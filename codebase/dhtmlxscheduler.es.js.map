{"version":3,"file":"dhtmlxscheduler.es.js","sources":["../sources/global.js","../sources/plugins/drag_highlight_pos.js","../sources/plugins/limit.js","../sources/plugins/batch_update.js","../node_modules/remote-client/dist/remote.es6.js","../sources/plugins/remote_events/remote_events.ts","../sources/plugins/remote_events/handlers.js","../sources/plugins/index.js","../sources/plugins/undo_delete.js","../sources/plugins/remote_events/index.js","../sources/core/utils/utils.js","../sources/core/nav_bar.js","../sources/core/scheduler_resize_listener.js","../sources/utils/eventable.js","../sources/core/utils/event.js","../sources/core/common.js","../sources/core/utils/scoped_event.js","../sources/core/utils/dom_helpers.js","../sources/utils/env.js","../sources/core/common/url_serialize.js","../sources/core/base.js","../sources/core/common/get_serializable_events.js","../sources/core/load.js","../sources/core/loaders/xml.js","../sources/core/loaders/json.js","../sources/core/loaders/ical.js","../sources/core/lightbox.js","../sources/core/touch.js","../sources/core/skins.js","../sources/core/dataprocessor/dataprocessor_hooks.js","../sources/core/dataprocessor/dataprocessor.js","../sources/core/message.js","../sources/locale/locale_ar.js","../sources/locale/locale_be.js","../sources/locale/locale_ca.js","../sources/locale/locale_cn.js","../sources/locale/locale_cs.js","../sources/locale/locale_da.js","../sources/locale/locale_de.js","../sources/locale/locale_el.js","../sources/locale/locale_en.js","../sources/locale/locale_es.js","../sources/locale/locale_fi.js","../sources/locale/locale_fr.js","../sources/locale/locale_he.js","../sources/locale/locale_hu.js","../sources/locale/locale_id.js","../sources/locale/locale_it.js","../sources/locale/locale_jp.js","../sources/locale/locale_manager.js","../sources/locale/locale_nb.js","../sources/locale/locale_nl.js","../sources/locale/locale_no.js","../sources/locale/locale_pl.js","../sources/locale/locale_pt.js","../sources/locale/locale_ro.js","../sources/locale/locale_ru.js","../sources/locale/locale_si.js","../sources/locale/locale_sk.js","../sources/locale/locale_sv.js","../sources/locale/locale_tr.js","../sources/locale/locale_ua.js","../sources/core/datepicker.js","../sources/scheduler_factory_method.js","../sources/core/state.js","../sources/core/common_errors.js","../sources/core/scheduler.js","../sources/core/wai_aria.js","../sources/core/common/assert.js","../sources/core/jquery.js","../sources/core/destructor.js","../sources/core/utils/ajax.js","../sources/core/config.js","../sources/core/event.js","../sources/core/event_highlight.js","../sources/core/dhtmlx/dhtmlx_suite_hooks.js","../sources/core/delay_render.js","../sources/core/connector.js","../sources/locale/index.js","../sources/ext/extension_manager.js","../sources/dhtmlx_hook.js","../sources/core/virtual_events_helpers.js","../sources/ext/drag_between.js","../sources/ext/keyboard_navigation/modals.js","../sources/ext/keyboard_navigation/key_nav_legacy.js","../sources/ext/keyboard_navigation/scheduler_handlers.js","../sources/legacy/dhtmlx_error.js","../sources/ext/map_view/gMapAdapter.ts","../sources/ext/map_view/osmMapAdapter.ts","../sources/ext/map_view/mapboxAdapter.ts","../node_modules/rrule/dist/esm/weekday.js","../node_modules/rrule/dist/esm/helpers.js","../node_modules/rrule/dist/esm/dateutil.js","../node_modules/rrule/dist/esm/iterresult.js","../node_modules/rrule/node_modules/tslib/tslib.es6.mjs","../node_modules/rrule/dist/esm/callbackiterresult.js","../node_modules/rrule/dist/esm/types.js","../node_modules/rrule/dist/esm/nlp/i18n.js","../node_modules/rrule/dist/esm/nlp/totext.js","../node_modules/rrule/dist/esm/nlp/parsetext.js","../node_modules/rrule/dist/esm/nlp/index.js","../node_modules/rrule/dist/esm/datetime.js","../node_modules/rrule/dist/esm/parseoptions.js","../node_modules/rrule/dist/esm/parsestring.js","../node_modules/rrule/dist/esm/datewithzone.js","../node_modules/rrule/dist/esm/optionstostring.js","../node_modules/rrule/dist/esm/cache.js","../node_modules/rrule/dist/esm/masks.js","../node_modules/rrule/dist/esm/iterinfo/yearinfo.js","../node_modules/rrule/dist/esm/iterinfo/index.js","../node_modules/rrule/dist/esm/iterinfo/monthinfo.js","../node_modules/rrule/dist/esm/iterinfo/easter.js","../node_modules/rrule/dist/esm/iter/poslist.js","../node_modules/rrule/dist/esm/iter/index.js","../node_modules/rrule/dist/esm/rrule.js","../node_modules/rrule/dist/esm/rrulestr.js","../node_modules/rrule/dist/esm/rruleset.js","../node_modules/rrule/dist/esm/iterset.js","../sources/ext/timeline/autoscroll.js","../sources/ext/timeline/rtl_scroll_helper.js","../sources/ext/tooltip/tooltip.ts","../sources/ext/tooltip/tooltipManager.ts","../sources/ext/extensions_all.js","../sources/ext/active_links.js","../sources/ext/agenda_legacy_view.js","../sources/ext/agenda.js","../sources/ext/all_timed.js","../sources/ext/collision.js","../sources/ext/container_autoresize.js","../sources/ext/cookie.js","../sources/ext/daytimeline.js","../sources/ext/editors.js","../sources/ext/expand.js","../sources/ext/export_api/index.js","../sources/ext/grid_view.js","../sources/ext/html_templates.js","../sources/ext/key_nav.js","../sources/ext/keyboard_navigation/common/keyboard_shortcuts.js","../sources/ext/keyboard_navigation/common/eventhandler.js","../sources/ext/keyboard_navigation/common/trap_modal_focus.js","../sources/ext/keyboard_navigation/marker.js","../sources/ext/keyboard_navigation/elements/scheduler_node.js","../sources/ext/keyboard_navigation/elements/nav_node.js","../sources/ext/keyboard_navigation/elements/header_cell.js","../sources/ext/keyboard_navigation/elements/event.js","../sources/ext/keyboard_navigation/elements/time_slot.js","../sources/ext/keyboard_navigation/elements/minical_button.js","../sources/ext/keyboard_navigation/elements/minical_cell.js","../sources/ext/keyboard_navigation/elements/data_area.js","../sources/ext/keyboard_navigation/core.js","../sources/ext/keyboard_navigation/minical_handlers.js","../sources/ext/layer.js","../sources/ext/legacy.js","../sources/legacy/dhtmlxcommon.js","../sources/ext/limit.js","../sources/ext/map_view/index.ts","../sources/ext/minical.js","../sources/ext/monthheight.js","../sources/ext/multisection.js","../sources/ext/multiselect.js","../sources/ext/multisource.js","../sources/ext/mvc.js","../sources/ext/outerdrag.js","../sources/ext/pdf.js","../sources/ext/quick_info.js","../sources/ext/readonly.js","../sources/ext/recurring.js","../sources/ext/recurring_legacy.js","../sources/ext/serialize.js","../sources/ext/timeline.js","../sources/ext/timeline/timeline_smart_render.js","../sources/ext/tooltip/index.ts","../sources/ext/treetimeline.js","../sources/ext/units.js","../sources/ext/url.js","../sources/ext/week_agenda.js","../sources/ext/wp.js","../sources/ext/year_view.js","../sources/dhtmlxscheduler.individual.js","../sources/scheduler_factory.js"],"sourcesContent":["\n/* eslint-disable no-restricted-globals */\nvar globalScope;\nif(typeof window !== \"undefined\"){\n\tglobalScope = window;\n}else{\n\tglobalScope = global;\n}\n/* eslint-enable no-restricted-globals */\n\nexport default globalScope;","export default function dragHighlightPos(scheduler){\n    let dndMarkers = [];\n    let dragStarted = false;\n    let eventNode = null;\n    let event = null;\n\n    function isEnabled() { \n        return scheduler.config.drag_highlight && scheduler.markTimespan;\n    }\n\n    function checkViewName(viewName){\n        const viewObj = scheduler.getView(viewName);\n        if(viewObj){\n            return viewObj.layout;\n        }\n        return viewName;\n    }\n\n    function checkSectionPropertyName(viewName){\n        const viewObj = scheduler.getView(viewName);\n        if(viewObj.y_property){\n            return viewObj.y_property;\n        }\n        if(viewObj.map_to){\n            return viewObj.map_to;\n        }\n    }\n\n    function setRequiredStylesToMarker(eventNode, layout){\n        switch (layout) {\n            case \"month\":\n                eventNode.style.top = \"\";\n                eventNode.style.left = \"\";\n                break;\n            case \"timeline\":\n                eventNode.style.left = \"\";\n                eventNode.style.marginLeft = \"1px\";\n                break;\n            default:\n                eventNode.style.top = \"\";\n                break;\n        }\n    }\n    \n    function createMarkerConfig(configSettings){\n        const { event, layout, viewName, sectionId, eventNode } = configSettings;\n        setRequiredStylesToMarker(eventNode, layout);\n        const sections = {};\n        let markerObject = {\n            start_date: event.start_date,\n            end_date: event.end_date,\n            css: \"dhx_scheduler_dnd_marker\",\n            html: eventNode\n        };\n        //GS-2644: case for round_position config in timeline view\n        if (layout == \"timeline\") {\n            const viewObj = scheduler.getView(viewName);\n            if (viewObj.round_position) {\n                const index = scheduler._get_date_index(viewObj,event.start_date);\n                const rounded_date = viewObj._trace_x[index];\n                markerObject.start_date = rounded_date;\n            }\n        }\n        if (layout == \"timeline\" || layout == \"month\" ){\n            // we need to set end date less than 24 hours of the views to avoid receiving multiple marktimespans\n            markerObject = {...markerObject, end_date: scheduler.date.add(event.start_date, 1, 'minute')};\n        }\n        if (sectionId){\n            sections[viewName] = sectionId;\n            markerObject.sections = sections;\n        }\n        return markerObject;\n    }\n\n    function createViewMarker(settings){\n        const { layout } = settings;\n        let markerConfigs;\n        switch (layout) {\n            case \"month\": \n                markerConfigs = getMonthViewMarkers(settings);\n                break;\n            case 'timeline':\n            case 'units':\n                markerConfigs = getTimelineAndUnitsViewMarkers(settings);\n                break;\n            default: \n                markerConfigs = getColumnViewMarkers(settings);\n                break;\n        }\n        markerConfigs.forEach((cfg) => {\n            dndMarkers.push(scheduler.markTimespan(cfg));\n        });\n    }\n\n    function getColumnViewMarkers(settings){\n        const {event, layout, viewName, sectionId} = settings;\n        let columnViewMarkersArray = [];\n            let eventNodes = scheduler.$container.querySelectorAll(`[${scheduler.config.event_attribute}='${event.id}']:not(.dhx_cal_select_menu):not(.dhx_drag_marker)`);\n            if(eventNodes){\n                for (let i = 0; i < eventNodes.length; i++) {\n                    let eventNodeClone = eventNodes[i].cloneNode(true);\n                    let startDate = new Date(+eventNodeClone.getAttribute(\"data-bar-start\"));\n                    let endDate = new Date(+eventNodeClone.getAttribute(\"data-bar-end\"));\n                    let dates = {start_date: startDate, end_date: endDate};\n                    const configSettings = {\n                        event: dates, \n                        layout, \n                        viewName, \n                        sectionId, \n                        eventNode:eventNodeClone\n                    };\n                    columnViewMarkersArray.push(createMarkerConfig(configSettings));\n                }\t\n            }\n        return columnViewMarkersArray;\n    }\n\n    function getMonthViewMarkers(settings){\n        let monthViewMarkersArray = [];\n        const {event, layout, viewName, sectionId} = settings;\n        const weekDates = [];\n        let currDate = new Date(event.start_date);\n        while(currDate.valueOf() < event.end_date.valueOf()){\n            let obj = {start_date: currDate};\n            weekDates.push(obj);\n            currDate = scheduler.date.week_start(scheduler.date.add(currDate, 1, \"week\"));\n        }\n        let cells = scheduler.$container.querySelectorAll(`[${scheduler.config.event_attribute}='${event.id}']`);\n        for (let i = 0; i < cells.length; i++) {\n            const configSettings = {\n                event: weekDates[i], \n                layout, \n                viewName, \n                sectionId, \n                eventNode: cells[i].cloneNode(true)\n            };\n            monthViewMarkersArray.push(createMarkerConfig(configSettings));\n        }\n        return monthViewMarkersArray;\n    }\n\n    function getTimelineAndUnitsViewMarkers(settings){\n        let unitMarkersArray = [];\n        const {event, layout, viewName, eventNode} = settings;\n        let sectionPropertyName = checkSectionPropertyName(viewName);\n        if (sectionPropertyName){\n            const sections = String(event[sectionPropertyName]).split(scheduler.config.section_delimiter);\n            const formatedSections = sections.map(element => String(element));\n            const elems = [];\n            for (let i = 0; i < formatedSections.length; i++) {\n                elems[i] = eventNode.cloneNode(true);\n                const configSettings = {\n                    event, \n                    layout, \n                    viewName, \n                    sectionId: formatedSections[i],\n                    eventNode: elems[i]\n                };\n                unitMarkersArray.push(createMarkerConfig(configSettings));\n            }\n        }\n        return unitMarkersArray;\n    }\n    \n    scheduler.attachEvent(\"onBeforeDrag\", function (id, mode, e){\n        if (isEnabled()) {\n            dragStarted = true;\n            event = scheduler.getEvent(id);\n            eventNode = e.target.closest(`[${scheduler.config.event_attribute}]`);\n            const viewName = scheduler.getState().mode;\n            const layout = checkViewName(viewName);\n            // to avoid incorrect eventNode and marker creation when scheduler.config.cascade_event_display included\n            if (layout == \"units\" && scheduler.config.cascade_event_display ) {\n                scheduler.unselect(id);\n                eventNode = e.target.closest(`[${scheduler.config.event_attribute}]`);\n            }\n        }\n        return true;\n    });\n\n    scheduler.attachEvent(\"onEventDrag\", function (id, mode, e){\n        if(dragStarted && isEnabled()){\n            dragStarted = false;// insert element only once after dnd start\n            const viewName = scheduler.getState().mode;\n            const layout = checkViewName(viewName);\n            const sectionId = scheduler.getActionData(e).section;\n            if (event) {\n                const settings = {\n                    event, \n                    layout, \n                    viewName, \n                    sectionId, \n                    eventNode\n                };\n                createViewMarker(settings);\n            }\n        }\n    });\n\n    scheduler.attachEvent(\"onDragEnd\", function(id, mode, e){\n        for (let i = 0; i < dndMarkers.length; i++) {\n            scheduler.unmarkTimespan(dndMarkers[i]);\n        }\n        dndMarkers = [];\n        eventNode = null;\n        event = null;\n    });\n}","export default function limitPlugin(scheduler){\n\n\n\tscheduler.config.mark_now = true;\n\tscheduler.config.display_marked_timespans = true;\n\tscheduler.config.overwrite_marked_timespans = true;\n\n\n\tvar dhx_time_block = \"dhx_time_block\";\n\tvar default_timespan_type = \"default\";\n\tvar fix_options = function(options, days, zones) {\n\t\tif (days instanceof Date && zones instanceof Date) {\n\t\t\toptions.start_date = days;\n\t\t\toptions.end_date = zones;\n\t\t} else {\n\t\t\toptions.days = days;\n\t\t\toptions.zones = zones;\n\t\t}\n\t\treturn options;\n\t};\n\tvar get_resulting_options = function(days, zones, sections) {\n\t\tvar options = (typeof days == \"object\") ? days : { days: days };\n\t\toptions.type = dhx_time_block;\n\t\toptions.css = \"\";\n\t\tif (zones) {\n\t\t\tif (sections)\n\t\t\t\toptions.sections = sections;\n\t\t\toptions = fix_options(options, days, zones);\n\t\t}\n\t\treturn options;\n\t};\n\tscheduler.blockTime = function(days, zones, sections){\n\t\tvar options = get_resulting_options(days, zones, sections);\n\t\treturn scheduler.addMarkedTimespan(options);\n\t};\n\tscheduler.unblockTime = function(days, zones, sections) {\n\t\tzones = zones || \"fullday\";\n\t\tvar options = get_resulting_options(days, zones, sections);\n\t\treturn scheduler.deleteMarkedTimespan(options);\n\t};\n\n\tscheduler.checkInMarkedTimespan = function(ev, timespan_type, on_overlap){\n\t\ttimespan_type = timespan_type || default_timespan_type;\n\n\t\tvar res = true;\n\t\tvar temp_start_date = new Date(ev.start_date.valueOf());\n\t\tvar temp_end_date = scheduler.date.add(temp_start_date, 1, \"day\");\n\t\tvar timespans = scheduler._marked_timespans;\n\t\tfor (; temp_start_date < ev.end_date; temp_start_date = scheduler.date.date_part(temp_end_date), temp_end_date = scheduler.date.add(temp_start_date, 1, \"day\") ) {\n\t\t\tvar day_value = +scheduler.date.date_part( new Date(temp_start_date) ); // the first part of event not necessarily contains only date part\n\t\t\tvar day_index = temp_start_date.getDay();\n\n\t\t\tvar zones = getZones(ev, timespans, day_index, day_value, timespan_type);\n\t\t\tif (zones){\n\t\t\t\tfor (var i = 0; i < zones.length; i+=2) {\n\n\t\t\t\t\t// they may change for new event if it passes limit zone\n\t\t\t\t\tvar eventStart = scheduler._get_zone_minutes(temp_start_date);\n\t\t\t\t\tvar eventEnd = ( ev.end_date>temp_end_date || ev.end_date.getDate() != temp_start_date.getDate() ) ? 1440 : scheduler._get_zone_minutes(ev.end_date);\n\n\t\t\t\t\tvar markerStart = zones[i];\n\t\t\t\t\tvar markerEnd = zones[i+1];\n\t\t\t\t\tif (markerStart<eventEnd && markerEnd>eventStart) {\n\t\t\t\t\t\tif(typeof on_overlap == \"function\"){\n\t\t\t\t\t\t\t//handler allows to cancel overlapping\n\t\t\t\t\t\t\t//actually needed only to keep default behavior of limits\n\t\t\t\t\t\t\tres = on_overlap(ev, eventStart, eventEnd, markerStart, markerEnd);//event object, event start/end minutes in 'zones' format, zone start/end minutes\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tres = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!res)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn !res;\n\t};\n\tscheduler.checkLimitViolation = function(event){\n\t\tif(!event)\n\t\t\treturn true;\n\t\tif (!scheduler.config.check_limits)\n\t\t\treturn true;\n\t\tvar s = scheduler;\n\t\tvar c = s.config;\n\t\tvar evs = [];\n\t\tif ((event.rec_type && event._end_date) || (event.rrule)) {\n\t\t\tconst seriesEnd = event._end_date || event.end_date;\n\t\t\t// GS-2482 need to take into account that a part of recurring events might be outside the limits\n\t\t\tif ((c.limit_start && c.limit_end)) {\n\t\t\t\tvar recEventInLimits = seriesEnd.valueOf() >= c.limit_start.valueOf() && event.start_date.valueOf() <= c.limit_end.valueOf();\n\t\t\t\treturn recEventInLimits;\n\t\t\t} else return true;\n\t\t} else {\n\t\t\tevs = [event];\n\t\t}\n\n\t\tvar complete_res = true;\n\t\tfor (var p=0; p<evs.length; p++) {\n\t\t\tvar res = true;\n\t\t\tvar ev = evs[p];\n\t\t\t// Event could have old _timed property (e.g. we are creating event with DND on timeline view and crossed day)\n\t\t\tev._timed = scheduler.isOneDayEvent(ev);\n\n\t\t\tres = (c.limit_start && c.limit_end) ? (ev.start_date.valueOf() >= c.limit_start.valueOf() && ev.end_date.valueOf() <= c.limit_end.valueOf()) : true;\n\t\t\tif (res){\n\t\t\t\tres = !scheduler.checkInMarkedTimespan(ev, dhx_time_block, function(event, eventStart, eventEnd, markerStart, markerEnd){\n\t\t\t\t\t//try crop event to allow placing\n\t\t\t\t\tvar allow = true;\n\t\t\t\t\tif (eventStart<=markerEnd && eventStart >= markerStart){\n\t\t\t\t\t\tif (markerEnd == 24*60 || eventEnd <= markerEnd){\n\t\t\t\t\t\t\tallow = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(event._timed && s._drag_id && s._drag_mode == \"new-size\"){\n\t\t\t\t\t\t\tevent.start_date.setHours(0);\n\t\t\t\t\t\t\tevent.start_date.setMinutes(markerEnd);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tallow = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ((eventEnd >= markerStart && eventEnd <= markerEnd) || (eventStart < markerStart && eventEnd > markerEnd)){\n\t\t\t\t\t\tif(event._timed && s._drag_id && s._drag_mode == \"new-size\"){\n\t\t\t\t\t\t\tevent.end_date.setHours(0);\n\t\t\t\t\t\t\tevent.end_date.setMinutes(markerStart);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tallow = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn allow;\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (!res) {\n\t\t\t\tres = (s.checkEvent(\"onLimitViolation\")) ? s.callEvent(\"onLimitViolation\",[ev.id, ev]) : res;\n\t\t\t}\n\t\t\tcomplete_res = complete_res && res;\n\t\t}\n\t\tif(!complete_res){\n\t\t\ts._drag_id = null;\n\t\t\ts._drag_mode = null;\n\t\t}\n\t\treturn complete_res;\n\n\n\t};\n\tscheduler._get_blocked_zones = function(timespans, property, day_index, day_value, timespan_type){\n\t\tvar zones =[];\n\t\tif (timespans && timespans[property]) {\n\t\t\tvar timeline_zones = timespans[property];\n\t\t\tvar blocked_timeline_zones = this._get_relevant_blocked_zones(day_index, day_value, timeline_zones, timespan_type);\n\t\t\tfor (var i=0; i<blocked_timeline_zones.length; i++) {\n\t\t\t\tzones = this._add_timespan_zones(zones, blocked_timeline_zones[i].zones);\n\t\t\t}\n\t\t}\n\t\treturn zones;\n\t};\n\tscheduler._get_relevant_blocked_zones = function(day_index, day_value, zones, timespan_type) {\n\t\tvar resultZones;\n\t\tif(scheduler.config.overwrite_marked_timespans){\n\t\t\tresultZones = (zones[day_value] && zones[day_value][timespan_type]) ? zones[day_value][timespan_type] :\n\t\t\t(zones[day_index] && zones[day_index][timespan_type]) ? zones[day_index][timespan_type] : [];\n\t\t}else{\n\t\t\tresultZones = [];\n\t\t\tif(zones[day_value] && zones[day_value][timespan_type]){\n\t\t\t\tresultZones = resultZones.concat(zones[day_value][timespan_type]);\n\t\t\t}\n\t\t\t\n\t\t\tif((zones[day_index] && zones[day_index][timespan_type])){\n\t\t\t\tresultZones = resultZones.concat(zones[day_index][timespan_type]);\n\t\t\t}\n\t\t}\n\n\t\treturn resultZones;\n\t};\n\tfunction getZones(ev, timespans, day_index, day_value, timespan_type){\n\t\tvar s = scheduler;\n\t\t//containers for 'unit' and 'timeline' views, and related 'section_id' properties\n\t\tvar zones = [];\n\t\tvar containers = {\n\t\t\t'_props':'map_to',\n\t\t\t'matrix':'y_property'};\n\t\t//check blocked sections in all units and timelines\n\t\tfor(var container in containers){\n\t\t\tvar property = containers[container];\n\t\t\tif(s[container]){\n\t\t\t\tfor(var view in s[container]){\n\t\t\t\t\tvar view_config = s[container][view];\n\t\t\t\t\tvar linker = view_config[property];\n\t\t\t\t\tif(!ev[linker]) continue;\n\t\t\t\t\tzones =  s._add_timespan_zones(zones,\n\t\t\t\t\t\tscheduler._get_blocked_zones(timespans[view], ev[linker], day_index, day_value, timespan_type));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// now need to add day blocks\n\t\tzones = s._add_timespan_zones(zones, scheduler._get_blocked_zones(timespans, 'global', day_index, day_value, timespan_type));\n\t\treturn zones;\n\t}\n\n\tscheduler._mark_now = function(hide) {\n\t\t// day, week, units views\n\t\tvar dhx_now_time = 'dhx_now_time';\n\t\tif (!this._els[dhx_now_time]) {\n\t\t\tthis._els[dhx_now_time] = [];\n\t\t}\n\t\tvar now = scheduler._currentDate();\n\t\tvar cfg = this.config;\n\t\tscheduler._remove_mark_now(); // delete previous marks if they exist\n\t\tif (!hide && cfg.mark_now && now < this._max_date && now > this._min_date && now.getHours() >= cfg.first_hour && now.getHours()<cfg.last_hour) {\n\t\t\tvar day_index = this.locate_holder_day(now);\n\t\t\tthis._els[dhx_now_time] = scheduler._append_mark_now(day_index, now);\n\t\t}\n\t};\n\tscheduler._append_mark_now = function(day_index, now) {\n\t\tvar dhx_now_time = 'dhx_now_time';\n\t\tvar zone_start= scheduler._get_zone_minutes(now);\n\t\tvar options = {\n\t\t\tzones: [zone_start, zone_start+1],\n\t\t\tcss: dhx_now_time,\n\t\t\ttype: dhx_now_time\n\t\t};\n\t\tif (!this._table_view) {\n\t\t\tif (this._props && this._props[this._mode]) { // units view\n\t\t\t\tvar start_index,\n\t\t\t\t\tend_index;\n\n\t\t\t\tvar view = this._props[this._mode];\n\t\t\t\tvar units_l = view.size || view.options.length;\n\t\t\t\tif (view.days > 1) {\n\t\t\t\t\tif(view.size && view.options.length){\n\t\t\t\t\t\tday_index = ((view.position+ day_index) / view.options.length) * view.size;\n\t\t\t\t\t}\n\t\t\t\t\tstart_index = day_index;\n\t\t\t\t\tend_index = day_index + units_l;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstart_index = 0;\n\t\t\t\t\tend_index = start_index + units_l;\n\t\t\t\t}\n\n\t\t\t\tvar r_divs = [];\n\n\t\t\t\tfor (var i = start_index; i < end_index; i++) {\n\t\t\t\t\tvar t_day = i; // as each unit is actually considered +1 day\n\t\t\t\t\toptions.days = t_day;\n\t\t\t\t\tvar t_div = scheduler._render_marked_timespan(options, null, t_day)[0];\n\t\t\t\t\tr_divs.push(t_div);\n\t\t\t\t}\n\t\t\t\treturn r_divs;\n\t\t\t} else {  // day/week views\n\t\t\t\toptions.days = day_index;\n\t\t\t\treturn scheduler._render_marked_timespan(options, null, day_index);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._mode == \"month\") {\n\t\t\t\toptions.days = +scheduler.date.date_part(now);\n\t\t\t\treturn scheduler._render_marked_timespan(options, null, null);\n\t\t\t}\n\t\t}\n\t};\n\tscheduler._remove_mark_now = function() {\n\t\tvar dhx_now_time = 'dhx_now_time';\n\t\tvar els = this._els[dhx_now_time];\n\t\tfor (var i=0; i<els.length; i++) {\n\t\t\tvar div = els[i];\n\t\t\tvar parent = div.parentNode;\n\t\t\tif (parent) {\n\t\t\t\tparent.removeChild(div);\n\t\t\t}\n\t\t}\n\t\tthis._els[dhx_now_time] = [];\n\t};\n\n\t/*\n\tscheduler._marked_timespans = {\n\t\t\"global\": {\n\t\t\t\"0\": {\n\t\t\t\t\"default\": [\n\t\t\t\t\t{  // sunday\n\t\t\t\t\t\tzones: [0, 100, 500, 600],\n\t\t\t\t\t\tcss: \"yellow_box\",\n\t\t\t\t\t\ttype: \"default\",\n\t\t\t\t\t\tview: \"global\",\n\t\t\t\t\t\tday: 0\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t\t\"112121312\": {\n\t\t\t\t\"my_special_type\": [\n\t\t\t\t\t{\n\t\t\t\t\t\tzones: [600, 900],\n\t\t\t\t\t\ttype: \"block\",\n\t\t\t\t\t\tcss: \"some_class\",\n\t\t\t\t\t\tview: \"global\",\n\t\t\t\t\t\tday: 112121312\n\t\t\t\t\t},\n\t\t\t\t\t{}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\t\t\"units\": {\n\t\t\t\"5_id\": {\n\t\t\t\t\"3\": {\n\t\t\t\t\t\"special_type\": [ {}, {}, {} ],\n\t\t\t\t\t\"another_type\": [ {} ]\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"6_id\": {\n\t\t\t\t\"11212127\": {\n\t\t\t\t\t...\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\tscheduler._marked_timespans = { global: {} };\n\n\tscheduler._get_zone_minutes = function(date) {\n\t\treturn date.getHours()*60 + date.getMinutes();\n\t};\n\tscheduler._prepare_timespan_options = function(config) { // receives 1 option, returns array of options\n\t\tvar r_configs = []; // resulting configs\n\t\tvar temp_configs = [];\n\n\t\tif (config.days == \"fullweek\")\n\t\t\tconfig.days = [0,1,2,3,4,5,6];\n\n\t\tif (config.days instanceof Array) {\n\t\t\tvar t_days = config.days.slice();\n\t\t\tfor (var i=0; i<t_days.length; i++) {\n\t\t\t\tvar cloned_config = scheduler._lame_clone(config);\n\t\t\t\tcloned_config.days = t_days[i];\n\t\t\t\tr_configs.push.apply(r_configs, scheduler._prepare_timespan_options(cloned_config));\n\t\t\t}\n\t\t\treturn r_configs;\n\t\t}\n\n\t\tif ( !config ||\n\t\t\t!((config.start_date && config.end_date && config.end_date > config.start_date) || (config.days !== undefined && config.zones)) && !config.type )\n\t\t\treturn r_configs;  // incorrect config was provided\n\n\t\tvar min = 0;\n\t\tvar max = 24*60;\n\t\tif (config.zones == \"fullday\")\n\t\t\tconfig.zones = [min, max];\n\t\tif (config.zones && config.invert_zones) {\n\t\t\tconfig.zones = scheduler.invertZones(config.zones);\n\t\t}\n\n\t\tconfig.id = scheduler.uid();\n\t\tconfig.css = config.css||\"\";\n\t\tconfig.type = config.type||default_timespan_type;\n\n\t\tvar sections = config.sections;\n\t\tif (sections) {\n\t\t\tfor (var view_key in sections) {\n\t\t\t\tif (sections.hasOwnProperty(view_key)) {\n\t\t\t\t\tvar ids = sections[view_key];\n\t\t\t\t\tif (!(ids instanceof Array))\n\t\t\t\t\t\tids = [ids];\n\t\t\t\t\tfor (var i=0; i<ids.length; i++) {\n\t\t\t\t\t\tvar t_config = scheduler._lame_copy({}, config);\n\t\t\t\t\t\tt_config.sections = {};\n\t\t\t\t\t\tt_config.sections[view_key] = ids[i];\n\t\t\t\t\t\ttemp_configs.push(t_config);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\ttemp_configs.push(config);\n\t\t}\n\n\t\tfor (var k=0; k<temp_configs.length; k++) {\n\t\t\tvar c_config = temp_configs[k]; // config to be checked\n\n\t\t\tvar start_date = c_config.start_date;\n\t\t\tvar end_date = c_config.end_date;\n\n\t\t\tif (start_date && end_date) {\n\t\t\t\tvar t_sd = scheduler.date.date_part(new Date(start_date)); // e.g. 05 october\n\t\t\t\tvar t_ed= scheduler.date.add(t_sd, 1, \"day\");  // 06 october, will both be incremented in the loop\n\n\t\t\t\twhile (t_sd < end_date) {\n\t\t\t\t\tvar t_config = scheduler._lame_copy({}, c_config);\n\t\t\t\t\tdelete t_config.start_date;\n\t\t\t\t\tdelete t_config.end_date;\n\t\t\t\t\tt_config.days = t_sd.valueOf();\n\t\t\t\t\tvar zone_start = (start_date > t_sd) ? scheduler._get_zone_minutes(start_date) : min;\n\t\t\t\t\tvar zone_end = ( end_date > t_ed || end_date.getDate() != t_sd.getDate() ) ? max : scheduler._get_zone_minutes(end_date);\n\t\t\t\t\tt_config.zones = [zone_start, zone_end];\n\t\t\t\t\tr_configs.push(t_config);\n\n\t\t\t\t\tt_sd = t_ed;\n\t\t\t\t\tt_ed = scheduler.date.add(t_ed, 1, \"day\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (c_config.days instanceof Date)\n\t\t\t\t\tc_config.days = (scheduler.date.date_part(c_config.days)).valueOf();\n\t\t\t\tc_config.zones = config.zones.slice();\n\t\t\t\tr_configs.push(c_config);\n\t\t\t}\n\t\t}\n\t\treturn r_configs;\n\t};\n\tscheduler._get_dates_by_index = function(index, start, end) {\n\t\tvar dates = [];\n\t\tstart = scheduler.date.date_part(new Date(start||scheduler._min_date));\n\t\tend = new Date(end||scheduler._max_date);\n\t\tvar start_day = start.getDay();\n\t\tvar delta = (index-start_day >= 0) ? (index-start_day) : (7-start.getDay()+index);\n\t\tvar t_date = scheduler.date.add(start, delta, \"day\");\n\t\tfor (; t_date < end; t_date = scheduler.date.add(t_date, 1, \"week\")) {\n\t\t\tdates.push(t_date);\n\t\t}\n\t\treturn dates;\n\t};\n\tscheduler._get_css_classes_by_config = function(config) {\n\t\tvar css_classes = [];\n\t\tif (config.type == dhx_time_block) {\n\t\t\tcss_classes.push(dhx_time_block);\n\t\t\tif (config.css)\n\t\t\t\tcss_classes.push(dhx_time_block+\"_reset\");\n\t\t}\n\t\tcss_classes.push(\"dhx_marked_timespan\", config.css);\n\t\treturn css_classes.join(\" \");\n\t};\n\tscheduler._get_block_by_config = function(config) {\n\t\tvar block  = document.createElement(\"div\");\n\t\tif (config.html) {\n\t\t\tif (typeof config.html == \"string\")\n\t\t\t\tblock.innerHTML = config.html;\n\t\t\telse\n\t\t\t\tblock.appendChild(config.html);\n\t\t}\n\t\treturn block;\n\t};\n\tscheduler._render_marked_timespan = function(options, area, day) {\n\t\tvar blocks = []; // resulting block which will be rendered and returned\n\t\tvar c = scheduler.config;\n\t\tvar min_date = this._min_date;\n\t\tvar max_date = this._max_date;\n\t\tvar day_value = false; // if timespan for specific date should be displayed\n\n\t\tif (!c.display_marked_timespans)\n\t\t\treturn blocks;\n\n\t\t// in case of markTimespan\n\t\tif (!day && day !== 0) {\n\t\t\tif (options.days < 7)\n\t\t\t\tday = options.days;\n\t\t\telse {\n\t\t\t\tvar date_to_display = new Date(options.days);\n\t\t\t\tday_value = +date_to_display;\n\n\t\t\t\t// in case of markTimespan date could be not in the viewing range, need to return\n\t\t\t\tif ( !(+max_date > +date_to_display && +min_date <= +date_to_display) )\n\t\t\t\t\treturn blocks;\n\n\t\t\t\tday = date_to_display.getDay();\n\t\t\t}\n\n\t\t\t// convert day default index (Sun - 0, Sat - 6) to index of hourscales (depends on week_start and config.start_on_monday)\n\t\t\tvar min_day = min_date.getDay();\n\t\t\tif (min_day > day) {\n\t\t\t\tday = 7 - (min_day-day);\n\t\t\t} else {\n\t\t\t\tday = day - min_day;\n\t\t\t}\n\t\t}\n\t\tvar zones = options.zones;\n\t\tvar css_classes = scheduler._get_css_classes_by_config(options);\n\n\t\tif (scheduler._table_view && scheduler._mode == \"month\") {\n\t\t\tvar areas = [];\n\t\t\tvar days = [];\n\n\n\t\t\tif (!area) {\n\t\t\t\tdays = (day_value) ? [day_value] : scheduler._get_dates_by_index(day);\n\t\t\t\tfor (var i=0; i < days.length; i++) {\n\t\t\t\t\tareas.push( this._scales[days[i]] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tareas.push(area);\n\t\t\t\tdays.push(day);\n\t\t\t}\n\n\t\t\tfor (var i=0; i < areas.length; i++) {\n\t\t\t\tarea = areas[i];\n\t\t\t\tday = days[i];\n\n\t\t\t\tvar sday = this.locate_holder_day(day, false) % this._cols.length;\n\n\t\t\t\tif(this._ignores[sday]) continue;\n\n\t\t\t\tvar block_proto = scheduler._get_block_by_config(options);\n\t\t\t\tblock_proto.className = css_classes;\n\t\t\t\tblock_proto.style.top = \"0px\";\n\t\t\t\tblock_proto.style.height = \"100%\";\n\t\t\t\t\n\t\t\t\tfor (var k=0; k < zones.length; k+=2) {\n\t\t\t\t\tvar start = zones[i];\n\t\t\t\t\tvar end = zones[i+1];\n\t\t\t\t\tif (end <= start)\n\t\t\t\t\t\treturn [];\n\n\t\t\t\t\tvar block = block_proto.cloneNode(true);\n\n\t\t\t\t\tblock.style.left = \"0px\";\n\t\t\t\t\tblock.style.width = \"100%\";\n\n\t\t\t\t\tarea.appendChild(block);\n\t\t\t\t\tblocks.push(block);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tvar index = day;\n\n\t\t\tif(this._ignores[this.locate_holder_day(day, false)]) return blocks;\n\n\t\t\tif (this._props && this._props[this._mode] && options.sections && options.sections[this._mode]) {\n\t\t\t\tvar view = this._props[this._mode];\n\t\t\t\tindex = view.order[options.sections[this._mode]];\n\n\t\t\t\tvar inner_index = view.order[options.sections[this._mode]];\n\t\t\t\tif(!(view.days > 1)){\n\t\t\t\t\tindex = inner_index;\n\t\t\t\t\tif (view.size && (index > view.position+view.size)) {\n\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tvar units_l = view.size || view.options.length;\n\t\t\t\t\tindex = index*units_l + inner_index;\n\t\t\t\t}\n\t\t\t}\n\t\t\tarea = area ? area : scheduler.locate_holder(index);\n\n\t\t\tfor (var i = 0; i < zones.length; i+=2){\n\t\t\t\tvar start = Math.max(zones[i], c.first_hour*60);\n\t\t\t\tvar end = Math.min(zones[i+1], c.last_hour*60);\n\t\t\t\tif (end <= start) {\n\t\t\t\t\tif (i+2 < zones.length)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse\n\t\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tvar block = scheduler._get_block_by_config(options);\n\t\t\t\tblock.className = css_classes;\n\n\t\t\t\t// +1 for working with section which really takes up whole height (as % would be == 0)\n\t\t\t\tvar all_hours_height = this.config.hour_size_px*24 + 1;\n\t\t\t\tvar hour_ms = 60*60*1000;\n\t\t\t\tblock.style.top = (Math.round((start*60*1000-this.config.first_hour*hour_ms)*this.config.hour_size_px/hour_ms) % all_hours_height) + \"px\";\n\t\t\t\tblock.style.height = Math.max((Math.round(((end-start)*60*1000)*this.config.hour_size_px/hour_ms)) % all_hours_height, 1)+\"px\";\n\n\t\t\t\tarea.appendChild(block);\n\t\t\t\tblocks.push(block);\n\t\t\t}\n\t\t}\n\t\treturn blocks;\n\t};\n\n\tscheduler._mark_timespans = function(){\n\t\tvar data = this._els[\"dhx_cal_data\"][0];\n\t\tvar divs = [];\n\t\tif (scheduler._table_view && scheduler._mode == \"month\"){\n\t\t\tfor (var day in this._scales) {\n\t\t\t\tvar date = new Date(+day);\n\t\t\t\tdivs.push.apply(divs, scheduler._on_scale_add_marker(this._scales[day],date));\n\t\t\t}\n\t\t}else {\n\t\t\t//manually trigger rendering of configs for each column\n\t\t\tvar date = new Date(scheduler._min_date);\n\t\t\tfor (var i = 0, len = data.childNodes.length; i < len; i++) {\n\t\t\t\tvar area = data.childNodes[i];\n\t\t\t\tif (area.firstChild && scheduler._getClassName(area.firstChild).indexOf(\"dhx_scale_hour\") > -1) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tdivs.push.apply(divs, scheduler._on_scale_add_marker(area, date));\n\t\t\t\tdate = scheduler.date.add(date, 1, \"day\");\n\t\t\t}\n\t\t}\n\t\treturn divs;\n\t};\n\n\t// just marks timespan, will be cleaned after refresh\n\tscheduler.markTimespan = function(configuration) {\n\t\tif(!this._els){\n\t\t\tthrow new Error(\"`scheduler.markTimespan` can't be used before scheduler initialization. Place `scheduler.markTimespan` call after `scheduler.init`.\");\n\t\t}\n\n\n\t\tvar rebuild_els = false;\n\t\tif(!this._els[\"dhx_cal_data\"]){\n\t\t\tscheduler.get_elements();\n\t\t\trebuild_els = true;\n\t\t}\n\n\n\t\t// backup regular marked timespans\n\t\tvar timespans_ids = scheduler._marked_timespans_ids,\n\t\t\ttimespan_types = scheduler._marked_timespans_types,\n\t\t\ttimespans = scheduler._marked_timespans;\n\n\t\tscheduler.deleteMarkedTimespan();\n\n\t\t//add block to configs\n\t\tscheduler.addMarkedTimespan(configuration);\n\n\t\tvar divs = scheduler._mark_timespans();\n\n\t\tif(rebuild_els)\n\t\t\tscheduler._els = [];\n\n\t\t// restore timespan config\n\t\tscheduler._marked_timespans_ids = timespans_ids;\n\t\tscheduler._marked_timespans_types = timespan_types;\n\t\tscheduler._marked_timespans = timespans;\n\n\t\treturn divs;\n\t};\n\tscheduler.unmarkTimespan = function(divs) {\n\t\tif (!divs)\n\t\t\treturn;\n\t\tfor (var i=0; i<divs.length; i++) {\n\t\t\tvar div = divs[i];\n\t\t\t// parent may no longer be present if we switched views, navigated\n\t\t\tif (div.parentNode) {\n\t\t\t\tdiv.parentNode.removeChild(div);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tscheduler._addMarkerTimespanConfig = function(config){\n\t\tvar global = \"global\";\n\t\tvar timespans = scheduler._marked_timespans;\n\t\tvar id = config.id;\n\n\t\tvar ids = scheduler._marked_timespans_ids;\n\t\tif (!ids[id])\n\t\t\tids[id] = [];\n\n\n\t\tvar day = config.days;\n\n\t\tvar sections = config.sections;\n\t\tvar type = config.type; // default or specified\n\t\tconfig.id = id;\n\n\t\tif (sections) {\n\t\t\tfor (var view_key in sections) {\n\t\t\t\tif (sections.hasOwnProperty(view_key)) {\n\t\t\t\t\tif (!timespans[view_key])\n\t\t\t\t\t\ttimespans[view_key] = {};\n\t\t\t\t\tvar unit_id = sections[view_key];\n\t\t\t\t\tvar timespans_view = timespans[view_key];\n\t\t\t\t\tif (!timespans_view[unit_id])\n\t\t\t\t\t\ttimespans_view[unit_id] = {};\n\t\t\t\t\tif (!timespans_view[unit_id][day])\n\t\t\t\t\t\ttimespans_view[unit_id][day] = {};\n\t\t\t\t\tif (!timespans_view[unit_id][day][type]){\n\t\t\t\t\t\ttimespans_view[unit_id][day][type] = [];\n\t\t\t\t\t\tif(!scheduler._marked_timespans_types)\n\t\t\t\t\t\t\tscheduler._marked_timespans_types = {};\n\t\t\t\t\t\tif(!scheduler._marked_timespans_types[type])\n\t\t\t\t\t\t\tscheduler._marked_timespans_types[type] = true;\n\t\t\t\t\t}\n\t\t\t\t\tvar day_configs = timespans_view[unit_id][day][type];\n\t\t\t\t\tconfig._array = day_configs;\n\t\t\t\t\tday_configs.push(config);\n\t\t\t\t\tids[id].push(config);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (!timespans[global][day])\n\t\t\t\ttimespans[global][day] = {};\n\t\t\tif (!timespans[global][day][type])\n\t\t\t\ttimespans[global][day][type] = [];\n\n\t\t\tif(!scheduler._marked_timespans_types)\n\t\t\t\tscheduler._marked_timespans_types = {};\n\t\t\tif(!scheduler._marked_timespans_types[type])\n\t\t\t\tscheduler._marked_timespans_types[type] = true;\n\n\t\t\tvar day_configs = timespans[global][day][type];\n\t\t\tconfig._array = day_configs;\n\t\t\tday_configs.push(config);\n\t\t\tids[id].push(config);\n\t\t}\n\n\t};\n\n\tscheduler._marked_timespans_ids = {};\n\t// adds marked timespan to collections, persistent\n\tscheduler.addMarkedTimespan = function(configuration) {\n\t\tvar configs = scheduler._prepare_timespan_options(configuration);\n\t\tif (!configs.length)\n\t\t\treturn; // options are incorrect, nothing to mark\n\n\t\tvar id = configs[0].id;\n\t\tfor (var i=0; i<configs.length; i++) {\n\t\t\tscheduler._addMarkerTimespanConfig(configs[i]);\n\t\t}\n\t\treturn id;\n\t};\n\t// not used for now\n\tscheduler._add_timespan_zones = function(current_zones, zones) {\n\t\tvar resulting_zones = current_zones.slice();\n\t\tzones = zones.slice();\n\n\t\tif (!resulting_zones.length)\n\t\t\treturn zones;\n\n\t\tfor (var i=0; i<resulting_zones.length; i+=2) {\n\t\t\tvar c_zone_start = resulting_zones[i];\n\t\t\tvar c_zone_end = resulting_zones[i+1];\n\t\t\tvar isLast = (i+2 == resulting_zones.length);\n\n\t\t\tfor (var k=0; k<zones.length; k+=2) {\n\t\t\t\tvar zone_start = zones[k];\n\t\t\t\tvar zone_end = zones[k+1];\n\t\t\t\tif ((zone_end > c_zone_end && zone_start <= c_zone_end) || (zone_start < c_zone_start && zone_end >= c_zone_start)) {\n\t\t\t\t\tresulting_zones[i] = Math.min(c_zone_start, zone_start);\n\t\t\t\t\tresulting_zones[i+1] = Math.max(c_zone_end, zone_end);\n\t\t\t\t\ti -= 2;\n\t\t\t\t} else {\n\t\t\t\t\tif (!isLast) // do nothing, maybe next current zone will match or will be last\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvar offset = (c_zone_start > zone_start)?0:2;\n\t\t\t\t\tresulting_zones.splice(i+offset, 0, zone_start, zone_end); // last current zone, need to add another\n\t\t\t\t}\n\t\t\t\tzones.splice(k--,2); // zone was merged or added, need to exclude it\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn resulting_zones;\n\t};\n\tscheduler._subtract_timespan_zones = function(current_zones, zones) {\n\t\tvar resulting_zones = current_zones.slice();\n\t\tfor (var i=0; i<resulting_zones.length; i+=2 ) {\n\t\t\tvar c_zone_start = resulting_zones[i];// current_zone_start\n\t\t\tvar c_zone_end = resulting_zones[i+1];\n\t\t\tfor (var k=0; k<zones.length; k+=2) {\n\t\t\t\tvar zone_start = zones[k];\n\t\t\t\tvar zone_end = zones[k+1];\n\t\t\t\tif (zone_end > c_zone_start && zone_start < c_zone_end) {\n\t\t\t\t\tvar is_modified = false;\n\t\t\t\t\tif (c_zone_start >= zone_start && c_zone_end <= zone_end) {\n\t\t\t\t\t\tresulting_zones.splice(i, 2);\n\t\t\t\t\t}\n\t\t\t\t\tif (c_zone_start < zone_start) {\n\t\t\t\t\t\tresulting_zones.splice(i, 2, c_zone_start, zone_start);\n\t\t\t\t\t\tis_modified = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (c_zone_end > zone_end) {\n\t\t\t\t\t\tresulting_zones.splice( (is_modified)?(i+2):i, (is_modified)?0:2, zone_end, c_zone_end);\n\t\t\t\t\t}\n\t\t\t\t\ti -= 2;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn resulting_zones;\n\t};\n\tscheduler.invertZones = function(zones) {\n\t\treturn scheduler._subtract_timespan_zones([0, 1440], zones.slice());\n\t};\n\tscheduler._delete_marked_timespan_by_id = function(id) {\n\t\tvar configs = scheduler._marked_timespans_ids[id];\n\t\tif (configs) {\n\t\t\tfor (var i=0; i<configs.length; i++) {\n\t\t\t\tvar config = configs[i];\n\t\t\t\tvar parent_array = config._array;\n\t\t\t\tfor (var k=0; k<parent_array.length; k++) {\n\t\t\t\t\tif (parent_array[k] == config) {\n\t\t\t\t\t\tparent_array.splice(k, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tscheduler._delete_marked_timespan_by_config = function(config) {\n\t\tvar timespans = scheduler._marked_timespans;\n\t\tvar sections = config.sections;\n\t\tvar day = config.days;\n\t\tvar type = config.type||default_timespan_type;\n\t\tvar viewspans;\n\t\tif (sections) {\n\t\t\tfor (var view_key in sections) {\n\t\t\t\tif (sections.hasOwnProperty(view_key) && timespans[view_key]) {\n\t\t\t\t\tvar unit_id = sections[view_key];\n\t\t\t\t\tif (timespans[view_key][unit_id]){\n\t\t\t\t\t\tviewspans = timespans[view_key][unit_id];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tviewspans = timespans.global;\n\t\t}\n\n\t\tif(viewspans) {\n\t\t\tif (day !== undefined) {\n\t\t\t\tif (viewspans[day] && viewspans[day][type]) {\n\t\t\t\t\tscheduler._addMarkerTimespanConfig(config); // register config in order to be able to delete recurring timespan from a specific day\n\t\t\t\t\tscheduler._delete_marked_timespans_list(viewspans[day][type], config);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (var d in viewspans) {\n\t\t\t\t\tif (viewspans[d][type]) {\n\t\t\t\t\t\tvar dayConfig = scheduler._lame_clone(config);\n\t\t\t\t\t\tconfig.days = d;\n\t\t\t\t\t\tscheduler._addMarkerTimespanConfig(dayConfig); // register config in order to be able to delete recurring timespan from a specific day\n\t\t\t\t\t\tscheduler._delete_marked_timespans_list(viewspans[d][type], config);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tscheduler._delete_marked_timespans_list = function(day_timespans, config){\n\t\tfor (var i=0; i<day_timespans.length; i++) {\n\t\t\tvar d_t = day_timespans[i];\n\t\t\tvar zones = scheduler._subtract_timespan_zones(d_t.zones, config.zones);\n\t\t\tif (zones.length)\n\t\t\t\td_t.zones = zones;\n\t\t\telse {\n\t\t\t\tday_timespans.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\t// need to update ids collection\n\t\t\t\tvar related_zones = scheduler._marked_timespans_ids[d_t.id];\n\t\t\t\tfor (var k=0; k<related_zones.length; k++) {\n\t\t\t\t\tif (related_zones[k] == d_t) {\n\t\t\t\t\t\trelated_zones.splice(k, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tscheduler.deleteMarkedTimespan = function(configuration) {\n\t\t// delete everything\n\t\tif (!arguments.length) {\n\t\t\tscheduler._marked_timespans = { global: {} };\n\t\t\tscheduler._marked_timespans_ids = {};\n\t\t\tscheduler._marked_timespans_types = {};\n\t\t}\n\n\t\tif (typeof configuration != \"object\") { // id was passed\n\t\t\tscheduler._delete_marked_timespan_by_id(configuration);\n\t\t} else { // normal configuration was passed\n\n\t\t\tif(!(configuration.start_date && configuration.end_date)){\n\t\t\t\tif(configuration.days === undefined && !configuration.type)\n\t\t\t\t\tconfiguration.days = \"fullweek\";\n\t\t\t\tif(!configuration.zones)\n\t\t\t\t\tconfiguration.zones = \"fullday\";\n\t\t\t}\n\n\t\t\tvar types = [];\n\t\t\tif(!configuration.type){\n\t\t\t\t//if type not specified - delete timespans of all types\n\t\t\t\tfor(var type in scheduler._marked_timespans_types){\n\t\t\t\t\ttypes.push(type);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\ttypes.push(configuration.type);\n\t\t\t}\n\n\n\t\t\tvar configs = scheduler._prepare_timespan_options(configuration);\n\n\t\t\tfor (var i=0; i<configs.length; i++) {\n\n\t\t\t\tvar config = configs[i];\n\t\t\t\tfor( var t=0; t < types.length; t++){\n\t\t\t\t\tvar typedConfig = scheduler._lame_clone(config);\n\t\t\t\t\ttypedConfig.type = types[t];\n\t\t\t\t\tscheduler._delete_marked_timespan_by_config(typedConfig);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t};\n\tscheduler._get_types_to_render = function(common, specific) {\n\t\tvar types_to_render = (common) ? scheduler._lame_copy({},common) : {};\n\t\tfor (var type in specific||{} ) {\n\t\t\tif (specific.hasOwnProperty(type)) {\n\t\t\t\ttypes_to_render[type] = specific[type];\n\t\t\t}\n\t\t}\n\t\treturn types_to_render;\n\t};\n\tscheduler._get_configs_to_render = function(types) {\n\t\tvar configs = [];\n\t\tfor (var type in types) {\n\t\t\tif (types.hasOwnProperty(type)) {\n\t\t\t\tconfigs.push.apply(configs, types[type]);\n\t\t\t}\n\t\t}\n\t\treturn configs;\n\t};\n\n\tscheduler._on_scale_add_marker = function(area, day){\n\t\tif (scheduler._table_view && scheduler._mode != \"month\")\n\t\t\treturn;\n\n\t\tvar day_index = day.getDay();\n\t\tvar day_value = day.valueOf();\n\t\tvar mode = this._mode;\n\t\tvar timespans = scheduler._marked_timespans;\n\t\tvar r_configs = [];\n\t\tvar divs = [];\n\t\tif (this._props && this._props[mode]) { // we are in the units view and need to draw it's sections as well\n\t\t\tvar view = this._props[mode]; // units view object\n\t\t\tvar units = view.options;\n\t\t\tvar index = scheduler._get_unit_index(view, day);\n\t\t\tvar unit = units[index]; // key, label\n\n\t\t\tif(!(view.days > 1)){\n\t\t\t\tday = scheduler.date.date_part(new Date(this._date)); // for units view actually only 1 day is displayed yet the day variable will change, need to use this._date for all calls\n\t\t\t}else{\n\t\t\t\tvar dx = 24*60*60*1000;\n\t\t\t\tvar day_ind = Math.round((day - scheduler._min_date)/dx);\n\t\t\t\tvar unitsPerDay = view.size || units.length;\n\t\t\t\tday = scheduler.date.add(scheduler._min_date, Math.floor(day_ind/unitsPerDay), \"day\"); // to the \"same\" day for all sections\n\t\t\t\tday = scheduler.date.date_part(day);\n\t\t\t}\n\t\t\tday_index = day.getDay();\n\t\t\tday_value = day.valueOf();\n\n\t\t\tif (timespans[mode] && timespans[mode][unit.key]) {\n\t\t\t\tvar unit_zones = timespans[mode][unit.key];\n\t\t\t\tvar unit_types = scheduler._get_types_to_render(unit_zones[day_index], unit_zones[day_value]);\n\t\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(unit_types));\n\t\t\t}\n\t\t}\n\n\t\tvar global_data = timespans[\"global\"];\n\n\t\tif(scheduler.config.overwrite_marked_timespans){\n\t\t\tvar day_types = global_data[day_value]||global_data[day_index];\n\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(day_types));\n\t\t} else {\n\t\t\tif(global_data[day_value]){\n\t\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(global_data[day_value]));\n\t\t\t}\n\t\t\tif(global_data[day_index]){\n\t\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(global_data[day_index]));\n\t\t\t}\n\t\t}\n\n\t\tfor (var i=0; i<r_configs.length; i++) {\n\t\t\tdivs.push.apply(divs, (scheduler._render_marked_timespan(r_configs[i], area, day)));\n\t\t}\n\t\treturn divs;\n\t};\n\tscheduler.attachEvent(\"onScaleAdd\", function(){\n\t\tscheduler._on_scale_add_marker.apply(scheduler, arguments);\n\t});\n\n\tscheduler.dblclick_dhx_marked_timespan = function(e,src){\n\t\tscheduler.callEvent(\"onScaleDblClick\",[scheduler.getActionData(e).date,src,e]);\n\n\t\tif (scheduler.config.dblclick_create){\n\t\t\tscheduler.addEventNow(scheduler.getActionData(e).date,null,e);\n\t\t}\n\t};\n\n}","function createMethod(scheduler){\n\tvar methods = {};\n\tvar isActive = false;\n\tfunction disableMethod(methodName, dummyMethod){\n\t\tdummyMethod = typeof dummyMethod == \"function\" ? dummyMethod : function(){};\n\n\t\tif(!methods[methodName]){\n\t\t\tmethods[methodName] = this[methodName];\n\t\t\tthis[methodName] = dummyMethod;\n\t\t}\n\t}\n\tfunction restoreMethod(methodName){\n\t\tif(methods[methodName]){\n\t\t\tthis[methodName] = methods[methodName];\n\t\t\tmethods[methodName] = null;\n\t\t}\n\t}\n\tfunction disableMethods(methodsHash){\n\t\tfor(var i in methodsHash){\n\t\t\tdisableMethod.call(this, i, methodsHash[i]);\n\t\t}\n\t}\n\tfunction restoreMethods(){\n\t\tfor(var i in methods){\n\t\t\trestoreMethod.call(this, i);\n\t\t}\n\t}\n\n\tfunction batchUpdatePayload(callback){\n\t\ttry{\n\t\t\tcallback();\n\t\t}catch(e){\n\t\t\twindow.console.error(e);\n\t\t}\n\t}\n\n\tscheduler.$stateProvider.registerProvider(\"batchUpdate\", function(){\n\t\treturn {\n\t\t\tbatch_update: isActive\n\t\t};\n\t}, false);\n\n\treturn function batchUpdate(callback, noRedraw) {\n\t\tif(isActive){\n\t\t\t// batch mode is already active\n\t\t\tbatchUpdatePayload(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tvar call_dp = (this._dp && this._dp.updateMode != \"off\");\n\t\tvar dp_mode;\n\t\tif (call_dp){\n\t\t\tdp_mode = this._dp.updateMode;\n\t\t\tthis._dp.setUpdateMode(\"off\");\n\t\t}\n\n\t\t// temporary disable some methods while updating multiple events\n\n\t\tconst calls = {\n\t\t\tsetModeDate: {date: null, mode: null},\n\t\t\tneedRender: false,\n\t\t\tneedUpdateView: false,\n\t\t\trepaintEvents: {}\n\n\t\t};\n\n\t\tconst rememberModeDate = (date, mode) => {\n\t\t\tif(date){\n\t\t\t\tcalls.setModeDate.date = date;\n\t\t\t}\n\t\t\tif(mode){\n\t\t\t\tcalls.setModeDate.mode = mode;\n\t\t\t}\n\t\t};\n\n\t\tvar methods = {\n\t\t\trender:(date, mode) => {calls.needRender = true; rememberModeDate(date, mode);},\n\t\t\tsetCurrentView:(date, mode) => {calls.needRender = true; rememberModeDate(date, mode);},\n\t\t\tupdateView:(date, mode) => {calls.needUpdateView = true; rememberModeDate(date, mode);},\n\t\t\trender_data:() => calls.needRender = true,\n\t\t\trender_view_data:(evs) => { \n\t\t\t\tif(evs && evs.length){\n\t\t\t\t\tevs.forEach((e) => calls.repaintEvents[e.id] = true);\n\t\t\t\t}else{\n\t\t\t\t\tcalls.needRender = true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tdisableMethods.call(this, methods);\n\n\t\tisActive = true;\n\t\tthis.callEvent(\"onBeforeBatchUpdate\", []);\n\n\t\tbatchUpdatePayload(callback);\n\n\t\tthis.callEvent(\"onAfterBatchUpdate\", []);\n\n\t\trestoreMethods.call(this);\n\n\t\tisActive = false;\n\t\tif(!noRedraw){\n\t\t\tif(calls.needRender){\n\t\t\t\tscheduler.render(calls.setModeDate.date, calls.setModeDate.mode);\n\t\t\t}else if(calls.needUpdateView){\n\t\t\t\tscheduler.updateView(calls.setModeDate.date, calls.setModeDate.mode);\n\t\t\t}else{\n\t\t\t\tfor(const i in calls.repaintEvents){\n\t\t\t\t\tscheduler.updateEvent(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (call_dp) {\n\t\t\tthis._dp.setUpdateMode(dp_mode);\n\t\t\tthis._dp.sendData();\n\t\t}\n\t};\n}\n\nexport default function(scheduler){\n\tscheduler.batchUpdate = createMethod(scheduler);\n}","class t{constructor(t){const{url:e,token:s}=t;this._url=e,this._token=s,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Remote-Token\":this._token}}fetch(t,e){const s={credentials:\"include\",headers:this.headers()};return e&&(s.method=\"POST\",s.body=e),fetch(t,s).then(t=>t.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(t=>this.parse(t))}parse(t){const{key:e,websocket:s}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const s=this.api[e]={},i=t.api[e];for(const t in i)s[t]=this._wrapper(e+\".\"+t)}return s&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,s,i){let n=e;\"/\"===n[0]&&(n=document.location.protocol+\"//\"+document.location.host+e);n=n.replace(/^http(s|):/,\"ws$1:\");const o=-1!=n.indexOf(\"?\")?\"&\":\"?\";n=`${n}${o}token=${s}&ws=1`;const r=new WebSocket(n);return r.onclose=()=>setTimeout(()=>t.connect(),2e3),r.onmessage=e=>{const s=JSON.parse(e.data);switch(s.action){case\"result\":t.result(s.body,[]);break;case\"event\":t.fire(s.body.name,s.body.value);break;case\"start\":i();break;default:t.onError(s.data)}},r}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return function(){const e=[].slice.call(arguments);let s=null;const i=new Promise((i,n)=>{s={data:{id:this._uid(),name:t,args:e},status:1,resolve:i,reject:n},this._queue.push(s)});return this.onCall(s,i),3===this._mode?this._send(s):setTimeout(()=>this._send(),1),i}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout(()=>this._send(),100);const e=t?[t]:this._queue.filter(t=>1===t.status);if(!e.length)return;const s=e.map(t=>(t.status=2,t.data));3!==this._mode?this.fetch(this._url,JSON.stringify(s)).catch(t=>this.onError(t)).then(t=>this.result(t,s)):this._socket.send(JSON.stringify({action:\"call\",body:s}))}result(t,e){const s={};if(t)for(let e=0;e<t.length;e++)s[t[e].id]=t[e];else for(let t=0;t<e.length;t++)s[e[t].id]={id:e[t].id,error:\"Network Error\",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],i=s[e.data.id];i&&(this.onResponse(e,i),i.error?e.reject(i.error):e.resolve(i.data),this._queue.splice(t,1))}}on(t,e){const s=this._uid();let i=this._events[t];const n=!!i;return n||(i=this._events[t]=[]),i.push({id:s,handler:e}),n||3!=this._mode||this._socket.send(JSON.stringify({action:\"subscribe\",name:t})),{name:t,id:s}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"subscribe\",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"unsubscribe\",key:t}));return void(this._events={})}const{id:e,name:s}=t,i=this._events[s];if(i){const t=i.filter(t=>t.id!=e);t.length?this._events[s]=t:(delete this._events[s],3==this._mode&&this._socket.send(JSON.stringify({action:\"unsubscribe\",name:s})))}}fire(t,e){const s=this._events[t];if(s)for(let t=0;t<s.length;t++)s[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}export{t as Client};\n//# sourceMappingURL=remote.es6.js.map\n","import { Client } from \"remote-client\";\n\nexport default class RemoteEvents {\n\tprotected _remote: any;\n\tprotected _ready: Promise<any>;\n\n\tconstructor(url: string, token: string) {\n\t\tconst remote = new Client({\n\t\t\turl,\n\t\t\ttoken,\n\t\t});\n\n\t\t// temporary patch, as we do not want credentials\n\t\tremote.fetch = function (url: string, body?: BodyInit) {\n\t\t\tconst req: RequestInit = {\n\t\t\t\theaders: this.headers(),\n\t\t\t};\n\t\t\tif (body) {\n\t\t\t\treq.method = \"POST\";\n\t\t\t\treq.body = body;\n\t\t\t}\n\n\t\t\treturn fetch(url, req).then(res => res.json());\n\t\t};\n\n\t\tthis._ready = remote.load().then(back => (this._remote = back));\n\t}\n\n\tprotected ready() {\n\t\treturn this._ready;\n\t}\n\n\tprotected on(name: string | any, handler?: any) {\n\t\tthis.ready().then(back => {\n\t\t\tif (typeof name === \"string\") back.on(name, handler);\n\t\t\telse {\n\t\t\t\tfor (const key in name) {\n\t\t\t\t\tback.on(key, name[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","function createHandlers(scheduler) {\n\n\tfunction remoteUpdates(message) {\n\t\tif (!message || !message.event || !message.event.id) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(\"Invalid message format:\", message);\n\t\t\treturn;\n\t\t}\n\n\t\tconst { type, event } = message;\n\n\t\tif (scheduler._dp._in_progress[event.id]) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (type === \"add-event\") {\n\t\t\tfor (const id in scheduler._dp._in_progress) {\n\t\t\t\tif (scheduler._dp.getState(id) === \"inserted\") {\n\t\t\t\t\tscheduler._dp.attachEvent(\"onFullSync\", function () {\n\t\t\t\t\t\tif (!scheduler.getEvent(event.id)) {\n\t\t\t\t\t\t\tprocessUpdate(type, event);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { once: true });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprocessUpdate(type, event);\n\n\t}\n\n\tfunction processUpdate(type, event) {\n\t\tswitch (type) {\n\t\t\tcase \"add-event\":\n\t\t\t\thandleAddEvent(event);\n\t\t\t\tbreak;\n\t\t\tcase \"update-event\":\n\t\t\t\thandleUpdateEvent(event);\n\t\t\t\tbreak;\n\t\t\tcase \"delete-event\":\n\t\t\t\thandleDeleteEvent(event);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction ignore(code){\n\t\tif(scheduler._dp){\n\t\t\tscheduler._dp.ignore(code);\n\t\t}\n\t\telse {\n\t\t\tcode();\n\t\t}\n\t}\n\n\tfunction handleAddEvent(eventData) {\n\t\tif (scheduler.getEvent(eventData.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Event with ID ${eventData.id} already exists. Skipping add.`);\n\t\t\treturn;\n\t\t}\n\n\t\teventData.start_date = scheduler.templates.parse_date(eventData.start_date);\n\t\teventData.end_date = scheduler.templates.parse_date(eventData.end_date);\n\t\tif (eventData.original_start) {\n\t\t\teventData.original_start = scheduler.templates.parse_date(eventData.original_start);\n\t\t}\n\n\t\tignore(() => {\n\t\t\tscheduler.addEvent(eventData);\n\t\t});\n\n\t}\n\n\tfunction handleUpdateEvent(eventData) {\n\t\tconst sid = eventData.id;\n\n\t\tif (!scheduler.getEvent(sid)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Event with ID ${sid} does not exist. Skipping update.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst existingEvent = scheduler.getEvent(sid);\n\n\t\tignore(() => {\n\t\t\tfor (let key in eventData) {\n\t\t\t\tif (key !== \"start_date\" && key !== \"end_date\") {\n\t\t\t\t\texistingEvent[key] = eventData[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\texistingEvent.start_date = scheduler.templates.parse_date(eventData.start_date);\n\t\t\texistingEvent.end_date = scheduler.templates.parse_date(eventData.end_date);\n\t\t\tif (eventData.original_start) {\n\t\t\t\teventData.original_start = scheduler.templates.parse_date(eventData.original_start);\n\t\t\t}\n\t\t\tscheduler.callEvent(\"onEventChanged\", [sid, existingEvent]);\n\t\t\tscheduler.updateEvent(sid);\n\n\t\t\tif (sid !== eventData.id) {\n\t\t\t\tscheduler.changeEventId(sid, eventData.id);\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfunction handleDeleteEvent(eventData) {\n\t\tconst sid = eventData.id;\n\n\t\tif (!scheduler.getEvent(sid)) {\n\n\t\t\tif (eventData.event_pid) {\n\t\t\t\tignore(() => {\n\t\t\t\t\tscheduler.addEvent(eventData);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tconst event = scheduler.getEvent(sid);\n\n\t\t\tif (event) {\n\t\t\t\t// handle recurring event markers\n\t\t\t\tif (event.rec_type || event.rrule) {\n\t\t\t\t\tscheduler._roll_back_dates(event);\n\n\t\t\t\t\tconst markers = scheduler._get_rec_markers(sid);\n\t\t\t\t\tfor (const markerId in markers) {\n\t\t\t\t\t\tif (scheduler.getEvent(markerId)) {\n\t\t\t\t\t\t\tscheduler.deleteEvent(markerId, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// handle unsaved edits in the lightbox\n\t\t\t\tif (scheduler.getState().lightbox_id == sid) {\n\t\t\t\t\tthis._new_event = this._lightbox_id;\n\t\t\t\t\teventData.id = this._lightbox_id;\n\t\t\t\t\tthis._events[this._lightbox_id] = eventData;\n\t\t\t\t\tif (scheduler.callEvent(\"onLiveUpdateCollision\", [sid, null, \"delete\", eventData]) === false) {\n\t\t\t\t\t\t// abort deletion if collision handler prevents it\n\t\t\t\t\t\tscheduler.endLightbox(false, scheduler._lightbox);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// delete the event\n\t\t\t\tscheduler.deleteEvent(sid, true);\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\treturn {\n\t\tevents: remoteUpdates\n\t};\n}\n\nexport default createHandlers;","import dragHighlightPos from \"./drag_highlight_pos\";\nimport undoDelete from \"./undo_delete\";\nimport limit from \"./limit\";\nimport batchUpdate from \"./batch_update\";\nimport remoteEvents from \"./remote_events/index.js\";\n\nexport default function initPlugins(scheduler){\n    undoDelete(scheduler);\n    dragHighlightPos(scheduler);\n    limit(scheduler);\n    batchUpdate(scheduler);\n    remoteEvents(scheduler);\n}","export default function undoDelete(scheduler) {\n\tconst undoableDeletes = {};\n\tscheduler.attachEvent(\"onConfirmedBeforeEventDelete\", function (id) {\n\t\tundoableDeletes[id] = true;\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventDeleted\", function (id, ev) {\n\t\tif (undoableDeletes[id]) {\n\t\t\tdelete undoableDeletes[id];\n\t\t} else {\n\t\t\t// ignore 'deleteEvent' calls called with 'silent' flag\n\t\t\treturn;\n\t\t}\n\t\tlet deletedEvent = scheduler.copy(ev);\n\t\tif (scheduler.config.undo_deleted && !scheduler.getState().new_event) {\n\t\t\tscheduler.message({\n\t\t\t\ttext: `<div class=\"dhx_info_message\">\n                            <span class=\"undo_popup_text\">Event deleted</span>\n                            <button class=\"undo_button\" data-deleted-event-id=\"${ev.id}\">Undo</button>\n                        </div>`,\n\t\t\t\texpire: 10000,\n\t\t\t\ttype: \"popup_after_delete\",\n\t\t\t\tcallback: function (e) {\n\t\t\t\t\tlet undoBtn = e.target.closest(\n\t\t\t\t\t\t`[data-deleted-event-id=\"${ev.id}\"]`\n\t\t\t\t\t);\n\t\t\t\t\tif (undoBtn) {\n\t\t\t\t\t\t// GS-2578: case for recurring events with occurences \n\t\t\t\t\t\tif (deletedEvent.rrule && deletedEvent.duration) {\n\t\t\t\t\t\t\tdeletedEvent.end_date = new Date(deletedEvent.start_date.valueOf() + deletedEvent.duration * 1000);\n\t\t\t\t\t\t\tscheduler.addEvent(deletedEvent);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscheduler.addEvent(deletedEvent);\n\t\t\t\t\t\tscheduler.render();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n}\n","import RemoteEvents from \"./remote_events\";\nimport createHandlers from \"./handlers\";\n\nexport default function remoteEvents(scheduler) {\n\tif (!scheduler.ext){\n\t\tscheduler.ext = {};\n\t}\n\n\tscheduler.ext.liveUpdates = {\n\t\tRemoteEvents,\n\t\tremoteUpdates: createHandlers(scheduler)\n\t};\n}\n\n","var uidSeed = Date.now();\nfunction uid () {\n\treturn uidSeed++;\n}\n\n// iframe-safe array type check instead of using instanceof\nfunction isArray(obj){\n\tif(Array.isArray){\n\t\treturn Array.isArray(obj);\n\t}else{\n\t\t// close enough\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\n\t}\n}\n\n// non-primitive string object, e.g. new String(\"abc\")\nfunction isStringObject(obj){\n\treturn obj && typeof obj === \"object\" && \n\t\tFunction.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Number(5)\nfunction isNumberObject(obj){\n\treturn obj && typeof obj === \"object\" && \n\t\tFunction.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Boolean(true)\nfunction isBooleanObject(obj){\n\treturn obj && typeof obj === \"object\" &&\n\t\tFunction.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\n}\n\nfunction isDate(obj) {\n\tif (obj && typeof obj === \"object\") {\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction defined(obj) {\n\treturn typeof(obj) != \"undefined\";\n}\n\nfunction delay (callback, timeout){\n\tvar timer;\n\n\tvar result = function() {\n\t\tresult.$cancelTimeout();\n\t\tresult.$pending = true;\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\ttimer = setTimeout(function(){\n\t\t\tcallback.apply(this, args);\n\t\t\tresult.$pending = false;\n\t\t}, timeout);\n\t};\n\n\tresult.$pending = false;\n\tresult.$cancelTimeout = function(){\n\t\tclearTimeout(timer);\n\t\tresult.$pending = false;\n\t};\n\tresult.$execute = function(){\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\tcallback.apply(this, args);\n\t\tresult.$cancelTimeout();\n\t};\n\n\treturn result;\n}\n\nexport default {\n\tuid: uid,\n\tmixin: function mixin (target, source, force){\n\t\tfor (var f in source)\n\t\t\tif (((target[f] === undefined) || force)) target[f]=source[f];\n\t\treturn target;\n\t},\n\tcopy: function copy(object) {\n\t\tvar i, result; // iterator, types array, result\n\t\n\t\tif (object && typeof object == \"object\") {\n\t\n\t\t\tswitch (true){\n\t\t\t\tcase (isDate(object)):\n\t\t\t\t\tresult = new Date(object);\n\t\t\t\t\tbreak;\n\t\t\t\tcase (isArray(object)):\n\t\t\t\t\tresult = new Array(object.length);\n\t\t\t\t\tfor(i = 0; i < object.length; i++){\n\t\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase (isStringObject(object)):\n\t\t\t\t\tresult = new String(object);// jshint ignore:line\n\t\t\t\t\tbreak;\n\t\t\t\tcase (isNumberObject(object)):\n\t\t\t\t\tresult = new Number(object);// jshint ignore:line\n\t\t\t\t\tbreak;\n\t\t\t\tcase (isBooleanObject(object)):\n\t\t\t\t\tresult = new Boolean(object);// jshint ignore:line\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tresult = {};\n\t\t\t\t\tfor (i in object) {\n\t\t\t\t\t\tconst varType = typeof object[i];\n\n\t\t\t\t\t\tif (varType === \"string\" || varType === \"number\" || varType === \"boolean\" ) {\n\t\t\t\t\t\t\tresult[i] = object[i];\n\t\t\t\t\t\t} else if(isDate(object[i])){\n\t\t\t\t\t\t\tresult[i] = new Date(object[i]);\n\t\t\t\t\t\t}else if (Object.prototype.hasOwnProperty.apply(object, [i]))\n\t\t\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn result || object;\n\t},\n\tdefined,\n\tisDate,\n\tdelay\n};\n","export default function extend(scheduler) {\n\nfunction div(className){\n\tvar element = document.createElement(\"div\");\n\tvar classes = (className || \"\").split(\" \");\n\tclasses.forEach(function(cssClass){\n\t\telement.classList.add(cssClass);\n\t});\n\treturn element;\n}\nvar itemTypes = {\n\trows_container: function(){\n\t\treturn div(\"dhx_cal_navbar_rows_container\");\n\t},\n\trow: function(){\n\t\treturn div(\"dhx_cal_navbar_row\");\n\t},\n\tview: function (config) {\n\t\tvar element = div(\"dhx_cal_tab\");\n\t\telement.setAttribute(\"name\", config.view + \"_tab\");\n\t\telement.setAttribute(\"data-tab\", config.view);\n\t\t// element.setAttribute(\"data-viewname\", config.view); // FIXME: need to remove? not used anywhere\n\t\tif(scheduler.config.fix_tab_position){\n\t\t\tif(config.$firstTab) {\n\t\t\t\telement.classList.add(\"dhx_cal_tab_first\");\n\t\t\t}else if(config.$lastTab) {\n\t\t\t\telement.classList.add(\"dhx_cal_tab_last\");\n\t\t\t} else if(config.view !== \"week\") {\n\t\t\t\telement.classList.add(\"dhx_cal_tab_standalone\");\n\t\t\t}\n\n\t\t\tif(config.$segmentedTab) {\n\t\t\t\telement.classList.add(\"dhx_cal_tab_segmented\");\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t},\n\tdate: function () {\n\t\treturn div(\"dhx_cal_date\");\n\t},\n\tbutton: function (config) {\n\t\treturn div(\"dhx_cal_nav_button dhx_cal_nav_button_custom dhx_cal_tab\");\n\t},\n\tbuiltInButton: function (config){\n\t\treturn div(\"dhx_cal_\" + config.view + \"_button dhx_cal_nav_button\");\n\t},\n\tspacer: function () {\n\t\treturn div(\"dhx_cal_line_spacer\");\n\t},\n\tminicalendarButton: function(config){\n\t\tvar minicalendarDiv = div('dhx_minical_icon');\n\t\tif(!config.click && !minicalendarDiv.$_eventAttached){\n\t\t\t\n\t\t\tscheduler.event(minicalendarDiv, \"click\", function () {\n\t\t\t\tif (scheduler.isCalendarVisible()) {\n\t\t\t\t\tscheduler.destroyCalendar();\n\t\t\t\t} else {\n\t\t\t\t\tscheduler.renderCalendar({\n\t\t\t\t\t\tposition: this,\n\t\t\t\t\t\tdate: scheduler.getState().date,\n\t\t\t\t\t\tnavigation: true,\n\t\t\t\t\t\thandler: function (date, calendar) {\n\t\t\t\t\t\t\tscheduler.setCurrentView(date);\n\t\t\t\t\t\t\tscheduler.destroyCalendar();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn minicalendarDiv;\n\t},\n\thtml_element: function (config) {\n\t\treturn div(\"dhx_cal_nav_content\");\n\t}\n};\n\nfunction findRenderer(config) {\n\tvar renderer;\n\tif (config.view) {\n\t\tswitch (config.view){\n\t\t\tcase \"today\":\n\t\t\tcase \"next\":\n\t\t\tcase \"prev\":\n\t\t\t\trenderer = itemTypes.builtInButton;\n\t\t\t\tbreak;\n\t\t\tcase \"date\":\n\t\t\t\trenderer = itemTypes.date;\n\t\t\t\tbreak;\n\t\t\tcase \"spacer\":\n\t\t\t\trenderer = itemTypes.spacer;\n\t\t\t\tbreak;\n\t\t\tcase \"button\":\n\t\t\t\trenderer = itemTypes.button;\n\t\t\t\tbreak;\n\t\t\tcase \"minicalendar\":\n\t\t\t\trenderer = itemTypes.minicalendarButton;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\trenderer = itemTypes.view;\n\t\t\t\tbreak;\n\t\t}\n\t} else if(config.rows) {\n\t\trenderer = itemTypes.rows_container;\n\t} else if(config.cols) {\n\t\trenderer = itemTypes.row;\n\t}\n\treturn renderer;\n}\n\nfunction renderElement(config){\n\tvar renderer = findRenderer(config);\n\tif(!renderer){\n\t\treturn;\n\t}\n\tvar element = renderer(config);\n\tif(config.css){\n\t\telement.classList.add(config.css);\n\t}\n\tif(config.width){\n\t\tvar value = config.width;\n\t\tif(value === value * 1){\n\t\t\tvalue += \"px\";\n\t\t}\n\t\telement.style.width = value;\n\t}\n\tif(config.height){\n\t\tvar value = config.height;\n\t\tif(value === value * 1){\n\t\t\tvalue += \"px\";\n\t\t}\n\t\telement.style.height = value;\n\t}\n\tif (config.click) {\n\t\tscheduler.event(element, \"click\", config.click);\n\t}\n\tif (config.html) {\n\t\telement.innerHTML = config.html;\n\t}\n\n\tif (config.align) {\n\t\tvar value = \"\";\n\t\tif (config.align == \"right\") {\n\t\t\tvalue = \"flex-end\";\n\t\t} else if(config.align == \"left\") {\n\t\t\tvalue = \"flex-start\";\n\t\t}\n\t\telement.style.justifyContent = value;\n\t}\n\treturn element;\n}\n\nfunction prepareConfig(config) {\n\tif (typeof config === \"string\") {\n\t\tconfig = {\n\t\t\tview: config\n\t\t};\n\t}\n\tif (!config.view && !config.rows && !config.cols) {\n\t\tconfig.view = \"button\";\n\t}\n\treturn config;\n}\n\nfunction renderLayout(config) {\n\tvar fragment = document.createDocumentFragment();\n\tvar items;\n\tif(Array.isArray(config)){\n\t\titems = config;\n\t}else{\n\t\titems = [config];\n\t}\n\n\tfor (var i = 0; i < items.length; i++) {\n\t\tvar view = prepareConfig(items[i]);\n\n\t\tif(view.view === \"day\" && items[i + 1]){\n\t\t\tvar next = prepareConfig(items[i + 1]);\n\t\t\tif(next.view === \"week\" || next.view === \"month\"){\n\t\t\t\tview.$firstTab = true;\n\t\t\t\tview.$segmentedTab = true;\n\t\t\t}\n\t\t}\n\n\t\tif(view.view === \"week\" && items[i - 1]){\n\t\t\tvar next = prepareConfig(items[i + 1]);\n\t\t\tif(next.view === \"week\" || next.view === \"month\"){\n\t\t\t\tview.$segmentedTab = true;\n\t\t\t}\n\t\t}\n\n\t\tif(view.view === \"month\" && items[i - 1]){\n\t\t\tvar next = prepareConfig(items[i - 1]);\n\t\t\tif(next.view === \"week\" || next.view === \"day\"){\n\t\t\t\tview.$lastTab = true;\n\t\t\t\tview.$segmentedTab = true;\n\t\t\t}\n\t\t}\n\n\t\tvar element = renderElement(view);\n\n\t\tfragment.appendChild(element);\n\t\tif(view.cols || view.rows){\n\t\t\telement.appendChild(renderLayout(view.cols || view.rows));\n\t\t}\n\t}\n\treturn fragment;\n}\n\nscheduler._init_nav_bar = function (items) {\n\tvar navBar = this.$container.querySelector(\".dhx_cal_navline\");\n\tif (!navBar){\n\t\tnavBar = document.createElement(\"div\");\n\t\tnavBar.className = \"dhx_cal_navline dhx_cal_navline_flex\";\n\t\tscheduler._update_nav_bar(items, navBar);\n\t\treturn navBar;\n\t}\n\treturn navBar;\n};\n\nvar previousNavbar = null;\nvar previousHeight = null;\nscheduler._update_nav_bar = function (config, container) {\n\n\tif(!config){\n\t\treturn;\n\t}\n\tvar heightChanged = false;\n\tvar configChanged = false;\n\n\tvar newHeight = config.height || scheduler.xy.nav_height;\n\n\tif(previousHeight === null ||\n\t\t\t(previousHeight !== newHeight)){\n\t\theightChanged = true;\n\t}\n\tif(!previousNavbar || JSON.stringify(config) !== previousNavbar){\n\t\tconfigChanged = true;\n\t}\n\n\tif(heightChanged){\n\t\tscheduler.xy.nav_height = newHeight;\n\t}\n\tif(configChanged){\n\t\tcontainer.innerHTML = \"\";\n\t\tcontainer.appendChild(renderLayout(config));\n\t}\n\n\tif(heightChanged || configChanged){\n\t\tscheduler.unset_actions();\n\t\tscheduler._els = [];\n\t\tscheduler.get_elements();\n\t\tscheduler.set_actions();\n\t}\n\n\tif(newHeight === 0){\n\t\tcontainer.style.display = \"none\";\n\t}else{\n\t\tcontainer.style.display = \"\";\n\t}\n\n\tpreviousHeight = newHeight;\n};\n\n}","export default function extend(scheduler) {\n\n\tfunction isAttachedNode(container){\n\t\tif(container.isConnected !== undefined){\n\t\t\treturn container.isConnected;\n\t\t}\n\t\treturn document.body.contains(container);\n\t}\n\t\n\tfunction getWindowSize(window){\n\t\treturn {\n\t\t\tw : window.innerWidth || document.documentElement.clientWidth,\n\t\t\th : window.innerHeight || document.documentElement.clientHeight\n\t\t};\n\t}\n\tfunction equals(a,b){\n\t\treturn a.w == b.w && a.h == b.h;\n\t}\n\t\n\tfunction listenWindowResize(scheduler, window){\n\t\tvar oldSize = getWindowSize(window);\n\t\tvar resizeDelay;\n\t\tscheduler.event(window, \"resize\", function(){\n\t\t\tclearTimeout(resizeDelay);\n\t\t\tresizeDelay = setTimeout(function(){\n\n\t\t\t\tif (!isAttachedNode(scheduler.$container) || scheduler.$destroyed){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar newSize = getWindowSize(window);\n\t\t\t\t// element may be resized by container-autoresize exteinsion\n\t\t\t\t// check if the size is actually changed in order to not to get endless loop\n\t\t\t\tif (!equals(oldSize, newSize)) {\n\t\t\t\t\toldSize = newSize;\n\t\t\t\t\ttriggerSchedulerResize(scheduler);\n\t\t\t\t}\n\t\t\t}, 150);\n\t\t});\n\t}\n\t\n\tfunction triggerSchedulerResize(scheduler){\n\t\tif(!scheduler.$initialized || scheduler.$destroyed || !scheduler.$root || !isAttachedNode(scheduler.$root)){\n\t\t\treturn;\t\n\t\t}\n\t\tif (scheduler.callEvent(\"onSchedulerResize\", [])) {\n\t\t\tscheduler.updateView();\n\t\t\tscheduler.callEvent(\"onAfterSchedulerResize\", []);\n\t\t}\n\t}\n\t\n\tfunction watchNodeResize(scheduler){\n\t\tvar previousHeight = scheduler.$root.offsetHeight;\n\t\tvar previousWidth = scheduler.$root.offsetWidth;\n\t\t\n\t\tfunction lowlevelResizeWatcher(){\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn;\t\n\t\t\t}\n\t\t\t\n\t\t\tif(scheduler.$root){\n\t\t\t\tif (scheduler.$root.offsetHeight != previousHeight ||\n\t\t\t\t\tscheduler.$root.offsetWidth != previousWidth){\n\t\t\t\t\ttriggerSchedulerResize(scheduler);\n\t\t\t\t}\n\t\n\t\t\t\tpreviousHeight = scheduler.$root.offsetHeight;\n\t\t\t\tpreviousWidth = scheduler.$root.offsetWidth;\n\t\t\t}\n\t\n\t\t\tsetTimeout(lowlevelResizeWatcher, 200);\n\t\t}\n\t\t\n\t\tlowlevelResizeWatcher();\n\t}\n\t\n\tfunction addResizeListener(scheduler){\n\t\tvar root = scheduler.$container;\n\t\tvar containerStyles = window.getComputedStyle(root);\n\t\tif(containerStyles.getPropertyValue(\"position\") == \"static\"){\n\t\t\troot.style.position = \"relative\";\n\t\t}\n\n\t\tif(window.ResizeObserver){\n\t\t\tlet skipFirst = true;// initial repaint triggers the resize listener\n\t\t\tconst resizeObserver = new ResizeObserver(function(entries){\n\t\t\t\tif(skipFirst){\n\t\t\t\t\tskipFirst = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttriggerSchedulerResize(scheduler);\n\t\t\t});\n\t\t\tresizeObserver.observe(root);\n\t\t\tscheduler.attachEvent(\"onDestroy\", function(){\n\t\t\t\tresizeObserver.unobserve(root);\n\t\t\t});\n\t\t}else {\n\t\t\tvar resizeWatcher = document.createElement('iframe');\n\t\t\tresizeWatcher.className = \"scheduler_container_resize_watcher\";\n\t\t\tresizeWatcher.tabIndex = -1;\n\t\t\tif(scheduler.config.wai_aria_attributes){\n\t\t\t\tresizeWatcher.setAttribute(\"role\", \"none\");\n\t\t\t\tresizeWatcher.setAttribute(\"aria-hidden\", true);\n\t\t\t}\n\t\t\n\t\t\t// in some environments (namely, in SalesForce) iframe.contentWindow is not available\n\t\t\tvar salesforce_environment = !!window[\"Sfdc\"] || !!window[\"$A\"] || window[\"Aura\"];\n\t\t\tif(salesforce_environment){\n\t\t\t\twatchNodeResize(scheduler);\n\t\t\t} else {\n\t\t\t\troot.appendChild(resizeWatcher);\n\t\t\t\tif (resizeWatcher.contentWindow) {\n\t\t\t\t\tlistenWindowResize(scheduler, resizeWatcher.contentWindow);\n\t\t\t\t} else {\n\t\t\t\t\t// if so - ditch the iframe and fallback to listening the main window resize\n\t\t\t\t\troot.removeChild(resizeWatcher);\n\t\t\t\t\tlistenWindowResize(scheduler, window);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\n\t}\n\t\n\taddResizeListener(scheduler);\n\n}","class EventHost {\n\tconstructor(){\n\t\tthis._silent_mode = false;\n\t\tthis.listeners = {};\n\t}\n\t_silentStart(){\n\t\tthis._silent_mode = true;\n\t}\n\t_silentEnd() {\n\t\tthis._silent_mode = false;\n\t}\n}\n\nconst createEventStorage = function(obj) {\n\tlet handlers = {};\n\tlet index = 0;\n\tconst eventStorage = function(){\n\t\tlet combinedResult = true;\n\t\tfor(const i in handlers){\n\t\t\tconst handlerResult = handlers[i].apply(obj, arguments);\n\t\t\tcombinedResult=combinedResult && handlerResult;\n\t\t}\n\t\treturn combinedResult;\n\t};\n\teventStorage.addEvent=function(handler, settings){\n\t\tif (typeof (handler) == \"function\"){\n\t\t\tlet handlerId;\n\t\t\tif(settings && settings.id){\n\t\t\t\thandlerId = settings.id;\n\t\t\t}else{\n\t\t\t\thandlerId = index;\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\tif(settings && settings.once){\n\t\t\t\tconst originalHandler = handler;\n\t\t\t\thandler = function(){\n\t\t\t\t\toriginalHandler();\n\t\t\t\t\teventStorage.removeEvent(handlerId);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\thandlers[handlerId] = handler;\n\t\t\treturn handlerId;\n\t\t}\n\t\treturn false;\n\t};\n\teventStorage.removeEvent=function(id){\n\t\tdelete handlers[id];\n\t};\n\n\teventStorage.clear = function(){\n\t\thandlers = {};\n\t};\n\n\treturn eventStorage;\n};\n\nfunction makeEventable(obj){\n\n\tconst eventHost = new EventHost();\n\tobj.attachEvent=function(eventName, handler, settings){\n\t\teventName = 'ev_'+eventName.toLowerCase();\n\t\tif (!eventHost.listeners[eventName]){\n\t\t\teventHost.listeners[eventName] = createEventStorage(this);\n\t\t}\n\n\t\tif(settings && settings.thisObject){\n\t\t\thandler = handler.bind(settings.thisObject);\n\t\t}\n\n\t\tconst innerId = eventHost.listeners[eventName].addEvent(handler, settings);\n\n\t\tlet handlerId = (eventName+':'+innerId); //return ID (ev_eventname:1)\n\t\tif(settings && settings.id){\n\t\t\thandlerId = settings.id;\n\t\t}\n\t\treturn handlerId;\n\t};\n\n\tobj.attachAll = function(callback){\n\t\tthis.attachEvent('listen_all', callback);\n\t};\n\n\tobj.callEvent=function(name, eventArguments){\n\t\tif (eventHost._silent_mode) return true;\n\n\t\tconst handlerName = 'ev_'+name.toLowerCase();\n\n\t\tconst listeners = eventHost.listeners;\n\t\tif (listeners['ev_listen_all']){\n\t\t\tlisteners['ev_listen_all'].apply(this, [name].concat(eventArguments));\n\t\t}\n\n\t\tif (listeners[handlerName])\n\t\t\treturn listeners[handlerName].apply(this, eventArguments);\n\t\treturn true;\n\t};\n\n\tobj.checkEvent=function(name){\n\t\tconst listeners = eventHost.listeners;\n\t\treturn (!!listeners['ev_'+name.toLowerCase()]);\n\t};\n\n\tobj.detachEvent=function(id){\n\t\tif (id){\n\t\t\tlet listeners = eventHost.listeners;\n\t\t\tfor(const i in listeners){\n\t\t\t\tlisteners[i].removeEvent(id); //remove event\n\t\t\t}\n\n\t\t\tconst list = id.split(':');//get EventName and ID\n\t\t\tlisteners = eventHost.listeners;\n\t\t\tif(list.length === 2){\n\t\t\t\tconst eventName = list[0];\n\t\t\t\tconst eventId = list[1];\n\t\t\t\tif(listeners[eventName]){\n\t\t\t\t\tlisteners[eventName].removeEvent(eventId); //remove event\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tobj.detachAllEvents = function(){\n\t\tfor (const name in eventHost.listeners) {\n\t\t\teventHost.listeners[name].clear();\n\t\t}\n\t};\n\n}\n\nexport default makeEventable;","export default {\n\tevent: function (el, event, handler){\n\t\tif (el.addEventListener)\n\t\t\tel.addEventListener(event, handler, false);\n\t\n\t\telse if (el.attachEvent)\n\t\t\tel.attachEvent(\"on\"+event, handler);\n\t},\n\teventRemove: function (el, event, handler){\n\t\tif (el.removeEventListener)\n\t\t\tel.removeEventListener(event, handler, false);\n\t\n\t\telse if (el.detachEvent)\n\t\t\tel.detachEvent(\"on\"+event, handler);\n\t}\n};","import createEventScope from './utils/scoped_event';\n\nexport default function extend(scheduler) {\n\n\nvar domEvents = createEventScope();\n\nscheduler.event = domEvents.attach;\nscheduler.eventRemove = domEvents.detach;\nscheduler._eventRemoveAll = domEvents.detachAll;\nscheduler._createDomEventScope = domEvents.extend;\n\n\nscheduler._trim = function(str){\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\n\treturn func.apply(str);\n};\n\nscheduler._isDate = function(obj){\n\tif (obj && typeof obj == \"object\") {\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\n\t} else {\n\t\treturn false;\n\t}\n};\n\nscheduler._isObject = function(obj){\n\treturn (obj && typeof obj == \"object\");\n};\n\n}","import defaultDomEvents from './event';\n\nexport default function(){\n\n\tvar domEvents = function (addEvent, removeEvent) {\n\t\taddEvent = addEvent || defaultDomEvents.event;\n\t\tremoveEvent = removeEvent || defaultDomEvents.eventRemove;\n\t\tvar handlers = [];\n\t\tvar eventScope = {\n\t\t\tattach: function(el, event, callback, capture){\n\t\t\t\thandlers.push({element: el, event:event, callback: callback, capture: capture});\n\t\t\t\taddEvent(el, event, callback, capture);\n\t\t\t},\n\t\t\tdetach: function(el, event, callback, capture){\n\t\t\t\tremoveEvent(el, event, callback, capture);\n\t\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\t\tvar handler = handlers[i];\n\t\t\t\t\tif (handler.element === el && handler.event === event && handler.callback === callback && handler.capture === capture) {\n\t\t\t\t\t\thandlers.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdetachAll: function () {\n\t\t\t\tvar staticArray = handlers.slice();\n\t\t\t\t// original handlers array can be spliced on every iteration\n\t\t\t\tfor (var i = 0; i < staticArray.length; i++){\n\t\t\t\t\tvar handler = staticArray[i];\n\t\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, handler.capture);\n\t\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, undefined);\n\t\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, false);\n\t\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, true);\n\t\t\t\t}\n\t\t\t\thandlers.splice(0, handlers.length);\n\t\t\t},\n\t\t\textend: function(){\n\t\t\t\treturn domEvents(this.event, this.eventRemove);\n\t\t\t}\n\t\t};\n\t\treturn eventScope;\n\t};\n\t\n\treturn domEvents();\n}","//returns position of html element on the page\nfunction elementPosition(elem) {\n\tvar top=0, left=0, right=0, bottom=0;\n\tif (elem.getBoundingClientRect) { //HTML5 method\n\t\tvar box = elem.getBoundingClientRect();\n\t\tvar body = document.body;\n\t\tvar docElem = (document.documentElement ||\n\t\t\tdocument.body.parentNode ||\n\t\t\tdocument.body);\n\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\t\ttop  = box.top +  scrollTop - clientTop;\n\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\tright = document.body.offsetWidth - box.right;\n\t\tbottom = document.body.offsetHeight - box.bottom;\n\t} else { //fallback to naive approach\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\n\t}\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\n}\n\n/*\nevent position relatively to DOM element\n */\nfunction getRelativeEventPosition(ev, node){\n\tvar d = document.documentElement;\n\tvar box = elementPosition(node);\n\n\treturn {\n\t\tx: ev.clientX - d.clientLeft - box.x + node.scrollLeft,\n\t\ty: ev.clientY - d.clientTop - box.y + node.scrollTop\n\t};\n}\n\nfunction getNodePosition(elem) {\n\tvar top=0, left=0, right=0, bottom=0;\n\tif (elem.getBoundingClientRect) { //HTML5 method\n\t\tvar box = elem.getBoundingClientRect();\n\t\tvar body = document.body;\n\t\tvar docElem = (document.documentElement ||\n\t\t\tdocument.body.parentNode ||\n\t\t\tdocument.body);\n\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\t\ttop  = box.top +  scrollTop - clientTop;\n\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\tright = document.body.offsetWidth - box.right;\n\t\tbottom = document.body.offsetHeight - box.bottom;\n\t} else { //fallback to naive approach\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\n\t}\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\n}\n\nfunction getClassName(node){\n\tif(!node) return \"\";\n\n\tvar className = node.className || \"\";\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\n\t\tclassName = className.baseVal;\n\n\tif(!className.indexOf)\n\t\tclassName = '';\n\n\treturn className || \"\";\n}\n\nfunction getTargetNode(e) {\n\tvar trg;\n\tif (e.tagName)\n\t\ttrg = e;\n\telse {\n\t\te = e || window.event;\n\t\ttrg = e.target || e.srcElement;\n\t\tif (trg.shadowRoot && e.composedPath) {\n\t\t\ttrg = e.composedPath()[0];\n\t\t}\n\t}\n\treturn trg;\n}\n\nfunction locateCss(e, classname, strict){\n\tif(strict === undefined)\n\t\tstrict = true;\n\n\tvar trg = e.target || e.srcElement;\n\tvar css = '';\n\n\twhile (trg){\n\t\tcss = getClassName(trg);\n\n\t\tif(css){\n\t\t\tvar ind = css.indexOf(classname);\n\t\t\tif (ind >= 0){\n\t\t\t\tif (!strict)\n\t\t\t\t\treturn trg;\n\n\t\t\t\t//check that we have exact match\n\t\t\t\tvar left = (ind === 0) || (!((css.charAt(ind - 1)||\"\").trim()));\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!((css.charAt(ind + classname.length)).trim()));\n\n\t\t\t\tif (left && right)\n\t\t\t\t\treturn trg;\n\t\t\t}\n\t\t}\n\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\n\n// get focusable nodes\nfunction isVisible(node){\n\tvar display = false,\n\t\tvisibility = false;\n\tif(window.getComputedStyle){\n\t\tvar style = window.getComputedStyle(node, null);\n\t\tdisplay = style[\"display\"];\n\t\tvisibility = style[\"visibility\"];\n\t}else if(node.currentStyle){\n\t\tdisplay = node.currentStyle[\"display\"];\n\t\tvisibility = node.currentStyle[\"visibility\"];\n\t}\n\n\tvar hiddenSection = false;\n\tvar recurringSection = locateCss({target:node}, \"dhx_form_repeat\", false);\n\tif(recurringSection){\n\t\thiddenSection = !!(recurringSection.style.height == \"0px\");\n\t}\n\thiddenSection = hiddenSection || !(node.offsetHeight);\n\n\treturn (display != \"none\" && visibility != \"hidden\" && !hiddenSection);\n}\n\nfunction hasNonNegativeTabIndex(node){\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\n}\n\nfunction hasHref(node){\n\tvar canHaveHref = {\"a\": true, \"area\": true};\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\n\t\treturn !!node.getAttribute(\"href\");\n\t}\n\treturn true;\n}\n\nfunction isEnabled(node){\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\n\tif(canDisable[node.nodeName.toLowerCase()]){\n\t\treturn !node.hasAttribute(\"disabled\");\n\t}\n\n\treturn true;\n}\n\n\nfunction getFocusableNodes(root){\n\tvar nodes = root.querySelectorAll([\n\t\t\"a[href]\",\n\t\t\"area[href]\",\n\t\t\"input\",\n\t\t\"select\",\n\t\t\"textarea\",\n\t\t\"button\",\n\t\t\"iframe\",\n\t\t\"object\",\n\t\t\"embed\",\n\t\t\"[tabindex]\",\n\t\t\"[contenteditable]\"\n\t].join(\", \"));\n\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tnodesArray[i].$position = i;\n\t\t// we remember original nodes order, \n\t\t// so when we sort them by tabindex we ensure order of nodes with same tabindex is preserved, \n\t\t// since some browsers do unstable sort\n\t}\n\t\n\tnodesArray.sort(function(a, b) {\n\t\tif(a.tabIndex === 0 && b.tabIndex !== 0){\n\t\t\treturn 1;\n\t\t}\n\t\tif(a.tabIndex !== 0 && b.tabIndex === 0){\n\t\t\treturn -1;\n\t\t}\n\t\t\n\t\tif (a.tabIndex === b.tabIndex){\n\t\t\t// ensure we do stable sort\n\t\t\treturn a.$position - b.$position;\n\t\t}\n\t\tif (a.tabIndex < b.tabIndex) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 1;\n\t});\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tvar node = nodesArray[i];\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\n\t\tif(!isValid){\n\t\t\tnodesArray.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\treturn nodesArray;\n}\n\n\nfunction isShadowDomSupported() {\n\treturn document.head.createShadowRoot || document.head.attachShadow;\n}\n\n/**\n * Returns element that has the browser focus, or null if no element has focus.\n * Works with shadow DOM, so it's prefereed to use this function instead of document.activeElement directly.\n * @returns HTMLElement\n */\nfunction getActiveElement(){\n\tvar activeElement = document.activeElement;\n\tif (activeElement.shadowRoot) {\n\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t}\n\tif (activeElement === document.body && document.getSelection) {\n\t\tactiveElement = document.getSelection().focusNode || document.body;\n\t}\n\n\treturn activeElement;\n}\n\n/**\n * Returns document.body or the host node of the ShadowRoot, if the element is attached to ShadowDom\n * @param {HTMLElement} element \n * @returns HTMLElement\n */\nfunction getRootNode(element) {\n\tif (!element) {\n\t\treturn document.body;\n\t}\n\tif (!isShadowDomSupported()) {\n\t\treturn document.body;\n\t}\n\twhile (element.parentNode && (element = element.parentNode)) {\n\t\tif (element instanceof ShadowRoot) {\n\t\t\treturn element.host;\n\t\t}\n\t}\n\treturn document.body;\n}\n\nfunction hasShadowParent(element) {\n\treturn !!getRootNode(element);\n}\n\nexport default {\n\t/**\n\t *     @desc: Calculate absolute position of html object\n\t *     @type: private\n\t *     @param: htmlObject - html object\n\t *     @topic: 0\n\t */\n\tgetAbsoluteLeft: function getAbsoluteLeft(htmlObject){\n\t\treturn this.getOffset(htmlObject).left;\n\t},\n\t/**\n\t *     @desc: Calculate absolute position of html object\n\t *     @type: private\n\t *     @param: htmlObject - html object\n\t *     @topic: 0\n\t */\n\tgetAbsoluteTop: function getAbsoluteTop(htmlObject){\n\t\treturn this.getOffset(htmlObject).top;\n\t},\n\n\tgetOffsetSum: function getOffsetSum(elem) {\n\t\tvar top=0, left=0;\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop);\n\t\t\tleft = left + parseInt(elem.offsetLeft);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\t\treturn {top: top, left: left};\n\t},\n\n\tgetOffsetRect: function getOffsetRect(elem) {\n\t\tvar box = elem.getBoundingClientRect();\n\n\t\tvar top = 0,\n\t\t\tleft = 0;\n\n\t\t// https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent#Mobile_Tablet_or_Desktop\n\t\tif (!/Mobi/.test(navigator.userAgent)) {\n\t\t\tvar body = document.body;\n\t\t\tvar docElem = document.documentElement;\n\t\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\n\t\t\ttop  = box.top +  scrollTop - clientTop;\n\t\t\tleft = box.left + scrollLeft - clientLeft;\n\t\t}else {\n\t\t\t// incorrect left coordinate on mobile zoom\n\t\t\t// https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n\n\t\t\tvar dummy = document.createElement(\"div\");\n\t\t\tdummy.style.position=\"absolute\";\n\t\t\tdummy.style.left=\"0px\";\n\t\t\tdummy.style.top=\"0px\";\n\t\t\tdummy.style.width=\"1px\";\n\t\t\tdummy.style.height = \"1px\";\n\n\t\t\tdocument.body.appendChild(dummy);\n\t\t\tvar dummyBox = dummy.getBoundingClientRect();\n\t\t\ttop  = box.top - dummyBox.top;\n\t\t\tleft = box.left - dummyBox.left;\n\n\t\t\tdummy.parentNode.removeChild(dummy);\n\t\t}\n\n\t\treturn { top: Math.round(top), left: Math.round(left) };\n\t},\n\n\tgetOffset: function getOffset(elem) {\n\t\tif (elem.getBoundingClientRect) {\n\t\t\treturn this.getOffsetRect(elem);\n\t\t} else {\n\t\t\treturn this.getOffsetSum(elem);\n\t\t}\n\t},\n\n\tclosest: function(element, selector){\n\t\tif(!element || !selector){\n\t\t\treturn null;\n\t\t}\n\t\treturn closest(element, selector);\n\t},\n\tinsertAfter: function(newNode, referenceNode){\n\t\tif(referenceNode.nextSibling){\n\t\t\treferenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n\t\t}else{\n\t\t\treferenceNode.parentNode.appendChild(newNode);\n\t\t}\n\t},\n\tremove: function(node) {\n\t\tif (node && node.parentNode) {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t},\n\tisChildOf: function(child, parent) {\n\t\treturn parent.contains(child);\n\t},\n\tgetFocusableNodes,\n\tgetClassName,\n\tlocateCss,\n\tgetRootNode,\n\thasShadowParent,\n\tisShadowDomSupported,\n\tgetActiveElement,\n\tgetRelativeEventPosition,\n\tgetTargetNode,\n\tgetNodePosition\n};\n\nvar closest;\nif(Element.prototype.closest){\n\tclosest = function(element, selector){\n\t\treturn element.closest(selector);\n\t};\n}else{\n\tvar matches = Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n\tclosest = function(element, selector) {\n\t\tvar el = element;\n\t\tdo {\n\t\t\tif (matches.call(el, selector)){\n\t\t\t\treturn el;\n\t\t\t}\n\t\t\tel = el.parentElement || el.parentNode;\n\t\t} while (el !== null && el.nodeType === 1);\n\t\treturn null;\n\t};\n}\n","/* eslint-disable no-restricted-globals */\nvar isWindowAwailable = typeof window !== \"undefined\";\n\n/* eslint-enable no-restricted-globals */\n\nexport default {\n\tisIE: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0),\n\tisOpera: isWindowAwailable && (navigator.userAgent.indexOf(\"Opera\") >= 0),\n\tisChrome: isWindowAwailable && (navigator.userAgent.indexOf(\"Chrome\") >= 0),\n\tisKHTML: isWindowAwailable && (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0),\n\tisFF: isWindowAwailable && (navigator.userAgent.indexOf(\"Firefox\") >= 0),\n\tisIPad: isWindowAwailable && (navigator.userAgent.search(/iPad/gi) >= 0),\n\tisEdge: isWindowAwailable && (navigator.userAgent.indexOf(\"Edge\")!=-1),\n\tisNode: (!isWindowAwailable || typeof navigator == \"undefined\")\n};","export default function(data) {\n\tif (typeof data === \"string\" || typeof data === \"number\") {\n\t\treturn data;\n\t}\n\tvar result = \"\";\n\tfor (var key in data) {\n\t\tvar serialized = \"\";\n\t\tif (data.hasOwnProperty(key)) {\n\t\t\tif (typeof data[key] === \"string\") {\n\t\t\t\tserialized = encodeURIComponent(data[key]);\n\t\t\t} else if (typeof data[key] === \"number\") {\n\t\t\t\tserialized = data[key];\n\t\t\t} else {\n\t\t\t\tserialized = encodeURIComponent(JSON.stringify(data[key]));\n\t\t\t}\n\t\t\tserialized = key + \"=\" + serialized;\n\n\t\t\tif (result.length) {\n\t\t\t\tserialized = \"&\" + serialized;\n\t\t\t}\n\t\t\tresult += serialized;\n\t\t}\n\t}\n\treturn result;\n}","export default function extend(scheduler) {\n\nvar generateStringToDate = function (format, utc) {\n\tvar splt = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\n\tvar mask = format.match(/%[a-zA-Z]/g);\n\tfor (var i = 0; i < mask.length; i++) {\n\t\tswitch (mask[i]) {\n\t\t\tcase \"%j\":\n\t\t\tcase \"%d\": splt += \"set[2]=temp[\" + i + \"]||1;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%n\":\n\t\t\tcase \"%m\": splt += \"set[1]=(temp[\" + i + \"]||1)-1;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%y\": splt += \"set[0]=temp[\" + i + \"]*1+(temp[\" + i + \"]>50?1900:2000);\";\n\t\t\t\tbreak;\n\t\t\tcase \"%g\":\n\t\t\tcase \"%G\":\n\t\t\tcase \"%h\":\n\t\t\tcase \"%H\":\n\t\t\t\tsplt += \"set[3]=temp[\" + i + \"]||0;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%i\":\n\t\t\t\tsplt += \"set[4]=temp[\" + i + \"]||0;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%Y\": splt += \"set[0]=temp[\" + i + \"]||0;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%a\":\n\t\t\tcase \"%A\": splt += \"set[3]=set[3]%12+((temp[\" + i + \"]||'').toLowerCase()=='am'?0:12);\";\n\t\t\t\tbreak;\n\t\t\tcase \"%s\": splt += \"set[5]=temp[\" + i + \"]||0;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%M\": splt += \"set[1]=this.locale.date.month_short_hash[temp[\" + i + \"]]||0;\";\n\t\t\t\tbreak;\n\t\t\tcase \"%F\": splt += \"set[1]=this.locale.date.month_full_hash[temp[\" + i + \"]]||0;\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tvar code = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\n\tif (utc) code = \" Date.UTC(\" + code + \")\";\n\treturn new Function(\"date\", \"var set=[0,0,1,0,0,0]; \" + splt + \" return new Date(\" + code + \");\");\n};\nvar csp_date_to_str = function (format, utc) {\n\treturn function(date) {\n\t\treturn format.replace(/%[a-zA-Z]/g, function (a) {\n\t\t\tswitch (a) {\n\t\t\t\tcase \"%d\": return utc ? scheduler.date.to_fixed(date.getUTCDate()) : scheduler.date.to_fixed(date.getDate());\n\t\t\t\tcase \"%m\": return utc ? scheduler.date.to_fixed((date.getUTCMonth() + 1)) : scheduler.date.to_fixed((date.getMonth() + 1));\n\t\t\t\tcase \"%j\": return utc ? date.getUTCDate() : date.getDate();\n\t\t\t\tcase \"%n\": return utc ? (date.getUTCMonth() + 1) : (date.getMonth() + 1);\n\t\t\t\tcase \"%y\": return utc ? scheduler.date.to_fixed(date.getUTCFullYear() % 100) : scheduler.date.to_fixed(date.getFullYear() % 100);\n\t\t\t\tcase \"%Y\": return utc ? date.getUTCFullYear() : date.getFullYear();\n\t\t\t\tcase \"%D\": return utc ? scheduler.locale.date.day_short[date.getUTCDay()] : scheduler.locale.date.day_short[date.getDay()];\n\t\t\t\tcase \"%l\": return utc ? scheduler.locale.date.day_full[date.getUTCDay()] : scheduler.locale.date.day_full[date.getDay()];\n\t\t\t\tcase \"%M\": return utc ? scheduler.locale.date.month_short[date.getUTCMonth()] : scheduler.locale.date.month_short[date.getMonth()];\n\t\t\t\tcase \"%F\": return utc ? scheduler.locale.date.month_full[date.getUTCMonth()] : scheduler.locale.date.month_full[date.getMonth()];\n\t\t\t\tcase \"%h\": return utc ? scheduler.date.to_fixed((date.getUTCHours() + 11) % 12 + 1) : scheduler.date.to_fixed((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%g\": return utc ? ((date.getUTCHours() + 11) % 12 + 1) : ((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%G\": return utc ? date.getUTCHours() : date.getHours();\n\t\t\t\tcase \"%H\": return utc ? scheduler.date.to_fixed(date.getUTCHours()) : scheduler.date.to_fixed(date.getHours());\n\t\t\t\tcase \"%i\": return utc ? scheduler.date.to_fixed(date.getUTCMinutes()) : scheduler.date.to_fixed(date.getMinutes());\n\t\t\t\tcase \"%a\": return utc ? (date.getUTCHours() > 11 ? \"pm\" : \"am\") : (date.getHours() > 11 ? \"pm\" : \"am\");\n\t\t\t\tcase \"%A\": return utc ? (date.getUTCHours() > 11 ? \"PM\" : \"AM\") : (date.getHours() > 11 ? \"PM\" : \"AM\");\n\t\t\t\tcase \"%s\": return utc ? scheduler.date.to_fixed(date.getUTCSeconds()) : scheduler.date.to_fixed(date.getSeconds());\n\t\t\t\tcase \"%W\": return utc ? scheduler.date.to_fixed(scheduler.date.getUTCISOWeek(date)) : scheduler.date.to_fixed(scheduler.date.getISOWeek(date));\n\t\t\t\tdefault: return a;\n\t\t\t}\n\t\t});\n\t};\n};\nvar csp_str_to_date = function (format, utc) {\n\tconst mask = format.match(/%[a-zA-Z]/g);\n\treturn function (date){\n\t\tvar set = [0, 0, 1, 0, 0, 0];\n\t\tvar temp = date.match(/[a-zA-Z]+|[0-9]+/g);\n\n\t\tfor (var i = 0; i < mask.length; i++) {\n\t\t\tswitch (mask[i]) {\n\t\t\t\tcase \"%j\":\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tset[2] = temp[i] || 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%n\":\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tset[1] = (temp[i] || 1) - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%y\":\n\t\t\t\t\tset[0] = temp[i] * 1 + (temp[i] > 50 ? 1900 : 2000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%g\":\n\t\t\t\tcase \"%G\":\n\t\t\t\tcase \"%h\":\n\t\t\t\tcase \"%H\":\n\t\t\t\t\tset[3] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%i\":\n\t\t\t\t\tset[4] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tset[0] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%a\":\n\t\t\t\tcase \"%A\":\n\t\t\t\t\tset[3] = set[3] % 12 + ((temp[i] || '').toLowerCase() == 'am' ? 0 : 12);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%s\":\n\t\t\t\t\tset[5] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%M\":\n\t\t\t\t\tset[1] = scheduler.locale.date.month_short_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%F\":\n\t\t\t\t\tset[1] = scheduler.locale.date.month_full_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (utc) {\n\t\t\treturn new Date(Date.UTC(set[0], set[1], set[2], set[3], set[4], set[5]));\n\t\t}\n\n\t\treturn new Date(set[0], set[1], set[2], set[3], set[4], set[5]);\n\t};\n};\n\nlet cspEnabled = undefined;\nfunction checkIfCSPEnabled(){\n\ttry {\n\t\tnew Function(\"cspEnabled = false;\");\n\t\tcspEnabled = false;\n\t} catch(e) {\n\t\tcspEnabled = true;\n\t}\n\treturn cspEnabled;\n}\n\nfunction useCsp() {\n\tvar result = false;\n\tif (scheduler.config.csp === \"auto\") {\n\t\tif(cspEnabled === undefined){\n\t\t\tcspEnabled = checkIfCSPEnabled();\n\t\t}\n\t\tresult = cspEnabled;\n\t} else {\n\t\tresult = scheduler.config.csp;\n\t}\n\treturn result;\n}\nscheduler.date = {\n\tinit:function(){\n\t\tvar s = scheduler.locale.date.month_short;\n\t\tvar t = scheduler.locale.date.month_short_hash = {};\n\t\tfor (var i = 0; i < s.length; i++)\n\t\t\tt[s[i]]=i;\n\n\t\tvar s = scheduler.locale.date.month_full;\n\t\tvar t = scheduler.locale.date.month_full_hash = {};\n\t\tfor (var i = 0; i < s.length; i++)\n\t\t\tt[s[i]]=i;\n\t},\n\tdate_part:function(value){\n\t\tconst date = new Date(value);\n\t\tvar old = new Date(date);\n\t\tdate.setHours(0);\n\t\tdate.setMinutes(0);\n\t\tdate.setSeconds(0);\n\t\tdate.setMilliseconds(0);\n\t\tif (date.getHours() && //shift to yesterday on dst\n\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()) )\n\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\n\t\treturn date;\n\t},\n\ttime_part:function(date){\n\t\treturn (date.valueOf()/1000 - date.getTimezoneOffset()*60)%86400;\n\t},\n\tweek_start:function(date){\n\t\tvar shift=date.getDay();\n\t\tif (scheduler.config.start_on_monday){\n\t\t\tif (shift===0) shift=6;\n\t\t\telse shift--;\n\t\t}\n\t\treturn this.date_part(this.add(date,-1*shift,\"day\"));\n\t},\n\tmonth_start:function(value){\n\t\tconst date = new Date(value);\n\t\tdate.setDate(1);\n\t\treturn this.date_part(date);\n\t},\n\tyear_start:function(value){\n\t\tconst date = new Date(value);\n\t\tdate.setMonth(0);\n\t\treturn this.month_start(date);\n\t},\n\tday_start:function(value){\n\t\tconst date = new Date(value);\n\t\treturn this.date_part(date);\n\t},\n\t_add_days:function(date, inc){\n\t\tvar ndate = new Date(date.valueOf());\n\n\t\tndate.setDate(ndate.getDate() + inc);\n\n\t\t// Workaround for Safari/iOS timezone bug, ref:OKZ-149693\n\t\tif(inc == Math.round(inc) && inc > 0){\n\t\t\tvar datesDiff = +ndate - +date,\n\t\t\t\trest = datesDiff % (24*60*60*1000);\n\t\t\tif(rest && date.getTimezoneOffset() == ndate.getTimezoneOffset()){\n\t\t\t\tvar hours = rest / (60* 60 * 1000);\n\t\t\t\tndate.setTime(ndate.getTime() + (24 - hours) * 60 * 60 * 1000);\n\t\t\t}\n\t\t}\n\n\t\tif (inc >= 0 && (!date.getHours() && ndate.getHours()) &&//shift to yesterday on dst\n\t\t\t(ndate.getDate() < date.getDate() || ndate.getMonth() < date.getMonth() || ndate.getFullYear() < date.getFullYear()) )\n\t\t\tndate.setTime(ndate.getTime() + 60 * 60 * 1000 * (24 - ndate.getHours()));\n\t\treturn ndate;\n\t},\n\tadd:function(date,inc,mode){\n\t\tvar ndate=new Date(date.valueOf());\n\t\tswitch(mode){\n\t\t\tcase \"day\":\n\t\t\t\tndate = scheduler.date._add_days(ndate, inc);\n\t\t\t\tbreak;\n\t\t\tcase \"week\":\n\t\t\t\tndate = scheduler.date._add_days(ndate, inc * 7);\n\t\t\t\tbreak;\n\t\t\tcase \"month\": ndate.setMonth(ndate.getMonth()+inc); break;\n\t\t\tcase \"year\": ndate.setYear(ndate.getFullYear()+inc); break;\n\t\t\tcase \"hour\":\n\t\t\t\t/*\n\t\t\t\t setHour(getHour() + inc) and setMinutes gives weird result when is applied on a Daylight Saving time switch\n\t\t\t\t setTime seems working as expected\n\t\t\t\t*/\n\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\n\t\t\t\tbreak;\n\t\t\tcase \"minute\":\n\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn scheduler.date[\"add_\"+mode](date,inc,mode);\n\t\t}\n\t\treturn ndate;\n\t},\n\tto_fixed:function(num){\n\t\tif (num<10)\treturn \"0\"+num;\n\t\treturn num;\n\t},\n\tcopy:function(date){\n\t\treturn new Date(date.valueOf());\n\t},\n\tdate_to_str:function(format,utc){\n\t\tif (useCsp()) {\n\t\t\treturn csp_date_to_str(format,utc);\n\t\t}\n\n\t\tformat=format.replace(/%[a-zA-Z]/g,function(a){\n\t\t\tswitch(a){\n\t\t\t\tcase \"%d\": return \"\\\"+this.date.to_fixed(date.getDate())+\\\"\";\n\t\t\t\tcase \"%m\": return \"\\\"+this.date.to_fixed((date.getMonth()+1))+\\\"\";\n\t\t\t\tcase \"%j\": return \"\\\"+date.getDate()+\\\"\";\n\t\t\t\tcase \"%n\": return \"\\\"+(date.getMonth()+1)+\\\"\";\n\t\t\t\tcase \"%y\": return \"\\\"+this.date.to_fixed(date.getFullYear()%100)+\\\"\";\n\t\t\t\tcase \"%Y\": return \"\\\"+date.getFullYear()+\\\"\";\n\t\t\t\tcase \"%D\": return \"\\\"+this.locale.date.day_short[date.getDay()]+\\\"\";\n\t\t\t\tcase \"%l\": return \"\\\"+this.locale.date.day_full[date.getDay()]+\\\"\";\n\t\t\t\tcase \"%M\": return \"\\\"+this.locale.date.month_short[date.getMonth()]+\\\"\";\n\t\t\t\tcase \"%F\": return \"\\\"+this.locale.date.month_full[date.getMonth()]+\\\"\";\n\t\t\t\tcase \"%h\": return \"\\\"+this.date.to_fixed((date.getHours()+11)%12+1)+\\\"\";\n\t\t\t\tcase \"%g\": return \"\\\"+((date.getHours()+11)%12+1)+\\\"\";\n\t\t\t\tcase \"%G\": return \"\\\"+date.getHours()+\\\"\";\n\t\t\t\tcase \"%H\": return \"\\\"+this.date.to_fixed(date.getHours())+\\\"\";\n\t\t\t\tcase \"%i\": return \"\\\"+this.date.to_fixed(date.getMinutes())+\\\"\";\n\t\t\t\tcase \"%a\": return \"\\\"+(date.getHours()>11?\\\"pm\\\":\\\"am\\\")+\\\"\";\n\t\t\t\tcase \"%A\": return \"\\\"+(date.getHours()>11?\\\"PM\\\":\\\"AM\\\")+\\\"\";\n\t\t\t\tcase \"%s\": return \"\\\"+this.date.to_fixed(date.getSeconds())+\\\"\";\n\t\t\t\tcase \"%W\": return \"\\\"+this.date.to_fixed(this.date.getISOWeek(date))+\\\"\";\n\t\t\t\tdefault: return a;\n\t\t\t}\n\t\t});\n\t\tif (utc) format=format.replace(/date\\.get/g,\"date.getUTC\");\n\t\tvar func = new Function(\"date\",\"return \\\"\"+format+\"\\\";\");\n\n\t\treturn func.bind(scheduler);\n\t},\n\tstr_to_date:function(format, utc, exactFormat){\n\t\tvar stringToDateMethod = useCsp() ? csp_str_to_date : generateStringToDate;\n\t\tvar parseExactFormat = stringToDateMethod(format, utc);\n\t\t// eslint-disable-next-line\n\t\tvar yyyyMMddhhIIss = /^[0-9]{4}(\\-|\\/)[0-9]{2}(\\-|\\/)[0-9]{2} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/;\n\n\t\t// MM/dd/yyyy - default old format for xml-date\n\t\t// eslint-disable-next-line\n\t\tvar MMddyyyyhhIIss = /^[0-9]{2}\\/[0-9]{2}\\/[0-9]{4} ?(([0-9]{1,2}:[0-9]{2})(:[0-9]{1,2})?)?$/;\n\t\t// dd-MM-yyyy - default old format for api-date\n\t\t// eslint-disable-next-line\n\t\tvar ddMMyyyyhhIIss = /^[0-9]{2}\\-[0-9]{2}\\-[0-9]{4} ?(([0-9]{1,2}:[0-9]{1,2})(:[0-9]{1,2})?)?$/;\n\t\t// eslint-disable-next-line\n\t\tvar ISO8601 = /^([\\+-]?\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24\\:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$/;\n\n\t\tvar isYMDDate = function (datestr) {\n\t\t\treturn yyyyMMddhhIIss.test(String(datestr));\n\t\t};\n\n\t\tvar isMDYDate = function (datestr) {\n\t\t\treturn MMddyyyyhhIIss.test(String(datestr));\n\t\t};\n\t\tvar isDMYDate = function (datestr) {\n\t\t\treturn ddMMyyyyhhIIss.test(String(datestr));\n\t\t};\n\t\tvar isISO8601 = function (datestr) {\n\t\t\treturn ISO8601.test(datestr);\n\t\t};\n\n\t\tvar parseYMD = stringToDateMethod(\"%Y-%m-%d %H:%i:%s\", utc);\n\t\tvar parseMDY = stringToDateMethod(\"%m/%d/%Y %H:%i:%s\", utc);\n\t\tvar parseDMY = stringToDateMethod(\"%d-%m-%Y %H:%i:%s\", utc);\n\n\t\treturn function (dateString) {\n\n\t\t\tif (!exactFormat && !scheduler.config.parse_exact_format) {\n\t\t\t\tif (dateString && dateString.getISOWeek) {\n\t\t\t\t\treturn new Date(dateString);\n\t\t\t\t} else if (typeof dateString === \"number\") {\n\t\t\t\t\treturn new Date(dateString);\n\t\t\t\t} else if (isYMDDate(dateString)) {\n\t\t\t\t\treturn parseYMD(dateString);\n\t\t\t\t} else if (isMDYDate(dateString)) {\n\t\t\t\t\treturn parseMDY(dateString);\n\t\t\t\t} else if (isDMYDate(dateString)) {\n\t\t\t\t\treturn parseDMY(dateString);\n\t\t\t\t} else if (isISO8601(dateString)) {\n\t\t\t\t\treturn new Date(dateString);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn parseExactFormat.call(scheduler, dateString);\n\t\t};\n\t},\n\tgetISOWeek: function(ndate) {\n\t\tif(!ndate) return false;\n\t\tndate = this.date_part(new Date(ndate));\n\t\tvar nday = ndate.getDay();\n\t\tif (nday === 0) {\n\t\t\tnday = 7;\n\t\t}\n\t\tvar first_thursday = new Date(ndate.valueOf());\n\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\n\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\n\t\tvar ordinal_date = Math.round( (first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\n\t\tvar week_number = 1 + Math.floor( ordinal_date / 7);\n\t\treturn week_number;\n\t},\n\tgetUTCISOWeek: function(ndate){\n\t\treturn this.getISOWeek(this.convert_to_utc(ndate));\n\t},\n\tconvert_to_utc: function(date) {\n\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n\t}\n};\n\n}\n\n","export default function(scheduler){\n\treturn (function(){\n\t\tvar res = {};\n\t\tfor (var a in this._events){\n\t\t\tvar ev = this._events[a];\n\t\t\tif (ev.id.toString().indexOf(\"#\") == -1){\n\t\t\t\tres[ev.id] = ev;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}).bind(scheduler);\n}","import xmlLoaded from \"./loaders/xml\";\nimport jsonLoader from \"./loaders/json\";\nimport iCalLoader from \"./loaders/ical\";\nimport createSerializator from \"../core/common/get_serializable_events\";\n\nexport default function extend(scheduler) {\n\nscheduler._loaded = {};\nscheduler._load = function(url, from) {\n\turl = url || this._load_url;\n\n\tif(!url){\n\t\t//if scheduler.setLoadMode is called before scheduler.init, initial rendering will invoke data loading while url is undefined\n\t\treturn;\n\t}\n\n\turl += (url.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"timeshift=\" + (new Date()).getTimezoneOffset();\n\tif (this.config.prevent_cache)    url += \"&uid=\" + this.uid();\n\tvar to;\n\tfrom = from || this._date;\n\tfunction ajaxCallback(response) {\n\t\tscheduler.on_load(response);\n\t\tscheduler.callEvent(\"onLoadEnd\", []);\n\t}\n\tif (this._load_mode) {\n\t\tvar lf = this.templates.load_format;\n\n\t\tfrom = this.date[this._load_mode + \"_start\"](new Date(from.valueOf()));\n\t\twhile (from > this._min_date) from = this.date.add(from, -1, this._load_mode);\n\t\tto = from;\n\n\t\tvar cache_line = true;\n\t\twhile (to < this._max_date) {\n\t\t\tto = this.date.add(to, 1, this._load_mode);\n\t\t\tif (this._loaded[lf(from)] && cache_line)\n\t\t\t\tfrom = this.date.add(from, 1, this._load_mode); else cache_line = false;\n\t\t}\n\n\t\tvar temp_to = to;\n\t\tdo {\n\t\t\tto = temp_to;\n\t\t\ttemp_to = this.date.add(to, -1, this._load_mode);\n\t\t} while (temp_to > from && this._loaded[lf(temp_to)]);\n\n\t\tif (to <= from)\n\t\t\treturn false; //already loaded\n\n\t\tscheduler.ajax.get(url + \"&from=\" + lf(from) + \"&to=\" + lf(to), ajaxCallback);\n\n\t\twhile (from < to) {\n\t\t\tthis._loaded[lf(from)] = true;\n\t\t\tfrom = this.date.add(from, 1, this._load_mode);\n\t\t}\n\t} else {\n\t\tscheduler.ajax.get(url, ajaxCallback);\n\t}\n\n\t// TODO: remove onXLS\n\tthis.callEvent(\"onXLS\", []);\n\tthis.callEvent(\"onLoadStart\", []);\n\treturn true;\n};\n\nscheduler._parsers = {};\n\n\nxmlLoaded(scheduler);\njsonLoader(scheduler);\niCalLoader(scheduler);\n\nscheduler.on_load = function (loader) {\n\tthis.callEvent(\"onBeforeParse\", []);\n\n\tvar evs;\n\tvar error = false;\n\n\tvar foundParser = false;\n\tfor(var i in this._parsers){\n\t\tvar parser = this._parsers[i];\n\t\tif(parser.canParse(loader.xmlDoc.responseText, loader.xmlDoc)){\n\t\t\ttry{\n\t\t\t\tvar param = loader.xmlDoc.responseText;\n\t\t\t\tif(i === \"xml\"){\n\t\t\t\t\tparam = loader;\n\t\t\t\t}\n\t\t\t\tevs = parser.parse(param);\n\t\t\t\tif(!evs){\n\t\t\t\t\terror = true;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\terror = true;\n\t\t\t}\n\t\t\tfoundParser = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(!foundParser){\n\t\tif(this._process && this[this._process]){\n\t\t\ttry{\n\t\t\t\tevs = this[this._process].parse(loader.xmlDoc.responseText);\n\t\t\t}catch (e){\n\t\t\t\terror = true;\n\t\t\t}\n\t\t}else{\n\t\t\terror = true;\n\t\t}\n\t}\n\n\tif(error || (loader.xmlDoc.status && loader.xmlDoc.status >= 400)){\n\t\tthis.callEvent(\"onLoadError\", [loader.xmlDoc]);\n\t\tevs = [];\n\t}\n\n\tthis._process_loading(evs);\n\n\t// TODO: remove onXLE\n\tthis.callEvent(\"onXLE\", []);\n\tthis.callEvent(\"onParse\", []);\n};\nscheduler._process_loading = function(evs) {\n\tthis._loading = true;\n\tthis._not_render = true;\n\tfor (var i = 0; i < evs.length; i++) {\n\t\tif (!this.callEvent(\"onEventLoading\", [evs[i]])) continue;\n\t\tthis.addEvent(evs[i]);\n\t}\n\tthis._not_render = false;\n\tif (this._render_wait) this.render_view_data();\n\n\tthis._loading = false;\n\tif (this._after_call) this._after_call();\n\tthis._after_call = null;\n};\nscheduler._init_event = function(event) {\n\tevent.text = (event.text || event._tagvalue) || \"\";\n\tevent.start_date = scheduler._init_date(event.start_date);\n\tevent.end_date = scheduler._init_date(event.end_date);\n};\n\nscheduler._init_date = function(date){\n\tif(!date)\n\t\treturn null;\n\tif (typeof date == \"string\") {\n\t\treturn scheduler._helpers.parseDate(date);\n\t}\n\telse return new Date(date);\n};\n\nconst getSerializableData = createSerializator(scheduler);\nscheduler.serialize = function(){\n\tconst dataset = [];\n\tconst allEvents = getSerializableData();\n\tfor (var a in allEvents){\n\t\t\n\t\tconst exportedEvent = {};\n\t\tvar ev = allEvents[a];\n\n\t\tfor(var key in ev){\n\t\t\tif (key.charAt(0) == \"$\" || key.charAt(0) == \"_\"){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet exportValue;\n\t\t\tconst rawValue = ev[key];\n\t\t\tif(scheduler.utils.isDate(rawValue)){\n\t\t\t\texportValue = scheduler.defined(scheduler.templates.xml_format) ? scheduler.templates.xml_format(rawValue) : scheduler.templates.format_date(rawValue);\n\t\t\t}else{\n\t\t\t\texportValue = rawValue;\n\t\t\t}\n\t\t\t\n\t\t\texportedEvent[key] = exportValue;\n\t\t}\n\n\t\tdataset.push(exportedEvent);\n\t}\n\treturn dataset;\n};\n\n/*\nscheduler.json = {};\nscheduler.json.parse = function(data) {\n\n\tvar events = [];\n\n\tif (typeof data == \"string\") {\n\t\tdata = JSON.parse(data);\n\t}\n\tif (Object.prototype.toString.call(data) === '[object Array]') {\n\t\tevents = data;\n\t} else {\n\t\tif(data){\n\t\t\tif(data.events){\n\t\t\t\tevents = data.events;\n\t\t\t}else if(data.data){\n\t\t\t\tevents = data.data;\n\t\t\t}\n\t\t}\n\t}\n\tevents = events || [];\n\n\tif (data.dhx_security) {\n\t\tif (window.dhtmlx) {\n\t\t\twindow.dhtmlx.security_key = data.dhx_security;\n\t\t}\n\t\tscheduler.security_key = data.dhx_security;\n\t}\n\n\tvar collections = (data && data.collections) ? data.collections : {};\n\tvar collections_loaded = false;\n\tfor (var key in collections) {\n\t\tif (collections.hasOwnProperty(key)) {\n\t\t\tcollections_loaded = true;\n\t\t\tvar collection = collections[key];\n\t\t\tvar arr = scheduler.serverList[key];\n\t\t\tif (!arr) {\n\t\t\t\tscheduler.serverList[key] = arr = [];\n\t\t\t}\n\t\t\tarr.splice(0, arr.length); //clear old options\n\t\t\tfor (var j = 0; j < collection.length; j++) {\n\t\t\t\tvar option = collection[j];\n\t\t\t\tvar obj = { key: option.value, label: option.label }; // resulting option object\n\t\t\t\tfor (var option_key in option) {\n\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\n\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tarr.push(obj);\n\t\t\t}\n\t\t}\n\t}\n\tif (collections_loaded)\n\t\tscheduler.callEvent(\"onOptionsLoad\", []);\n\n\tvar evs = [];\n\tfor (var i = 0; i < events.length; i++) {\n\t\tvar event = events[i];\n\t\tscheduler._init_event(event);\n\t\tevs.push(event);\n\t}\n\treturn evs;\n};*/\nscheduler.parse = function(data, type) {\n\tthis._process = type;\n\tthis.on_load({xmlDoc: {responseText: data}});\n};\nscheduler.load = function(url, call) {\n\tif (typeof call == \"string\") {\n\t\tthis._process = call;\n\t\tcall = arguments[2];\n\t}\n\n\tthis._load_url = url;\n\tthis._after_call = call;\n\tthis._load(url, this._date);\n};\n//possible values - day,week,month,year,all\nscheduler.setLoadMode = function(mode) {\n\tif (mode == \"all\") mode = \"\";\n\tthis._load_mode = mode;\n};\n\nscheduler.serverList = function(name, array) {\n\tif (array) {\n\t\tthis.serverList[name] = array.slice(0);\n\t\treturn this.serverList[name];\n\t}\n\tthis.serverList[name] = (this.serverList[name] || []);\n\treturn this.serverList[name];\n};\nscheduler._userdata = {};\n\nscheduler._xmlNodeToJSON = function(node) {\n\tvar t = {};\n\tfor (var i = 0; i < node.attributes.length; i++)\n\t\tt[node.attributes[i].name] = node.attributes[i].value;\n\n\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\tvar child = node.childNodes[i];\n\t\tif (child.nodeType == 1)\n\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\n\t}\n\n\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\n\n\treturn t;\n};\nscheduler.attachEvent(\"onXLS\", function() {\n\tif (this.config.show_loading === true) {\n\t\tvar t;\n\t\tt = this.config.show_loading = document.createElement(\"div\");\n\t\tt.className = 'dhx_loading';\n\t\tt.style.left = Math.round((this._x - 128) / 2) + \"px\";\n\t\tt.style.top = Math.round((this._y - 15) / 2) + \"px\";\n\t\tthis._obj.appendChild(t);\n\t}\n});\nscheduler.attachEvent(\"onXLE\", function() {\n\tvar t = this.config.show_loading;\n\tif (t && typeof t == \"object\") {\n\t\tif(t.parentNode) {\n\t\t\tt.parentNode.removeChild(t);\n\t\t}\n\t\tthis.config.show_loading = true;\n\t}\n});\n\n\n}","export default function extend(scheduler) {\n\n\nscheduler._parsers.xml = {\n\tcanParse: function(data, xhr){\n\t\t// IE returns non-empty responseXML type regardless of actual data type\n\t\tif(xhr.responseXML && xhr.responseXML.firstChild){\n\t\t\treturn true;\n\t\t}\n\n\t\ttry{\n\t\t\tvar xmlDoc = scheduler.ajax.parse(xhr.responseText);\n\t\t\tvar topElement = scheduler.ajax.xmltop(\"data\", xmlDoc);\n\t\t\tif(topElement && topElement.tagName === \"data\"){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}catch (e){\n\t\t}\n\t\treturn false;\n\t},\n\tparse: function(loader) {\n\t\tvar xml;\n\n\t\tif (!loader.xmlDoc.responseXML) { //from a string\n\t\t\tloader.xmlDoc.responseXML = scheduler.ajax.parse(loader.xmlDoc.responseText);\n\t\t}\n\t\n\t\txml = scheduler.ajax.xmltop(\"data\", loader.xmlDoc);\n\t\tif (xml.tagName != \"data\") return null;//not an xml\n\t\tvar csrfToken = xml.getAttribute(\"dhx_security\");\n\t\tif (csrfToken) {\n\t\t\tif (window.dhtmlx) {\n\t\t\t\twindow.dhtmlx.security_key = csrfToken;\n\t\t\t}\n\t\t\tscheduler.security_key = csrfToken;\n\t\t}\n\t\n\t\tvar opts = scheduler.ajax.xpath(\"//coll_options\", loader.xmlDoc);\n\t\tfor (var i = 0; i < opts.length; i++) {\n\t\t\tvar bind = opts[i].getAttribute(\"for\");\n\t\t\tvar arr = scheduler.serverList[bind];\n\t\t\tif (!arr) {\n\t\t\t\tscheduler.serverList[bind] = arr = [];\n\t\t\t}\n\t\t\tarr.splice(0, arr.length);\t//clear old options\n\t\t\tvar itms = scheduler.ajax.xpath(\".//item\", opts[i]);\n\t\t\tfor (var j = 0; j < itms.length; j++) {\n\t\t\t\tvar itm = itms[j];\n\t\t\t\tvar attrs = itm.attributes;\n\t\t\t\tvar obj = { key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\n\t\t\t\tfor (var k = 0; k < attrs.length; k++) {\n\t\t\t\t\tvar attr = attrs[k];\n\t\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\n\t\t\t\t}\n\t\t\t\tarr.push(obj);\n\t\t\t}\n\t\t}\n\t\tif (opts.length)\n\t\t\tscheduler.callEvent(\"onOptionsLoad\", []);\n\t\n\t\tvar ud = scheduler.ajax.xpath(\"//userdata\", loader.xmlDoc);\n\t\tfor (var i = 0; i < ud.length; i++) {\n\t\t\tvar udx = scheduler._xmlNodeToJSON(ud[i]);\n\t\t\tscheduler._userdata[udx.name] = udx.text;\n\t\t}\n\t\n\t\tvar evs = [];\n\t\txml = scheduler.ajax.xpath(\"//event\", loader.xmlDoc);\n\t\n\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\tvar ev = evs[i] = scheduler._xmlNodeToJSON(xml[i]);\n\t\t\tscheduler._init_event(ev);\n\t\t}\n\t\treturn evs;\n\t}\n};\n\n}","export default function extend(scheduler) {\n\n\nscheduler.json = scheduler._parsers.json = {\n\tcanParse: function(data){\n\t\tif(data && typeof data === \"object\"){\n\t\t\treturn true;\n\t\t} else if(typeof data === \"string\"){\n\t\t\ttry {\n\t\t\t\tvar result = JSON.parse(data);\n\t\t\t\treturn Object.prototype.toString.call(result) === '[object Object]' || \n\t\t\t\t\t\tObject.prototype.toString.call(result) === '[object Array]';\n\t\t\t} catch (err) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\tparse: function(data) {\n\t\tvar events = [];\n\n\t\tif (typeof data == \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\tif (Object.prototype.toString.call(data) === '[object Array]') {\n\t\t\tevents = data;\n\t\t} else {\n\t\t\tif(data){\n\t\t\t\tif(data.events){\n\t\t\t\t\tevents = data.events;\n\t\t\t\t}else if(data.data){\n\t\t\t\t\tevents = data.data;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tevents = events || [];\n\n\t\tif (data.dhx_security) {\n\t\t\tif (window.dhtmlx) {\n\t\t\t\twindow.dhtmlx.security_key = data.dhx_security;\n\t\t\t}\n\t\t\tscheduler.security_key = data.dhx_security;\n\t\t}\n\n\t\tvar collections = (data && data.collections) ? data.collections : {};\n\t\tvar collections_loaded = false;\n\t\tfor (var key in collections) {\n\t\t\tif (collections.hasOwnProperty(key)) {\n\t\t\t\tcollections_loaded = true;\n\t\t\t\tvar collection = collections[key];\n\t\t\t\tvar arr = scheduler.serverList[key];\n\t\t\t\tif (!arr) {\n\t\t\t\t\tscheduler.serverList[key] = arr = [];\n\t\t\t\t}\n\t\t\t\tarr.splice(0, arr.length); //clear old options\n\t\t\t\tfor (var j = 0; j < collection.length; j++) {\n\t\t\t\t\tvar option = collection[j];\n\t\t\t\t\tvar obj = { key: option.value, label: option.label }; // resulting option object\n\t\t\t\t\tfor (var option_key in option) {\n\t\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\n\t\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (collections_loaded)\n\t\t\tscheduler.callEvent(\"onOptionsLoad\", []);\n\n\t\tvar evs = [];\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tvar event = events[i];\n\t\t\tscheduler._init_event(event);\n\t\t\tevs.push(event);\n\t\t}\n\t\treturn evs;\n\t}\n};\n\n}","export default function extend(scheduler) {\n\n\nscheduler.ical = scheduler._parsers.ical = {\n\tcanParse: function(data){\n\t\tif(typeof data === \"string\"){\n\t\t\treturn new RegExp(\"^BEGIN:VCALENDAR\").test(data);\n\t\t}\n\n\t\treturn false;\n\t},\n\tparse:function(str){\n\t\tvar data = str.match(RegExp(this.c_start+\"[^\\f]*\"+this.c_end,\"\"));\n\t\tif (!data.length) return;\n\n\t\t// mpl: handle bad unfolding\n\t\tdata[0]=data[0].replace(/[\\r\\n]+ /g,\"\");\n\n\t\t//unfolding \n\t\tdata[0]=data[0].replace(/[\\r\\n]+(?=[a-z \\t])/g,\" \");\n\t\t//drop property\n\t\tdata[0]=data[0].replace(/;[^:\\r\\n]*:/g,\":\");\n\t\t\n\t\t\n\t\tvar incoming=[];\n\t\tvar match;\n\t\tvar event_r = RegExp(\"(?:\"+this.e_start+\")([^\\f]*?)(?:\"+this.e_end+\")\",\"g\");\n\t\twhile ((match=event_r.exec(data)) !== null){\n\t\t\tvar e={};\n\t\t\tvar param;\n\t\t\tvar param_r = /[^\\r\\n]+[\\r\\n]+/g;\n\t\t\twhile ((param=param_r.exec(match[1])) !== null)\n\t\t\t\tthis.parse_param(param.toString(),e);\n\t\t\tif (e.uid && !e.id) e.id = e.uid; //fallback to UID, when ID is not defined\n\t\t\tincoming.push(e);\t\n\t\t}\n\t\treturn incoming;\n\t},\n\tparse_param:function(str,obj){\n\t\tvar d = str.indexOf(\":\"); \n\t\t\tif (d==-1) return;\n\t\t\n\t\tvar name = str.substr(0,d).toLowerCase();\n\t\tvar value = str.substr(d+1).replace(/\\\\,/g,\",\").replace(/[\\r\\n]+$/,\"\");\n\t\tif (name==\"summary\")\n\t\t\tname=\"text\";\n\t\telse if (name==\"dtstart\"){\n\t\t\tname = \"start_date\";\n\t\t\tvalue = this.parse_date(value,0,0);\n\t\t}\n\t\telse if (name==\"dtend\"){\n\t\t\tname = \"end_date\";\n\t\t\tvalue = this.parse_date(value,0,0);\n\t\t}\n\t\tobj[name]=value;\n\t},\n\tparse_date:function(value,dh,dm){\n\t\tvar t = value.split(\"T\");\n\n\t\tvar utcMark = false;\n\t\tif (t[1]){\n\t\t\tdh=t[1].substr(0,2);\n\t\t\tdm=t[1].substr(2,2);\n\t\t\tutcMark = !!(t[1][6] == \"Z\");\n\t\t}\n\t\tvar dy = t[0].substr(0,4);\n\t\tvar dn = parseInt(t[0].substr(4,2),10)-1;\n\t\tvar dd = t[0].substr(6,2);\n\n\t\tif(scheduler.config.server_utc || utcMark){\n\t\t\treturn new Date(Date.UTC(dy,dn,dd,dh,dm)) ;\n\t\t}else{\n\t\t\treturn new Date(dy,dn,dd,dh,dm);\n\t\t}\n\t},\n\tc_start:\"BEGIN:VCALENDAR\",\n\te_start:\"BEGIN:VEVENT\",\n\te_end:\"END:VEVENT\",\n\tc_end:\"END:VCALENDAR\"\t\n};\n\n}","export default function extend(scheduler) {\n\nscheduler._lightbox_controls = {};\nscheduler.formSection = function(name){\n\tvar config = this.config.lightbox.sections;\n\tvar i = 0;\n\tfor (i; i < config.length; i++) {\n\t\tif (config[i].name == name) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (i === config.length) {\n\t\t// GS-1662 section not found, should exit here instead of throwing an error\n\t\treturn null;\n\t}\n\n\tvar section = config[i];\n\tif (!scheduler._lightbox) {\n\t\tscheduler.getLightbox();\n\t}\n\tvar header = scheduler._lightbox.querySelector(`#${section.id}`);\n\tvar node = header.nextSibling;\n\n\tvar result = {\n\t\tsection: section,\n\t\theader: header,\n\t\tnode: node,\n\t\tgetValue:function(ev){\n\t\t\treturn scheduler.form_blocks[section.type].get_value(node, (ev||{}), section);\n\t\t},\n\t\tsetValue:function(value, ev){\n\t\t\treturn scheduler.form_blocks[section.type].set_value(node, value, (ev||{}), section);\n\t\t}\n\t};\n\n\tvar handler = scheduler._lightbox_controls[\"get_\"+section.type+\"_control\"];\n\treturn handler?handler(result):result;\n};\nscheduler._lightbox_controls.get_template_control = function(result) {\n\tresult.control = result.node;\n\treturn result;\n};\nscheduler._lightbox_controls.get_select_control = function(result) {\n\tresult.control = result.node.getElementsByTagName('select')[0];\n\treturn result;\n};\nscheduler._lightbox_controls.get_textarea_control = function(result) {\n\tresult.control = result.node.getElementsByTagName('textarea')[0];\n\treturn result;\n};\nscheduler._lightbox_controls.get_time_control = function(result) {\n\tresult.control = result.node.getElementsByTagName('select'); // array\n\treturn result;\n};\n\nscheduler._lightbox_controls.defaults = {\n\ttemplate: {\n\t\theight:30\n\t},\n\ttextarea: {\n\t\theight: 200\n\t},\n\tselect: {\n\t\theight: 23\n\t},\n\ttime: {\n\t\theight: 20\n\t}\n};\n\n\nscheduler.form_blocks={\n\ttemplate:{\n\t\trender: function(sns){\n\t\t\tconst sectionHeight = sns.height ? `style='height:${sns.height}px;'` : \"\";\n\t\t\treturn `<div class='dhx_cal_ltext dhx_cal_template' ${sectionHeight}></div>`;\n\t\t},\n\t\tset_value:function(node,value,ev,config){\n\t\t\tnode.innerHTML = value||\"\";\n\t\t},\n\t\tget_value:function(node,ev,config){\n\t\t\treturn node.innerHTML||\"\";\n\t\t},\n\t\tfocus: function(node){\n\t\t}\n\t},\n\ttextarea:{\n\t\trender:function(sns){\n\t\t\tconst sectionHeight = sns.height ? `style='height:${sns.height}px;'` : \"\";\n\t\t\tconst placeholder = sns.placeholder ? `placeholder='${sns.placeholder}'` : \"\";\n\t\t\treturn `<div class='dhx_cal_ltext' ${sectionHeight}><textarea ${placeholder}></textarea></div>`;\n\t\t},\n\t\tset_value:function(node,value,ev){\n\t\t\tscheduler.form_blocks.textarea._get_input(node).value=value||\"\";\n\t\t},\n\t\tget_value:function(node,ev){\n\t\t\treturn scheduler.form_blocks.textarea._get_input(node).value;\n\t\t},\n\t\tfocus:function(node){\n\t\t\tvar a = scheduler.form_blocks.textarea._get_input(node);\n\t\t\tscheduler._focus(a, true);\n\t\t},\n\t\t_get_input: function(node){\n\t\t\treturn node.getElementsByTagName(\"textarea\")[0];\n\t\t}\n\t},\n\tselect:{\n\t\trender:function(sns){\n\t\t\t//var defaults = scheduler._lightbox_controls.defaults.select;\n\t\t\tconst sectionHeight = sns.height ? `style='height:${sns.height}px;'` : \"\";\n\t\t\tvar html=`<div class='dhx_cal_ltext dhx_cal_select' ${sectionHeight}><select style='width:100%;'>`;\n\t\t\tfor (var i=0; i < sns.options.length; i++)\n\t\t\t\thtml+=\"<option value='\"+sns.options[i].key+\"'>\"+sns.options[i].label+\"</option>\";\n\t\t\thtml+=\"</select></div>\";\n\t\t\treturn html;\n\t\t},\n\t\tset_value:function(node,value,ev,sns){\n\t\t\tvar select = node.firstChild;\n\t\t\tif (!select._dhx_onchange && sns.onchange) {\n\t\t\t\tscheduler.event(select, \"change\", sns.onchange);\n\t\t\t\tselect._dhx_onchange = true;\n\t\t\t}\n\t\t\tif (typeof value == \"undefined\")\n\t\t\t\tvalue = (select.options[0]||{}).value;\n\t\t\tselect.value=value||\"\";\n\t\t},\n\t\tget_value:function(node,ev){\n\t\t\treturn node.firstChild.value;\n\t\t},\n\t\tfocus:function(node){\n\t\t\tvar a=node.firstChild; scheduler._focus(a, true);\n\t\t}\n\t},\n\ttime:{\n\t\trender:function(sns) {\n\t\t\tif (!sns.time_format) {\n\t\t\t\t// default order\n\t\t\t\tsns.time_format = [\"%H:%i\", \"%d\", \"%m\", \"%Y\"];\n\t\t\t}\n\t\t\t// map: default order => real one\n\t\t\tsns._time_format_order = {};\n\t\t\tvar time_format = sns.time_format;\n\n\t\t\tvar cfg = scheduler.config;\n\t\t\tvar dt = scheduler.date.date_part(scheduler._currentDate());\n\t\t\tvar last = 24*60, first = 0;\n\t\t\tif(scheduler.config.limit_time_select){\n\t\t\t\tlast = 60*cfg.last_hour+1;\n\t\t\t\tfirst = 60*cfg.first_hour;\n\t\t\t\tdt.setHours(cfg.first_hour);\n\t\t\t}\n\t\t\tvar html = \"\";\n\n\t\t\tfor (var p = 0; p < time_format.length; p++) {\n\t\t\t\tvar time_option = time_format[p];\n\n\t\t\t\t// adding spaces between selects\n\t\t\t\tif (p > 0) {\n\t\t\t\t\thtml += \" \";\n\t\t\t\t}\n\t\t\t\tvar selectBoxClass = \"\";\n\t\t\t\tvar options = \"\";\n\t\t\t\tswitch (time_option) {\n\t\t\t\t\tcase \"%Y\":\n\t\t\t\t\t\tselectBoxClass = \"dhx_lightbox_year_select\";\n\t\t\t\t\t\tsns._time_format_order[3] = p;\n\t\t\t\t\t\t//year\n\t\t\t\t\t\tvar range;\n\t\t\t\t\t\tvar start_year;\n\t\t\t\t\t\tvar end_year;\n\t\t\t\t\t\tif(sns.year_range){\n\t\t\t\t\t\t\tif (!isNaN(sns.year_range)) {\n\t\t\t\t\t\t\t\trange = sns.year_range;\n\t\t\t\t\t\t\t} else if (sns.year_range.push) {\n\t\t\t\t\t\t\t\t// if\n\t\t\t\t\t\t\t\tstart_year = sns.year_range[0];\n\t\t\t\t\t\t\t\tend_year = sns.year_range[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trange = range || 10;\n\t\t\t\t\t\tvar offset = offset || Math.floor(range / 2);\n\t\t\t\t\t\tstart_year = start_year || dt.getFullYear() - offset;\n\t\t\t\t\t\tend_year = end_year || start_year + range;\n\n\t\t\t\t\t\tfor (var i = start_year; i < end_year; i++)\n\t\t\t\t\t\t\toptions += \"<option value='\" + (i) + \"'>\" + (i) + \"</option>\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"%m\":\n\t\t\t\t\t\tselectBoxClass = \"dhx_lightbox_month_select\";\n\t\t\t\t\t\tsns._time_format_order[2] = p;\n\t\t\t\t\t\t//month\n\t\t\t\t\t\tfor (var i=0; i < 12; i++)\n\t\t\t\t\t\t\toptions+=\"<option value='\"+i+\"'>\"+this.locale.date.month_full[i]+\"</option>\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"%d\":\n\t\t\t\t\t\tselectBoxClass = \"dhx_lightbox_day_select\";\n\t\t\t\t\t\tsns._time_format_order[1] = p;\n\t\t\t\t\t\t//days\n\t\t\t\t\t\tfor (var i=1; i < 32; i++)\n\t\t\t\t\t\t\toptions+=\"<option value='\"+i+\"'>\"+i+\"</option>\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"%H:%i\":\n\t\t\t\t\t\tselectBoxClass = \"dhx_lightbox_time_select\";\n\t\t\t\t\t\tsns._time_format_order[0] = p;\n\t\t\t\t\t\t//hours\n\t\t\t\t\t\tvar i = first;\n\t\t\t\t\t\tvar tdate = dt.getDate();\n\t\t\t\t\t\tsns._time_values = [];\n\n\t\t\t\t\t\twhile(i<last){\n\t\t\t\t\t\t\tvar time=this.templates.time_picker(dt);\n\t\t\t\t\t\t\toptions+=\"<option value='\"+i+\"'>\"+time+\"</option>\";\n\t\t\t\t\t\t\tsns._time_values.push(i);\n\t\t\t\t\t\t\tdt.setTime(dt.valueOf()+this.config.time_step*60*1000);\n\t\t\t\t\t\t\tvar diff = (dt.getDate()!=tdate)?1:0; // moved or not to the next day\n\t\t\t\t\t\t\ti=diff*24*60+dt.getHours()*60+dt.getMinutes();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif(options){\n\n\t\t\t\t\tvar ariaAttrs = scheduler._waiAria.lightboxSelectAttrString(time_option);\n\t\t\t\t\tvar readonly = sns.readonly ? \"disabled='disabled'\" : \"\";\n\t\t\t\t\thtml += \"<select class='\"+selectBoxClass+\"' \"+readonly + ariaAttrs+\">\"+options+\"</select> \";\n\t\t\t\t}\n\t\t\t}\n\t\t\t//var defaults = scheduler._lightbox_controls.defaults.select;\n\t\t\tconst sectionHeight = sns.height ? `style='height:${sns.height}px;'` : \"\";\n\t\t\treturn `<div class='dhx_section_time' ${sectionHeight}>${html}<span style='font-weight:normal; font-size:10pt;' class='dhx_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>${html}</div>`;\n\t\t},\n\t\tset_value:function(node,value,ev,config){\n\t\t\tvar cfg = scheduler.config;\n\t\t\tvar s=node.getElementsByTagName(\"select\");\n\t\t\tvar map = config._time_format_order;\n\t\t\tvar start_date, end_date;\n\n\t\t\tif(cfg.full_day) {\n\t\t\t\tif (!node._full_day){\n\t\t\t\t\tvar html = \"<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> \"+scheduler.locale.labels.full_day+\"&nbsp;</label></input>\";\n\t\t\t\t\tif (!scheduler.config.wide_form)\n\t\t\t\t\t\thtml = node.previousSibling.innerHTML+html;\n\t\t\t\t\tnode.previousSibling.innerHTML=html;\n\t\t\t\t\tnode._full_day=true;\n\t\t\t\t}\n\t\t\t\tvar input=node.previousSibling.getElementsByTagName(\"input\")[0];\n\t\t\t\tinput.checked = (scheduler.date.time_part(ev.start_date)===0 && scheduler.date.time_part(ev.end_date)===0);\n\n\t\t\t\ts[map[0]].disabled=input.checked;\n\t\t\t\ts[ map[0] + s.length/2 ].disabled=input.checked;\n\n\t\t\t\tif(!input.$_eventAttached){\n\t\t\t\t\tinput.$_eventAttached = true;\n\n\t\t\t\t\t\tscheduler.event(input, \"click\", function(){\n\t\t\t\t\t\tif(input.checked) {\n\t\t\t\t\t\t\tvar obj = {};\n\t\t\t\t\t\t\tscheduler.form_blocks.time.get_value(node,obj,config);\n\n\t\t\t\t\t\t\tstart_date = scheduler.date.date_part(obj.start_date);\n\t\t\t\t\t\t\tend_date = scheduler.date.date_part(obj.end_date);\n\n\t\t\t\t\t\t\tif (+end_date == +start_date || (+end_date >= +start_date && (ev.end_date.getHours() !== 0 || ev.end_date.getMinutes() !== 0)))\n\t\t\t\t\t\t\t\tend_date = scheduler.date.add(end_date, 1, \"day\");\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstart_date = null;\n\t\t\t\t\t\t\tend_date = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ts[map[0]].disabled=input.checked;\n\t\t\t\t\t\ts[ map[0] + s.length/2 ].disabled=input.checked;\n\n\t\t\t\t\t\t_fill_lightbox_select(s,0,start_date||ev.start_date);\n\t\t\t\t\t\t_fill_lightbox_select(s,4,end_date||ev.end_date);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(cfg.auto_end_date && cfg.event_duration) {\n\t\t\t\tvar _update_lightbox_select = function () {\n\t\t\t\t\t\n\t\t\t\t\tif (!(cfg.auto_end_date && cfg.event_duration)){\n\t\t\t\t\t\t// setting may be disabled after the handler is attached\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstart_date = new Date(s[map[3]].value,s[map[2]].value,s[map[1]].value,0,s[map[0]].value);\n\t\t\t\t\tend_date = new Date(start_date.getTime() + (scheduler.config.event_duration * 60 * 1000));\n\t\t\t\t\t_fill_lightbox_select(s, 4, end_date);\n\t\t\t\t};\n\t\t\t\tfor(var i=0; i<4; i++) {\n\t\t\t\t\tif(!s[i].$_eventAttached) {\n\t\t\t\t\t\ts[i].$_eventAttached = true;\n\t\t\t\t\t\tscheduler.event(s[i], \"change\", _update_lightbox_select);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction _fill_lightbox_select(s,i,d) {\n\t\t\t\tvar time_values = config._time_values;\n\t\t\t\tvar direct_value = d.getHours()*60+d.getMinutes();\n\t\t\t\tvar fixed_value = direct_value;\n\t\t\t\tvar value_found = false;\n\t\t\t\tfor (var k=0; k<time_values.length; k++) {\n\t\t\t\t\tvar t_v = time_values[k];\n\t\t\t\t\tif (t_v === direct_value) {\n\t\t\t\t\t\tvalue_found = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (t_v < direct_value)\n\t\t\t\t\t\tfixed_value = t_v;\n\t\t\t\t}\n\n\t\t\t\ts[i+map[0]].value=(value_found)?direct_value:fixed_value;\n\t\t\t\tif(!(value_found || fixed_value)){\n\t\t\t\t\ts[i+map[0]].selectedIndex = -1;//show empty select in FF\n\t\t\t\t}\n\t\t\t\ts[i+map[1]].value=d.getDate();\n\t\t\t\ts[i+map[2]].value=d.getMonth();\n\t\t\t\ts[i+map[3]].value=d.getFullYear();\n\t\t\t}\n\n\t\t\t_fill_lightbox_select(s,0,ev.start_date);\n\t\t\t_fill_lightbox_select(s,4,ev.end_date);\n\t\t},\n\t\tget_value:function(node, ev, config) {\n\t\t\tvar s = node.getElementsByTagName(\"select\");\n\t\t\tvar map = config._time_format_order;\n\n\t\t\tev.start_date=new Date(s[map[3]].value,s[map[2]].value,s[map[1]].value,0,s[map[0]].value);\n\t\t\tev.end_date=new Date(s[map[3]+4].value,s[map[2]+4].value,s[map[1]+4].value,0,s[map[0]+4].value);\n\n\t\t\tif(!(s[map[3]].value && s[map[3]+4].value)){\n\t\t\t\t// use the previous date if start/end years are empty (outside lightbox range)\n\t\t\t\tvar original = scheduler.getEvent(scheduler._lightbox_id);\n\t\t\t\tif(original){\n\t\t\t\t\tev.start_date = original.start_date;\n\t\t\t\t\tev.end_date = original.end_date;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (ev.end_date<=ev.start_date)\n\t\t\t\tev.end_date=scheduler.date.add(ev.start_date,scheduler.config.time_step,\"minute\");\n\t\t\treturn {\n\t\t\t\tstart_date: new Date(ev.start_date),\n\t\t\t\tend_date: new Date(ev.end_date)\n\t\t\t};\n\t\t},\n\t\tfocus:function(node){\n\t\t\tscheduler._focus(node.getElementsByTagName(\"select\")[0]);\n\t\t}\n\t}\n\n};\n\n\t// GS-2214. Attaching the lightbox to the BODY element is not considered secure.\n\t// Attach it to Scheduler container for Salesforce and other secure environments\n\tfunction getLightboxRoot(){\n\t\tconst cspEnvironment = scheduler.config.csp === true;\n\t\tconst salesforceEnvironment = !!window[\"Sfdc\"] || !!window[\"$A\"] || window[\"Aura\"] || ('$shadowResolver$' in document.body);\n\t\tif (cspEnvironment || salesforceEnvironment) {\n\t\t\treturn scheduler.$root;\n\t\t} else {\n\t\t\treturn document.body;\n\t\t}\n\t}\n\nscheduler._setLbPosition = function(box) {\n\tif(!box){\n\t\treturn;\n\t}\n\n\tbox.style.top = Math.max(getLightboxRoot().offsetHeight / 2 - box.offsetHeight/2, 0) + \"px\";\n\tbox.style.left = Math.max(getLightboxRoot().offsetWidth / 2 - box.offsetWidth/2, 0) + \"px\";\n\n};\n\nscheduler.showCover=function(box){\n\tif (box){\n\t\tbox.style.display=\"block\";\n\n\t\tthis._setLbPosition(box);\n\t}\n\tif(scheduler.config.responsive_lightbox){\n\t\tdocument.documentElement.classList.add(\"dhx_cal_overflow_container\");\n\t\tgetLightboxRoot().classList.add(\"dhx_cal_overflow_container\");\n\t}\n\tthis.show_cover();\n\tthis._cover.style.display = \"\";\n};\nscheduler.showLightbox=function(id){\n\tif (!id) return;\n\tif (!this.callEvent(\"onBeforeLightbox\",[id])) {\n\t\tif (this._new_event)\n\t\t\tthis._new_event = null;\n\t\treturn;\n\t}\n\tthis.showCover(box);\n\tvar box = this.getLightbox();\n\tthis._setLbPosition(box);\n\tthis._fill_lightbox(id,box);\n\tthis._waiAria.lightboxVisibleAttr(box);\n\t\n\tthis.callEvent(\"onLightbox\",[id]);\n};\nscheduler._fill_lightbox = function(id, box) {\n\tvar ev = this.getEvent(id);\n\tvar s = box.getElementsByTagName(\"span\");\n\tvar lightboxHeader = [];\n\n\tif (scheduler.templates.lightbox_header) {\n\t\tlightboxHeader.push(\"\");\n\t\tvar headerContent = scheduler.templates.lightbox_header(ev.start_date, ev.end_date, ev);\n\t\tlightboxHeader.push(headerContent);\n\t\ts[1].innerHTML = \"\";\n\t\ts[2].innerHTML = headerContent;\n\t} else {\n\t\tvar headerDate = this.templates.event_header(ev.start_date, ev.end_date, ev);\n\t\tvar headerTitle = (this.templates.event_bar_text(ev.start_date, ev.end_date, ev) || \"\").substr(0, 70); //IE6 fix;\n\n\t\tlightboxHeader.push(headerDate);\n\t\tlightboxHeader.push(headerTitle);\n\t\ts[1].innerHTML = headerDate;\n\t\ts[2].innerHTML = headerTitle;\n\t}\n\n\tthis._waiAria.lightboxHeader(box,  lightboxHeader.join(\" \"));\n\n\tvar sns = this.config.lightbox.sections;\n\tfor (var i = 0; i < sns.length; i++) {\n\t\tvar current_sns = sns[i];\n\t\tvar node = scheduler._get_lightbox_section_node(current_sns);\n\t\tvar block = this.form_blocks[current_sns.type];\n\t\tvar value = (ev[current_sns.map_to] !== undefined) ? ev[current_sns.map_to] : current_sns.default_value;\n\t\tblock.set_value.call(this, node, value, ev, current_sns);\n\t\tif (sns[i].focus)\n\t\t\tblock.focus.call(this, node);\n\t}\n\n\tscheduler._lightbox_id = id;\n};\n\nscheduler._get_lightbox_section_node = function(section){\n\treturn scheduler._lightbox.querySelector(`#${section.id}`).nextSibling;\n};\n\nscheduler._lightbox_out=function(ev){\n\tvar sns = this.config.lightbox.sections;\n\tfor (var i=0; i < sns.length; i++) {\n\t\tvar node = scheduler._lightbox.querySelector(`#${sns[i].id}`);\n\t\tnode=(node?node.nextSibling:node);\n\t\tvar block=this.form_blocks[sns[i].type];\n\t\tvar res=block.get_value.call(this,node,ev, sns[i]);\n\t\tif (sns[i].map_to!=\"auto\")\n\t\t\tev[sns[i].map_to]=res;\n\t}\n\treturn ev;\n};\nscheduler._empty_lightbox=function(data){\n\tvar id=scheduler._lightbox_id;\n\tvar ev=this.getEvent(id);\n\t//var box=this.getLightbox();\n\n\tthis._lame_copy(ev, data);\n\n\tthis.setEvent(ev.id,ev);\n\tthis._edit_stop_event(ev,true);\n\tthis.render_view_data();\n};\nscheduler.hide_lightbox=function(id){\n\tscheduler.endLightbox(false, this.getLightbox());\n};\n\nscheduler.hideCover=function(box){\n\tif (box) box.style.display=\"none\";\n\tthis.hide_cover();\n\tif(scheduler.config.responsive_lightbox){\n\t\tdocument.documentElement.classList.remove(\"dhx_cal_overflow_container\");\n\t\tgetLightboxRoot().classList.remove(\"dhx_cal_overflow_container\");\n\t}\n};\nscheduler.hide_cover=function(){\n\tif (this._cover)\n\t\tthis._cover.parentNode.removeChild(this._cover);\n\tthis._cover=null;\n};\n\nscheduler.show_cover=function(){\n\tif(this._cover) {\n\t\treturn;\n\t}\n\n\tthis._cover=document.createElement(\"div\");\n\tthis._cover.className=\"dhx_cal_cover\";\n\tthis._cover.style.display = \"none\";\n\n\tscheduler.event(this._cover, \"mousemove\", scheduler._move_while_dnd);\n\tscheduler.event(this._cover, \"mouseup\", scheduler._finish_dnd);\n\n\tgetLightboxRoot().appendChild(this._cover);\n};\nscheduler.save_lightbox=function(){\n\tvar data = this._lightbox_out({}, this._lame_copy(this.getEvent(this._lightbox_id)));\n\tif (this.checkEvent(\"onEventSave\") && !this.callEvent(\"onEventSave\",[this._lightbox_id, data, this._new_event]))\n\t\treturn;\n\tthis._empty_lightbox(data);\n\tthis.hide_lightbox();\n};\nscheduler.startLightbox = function(id, box){\n\tthis._lightbox_id = id;\n\tthis._custom_lightbox = true;\n\n\tthis._temp_lightbox = this._lightbox;\n\tthis._lightbox = box;\n\tthis.showCover(box);\n};\nscheduler.endLightbox = function(mode, box){\n\tvar box = box || scheduler.getLightbox();\n\n\tvar event = scheduler.getEvent(this._lightbox_id);\n\tif(event)\n\t\tthis._edit_stop_event(event, mode);\n\tif (mode)\n\t\tscheduler.render_view_data();\n\tthis.hideCover(box);\n\n\tif (this._custom_lightbox){\n\t\tthis._lightbox = this._temp_lightbox;\n\t\tthis._custom_lightbox = false;\n\t}\n\tthis._temp_lightbox = this._lightbox_id = null; // in case of custom lightbox user only calls endLightbox so we need to reset _lightbox_id\n\tthis._waiAria.lightboxHiddenAttr(box);\n\tthis.resetLightbox();\n\tthis.callEvent(\"onAfterLightbox\",[]);\n};\nscheduler.resetLightbox = function(){\n\tif (scheduler._lightbox && !scheduler._custom_lightbox)\n\t\tscheduler._lightbox.parentNode.removeChild(scheduler._lightbox);\n\tscheduler._lightbox = null;\n};\nscheduler.cancel_lightbox=function(){\n\tif(this._lightbox_id){\n\t\tthis.callEvent(\"onEventCancel\",[this._lightbox_id, !!this._new_event]);\n\t}\n\n\tthis.hide_lightbox();\n};\nscheduler.hideLightbox = scheduler.cancel_lightbox;// GS-1650 need to use cancel in order to fire onEventCancel event, which is important to refresh the state of recurring series\n\nscheduler._init_lightbox_events=function(){\n\tif(this.getLightbox().$_eventAttached){\n\t\treturn;\t\n\t}\n\tconst lightbox = this.getLightbox();\n\tlightbox.$_eventAttached = true;\n\n\tscheduler.event(lightbox, \"click\", function(e){\n\n\t\tif(e.target.closest(\".dhx_cal_ltitle_close_btn\")){\n\t\t\tscheduler.cancel_lightbox();\n\t\t}\n\t\t\n\t\tconst buttonTarget = scheduler.$domHelpers.closest(e.target, \".dhx_btn_set\");\n\t\tif(!buttonTarget) {\n\t\t\tconst sectionButton = scheduler.$domHelpers.closest(e.target, \".dhx_custom_button[data-section-index]\");\n\t\t\tif(sectionButton){\n\t\t\t\tconst index = Number(sectionButton.getAttribute(\"data-section-index\"));\n\t\t\t\tconst block = scheduler.form_blocks[scheduler.config.lightbox.sections[index].type];\n\t\t\t\tblock.button_click(scheduler.$domHelpers.closest(sectionButton, \".dhx_cal_lsection\"), sectionButton, e);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconst action = buttonTarget ? buttonTarget.getAttribute(\"data-action\") : null;\n\n\t\tswitch(action){\n\t\t\tcase \"dhx_save_btn\":\n\t\t\tcase \"save\":\n\t\t\t\tif(scheduler.config.readonly_active){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tscheduler.save_lightbox();\n\t\t\t\tbreak;\n\t\t\tcase \"dhx_delete_btn\":\n\t\t\tcase \"delete\":\n\t\t\t\tif(scheduler.config.readonly_active){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar c=scheduler.locale.labels.confirm_deleting;\n\n\t\t\t\tscheduler._dhtmlx_confirm({message: c, title: scheduler.locale.labels.title_confirm_deleting, callback: function(){\n\t\t\t\t\tlet ev = scheduler.getEvent(scheduler._lightbox_id);\n\t\t\t\t\t// GS-2578: case for removing following events\n\t\t\t\t\tif (ev._thisAndFollowing){\n\t\t\t\t\t\tev._removeFollowing = true;\n\t\t\t\t\t\tscheduler.callEvent(\"onEventSave\", [ev.id, ev,scheduler._new_event]);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tscheduler.deleteEvent(scheduler._lightbox_id);\n\t\t\t\t\t}\n\t\t\t\t\tscheduler._new_event = null; //clear flag, if it was unsaved event\n\t\t\t\t\tscheduler.hide_lightbox();\n\t\t\t\t},\n\t\t\t\tconfig: {ok: scheduler.locale.labels.icon_delete}});\n\n\t\t\t\tbreak;\n\t\t\tcase \"dhx_cancel_btn\":\n\t\t\tcase \"cancel\":\n\t\t\t\tscheduler.cancel_lightbox();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tscheduler.callEvent(\"onLightboxButton\", [action, buttonTarget, e]);\n\t\t}\n\t});\n\tscheduler.event(lightbox, \"keydown\", function(e){\n\t\tvar event = e || window.event;\n\t\tvar target = e.target || e.srcElement;\n\t\tvar buttonTarget = target.querySelector(\"[dhx_button]\");\n\n\t\tif(!buttonTarget){\n\t\t\tbuttonTarget = target.parentNode.querySelector(\".dhx_custom_button, .dhx_readonly\");\n\t\t}\n\n\t\tswitch((e||event).keyCode){\n\t\t\tcase 32:{//space\n\t\t\t\tif ((e||event).shiftKey) return;\n\t\t\t\tif(buttonTarget && buttonTarget.click){\n\t\t\t\t\tbuttonTarget.click();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase scheduler.keys.edit_save:\n\t\t\t\tif ((e||event).shiftKey) return;\n\t\t\t\tif(buttonTarget && buttonTarget.click){\n\t\t\t\t\tbuttonTarget.click();\n\t\t\t\t}else{\n\t\t\t\t\tif(scheduler.config.readonly_active){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tscheduler.save_lightbox();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase scheduler.keys.edit_cancel:\n\t\t\t\tscheduler.cancel_lightbox();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t});\n\tfunction getDaysInMonth(year, month){\n\t\treturn new Date(year, month + 1, 0).getDate();\n\t}\n\t// GS-1680: setting the correct number of days in month\n\tscheduler.event(lightbox, \"click\", function(e){\n\t\tif (e.target.closest(\".dhx_lightbox_day_select\") || e.target.closest(\".dhx_lightbox_month_select\")) {\n\t\t\tconst monthSelectNodes = lightbox.querySelectorAll(\".dhx_lightbox_month_select\");\n\t\t\tconst daySelectNodes = lightbox.querySelectorAll(\".dhx_lightbox_day_select\");\n\t\t\tconst yearSelectNodes = lightbox.querySelectorAll(\".dhx_lightbox_year_select\");\n\n\t\t\tif (monthSelectNodes.length && daySelectNodes.length && yearSelectNodes) {\n\t\t\t\tmonthSelectNodes.forEach((select, i) => {\n\t\t\t\t\tconst daySelect = daySelectNodes[i];\n\t\t\t\t\tconst month = parseInt(select.value, 10);\n\t\t\t\t\tlet year = parseInt(yearSelectNodes[i].value, 10);\n\t\t\t\t\tif(!year){\n\t\t\t\t\t\tyear = new Date(scheduler.getState().date).getFullYear(); // case when there is no year selects\n\t\t\t\t\t}\n\t\t\t\t\tconst daysInMonth = getDaysInMonth(year, month);\n\t\t\t\t\tconst maxDays = daysInMonth || 31;\n\t\t\t\t\tlet curDayValue = daySelect.value;\n\t\t\t\t\t// need to remove all options\n\t\t\t\t\tdaySelect.innerHTML = \"\";\n\t\t\t\t\tfor (let day = 1; day <= maxDays; day++) {\n\t\t\t\t\t\tconst option = document.createElement('option');\n\t\t\t\t\t\toption.value = day;\n\t\t\t\t\t\toption.textContent = day;\n\t\t\t\t\t\tdaySelect.appendChild(option);\n\t\t\t\t\t}\n\t\t\t\t\tdaySelect.value = Math.min(curDayValue, maxDays); // set the correct max day\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n};\nscheduler.setLightboxSize=function(){\n\treturn;\n/* TODO: inspect and remove in 7.0\n\tvar d = this._lightbox;\n\tif (!d) return;\n\n\tvar con = d.childNodes[1];\n\tcon.style.height=\"0px\";\n\tcon.style.height=con.scrollHeight+\"px\";\n\td.style.height=con.scrollHeight+scheduler.xy.lightbox_additional_height+\"px\";\n\tcon.style.height=con.scrollHeight+\"px\"; //it is incredible , how ugly IE can be*/\n};\n\nscheduler._init_dnd_events = function(){\n\tscheduler.event(getLightboxRoot(), \"mousemove\", scheduler._move_while_dnd);\n\tscheduler.event(getLightboxRoot(), \"mouseup\", scheduler._finish_dnd);\n\tscheduler._init_dnd_events = function(){};\n };\nscheduler._move_while_dnd = function(e){\n\tif (scheduler._dnd_start_lb){\n\t\tif (!document.dhx_unselectable){\n\t\t\tgetLightboxRoot().classList.add(\"dhx_unselectable\");\n\t\t\tdocument.dhx_unselectable = true;\n\t\t}\n\t\tvar lb = scheduler.getLightbox();\n\t\tvar now = [e.pageX, e.pageY];\n\t\tlb.style.top = scheduler._lb_start[1]+now[1]-scheduler._dnd_start_lb[1]+\"px\";\n\t\tlb.style.left = scheduler._lb_start[0]+now[0]-scheduler._dnd_start_lb[0]+\"px\";\n\t}\n};\nscheduler._ready_to_dnd = function(e){\n\tvar lb = scheduler.getLightbox();\n\tscheduler._lb_start = [lb.offsetLeft, lb.offsetTop];\n\tscheduler._dnd_start_lb = [e.pageX, e.pageY];\n};\nscheduler._finish_dnd = function(){\n\tif (scheduler._lb_start){\n\t\tscheduler._lb_start = scheduler._dnd_start_lb = false;\n\t\tgetLightboxRoot().classList.remove(\"dhx_unselectable\");\n\t\tdocument.dhx_unselectable = false;\n\t}\n};\nscheduler.getLightbox=function(){ //scheduler.config.wide_form=true;\n\tif (!this._lightbox){\n\t\tvar d=document.createElement(\"div\");\n\t\td.className=\"dhx_cal_light\";\n\t\tif (scheduler.config.wide_form)\n\t\t\td.className+=\" dhx_cal_light_wide\";\n\t\tif (scheduler.form_blocks.recurring)\n\t\t\td.className+=\" dhx_cal_light_rec\";\n\t\tif (scheduler.config.rtl)\n\t\t\td.className+=\" dhx_cal_light_rtl\";\n\t\tif (scheduler.config.responsive_lightbox)\n\t\t\td.className += \" dhx_cal_light_responsive\";\n\n\t\td.style.visibility=\"hidden\";\n\t\tvar html = this._lightbox_template;\n\n\t\tvar buttons = this.config.buttons_right;\n\n\n\t\thtml += \"<div class='dhx_cal_lcontrols'>\";\n\t\tvar ariaAttr = \"\";\n\t\tfor (var i = 0; i < buttons.length; i++) {\n\t\t\tariaAttr = this._waiAria.lightboxButtonAttrString(buttons[i]);\n\t\t\thtml += \"<div \"+ariaAttr+\" data-action='\"+ buttons[i]+\"' class='dhx_btn_set dhx_\"+(scheduler.config.rtl?\"right\":\"left\")+\"_btn_set \" + buttons[i] + \"_set'><div class='dhx_btn_inner \" + buttons[i] + \"'></div><div>\" + scheduler.locale.labels[buttons[i]] + \"</div></div>\";\n\t\t}\n\n\t\tbuttons = this.config.buttons_left;\n\t\tvar rtl = scheduler.config.rtl;\n\t\tfor (var i = 0; i < buttons.length; i++) {\n\t\t\tariaAttr = this._waiAria.lightboxButtonAttrString(buttons[i]);\n\n\t\t\thtml += \"<div class='dhx_cal_lcontrols_push_right'></div>\";\n\n\t\t\thtml += \"<div \"+ariaAttr+\" data-action='\"+ buttons[i]+\"' class='dhx_btn_set dhx_\"+(rtl?\"left\":\"right\")+\"_btn_set \" +\n\t\t\t\t\t\tbuttons[i] + \"_set'><div class='dhx_btn_inner \" +\n\t\t\t\t\t\tbuttons[i] + \"'></div><div>\" + scheduler.locale.labels[buttons[i]] + \"</div></div>\";\n\t\t}\n\t\thtml += \"</div>\";\n\t\thtml+=\"</div>\";\n\t\td.innerHTML=html;\n\t\tif (scheduler.config.drag_lightbox){\n\t\t\tscheduler.event(d.firstChild, \"mousedown\", scheduler._ready_to_dnd);\n\t\t\tscheduler.event(d.firstChild, \"selectstart\", function(e){ \n\t\t\t\te.preventDefault();\n\t\t\t\treturn false; \n\t\t\t});\n\t\t\td.firstChild.style.cursor = \"move\";\n\t\t\tscheduler._init_dnd_events();\n\n\t\t}\n\n\t\tthis._waiAria.lightboxAttr(d);\n\n\t\tthis.show_cover();\n\t\tthis._cover.insertBefore(d,this._cover.firstChild);\n\t\t\n\t\tthis._lightbox=d;\n\n\t\tvar sns=this.config.lightbox.sections;\n\t\thtml=\"\";\n\t\tfor (var i=0; i < sns.length; i++) {\n\t\t\tvar block=this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue; //ignore incorrect blocks\n\t\t\tsns[i].id=\"area_\"+this.uid();\n\t\t\tvar button = \"\";\n\t\t\tif (sns[i].button){\n\t\t\t\tvar ariaAttr = scheduler._waiAria.lightboxSectionButtonAttrString(this.locale.labels[\"button_\"+sns[i].button]);\n\t\t\t\tbutton = \"<div \"+ariaAttr+\" class='dhx_custom_button' data-section-index='\"+i+\"' index='\"+i+\"'><div class='dhx_custom_button_\"+sns[i].button+\"'></div><div>\"+this.locale.labels[\"button_\"+sns[i].button]+\"</div></div>\";\n\t\t\t}\n\n\t\t\tif (this.config.wide_form){\n\t\t\t\thtml+=\"<div class='dhx_wrap_section'>\";\n\t\t\t}\n\n\t\t\tvar label_name = this.locale.labels[\"section_\"+sns[i].name];\n\t\t\tif(typeof label_name !== \"string\"){\n\t\t\t\tlabel_name = sns[i].name;\n\t\t\t}\n\t\t\thtml+=\"<div id='\"+sns[i].id+\"' class='dhx_cal_lsection dhx_cal_lsection_\"+sns[i].name+\"'>\"+button+ \"<label>\"+label_name+\"</label></div>\"+block.render.call(this,sns[i]);\n\t\t\thtml+=\"</div>\";\n\t\t}\n\n\t\tvar ds=d.getElementsByTagName(\"div\");\n\t\tfor (var i=0; i<ds.length; i++) {\n\t\t\tvar t_ds = ds[i];\n\t\t\tvar className = scheduler._getClassName(t_ds);\n\t\t\tif (className == \"dhx_cal_larea\") {\n\t\t\t\tt_ds.innerHTML = html;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// bind labels to lightbox inputs\n\t\tscheduler._bindLightboxLabels(sns);\n\n\t\t//sizes\n\t\tthis.setLightboxSize();\n\n\t\tthis._init_lightbox_events(this);\n\t\t//d.style.display=\"none\";\n\t\td.style.visibility=\"visible\";\n\t}\n\n\n\treturn this._lightbox;\n};\n\nscheduler._bindLightboxLabels = function(sections){\n\t// link section labels to controls using label[for] attribute and label.onclick=control.focus as a fallback\n\t// label[for] is preferable for accessibility reasons\n\n\tfor(var i = 0; i < sections.length; i++){\n\t\tvar section = sections[i];\n\t\tif(!section.id || !scheduler._lightbox.querySelector(`#${section.id}`))\n\t\t\tcontinue;\n\n\t\tvar labelBlock = scheduler._lightbox.querySelector(`#${section.id}`);\n\t\tvar label = labelBlock.querySelector(\"label\");\n\n\t\tvar inputBlock = scheduler._get_lightbox_section_node(section);\n\t\twhile(inputBlock && !inputBlock.querySelector){\n\t\t\tinputBlock = inputBlock.nextSibling;\n\t\t}\n\n\t\tvar fallback = true;\n\n\t\tif(inputBlock) {\n\t\t\tvar input = inputBlock.querySelector(\"input, select, textarea\");\n\t\t\tif(input){\n\t\t\t\tsection.inputId = input.id || \"input_\" + scheduler.uid();\n\t\t\t\tif(!input.id)\n\t\t\t\t\tinput.id = section.inputId;\n\t\t\t\tlabel.setAttribute(\"for\", section.inputId);\n\t\t\t\tfallback = false;\n\t\t\t}\n\t\t}\n\n\t\t// use control.focus if failed to bind input using label[for]\n\t\tif(fallback){\n\t\t\tvar control = scheduler.form_blocks[section.type];\n\t\t\tif(control.focus){\n\t\t\t\tscheduler.event(label, \"click\", (function(section){\n\t\t\t\t\treturn function(){\n\n\t\t\t\t\t\tvar block = scheduler.form_blocks[section.type];\n\t\t\t\t\t\tvar node = scheduler._get_lightbox_section_node(section);\n\n\t\t\t\t\t\tif(block && block.focus)\n\t\t\t\t\t\t\tblock.focus.call(scheduler, node);\n\t\t\t\t\t};\n\t\t\t\t})(section));\n\t\t\t}\n\t\t}\n\t}\n};\n\nscheduler.attachEvent(\"onEventIdChange\", function(old_id, new_id){\n\tif(this._lightbox_id == old_id)\n\t\tthis._lightbox_id = new_id;\n});\n\nscheduler._lightbox_template= `<div class='dhx_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"dhx_cal_ltitle_controls\">\n<a class=\"dhx_cal_ltitle_close_btn scheduler_icon close\"></a>\n</div></div><div class='dhx_cal_larea'></div>`;\n\n\n}","export default function extend(scheduler) {\n\n\nscheduler._init_touch_events = function(){\n\tvar mobile = this.config.touch  &&\n\t\t( ((navigator.userAgent.indexOf(\"Mobile\")!=-1)   ||\n\t\t\t(navigator.userAgent.indexOf(\"iPad\")!=-1)       ||\n\t\t\t(navigator.userAgent.indexOf(\"Android\")!=-1)    ||\n\t\t\t(navigator.userAgent.indexOf(\"Touch\")!=-1)) && !window.MSStream) ||\n\t\t\t((navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1));\n\n\tif(mobile){\n\t\tthis.xy.scroll_width = 0;\n\t\tthis._mobile = true;\n\t}\n\n\tif(this.config.touch){\n\n\t\tvar touchEventsSupported = true;\n\t\ttry {\n\t\t\tdocument.createEvent(\"TouchEvent\");\n\t\t} catch (e) {\n\t\t\ttouchEventsSupported = false;\n\t\t}\n\n\t\tif (touchEventsSupported) {\n\t\t\tthis._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (ev) {\n\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\tif (ev.touches[0])\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t};\n\t\t\t\telse\n\t\t\t\t\treturn ev;\n\t\t\t}, function () {\n\t\t\t\treturn false;\n\t\t\t});\n\t\t} else if (window.PointerEvent || window.navigator.pointerEnabled) {\n\t\t\tthis._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (ev) {\n\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\treturn ev;\n\t\t\t}, function (ev) {\n\t\t\t\treturn (!ev || (ev.pointerType == \"mouse\" ));\n\t\t\t});\n\t\t} else if (window.navigator.msPointerEnabled) {\n\t\t\tthis._touch_events([\"MSPointerMove\", \"MSPointerDown\", \"MSPointerUp\"], function (ev) {\n\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\n\t\t\t\treturn ev;\n\t\t\t}, function (ev) {\n\t\t\t\treturn (!ev || ev.pointerType == ev.MSPOINTER_TYPE_MOUSE);\n\t\t\t});\n\t\t}\n\t}\n};\n\nscheduler._touch_events = function(names, accessor, ignore){\n\t//webkit on android need to be handled separately\n\t//var a_webkit = (navigator.userAgent.indexOf(\"Android\")!=-1) && (navigator.userAgent.indexOf(\"WebKit\")!=-1);\n\tvar source, tracker, timer, drag_mode, scroll_mode, action_mode;\n\tvar dblclicktime = 0;\n\n\tfunction attachTouchEvent(element, name, callback){\n\t\t//touch gestures must be disabled when ligthbox is opened\n\t\tscheduler.event(element, name, function(e){\n\t\t\tif(scheduler._is_lightbox_open()){\n\t\t\t\treturn true;\n\t\t\t}else{\n\t\t\t\tif (ignore(e)) return;\n\t\t\t\treturn callback(e);\n\t\t\t}\n\t\t}, { passive: false });\n\t}\n\n\tfunction check_direction_swipe(s_ev, e_ev, step, max_dy){\n\t\tif (!s_ev || !e_ev) return false;\n\n\t\tvar t = s_ev.target;\n\t\twhile(t && t != scheduler._obj){\n\t\t\tt = t.parentNode;\n\t\t}\n\t\tif(t != scheduler._obj){\n\t\t\t//swipe outside scheduler\n\t\t\treturn false;\n\t\t}\n\n\t\t// ignore swipe in horizontal timeline\n\t\tif(scheduler.matrix && scheduler.matrix[scheduler.getState().mode]){\n\t\t\tvar timeline = scheduler.matrix[scheduler.getState().mode];\n\t\t\tif(timeline.scrollable){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tvar dy = Math.abs(s_ev.pageY - e_ev.pageY);\n\t\tvar dx = Math.abs(s_ev.pageX - e_ev.pageX);\n\t\tif (dy < max_dy && dx>step && (!dy || (dx/dy > 3))){\n\t\t\tif (s_ev.pageX > e_ev.pageX) {\n\t\t\t\tscheduler._click.dhx_cal_next_button();\n\t\t\t}else {\n\t\t\t\tscheduler._click.dhx_cal_prev_button();\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction doMouseMove(e){\n\t\tif (ignore(e)) return;\n\t\tvar dnd = scheduler.getState().drag_mode,\n\t\t\ttimeline = scheduler.matrix ? scheduler.matrix[scheduler._mode] : false;\n\n\t\tvar original_render = scheduler.render_view_data;\n\t\tif(dnd == 'create' && timeline){\n\t\t\t//suppress full redraw of timeline on creating event\n\t\t\tscheduler.render_view_data = function() {\n\t\t\t\tvar id = scheduler.getState().drag_id;\n\t\t\t\tvar ev = scheduler.getEvent(id);\n\t\t\t\tvar property = timeline.y_property;\n\n\t\t\t\tvar evs = scheduler.getEvents(ev.start_date, ev.end_date);\n\t\t\t\tfor(var i = 0; i < evs.length; i++){\n\t\t\t\t\tif(evs[i][property] != ev[property]){\n\t\t\t\t\t\tevs.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tev._sorder = evs.length - 1;\n\t\t\t\tev._count = evs.length;\n\n\t\t\t\tthis.render_data([ev], scheduler.getState().mode);\n\n\t\t\t};\n\t\t}\n\n\t\tscheduler._on_mouse_move(e);\n\n\t\tif(dnd == 'create' && timeline){\n\t\t\tscheduler.render_view_data = original_render;\n\t\t}\n\n\t\tif (e.preventDefault)\n\t\t\te.preventDefault();\n\t\te.cancelBubble = true;\n\t\treturn false;\n\t}\n\n\t// touchmove\n\tattachTouchEvent(document.body, names[0], function(e){\n\t\tif (ignore(e)) return;\n\n\t\tvar acc = accessor(e);\n\t\tif(!acc) return;\n\t\tif (drag_mode){\n\t\t\tdoMouseMove(acc);\n\n\t\t\tif (e.preventDefault)\n\t\t\t\te.preventDefault();\n\t\t\te.cancelBubble = true;\n\t\t\tscheduler._update_global_tip();\n\t\t\treturn false;\n\t\t}\n\t\t//if (tracker && a_webkit){\n\t\t//\tcheck_direction_swipe(tracker, accessor(e), 0);\n\t\t//}\n\n\t\ttracker = accessor(e);\n\t\t//ignore common and scrolling moves\n\t\tif (!action_mode) return;\n\n\t\t//multitouch\n\t\tif (!tracker){\n\t\t\tscroll_mode = true;\n\t\t\treturn;\n\t\t}\n\n\t\t//target changed - probably in scroll mode\n\n\t\tif (source.target != tracker.target || (Math.abs(source.pageX - tracker.pageX) > 5) || (Math.abs(source.pageY - tracker.pageY) > 5)){\n\t\t\tscroll_mode = true;\n\t\t\tclearTimeout(timer);\n\t\t}\n\n\t});\n\n\t//attachTouchEvent(this._els[\"dhx_cal_data\"][0], \"scroll\", drag_cancel);\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], \"touchcancel\", drag_cancel);\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], \"contextmenu\", function(e){\n\t\tif (ignore(e)) return;\n\t\tif (action_mode){\n\t\t\tif (e && e.preventDefault)\n\t\t\t\te.preventDefault();\n\t\t\te.cancelBubble = true;\n\t\t\treturn false;\n\t\t}\n\t});\n\n\t// touchstart\n\tattachTouchEvent(this._obj, names[1], function(e){\n\t\t// block pull-to-refresh\n\t\tif(document && document.body){\n\t\t\tdocument.body.classList.add(\"dhx_cal_touch_active\");\n\t\t}\n\n\t\tif (ignore(e)) return;\n\t\tscheduler._pointerDragId = e.pointerId;\n\n\t\tvar fake_event;\n\t\tdrag_mode = scroll_mode = false;\n\t\taction_mode = true;\n\t\tfake_event = tracker = accessor(e);\n\n\t\tif (!fake_event){\n\t\t\tscroll_mode = true;\n\t\t\treturn;\n\t\t}\n\n\t\t//dbl click\n\t\tvar now = new Date();\n\n\t\tif (!scroll_mode && !drag_mode && now - dblclicktime < 250){\n\t\t\tscheduler._click.dhx_cal_data(fake_event);\n\t\t\twindow.setTimeout(function(){\n\t\t\t\tif(scheduler.$destroyed){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//fake_event.type = \"dblclick\";\n\t\t\t\tscheduler._on_dbl_click(fake_event);\n\t\t\t}, 50);\n\n\t\t\tif (e.preventDefault)\n\t\t\t\te.preventDefault();\n\t\t\te.cancelBubble = true;\n\t\t\tscheduler._block_next_stop = true;\n\t\t\treturn false;\n\t\t}\n\t\tdblclicktime = now;\n\n\t\t//drag\n\n\t\tif (scroll_mode || drag_mode || !scheduler.config.touch_drag)\n\t\t\treturn;\n\n\t\tvar actTask = scheduler._locate_event(document.activeElement);\n\t\tvar fakeTask = scheduler._locate_event(fake_event.target);\n\t\tvar sourceTask = source? scheduler._locate_event(source.target) : null;\n\n\t\tif(actTask && fakeTask && actTask == fakeTask && actTask != sourceTask)\n\t\t{\n\t\t\tif(e.preventDefault) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.cancelBubble = true;\n\t\t\tscheduler._ignore_next_click = false;\n\t\t\tscheduler._click.dhx_cal_data(fake_event);\n\t\t\tsource = fake_event;\n\t\t\treturn false;\n\t\t}\n\t\t//there is no target\n\t\ttimer = setTimeout(function(){\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdrag_mode = true;\n\t\t\tvar target = source.target;\n\t\t\tvar className = scheduler._getClassName(target);\n\t\t\tif (target && className.indexOf(\"dhx_body\") != -1)\n\t\t\t\ttarget = target.previousSibling;\n\n\t\t\tscheduler._on_mouse_down(source, target);\n\t\t\tif (scheduler._drag_mode && scheduler._drag_mode != \"create\"){\n\t\t\t\tscheduler.for_rendered(scheduler._drag_id, function(node, i) {\n\t\t\t\t\tnode.style.display='none';\n\t\t\t\t\tscheduler._rendered.splice(i, 1);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (scheduler.config.touch_tip) {\n\t\t\t\tscheduler._show_global_tip();\n\t\t\t}\n\t\t\tscheduler.updateEvent(scheduler._drag_id);\n\t\t},scheduler.config.touch_drag);\n\n\t\tsource = fake_event;\n\t});\n\tfunction drag_cancel(e){\n\t\tif (ignore(e)) return;\n\t\tscheduler._hide_global_tip();\n\t\tif (drag_mode){\n\t\t\tscheduler._on_mouse_up( accessor(e) );\n\t\t\tscheduler._temp_touch_block = false;\n\t\t}\n\t\tscheduler._drag_id = null;\n\t\tscheduler._drag_mode=null;\n\t\tscheduler._drag_pos=null;\n\t\tscheduler._pointerDragId = null;\n\t\tclearTimeout(timer);\n\t\tdrag_mode = action_mode = false;\n\t\tscroll_mode = true;\n\t}\n\n\t// touch end\n\tattachTouchEvent(this._els[\"dhx_cal_data\"][0], names[2], function(e){\n\t\tif(document && document.body){\n\t\t\tdocument.body.classList.remove(\"dhx_cal_touch_active\");\n\t\t}\n\n\t\tif (ignore(e)) return;\n\n\t\tif(scheduler.config.touch_swipe_dates){\n\t\t\tif (!drag_mode && check_direction_swipe(source, tracker, 200, 100)) {\n\t\t\t\tscheduler._block_next_stop = true;\n\t\t\t}\n\t\t}\n\n\t\tif (drag_mode) {\n\t\t\tscheduler._ignore_next_click = true;\n\t\t\tsetTimeout(function(){\n\t\t\t\tscheduler._ignore_next_click = false;\n\t\t\t}, 100);\n\t\t}\n\n\t\tdrag_cancel(e);\n\t\tif (scheduler._block_next_stop){\n\t\t\tscheduler._block_next_stop = false;\n\t\t\tif (e.preventDefault)\n\t\t\t\te.preventDefault();\n\t\t\te.cancelBubble = true;\n\t\t\treturn false;\n\t\t}\n\t});\n\n\tscheduler.event(document.body, names[2], drag_cancel);\n};\n\nscheduler._show_global_tip = function(){\n\tscheduler._hide_global_tip();\n\n\tvar toptip = scheduler._global_tip = document.createElement(\"div\");\n\ttoptip.className='dhx_global_tip';\n\n\tscheduler._update_global_tip(1);\n\n\tdocument.body.appendChild(toptip);\n};\nscheduler._update_global_tip = function(init){\n\tvar toptip = scheduler._global_tip;\n\tif (toptip){\n\t\tvar time = \"\";\n\t\tif (scheduler._drag_id && !init){\n\t\t\tvar ev = scheduler.getEvent(scheduler._drag_id);\n\t\t\tif (ev)\n\t\t\t\ttime = \"<div>\" + (ev._timed ? scheduler.templates.event_header(ev.start_date, ev.end_date, ev):scheduler.templates.day_date(ev.start_date, ev.end_date, ev)) + \"</div>\";\n\t\t}\n\n\t\tif (scheduler._drag_mode == \"create\" || scheduler._drag_mode == \"new-size\")\n\t\t\ttoptip.innerHTML = (scheduler.locale.labels.drag_to_create || \"Drag to create\")+time;\n\t\telse\n\t\t\ttoptip.innerHTML = (scheduler.locale.labels.drag_to_move || \"Drag to move\")+time;\n\t}\n};\nscheduler._hide_global_tip = function(){\n\tvar toptip = scheduler._global_tip;\n\tif (toptip && toptip.parentNode){\n\t\ttoptip.parentNode.removeChild(toptip);\n\t\tscheduler._global_tip = 0;\n\t}\n};\n\n\n}","export default function extend(scheduler) {\n\n\nscheduler._addThemeClass = function(){\n\tdocument.documentElement.setAttribute(\"data-scheduler-theme\", scheduler.skin);\n};\n\nscheduler._skin_settings = {\n\tfix_tab_position: [1,0],\n\tuse_select_menu_space: [1,0],\n\twide_form: [1,0],\n\n\thour_size_px: [44,42],\n\tdisplayed_event_color: [\"#ff4a4a\", \"ffc5ab\"],\n\tdisplayed_event_text_color: [\"#ffef80\", \"7e2727\"]\n};\n\nscheduler._skin_xy = {\n\tlightbox_additional_height: [90,50],\n\tnav_height: [59,22],\n\tbar_height: [24,20]\n};\n\n// material skin uses a different box sizing model than other skins, and also requires some post-processing.\n// In order to render events correctly, we need to know which box sizing model is used\n// We can detect it by styles applied, taking into account that styles may be loaded after scheduler is rendered\n\nscheduler._is_material_skin = function(){\n\tif(!scheduler.skin){\n\t\treturn checkIfMaterialSkin();\n\t}else{\n\t\treturn ((scheduler.skin + \"\").indexOf(\"material\") > -1);\n\t}\n};\n\nfunction themeNameFromFile(){\n\tvar links = document.getElementsByTagName(\"link\");\n\tfor (var i = 0; i < links.length; i++) {\n\t\tvar res = links[i].href.match(\"dhtmlxscheduler_([a-z]+).css\");\n\t\tif (res){\n\t\t\treturn res[1];\n\t\t}\n\t}\n}\n\nscheduler._build_skin_info = function() {\n\tmonitorThemeChange();\n\tconst styles = getComputedStyle(this.$container);\n\tconst themeVar = styles.getPropertyValue(\"--dhx-scheduler-theme\");\n\n\tlet isCssVarTheme = !!themeVar;\n\tlet themeName;\n\tlet cssValues = {};\n\tlet oldMaterialTheme = false;\n\n\tif(isCssVarTheme){\n\t\tthemeName = themeVar;\n\t\tfor(let i in scheduler.xy){\n\t\t\tcssValues[i] = styles.getPropertyValue(`--dhx-scheduler-xy-${i}`);\n\t\t}\n\n\t\tcssValues.hour_size_px = styles.getPropertyValue(`--dhx-scheduler-config-hour_size_px`);\n\t\tcssValues.wide_form = styles.getPropertyValue(`--dhx-scheduler-config-form_wide`);\n\n\t}else{\n\t\tthemeName = themeNameFromFile();\n\t\toldMaterialTheme = scheduler._is_material_skin();\n\t}\n\n\n\tscheduler._theme_info = {\n\t\ttheme: themeName,\n\t\tcssVarTheme: isCssVarTheme,\n\t\toldMaterialTheme: oldMaterialTheme,\n\t\tvalues: cssValues\n\t};\n\n\tif(scheduler._theme_info.cssVarTheme){\n\t\tconst themeVariables = this._theme_info.values;\n\t\tfor(let i in scheduler.xy){\n\t\t\tif(!isNaN(parseInt(themeVariables[i]))){\n\t\t\t\tscheduler.xy[i] = parseInt(themeVariables[i]);\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar calculatedMaterial;\nfunction checkIfMaterialSkin(){\n\tif(calculatedMaterial === undefined){\n\t\tvar probe = document.createElement(\"div\");\n\t\tprobe.style.position = \"absolute\";\n\t\tprobe.style.left = \"-9999px\";\n\t\tprobe.style.top = \"-9999px\";\n\t\tprobe.innerHTML = \"<div class='dhx_cal_container'>\" +\n\t\t\t\"<div class='dhx_cal_scale_placeholder'>\" +\n\t\t\t\"</div>\"+\n\t\t\"<div>\";\n\t\tdocument.body.appendChild(probe);\n\t\tvar styles = window.getComputedStyle(probe.querySelector(\".dhx_cal_scale_placeholder\"));\n\t\tvar position = styles.getPropertyValue('position');\n\t\tif(position === \"absolute\"){\n\t\t\t// page has skins for placeholder element from material skin\n\t\t\tcalculatedMaterial = true;\n\t\t}else{\n\t\t\tcalculatedMaterial = false;\n\t\t}\n\n\t\tsetTimeout(function(){\n\t\t\tcalculatedMaterial = null;\n\t\t\tif(probe && probe.parentNode){\n\t\t\t\tprobe.parentNode.removeChild(probe);\n\t\t\t}\n\t\t}, 500);\n\t}\n\treturn calculatedMaterial;\n}\n\nvar cachedBorderBoxValue;\nfunction checkIfBorderBoxStyling(){\n\tif(scheduler._is_material_skin()){\n\t\treturn true;\n\t}else{\n\t\tif(cachedBorderBoxValue === undefined){\n\t\t\tvar probe = document.createElement(\"div\");\n\t\t\tprobe.style.position = \"absolute\";\n\t\t\tprobe.style.left = \"-9999px\";\n\t\t\tprobe.style.top = \"-9999px\";\n\t\t\tprobe.innerHTML = \"<div class='dhx_cal_container'>\" +\n\t\t\t\t\"<div class='dhx_cal_data'>\" +\n\t\t\t\t\t\"<div class='dhx_cal_event'><div class='dhx_body'></div>\"+\n\t\t\t\t\"</div>\"+\n\t\t\t\"<div>\";\n\n\t\t\tdocument.body.appendChild(probe);\n\t\t\tvar styles = window.getComputedStyle(probe.querySelector(\".dhx_body\"));\n\t\t\tvar boxSizing = styles.getPropertyValue('box-sizing');\n\t\t\tdocument.body.removeChild(probe);\n\t\t\tcachedBorderBoxValue = !!(boxSizing === \"border-box\");\n\n\t\t\tif(!cachedBorderBoxValue){\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tcachedBorderBoxValue = undefined;\n\t\t\t\t}, 1000);// recalculate in case scheduler initialized before skin is loaded\n\t\t\t}\n\t\t}else{\n\t\t\treturn cachedBorderBoxValue;\n\t\t}\n\t}\n}\n\nfunction refreshAfterLoad(){\n\tif(scheduler._is_material_skin() || scheduler._border_box_events()){\n\t\treturn;\n\t}\n\n\tvar oldStyling = cachedBorderBoxValue;\n\tcachedBorderBoxValue = undefined;\n\tcalculatedMaterial = undefined;\n\tvar newStyling = checkIfBorderBoxStyling();\n\n\t// if box styling model changed - means scheduler was rendered before stylesheet was loaded or parsed inline\n\t// repaint scheduler in order to apply new styles\n\tif(oldStyling !== newStyling && scheduler.$container && scheduler.getState().mode){\n\t\tscheduler.setCurrentView();\n\t}\n}\nscheduler.event(window, 'DOMContentLoaded', refreshAfterLoad);\nscheduler.event(window, 'load', refreshAfterLoad);\n\nscheduler._border_box_events = function(){\n\treturn checkIfBorderBoxStyling();\n};\n\nscheduler._configure = function(col, data, skin){\n\tfor (var key in data)\n\t\tif (typeof col[key] == \"undefined\")\n\t\t\tcol[key] = data[key][skin];\n};\n\nscheduler.setSkin = function(value){\n\tthis.skin = value;\n\tscheduler._addThemeClass();\n\tif(scheduler.$container){\n\t\tthis._skin_init();\n\t\tthis.render();\n\t}\n\t\n\t//\n};\n\nfunction flatSkinHourScale(date){\n\tvar min = date.getMinutes();\n\tmin = min < 10 ? \"0\"+min : min;\n\tvar html = \"<span class='dhx_scale_h'>\"+ date.getHours() +\"</span>\"+\n\t\t\"<span class='dhx_scale_m'>&nbsp;\"+ min +\"</span>\";\n\treturn html;\n}\n\nlet monitorIntervalId = null;\nfunction monitorThemeChange(){\n\tconst container = scheduler.$container;\n\t\n\tclearInterval(monitorIntervalId);\n\tif(container){\n\t\tmonitorIntervalId = setInterval(() => {\n\t\t\tconst csstheme = getComputedStyle(container).getPropertyValue('--dhx-scheduler-theme');\n\t\t\tif(csstheme && csstheme !== scheduler.skin){\n\t\t\t\tscheduler.setSkin(csstheme);\n\t\t\t}\n\n\t\t}, 100);\n\t}\n}\nscheduler.attachEvent(\"onDestroy\", function(){\n\tclearInterval(monitorIntervalId);\n});\n\nscheduler._skin_init = function(){\n\tthis._build_skin_info();\n\n\tif (!this.skin){\n\t\tthis.skin = this._theme_info.theme;\n\t}\n\tscheduler._addThemeClass();\n\tif (scheduler.skin === \"flat\"){\n\t\t// scheduler.xy.scale_height = 35;\n\t\tscheduler.templates.hour_scale = flatSkinHourScale;\n\t}else if (scheduler.templates.hour_scale === flatSkinHourScale){\n\t\tscheduler.templates.hour_scale = scheduler.date.date_to_str(scheduler.config.hour_date);\n\t}\n\n\n\n\t//scheduler._lightbox_template=\"<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span><div class='dhx_close_icon'></div></div><div class='dhx_cal_larea'></div>\";\n\tscheduler.attachEvent(\"onTemplatesReady\", function() {\n\n\t\tvar date_to_str = scheduler.date.date_to_str(\"%d\");\n\t\tif(!scheduler.templates._old_month_day){\n\t\t\tscheduler.templates._old_month_day = scheduler.templates.month_day;\n\t\t}\n\t\tvar old_month_day = scheduler.templates._old_month_day;\n\t\tscheduler.templates.month_day = function(date) {\n\t\t\tif (this._mode == \"month\") {\n\t\t\t\tvar label = date_to_str(date);\n\t\t\t\tif (date.getDate() == 1) {\n\t\t\t\t\tlabel = scheduler.locale.date.month_full[date.getMonth()] + \" \" + label;\n\t\t\t\t}\n\t\t\t\tif (+date == +scheduler.date.date_part(this._currentDate())) {\n\t\t\t\t\tlabel = scheduler.locale.labels.dhx_cal_today_button + \" \" + label;\n\t\t\t\t}\n\t\t\t\treturn label;\n\t\t\t} else {\n\t\t\t\treturn old_month_day.call(this, date);\n\t\t\t}\n\t\t};\n\n\t\t// tab classes\n\t\tif(scheduler.config.fix_tab_position){\n\t\t\tconst tabs = scheduler._els[\"dhx_cal_navline\"][0].querySelectorAll('[data-tab]');\n\t\t\ttabs.forEach((tab) => {\n\t\t\t\tconst view = tab.getAttribute(\"data-tab\") || tab.getAttribute(\"name\");\n\n\t\t\t\tswitch (view) {\n\t\t\t\t\tcase \"day\":\n\t\t\t\t\tcase \"day_tab\":\n\t\t\t\t\t\ttab.classList.add(\"dhx_cal_tab_first\");\n\t\t\t\t\t\ttab.classList.add(\"dhx_cal_tab_segmented\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"week\":\n\t\t\t\t\tcase \"week_tab\":\n\t\t\t\t\t\ttab.classList.add(\"dhx_cal_tab_segmented\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"month\":\n\t\t\t\t\tcase \"month_tab\":\n\t\t\t\t\t\ttab.classList.add(\"dhx_cal_tab_last\");\n\t\t\t\t\t\ttab.classList.add(\"dhx_cal_tab_segmented\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttab.classList.add(\"dhx_cal_tab_standalone\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treorderTabs(scheduler._els[\"dhx_cal_navline\"][0]);\n\n\t\t}\n\t}, {once: true});\n\n\tfunction reorderTabs(container) {\n\t\t// segmented tabs should go first\n\n\t\tif(scheduler.config.header){\n\t\t\treturn;\n\t\t\t// don't reorder tabs if header is defined via config\n\t\t}\n\t\tconst tabs = Array.from(container.querySelectorAll('.dhx_cal_tab'));\n\t\n\t\t// segmented tabs\n\t\tconst order = ['day', 'week', 'month'];\n\t\n\t\tconst specialTabs = order.map(tabName => \n\t\t\ttabs.find(tab => tab.getAttribute('data-tab') === tabName)\n\t\t).filter(tab => tab !== undefined);\n\t\n\t\tlet firstTab = tabs.length > 0 ? tabs[0] : null;\n\n\t\tspecialTabs.reverse().forEach(tab => {\n\t\t\tcontainer.insertBefore(tab, firstTab);\n\t\t\tfirstTab = tab;\n\t\t});\n\t}\n\n\t// scheduler._skin_init = function(){\n\t// \tthis._build_skin_info();\n\t// \tthis.skin = this._theme_info.theme;\n\t// };\n};\n\n\n\n}","export default function DataProcessorEvents(scheduler, dp){\n\tthis.$scheduler = scheduler;\n\tthis.$dp = dp;\n\tthis._dataProcessorHandlers = [];\n\n\tthis.attach = function () {\n\t\tvar dp = this.$dp;\n\t\tvar scheduler = this.$scheduler;\n\n\t\tthis._dataProcessorHandlers.push(scheduler.attachEvent(\"onEventAdded\", function(id) {\n\t\t\tif (!this._loading && this._validId(id))\n\t\t\tdp.setUpdated(id,true,\"inserted\");\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(scheduler.attachEvent(\"onConfirmedBeforeEventDelete\", function(id) {\n\t\t\tif (!this._validId(id)) return;\n\t\t\tvar z=dp.getState(id);\n\n\t\t\tif (z==\"inserted\" || this._new_event) { dp.setUpdated(id,false); return true; }\n\t\t\tif (z==\"deleted\") return false;\n\t\t\tif (z==\"true_deleted\") return true;\n\n\t\t\tdp.setUpdated(id,true,\"deleted\");\n\t\t\treturn false;\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(scheduler.attachEvent(\"onEventChanged\", function(id) { \n\t\t\tif (!this._loading && this._validId(id))\n\t\t\tdp.setUpdated(id,true,\"updated\");\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(scheduler.attachEvent(\"onClearAll\", function() { \n\t\t\t// clear dataprocessor state when scheduler is reset\n\t\t\tdp._in_progress={};\n\t\t\tdp._invalid={};\n\t\t\tdp.updatedRows = [];\n\t\t\tdp._waitMode = 0;\n\t\t}));\n\n\t\tdp.attachEvent(\"insertCallback\", scheduler._update_callback);\n\t\tdp.attachEvent(\"updateCallback\", scheduler._update_callback);\n\t\tdp.attachEvent(\"deleteCallback\", function(upd, id) {\n\t\t\tif (scheduler.getEvent(id)){\n\t\t\t\tscheduler.setUserData(id, this.action_param, \"true_deleted\");\n\t\t\t\tscheduler.deleteEvent(id);\n\t\t\t} else if (scheduler._add_rec_marker)\n\t\t\t\tscheduler._update_callback(upd, id);\n\t\t});\n\t};\n\n\tthis.detach = function () {\n\t\tfor (var key in this._dataProcessorHandlers) {\n\t\t\tvar handler = this._dataProcessorHandlers[key];\n\t\t\tthis.$scheduler.detachEvent(handler);\n\t\t}\n\t\tthis._dataProcessorHandlers = [];\n\t};\n}\n\nexport function extendScheduler(scheduler, dp){\n\tscheduler._validId=function(id){\n\t\tif(this._is_virtual_event){\n\t\t\treturn !this._is_virtual_event(id);\n\t\t}\n\t\treturn true;\n\t};\n\tscheduler.setUserData=function(id,name,value){\n\t\tif (id){\n\t\t\tvar ev = this.getEvent(id);\n\t\t\tif(ev) ev[name]=value;\n\t\t}else{\n\t\t\tthis._userdata[name]=value;\n\t\t}\n\t};\n\tscheduler.getUserData=function(id,name){\n\t\tif (id){\n\t\t\tvar ev = this.getEvent(id);\n\t\t\tif(ev)\n\t\t\t\treturn ev[name];\n\t\t\telse\n\t\t\t\treturn null;\n\t\t}else{\n\t\t\treturn this._userdata[name];\n\t\t}\n\t};\n\tscheduler._set_event_text_style=function(id,style){\n\t\tif(!scheduler.getEvent(id))\n\t\t\treturn;\n\t\tthis.for_rendered(id,function(r){\n\t\t\tr.style.cssText+=\";\"+style;\n\t\t});\n\t\tvar ev = this.getEvent(id);\n\t\tev[\"_text_style\"]=style;\n\t\tthis.event_updated(ev);\n\t};\n\tscheduler._update_callback = function(upd,id){\n\t\tvar data = scheduler._xmlNodeToJSON(upd.firstChild);\n\t\t//fix for updates of recurring events\n\t\tif (data.rec_type == \"none\") data.rec_pattern = \"none\";\n\t\tdata.text = data.text||data._tagvalue;\n\t\tdata.start_date = scheduler._helpers.parseDate(data.start_date);\n\t\tdata.end_date = scheduler._helpers.parseDate(data.end_date);\n\t\tscheduler.addEvent(data);\n\t\tif (scheduler._add_rec_marker)\n\t\t\tscheduler.setCurrentView();\n\t};\n\tscheduler._dp_change_event_id = function(id, new_id){\n\t\tif(!scheduler.getEvent(id))\n\t\t\treturn;\n\t\tscheduler.changeEventId(id, new_id);\n\t};\n\tscheduler._dp_hook_delete = function(id, new_id){\n\t\tif(!scheduler.getEvent(id))\n\t\t\treturn;\n\n\t\tif(new_id && id != new_id){\n\t\t\tif(this.getUserData(id, dp.action_param) == \"true_deleted\")\n\t\t\t\tthis.setUserData(id, dp.action_param, \"updated\");\n\n\t\t\tthis.changeEventId(id, new_id);\n\t\t}\n\t\treturn this.deleteEvent(new_id, true);\n\t};\n\n\tscheduler.setDp = function() {\n\t\tthis._dp = dp;\n\t};\n\tscheduler.setDp();\n}","import DataProcessorEvents from \"./dataprocessor_hooks\";\nimport { extendScheduler } from \"./dataprocessor_hooks\";\nimport eventable from \"../../utils/eventable\";\nimport global from \"../../global\";\n\n/**\n *\t@desc: constructor, data processor object\n *\t@param: serverProcessorURL - url used for update\n *\t@type: public\n */\nexport function DataProcessor(serverProcessorURL){\n\tthis.serverProcessor = serverProcessorURL;\n\tthis.action_param = \"!nativeeditor_status\";\n\n\tthis.object = null;\n\tthis.updatedRows = []; // ids of updated rows\n\n\tthis.autoUpdate = true;\n\tthis.updateMode = \"cell\";\n\tthis._tMode = \"GET\";\n\tthis._headers = null;\n\tthis._payload = null;\n\tthis.post_delim = \"_\";\n\n\tthis._waitMode = 0;\n\tthis._in_progress = {};\n\tthis._invalid = {};\n\tthis.messages = [];\n\n\tthis.styles = {\n\t\tupdated: \"font-weight:bold;\",\n\t\tinserted: \"font-weight:bold;\",\n\t\tdeleted: \"text-decoration : line-through;\",\n\t\tinvalid: \"background-color:FFE0E0;\",\n\t\tinvalid_cell: \"border-bottom:2px solid red;\",\n\t\terror: \"color:red;\",\n\t\tclear: \"font-weight:normal;text-decoration:none;\"\n\t};\n\tthis.enableUTFencoding(true);\n\teventable(this); // TODO: need to update\n\n\treturn this;\n}\nDataProcessor.prototype = {\n\tsetTransactionMode: function (mode, total) {\n\t\tif (typeof mode == \"object\") {\n\t\t\tthis._tMode = mode.mode || this._tMode;\n\n\t\t\tif (mode.headers !== undefined) {\n\t\t\t\tthis._headers = mode.headers;\n\t\t\t}\n\n\t\t\tif (mode.payload !== undefined) {\n\t\t\t\tthis._payload = mode.payload;\n\t\t\t}\n\t\t\tthis._tSend = !!total;\n\t\t} else {\n\t\t\tthis._tMode = mode;\n\t\t\tthis._tSend = total;\n\t\t}\n\n\t\tif (this._tMode == \"REST\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._endnm = true;\n\t\t}\n\n\t\tif (this._tMode === \"JSON\" || this._tMode === \"REST-JSON\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._endnm = true;\n\t\t\tthis._serializeAsJson = true;\n\t\t\tthis._headers = this._headers || {};\n\t\t\tthis._headers[\"Content-Type\"] = \"application/json\";\n\t\t}else{\n\t\t\tif(this._headers && !this._headers[\"Content-Type\"]){\n\t\t\t\tthis._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n\t\t\t}\n\t\t}\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._endnm = true;\n\t\t\tthis._router = mode.router;\n\t\t}\n\t},\n\tescape: function (data) {\n\t\tif (this._utf)\n\t\t\treturn encodeURIComponent(data);\n\t\telse\n\t\t\treturn escape(data);\n\t},\n\t/**\n\t *\t@desc: allows to set escaping mode\n\t *\t@param: true - utf based escaping, simple - use current page encoding\n\t *\t@type: public\n\t */\n\tenableUTFencoding: function (mode) {\n\t\tthis._utf = !!mode;\n\t},\n\t/**\n\t *\t@desc: allows to define, which column may trigger update\n\t *\t@param: val - array or list of true/false values\n\t *\t@type: public\n\t */\n\tsetDataColumns: function (val) {\n\t\tthis._columns = (typeof val == \"string\") ? val.split(\",\") : val;\n\t},\n\t/**\n\t *\t@desc: get state of updating\n\t *\t@returns:   true - all in sync with server, false - some items not updated yet.\n\t *\t@type: public\n\t */\n\tgetSyncState: function () {\n\t\treturn !this.updatedRows.length;\n\t},\n\t/**\n\t *\t@desc: enable/disable named field for data syncing, will use column ids for grid\n\t *\t@param:   mode - true/false\n\t *\t@type: public\n\t */\n\tenableDataNames: function (mode) {\n\t\tthis._endnm = !!mode;\n\t},\n\t/**\n\t *\t@desc: enable/disable mode , when only changed fields and row id send to the server side, instead of all fields in default mode\n\t *\t@param:   mode - true/false\n\t *\t@type: public\n\t */\n\tenablePartialDataSend: function (mode) {\n\t\tthis._changed = !!mode;\n\t},\n\t/**\n\t *\t@desc: set if rows should be send to server automatically\n\t *\t@param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\n\t *\t@type: public\n\t */\n\tsetUpdateMode: function (mode, dnd) {\n\t\tthis.autoUpdate = (mode == \"cell\");\n\t\tthis.updateMode = mode;\n\t\tthis.dnd = dnd;\n\t},\n\tignore: function (code, master) {\n\t\tthis._silent_mode = true;\n\t\tcode.call(master || window);\n\t\tthis._silent_mode = false;\n\t},\n\t/**\n\t *\t@desc: mark row as updated/normal. check mandatory fields,initiate autoupdate (if turned on)\n\t *\t@param: rowId - id of row to set update-status for\n\t *\t@param: state - true for \"updated\", false for \"not updated\"\n\t *\t@param: mode - update mode name\n\t *\t@type: public\n\t */\n\tsetUpdated: function (rowId, state, mode) {\n\t\tif (this._silent_mode) return;\n\t\tvar ind = this.findRow(rowId);\n\n\t\tmode = mode || \"updated\";\n\t\tvar existing = this.$scheduler.getUserData(rowId, this.action_param);\n\t\tif (existing && mode == \"updated\") mode = existing;\n\t\tif (state) {\n\t\t\tthis.set_invalid(rowId, false); //clear previous error flag\n\t\t\tthis.updatedRows[ind] = rowId;\n\t\t\tthis.$scheduler.setUserData(rowId, this.action_param, mode);\n\t\t\tif (this._in_progress[rowId])\n\t\t\t\tthis._in_progress[rowId] = \"wait\";\n\t\t} else {\n\t\t\tif (!this.is_invalid(rowId)) {\n\t\t\t\tthis.updatedRows.splice(ind, 1);\n\t\t\t\tthis.$scheduler.setUserData(rowId, this.action_param, \"\");\n\t\t\t}\n\t\t}\n\n\t\tthis.markRow(rowId, state, mode);\n\t\tif (state && this.autoUpdate) this.sendData(rowId);\n\t},\n\n\tmarkRow: function (id, state, mode) {\n\t\tvar str = \"\";\n\t\tvar invalid = this.is_invalid(id);\n\t\tif (invalid) {\n\t\t\tstr = this.styles[invalid];\n\t\t\tstate = true;\n\t\t}\n\t\tif (this.callEvent(\"onRowMark\", [id, state, mode, invalid])) {\n\t\t\t//default logic\n\t\t\tstr = this.styles[state ? mode : \"clear\"] + str;\n\n\t\t\tthis.$scheduler[this._methods[0]](id, str);\n\n\t\t\tif (invalid && invalid.details) {\n\t\t\t\tstr += this.styles[invalid + \"_cell\"];\n\t\t\t\tfor (var i = 0; i < invalid.details.length; i++)\n\t\t\t\t\tif (invalid.details[i])\n\t\t\t\t\t\tthis.$scheduler[this._methods[1]](id, i, str);\n\t\t\t}\n\t\t}\n\t},\n\tgetActionByState: function(state) {\n\t\tif (state === \"inserted\") {\n\t\t\treturn \"create\";\n\t\t}\n\t\tif (state === \"updated\") {\n\t\t\treturn \"update\";\n\t\t}\n\t\tif (state === \"deleted\") {\n\t\t\treturn \"delete\";\n\t\t}\n\t\treturn \"update\";\n\t},\n\n\tgetState: function (id) {\n\t\treturn this.$scheduler.getUserData(id, this.action_param);\n\t},\n\tis_invalid: function (id) {\n\t\treturn this._invalid[id];\n\t},\n\tset_invalid: function (id, mode, details) {\n\t\tif (details) mode = {\n\t\t\tvalue: mode, details: details, toString: function () {\n\t\t\t\treturn this.value.toString();\n\t\t\t}\n\t\t};\n\t\tthis._invalid[id] = mode;\n\t},\n\t/**\n\t *\t@desc: check mandatory fields and varify values of cells, initiate update (if specified)\n\t *\t@param: rowId - id of row to set update-status for\n\t *\t@type: public\n\t */\n\tcheckBeforeUpdate: function (rowId) {\n\t\treturn true;\n\t},\n\t/**\n\t *\t@desc: send row(s) values to server\n\t *\t@param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\n\t *\t@type: public\n\t */\n\tsendData: function (rowId) {\n\t\tif (this.$scheduler.editStop) this.$scheduler.editStop();\n\n\t\tif (typeof rowId == \"undefined\" || this._tSend) return this.sendAllData();\n\t\tif (this._in_progress[rowId]) return false;\n\n\t\tthis.messages = [];\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\", [rowId, this.messages])) return false;\n\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t},\n\t_beforeSendData: function (data, rowId) {\n\t\tif (!this.callEvent(\"onBeforeUpdate\", [rowId, this.getState(rowId), data])) return false;\n\t\tthis._sendData(data, rowId);\n\t},\n\tserialize: function (data, id) {\n\t\tif (this._serializeAsJson) {\n\t\t\treturn  this._serializeAsJSON(data);\n\t\t}\n\n\t\tif (typeof data == \"string\")\n\t\t\treturn data;\n\t\tif (typeof id != \"undefined\")\n\t\t\treturn this.serialize_one(data, \"\");\n\t\telse {\n\t\t\tvar stack = [];\n\t\t\tvar keys = [];\n\t\t\tfor (var key in data)\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tstack.push(this.serialize_one(data[key], key + this.post_delim));\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\tstack.push(\"ids=\" + this.escape(keys.join(\",\")));\n\t\t\tif (this.$scheduler.security_key)\n\t\t\t\tstack.push(\"dhx_security=\" + (this.$scheduler.security_key));\n\t\t\treturn stack.join(\"&\");\n\t\t}\n\t},\n\tserialize_one: function (data, pref) {\n\t\tif (typeof data == \"string\")\n\t\t\treturn data;\n\t\tvar stack = [];\n\t\tvar serialized = \"\";\n\t\tfor (var key in data)\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tif ((key == \"id\" || key == this.action_param) && this._tMode == \"REST\") continue;\n\t\t\t\tif (typeof data[key] === \"string\" || typeof data[key] === \"number\") {\n\t\t\t\t\tserialized = data[key];\n\t\t\t\t} else {\n\t\t\t\t\tserialized = JSON.stringify(data[key]);\n\t\t\t\t}\n\t\t\t\tstack.push(this.escape((pref || \"\") + key) + \"=\" + this.escape(serialized));\n\t\t\t}\n\t\treturn stack.join(\"&\");\n\t},\n\t_applyPayload: function (url) {\n\t\tvar ajax = this.$scheduler.ajax;\n\t\tif (this._payload)\n\t\t\tfor (var key in this._payload)\n\t\t\t\turl = url + ajax.urlSeparator(url) + this.escape(key) + \"=\" + this.escape(this._payload[key]);\n\t\treturn url;\n\t},\n\t_sendData: function (dataToSend, rowId) {\n\t\tif (!dataToSend) {\n\t\t\treturn; // nothing to send\n\t\t}\n\t\tif (!this.callEvent(\"onBeforeDataSending\", rowId ? [rowId, this.getState(rowId), dataToSend] : [null, null, dataToSend])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (rowId) {\n\t\t\tthis._in_progress[rowId] = (new Date()).valueOf();\n\t\t}\n\n\t\tvar self = this;\n\t\tvar ajax = this.$scheduler.ajax;\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tvar state = this.getState(rowId);\n\t\t\tvar action = this.getActionByState(state);\n\t\t\tdelete dataToSend[this.action_param]; // do not send !nativeeditor_status parameter in router mode GS-2868\n\t\t\tvar _onResolvedCreateUpdate = function (tag) {\n\t\t\t\tvar resultState = state;\n\t\t\t\tif(tag && tag.responseText && tag.setRequestHeader){\n\t\t\t\t\tif(tag.status !== 200){\n\t\t\t\t\t\tresultState = \"error\";\n\t\t\t\t\t}\n\t\t\t\t\ttry{\n\t\t\t\t\t\ttag = JSON.parse(tag.responseText);\n\t\t\t\t\t} catch (e){}\n\t\t\t\t}\n\n\t\t\t\tresultState = resultState || \"updated\";\n\t\t\t\tvar sid = rowId;\n\t\t\t\tvar tid = rowId;\n\n\t\t\t\tif (tag) {\n\t\t\t\t\tresultState = tag.action || resultState;\n\t\t\t\t\tsid = tag.sid || sid;\n\t\t\t\t\ttid = tag.id || tag.tid || tid;\n\t\t\t\t}\n\t\t\t\tself.afterUpdateCallback(sid, tid, resultState, tag);\n\t\t\t};\n\n\t\t\tconst routerMode = \"event\";\n\t\t\tvar actionPromise;\n\t\t\tif (this._router instanceof Function) {\n\t\t\t\tactionPromise = this._router(routerMode, action, dataToSend, rowId);\n\t\t\t} else {\n\t\t\t\tswitch (state) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tactionPromise = this._router[routerMode].create(dataToSend);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tactionPromise = this._router[routerMode].delete(rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tactionPromise = this._router[routerMode].update(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(actionPromise){\n\t\t\t\t// neither promise nor {tid: newId} response object\n\t\t\t\tif(!actionPromise.then &&\n\t\t\t\t\t(actionPromise.id === undefined && actionPromise.tid === undefined && actionPromise.action === undefined)){\n\t\t\t\t\tthrow new Error(\"Incorrect router return value. A Promise or a response object is expected\");\n\t\t\t\t}\n\n\t\t\t\tif(actionPromise.then){\n\t\t\t\t\tactionPromise.then(_onResolvedCreateUpdate).catch(function(error) {\n\t\t\t\t\t\tif(error && error.action){\n\t\t\t\t\t\t\t_onResolvedCreateUpdate(error);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t_onResolvedCreateUpdate({ action: \"error\", value: error});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\t// custom method may return a response object in case of sync action\n\t\t\t\t\t_onResolvedCreateUpdate(actionPromise);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t_onResolvedCreateUpdate(null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar queryParams = {\n\t\t\tcallback: function(xml) {\n\t\t\t\tvar ids = [];\n\n\t\t\t\tif (rowId) {\n\t\t\t\t\tids.push(rowId);\n\t\t\t\t} else if (dataToSend) {\n\t\t\t\t\tfor (var key in dataToSend) {\n\t\t\t\t\t\tids.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn self.afterUpdate(self, xml, ids);\n\t\t\t},\n\t\t\theaders: self._headers\n\t\t};\n\n\t\tvar urlParams = this.serverProcessor + (this._user ? (ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + this.$scheduler.getUserData(0, \"version\")].join(\"&\")) : \"\");\n\t\tvar url = this._applyPayload(urlParams);\n\t\tvar data;\n\n\t\tswitch (this._tMode) {\n\t\t\tcase \"GET\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url + ajax.urlSeparator(url) + this.serialize(data, rowId);\n\t\t\t\tqueryParams.method = \"GET\";\n\t\t\t\tbreak;\n\t\t\tcase \"POST\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = this.serialize(data, rowId);\n\t\t\t\tbreak;\n\t\t\tcase \"JSON\":\n\t\t\t\tdata = {};\n\t\t\t\tvar preprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t\t\tfor (var key in preprocessedData) {\n\t\t\t\t\tif (key === this.action_param || key === \"id\" || key === \"gr_id\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdata[key] = preprocessedData[key];\n\t\t\t\t}\n\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = JSON.stringify({\n\t\t\t\t\tid: rowId,\n\t\t\t\t\taction: dataToSend[this.action_param],\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"REST\":\n\t\t\tcase \"REST-JSON\":\n\t\t\t\turl = urlParams.replace(/(&|\\?)editing=true/, \"\");\n\t\t\t\tdata = \"\";\n\n\t\t\t\tswitch (this.getState(rowId)) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tqueryParams.method = \"DELETE\";\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tqueryParams.method = \"PUT\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tqueryParams.url = this._applyPayload(url);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._waitMode++;\n\t\treturn ajax.query(queryParams);\n\t},\n\tsendAllData: function () {\n\t\tif (!this.updatedRows.length || this.updateMode === \"off\") { // FIXME: need to leave checking 'this.updateMode === \"off\"'?\n\t\t\treturn;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tvar valid = true;\n\n\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\tvalid = valid && this.checkBeforeUpdate(rowId);\n\t\t});\n\n\t\tif (!valid && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._tSend) {\n\t\t\tthis._sendData(this._getAllData());\n\t\t} else {\n\t\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\t\tif (!this._in_progress[rowId]) {\n\t\t\t\t\tif (this.is_invalid(rowId)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t_getAllData: function (rowId) {\n\t\tvar out = {};\n\t\tvar has_one = false;\n\t\tthis._forEachUpdatedRow(function(id) {\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar row = this._getRowData(id);\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\", [id, this.getState(id), row])) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tout[id] = row;\n\t\t\thas_one = true;\n\t\t\tthis._in_progress[id] = (new Date()).valueOf();\n\t\t});\n\t\treturn has_one ? out : null;\n\t},\n\n\tfindRow: function (pattern) {\n\t\tvar i = 0;\n\t\tfor (i = 0; i < this.updatedRows.length; i++)\n\t\t\tif (pattern == this.updatedRows[i]) break;\n\t\treturn i;\n\t},\n\n\t/**\n\t *\t@desc: define custom actions\n\t *\t@param: name - name of action, same as value of action attribute\n\t *\t@param: handler - custom function, which receives a XMl response content for action\n\t *\t@type: private\n\t */\n\tdefineAction: function (name, handler) {\n\t\tif (!this._uActions) this._uActions = {};\n\t\tthis._uActions[name] = handler;\n\t},\n\n\t/**\n\t *\t @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\n\t *\t @param: sid - id of item before update\n\t *\t @param: tid - id of item after up0ate\n\t *\t @param: action - action name\n\t *\t @type: public\n\t *\t @topic: 0\n\t */\n\tafterUpdateCallback: function (sid, tid, action, btag) {\n\t\tif(!this.$scheduler){\n\t\t\t// destructor has been called before the callback\n\t\t\treturn;\n\t\t}\n\n\t\tvar marker = sid;\n\t\tvar correct = (action !== \"error\" && action !== \"invalid\");\n\t\tif (!correct) {\n\t\t\tthis.set_invalid(sid, action);\n\t\t}\n\t\tif ((this._uActions) && (this._uActions[action]) && (!this._uActions[action](btag))) {\n\t\t\treturn (delete this._in_progress[marker]);\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tthis.setUpdated(sid, false);\n\t\t}\n\n\t\tvar originalSid = sid;\n\n\t\tswitch (action) {\n\t\t\tcase \"inserted\":\n\t\t\tcase \"insert\":\n\t\t\t\tif (tid != sid) {\n\t\t\t\t\tthis.setUpdated(sid, false);\n\t\t\t\t\tthis.$scheduler[this._methods[2]](sid, tid);\n\t\t\t\t\tsid = tid;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\tcase \"deleted\":\n\t\t\t\tthis.$scheduler.setUserData(sid, this.action_param, \"true_deleted\");\n\t\t\t\tthis.$scheduler[this._methods[3]](sid, tid);\n\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tif (correct) {\n\t\t\t\tthis.$scheduler.setUserData(sid, this.action_param, \"\");\n\t\t\t}\n\t\t\tdelete this._in_progress[marker];\n\t\t} else {\n\t\t\tdelete this._in_progress[marker];\n\t\t\tthis.setUpdated(tid, true, this.$scheduler.getUserData(sid, this.action_param));\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdate\", [originalSid, action, tid, btag]);\n\t},\n\n\t_errorResponse: function (xml, id){\n\t\tif(this.$scheduler && this.$scheduler.callEvent){\n\t\t\tthis.$scheduler.callEvent(\"onSaveError\", [id, xml.xmlDoc]);\n\t\t}\n\t\treturn this.cleanUpdate(id);\n\t},\n\n\t_setDefaultTransactionMode: function () {\n\t\tif (this.serverProcessor) {\n\t\t\tthis.setTransactionMode(\"POST\", true);\n\t\t\tthis.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\";\n\t\t\tthis._serverProcessor = this.serverProcessor;\n\t\t}\n\t},\n\t\n\t/**\n\t *\t@desc: response from server\n\t *\t@param: xml - XMLLoader object with response XML\n\t *\t@type: private\n\t */\n\tafterUpdate: function (that, xml, id) {\n\t\tvar ajax = this.$scheduler.ajax;\n\n\t\tif (xml.xmlDoc.status !== 200){\n\t\t\tthis._errorResponse(xml, id);\n\t\t\treturn;\n\t\t}\n\n\t\t// try to use json first\n\t\tvar tag;\n\t\ttry {\n\t\t\ttag = JSON.parse(xml.xmlDoc.responseText);\n\t\t} catch (e) {\n\t\t\t// empty response also can be processed by json handler\n\t\t\tif (!xml.xmlDoc.responseText.length) {\n\t\t\t\ttag = {};\n\t\t\t}\n\t\t}\n\n\t\tif (tag) {\n\t\t\tvar action = tag.action || this.getState(id) || \"updated\";\n\t\t\tvar sid = tag.sid || id[0];\n\t\t\tvar tid = tag.tid || id[0];\n\t\t\tthat.afterUpdateCallback(sid, tid, action, tag);\n\t\t\tthat.finalizeUpdate();\n\t\t\treturn;\n\t\t}\n\n\t\t// xml response\n\t\tvar top = ajax.xmltop(\"data\", xml.xmlDoc); // fix incorrect content type in IE\n\t\tif (!top) {\n\t\t\treturn this._errorResponse(xml, id);\n\t\t}\n\t\tvar atag = ajax.xpath(\"//data/action\", top);\n\t\tif (!atag.length) {\n\t\t\treturn this._errorResponse(xml, id);\n\t\t}\n\n\t\tfor (var i = 0; i < atag.length; i++) {\n\t\t\tvar btag = atag[i];\n\t\t\tvar action = btag.getAttribute(\"type\");\n\t\t\tvar sid = btag.getAttribute(\"sid\");\n\t\t\tvar tid = btag.getAttribute(\"tid\");\n\n\t\t\tthat.afterUpdateCallback(sid, tid, action, btag);\n\t\t}\n\t\tthat.finalizeUpdate();\n\t},\n\tcleanUpdate: function (id) {\n\t\tif (id)\n\t\t\tfor (var i = 0; i < id.length; i++)\n\t\t\t\tdelete this._in_progress[id[i]];\n\t},\n\tfinalizeUpdate: function () {\n\t\tif (this._waitMode) this._waitMode--;\n\n\t\tthis.callEvent(\"onAfterUpdateFinish\", []);\n\t\tif (!this.updatedRows.length)\n\t\t\tthis.callEvent(\"onFullSync\", []);\n\t},\n\n\t/**\n\t *\t@desc: initializes data-processor\n\t *\t@param: scheduler - dhtmlxScheduler object to attach this data-processor to\n\t *\t@type: public\n\t */\n\tinit: function (scheduler) {\n\t\tif (this._initialized) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$scheduler = scheduler;\n\t\tif (this.$scheduler._dp_init) {\n\t\t\tthis.$scheduler._dp_init(this);\n\t\t}\n\n\t\tthis._setDefaultTransactionMode();\n\n\t\tthis._methods=this._methods||[\"_set_event_text_style\",\"\",\"_dp_change_event_id\",\"_dp_hook_delete\"];\n\t\textendScheduler(this.$scheduler, this);\n\t\tvar dataProcessorEvents = new DataProcessorEvents(this.$scheduler, this);\n\t\tdataProcessorEvents.attach();\n\t\tthis.attachEvent(\"onDestroy\", function() {\n\t\t\tdelete this._getRowData;\n\n\t\t\tdelete this.$scheduler._dp;\n\t\t\tdelete this.$scheduler._dataprocessor;\n\t\t\tdelete this.$scheduler._set_event_text_style;\n\t\t\tdelete this.$scheduler._dp_change_event_id;\n\t\t\tdelete this.$scheduler._dp_hook_delete;\n\t\t\tdelete this.$scheduler;\n\t\t\tdataProcessorEvents.detach();\n\t\t});\n\t\tthis.$scheduler.callEvent(\"onDataProcessorReady\", [this]);\n\t\tthis._initialized = true;\n\n\t\tscheduler._dataprocessor=this;\n\t},\n\n\tsetOnAfterUpdate: function (ev) {\n\t\tthis.attachEvent(\"onAfterUpdate\", ev);\n\t},\n\tsetOnBeforeUpdateHandler: function (func) {\n\t\tthis.attachEvent(\"onBeforeDataSending\", func);\n\t},\n\n\t/* starts autoupdate mode\n\t\t@param interval time interval for sending update requests\n\t*/\n\tsetAutoUpdate: function (interval, user) {\n\t\tinterval = interval || 2000;\n\n\t\tthis._user = user || (new Date()).valueOf();\n\t\tthis._need_update = false;\n\t\t//this._loader = null;\n\t\tthis._update_busy = false;\n\n\t\tthis.attachEvent(\"onAfterUpdate\", function (sid, action, tid, xml_node) {\n\t\t\tthis.afterAutoUpdate(sid, action, tid, xml_node);\n\t\t});\n\t\tthis.attachEvent(\"onFullSync\", function () {\n\t\t\tthis.fullSync();\n\t\t});\n\n\t\tvar self = this;\n\t\tlet intervalId = global.setInterval(function () {\n\t\t\tself.loadUpdate();\n\t\t}, interval);\n\t\tthis.attachEvent(\"onDestroy\", function(){\n\t\t\tclearInterval(intervalId);\n\t\t});\n\t},\n\n\t/* process updating request answer\n\t\tif status == collision version is deprecated\n\t\tset flag for autoupdating immediately\n\t*/\n\tafterAutoUpdate: function (sid, action, tid, xml_node) {\n\t\tif (action == 'collision') {\n\t\t\tthis._need_update = true;\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t},\n\n\t/* callback function for onFillSync event\n\t\tcall update function if it's need\n\t*/\n\tfullSync: function () {\n\t\tif (this._need_update) {\n\t\t\tthis._need_update = false;\n\t\t\tthis.loadUpdate();\n\t\t}\n\t\treturn true;\n\t},\n\n\t/* sends query to the server and call callback function\n\t*/\n\tgetUpdates: function (url, callback) {\n\t\tvar ajax = this.$scheduler.ajax;\n\t\tif (this._update_busy)\n\t\t\treturn false;\n\t\telse\n\t\t\tthis._update_busy = true;\n\n\t\tajax.get(url, callback);\n\t},\n\n\t/* returns xml node value\n\t\t@param node\n\t\t\txml node\n\t*/\n\t_getXmlNodeValue: function(node) {\n\t\tif (node.firstChild) {\n\t\t\treturn node.firstChild.nodeValue;\n\t\t}\n\t\treturn \"\";\n\t},\n\n\t/* loads updates and processes them\n\t*/\n\tloadUpdate: function () {\n\t\tvar self = this;\n\t\tvar ajax = this.$scheduler.ajax;\n\t\tvar version = this.$scheduler.getUserData(0, \"version\");\n\t\tvar url = this.serverProcessor + ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + version].join(\"&\");\n\t\turl = url.replace(\"editing=true&\", \"\");\n\t\tthis.getUpdates(url, function (xml) {\n\t\t\tvar vers = ajax.xpath(\"//userdata\", xml);\n\t\t\tself.$scheduler.setUserData(0, \"version\", self._getXmlNodeValue(vers[0]));\n\n\t\t\tvar updates = ajax.xpath(\"//update\", xml);\n\t\t\tif (updates.length) {\n\t\t\t\tself._silent_mode = true;\n\n\t\t\t\tfor (var i = 0; i < updates.length; i++) {\n\t\t\t\t\tvar status = updates[i].getAttribute(\"status\");\n\t\t\t\t\tvar id = updates[i].getAttribute(\"id\");\n\t\t\t\t\tvar parent = updates[i].getAttribute(\"parent\");\n\t\t\t\t\tswitch (status) {\n\t\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\t\tthis.callEvent(\"insertCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"updated\":\n\t\t\t\t\t\t\tthis.callEvent(\"updateCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\t\tthis.callEvent(\"deleteCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself._silent_mode = false;\n\t\t\t}\n\t\t\tself._update_busy = false;\n\t\t\tself = null;\n\t\t});\n\t},\n\n\tdestructor: function() {\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t\tthis.updatedRows = [];\n\t\tthis._in_progress = {};\n\t\tthis._invalid = {};\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tdelete this._initialized;\n\t},\n\n\turl: function(url) {\n\t\tthis.serverProcessor = this._serverProcessor = url;\n\t},\n\n\t_serializeAsJSON: function(data) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\n\t\tvar copy = this.$scheduler.utils.copy(data);\n\t\tif (this._tMode === \"REST-JSON\") {\n\t\t\tdelete copy.id;\n\t\t\tdelete copy[this.action_param];\n\t\t}\n\n\t\treturn JSON.stringify(copy);\n\t},\n\n\t// GET/POST/JSON modes of the dataProcessor didn't send the whole data items in 'delete' requests\n\t// clear extra info from the data in order not to change the request format\n\t_cleanupArgumentsBeforeSend: function(dataToSend) {\n\t\tvar processedData;\n\t\tif(dataToSend[this.action_param] === undefined){// hash of updated items, and not an individual item\n\t\t\tprocessedData = {};\n\t\t\tfor(var i in dataToSend) {\n\t\t\t\tprocessedData[i] = this._cleanupArgumentsBeforeSend(dataToSend[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t}\n\t\treturn processedData;\n\t},\n\t_cleanupItemBeforeSend: function(updatedItem) {\n\t\tvar output = null;\n\t\tif(updatedItem){\n\t\t\tif(updatedItem[this.action_param] === \"deleted\"){\n\t\t\t\toutput = {};\n\t\t\t\toutput.id = updatedItem.id;\n\t\t\t\toutput[this.action_param] = updatedItem[this.action_param];\n\t\t\t}else{\n\t\t\t\toutput = updatedItem;\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t},\n\n\t_forEachUpdatedRow: function(code) {\n\t\tvar updatedRows = this.updatedRows.slice();\n\t\tfor (var i = 0; i < updatedRows.length; i++) {\n\t\t\tvar rowId = updatedRows[i];\n\t\t\tif (this.$scheduler.getUserData(rowId, this.action_param)) {\n\t\t\t\tcode.call(this, rowId);\n\t\t\t}\n\t\t}\n\t},\n\t_prepareItemForJson(item){\n\t\tconst processedItem = {};\n\t\tconst scheduler = this.$scheduler;\n\t\tconst copy = scheduler.utils.copy(item);\n\t\tfor (let i in copy) {\n\t\t\tlet prop = copy[i];\n\t\t\tif (i.indexOf(\"_\") === 0) {\n\t\t\t\tcontinue;\n\t\t\t} else if (prop){\n\t\t\t\tif(prop.getUTCFullYear){\n\t\t\t\t\tprocessedItem[i] = scheduler._helpers.formatDate(prop);\n\t\t\t\t} else if(typeof prop == \"object\") {\n\t\t\t\t\tprocessedItem[i] = this._prepareItemForJson(prop);\n\t\t\t\t} else {\n\t\t\t\t\tprocessedItem[i] = prop; \n\t\t\t\t}\n\t\t\t} else if (prop !== undefined){\n\t\t\t\tprocessedItem[i] = prop; \n\t\t\t}\n\t\t}\n\t\tprocessedItem[this.action_param] = scheduler.getUserData(item.id, this.action_param);\n\t\treturn processedItem;\n\t},\n\t_prepareItemForForm(item){\n\t\tconst processedItem = {};\n\t\tconst scheduler = this.$scheduler;\n\t\tconst copy = scheduler.utils.copy(item);\n\t\tfor (var i in copy) {\n\t\t\tlet prop = copy[i];\n\t\t\tif (i.indexOf(\"_\") === 0) {\n\t\t\t\tcontinue;\n\t\t\t} else if (prop) {\n\t\t\t\tif(prop.getUTCFullYear){\n\t\t\t\t\tprocessedItem[i] = scheduler._helpers.formatDate(prop);\n\t\t\t\t} else if(typeof prop == \"object\") {\n\t\t\t\t\tprocessedItem[i] = this._prepareItemForForm(prop);\n\t\t\t\t} else {\n\t\t\t\t\tprocessedItem[i] = prop;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tprocessedItem[i] = \"\"; // for all falthy values\n\t\t\t}\n\t\t}\n\t\tprocessedItem[this.action_param] = scheduler.getUserData(item.id, this.action_param);\n\t\treturn processedItem;\n\t},\n\t_prepareDataItem: function(item) {\n\t\tif(this._serializeAsJson){\n\t\t\treturn this._prepareItemForJson(item);\n\t\t}else {\n\t\t\treturn this._prepareItemForForm(item);\n\t\t}\n\t},\n\t_getRowData: function(id) {\n\t\tvar dataItem = this.$scheduler.getEvent(id);\n\t\tif (!dataItem) {\n\t\t\tdataItem = { id: id };\n\t\t}\n\t\treturn this._prepareDataItem(dataItem);\n\t}\n};\n\n\nexport default function extend(scheduler) {\n\nscheduler.createDataProcessor = function(config) {\n\tvar router;\n\tvar tMode;\n\tif (config instanceof Function) {\n\t\trouter = config;\n\t} else if (config.hasOwnProperty(\"router\")) {\n\t\trouter = config.router;\n\t} else if(config.hasOwnProperty(\"event\")){\n\t\trouter = config;\n\t}\n\n\tif (router) {\n\t\ttMode = \"CUSTOM\";\n\t} else {\n\t\ttMode = config.mode || \"REST-JSON\";\n\t}\n\n\tvar dp = new DataProcessor(config.url);\n\tdp.init(scheduler);\n\tdp.setTransactionMode({\n\t\tmode: tMode,\n\t\trouter: router\n\t}, config.batchUpdate); // FIXME: config.batchUpdate where it is explained?\n\treturn dp;\n};\n\nscheduler.DataProcessor = DataProcessor;\n\n}\n\n//var dataProcessor = global.dataProcessor = DataProcessor; // for old","import utils from \"./utils/utils\";\nimport domHelpers from \"./utils/dom_helpers\";\n\n\nexport default function(scheduler) {\n\n\tvar boxAttribute = \"data-dhxbox\";\n\n\tvar _dhx_msg_cfg = null;\n\n\tfunction callback(config, result, event) {\n\t\tvar usercall = config.callback;\n\t\tif (usercall)\n\t\t\tusercall(result, event);\n\n\t\tmodalBox.hide(config.box);\n\t\t_dhx_msg_cfg = config.box = null;\n\t}\n\n\tfunction modal_key(event) {\n\t\tif (_dhx_msg_cfg) {\n\n\t\t\tvar code = event.which || event.keyCode;\n\t\t\tvar preventDefault = false;\n\n\t\t\tif (messageBox.keyboard) {\n\t\t\t\tif (code == 13 || code == 32) {\n\t\t\t\t\t// default behavior is to confirm/submit popup on space/enter\n\t\t\t\t\t// if browser focus is set on button element - do button click instead of default behavior\n\t\t\t\t\tvar target = event.target || event.srcElement;\n\t\t\t\t\tif (domHelpers.getClassName(target).indexOf(\"scheduler_popup_button\") > -1 && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback(_dhx_msg_cfg, true);\n\t\t\t\t\t\tpreventDefault = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (code == 27) {\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\n\t\t\t\t\tpreventDefault = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (preventDefault) {\n\t\t\t\tif (event.preventDefault){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn !(event.cancelBubble = true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\tscheduler.event(document, \"keydown\", modal_key, true);\n\n\tfunction modality(mode) {\n\t\tif (!modality.cover) {\n\t\t\tmodality.cover = document.createElement(\"div\");\n\t\t\t//necessary for IE only\n\t\t\tscheduler.event(modality.cover, \"keydown\", modal_key);\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\n\t\t\tdocument.body.appendChild(modality.cover);\n\t\t}\n\n\t\tmodality.cover.style.display = mode ? \"inline-block\" : \"none\";\n\t}\n\n\tfunction button(text, classValue, result) {\n\t\tvar buttonAriaAttrs = scheduler._waiAria.messageButtonAttrString(text);\n\t\tvar name = (classValue || \"\").toLowerCase().replace(/ /g, \"_\");\n\t\tvar buttonCss = `scheduler_${name}_button dhtmlx_${name}_button`; \n\t\treturn `<div ${buttonAriaAttrs} class='scheduler_popup_button dhtmlx_popup_button ${buttonCss}' data-result='${result}' result='${result}' ><div>${text}</div></div>`;\n\t}\n\n\tfunction info(text) {\n\t\tif (!messageBox.area) {\n\t\t\tmessageBox.area = document.createElement(\"div\");\n\t\t\tmessageBox.area.className = \"scheduler_message_area dhtmlx_message_area\";\n\t\t\tmessageBox.area.style[messageBox.position] = \"5px\";\n\t\t\tdocument.body.appendChild(messageBox.area);\n\t\t}\n\n\t\tmessageBox.hide(text.id);\n\t\tvar message = document.createElement(\"div\");\n\t\tmessage.innerHTML = \"<div>\" + text.text + \"</div>\";\n\t\tmessage.className = \"scheduler-info dhtmlx-info scheduler-\" + text.type + \" dhtmlx-\" + text.type;\n\t\tscheduler.event(message, \"click\",function (e) {\n            if(text.callback) {\n                text.callback.call(this, e);\n            }\n\t\t\tmessageBox.hide(text.id);\n\t\t\ttext = null;\n\t\t});\n\n\t\tscheduler._waiAria.messageInfoAttr(message);\n\n\t\tif (messageBox.position == \"bottom\" && messageBox.area.firstChild)\n\t\t\tmessageBox.area.insertBefore(message, messageBox.area.firstChild);\n\t\telse\n\t\t\tmessageBox.area.appendChild(message);\n\n\t\tif (text.expire > 0)\n\t\t\tmessageBox.timers[text.id] = window.setTimeout(function () {\n\t\t\t\t// GS-1213: We need that when Scheduler is destroyed\n\t\t\t\tif (messageBox) messageBox.hide(text.id);\n\t\t\t}, text.expire);\n\n\t\tmessageBox.pull[text.id] = message;\n\t\tmessage = null;\n\n\t\treturn text.id;\n\t}\n\n\tfunction getFirstDefined() {\n\t\tvar values = [].slice.apply(arguments, [0]);\n\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tif (values[i]) {\n\t\t\t\treturn values[i];\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction _boxStructure(config, ok, cancel) {\n\t\tvar box = document.createElement(\"div\");\n\n\t\tvar contentId = utils.uid();\n\t\tscheduler._waiAria.messageModalAttr(box, contentId);\n\n\n\t\tbox.className = \" scheduler_modal_box dhtmlx_modal_box scheduler-\" + config.type + \" dhtmlx-\" + config.type;\n\t\tbox.setAttribute(boxAttribute, 1);\n\n\t\tvar inner = '';\n\n\t\tif (config.width)\n\t\t\tbox.style.width = config.width;\n\t\tif (config.height)\n\t\t\tbox.style.height = config.height;\n\t\tif (config.title)\n\t\t\tinner += '<div class=\"scheduler_popup_title dhtmlx_popup_title\">' + config.title + '</div>';\n\t\tinner += '<div class=\"scheduler_popup_text dhtmlx_popup_text\" id=\"' + contentId + '\"><span>' + (config.content ? '' : config.text) + '</span></div><div  class=\"scheduler_popup_controls dhtmlx_popup_controls\">';\n\t\tif (ok)\n\t\t\tinner += button(getFirstDefined(config.ok, scheduler.locale.labels.message_ok, \"OK\"), \"ok\", true);\n\t\tif (cancel)\n\t\t\tinner += button(getFirstDefined(config.cancel, scheduler.locale.labels.message_cancel, \"Cancel\"), \"cancel\", false);\n\n\t\tif (config.buttons) {\n\t\t\tfor (var i = 0; i < config.buttons.length; i++) {\n\t\t\t\tvar btn = config.buttons[i];\n\t\t\t\tif (typeof btn == \"object\") {\n\t\t\t\t\t// Support { label:\"Save\", css:\"main_button\", value:\"save\" }\n\t\t\t\t\tvar label = btn.label;\n\t\t\t\t\tvar css = btn.css || (\"scheduler_\" + btn.label.toLowerCase() + \"_button dhtmlx_\" + btn.label.toLowerCase() + \"_button\");\n\t\t\t\t\tvar value = btn.value || i;\n\t\t\t\t\tinner += button(label, css, value);\n\t\t\t\t} else {\n\t\t\t\t\tinner += button(btn, btn, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinner += '</div>';\n\t\tbox.innerHTML = inner;\n\n\t\tif (config.content) {\n\t\t\tvar node = config.content;\n\t\t\tif (typeof node == \"string\")\n\t\t\t\tnode = document.getElementById(node);\n\t\t\tif (node.style.display == 'none')\n\t\t\t\tnode.style.display = \"\";\n\t\t\tbox.childNodes[config.title ? 1 : 0].appendChild(node);\n\t\t}\n\n\t\tscheduler.event(box, \"click\", function (event) {\n\t\t\tvar source = event.target || event.srcElement;\n\t\t\tif (!source.className) source = source.parentNode;\n\t\t\tif (domHelpers.closest(source, \".scheduler_popup_button\")) {\n\t\t\t\tvar result = source.getAttribute(\"data-result\");\n\t\t\t\tresult = (result == \"true\") || (result == \"false\" ? false : result);\n\t\t\t\tcallback(config, result, event);\n\t\t\t}\n\t\t});\n\t\tconfig.box = box;\n\t\tif (ok || cancel)\n\t\t\t_dhx_msg_cfg = config;\n\n\t\treturn box;\n\t}\n\n\tfunction _createBox(config, ok, cancel) {\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\n\n\t\tif (!config.hidden)\n\t\t\tmodality(true);\n\t\tdocument.body.appendChild(box);\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - box.offsetWidth) / 2));\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - box.offsetHeight) / 2));\n\t\tif (config.position == \"top\")\n\t\t\tbox.style.top = \"-3px\";\n\t\telse\n\t\t\tbox.style.top = y + 'px';\n\t\tbox.style.left = x + 'px';\n\t\t//necessary for IE only\n\t\tscheduler.event(box, \"keydown\", modal_key);\n\n\t\tmodalBox.focus(box);\n\n\t\tif (config.hidden)\n\t\t\tmodalBox.hide(box);\n\n\t\tscheduler.callEvent(\"onMessagePopup\", [box]);\n\t\treturn box;\n\t}\n\n\tfunction alertPopup(config) {\n\t\treturn _createBox(config, true, false);\n\t}\n\n\tfunction confirmPopup(config) {\n\t\treturn _createBox(config, true, true);\n\t}\n\n\tfunction boxPopup(config) {\n\t\treturn _createBox(config);\n\t}\n\n\tfunction box_params(text, type, callback) {\n\t\tif (typeof text != \"object\") {\n\t\t\tif (typeof type == \"function\") {\n\t\t\t\tcallback = type;\n\t\t\t\ttype = \"\";\n\t\t\t}\n\t\t\ttext = {text: text, type: type, callback: callback};\n\t\t}\n\t\treturn text;\n\t}\n\n\tfunction params(text, type, expire, id, callback) {\n\t\tif (typeof text != \"object\")\n\t\t\ttext = {text: text, type: type, expire: expire, id: id, callback: callback};\n\t\ttext.id = text.id || utils.uid();\n\t\ttext.expire = text.expire || messageBox.expire;\n\t\treturn text;\n\t}\n\n\tvar alertBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"confirm\";\n\t\treturn alertPopup(text);\n\t};\n\tvar confirmBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn confirmPopup(text);\n\t};\n\tvar modalBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn boxPopup(text);\n\t};\n\tmodalBox.hide = function (node) {\n\t\twhile (node && node.getAttribute && !node.getAttribute(boxAttribute))\n\t\t\tnode = node.parentNode;\n\t\tif (node) {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t\tmodality(false);\n\n\t\t\tscheduler.callEvent(\"onAfterMessagePopup\", [node]);\n\t\t}\n\t};\n\n\tmodalBox.focus = function (node) {\n\t\tsetTimeout(function () {\n\t\t\tvar focusable = domHelpers.getFocusableNodes(node);\n\t\t\tif (focusable.length) {\n\t\t\t\tif (focusable[0].focus) focusable[0].focus();\n\t\t\t}\n\t\t}, 1);\n\t};\n\n\tvar messageBox = function (text, type, expire, id) {\n\t\ttext = params.apply(this, arguments);\n\t\ttext.type = text.type || \"info\";\n\n\t\tvar subtype = text.type.split(\"-\")[0];\n\t\tswitch (subtype) {\n\t\t\tcase \"alert\":\n\t\t\t\treturn alertPopup(text);\n\t\t\tcase \"confirm\":\n\t\t\t\treturn confirmPopup(text);\n\t\t\tcase \"modalbox\":\n\t\t\t\treturn boxPopup(text);\n\t\t\tdefault:\n\t\t\t\treturn info(text);\n\t\t}\n\t};\n\n\tmessageBox.seed = (new Date()).valueOf();\n\tmessageBox.uid = utils.uid;\n\tmessageBox.expire = 4000;\n\tmessageBox.keyboard = true;\n\tmessageBox.position = \"top\";\n\tmessageBox.pull = {};\n\tmessageBox.timers = {};\n\n\tmessageBox.hideAll = function () {\n\t\tfor (var key in messageBox.pull)\n\t\t\tmessageBox.hide(key);\n\t};\n\tmessageBox.hide = function (id) {\n\t\tvar obj = messageBox.pull[id];\n\t\tif (obj && obj.parentNode) {\n\t\t\twindow.setTimeout(function () {\n\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\tobj = null;\n\t\t\t}, 2000);\n\t\t\tobj.className += \" hidden\";\n\n\t\t\tif (messageBox.timers[id])\n\t\t\t\twindow.clearTimeout(messageBox.timers[id]);\n\t\t\tdelete messageBox.pull[id];\n\t\t}\n\t};\n\n\tvar popups = [];\n\tscheduler.attachEvent(\"onMessagePopup\", function(box){\n\t\tpopups.push(box);\n\t});\n\tscheduler.attachEvent(\"onAfterMessagePopup\", function(box){\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i] === box){\n\t\t\t\tpopups.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t});\n\n\tscheduler.attachEvent(\"onDestroy\", function(){\n\t\tif(modality.cover && modality.cover.parentNode){\n\t\t\tmodality.cover.parentNode.removeChild(modality.cover);\n\t\t}\n\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i].parentNode){\n\t\t\t\tpopups[i].parentNode.removeChild(popups[i]);\n\t\t\t}\n\t\t}\n\t\tpopups = null;\n\n\t\tif(messageBox.area && messageBox.area.parentNode){\n\t\t\tmessageBox.area.parentNode.removeChild(messageBox.area);\n\t\t}\n\t\tmessageBox = null;\n\t});\n\n\treturn {\n\t\talert: alertBox,\n\t\tconfirm: confirmBox,\n\t\tmessage: messageBox,\n\t\tmodalbox: modalBox\n\t};\n}","export default {\n\tdate: {\n\t\tmonth_full: [\" \", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \" \", \" \", \" \"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"  ,   \", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"       \",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tfull_day: \" \",\n\n\t\tconfirm_recurring: \"       \",\n\t\tsection_recurring: \" \",\n\t\tbutton_recurring: \"\",\n\t\tbutton_recurring_open: \"\",\n\t\tbutton_edit_series: \" \",\n\t\tbutton_edit_occurrence: \" \",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create: \"Drag to create\",\n\t\tdrag_to_move: \"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour: \"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"  \",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \"   :\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \" \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \"\",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"  \",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end2: \"\",\n\t\trepeat_radio_end3: \" \",\n\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \" \",\n\t\trepeat_workdays: \"  \",\n\t\trepeat_weekly: \" \",\n\t\trepeat_monthly: \" \",\n\t\trepeat_yearly: \" \",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \" \",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n\n\n","/*\n Translation by Sofya Morozova\n */\nexport default {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [ \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //   , ?\n\t\tconfirm_deleting: \"   , ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tfull_day: \" \",\n\n\t\tconfirm_recurring: \"      ?\",\n\t\tsection_recurring: \"\",\n\t\tbutton_recurring: \"\",\n\t\tbutton_recurring_open: \"\",\n\t\tbutton_edit_series: \" \",\n\t\tbutton_edit_occurrence: \" \",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"\",\n\t\tdate: \"\",\n\t\tdescription: \"\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"ic\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\",\n\t\trepeat_radio_week: \"\",\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"  \",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \"\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \"  \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \" \",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"  \",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end2: \"\",\n\t\trepeat_radio_end3: \" \",\n\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \" \",\n\t\trepeat_workdays: \"  \",\n\t\trepeat_weekly: \" \",\n\t\trepeat_monthly: \" \",\n\t\trepeat_yearly: \" \",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \" \",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"e\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n","/*\n @Traducido por Vicente Adria Bohigues - vicenteadria@hotmail.com\n */\nexport default {\n\tdate: {\n\t\tmonth_full: [\"Gener\", \"Febrer\", \"Mar\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\n\t\tday_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Hui\",\n\t\tday_tab: \"Dia\",\n\t\tweek_tab: \"Setmana\",\n\t\tmonth_tab: \"Mes\",\n\t\tnew_event: \"Nou esdeveniment\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancellar\",\n\t\ticon_details: \"Detalls\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Esborrar\",\n\t\tconfirm_closing: \"\", //\"Els seus canvis es perdrn, continuar ?\"\n\t\tconfirm_deleting: \"L'esdeveniment s'esborrar definitivament, continuar ?\",\n\t\tsection_description: \"Descripci\",\n\t\tsection_time: \"Periode de temps\",\n\t\tfull_day: \"Tot el dia\",\n\n\t\tconfirm_recurring: \"Desitja modificar el conjunt d'esdeveniments repetits?\",\n\t\tsection_recurring: \"Repeteixca l'esdeveniment\",\n\t\tbutton_recurring: \"Impedit\",\n\t\tbutton_recurring_open: \"Perms\",\n\t\tbutton_edit_series: \"Edit srie\",\n\t\tbutton_edit_occurrence: \"Edita Instncia\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Data\",\n\t\tdescription: \"Descripci\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Any\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Taula\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create: \"Drag to create\",\n\t\tdrag_to_move: \"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour: \"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Diari\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Setmanal\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Mensual\",\n\t\trepeat_radio_year: \"Anual\",\n\t\trepeat_radio_day_type: \"Cada\",\n\t\trepeat_text_day_count: \"dia\",\n\t\trepeat_radio_day_type2: \"Cada dia laborable\",\n\t\trepeat_week: \" Repetir cada\",\n\t\trepeat_text_week_count: \"setmana els dies segents:\",\n\t\trepeat_radio_month_type: \"Repetir\",\n\t\trepeat_radio_month_start: \"El\",\n\t\trepeat_text_month_day: \"dia cada\",\n\t\trepeat_text_month_count: \"mes\",\n\t\trepeat_text_month_count2_before: \"cada\",\n\t\trepeat_text_month_count2_after: \"mes\",\n\t\trepeat_year_label: \"El\",\n\t\tselect_year_day2: \"de\",\n\t\trepeat_text_year_day: \"dia\",\n\t\tselect_year_month: \"mes\",\n\t\trepeat_radio_end: \"Sense data de finalitzaci\",\n\t\trepeat_text_occurrences_count: \"ocurrncies\",\n\t\trepeat_radio_end2: \"Desprs\",\n\t\trepeat_radio_end3: \"Finalitzar el\",\n\n\t\trepeat_never: \"Mai\",\n\t\trepeat_daily: \"Cada dia\",\n\t\trepeat_workdays: \"Cada dia laborable\",\n\t\trepeat_weekly: \"Cada setmana\",\n\t\trepeat_monthly: \"Cada mes\",\n\t\trepeat_yearly: \"Cada any\",\n\t\trepeat_custom: \"Personalitzat\",\n\t\trepeat_freq_day: \"Dia\",\n\t\trepeat_freq_week: \"Setmana\",\n\t\trepeat_freq_month: \"Mes\",\n\t\trepeat_freq_year: \"Any\",\n\t\trepeat_on_date: \"En la data\",\n\t\trepeat_ends: \"Finalitza\",\n\n\t\tmonth_for_recurring: [\"Gener\", \"Febrer\", \"Mar\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n\t\tday_for_recurring: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"]\n\t}\n};","/*\nTranslation by FreezeSoul\n*/\n//scheduler.config.day_date=\"%M %d %D\";\n//scheduler.config.default_date=\"%Y %M %d\";\n//scheduler.config.month_date=\"%Y %M\";\n\nexport default {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \"\",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"!\", //Your changes will be lost, are your sure?\n\t\tconfirm_deleting: \"?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tfull_day: \"\",\n\n\t\tconfirm_recurring:\"?\",\n\t\tsection_recurring:\"\",\n\t\tbutton_recurring:\"\",\n\t\tbutton_recurring_open:\"\",\n\t\tbutton_edit_series: \"\",\n\t\tbutton_edit_occurrence: \"\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab:\"\",\n\t\tdate:\"\",\n\t\tdescription:\"\",\n\t\t\n\t\t/*year view extension*/\n\t\tyear_tab:\"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab:\"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\",\n\t\trepeat_radio_week: \"\",\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"\",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \":\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \" \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \"\",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"\",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end2: \"\",\n\t\trepeat_radio_end3: \"\",\n\t\t\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \"\",\n\t\trepeat_workdays: \"\",\n\t\trepeat_weekly: \"\",\n\t\trepeat_monthly: \"\",\n\t\trepeat_yearly: \"\",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \"\",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Leden\", \"nor\", \"Bezen\", \"Duben\", \"Kvten\", \"erven\", \"ervenec\", \"Srpen\", \"Z\", \"jen\", \"Listopad\", \"Prosinec\"],\n\t\tmonth_short: [\"Led\", \"n\", \"Be\", \"Dub\", \"Kv\", \"er\", \"ec\", \"Srp\", \"Z\", \"j\", \"List\", \"Pro\"],\n\t\tday_full: [\"Nedle\", \"Pondl\", \"ter\", \"Steda\", \"tvrtek\", \"Ptek\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"t\", \"St\", \"t\", \"P\", \"So\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Dnes\",\n\t\tday_tab: \"Den\",\n\t\tweek_tab: \"Tden\",\n\t\tmonth_tab: \"Msc\",\n\t\tnew_event: \"Nov udlost\",\n\t\ticon_save: \"Uloit\",\n\t\ticon_cancel: \"Zpt\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Smazat\",\n\t\tconfirm_closing: \"\", //Vae zmny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udlost bude trvale smazna, opravdu?\",\n\t\tsection_description: \"Poznmky\",\n\t\tsection_time: \"Doba platnosti\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Pejete si upravit celou adu opakovanch udlost?\",\n\t\tsection_recurring: \"Opakovn udlosti\",\n\t\tbutton_recurring: \"Vypnuto\",\n\t\tbutton_recurring_open: \"Zapnuto\",\n\t\tbutton_edit_series: \"Edit series\",\n\t\tbutton_edit_occurrence: \"Upravit instance\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Program\",\n\t\tdate: \"Datum\",\n\t\tdescription: \"Poznmka\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Rok\",\n\t\tfull_day: \"Full day\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Program\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Mka\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Denn\",\n\t\trepeat_radio_week: \"Tdn\",\n\t\trepeat_radio_month: \"Msn\",\n\t\trepeat_radio_year: \"Ron\",\n\t\trepeat_radio_day_type: \"kad\",\n\t\trepeat_text_day_count: \"Den\",\n\t\trepeat_radio_day_type2: \"pracovn dny\",\n\t\trepeat_week: \"Opakuje kadch\",\n\t\trepeat_text_week_count: \"Tdn na:\",\n\t\trepeat_radio_month_type: \"u kadho\",\n\t\trepeat_radio_month_start: \"na\",\n\t\trepeat_text_month_day: \"Den kadho\",\n\t\trepeat_text_month_count: \"Msc\",\n\t\trepeat_text_month_count2_before: \"kad\",\n\t\trepeat_text_month_count2_after: \"Msc\",\n\t\trepeat_year_label: \"na\",\n\t\tselect_year_day2: \"v\",\n\t\trepeat_text_year_day: \"Den v\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"bez data ukonen\",\n\t\trepeat_text_occurrences_count: \"Udlosti\",\n\t\trepeat_radio_end2: \"po\",\n\t\trepeat_radio_end3: \"Konec\",\n\n\t\trepeat_never: \"Nikdy\",\n\t\trepeat_daily: \"Kad den\",\n\t\trepeat_workdays: \"Kad pracovn den\",\n\t\trepeat_weekly: \"Kad tden\",\n\t\trepeat_monthly: \"Kad msc\",\n\t\trepeat_yearly: \"Kad rok\",\n\t\trepeat_custom: \"Vlastn\",\n\t\trepeat_freq_day: \"Den\",\n\t\trepeat_freq_week: \"Tden\",\n\t\trepeat_freq_month: \"Msc\",\n\t\trepeat_freq_year: \"Rok\",\n\t\trepeat_on_date: \"Na datum\",\n\t\trepeat_ends: \"Kon\",\n\n\t\tmonth_for_recurring: [\"Leden\", \"nor\", \"Bezen\", \"Duben\", \"Kvten\", \"erven\", \"ervenec\", \"Srpen\", \"Z\", \"jen\", \"Listopad\", \"Prosinec\"],\n\t\tday_for_recurring: [\"Nedle \", \"Pondl\", \"ter\", \"Steda\", \"tvrtek\", \"Ptek\", \"Sobota\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Idag\",\n\t\tday_tab: \"Dag\",\n\t\tweek_tab: \"Uge\",\n\t\tmonth_tab: \"Mned\",\n\t\tnew_event: \"Ny begivenhed\",\n\t\ticon_save: \"Gem\",\n\t\ticon_cancel: \"Fortryd\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Tilret\",\n\t\ticon_delete: \"Slet\",\n\t\tconfirm_closing: \"Dine rettelser vil g tabt.. Er dy sikker?\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Vil du tilrette hele serien af gentagne begivenheder?\",\n\t\tsection_recurring: \"Gentag begivenhed\",\n\t\tbutton_recurring: \"Frakoblet\",\n\t\tbutton_recurring_open: \"Tilkoblet\",\n\t\tbutton_edit_series: \"Rediger serien\",\n\t\tbutton_edit_occurrence: \"Rediger en kopi\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Dagsorden\",\n\t\tdate: \"Dato\",\n\t\tdescription: \"Beskrivelse\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"r\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Dagsorden\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grid\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Daglig\",\n\t\trepeat_radio_week: \"Ugenlig\",\n\t\trepeat_radio_month: \"Mnedlig\",\n\t\trepeat_radio_year: \"rlig\",\n\t\trepeat_radio_day_type: \"Hver\",\n\t\trepeat_text_day_count: \"dag\",\n\t\trepeat_radio_day_type2: \"P hver arbejdsdag\",\n\t\trepeat_week: \" Gentager sig hver\",\n\t\trepeat_text_week_count: \"uge p flgende dage:\",\n\t\trepeat_radio_month_type: \"Hver den\",\n\t\trepeat_radio_month_start: \"Den\",\n\t\trepeat_text_month_day: \" i hver\",\n\t\trepeat_text_month_count: \"mned\",\n\t\trepeat_text_month_count2_before: \"hver\",\n\t\trepeat_text_month_count2_after: \"mned\",\n\t\trepeat_year_label: \"Den\",\n\t\tselect_year_day2: \"i\",\n\t\trepeat_text_year_day: \"dag i\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"Ingen slutdato\",\n\t\trepeat_text_occurrences_count: \"gentagelse\",\n\t\trepeat_radio_end2: \"Efter\",\n\t\trepeat_radio_end3: \"Slut\",\n\n\t\trepeat_never: \"Aldrig\",\n\t\trepeat_daily: \"Hver dag\",\n\t\trepeat_workdays: \"Hver hverdag\",\n\t\trepeat_weekly: \"Hver uge\",\n\t\trepeat_monthly: \"Hver mned\",\n\t\trepeat_yearly: \"Hvert r\",\n\t\trepeat_custom: \"Brugerdefineret\",\n\t\trepeat_freq_day: \"Dag\",\n\t\trepeat_freq_week: \"Uge\",\n\t\trepeat_freq_month: \"Mned\",\n\t\trepeat_freq_year: \"r\",\n\t\trepeat_on_date: \"P dato\",\n\t\trepeat_ends: \"Slutter\",\n\n\t\tmonth_for_recurring: [\"Januar\", \"Februar\", \"Mrz\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Dezember\"],\n\t\tday_for_recurring: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\" Januar\", \" Februar\", \" Mrz \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\n\t\tday_full: [ \"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\n\t\tday_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Heute\",\n\t\tday_tab: \"Tag\",\n\t\tweek_tab: \"Woche\",\n\t\tmonth_tab: \"Monat\",\n\t\tnew_event: \"neuer Eintrag\",\n\t\ticon_save: \"Speichern\",\n\t\ticon_cancel: \"Abbrechen\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"ndern\",\n\t\ticon_delete: \"Lschen\",\n\t\tconfirm_closing: \"\", //\"Ihre Vernderungen werden verloren sein, wollen Sie ergnzen? \"\n\t\tconfirm_deleting: \"Der Eintrag wird gelscht\",\n\t\tsection_description: \"Beschreibung\",\n\t\tsection_time: \"Zeitspanne\",\n\t\tfull_day: \"Ganzer Tag\",\n\n\t\tconfirm_recurring: \"Wollen Sie alle Eintrge bearbeiten oder nur diesen einzelnen Eintrag?\",\n\t\tsection_recurring: \"Wiederholung\",\n\t\tbutton_recurring: \"Aus\",\n\t\tbutton_recurring_open: \"An\",\n\t\tbutton_edit_series: \"Bearbeiten Sie die Serie\",\n\t\tbutton_edit_occurrence: \"Bearbeiten Sie eine Kopie\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Datum\",\n\t\tdescription: \"Beschreibung\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Jahre\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grid\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Tglich\",\n\t\trepeat_radio_week: \"Wchentlich\",\n\t\trepeat_radio_month: \"Monatlich\",\n\t\trepeat_radio_year: \"Jhrlich\",\n\t\trepeat_radio_day_type: \"jeden\",\n\t\trepeat_text_day_count: \"Tag\",\n\t\trepeat_radio_day_type2: \"an jedem Arbeitstag\",\n\t\trepeat_week: \" Wiederholt sich jede\",\n\t\trepeat_text_week_count: \"Woche am:\",\n\t\trepeat_radio_month_type: \"an jedem\",\n\t\trepeat_radio_month_start: \"am\",\n\t\trepeat_text_month_day: \"Tag eines jeden\",\n\t\trepeat_text_month_count: \"Monats\",\n\t\trepeat_text_month_count2_before: \"jeden\",\n\t\trepeat_text_month_count2_after: \"Monats\",\n\t\trepeat_year_label: \"am\",\n\t\tselect_year_day2: \"im\",\n\t\trepeat_text_year_day: \"Tag im\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"kein Enddatum\",\n\t\trepeat_text_occurrences_count: \"Ereignissen\",\n\t\trepeat_radio_end3: \"Schlu\",\n\t\trepeat_radio_end2: \"nach\",\n\n\t\trepeat_never: \"Nie\",\n\t\trepeat_daily: \"Jeden Tag\",\n\t\trepeat_workdays: \"Jeden Werktag\",\n\t\trepeat_weekly: \"Jede Woche\",\n\t\trepeat_monthly: \"Jeden Monat\",\n\t\trepeat_yearly: \"Jedes Jahr\",\n\t\trepeat_custom: \"Benutzerdefiniert\",\n\t\trepeat_freq_day: \"Tag\",\n\t\trepeat_freq_week: \"Woche\",\n\t\trepeat_freq_month: \"Monat\",\n\t\trepeat_freq_year: \"Jahr\",\n\t\trepeat_on_date: \"Am Datum\",\n\t\trepeat_ends: \"Endet\",\n\n\t\tmonth_for_recurring: [\"Januar\", \"Februar\", \"Mrz\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Dezember\"],\n\t\tday_for_recurring: [\"Sonntag\", \"Montag\", \"Dienstag\", \"Mittwoch\", \"Donnerstag\", \"Freitag\", \"Samstag\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"    .   ;\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tfull_day: \" \",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"        ;\",\n\t\tsection_recurring: \" \",\n\t\tbutton_recurring: \"\",\n\t\tbutton_recurring_open: \"\",\n\t\tbutton_edit_series: \"  \",\n\t\tbutton_edit_occurrence: \"  \",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \" \",\n\t\tdate: \"\",\n\t\tdescription: \"\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \" \",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\",\n\t\trepeat_radio_week: \"\",\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \" \",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \"   :\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \" \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \"\",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"  \",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end3: \" \",\n\t\trepeat_radio_end2: \" \",\n\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \" \",\n\t\trepeat_workdays: \"  \",\n\t\trepeat_weekly: \" \",\n\t\trepeat_monthly: \" \",\n\t\trepeat_yearly: \" \",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \" \",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n\n","export default {\n\tdate:{\n\t\tmonth_full:[\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\tmonth_short:[\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full:[\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n\t\tday_short:[\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n\t},\n\tlabels:{\n\t\tdhx_cal_today_button:\"Today\",\n\t\tday_tab:\"Day\",\n\t\tweek_tab:\"Week\",\n\t\tmonth_tab:\"Month\",\n\t\tnew_event:\"New event\",\n\t\ticon_save:\"Save\",\n\t\ticon_cancel:\"Cancel\",\n\t\ticon_details:\"Details\",\n\t\ticon_edit:\"Edit\",\n\t\ticon_delete:\"Delete\",\n\t\tconfirm_closing:\"\",//Your changes will be lost, are your sure ?\n\t\tconfirm_deleting:\"Event will be deleted permanently, are you sure?\",\n\t\tsection_description:\"Description\",\n\t\tsection_time:\"Time period\",\n\t\tfull_day:\"Full day\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring:\"Edit recurring event\",\n\t\tsection_recurring:\"Repeat event\",\n\t\tbutton_recurring:\"Disabled\",\n\t\tbutton_recurring_open:\"Enabled\",\n\t\tbutton_edit_series: \"All events\",\n\t\tbutton_edit_occurrence: \"This event\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\n\t\t/*agenda view extension*/\n\t\tagenda_tab:\"Agenda\",\n\t\tdate:\"Date\",\n\t\tdescription:\"Description\",\n\n\t\t/*year view extension*/\n\t\tyear_tab:\"Year\",\n\n\t\t/* week agenda extension */\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grid\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Daily\",//name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Weekly\",//name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Monthly\",\n\t\trepeat_radio_year: \"Yearly\",\n\t\trepeat_radio_day_type: \"Every\",\n\t\trepeat_text_day_count: \"day\",\n\t\trepeat_radio_day_type2: \"Every workday\",\n\t\trepeat_week: \" Repeat every\",\n\t\trepeat_text_week_count: \"week next days:\",\n\t\trepeat_radio_month_type: \"Repeat\",\n\t\trepeat_radio_month_start: \"On\",\n\t\trepeat_text_month_day: \"day every\",\n\t\trepeat_text_month_count: \"month\",\n\t\trepeat_text_month_count2_before: \"every\",\n\t\trepeat_text_month_count2_after: \"month\",\n\t\trepeat_year_label: \"On\",\n\t\tselect_year_day2: \"of\",\n\t\trepeat_text_year_day: \"day\",\n\t\tselect_year_month: \"month\",\n\t\trepeat_radio_end: \"No end date\",\n\t\trepeat_text_occurrences_count: \"occurrences\",\n\t\trepeat_radio_end2: \"After\",\n\t\trepeat_radio_end3: \"End by\",\n\n\t\trepeat_never: \"Never\",\n\t\trepeat_daily: \"Every day\",\n\t\trepeat_workdays: \"Every weekday\",\n\t\trepeat_weekly: \"Every week\",\n\t\trepeat_monthly: \"Every month\",\n\t\trepeat_yearly: \"Every year\",\n\t\trepeat_custom: \"Custom\",\n\t\trepeat_freq_day: \"Day\",\n\t\trepeat_freq_week: \"Week\",\n\t\trepeat_freq_month: \"Month\",\n\t\trepeat_freq_year: \"Year\",\n\t\trepeat_on_date: \"On date\",\n\t\trepeat_ends: \"Ends\",\n\n\t\tmonth_for_recurring: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\tday_for_recurring: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]//\n\t}\n};\n\n","/*\n @Autor Manuel Fernandez Panzuela - www.mfernandez.es\n */\nexport default {\n\tdate: {\n\t\tmonth_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n\t\tmonth_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Mircoles\", \"Jueves\", \"Viernes\", \"Sbado\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mi\", \"Jue\", \"Vie\", \"Sb\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Hoy\",\n\t\tday_tab: \"Da\",\n\t\tweek_tab: \"Semana\",\n\t\tmonth_tab: \"Mes\",\n\t\tnew_event: \"Nuevo evento\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalles\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Eliminar\",\n\t\tconfirm_closing: \"\", //\"Sus cambios se perdern, continuar ?\"\n\t\tconfirm_deleting: \"El evento se borrar definitivamente, continuar?\",\n\t\tsection_description: \"Descripcin\",\n\t\tsection_time: \"Perodo\",\n\t\tfull_day: \"Todo el da\",\n\n\t\tconfirm_recurring: \"Desea modificar el conjunto de eventos repetidos?\",\n\t\tsection_recurring: \"Repita el evento\",\n\t\tbutton_recurring: \"Impedido\",\n\t\tbutton_recurring_open: \"Permitido\",\n\t\tbutton_edit_series: \"Editar la serie\",\n\t\tbutton_edit_occurrence: \"Editar este evento\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Da\",\n\t\tdate: \"Fecha\",\n\t\tdescription: \"Descripcin\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Ao\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Da\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Reja\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Diariamente\",\n\t\trepeat_radio_week: \"Semanalmente\",\n\t\trepeat_radio_month: \"Mensualmente\",\n\t\trepeat_radio_year: \"Anualmente\",\n\t\trepeat_radio_day_type: \"Cada\",\n\t\trepeat_text_day_count: \"dia\",\n\t\trepeat_radio_day_type2: \"Cada jornada de trabajo\",\n\t\trepeat_week: \" Repetir cada\",\n\t\trepeat_text_week_count: \"semana:\",\n\t\trepeat_radio_month_type: \"Repita\",\n\t\trepeat_radio_month_start: \"El\",\n\t\trepeat_text_month_day: \"dia cada \",\n\t\trepeat_text_month_count: \"mes\",\n\t\trepeat_text_month_count2_before: \"cada\",\n\t\trepeat_text_month_count2_after: \"mes\",\n\t\trepeat_year_label: \"El\",\n\t\tselect_year_day2: \"del\",\n\t\trepeat_text_year_day: \"dia\",\n\t\tselect_year_month: \"mes\",\n\t\trepeat_radio_end: \"Sin fecha de finalizacin\",\n\t\trepeat_text_occurrences_count: \"ocurrencias\",\n\t\trepeat_radio_end3: \"Fin\",\n\t\trepeat_radio_end2: \"Despus de\",\n\n\t\trepeat_never: \"Nunca\",\n\t\trepeat_daily: \"Cada da\",\n\t\trepeat_workdays: \"Cada da laborable\",\n\t\trepeat_weekly: \"Cada semana\",\n\t\trepeat_monthly: \"Cada mes\",\n\t\trepeat_yearly: \"Cada ao\",\n\t\trepeat_custom: \"Personalizado\",\n\t\trepeat_freq_day: \"Da\",\n\t\trepeat_freq_week: \"Semana\",\n\t\trepeat_freq_month: \"Mes\",\n\t\trepeat_freq_year: \"Ao\",\n\t\trepeat_on_date: \"En la fecha\",\n\t\trepeat_ends: \"Termina\",\n\n\t\tmonth_for_recurring: [\"Enero\", \"Febrero\", \"rzo\", \"bril\", \"Mayo\", \"Junio\", \"Julio\", \"gosto\", \"Setiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n\t\tday_for_recurring: [\"Domingo\", \"Lunes\", \"Martes\", \"Mircoles\", \"Jeuves\", \"Viernes\", \"Sabado\"]\n\t}\n};\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n\t\tmonth_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\n\t\tday_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\n\t\tday_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Tnn\",\n\t\tday_tab: \"Piv\",\n\t\tweek_tab: \"Viikko\",\n\t\tmonth_tab: \"Kuukausi\",\n\t\tnew_event: \"Uusi tapahtuma\",\n\t\ticon_save: \"Tallenna\",\n\t\ticon_cancel: \"Peru\",\n\t\ticon_details: \"Tiedot\",\n\t\ticon_edit: \"Muokkaa\",\n\t\ticon_delete: \"Poista\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\n\t\tsection_description: \"Kuvaus\",\n\t\tsection_time: \"Aikajakso\",\n\t\tfull_day: \"Koko piv\",\n\n\t\tconfirm_recurring: \"Haluatko varmasti muokata toistuvan tapahtuman kaikkia jaksoja?\",\n\t\tsection_recurring: \"Toista tapahtuma\",\n\t\tbutton_recurring: \"Ei k&auml;yt&ouml;ss&auml;\",\n\t\tbutton_recurring_open: \"K&auml;yt&ouml;ss&auml;\",\n\t\tbutton_edit_series: \"Muokkaa sarja\",\n\t\tbutton_edit_occurrence: \"Muokkaa kopio\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Esityslista\",\n\t\tdate: \"Pivmr\",\n\t\tdescription: \"Kuvaus\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Vuoden\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Esityslista\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Ritil\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Luo uusi vetmll\",\n\t\tdrag_to_move:\"Siirr vetmll\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"P&auml;ivitt&auml;in\",\n\t\trepeat_radio_week: \"Viikoittain\",\n\t\trepeat_radio_month: \"Kuukausittain\",\n\t\trepeat_radio_year: \"Vuosittain\",\n\t\trepeat_radio_day_type: \"Joka\",\n\t\trepeat_text_day_count: \"p&auml;iv&auml;\",\n\t\trepeat_radio_day_type2: \"Joka arkip&auml;iv&auml;\",\n\t\trepeat_week: \"Toista joka\",\n\t\trepeat_text_week_count: \"viikko n&auml;in&auml; p&auml;ivin&auml;:\",\n\t\trepeat_radio_month_type: \"Toista\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \"p&auml;iv&auml;n&auml; joka\",\n\t\trepeat_text_month_count: \"kuukausi\",\n\t\trepeat_text_month_count2_before: \"joka\",\n\t\trepeat_text_month_count2_after: \"kuukausi\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"p&auml;iv&auml;\",\n\t\tselect_year_month: \"kuukausi\",\n\t\trepeat_radio_end: \"Ei loppumisaikaa\",\n\t\trepeat_text_occurrences_count: \"Toiston j&auml;lkeen\",\n\t\trepeat_radio_end3: \"Loppuu\",\n\t\trepeat_radio_end2: \"\",\n\n\t\trepeat_never: \"Ei koskaan\",\n\t\trepeat_daily: \"Joka piv\",\n\t\trepeat_workdays: \"Joka arkipiv\",\n\t\trepeat_weekly: \"Joka viikko\",\n\t\trepeat_monthly: \"Joka kuukausi\",\n\t\trepeat_yearly: \"Joka vuosi\",\n\t\trepeat_custom: \"Mukautettu\",\n\t\trepeat_freq_day: \"Piv\",\n\t\trepeat_freq_week: \"Viikko\",\n\t\trepeat_freq_month: \"Kuukausi\",\n\t\trepeat_freq_year: \"Vuosi\",\n\t\trepeat_on_date: \"Tiettyn pivn\",\n\t\trepeat_ends: \"Pttyy\",\n\n\t\tmonth_for_recurring: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n\t\tday_for_recurring: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"]\n\t}\n};\n\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Janvier\", \"Fvrier\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Aot\", \"Septembre\", \"Octobre\", \"Novembre\", \"Dcembre\"],\n\t\tmonth_short: [\"Jan\", \"Fv\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Ao\", \"Sep\", \"Oct\", \"Nov\", \"Dc\"],\n\t\tday_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\n\t\tday_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Aujourd'hui\",\n\t\tday_tab: \"Jour\",\n\t\tweek_tab: \"Semaine\",\n\t\tmonth_tab: \"Mois\",\n\t\tnew_event: \"Nouvel vnement\",\n\t\ticon_save: \"Enregistrer\",\n\t\ticon_cancel: \"Annuler\",\n\t\ticon_details: \"Dtails\",\n\t\ticon_edit: \"Modifier\",\n\t\ticon_delete: \"Effacer\",\n\t\tconfirm_closing: \"\", //Vos modifications seront perdus, tes-vous sr ?\n\t\tconfirm_deleting: \"L'vnement sera effac sans appel, tes-vous sr ?\",\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Priode\",\n\t\tfull_day: \"Journe complte\",\n\n\t\tconfirm_recurring: \"Voulez-vous diter toute une srie d'vnements rpts?\",\n\t\tsection_recurring: \"Priodicit\",\n\t\tbutton_recurring: \"Dsactiv\",\n\t\tbutton_recurring_open: \"Activ\",\n\t\tbutton_edit_series: \"Modifier la srie\",\n\t\tbutton_edit_occurrence: \"Modifier une copie\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Jour\",\n\t\tdate: \"Date\",\n\t\tdescription: \"Description\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Anne\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Jour\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grille\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Quotidienne\",\n\t\trepeat_radio_week: \"Hebdomadaire\",\n\t\trepeat_radio_month: \"Mensuelle\",\n\t\trepeat_radio_year: \"Annuelle\",\n\t\trepeat_radio_day_type: \"Chaque\",\n\t\trepeat_text_day_count: \"jour\",\n\t\trepeat_radio_day_type2: \"Chaque journe de travail\",\n\t\trepeat_week: \" Rpter toutes les\",\n\t\trepeat_text_week_count: \"semaine:\",\n\t\trepeat_radio_month_type: \"Rpter\",\n\t\trepeat_radio_month_start: \"Le\",\n\t\trepeat_text_month_day: \"jour chaque\",\n\t\trepeat_text_month_count: \"mois\",\n\t\trepeat_text_month_count2_before: \"chaque\",\n\t\trepeat_text_month_count2_after: \"mois\",\n\t\trepeat_year_label: \"Le\",\n\t\tselect_year_day2: \"du\",\n\t\trepeat_text_year_day: \"jour\",\n\t\tselect_year_month: \"mois\",\n\t\trepeat_radio_end: \"Pas de date d&quot;achvement\",\n\t\trepeat_text_occurrences_count: \"occurrences\",\n\t\trepeat_radio_end3: \"Fin\",\n\t\trepeat_radio_end2: \"Aprs\",\n\n\t\trepeat_never: \"Jamais\",\n\t\trepeat_daily: \"Chaque jour\",\n\t\trepeat_workdays: \"Chaque jour ouvrable\",\n\t\trepeat_weekly: \"Chaque semaine\",\n\t\trepeat_monthly: \"Chaque mois\",\n\t\trepeat_yearly: \"Chaque anne\",\n\t\trepeat_custom: \"Personnalis\",\n\t\trepeat_freq_day: \"Jour\",\n\t\trepeat_freq_week: \"Semaine\",\n\t\trepeat_freq_month: \"Mois\",\n\t\trepeat_freq_year: \"Anne\",\n\t\trepeat_on_date: \" la date\",\n\t\trepeat_ends: \"Se termine\",\n\n\t\tmonth_for_recurring: [\"Janvier\", \"Fvrier\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Aot\", \"Septembre\", \"Octobre\", \"Novembre\", \"Dcembre\"],\n\t\tday_for_recurring: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"]\n\t}\n};\n","export default {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"  .?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\n\t\tconfirm_recurring: \"      ?\",\n\t\tsection_recurring: \" \",\n\t\tbutton_recurring: \" \",\n\t\tbutton_recurring_open: \"\",\n\t\tfull_day: \" \",\n\t\tbutton_edit_series: \"  \",\n\t\tbutton_edit_occurrence: \" \",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \" \",\n\t\tdate: \"\",\n\t\tdescription: \"\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \" \",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"  \",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"\",\n\t\tprev: \"\",\n\t\tyear: \"\",\n\t\tmonth: \"\",\n\t\tday: \"\",\n\t\thour:\"\",\n\t\tminute: \"\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\",\n\t\trepeat_radio_week: \"\",\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \" \",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"   \",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \"  :\",\n\t\trepeat_radio_month_type: \" \",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \" \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \" \",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"  \",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end3: \" \",\n\t\trepeat_radio_end2: \"\",\n\n\t\trepeat_never: \" \",\n\t\trepeat_daily: \" \",\n\t\trepeat_workdays: \"  \",\n\t\trepeat_weekly: \" \",\n\t\trepeat_monthly: \" \",\n\t\trepeat_yearly: \" \",\n\t\trepeat_custom: \" \",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \"\",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Mrcius\", \"prilis\", \"Mjus\", \"Jnius\", \"Jlius\", \"Augusztus\", \"Szeptember\", \"Oktber\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"pr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Vasrnap\", \"Htf\", \"Kedd\", \"Szerda\", \"Cstrtk\", \"Pntek\", \"szombat\"],\n\t\tday_short: [\"Va\", \"H\", \"Ke\", \"Sze\", \"Cs\", \"P\", \"Szo\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Ma\",\n\t\tday_tab: \"Nap\",\n\t\tweek_tab: \"Ht\",\n\t\tmonth_tab: \"Hnap\",\n\t\tnew_event: \"j esemny\",\n\t\ticon_save: \"Ments\",\n\t\ticon_cancel: \"Mgse\",\n\t\ticon_details: \"Rszletek\",\n\t\ticon_edit: \"Szerkeszts\",\n\t\ticon_delete: \"Trls\",\n\t\tconfirm_closing: \"\", //A vltozsok elvesznek, biztosan folytatja? \"\n\t\tconfirm_deleting: \"Az esemny trlve lesz, biztosan folytatja?\",\n\t\tsection_description: \"Lers\",\n\t\tsection_time: \"Idszak\",\n\t\tfull_day: \"Egesz napos\",\n\n\t\t/*ismtld esemnyek*/\n\t\tconfirm_recurring: \"Biztosan szerkeszteni akarod az sszes ismtld esemny belltst?\",\n\t\tsection_recurring: \"Esemny ismtlse\",\n\t\tbutton_recurring: \"Tilts\",\n\t\tbutton_recurring_open: \"Engedlyezs\",\n\t\tbutton_edit_series: \"Edit series\",\n\t\tbutton_edit_occurrence: \"Szerkeszts brsg\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*napirendi nzet*/\n\t\tagenda_tab: \"Napirend\",\n\t\tdate: \"Dtum\",\n\t\tdescription: \"Lers\",\n\n\t\t/*ves nzet*/\n\t\tyear_tab: \"v\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Napi\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Heti\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Havi\",\n\t\trepeat_radio_year: \"ves\",\n\t\trepeat_radio_day_type: \"Minden\",\n\t\trepeat_text_day_count: \"nap\",\n\t\trepeat_radio_day_type2: \"Minden munkanap\",\n\t\trepeat_week: \" Ismtelje meg minden\",\n\t\trepeat_text_week_count: \"hten a kvetkez napokon:\",\n\t\trepeat_radio_month_type: \"Ismtls\",\n\t\trepeat_radio_month_start: \"Ekkor\",\n\t\trepeat_text_month_day: \"nap minden\",\n\t\trepeat_text_month_count: \"hnapban\",\n\t\trepeat_text_month_count2_before: \"minden\",\n\t\trepeat_text_month_count2_after: \"hnapban\",\n\t\trepeat_year_label: \"Ekkor\",\n\t\tselect_year_day2: \"-n/-n\",\n\t\trepeat_text_year_day: \"nap\",\n\t\tselect_year_month: \"hnap\",\n\t\trepeat_radio_end: \"Nincs befejezsi dtum\",\n\t\trepeat_text_occurrences_count: \"esemny\",\n\t\trepeat_radio_end2: \"Utn\",\n\t\trepeat_radio_end3: \"Befejez dtum\",\n\n\t\trepeat_never: \"Soha\",\n\t\trepeat_daily: \"Minden nap\",\n\t\trepeat_workdays: \"Minden munkanap\",\n\t\trepeat_weekly: \"Minden hten\",\n\t\trepeat_monthly: \"Minden hnapban\",\n\t\trepeat_yearly: \"Minden vben\",\n\t\trepeat_custom: \"Egyedi\",\n\t\trepeat_freq_day: \"Nap\",\n\t\trepeat_freq_week: \"Ht\",\n\t\trepeat_freq_month: \"Hnap\",\n\t\trepeat_freq_year: \"v\",\n\t\trepeat_on_date: \"Dtum szerint\",\n\t\trepeat_ends: \"Befejezdik\",\n\n\t\tmonth_for_recurring: [\"Janur\", \"Februr\", \"Mrcius\", \"prilis\", \"Mjus\", \"Jnius\", \"Jlius\", \"Augusztus\", \"Szeptember\", \"Oktber\", \"November\", \"December\"],\n\t\tday_for_recurring: [\"Vasrnap\", \"Htf\", \"Kedd\", \"Szerda\", \"Cstrtk\", \"Pntek\", \"Szombat\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\n\t\tday_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Hari Ini\",\n\t\tday_tab: \"Hari\",\n\t\tweek_tab: \"Minggu\",\n\t\tmonth_tab: \"Bulan\",\n\t\tnew_event: \"Acara Baru\",\n\t\ticon_save: \"Simpan\",\n\t\ticon_cancel: \"Batal\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Hapus\",\n\t\tconfirm_closing: \"\", /*Perubahan tidak akan disimpan ?*/\n\t\tconfirm_deleting: \"Acara akan dihapus\",\n\t\tsection_description: \"Keterangan\",\n\t\tsection_time: \"Periode\",\n\t\tfull_day: \"Hari penuh\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Apakah acara ini akan berulang?\",\n\t\tsection_recurring: \"Acara Rutin\",\n\t\tbutton_recurring: \"Tidak Difungsikan\",\n\t\tbutton_recurring_open: \"Difungsikan\",\n\t\tbutton_edit_series: \"Mengedit seri\",\n\t\tbutton_edit_occurrence: \"Mengedit salinan\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Tanggal\",\n\t\tdescription: \"Keterangan\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Tahun\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Tabel\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Harian\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Mingguan\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Bulanan\",\n\t\trepeat_radio_year: \"Tahunan\",\n\t\trepeat_radio_day_type: \"Setiap\",\n\t\trepeat_text_day_count: \"hari\",\n\t\trepeat_radio_day_type2: \"Setiap hari kerja\",\n\t\trepeat_week: \" Ulangi setiap\",\n\t\trepeat_text_week_count: \"minggu pada hari berikut:\",\n\t\trepeat_radio_month_type: \"Ulangi\",\n\t\trepeat_radio_month_start: \"Pada\",\n\t\trepeat_text_month_day: \"hari setiap\",\n\t\trepeat_text_month_count: \"bulan\",\n\t\trepeat_text_month_count2_before: \"setiap\",\n\t\trepeat_text_month_count2_after: \"bulan\",\n\t\trepeat_year_label: \"Pada\",\n\t\tselect_year_day2: \"dari\",\n\t\trepeat_text_year_day: \"hari\",\n\t\tselect_year_month: \"bulan\",\n\t\trepeat_radio_end: \"Tanpa tanggal akhir\",\n\t\trepeat_text_occurrences_count: \"kejadian\",\n\t\trepeat_radio_end2: \"Setelah\",\n\t\trepeat_radio_end3: \"Berakhir pada\",\n\n\t\trepeat_never: \"Tidak pernah\",\n\t\trepeat_daily: \"Setiap hari\",\n\t\trepeat_workdays: \"Setiap hari kerja\",\n\t\trepeat_weekly: \"Setiap minggu\",\n\t\trepeat_monthly: \"Setiap bulan\",\n\t\trepeat_yearly: \"Setiap tahun\",\n\t\trepeat_custom: \"Kustom\",\n\t\trepeat_freq_day: \"Hari\",\n\t\trepeat_freq_week: \"Minggu\",\n\t\trepeat_freq_month: \"Bulan\",\n\t\trepeat_freq_year: \"Tahun\",\n\t\trepeat_on_date: \"Pada tanggal\",\n\t\trepeat_ends: \"Berakhir\",\n\n\t\tmonth_for_recurring: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tday_for_recurring: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"]\n\t}\n};","export default {\n\tdate: {\n\t\tmonth_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domenica\", \"Luned\", \"Marted\", \"Mercoled\", \"Gioved\", \"Venerd\", \"Sabato\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Oggi\",\n\t\tday_tab: \"Giorno\",\n\t\tweek_tab: \"Settimana\",\n\t\tmonth_tab: \"Mese\",\n\t\tnew_event: \"Nuovo evento\",\n\t\ticon_save: \"Salva\",\n\t\ticon_cancel: \"Chiudi\",\n\t\ticon_details: \"Dettagli\",\n\t\ticon_edit: \"Modifica\",\n\t\ticon_delete: \"Elimina\",\n\t\tconfirm_closing: \"\", //Le modifiche apportate saranno perse, siete sicuri?\n\t\tconfirm_deleting: \"L'evento sar eliminato, siete sicuri?\",\n\t\tsection_description: \"Descrizione\",\n\t\tsection_time: \"Periodo di tempo\",\n\t\tfull_day: \"Intera giornata\",\n\n\t\tconfirm_recurring: \"Vuoi modificare l'intera serie di eventi?\",\n\t\tsection_recurring: \"Ripetere l'evento\",\n\t\tbutton_recurring: \"Disattivato\",\n\t\tbutton_recurring_open: \"Attivato\",\n\t\tbutton_edit_series: \"Modificare la serie\",\n\t\tbutton_edit_occurrence: \"Modificare una copia\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Data\",\n\t\tdescription: \"Descrizione\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Anno\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Griglia\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Quotidiano\",\n\t\trepeat_radio_week: \"Settimanale\",\n\t\trepeat_radio_month: \"Mensile\",\n\t\trepeat_radio_year: \"Annuale\",\n\t\trepeat_radio_day_type: \"Ogni\",\n\t\trepeat_text_day_count: \"giorno\",\n\t\trepeat_radio_day_type2: \"Ogni giornata lavorativa\",\n\t\trepeat_week: \" Ripetere ogni\",\n\t\trepeat_text_week_count: \"settimana:\",\n\t\trepeat_radio_month_type: \"Ripetere\",\n\t\trepeat_radio_month_start: \"Il\",\n\t\trepeat_text_month_day: \"giorno ogni\",\n\t\trepeat_text_month_count: \"mese\",\n\t\trepeat_text_month_count2_before: \"ogni\",\n\t\trepeat_text_month_count2_after: \"mese\",\n\t\trepeat_year_label: \"Il\",\n\t\tselect_year_day2: \"del\",\n\t\trepeat_text_year_day: \"giorno\",\n\t\tselect_year_month: \"mese\",\n\t\trepeat_radio_end: \"Senza data finale\",\n\t\trepeat_text_occurrences_count: \"occorenze\",\n\t\trepeat_radio_end3: \"Fine\",\n\t\trepeat_radio_end2: \"Dopo\",\n\n\t\trepeat_never: \"Mai\",\n\t\trepeat_daily: \"Ogni giorno\",\n\t\trepeat_workdays: \"Ogni giorno feriale\",\n\t\trepeat_weekly: \"Ogni settimana\",\n\t\trepeat_monthly: \"Ogni mese\",\n\t\trepeat_yearly: \"Ogni anno\",\n\t\trepeat_custom: \"Personalizzato\",\n\t\trepeat_freq_day: \"Giorno\",\n\t\trepeat_freq_week: \"Settimana\",\n\t\trepeat_freq_month: \"Mese\",\n\t\trepeat_freq_year: \"Anno\",\n\t\trepeat_on_date: \"Alla data\",\n\t\trepeat_ends: \"Finisce\",\n\n\t\tmonth_for_recurring: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Jiugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n\t\tday_for_recurring: [\"Domenica\", \"Luned\", \"Marted\", \"Mercoled\", \"Joved\", \"Venerd\", \"Sabato\"]\n\t}\n};\n","/*\n Translation by Genexus Japan Inc.\n */\nexport default {\n\tdate: {\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tmonth_short: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \"\",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //\n\t\tconfirm_deleting: \"\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tconfirm_recurring: \"\",\n\t\tsection_recurring: \"\",\n\t\tbutton_recurring: \"\",\n\t\tbutton_recurring_open: \"\",\n\t\tfull_day: \"\",\n\t\tbutton_edit_series: \"\",\n\t\tbutton_edit_occurrence: \"\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"\",\n\t\tdate: \"\",\n\t\tdescription: \"\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"\",\n\t\trepeat_week: \" \",\n\t\trepeat_text_week_count: \" :\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \"\",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \"\",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"\",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end2: \"\",\n\t\trepeat_radio_end3: \"\",\n\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \"\",\n\t\trepeat_workdays: \"\",\n\t\trepeat_weekly: \"\",\n\t\trepeat_monthly: \"\",\n\t\trepeat_yearly: \"\",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \"\",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n\n\n","export default class LocaleManager{\n\tconstructor(config){\n\t\tthis._locales = {};\n\t\tfor(const i in config){\n\t\t\tthis._locales[i] = config[i];\n\t\t}\n\t}\n\n\taddLocale(name, locale) {\n\t\tthis._locales[name] = locale;\n\t}\n\n\tgetLocale(name) {\n\t\treturn this._locales[name];\n\t}\n}","export default {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"I dag\",\n\t\tday_tab: \"Dag\",\n\t\tweek_tab: \"Uke\",\n\t\tmonth_tab: \"Mned\",\n\t\tnew_event: \"Ny hendelse\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Rediger\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Vil du forandre hele dette settet av repeterende hendelser?\",\n\t\tsection_recurring: \"Repeter hendelsen\",\n\t\tbutton_recurring: \"Av\",\n\t\tbutton_recurring_open: \"P\",\n\t\tbutton_edit_series: \"Rediger serien\",\n\t\tbutton_edit_occurrence: \"Redigere en kopi\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Dato\",\n\t\tdescription: \"Beskrivelse\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"r\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grid\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Daglig\",\n\t\trepeat_radio_week: \"Ukentlig\",\n\t\trepeat_radio_month: \"Mnedlig\",\n\t\trepeat_radio_year: \"rlig\",\n\t\trepeat_radio_day_type: \"Hver\",\n\t\trepeat_text_day_count: \"dag\",\n\t\trepeat_radio_day_type2: \"Alle hverdager\",\n\t\trepeat_week: \" Gjentas hver\",\n\t\trepeat_text_week_count: \"uke p:\",\n\t\trepeat_radio_month_type: \"P hver\",\n\t\trepeat_radio_month_start: \"P\",\n\t\trepeat_text_month_day: \"dag hver\",\n\t\trepeat_text_month_count: \"mned\",\n\t\trepeat_text_month_count2_before: \"hver\",\n\t\trepeat_text_month_count2_after: \"mned\",\n\t\trepeat_year_label: \"p\",\n\t\tselect_year_day2: \"i\",\n\t\trepeat_text_year_day: \"dag i\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"Ingen sluttdato\",\n\t\trepeat_text_occurrences_count: \"forekomst\",\n\t\trepeat_radio_end3: \"Stop den\",\n\t\trepeat_radio_end2: \"Etter\",\n\n\t\trepeat_never: \"Aldri\",\n\t\trepeat_daily: \"Hver dag\",\n\t\trepeat_workdays: \"Hver ukedag\",\n\t\trepeat_weekly: \"Hver uke\",\n\t\trepeat_monthly: \"Hver mned\",\n\t\trepeat_yearly: \"Hvert r\",\n\t\trepeat_custom: \"Tilpasset\",\n\t\trepeat_freq_day: \"Dag\",\n\t\trepeat_freq_week: \"Uke\",\n\t\trepeat_freq_month: \"Mned\",\n\t\trepeat_freq_year: \"r\",\n\t\trepeat_on_date: \"P dato\",\n\t\trepeat_ends: \"Slutter\",\n\n\t\tmonth_for_recurring: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tday_for_recurring: [\"Sondag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"]\n\t}\n};\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\n\t\tday_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Vandaag\",\n\t\tday_tab: \"Dag\",\n\t\tweek_tab: \"Week\",\n\t\tmonth_tab: \"Maand\",\n\t\tnew_event: \"Nieuw item\",\n\t\ticon_save: \"Opslaan\",\n\t\ticon_cancel: \"Annuleren\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Bewerken\",\n\t\ticon_delete: \"Verwijderen\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\n\t\tsection_description: \"Beschrijving\",\n\t\tsection_time: \"Tijd periode\",\n\t\tfull_day: \"Hele dag\",\n\n\t\tconfirm_recurring: \"Wilt u alle terugkerende items bijwerken?\",\n\t\tsection_recurring: \"Item herhalen\",\n\t\tbutton_recurring: \"Uit\",\n\t\tbutton_recurring_open: \"Aan\",\n\t\tbutton_edit_series: \"Bewerk de serie\",\n\t\tbutton_edit_occurrence: \"Bewerk een kopie\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Datum\",\n\t\tdescription: \"Omschrijving\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Jaar\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Tabel\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Dagelijks\",\n\t\trepeat_radio_week: \"Wekelijks\",\n\t\trepeat_radio_month: \"Maandelijks\",\n\t\trepeat_radio_year: \"Jaarlijks\",\n\t\trepeat_radio_day_type: \"Elke\",\n\t\trepeat_text_day_count: \"dag(en)\",\n\t\trepeat_radio_day_type2: \"Elke werkdag\",\n\t\trepeat_week: \" Herhaal elke\",\n\t\trepeat_text_week_count: \"week op de volgende dagen:\",\n\t\trepeat_radio_month_type: \"Herhaal\",\n\t\trepeat_radio_month_start: \"Op\",\n\t\trepeat_text_month_day: \"dag iedere\",\n\t\trepeat_text_month_count: \"maanden\",\n\t\trepeat_text_month_count2_before: \"iedere\",\n\t\trepeat_text_month_count2_after: \"maanden\",\n\t\trepeat_year_label: \"Op\",\n\t\tselect_year_day2: \"van\",\n\t\trepeat_text_year_day: \"dag\",\n\t\tselect_year_month: \"maand\",\n\t\trepeat_radio_end: \"Geen eind datum\",\n\t\trepeat_text_occurrences_count: \"keren\",\n\t\trepeat_radio_end3: \"Eindigd per\",\n\t\trepeat_radio_end2: \"Na\",\n\n\t\trepeat_never: \"Nooit\",\n\t\trepeat_daily: \"Elke dag\",\n\t\trepeat_workdays: \"Elke werkdag\",\n\t\trepeat_weekly: \"Elke week\",\n\t\trepeat_monthly: \"Elke maand\",\n\t\trepeat_yearly: \"Elk jaar\",\n\t\trepeat_custom: \"Aangepast\",\n\t\trepeat_freq_day: \"Dag\",\n\t\trepeat_freq_week: \"Week\",\n\t\trepeat_freq_month: \"Maand\",\n\t\trepeat_freq_year: \"Jaar\",\n\t\trepeat_on_date: \"Op datum\",\n\t\trepeat_ends: \"Eindigt\",\n\n\t\tmonth_for_recurring: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tday_for_recurring: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"]\n\t}\n};\n\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Idag\",\n\t\tday_tab: \"Dag\",\n\t\tweek_tab: \"Uke\",\n\t\tmonth_tab: \"Mned\",\n\t\tnew_event: \"Ny\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Endre\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"Endringer blir ikke lagret, er du sikker?\", //Endringer blir ikke lagret, er du sikker?\n\t\tconfirm_deleting: \"Oppfringen vil bli slettet, er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tfull_day: \"Full dag\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Vil du endre hele settet med repeterende oppfringer?\",\n\t\tsection_recurring: \"Repeterende oppfring\",\n\t\tbutton_recurring: \"Ikke aktiv\",\n\t\tbutton_recurring_open: \"Aktiv\",\n\t\tbutton_edit_series: \"Rediger serien\",\n\t\tbutton_edit_occurrence: \"Redigere en kopi\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Dato\",\n\t\tdescription: \"Beskrivelse\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"r\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grid\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Daglig\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Ukentlig\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Mnedlig\",\n\t\trepeat_radio_year: \"rlig\",\n\t\trepeat_radio_day_type: \"Hver\",\n\t\trepeat_text_day_count: \"dag\",\n\t\trepeat_radio_day_type2: \"Hver arbeidsdag\",\n\t\trepeat_week: \" Gjenta hver\",\n\t\trepeat_text_week_count: \"uke neste dager:\",\n\t\trepeat_radio_month_type: \"Gjenta\",\n\t\trepeat_radio_month_start: \"P\",\n\t\trepeat_text_month_day: \"dag hver\",\n\t\trepeat_text_month_count: \"mned\",\n\t\trepeat_text_month_count2_before: \"hver\",\n\t\trepeat_text_month_count2_after: \"mned\",\n\t\trepeat_year_label: \"P\",\n\t\tselect_year_day2: \"av\",\n\t\trepeat_text_year_day: \"dag\",\n\t\tselect_year_month: \"mned\",\n\t\trepeat_radio_end: \"Ingen sluttdato\",\n\t\trepeat_text_occurrences_count: \"forekomster\",\n\t\trepeat_radio_end2: \"Etter\",\n\t\trepeat_radio_end3: \"Slutt innen\",\n\n\t\trepeat_never: \"Aldri\",\n\t\trepeat_daily: \"Hver dag\",\n\t\trepeat_workdays: \"Hver ukedag\",\n\t\trepeat_weekly: \"Hver uke\",\n\t\trepeat_monthly: \"Hver mned\",\n\t\trepeat_yearly: \"Hvert r\",\n\t\trepeat_custom: \"Tilpasset\",\n\t\trepeat_freq_day: \"Dag\",\n\t\trepeat_freq_week: \"Uke\",\n\t\trepeat_freq_month: \"Mned\",\n\t\trepeat_freq_year: \"r\",\n\t\trepeat_on_date: \"P dato\",\n\t\trepeat_ends: \"Slutter\",\n\n\t\tmonth_for_recurring: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tday_for_recurring: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Stycze\", \"Luty\", \"Marzec\", \"Kwiecie\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpie\", \"Wrzesie\", \"Padziernik\", \"Listopad\", \"Grudzie\"],\n\t\tmonth_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Pa\", \"Lis\", \"Gru\"],\n\t\tday_full: [\"Niedziela\", \"Poniedziaek\", \"Wtorek\", \"roda\", \"Czwartek\", \"Pitek\", \"Sobota\"],\n\t\tday_short: [\"Nie\", \"Pon\", \"Wto\", \"ro\", \"Czw\", \"Pi\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Dzi\",\n\t\tday_tab: \"Dzie\",\n\t\tweek_tab: \"Tydzie\",\n\t\tmonth_tab: \"Miesic\",\n\t\tnew_event: \"Nowe zdarzenie\",\n\t\ticon_save: \"Zapisz\",\n\t\ticon_cancel: \"Anuluj\",\n\t\ticon_details: \"Szczegy\",\n\t\ticon_edit: \"Edytuj\",\n\t\ticon_delete: \"Usu\",\n\t\tconfirm_closing: \"\", //Zmiany zostan usunite, jeste pewien?\n\t\tconfirm_deleting: \"Zdarzenie zostanie usunite na zawsze, kontynuowa?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Okres czasu\",\n\t\tfull_day: \"Cay dzie\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Czy chcesz edytowa cay zbir powtarzajcych si zdarze?\",\n\t\tsection_recurring: \"Powtrz zdarzenie\",\n\t\tbutton_recurring: \"Nieaktywne\",\n\t\tbutton_recurring_open: \"Aktywne\",\n\t\tbutton_edit_series: \"Edytuj seri\",\n\t\tbutton_edit_occurrence: \"Edytuj kopi\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Agenda\",\n\t\tdate: \"Data\",\n\t\tdescription: \"Opis\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Rok\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Tabela\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Codziennie\",\n\t\trepeat_radio_week: \"Co tydzie\",\n\t\trepeat_radio_month: \"Co miesic\",\n\t\trepeat_radio_year: \"Co rok\",\n\t\trepeat_radio_day_type: \"Kadego\",\n\t\trepeat_text_day_count: \"dnia\",\n\t\trepeat_radio_day_type2: \"Kadego dnia roboczego\",\n\t\trepeat_week: \" Powtarzaj kadego\",\n\t\trepeat_text_week_count: \"tygodnia w dni:\",\n\t\trepeat_radio_month_type: \"Powtrz\",\n\t\trepeat_radio_month_start: \"W\",\n\t\trepeat_text_month_day: \"dnia kadego\",\n\t\trepeat_text_month_count: \"miesica\",\n\t\trepeat_text_month_count2_before: \"kadego\",\n\t\trepeat_text_month_count2_after: \"miesica\",\n\t\trepeat_year_label: \"W\",\n\t\tselect_year_day2: \"miesica\",\n\t\trepeat_text_year_day: \"dnia miesica\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"Bez daty kocowej\",\n\t\trepeat_text_occurrences_count: \"wystpieniu/ach\",\n\t\trepeat_radio_end3: \"Zakocz w\",\n\t\trepeat_radio_end2: \"Po\",\n\n\t\trepeat_never: \"Nigdy\",\n\t\trepeat_daily: \"Codziennie\",\n\t\trepeat_workdays: \"Kady dzie roboczy\",\n\t\trepeat_weekly: \"Co tydzie\",\n\t\trepeat_monthly: \"Co miesic\",\n\t\trepeat_yearly: \"Co rok\",\n\t\trepeat_custom: \"Niestandardowy\",\n\t\trepeat_freq_day: \"Dzie\",\n\t\trepeat_freq_week: \"Tydzie\",\n\t\trepeat_freq_month: \"Miesic\",\n\t\trepeat_freq_year: \"Rok\",\n\t\trepeat_on_date: \"W dniu\",\n\t\trepeat_ends: \"Koczy si\",\n\n\t\tmonth_for_recurring: [\"Stycznia\", \"Lutego\", \"Marca\", \"Kwietnia\", \"Maja\", \"Czerwca\", \"Lipca\", \"Sierpnia\", \"Wrzenia\", \"Padziernka\", \"Listopada\", \"Grudnia\"],\n\t\tday_for_recurring: [\"Niedziela\", \"Poniedziaek\", \"Wtorek\", \"roda\", \"Czwartek\", \"Pitek\", \"Sobota\"]\n\t}\n};\n\n","/*\n\n TRANSLATION BY MATTHEUS PIROVANI RORIZ GONALVES\n\n mattheusroriz@hotmail.com / mattheus.pirovani@gmail.com /\n\n www.atrixian.com.br\n\n */\n\nexport default {\n\tdate: {\n\t\tmonth_full: [\"Janeiro\", \"Fevereiro\", \"Maro\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n\t\tmonth_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Domingo\", \"Segunda\", \"Tera\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sbado\"],\n\t\tday_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Hoje\",\n\t\tday_tab: \"Dia\",\n\t\tweek_tab: \"Semana\",\n\t\tmonth_tab: \"Ms\",\n\t\tnew_event: \"Novo evento\",\n\t\ticon_save: \"Salvar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalhes\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Deletar\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Tem certeza que deseja excluir?\",\n\t\tsection_description: \"Descrio\",\n\t\tsection_time: \"Perodo de tempo\",\n\t\tfull_day: \"Dia inteiro\",\n\n\t\tconfirm_recurring: \"Deseja editar todos esses eventos repetidos?\",\n\t\tsection_recurring: \"Repetir evento\",\n\t\tbutton_recurring: \"Desabilitar\",\n\t\tbutton_recurring_open: \"Habilitar\",\n\t\tbutton_edit_series: \"Editar a srie\",\n\t\tbutton_edit_occurrence: \"Editar uma cpia\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Dia\",\n\t\tdate: \"Data\",\n\t\tdescription: \"Descrio\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Ano\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Dia\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Grade\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Dirio\",\n\t\trepeat_radio_week: \"Semanal\",\n\t\trepeat_radio_month: \"Mensal\",\n\t\trepeat_radio_year: \"Anual\",\n\t\trepeat_radio_day_type: \"Cada\",\n\t\trepeat_text_day_count: \"dia(s)\",\n\t\trepeat_radio_day_type2: \"Cada trabalho dirio\",\n\t\trepeat_week: \" Repita cada\",\n\t\trepeat_text_week_count: \"semana:\",\n\t\trepeat_radio_month_type: \"Repetir\",\n\t\trepeat_radio_month_start: \"Em\",\n\t\trepeat_text_month_day: \"todo dia\",\n\t\trepeat_text_month_count: \"ms\",\n\t\trepeat_text_month_count2_before: \"todo\",\n\t\trepeat_text_month_count2_after: \"ms\",\n\t\trepeat_year_label: \"Em\",\n\t\tselect_year_day2: \"of\",\n\t\trepeat_text_year_day: \"dia\",\n\t\tselect_year_month: \"ms\",\n\t\trepeat_radio_end: \"Sem data final\",\n\t\trepeat_text_occurrences_count: \"ocorrncias\",\n\t\trepeat_radio_end3: \"Fim\",\n\t\trepeat_radio_end2: \"Depois\",\n\n\t\trepeat_never: \"Nunca\",\n\t\trepeat_daily: \"Todos os dias\",\n\t\trepeat_workdays: \"Todos os dias teis\",\n\t\trepeat_weekly: \"Toda semana\",\n\t\trepeat_monthly: \"Todo ms\",\n\t\trepeat_yearly: \"Todo ano\",\n\t\trepeat_custom: \"Personalizado\",\n\t\trepeat_freq_day: \"Dia\",\n\t\trepeat_freq_week: \"Semana\",\n\t\trepeat_freq_month: \"Ms\",\n\t\trepeat_freq_year: \"Ano\",\n\t\trepeat_on_date: \"Na data\",\n\t\trepeat_ends: \"Termina\",\n\n\t\tmonth_for_recurring: [\"Janeiro\", \"Fevereiro\", \"Maro\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n\t\tday_for_recurring: [\"Domingo\", \"Segunda\", \"Tera\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sbado\"]\n\t}\n};\n\n\n","/*\n\tTraducere de Ovidiu Lixandru: http://www.madball.ro\n */\n\nexport default {\n\tdate:{\n\t\tmonth_full:[\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\n\t\tmonth_short:[\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full:[\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\n\t\tday_short:[\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\n\t},\n\tlabels:{\n\t\tdhx_cal_today_button:\"Astazi\",\n\t\tday_tab:\"Zi\",\n\t\tweek_tab:\"Saptamana\",\n\t\tmonth_tab:\"Luna\",\n\t\tnew_event:\"Eveniment nou\",\n\t\ticon_save:\"Salveaza\",\n\t\ticon_cancel:\"Anuleaza\",\n\t\ticon_details:\"Detalii\",\n\t\ticon_edit:\"Editeaza\",\n\t\ticon_delete:\"Sterge\",\n\t\tconfirm_closing:\"Schimbarile nu vor fi salvate, esti sigur?\",//Your changes will be lost, are your sure ?\n\t\tconfirm_deleting:\"Evenimentul va fi sters permanent, esti sigur?\",\n\t\tsection_description:\"Descriere\",\n\t\tsection_time:\"Interval\",\n\t\tfull_day:\"Toata ziua\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring:\"Vrei sa editezi toata seria de evenimente repetate?\",\n\t\tsection_recurring:\"Repetare\",\n\t\tbutton_recurring:\"Dezactivata\",\n\t\tbutton_recurring_open:\"Activata\",\n\t\tbutton_edit_series: \"Editeaza serie\",\n\t\tbutton_edit_occurrence: \"Editeaza doar intrare\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab:\"Agenda\",\n\t\tdate:\"Data\",\n\t\tdescription:\"Descriere\",\n\n\t\t/*year view extension*/\n\t\tyear_tab:\"An\",\n\n\t\t/* week agenda extension */\n\t\tweek_agenda_tab: \"Agenda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Lista\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Zilnic\",\n\t\trepeat_radio_week: \"Saptamanal\",\n\t\trepeat_radio_month: \"Lunar\",\n\t\trepeat_radio_year: \"Anual\",\n\t\trepeat_radio_day_type: \"La fiecare\",\n\t\trepeat_text_day_count: \"zi(le)\",\n\t\trepeat_radio_day_type2: \"Fiecare zi lucratoare\",\n\t\trepeat_week: \" Repeta la fiecare\",\n\t\trepeat_text_week_count: \"saptamana in urmatoarele zile:\",\n\t\trepeat_radio_month_type: \"Repeta in\",\n\t\trepeat_radio_month_start: \"In a\",\n\t\trepeat_text_month_day: \"zi la fiecare\",\n\t\trepeat_text_month_count: \"luni\",\n\t\trepeat_text_month_count2_before: \"la fiecare\",\n\t\trepeat_text_month_count2_after: \"luni\",\n\t\trepeat_year_label: \"In\",\n\t\tselect_year_day2: \"a lunii\",\n\t\trepeat_text_year_day: \"zi a lunii\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"Fara data de sfarsit\",\n\t\trepeat_text_occurrences_count: \"evenimente\",\n\t\trepeat_radio_end3: \"La data\",\n\t\trepeat_radio_end2: \"Dupa\",\n\n\t\trepeat_never: \"Niciodat\",\n\t\trepeat_daily: \"n fiecare zi\",\n\t\trepeat_workdays: \"n fiecare zi lucrtoare\",\n\t\trepeat_weekly: \"n fiecare sptmn\",\n\t\trepeat_monthly: \"n fiecare lun\",\n\t\trepeat_yearly: \"n fiecare an\",\n\t\trepeat_custom: \"Personalizat\",\n\t\trepeat_freq_day: \"Zi\",\n\t\trepeat_freq_week: \"Sptmn\",\n\t\trepeat_freq_month: \"Lun\",\n\t\trepeat_freq_year: \"An\",\n\t\trepeat_on_date: \"La data\",\n\t\trepeat_ends: \"Se termin\",\n\n\t\tmonth_for_recurring: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"Noiembrie\", \"Decembrie\"],\n\t\tday_for_recurring: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"O\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"Ma\", \"A\", \"Ma\", \"\", \"\", \"A\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [ \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //   , ?\n\t\tconfirm_deleting: \"   , ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tfull_day: \" \",\n\n\t\tconfirm_recurring: \"      ?\",\n\t\tsection_recurring: \"\",\n\t\tbutton_recurring: \"\",\n\t\tbutton_recurring_open: \"\",\n\t\tbutton_edit_series: \" \",\n\t\tbutton_edit_occurrence: \" \",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"\",\n\t\tdate: \"\",\n\t\tdescription: \"\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\",\n\t\trepeat_radio_week: \"\",\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"  \",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \" , :\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \"   \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \" \",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"  \",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end3: \" \",\n\t\trepeat_radio_end2: \"\",\n\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \" \",\n\t\trepeat_workdays: \"  \",\n\t\trepeat_weekly: \" \",\n\t\trepeat_monthly: \" \",\n\t\trepeat_yearly: \" \",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \" \",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t}\n};\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"etrtek\", \"Petek\", \"Sobota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"et\", \"Pet\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Danes\",\n\t\tday_tab: \"Dan\",\n\t\tweek_tab: \"Teden\",\n\t\tmonth_tab: \"Mesec\",\n\t\tnew_event: \"Nov dogodek\",\n\t\ticon_save: \"Shrani\",\n\t\ticon_cancel: \"Preklii\",\n\t\ticon_details: \"Podrobnosti\",\n\t\ticon_edit: \"Uredi\",\n\t\ticon_delete: \"Izbrii\",\n\t\tconfirm_closing: \"\", //Spremembe ne bodo shranjene. elite nadaljevati ?\n\t\tconfirm_deleting: \"Dogodek bo izbrisan. elite nadaljevati?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"asovni okvir\",\n\t\tfull_day: \"Ves dan\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"elite urediti celoten set ponavljajoih dogodkov?\",\n\t\tsection_recurring: \"Ponovi dogodek\",\n\t\tbutton_recurring: \"Onemogoeno\",\n\t\tbutton_recurring_open: \"Omogoeno\",\n\t\tbutton_edit_series: \"Edit series\",\n\t\tbutton_edit_occurrence: \"Edit occurrence\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Zadeva\",\n\t\tdate: \"Datum\",\n\t\tdescription: \"Opis\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Leto\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Zadeva\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Miza\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Dnevno\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Tedensko\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Meseno\",\n\t\trepeat_radio_year: \"Letno\",\n\t\trepeat_radio_day_type: \"Vsak\",\n\t\trepeat_text_day_count: \"dan\",\n\t\trepeat_radio_day_type2: \"Vsak delovni dan\",\n\t\trepeat_week: \" Ponavljaj vsak\",\n\t\trepeat_text_week_count: \"teden na naslednje dni:\",\n\t\trepeat_radio_month_type: \"Ponavljaj\",\n\t\trepeat_radio_month_start: \"Na\",\n\t\trepeat_text_month_day: \"dan vsak\",\n\t\trepeat_text_month_count: \"mesec\",\n\t\trepeat_text_month_count2_before: \"vsak\",\n\t\trepeat_text_month_count2_after: \"mesec\",\n\t\trepeat_year_label: \"Na\",\n\t\tselect_year_day2: \"od\",\n\t\trepeat_text_year_day: \"dan\",\n\t\tselect_year_month: \"mesec\",\n\t\trepeat_radio_end: \"Brez konnega datuma\",\n\t\trepeat_text_occurrences_count: \"pojavitve\",\n\t\trepeat_radio_end2: \"Po\",\n\t\trepeat_radio_end3: \"Konaj do\",\n\n\t\trepeat_never: \"Nikoli\",\n\t\trepeat_daily: \"Vsak dan\",\n\t\trepeat_workdays: \"Vsak delovni dan\",\n\t\trepeat_weekly: \"Vsak teden\",\n\t\trepeat_monthly: \"Vsak mesec\",\n\t\trepeat_yearly: \"Vsako leto\",\n\t\trepeat_custom: \"Po meri\",\n\t\trepeat_freq_day: \"Dan\",\n\t\trepeat_freq_week: \"Teden\",\n\t\trepeat_freq_month: \"Mesec\",\n\t\trepeat_freq_year: \"Leto\",\n\t\trepeat_on_date: \"Na datum\",\n\t\trepeat_ends: \"Kona se\",\n\n\t\tmonth_for_recurring: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tday_for_recurring: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"etrtek\", \"Petek\", \"Sobota\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Marec\", \"Aprl\", \"Mj\", \"Jn\", \"Jl\", \"August\", \"September\", \"Oktber\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedea\", \"Pondelok\", \"Utorok\", \"Streda\", \"tvrtok\", \"Piatok\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"t\", \"Pi\", \"So\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Dnes\",\n\t\tday_tab: \"De\",\n\t\tweek_tab: \"Tde\",\n\t\tmonth_tab: \"Mesiac\",\n\t\tnew_event: \"Nov udalos\",\n\t\ticon_save: \"Uloi\",\n\t\ticon_cancel: \"Sp\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Zmaza\",\n\t\tconfirm_closing: \"Vae zmeny nebud uloen. Skutone?\", //Vae zmny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udalos bude natrvalo vymazan. Skutone?\",\n\t\tsection_description: \"Poznmky\",\n\t\tsection_time: \"Doba platnosti\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Prajete si upravi cel radu opakovanch udalost?\",\n\t\tsection_recurring: \"Opakovanie udalosti\",\n\t\tbutton_recurring: \"Vypnut\",\n\t\tbutton_recurring_open: \"Zapnut\",\n\t\tbutton_edit_series: \"Upravi opakovania\",\n\t\tbutton_edit_occurrence: \"Upravi intancie\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Program\",\n\t\tdate: \"Dtum\",\n\t\tdescription: \"Poznmka\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Rok\",\n\t\tfull_day: \"Cel de\", // Full day\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Program\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Mrieka\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Denne\",\n\t\trepeat_radio_week: \"Tdenne\",\n\t\trepeat_radio_month: \"Mesane\",\n\t\trepeat_radio_year: \"Rone\",\n\t\trepeat_radio_day_type: \"Kad\",\n\t\trepeat_text_day_count: \"de\",\n\t\trepeat_radio_day_type2: \"Kad prac. de\",\n\t\trepeat_week: \"Opakova kad\",\n\t\trepeat_text_week_count: \"tde v doch:\",\n\t\trepeat_radio_month_type: \"Opakova\",\n\t\trepeat_radio_month_start: \"On\",\n\t\trepeat_text_month_day: \"de kad\",\n\t\trepeat_text_month_count: \"mesiac\",\n\t\trepeat_text_month_count2_before: \"kad\",\n\t\trepeat_text_month_count2_after: \"mesiac\",\n\t\trepeat_year_label: \"On\",\n\t\tselect_year_day2: \"poas\",\n\t\trepeat_text_year_day: \"de\",\n\t\tselect_year_month: \"mesiac\",\n\t\trepeat_radio_end: \"Bez dtumu ukonenia\",\n\t\trepeat_text_occurrences_count: \"udalostiach\",\n\t\trepeat_radio_end3: \"Ukoni\",\n\t\trepeat_radio_end2: \"Po\",\n\n\t\trepeat_never: \"Nikdy\",\n\t\trepeat_daily: \"Kad de\",\n\t\trepeat_workdays: \"Kad pracovn de\",\n\t\trepeat_weekly: \"Kad tde\",\n\t\trepeat_monthly: \"Kad mesiac\",\n\t\trepeat_yearly: \"Kad rok\",\n\t\trepeat_custom: \"Vlastn\",\n\t\trepeat_freq_day: \"De\",\n\t\trepeat_freq_week: \"Tde\",\n\t\trepeat_freq_month: \"Mesiac\",\n\t\trepeat_freq_year: \"Rok\",\n\t\trepeat_on_date: \"Na dtum\",\n\t\trepeat_ends: \"Koniec\",\n\n\t\tmonth_for_recurring: [\"Janur\", \"Februr\", \"Marec\", \"Aprl\", \"Mj\", \"Jn\", \"Jl\", \"August\", \"September\", \"Oktber\", \"November\", \"December\"],\n\t\tday_for_recurring: [\"Nedea\", \"Pondelok\", \"Utorok\", \"Streda\", \"tvrtok\", \"Piatok\", \"Sobota\"]\n\t}\n};\n\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sndag\", \"Mndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Mn\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Idag\",\n\t\tday_tab: \"Dag\",\n\t\tweek_tab: \"Vecka\",\n\t\tmonth_tab: \"Mnad\",\n\t\tnew_event: \"Ny hndelse\",\n\t\ticon_save: \"Spara\",\n\t\ticon_cancel: \"ngra\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"ndra\",\n\t\ticon_delete: \"Ta bort\",\n\t\tconfirm_closing: \"\", //Dina frndingar kommer g frlorade, r du sker?\n\t\tconfirm_deleting: \"r du sker p att du vill ta bort hndelsen permanent?\",\n\t\tsection_description: \"Beskrivning\",\n\t\tsection_time: \"Tid\",\n\t\tfull_day: \"Hela dagen\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Vill du redigera hela serien med repeterande hndelser?\",\n\t\tsection_recurring: \"Upprepa hndelse\",\n\t\tbutton_recurring: \"Inaktiverat\",\n\t\tbutton_recurring_open: \"Aktiverat\",\n\t\tbutton_edit_series: \"Redigera serien\",\n\t\tbutton_edit_occurrence: \"Redigera en kopia\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Dagordning\",\n\t\tdate: \"Datum\",\n\t\tdescription: \"Beskrivning\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"r\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Dagordning\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Galler\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Dra fr att skapa ny\",\n\t\tdrag_to_move:\"Dra fr att flytta\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Dagligen\",\n\t\trepeat_radio_week: \"Veckovis\",\n\t\trepeat_radio_month: \"Mnadsvis\",\n\t\trepeat_radio_year: \"rligen\",\n\t\trepeat_radio_day_type: \"Var\",\n\t\trepeat_text_day_count: \"dag\",\n\t\trepeat_radio_day_type2: \"Varje arbetsdag\",\n\t\trepeat_week: \" Upprepa var\",\n\t\trepeat_text_week_count: \"vecka dessa dagar:\",\n\t\trepeat_radio_month_type: \"Upprepa\",\n\t\trepeat_radio_month_start: \"Den\",\n\t\trepeat_text_month_day: \"dagen var\",\n\t\trepeat_text_month_count: \"mnad\",\n\t\trepeat_text_month_count2_before: \"var\",\n\t\trepeat_text_month_count2_after: \"mnad\",\n\t\trepeat_year_label: \"Den\",\n\t\tselect_year_day2: \"i\",\n\t\trepeat_text_year_day: \"dag i\",\n\t\tselect_year_month: \"mnad\",\n\t\trepeat_radio_end: \"Inget slutdatum\",\n\t\trepeat_text_occurrences_count: \"upprepningar\",\n\t\trepeat_radio_end3: \"Sluta efter\",\n\t\trepeat_radio_end2: \"Efter\",\n\n\t\trepeat_never: \"Aldrig\",\n\t\trepeat_daily: \"Varje dag\",\n\t\trepeat_workdays: \"Varje vardag\",\n\t\trepeat_weekly: \"Varje vecka\",\n\t\trepeat_monthly: \"Varje mnad\",\n\t\trepeat_yearly: \"Varje r\",\n\t\trepeat_custom: \"Anpassad\",\n\t\trepeat_freq_day: \"Dag\",\n\t\trepeat_freq_week: \"Vecka\",\n\t\trepeat_freq_month: \"Mnad\",\n\t\trepeat_freq_year: \"r\",\n\t\trepeat_on_date: \"P datum\",\n\t\trepeat_ends: \"Slutar\",\n\n\t\tmonth_for_recurring: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tday_for_recurring: [\"Sndag\", \"Mndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"]\n\t}\n};\n","export default {\n\tdate: {\n\t\tmonth_full: [\"Ocak\", \"ubat\", \"Mart\", \"Nisan\", \"Mays\", \"Haziran\", \"Temmuz\", \"Austos\", \"Eyll\", \"Ekim\", \"Kasm\", \"Aralk\"],\n\t\tmonth_short: [\"Oca\", \"ub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Au\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\n\t\tday_full: [\"Pazar\", \"Pazartes,\", \"Sal\", \"aramba\", \"Perembe\", \"Cuma\", \"Cumartesi\"],\n\t\tday_short: [\"Paz\", \"Pts\", \"Sal\", \"ar\", \"Per\", \"Cum\", \"Cts\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"Bugn\",\n\t\tday_tab: \"Gn\",\n\t\tweek_tab: \"Hafta\",\n\t\tmonth_tab: \"Ay\",\n\t\tnew_event: \"Uygun\",\n\t\ticon_save: \"Kaydet\",\n\t\ticon_cancel: \"ptal\",\n\t\ticon_details: \"Detaylar\",\n\t\ticon_edit: \"Dzenle\",\n\t\ticon_delete: \"Sil\",\n\t\tconfirm_closing: \"\", //Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Etkinlik silinecek, devam?\",\n\t\tsection_description: \"Aklama\",\n\t\tsection_time: \"Zaman aral\",\n\t\tfull_day: \"Tam gn\",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"Tm tekrar eden etkinlikler silinecek, devam?\",\n\t\tsection_recurring: \"Etkinlii tekrarla\",\n\t\tbutton_recurring: \"Pasif\",\n\t\tbutton_recurring_open: \"Aktif\",\n\t\tbutton_edit_series: \"Dizi dzenleme\",\n\t\tbutton_edit_occurrence: \"Bir kopyasn dzenleyin\",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"Ajanda\",\n\t\tdate: \"Tarih\",\n\t\tdescription: \"Aklama\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"Yl\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"Ajanda\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"Izgara\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"Gnlk\", //name=\"repeat\" value=\"day\"\n\t\trepeat_radio_week: \"Haftalk\", //name=\"repeat\" value=\"week\n\t\trepeat_radio_month: \"Aylk\",\n\t\trepeat_radio_year: \"Yllk\",\n\t\trepeat_radio_day_type: \"Her\",\n\t\trepeat_text_day_count: \"gn\",\n\t\trepeat_radio_day_type2: \"Her i gn\",\n\t\trepeat_week: \" Tekrar her\",\n\t\trepeat_text_week_count: \"hafta u gnlerde:\",\n\t\trepeat_radio_month_type: \"Tekrar et\",\n\t\trepeat_radio_month_start: \"Tarihinde\",\n\t\trepeat_text_month_day: \"gn her\",\n\t\trepeat_text_month_count: \"ay\",\n\t\trepeat_text_month_count2_before: \"her\",\n\t\trepeat_text_month_count2_after: \"ay\",\n\t\trepeat_year_label: \"Tarihinde\",\n\t\tselect_year_day2: \"ayn\",\n\t\trepeat_text_year_day: \"gn\",\n\t\tselect_year_month: \"ay\",\n\t\trepeat_radio_end: \"Biti tarihi yok\",\n\t\trepeat_text_occurrences_count: \"olay\",\n\t\trepeat_radio_end2: \"Sonra\",\n\t\trepeat_radio_end3: \"Tarihinde bitir\",\n\n\t\trepeat_never: \"Asla\",\n\t\trepeat_daily: \"Her gn\",\n\t\trepeat_workdays: \"Her i gn\",\n\t\trepeat_weekly: \"Her hafta\",\n\t\trepeat_monthly: \"Her ay\",\n\t\trepeat_yearly: \"Her yl\",\n\t\trepeat_custom: \"zel\",\n\t\trepeat_freq_day: \"Gn\",\n\t\trepeat_freq_week: \"Hafta\",\n\t\trepeat_freq_month: \"Ay\",\n\t\trepeat_freq_year: \"Yl\",\n\t\trepeat_on_date: \"Tarihinde\",\n\t\trepeat_ends: \"Biter\",\n\n\t\tmonth_for_recurring: [\"Ocak\", \"ubat\", \"Mart\", \"Nisan\", \"Mays\", \"Haziran\", \"Temmuz\", \"Austos\", \"Eyll\", \"Ekim\", \"Kasm\", \"Aralk\"],\n\t\tday_for_recurring: [\"Pazar\", \"Pazartesi\", \"Sal\", \"aramba\", \"Perembe\", \"Cuma\", \"Cumartesi\"]\n\t}\n};","export default {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"'\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tdhx_cal_today_button: \"\",\n\t\tday_tab: \"\",\n\t\tweek_tab: \"\",\n\t\tmonth_tab: \"\",\n\t\tnew_event: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //  .   ?\n\t\tconfirm_deleting: \"  .  ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tfull_day: \" \",\n\n\t\t/*recurring events*/\n\t\tconfirm_recurring: \"     ?\",\n\t\tsection_recurring: \" \",\n\t\tbutton_recurring: \"\",\n\t\tbutton_recurring_open: \"\",\n\t\tbutton_edit_series: \" \",\n\t\tbutton_edit_occurrence: \" \",\n\t\tbutton_edit_occurrence_and_following: \"This and following events\",\n\t\t\n\t\t/*agenda view extension*/\n\t\tagenda_tab: \"\",\n\t\tdate: \"\",\n\t\tdescription: \"\",\n\n\t\t/*year view extension*/\n\t\tyear_tab: \"\",\n\n\t\t/*week agenda view extension*/\n\t\tweek_agenda_tab: \"\",\n\n\t\t/*grid view extension*/\n\t\tgrid_tab: \"\",\n\n\t\t/* touch tooltip*/\n\t\tdrag_to_create:\"Drag to create\",\n\t\tdrag_to_move:\"Drag to move\",\n\n\t\t/* dhtmlx message default buttons */\n\t\tmessage_ok:\"OK\",\n\t\tmessage_cancel:\"Cancel\",\n\n\t\t/* wai aria labels for non-text controls */\n\t\tnext: \"Next\",\n\t\tprev: \"Previous\",\n\t\tyear: \"Year\",\n\t\tmonth: \"Month\",\n\t\tday: \"Day\",\n\t\thour:\"Hour\",\n\t\tminute: \"Minute\",\n\n\t\t/* recurring event components */\n\t\trepeat_radio_day: \"\",\n\t\trepeat_radio_week: \"\",\n\t\trepeat_radio_month: \"\",\n\t\trepeat_radio_year: \"\",\n\t\trepeat_radio_day_type: \"\",\n\t\trepeat_text_day_count: \"\",\n\t\trepeat_radio_day_type2: \"  \",\n\t\trepeat_week: \"  \",\n\t\trepeat_text_week_count: \" , :\",\n\t\trepeat_radio_month_type: \"\",\n\t\trepeat_radio_month_start: \"\",\n\t\trepeat_text_month_day: \"   \",\n\t\trepeat_text_month_count: \"\",\n\t\trepeat_text_month_count2_before: \" \",\n\t\trepeat_text_month_count2_after: \"\",\n\t\trepeat_year_label: \"\",\n\t\tselect_year_day2: \"\",\n\t\trepeat_text_year_day: \"\",\n\t\tselect_year_month: \"\",\n\t\trepeat_radio_end: \"  \",\n\t\trepeat_text_occurrences_count: \"\",\n\t\trepeat_radio_end3: \" \",\n\t\trepeat_radio_end2: \"\",\n\n\t\trepeat_never: \"\",\n\t\trepeat_daily: \"\",\n\t\trepeat_workdays: \"   \",\n\t\trepeat_weekly: \"\",\n\t\trepeat_monthly: \"\",\n\t\trepeat_yearly: \"\",\n\t\trepeat_custom: \"\",\n\t\trepeat_freq_day: \"\",\n\t\trepeat_freq_week: \"\",\n\t\trepeat_freq_month: \"\",\n\t\trepeat_freq_year: \"\",\n\t\trepeat_on_date: \" \",\n\t\trepeat_ends: \"\",\n\n\t\tmonth_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_for_recurring: [\"\", \"\", \"\", \"\", \"\", \"'\", \"\"]\n\t}\n};\n","import eventable from \"../utils/eventable\";\n\nexport class DatePicker {\n\tconstructor(scheduler, container, state = {}) {\n\t\tthis.state = {\n\t\t\tdate: new Date(),\n\t\t\tmodes: ['days', 'months', 'years'],\n\t\t\tcurrentRange: [],\n\t\t\teventDates: [],\n\t\t\tfilterDays: null,\n\t\t\tcurrentModeIndex: 0,\n\t\t\t...state\n\t\t};\n\t\tthis.container = null;\n\t\tthis.element = null;\n\t\tthis.onStateChangeHandlers = [];\n\t\tthis.scheduler = scheduler;\n\t\tthis._domEvents = scheduler._createDomEventScope();\n\t\tthis.state = this.getState();\n\t\teventable(this);\n\t\tif(container){\n\n\t\t\tthis.container = container;\n\t\t\tthis.render(this.container);\n\t\t}\n\n\t\tthis.onStateChange((oldState, newState) => {\n\t\t\tthis.callEvent(\"onStateChange\", [newState, oldState]);\n\t\t});\n\t}\n\n\tgetState() {\n\t\treturn { \n\t\t\t...this.state,\n\t\t\tmode: this.state.modes[this.state.currentModeIndex]\n\t\t};\n\t}\n\n\tsetState(newState) {\n\t\tconst oldState = { ...this.state };\n\t\tif(newState.mode){\n\t\t\tnewState.currentModeIndex = this.state.modes.indexOf(newState.mode);\n\t\t}\n\t\tthis.state = { ...this.state, ...newState };\n\n\t\tthis._notifyStateChange(oldState, this.state);\n\n\t\tif (this.container) {\n\t\t\tthis.render(this.container);\n\t\t}\n\t}\n\n\tonStateChange(handler) {\n\t\tthis.onStateChangeHandlers.push(handler);\n\n\t\t// function to remove the handler\n\t\treturn () => {\n\t\t\tconst index = this.onStateChangeHandlers.indexOf(handler);\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.onStateChangeHandlers.splice(index, 1);\n\t\t\t}\n\t\t};\n\t}\n\n\t_notifyStateChange(oldState, newState) {\n\t\tthis.onStateChangeHandlers.forEach(handler => handler(oldState, newState));\n\t}\n\n\t_adjustDate(direction) {\n\n\t\tconst {mode, date} = this.getState();\n\t\tconst newDate = new Date(date);\n\t\tif (mode === 'days') {\n\t\t\tnewDate.setMonth(date.getMonth() + direction);\n\t\t} else if (mode === 'months') {\n\t\t\tnewDate.setFullYear(date.getFullYear() + direction);\n\t\t} else {\n\t\t\tnewDate.setFullYear(date.getFullYear() + direction * 10);\n\t\t}\n\t\tthis.setState({ date: newDate });\n\t}\n\n\t_toggleMode() {\n\t\tconst newIndex = (this.state.currentModeIndex + 1) % this.state.modes.length;\n\t\tthis.setState({ currentModeIndex: newIndex });\n\t}\n\n\t_renderCalendarHeader(container) {\n\t\tconst {mode, date} = this.getState();\n\n\t\tconst header = document.createElement('div');\n\t\theader.classList.add('dhx_cal_datepicker_header');\n\n\t\tconst backwardArrow = document.createElement('button');\n\n\t\tbackwardArrow.classList.add(\"dhx_cal_datepicker_arrow\", \"scheduler_icon\", \"arrow_left\");\n\t\theader.appendChild(backwardArrow);\n\n\t\tconst monthLabel = document.createElement('div');\n\t\tmonthLabel.classList.add('dhx_cal_datepicker_title');\n\n\t\tif (mode === 'days') {\n\t\t\tmonthLabel.innerText = date.toLocaleString('default', { month: 'long' }) + ' ' + date.getFullYear();\n\t\t} else if (mode === 'months') {\n\t\t\tmonthLabel.innerText = date.getFullYear();\n\t\t} else {\n\t\t\tconst startYear = Math.floor(date.getFullYear() / 10) * 10;\n\t\t\tmonthLabel.innerText = `${startYear} - ${startYear + 9}`;\n\t\t}\n\n\t\tthis._domEvents.attach(monthLabel, \"click\", this._toggleMode.bind(this));\n\t\theader.appendChild(monthLabel);\n\n\t\tconst forwardArrow = document.createElement('button');\n\n\t\tforwardArrow.classList.add(\"dhx_cal_datepicker_arrow\", \"scheduler_icon\", \"arrow_right\");\n\t\theader.appendChild(forwardArrow);\n\n\t\tcontainer.appendChild(header);\n\n\t\tthis._domEvents.attach(backwardArrow, \"click\", this._adjustDate.bind(this, -1));\n\t\tthis._domEvents.attach(forwardArrow, \"click\", this._adjustDate.bind(this, 1));\n\t}\n\n\trender(container) {\n\t\tthis._domEvents.detachAll();\n\t\tthis.container = container || this.container; \n\t\tthis.container.innerHTML = '';\n\n\t\tif(!this.element){\n\t\t\tthis.element = document.createElement(\"div\");\n\t\t\tthis.element.classList.add(\"dhx_cal_datepicker\");\n\t\t}\n\t\tthis.element.innerHTML = '';\n\t\tthis.container.appendChild(this.element);\n\n\t\tthis._renderCalendarHeader(this.element);\n\t\tconst dataContainer = document.createElement(\"div\");\n\t\tdataContainer.classList.add(\"dhx_cal_datepicker_data\");\n\t\tthis.element.appendChild(dataContainer);\n\n\t\tconst {mode} = this.getState();\n\t\tif (mode === 'days') {\n\t\t\tthis._renderDayGrid(dataContainer);\n\t\t} else if (mode === 'months') {\n\t\t\tthis._renderMonthGrid(dataContainer);\n\t\t} else {\n\t\t\tthis._renderYearGrid(dataContainer);\n\t\t}\n\t}\n\n\t_renderDayGridHeader(daysOfWeekContainer) {\n\t\tconst {date, filterDays} = this.getState();\n\t\tconst scheduler = this.scheduler;\n\n\t\tlet currentDate = scheduler.date.week_start(new Date(date));\n\t\tconst maxDate = scheduler.date.add(scheduler.date.week_start(new Date(date)), 1, 'week');\n\n\t\tdaysOfWeekContainer.classList.add('dhx_cal_datepicker_days');\n\n\t\tconst labelFormat = scheduler.date.date_to_str(\"%D\");\n\n\t\twhile (currentDate.valueOf() < maxDate.valueOf()) {\n\t\t\tif(!(filterDays && filterDays(currentDate))){\n\t\t\t\tconst label = labelFormat(currentDate);\n\n\t\t\t\tconst dayElement = document.createElement('div');\n\t\t\t\tdayElement.setAttribute(\"data-day\", currentDate.getDay());\n\t\t\t\tdayElement.classList.add('dhx_cal_datepicker_dayname');\n\t\t\t\tdayElement.innerText = label;\n\t\t\t\tdaysOfWeekContainer.appendChild(dayElement);\n\t\t\t}\n\n\t\t\tcurrentDate = scheduler.date.add(currentDate, 1, 'day');\n\t\t}\n\t}\n\n\t_weeksBetween(min, max) {\n\t\tconst scheduler = this.scheduler;\n\t\tlet weeks = 0;\n\t\tlet currWeek = new Date(min);\n\t\twhile(currWeek.valueOf() < max.valueOf()){\n\t\t\tweeks += 1;\n\t\t\tcurrWeek = scheduler.date.week_start(scheduler.date.add(currWeek, 1, \"week\"));\n\t\t}\n\t\treturn weeks;\n\t}\n\n\t_renderDayGrid(container) {\n\t\tconst {date, currentRange, eventDates, minWeeks, filterDays} = this.getState();\n\n\t\tlet minSchedulerDate = currentRange[0];\n\t\tlet maxSchedulerDate = currentRange[1];\n\n\t\tconst eventDaysTable = eventDates.reduce((acc, date) => {\n\t\t\tconst dayStart = this.scheduler.date.day_start(new Date(date));\n\t\t\tacc[dayStart.valueOf()] = true;\n\t\t\treturn acc;\n\t\t}, {});\n\n\n\t\t// Render Days of the Week\n\t\tconst daysOfWeekContainer = document.createElement('div');\n\t\tthis._renderDayGridHeader(daysOfWeekContainer);\n\t\tconst weekLength = daysOfWeekContainer.children.length;\n\t\tcontainer.appendChild(daysOfWeekContainer);\n\t\tif(weekLength !== 7){\n\t\t\tcontainer.style.setProperty(\"--dhx-scheduler-week-length\", weekLength);\n\t\t}\n\n\t\tconst scheduler = this.scheduler;\n\t\tconst firstDate = scheduler.date.week_start(scheduler.date.month_start(new Date(date)));\n\t\tconst monthStart = scheduler.date.month_start(new Date(date));\n\t\tconst monthEnd = scheduler.date.add(scheduler.date.month_start(new Date(date)), 1, 'month');\n\t\tlet lastDate = scheduler.date.add(scheduler.date.month_start(new Date(date)), 1, 'month');\n\t\tconst currentCalDate = scheduler.date.date_part(scheduler._currentDate());\n\t\tif(lastDate.getDay() !== 0){\n\t\t\tlastDate = scheduler.date.add(scheduler.date.week_start(lastDate), 1, \"week\");\n\t\t}\n\n\t\tlet weeks = this._weeksBetween(firstDate, lastDate);\n\t\tif(minWeeks && weeks < minWeeks){\n\t\t\tlastDate = scheduler.date.add(lastDate, (minWeeks - weeks), \"week\");\n\t\t}\n\n\t\tlet currDate = firstDate;\n\n\t\tconst dayGridContainer = document.createElement('div');\n\t\tdayGridContainer.classList.add('dhx_cal_datepicker_days');\n\n\t\tthis._domEvents.attach(dayGridContainer, \"click\", (event) => {\n\t\t\tconst dateCell = event.target.closest(\"[data-cell-date]\");\n\t\t\tconst date = new Date(dateCell.getAttribute(\"data-cell-date\"));\n\t\t\tthis.callEvent(\"onDateClick\", [date, event]);\n\t\t});\n\n\t\twhile(currDate.valueOf() < lastDate.valueOf()){\n\t\t\tif(!(filterDays && filterDays(currDate))){\n\n\t\t\t\tconst dayElement = document.createElement('div');\n\t\t\t\tdayElement.setAttribute(\"data-cell-date\", scheduler.templates.format_date(currDate));\n\t\t\t\tdayElement.setAttribute(\"data-day\", currDate.getDay());\n\t\t\t\t// GS-2615: apply month template to year view\n\t\t\t\tdayElement.innerHTML = scheduler.templates.month_day(currDate);\n\n\t\t\t\tif(currDate.valueOf() < monthStart.valueOf()){\n\t\t\t\t\tdayElement.classList.add('dhx_before');\n\t\t\t\t}else if(currDate.valueOf() >= monthEnd.valueOf()){\t\n\t\t\t\t\tdayElement.classList.add('dhx_after');\n\t\t\t\t}\n\n\t\t\t\tif(currDate.getDay() === 0 || currDate.getDay() === 6){\n\t\t\t\t\tdayElement.classList.add(\"dhx_cal_datepicker_weekend\");\n\t\t\t\t}\n\n\t\t\t\tif(currDate.valueOf() == currentCalDate.valueOf()){\n\t\t\t\t\tdayElement.classList.add(\"dhx_now\");\n\t\t\t\t}\n\n\t\t\t\tif(minSchedulerDate && maxSchedulerDate){\n\t\t\t\t\tif(currDate.valueOf() >= minSchedulerDate.valueOf() && currDate.valueOf() < maxSchedulerDate.valueOf()){\n\t\t\t\t\t\tdayElement.classList.add('dhx_cal_datepicker_current');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(eventDaysTable[currDate.valueOf()]){\n\t\t\t\t\tdayElement.classList.add('dhx_cal_datepicker_event');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdayElement.classList.add('dhx_cal_datepicker_date');\n\n\t\t\t\tdayGridContainer.appendChild(dayElement);\n\t\t\t}\n\t\t\tcurrDate = scheduler.date.add(currDate, 1, 'day');\n\t\t}\n\n\t\tcontainer.appendChild(dayGridContainer);\n\n\t}\n\n\t_renderMonthGrid(container) {\n\t\tconst {date} = this.getState();\n\n\t\tconst wrapper = document.createElement('div');\n\t\twrapper.classList.add(\"dhx_cal_datepicker_months\");\n\n\t\tconst months = [];\n\t\tfor(let i = 0; i < 12; i++){\n\t\t\tmonths.push(new Date(date.getFullYear(), i, 1));\n\t\t}\n\n\t\tconst formatLabel = this.scheduler.date.date_to_str(\"%M\");\n\t\tmonths.forEach(month => {\n\t\t\tconst monthElement = document.createElement('div');\n\t\t\tmonthElement.classList.add('dhx_cal_datepicker_month');\n\t\t\tif(date.getMonth() === month.getMonth()){\n\t\t\t\tmonthElement.classList.add('dhx_cal_datepicker_current');\n\t\t\t}\n\t\t\tmonthElement.setAttribute(\"data-month\", month.getMonth());\n\t\t\tmonthElement.innerHTML = formatLabel(month);\n\t\t\tthis._domEvents.attach(monthElement, \"click\", () => {\n\t\t\t\tconst newDate = new Date(month);\n\t\t\t\tthis.setState({\n\t\t\t\t\tdate: newDate,\n\t\t\t\t\tmode: 'days'\n\t\t\t\t});\n\t\t\t});\n\t\t\twrapper.appendChild(monthElement);\n\t\t});\n\t\tcontainer.appendChild(wrapper);\n\n\t\tconst doneArea = document.createElement(\"div\");\n\t\tdoneArea.classList.add(\"dhx_cal_datepicker_done\");\n\t\tconst doneBtn = document.createElement(\"button\");\n\t\tdoneBtn.innerText = \"Done\";\n\t\tdoneBtn.classList.add(\"dhx_cal_datepicker_done_btn\");\n\t\tthis._domEvents.attach(doneBtn, \"click\", () => {\n\t\t\tthis.setState({\n\t\t\t\tmode: 'days'\n\t\t\t});\n\t\t});\n\t\tdoneArea.appendChild(doneBtn);\n\t\tcontainer.appendChild(doneArea);\n\t}\n\n\t_renderYearGrid(container) {\n\t\tconst {date} = this.getState();\n\t\tconst startYear = Math.floor(date.getFullYear() / 10) * 10;\n\t\t\n\t\tconst wrapper = document.createElement('div');\n\t\twrapper.classList.add(\"dhx_cal_datepicker_years\");\n\t\tfor (let i = startYear - 1; i <= startYear + 10; i++) {\n\t\t\tconst yearElement = document.createElement('div');\n\t\t\tyearElement.innerText = i;\n\t\t\tyearElement.classList.add('dhx_cal_datepicker_year');\n\t\t\tyearElement.setAttribute(\"data-year\", i);\n\t\t\tif(date.getFullYear() === i){\n\t\t\t\tyearElement.classList.add('dhx_cal_datepicker_current');\n\t\t\t}\n\t\t\tthis._domEvents.attach(yearElement, \"click\", () => {\n\t\t\t\tthis.setState({\n\t\t\t\t\tdate: new Date(i, date.getMonth(), 1),\n\t\t\t\t\tmode: 'months'\n\t\t\t\t});\n\t\t\t});\n\t\t\twrapper.appendChild(yearElement);\n\t\t\t\n\t\t}\n\t\tcontainer.appendChild(wrapper);\n\n\t\tconst doneArea = document.createElement(\"div\");\n\t\tdoneArea.classList.add(\"dhx_cal_datepicker_done\");\n\t\tconst doneBtn = document.createElement(\"button\");\n\t\tdoneBtn.innerText = \"Done\";\n\t\tdoneBtn.classList.add(\"dhx_cal_datepicker_done_btn\");\n\t\tthis._domEvents.attach(doneBtn, \"click\", () => {\n\t\t\tthis.setState({\n\t\t\t\tmode: 'months'\n\t\t\t});\n\t\t});\n\t\tdoneArea.appendChild(doneBtn);\n\t\tcontainer.appendChild(doneArea);\n\t}\n\n\tdestructor(){\n\t\tthis.onStateChangeHandlers = [];\n\t\tif(this.element){\n\t\t\tthis.element.innerHTML = '';\n\t\t\tthis.element.remove();\n\t\t}\n\n\t\tthis._domEvents.detachAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t\tthis.scheduler = null;\n\t}\n}","// import \"./css/dhtmlxscheduler_terrace\";\n// import \"./css/dhtmlxscheduler_material\";\n// import \"./css/dhtmlxscheduler_material_nofont\";\n// import \"./css/dhtmlxscheduler_flat\";\n// import \"./css/dhtmlxscheduler_contrast_black\";\n// import \"./css/dhtmlxscheduler_contrast_white\";\n\nimport addPlugins from \"./plugins\";\nimport stateProvider from \"./core/state\";\nimport assert from \"./core/common/assert\";\nimport common_errors from \"./core/common_errors\";\nimport connector from \"./core/connector\";\nimport schedulerCore from \"./core/scheduler\";\nimport common from \"./core/common\";\nimport wai_aria from \"./core/wai_aria\";\nimport utils from \"./core/utils/utils\";\nimport dom_helpers from \"./core/utils/dom_helpers\";\nimport env from \"./utils/env\";\nimport destructor from \"./core/destructor\";\nimport ajax from \"./core/utils/ajax\";\nimport base from \"./core/base\";\nimport config from \"./core/config\";\nimport event from \"./core/event\";\nimport event_highlight from \"./core/event_highlight\";\nimport load from \"./core/load\";\nimport lightbox from \"./core/lightbox\";\nimport touch from \"./core/touch\";\nimport dhtmlx_suite_hooks from \"./core/dhtmlx/dhtmlx_suite_hooks\";\nimport skins from \"./core/skins\";\nimport jquery from \"./core/jquery\";\nimport delay_render from \"./core/delay_render\";\nimport dataProcessorExtend from \"./core/dataprocessor/dataprocessor\";\nimport message from \"./core/message\";\nimport i18nFactory from \"./locale\";\n\nimport voidFirst from \"./publish_helpers/void_script_first\";\nimport voidSecond from \"./publish_helpers/void_script_second\";\nimport voidThird from \"./publish_helpers/void_script_third\";\n\n//import datepickerHeader from \"./core/clickable_header\";\n\nimport { DatePicker } from \"./core/datepicker\";\n\nexport default function(extensionManager) {\n\n\tconst scheduler = { version: VERSION };\n\t\n\tscheduler.$stateProvider = stateProvider();\n\n\tscheduler.getState = scheduler.$stateProvider.getState;\n\tcommon_errors(scheduler);\n\tcommon(scheduler);\n\tschedulerCore(scheduler);\n\twai_aria(scheduler);\n\t//utils(scheduler);\n\n\tscheduler.utils = utils;\n\tscheduler.$domHelpers = dom_helpers;\n\tscheduler.utils.dom = dom_helpers;\n\tscheduler.uid = utils.uid;\n\tscheduler.mixin = utils.mixin;\n\tscheduler.defined = utils.defined;\n\tscheduler.assert = assert(scheduler);\n\tscheduler.copy = utils.copy;\n\n\tscheduler._createDatePicker = function(container, config){\n\t\treturn new DatePicker(scheduler, container, config);\n\t};\n\n\t//datepickerHeader(scheduler);\n\n\n\t//old api compatibility\n\tscheduler._getFocusableNodes = dom_helpers.getFocusableNodes;\n\tscheduler._getClassName = dom_helpers.getClassName;\n\tscheduler._locate_css = dom_helpers.locateCss;\n\n\tconst messageApi = message(scheduler);\n\tscheduler.utils.mixin(scheduler, messageApi);\n\n\tscheduler.env = scheduler.$env = env;\n\tscheduler.Promise = window.Promise;\n\tdestructor(scheduler);\n\tajax(scheduler);\n\tvoidFirst(scheduler);\n\tbase(scheduler);\n\tconfig(scheduler);\n\tevent(scheduler);\n\tevent_highlight(scheduler);\n\tload(scheduler);\n\tlightbox(scheduler);\n\ttouch(scheduler);\n\tdhtmlx_suite_hooks(scheduler);\n\tvoidSecond(scheduler);\n\tskins(scheduler);\n\tjquery(scheduler);\n\tdelay_render(scheduler);\n\tdataProcessorExtend(scheduler);\n\tvoidThird(scheduler);\n\tconnector(scheduler);\n\tconst i18n = i18nFactory();\n\tscheduler.i18n = {\n\t\taddLocale: i18n.addLocale,\n\t\tsetLocale: function(locale){\n\t\t\tif(typeof locale === \"string\"){\n\t\t\t\tvar localeObject = i18n.getLocale(locale);\n\t\t\t\tif(!localeObject){\n\t\t\t\t\tlocaleObject = i18n.getLocale(\"en\");\n\t\t\t\t}\n\n\t\t\t\tscheduler.locale = localeObject;\n\t\t\t}else if(locale){\n\t\t\t\tif(!scheduler.locale){\n\t\t\t\t\tscheduler.locale = locale;\n\t\t\t\t}else{\n\t\t\t\t\tfor(var i in locale){\n\t\t\t\t\t\tif(locale[i] && typeof locale[i] === \"object\"){\n\t\t\t\t\t\t\tif(!scheduler.locale[i]){\n\t\t\t\t\t\t\t\tscheduler.locale[i] = {};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tscheduler.mixin(scheduler.locale[i], locale[i], true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tscheduler.locale[i] = locale[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar labels = scheduler.locale.labels;\n\t\t\tlabels.dhx_save_btn \t= labels.icon_save;\n\t\t\tlabels.dhx_cancel_btn \t= labels.icon_cancel;\n\t\t\tlabels.dhx_delete_btn \t= labels.icon_delete;\n\n\t\t\tif(scheduler.$container){\n\t\t\t\tscheduler.get_elements();\n\t\t\t}\n\t\t\t\n\t\t},\n\t\tgetLocale: i18n.getLocale\n\t};\n\tscheduler.i18n.setLocale(\"en\");\n\tscheduler.ext = {};\n\taddPlugins(scheduler);\n\t\n\n\tconst activePlugins = {};\n\tscheduler.plugins = function(config){\n\t\tconst extensionList = getExtensionList(config, {\n\t\t\t\ttreetimeline: [\"timeline\"],\n\t\t\t\tdaytimeline: [\"timeline\"],\n\t\t\t\touterdrag: [\"legacy\"]\n\t\t\t}, {\n\t\t\t\tlegacy: 1,\n\t\t\t\tlimit: 1,\n\t\t\t\ttimeline: 2,\n\t\t\t\tdaytimeline: 3,\n\t\t\t\ttreetimeline: 3,\n\t\t\t\touterdrag:6\n\t\t\t});\n\n\t\textensionList.forEach(function(name){\n\t\t\tif(!activePlugins[name]){\n\t\t\t\tconst plugin = extensionManager.getExtension(name);\n\t\t\t\tif(plugin){\n\t\t\t\t\tplugin(scheduler);\n\t\t\t\t\tactivePlugins[name] = true;\n\t\t\t\t}else{\n\t\t\t\t\tthrow new Error(\"unknown plugin \" + name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tfunction getExtensionList(config, dependencies, priorities){\n\t\tconst result = [];\n\n\t\tfor(const i in config){\n\t\t\tif(config[i]){\n\t\t\t\tconst extension = i.toLowerCase();\n\t\t\t\tif(dependencies[extension]){\n\t\t\t\t\tdependencies[extension].forEach(function(dep){\n\t\t\t\t\t\tconst dependencyName = dep.toLowerCase();\n\t\t\t\t\t\tif(!config[dependencyName]){\n\t\t\t\t\t\t\tresult.push(dependencyName);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tresult.push(extension);\n\t\t\t}\n\t\t}\n\t\t\n\t\tresult.sort(function(a, b){\n\t\t\tconst orderA = priorities[a] || 0;\n\t\t\tconst orderB = priorities[b] || 0;\n\t\t\tif(orderA > orderB){\n\t\t\t\treturn 1;\n\t\t\t}else if(orderA < orderB){\n\t\t\t\treturn -1;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tscheduler.plugins({\n\t\tall_timed: \"short\"\n\t});\n\n\treturn scheduler;\n\n}","import utils from \"./utils/utils\";\n\nconst StateService = (function(){\n\tconst stateProviders = {};\n\n\tfunction getState(name){\n\t\tconst provider = stateProviders[name];\n\t\tif(provider){\n\t\t\treturn stateProviders[name].method();\n\t\t}else{\n\t\t\tconst res = {};\n\t\t\tfor(const i in stateProviders){\n\t\t\t\tif(!stateProviders[i].internal)\n\t\t\t\t\tutils.mixin(res, stateProviders[i].method(), true);\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tfunction registerProvider(name, provider, internal){\n\t\tstateProviders[name] = { method: provider, internal: internal};\n\t}\n\n\tfunction unregisterProvider(name){\n\t\tdelete stateProviders[name];\n\t}\n\n\treturn {\n\t\tgetState: getState,\n\t\tregisterProvider: registerProvider,\n\t\tunregisterProvider: unregisterProvider\n\t};\n});\n\nexport default StateService;\n\n","export default function extend(scheduler) {\n\nvar commonViews = {\n\tagenda: \"https://docs.dhtmlx.com/scheduler/agenda_view.html\",\n\tgrid: \"https://docs.dhtmlx.com/scheduler/grid_view.html\",\n\tmap: \"https://docs.dhtmlx.com/scheduler/map_view.html\",\n\tunit: \"https://docs.dhtmlx.com/scheduler/units_view.html\",\n\ttimeline: \"https://docs.dhtmlx.com/scheduler/timeline_view.html\",\n\tweek_agenda: \"https://docs.dhtmlx.com/scheduler/weekagenda_view.html\",\n\tyear: \"https://docs.dhtmlx.com/scheduler/year_view.html\",\n\tanythingElse: \"https://docs.dhtmlx.com/scheduler/views.html\"\n};\n\nvar requiredExtensions = {\n\tagenda: \"ext/dhtmlxscheduler_agenda_view.js\",\n\tgrid: \"ext/dhtmlxscheduler_grid_view.js\",\n\tmap: \"ext/dhtmlxscheduler_map_view.js\",\n\tunit: \"ext/dhtmlxscheduler_units.js\",\n\ttimeline: \"ext/dhtmlxscheduler_timeline.js, ext/dhtmlxscheduler_treetimeline.js, ext/dhtmlxscheduler_daytimeline.js\",\n\tweek_agenda: \"ext/dhtmlxscheduler_week_agenda.js\",\n\tyear: \"ext/dhtmlxscheduler_year_view.js\",\n\tlimit: \"ext/dhtmlxscheduler_limit.js\"\n};\n\nscheduler._commonErrorMessages = {\n\tunknownView: function(view){\n\t\tvar relatedDoc = \"Related docs: \" + (commonViews[view] || commonViews.anythingElse); \n\t\tvar relatedExtension = requiredExtensions[view] ? (\"You're probably missing \" + requiredExtensions[view] + \".\") : \"\";\n\t\treturn (\n\t\t\t\"`\"+view+\"` view is not defined. \\n\" +\n\t\t\t\"Please check parameters you pass to `scheduler.init` or `scheduler.setCurrentView` in your code and ensure you've imported appropriate extensions. \\n\" + \n\t\t\trelatedDoc + \"\\n\" + (relatedExtension ? (relatedExtension + \"\\n\") : \"\"));\n\t},\n\tcollapsedContainer: function(div){\n\t\treturn \"Scheduler container height is set to *100%* but the rendered height is zero and the scheduler is not visible. \\n\"+\n\t\t\"Make sure that the container has some initial height or use different units. For example:\\n\" +\n\t\t\"<div id='scheduler_here' class='dhx_cal_container' style='width:100%; height:600px;'> \\n\";\n\t}\n};\n\nscheduler.createTimelineView = function() {\n\tthrow new Error(\"scheduler.createTimelineView is not implemented. Be sure to add the required extension: \" + requiredExtensions.timeline + \n\t\"\\n\" +\n\t\"Related docs: \" + commonViews.timeline);\n};\n\nscheduler.createUnitsView = function() {\n\tthrow new Error(\"scheduler.createUnitsView is not implemented. Be sure to add the required extension: \" + requiredExtensions.unit + \n\t\"\\n\" +\n\t\"Related docs: \" + commonViews.unit);\n};\n\nscheduler.createGridView = function() {\n\tthrow new Error(\"scheduler.createGridView is not implemented. Be sure to add the required extension: \" + requiredExtensions.grid + \n\t\"\\n\" +\n\t\"Related docs: \" + commonViews.grid);\n};\n\nscheduler.addMarkedTimespan = function() {\n\tthrow new Error(\"scheduler.addMarkedTimespan is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_limit.js\" + \n\t\"\\n\" +\n\t\"Related docs: https://docs.dhtmlx.com/scheduler/limits.html\");\n};\n\nscheduler.renderCalendar = function() {\n\tthrow new Error(\"scheduler.renderCalendar is not implemented. Be sure to add the required extension: ext/dhtmlxscheduler_minical.js\" + \n\t\"\\n\" +\n\t\"https://docs.dhtmlx.com/scheduler/minicalendar.html\");\n};\n\nscheduler.exportToPNG = function() {\n\tthrow new Error([\n\t\t\"scheduler.exportToPNG is not implemented.\",\n\t\t\"This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/png.html\",\n\t\t\"Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml\"\n\t].join(\"\\n\"));\n};\n\nscheduler.exportToPDF = function() {\n\tthrow new Error([\n\t\t\"scheduler.exportToPDF is not implemented.\",\n\t\t\"This feature requires an additional module, be sure to check the related doc here https://docs.dhtmlx.com/scheduler/pdf.html\",\n\t\t\"Licensing info: https://dhtmlx.com/docs/products/dhtmlxScheduler/export.shtml\"\n\t].join(\"\\n\"));\n};\n\n\n}","\nimport nav_bar from \"./nav_bar\";\nimport scheduler_resize_listener from \"./scheduler_resize_listener\";\nimport eventable from \"../utils/eventable\";\n\n\nexport default function extend(scheduler) {\n\neventable(scheduler);\n\nnav_bar(scheduler);\n\nscheduler._detachDomEvent = function(el, event, handler){\n\tif (el.removeEventListener){\n\t\tel.removeEventListener(event, handler, false);\n\n\t}else if (el.detachEvent){\n\t\tel.detachEvent(\"on\"+event, handler);\n\t}\n};\n\n\nscheduler._init_once = function(){\n\tscheduler_resize_listener(scheduler);\n\n\tscheduler._init_once = function(){};\n};\n\nconst layout = {\n\t\"navbar\": {\n\t\trender: function (config) {\n\t\t\treturn scheduler._init_nav_bar(config);\n\t\t}\n\t},\n\t\"header\": {\n\t\trender: function (config) {\n\t\t\tconst element = document.createElement(\"div\");\n\t\t\telement.className = \"dhx_cal_header\";\n\t\t\treturn element;\n\t\t}\n\t},\n\t\"dataArea\": {\n\t\trender: function (config) {\n\t\t\tconst element = document.createElement(\"div\");\n\t\t\telement.className = \"dhx_cal_data\";\n\t\t\treturn element;\n\t\t}\n\t},\n\t\"html_element\": {\n\t\trender: function (config) {\n\t\t\treturn config.html;\n\t\t}\n\t}\n};\n\nfunction hasSchedulerMarkup(element){\n\treturn !!(\n\t\telement.querySelector(\".dhx_cal_header\") &&\n\t\telement.querySelector(\".dhx_cal_data\") &&\n\t\telement.querySelector(\".dhx_cal_navline\")\n\t\t);\n}\n\nfunction createDefaultHeader(scheduler){\n\tconst views = [\n\t\t\"day\",\n\t\t\"week\",\n\t\t\"month\"\n\t];\n\tconst date = [\n\t\t\"date\"\n\t];\n\tconst nav = [\n\t\t\"prev\",\n\t\t\"today\",\n\t\t\"next\"\n\t];\n\n\tif(scheduler.matrix){\n\t\tfor(const i in scheduler.matrix){\n\t\t\tviews.push(i);\n\t\t}\n\t}\n\tif(scheduler._props){\n\t\tfor(const i in scheduler._props){\n\t\t\tviews.push(i);\n\t\t}\n\t}\n\n\tif(scheduler._grid && scheduler._grid.names){\n\t\tfor(const i in scheduler._grid.names){\n\t\t\tviews.push(i);\n\t\t}\n\t}\n\n\tconst optionalViews = [\n\t\t\"map\",\n\t\t\"agenda\",\n\t\t\"week_agenda\",\n\t\t\"year\"\n\t];\n\n\toptionalViews.forEach(function(viewName){\n\t\tif(scheduler[viewName + \"_view\"]){\n\t\t\tviews.push(viewName);\n\t\t}\n\t});\n\n\treturn views.concat(date).concat(nav);\n}\n\nscheduler.init=function(id,date,mode){\n\tif(this.$destroyed){\n\t\treturn; // not have errors when try to reinit destroyed scheduler\n\t}\n\tdate=date||(scheduler._currentDate());\n\tmode=mode||\"week\";\n\n\tif(this._obj){\n\t\tthis.unset_actions();\n\t}\n\n\tthis._obj=(typeof id == \"string\")?document.getElementById(id):id;\n\tthis.$container = this._obj;\n\tthis.$root = this._obj;\n\n\tif(!this.$container.offsetHeight && this.$container.offsetWidth && this.$container.style.height === \"100%\"){\n\t\t// scheduler container has zero height and non-zero width\n\t\twindow.console.error(scheduler._commonErrorMessages.collapsedContainer(), this.$container);\n\t}\n\n\tif(this.config.wai_aria_attributes && this.config.wai_aria_application_role){\n\t\tthis.$container.setAttribute(\"role\", \"application\");\n\t}\n\n\tif(!this.config.header && !hasSchedulerMarkup(this.$container)){\n\t\t// if no header config and no required markup - use the default header\n\t\t// so the scheduler could be initialized in an empty div\n\t\tthis.config.header = createDefaultHeader(this);\n\t\twindow.console.log([// jshint ignore:line\n\t\t\t\"Required DOM elements are missing from the scheduler container and **scheduler.config.header** is not specified.\",\n\t\t\t\"Using a default header configuration: \",\n\t\t\t\"scheduler.config.header = \" + JSON.stringify(this.config.header, null, 2),\n\t\t\t\"Check this article for the details: https://docs.dhtmlx.com/scheduler/initialization.html\"\n\t\t].join(\"\\n\"));// jshint ignore:line\n\t}\n\n\tif (this.config.header) {\n\t\tthis.$container.innerHTML = \"\";\n\t\tthis.$container.classList.add(\"dhx_cal_container\");\n\t\tif(this.config.header.height){\n\t\t\tthis.xy.nav_height = this.config.header.height;\n\t\t}\n\t\tthis.$container.appendChild(layout.navbar.render(this.config.header));\n\t\tthis.$container.appendChild(layout.header.render());\n\t\tthis.$container.appendChild(layout.dataArea.render());\n\t} else {\n\t\t// if no header config provided - make sure scheduler container has all necessary elements\n\t\tif(!hasSchedulerMarkup(this.$container)){\n\t\t\tthrow new Error([\n\t\t\t\t\"Required DOM elements are missing from the scheduler container.\",\n\t\t\t\t\"Be sure to either specify them manually in the markup: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviamarkup\",\n\t\t\t\t\"Or to use **scheduler.config.header** setting so they could be created automatically: https://docs.dhtmlx.com/scheduler/initialization.html#initializingschedulerviaheaderconfig\"\n\t\t\t].join(\"\\n\"));\n\t\t}\n\t}\n\n\tif (this.config.rtl) this.$container.className += \" dhx_cal_container_rtl\";\n\n\t//hook for terrace skin\n\tif (this._skin_init)\n\t\tscheduler._skin_init();\n\n\tscheduler.date.init();\n\n\tthis._scroll=true;\n\n\tthis._els=[];\n\tthis.get_elements();\n\tthis.init_templates();\n\tthis.set_actions();\n\n\tthis._init_once();\n\tthis._init_touch_events();\n\n\tthis.set_sizes();\n\tscheduler.callEvent('onSchedulerReady', []);\n\tscheduler.$initialized = true;\n\tthis.setCurrentView(date,mode);\n\n};\n\nscheduler.xy={\n\tmin_event_height:20,\n\tbar_height: 24,\n\tscale_width:50,\n\tscroll_width:18,\n\tscale_height:20,\n\tmonth_scale_height:20,\n\tmenu_width:25,\n\tmargin_top:0,\n\tmargin_left:0,\n\teditor_width:140,\n\tmonth_head_height:22,\n\tevent_header_height: 14\n};\nscheduler.keys={\n\tedit_save:13,\n\tedit_cancel:27\n};\n\nscheduler.bind = function bind(functor, object){\n\tif(functor.bind)\n\t\treturn functor.bind(object);\n\telse\n\t\treturn function(){ return functor.apply(object,arguments); };\n};\n\nscheduler.set_sizes=function(){\n\n\tvar w = this._x = this._obj.clientWidth-this.xy.margin_left;\n\n\t//not-table mode always has scroll - need to be fixed in future\n\tvar scale_x=this._table_view?0:(this.xy.scale_width+this.xy.scroll_width);\n\n\tvar materialScalePlaceholder = this.$container.querySelector(\".dhx_cal_scale_placeholder\");\n\tif(scheduler._is_material_skin()){\n\t\tif(!materialScalePlaceholder) {\n\t\t\tmaterialScalePlaceholder = document.createElement(\"div\");\n\t\t\tmaterialScalePlaceholder.className = \"dhx_cal_scale_placeholder\";\n\t\t\tthis.$container.insertBefore(materialScalePlaceholder, this._els[\"dhx_cal_header\"][0]);\n\t\t}\n\t\tmaterialScalePlaceholder.style.display = \"block\";\n\n\t\tthis.set_xy(materialScalePlaceholder,w,this.xy.scale_height + 1,0, this._els[\"dhx_cal_header\"][0].offsetTop);\n\n\t}else{\n\t\tif(materialScalePlaceholder){\n\t\t\tmaterialScalePlaceholder.parentNode.removeChild(materialScalePlaceholder);\n\t\t}\n\t}\n\n\tif (this._lightbox) {\n\t\tif (scheduler.$container.offsetWidth  < 1200) {\n\t\t} else {\n\t\t\tthis._setLbPosition(document.querySelector(\".dhx_cal_light\"));\n\t\t}\n\t}\n\n\tthis._data_width = w-scale_x;\n\n\tthis._els[\"dhx_cal_navline\"][0].style.width = w + \"px\";\n\tconst header = this._els[\"dhx_cal_header\"][0];\n\tthis.set_xy(header, this._data_width, this.xy.scale_height);\n\t// this._els[\"dhx_cal_header\"][0].style.marginLeft = `${scheduler.xy.scale_width}px`;\n\theader.style.left = ``;\n\theader.style.right = ``;\n\tif(!this._table_view){\n\t\tif(this.config.rtl){\n\t\t\theader.style.right = `${this.xy.scale_width}px`;\n\t\t}else{\n\t\t\theader.style.left = `${this.xy.scale_width}px`;\n\t\t}\n\t} else {\n\t\tif(!this.config.rtl){\n\t\t\theader.style.left = `-1px`;\n\t\t} else {\n\t\t\theader.style.right = `-1px`;\n\t\t}\n\t}\n};\nscheduler.set_xy=function(node,w,h,x,y){\n\tfunction prepareValue(val){\n\t\tlet prepared = val;\n\t\tif(!isNaN(Number(prepared))){\n\t\t\tprepared = Math.max(0,prepared) + \"px\";\n\t\t}\n\t\treturn prepared;\n\t}\n\n\tvar direction = 'left';\n\n\tif(w !== undefined) {\n\t\tnode.style.width = prepareValue(w);\n\t}\n\n\tif(h !== undefined){\n\t\tnode.style.height = prepareValue(h);\n\t}\n\n\tif (arguments.length>3){\n\n\t\tif(x !== undefined){\n\t\t\tif (this.config.rtl) direction = 'right';\n\t\t\tnode.style[direction]=x+\"px\";\n\t\t}\n\t\tif(y !== undefined){\n\t\t\tnode.style.top=y+\"px\";\n\t\t}\n\t}\n};\nscheduler.get_elements=function(){\n\t//get all child elements as named hash\n\tconst els=this._obj.getElementsByTagName(\"DIV\");\n\tfor (let i=0; i < els.length; i++){\n\t\tlet class_name= scheduler._getClassName(els[i]);\n\t\tconst attr_value = els[i].getAttribute(\"data-tab\") || els[i].getAttribute(\"name\") || \"\";\n\t\tif (class_name) class_name = class_name.split(\" \")[0];\n\t\tif (!this._els[class_name]) this._els[class_name]=[];\n\t\tthis._els[class_name].push(els[i]);\n\n\t\t//check if name need to be changed\n\t\t// scheduler.locale.labels[attr_value+\"_tab\"] - to fix getting labels for data-tab\n\t\tlet label = scheduler.locale.labels[attr_value+\"_tab\"] || scheduler.locale.labels[attr_value||class_name];\n\t\tif (typeof label !== \"string\" && attr_value && !els[i].innerHTML)\n\t\t\tlabel = attr_value.split(\"_\")[0];\n\t\tif (label) {\n\t\t\tthis._waiAria.labelAttr(els[i], label);\n\t\t\tels[i].innerHTML = label;\n\t\t}\n\t}\n};\n\n\nconst domEventsScope = scheduler._createDomEventScope();\n\nscheduler.unset_actions = function(){\n\tdomEventsScope.detachAll();\n};\n\nscheduler.set_actions=function(){\n\tfor (const a in this._els){\n\t\tif (this._click[a]){\n\t\t\tfor (let i=0; i < this._els[a].length; i++){\n\t\t\t\tconst element = this._els[a][i];\n\t\t\t\tconst handler = this._click[a].bind(element);\n\t\t\t\tdomEventsScope.attach(element, \"click\", handler);\n\t\t\t}\n\t\t}\n\t}\n\n\tdomEventsScope.attach(this._obj, \"selectstart\", function(e){\n\t\te.preventDefault();\n\t\treturn false;\n\t});\n\t//this._obj.onselectstart=function(e){ return false; };\n\tdomEventsScope.attach(this._obj, \"mousemove\", function(e){\n\t\tif (!scheduler._temp_touch_block)\n\t\t\tscheduler._on_mouse_move(e);\n\t});\n\tdomEventsScope.attach(this._obj, \"mousedown\", function(e){\n\t\tif (!scheduler._ignore_next_click)\n\t\t\tscheduler._on_mouse_down(e);\n\t});\n\tdomEventsScope.attach(this._obj, \"mouseup\", function(e){\n\t\tif (!scheduler._ignore_next_click)\n\t\t\tscheduler._on_mouse_up(e);\n\t});\n\tdomEventsScope.attach(this._obj, \"dblclick\", function(e){\n\t\tscheduler._on_dbl_click(e);\n\t});\n\tdomEventsScope.attach(this._obj, \"contextmenu\", function(event) {\n\t\tif(scheduler.checkEvent(\"onContextMenu\")){\n\t\t\t// block the default browser context menu \n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tconst returnValue = scheduler.callEvent(\"onContextMenu\", [scheduler._locate_event(event.target), event]);\n\t\treturn returnValue;\n\t});\n};\nscheduler.select=function(id){\n\tif (this._select_id==id) return;\n\tscheduler._close_not_saved();\n\tthis.editStop(false);\n\tif(this._select_id){\n\t\tthis.unselect();\n\t}\n\tthis._select_id = id;\n\tthis.updateEvent(id);\n\tthis.callEvent(\"onEventSelected\", [id]);\n};\nscheduler.unselect=function(id){\n\tif (id && id!=this._select_id) {\n\t\treturn;\n\t}\n\tconst previousSelection = this._select_id;\n\tthis._select_id = null;\n\tif (previousSelection && this.getEvent(previousSelection)) {\n\t\tthis.updateEvent(previousSelection);\n\t}\n\tthis.callEvent(\"onEventUnselected\", [previousSelection]);\n};\nscheduler.$stateProvider.registerProvider(\"global\", (function(){\n\treturn {\n\t\tmode: this._mode,\n\t\tdate: new Date(this._date),\n\t\tmin_date: new Date(this._min_date),\n\t\tmax_date: new Date(this._max_date),\n\t\teditor_id: this._edit_id,\n\t\tlightbox_id: this._lightbox_id,\n\t\tnew_event: this._new_event,\n\t\tselect_id: this._select_id,\n\t\texpanded: this.expanded,\n\t\tdrag_id: this._drag_id,\n\t\tdrag_mode: this._drag_mode\n\t};\n}).bind(scheduler));\n\nscheduler._click={\n\tdhx_cal_data:function(e){\n\t\t//in case of touch disable click processing\n\t\tif (scheduler._ignore_next_click){\n\t\t\tif (e.preventDefault)\n\t\t\t\te.preventDefault();\n\t\t\te.cancelBubble = true;\n\t\t\tscheduler._ignore_next_click = false;\n\t\t\treturn false;\n\t\t}\n\n\n\t\tconst id = scheduler._locate_event(e.target);\n\n\t\tif (!id) {\n\t\t\tscheduler.callEvent(\"onEmptyClick\",[scheduler.getActionData(e).date, e]);\n\t\t} else {\n\t\t\tif ( !scheduler.callEvent(\"onClick\",[id,e]) || scheduler.config.readonly ) return;\n\t\t}\n\n\t\tif (id && scheduler.config.select) {\n\n\t\t\tscheduler.select(id);\n\t\t\tconst icon = e.target.closest(\".dhx_menu_icon\");\n\n\t\t\tconst mask = scheduler._getClassName(icon);\n\t\t\tif (mask.indexOf(\"_icon\")!=-1)\n\t\t\t\tscheduler._click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\n\t\t} else{\n\t\t\tscheduler._close_not_saved();\n\t\t\tif (scheduler.getState().select_id && new Date().valueOf()-(scheduler._new_event||0) > 500){\n\t\t\t\tscheduler.unselect();\n\t\t\t}\n\t\t}\n\t},\n\tdhx_cal_prev_button:function(){\n\t\tscheduler._click.dhx_cal_next_button(0,-1);\n\t},\n\tdhx_cal_next_button:function(dummy,step){\n\t\tlet def_step = 1;\n\t\tif (scheduler.config.rtl){\n\t\t\tstep = -step;\n\t\t\tdef_step = -def_step;\n\t\t}\n\t\tscheduler.setCurrentView(scheduler.date.add( //next line changes scheduler._date , but seems it has not side-effects\n\t\t\tscheduler.date[scheduler._mode+\"_start\"](new Date(scheduler._date)),(step||def_step),scheduler._mode));\n\t},\n\tdhx_cal_today_button:function(){\n\t\tif (scheduler.callEvent(\"onBeforeTodayDisplayed\", [])) {\n\t\t\tscheduler.setCurrentView(scheduler._currentDate());\n\t\t}\n\t},\n\tdhx_cal_tab:function(){\n\t\tconst name = this.getAttribute(\"data-tab\");\n\t\tconst deprecated_name = this.getAttribute(\"name\");\n\t\tconst mode = name || deprecated_name.substring(0, deprecated_name.search(\"_tab\"));\n\t\tscheduler.setCurrentView(scheduler._date,mode);\n\t},\n\tbuttons:{\n\t\t\"delete\":function(id){\n\t\t\tconst c = scheduler.locale.labels.confirm_deleting;\n\t\t\tscheduler._dhtmlx_confirm({message: c, title: scheduler.locale.labels.title_confirm_deleting, callback:function(){ scheduler.deleteEvent(id); },\n\t\t\tconfig: {ok: scheduler.locale.labels.icon_delete}\n\t\t});\n\t\t},\n\t\tedit:function(id){ scheduler.edit(id); },\n\t\tsave:function(id){ scheduler.editStop(true); },\n\t\tdetails:function(id){ scheduler.showLightbox(id); },\n\t\tform:function(id){ scheduler.showLightbox(id); },\n\t\tcancel:function(id){ scheduler.editStop(false); }\n\t}\n};\nscheduler._dhtmlx_confirm = function({message, title, callback, config}) {\n\tif (!message)\n\t\treturn callback();\n\n\tconfig = config || {};\n\tconst opts = { ...config, text: message };\n\tif (title) {\n\t\topts.title = title;\n\t}\n\tif (callback) {\n\t\topts.callback = function(result) {\n\t\t\tif (result) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t};\n\t}\n\tscheduler.confirm(opts);\n};\nscheduler.addEventNow=function(start,end,e){\n\tlet base = {};\n\tif (scheduler._isObject(start) && !scheduler._isDate(start)){\n\t\tbase = start;\n\t\tstart = null;\n\t}\n\n\tconst duration = (this.config.event_duration||this.config.time_step)*60000;\n\tif (!start) start = base.start_date||Math.round((scheduler._currentDate()).valueOf()/duration)*duration;\n\tlet start_date = new Date(start);\n\tif (!end){\n\t\tlet start_hour = this.config.first_hour;\n\t\tif (start_hour > start_date.getHours()){\n\t\t\tstart_date.setHours(start_hour);\n\t\t\tstart = start_date.valueOf();\n\t\t}\n\t\tend = start.valueOf()+duration;\n\t}\n\tlet end_date = new Date(end);\n\n\t// scheduler.addEventNow(new Date(), new Date()) + collision though get_visible events defect (such event was not retrieved)\n\tif(start_date.valueOf() == end_date.valueOf())\n\t\tend_date.setTime(end_date.valueOf()+duration);\n\tbase.start_date = base.start_date||start_date;\n\tbase.end_date =  base.end_date||end_date;\n\tbase.text = base.text||this.locale.labels.new_event;\n\tbase.id = this._drag_id = base.id || this.uid();\n\tthis._drag_mode=\"new-size\";\n\tthis._loading=true;\n\tconst eventId = this.addEvent(base);\n\tthis.callEvent(\"onEventCreated\",[this._drag_id,e]);\n\tthis._loading=false;\n\n\tthis._drag_event={}; //dummy , to trigger correct event updating logic\n\tthis._on_mouse_up(e);\n\treturn eventId;\n};\nscheduler._on_dbl_click=function(e,src){\n\tsrc = src || e.target;\n\tif (this.config.readonly) return;\n\tconst name = scheduler._getClassName(src).split(\" \")[0];\n\tswitch(name){\n\t\tcase \"dhx_scale_holder\":\n\t\tcase \"dhx_scale_holder_now\":\n\t\tcase \"dhx_month_body\":\n\t\tcase \"dhx_wa_day_data\":\n\t\t\tif (!scheduler.config.dblclick_create) break;\n\t\t\tthis.addEventNow(this.getActionData(e).date,null,e);\n\t\t\tbreak;\n\t\tcase \"dhx_cal_event\":\n\t\tcase \"dhx_wa_ev_body\":\n\t\tcase \"dhx_agenda_line\":\n\t\tcase \"dhx_cal_agenda_event_line\":\n\t\tcase \"dhx_grid_event\":\n\t\tcase \"dhx_cal_event_line\":\n\t\tcase \"dhx_cal_event_clear\": {\n\t\t\tconst id = this._locate_event(src);\n\t\t\tif (!this.callEvent(\"onDblClick\",[id,e])) return;\n\t\t\tif (this.config.details_on_dblclick || this._table_view || !this.getEvent(id)._timed || !this.config.select)\n\t\t\t\tthis.showLightbox(id);\n\t\t\telse\n\t\t\t\tthis.edit(id);\n\t\t\tbreak;\n\t\t}\n\t\tcase \"dhx_time_block\":\n\t\tcase \"dhx_cal_container\":\n\t\t\treturn;\n\t\tdefault: {\n\t\t\tconst viewHandler = this[\"dblclick_\"+name];\n\t\t\tif (viewHandler) {\n\t\t\t\tviewHandler.call(this,e);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (src.parentNode && src != this)\n\t\t\t\t\treturn scheduler._on_dbl_click(e,src.parentNode);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n};\n//column index by mouse x-coordinate\nscheduler._get_column_index = function(x_pos){\n\tlet column = 0;\n\tif (this._cols){\n\t\tlet width = 0;\n\t\tlet i = 0;\n\t\twhile (width + this._cols[i] < x_pos && i < this._cols.length){\n\t\t\twidth += this._cols[i];\n\t\t\ti++;\n\t\t}\n\t\tcolumn = i + (this._cols[i] ? ((x_pos - width)/ this._cols[i]) : 0);\n\n\t\tif (this._ignores){\n\t\t\tif(column >= this._cols.length){\n\t\t\t\twhile(column >= 1 && this._ignores[Math.floor(column)]){\n\t\t\t\t\tcolumn--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\treturn column;\n};\n\n//transform mouse coordinates to day-time indexes of week based view\nscheduler._week_indexes_from_pos = function(pos){\n\t//\"get position\" can be invoked before columns are loaded into the units view(e.g. by onMouseMove handler in key_nav.js)\n\tif(!this._cols){\n\t\treturn pos;\n\t}else{\n\t\tconst column = this._get_column_index(pos.x);\n\n\t\tpos.x=Math.min(this._cols.length-1, Math.max(0,Math.ceil(column)-1));\n\t\tpos.y=Math.max(0,Math.ceil(pos.y*60/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step);\n\t\treturn pos;\n\t}\n};\n\nscheduler._mouse_coords=function(ev){\n\tlet pos;\n\tconst body = document.body;\n\tconst documentElement = document.documentElement;\n\tif (!this.$env.isIE && (ev.pageX || ev.pageY))\n\t\tpos={x:ev.pageX, y:ev.pageY};\n\telse pos={\n\t\tx:ev.clientX + (body.scrollLeft||documentElement.scrollLeft||0) - body.clientLeft,\n\t\ty:ev.clientY + (body.scrollTop||documentElement.scrollTop||0) - body.clientTop\n\t};\n\t//apply layout\n\tif (this.config.rtl && this._colsS) {\n\t\tpos.x = this.$container.querySelector(\".dhx_cal_data\").offsetWidth - pos.x;\n\t\tpos.x += this.$domHelpers.getAbsoluteLeft(this._obj);\n\t\tif (this._mode !== \"month\") {\n\t\t\tpos.x -= this.xy.scale_width;\n\t\t}\n\t} else {\n\t\tpos.x-=this.$domHelpers.getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width);\n\t}\n\n\tconst dataArea = this.$container.querySelector(\".dhx_cal_data\");\n\t//pos.y-=this.$domHelpers.getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els[\"dhx_cal_data\"][0].scrollTop;\n\tpos.y-=this.$domHelpers.getAbsoluteTop(dataArea)-this._els[\"dhx_cal_data\"][0].scrollTop;\n\tpos.ev = ev;\n\tconst handler = this[\"mouse_\"+this._mode];\n\tif (handler){\n\t\tpos = handler.call(this,pos);\n\t}else{\n\t\t//transform to date\n\t\tif (!this._table_view) {\n\t\t\tpos = this._week_indexes_from_pos(pos);\n\t\t} else {\n\t\t\tconst column = this._get_column_index(pos.x);\n\t\t\tif (!this._cols || !this._colsS) // agenda/map views\n\t\t\t\treturn pos;\n\t\t\tlet dy=0;\n\t\t\tfor (dy=1; dy < this._colsS.heights.length; dy++)\n\t\t\t\tif (this._colsS.heights[dy]>pos.y) break;\n\n\t\t\tpos.y=Math.ceil( (Math.max(0, column)+Math.max(0,dy-1)*7)*24*60/this.config.time_step );\n\n\t\t\tif (scheduler._drag_mode || this._mode == \"month\")\n\t\t\t\tpos.y=(Math.max(0,Math.ceil(column)-1)+Math.max(0,dy-1)*7)*24*60/this.config.time_step;\n\n\t\t\t//we care about ignored days only during event moving in month view\n\t\t\tif (this._drag_mode == \"move\"){\n\t\t\t\tif (scheduler._ignores_detected && scheduler.config.preserve_length){\n\t\t\t\t\tpos._ignores = true;\n\t\t\t\t\t//get real lengtn of event\n\t\t\t\t\tif (!this._drag_event._event_length)\n\t\t\t\t\t\tthis._drag_event._event_length = this._get_real_event_length(this._drag_event.start_date, this._drag_event.end_date, { x_step:1, x_unit:\"day\"});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpos.x=0;\n\t\t}\n\t}\n\tpos.timestamp = +new Date();\n\treturn pos;\n};\nscheduler._close_not_saved=function(){\n\tif (new Date().valueOf()-(scheduler._new_event||0) > 500 && scheduler._edit_id){\n\t\tconst confirmationText=scheduler.locale.labels.confirm_closing;\n\n\t\tscheduler._dhtmlx_confirm({\n\t\t\tmessage: confirmationText, \n\t\t\ttitle: scheduler.locale.labels.title_confirm_closing, \n\t\t\tcallback: function() { \n\t\t\t\tscheduler.editStop(scheduler.config.positive_closing);\n\t\t\t}\n\t\t});\n\t\tif(confirmationText){\n\t\t\tthis._drag_id = this._drag_pos = this._drag_mode = null;\n\t\t}\n\t}\n};\nscheduler._correct_shift=function(start, back){\n\treturn start-=((new Date(scheduler._min_date)).getTimezoneOffset()-(new Date(start)).getTimezoneOffset())*60000*(back?-1:1);\n};\n\nscheduler._is_pos_changed = function(old_pos, new_pos){\n\tfunction diff(old_val, new_val, acc){\n\t\treturn !!(Math.abs(old_val - new_val) > acc);\n\t}\n\n\tif(!(old_pos && this._drag_pos)){\n\t\treturn true;\n\t}\n\tconst delay = 100;\n\tconst d_pos = 5;\n\n\t// start drag only if passed some time since mouse down, or if mouse position changed sufficiently\n\treturn !!(this._drag_pos.has_moved || !this._drag_pos.timestamp || (new_pos.timestamp - this._drag_pos.timestamp > delay) || diff(old_pos.ev.clientX, new_pos.ev.clientX, d_pos) || diff(old_pos.ev.clientY, new_pos.ev.clientY, d_pos));\n};\n\nscheduler._correct_drag_start_date = function(start){\n\tlet obj;\n\tif (scheduler.matrix)\n\t\tobj = scheduler.matrix[scheduler._mode];\n\tobj = obj  || { x_step:1, x_unit:\"day\" };\n\n\tstart = new Date(start);\n\tlet len = 1;\n\tif(obj._start_correction || obj._end_correction)\n\t\tlen = (obj.last_hour||0)*60 - (start.getHours()*60+start.getMinutes()) || 1;\n\n\treturn start*1 + (scheduler._get_fictional_event_length(start, len, obj)  - len);\n};\nscheduler._correct_drag_end_date = function(start, duration){\n\tlet obj;\n\tif (scheduler.matrix) {\n\t\tobj = scheduler.matrix[scheduler._mode];\n\t}\n\tobj = obj  || { x_step:1, x_unit:\"day\" };\n\n\tconst end = start*1 + scheduler._get_fictional_event_length(start, duration, obj);\n\treturn new Date(end*1 - (scheduler._get_fictional_event_length(end, -1, obj, -1) + 1));\n};\n\nscheduler._on_mouse_move=function(e){\n\tif (this._drag_mode){\n\t\tvar pos=this._mouse_coords(e);\n\t\tif (this._is_pos_changed(this._drag_pos, pos)){\n\t\t\tvar start, end;\n\t\t\tif (this._edit_id!=this._drag_id)\n\t\t\t\tthis._close_not_saved();\n\n\t\t\tif(!this._drag_mode)\n\t\t\t\treturn;\n\n\t\t\tvar mousedownPos = null;\n\t\t\tif(this._drag_pos && !this._drag_pos.has_moved){\n\t\t\t\tmousedownPos = this._drag_pos;\n\t\t\t\tmousedownPos.has_moved = true;\n\t\t\t}\n\n\t\t\tthis._drag_pos = pos;\n\n\t\t\tthis._drag_pos.has_moved = true;\n\n\t\t\tif (this._drag_mode==\"create\"){\n\n\t\t\t\t// use mouse down position as a starting point for drag-create\n\t\t\t\tif(mousedownPos){\n\t\t\t\t\tpos = mousedownPos;\n\t\t\t\t}\n\n\t\t\t\tthis._close_not_saved();\n\t\t\t\tthis.unselect(this._select_id);\n\t\t\t\tthis._loading=true; //will be ignored by dataprocessor\n\n\t\t\t\tstart = this._get_date_from_pos(pos).valueOf();\n\n\t\t\t\tif (!this._drag_start) {\n\t\t\t\t\tvar res = this.callEvent(\"onBeforeEventCreated\", [e, this._drag_id]);\n\t\t\t\t\tif (!res){\n\t\t\t\t\t\tthis._loading=false;\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._loading=false;\n\t\t\t\t\tthis._drag_start=start;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tend = start;\n\t\t\t\tif (end == this._drag_start) {\n\t\t\t\t}\n\n\t\t\t\tvar start_date = new Date(this._drag_start);\n\t\t\t\tvar end_date = new Date(end);\n\t\t\t\tif ( (this._mode == \"day\" || this._mode == \"week\") &&\n\t\t\t\t\t(start_date.getHours() == end_date.getHours() &&\n\t\t\t\t\tstart_date.getMinutes() == end_date.getMinutes()) ) {\n\t\t\t\t\t\tend_date = new Date(this._drag_start+1000);\n\t\t\t\t}\n\n\n\t\t\t\tthis._drag_id=this.uid();\n\t\t\t\tthis.addEvent(start_date, end_date, this.locale.labels.new_event, this._drag_id, pos.fields);\n\n\t\t\t\tthis.callEvent(\"onEventCreated\",[this._drag_id,e]);\n\t\t\t\tthis._loading=false;\n\t\t\t\tthis._drag_mode=\"new-size\";\n\n\t\t\t}\n\n\t\t\tvar timeStep = this.config.time_step;\n\t\t\tvar ev=this.getEvent(this._drag_id);\n\t\t\tvar obj;\n\t\t\tif (scheduler.matrix)\n\t\t\t\tobj = scheduler.matrix[scheduler._mode];\n\t\t\tobj = obj  || { x_step:1, x_unit:\"day\" };\n\n\t\t\tif (this._drag_mode==\"move\"){\n\t\t\t\tstart = this._min_date.valueOf()+(pos.y*this.config.time_step+pos.x*24*60)*60000;\n\t\t\t\tif (!pos.custom && this._table_view) {\n\t\t\t\t\tstart += this.date.time_part(ev.start_date) * 1000;\n\t\t\t\t}\n\n\t\t\t\tif (!this._table_view && this._dragEventBody && this._drag_event._move_event_shift === undefined) {\n\t\t\t\t\tthis._drag_event._move_event_shift = start - ev.start_date;\n\t\t\t\t}\n\n\t\t\t\tif (this._drag_event._move_event_shift) {\n\t\t\t\t\tstart -= this._drag_event._move_event_shift;\n\t\t\t\t}\n\n\t\t\t\tstart = this._correct_shift(start);\n\n\t\t\t\tif (pos._ignores && this.config.preserve_length && this._table_view && obj){\n\n\t\t\t\t\tstart = scheduler._correct_drag_start_date(start);\n\t\t\t\t\tend = scheduler._correct_drag_end_date(start,this._drag_event._event_length);\n\n\t\t\t\t} else\n\t\t\t\t\tend = ev.end_date.valueOf()-(ev.start_date.valueOf()-start);\n\t\t\t} else { // resize\n\t\t\t\tstart = ev.start_date.valueOf();\n\t\t\t\tend = ev.end_date.valueOf();\n\t\t\t\tif (this._table_view) {\n\t\t\t\t\tvar resize_date = this._min_date.valueOf()+pos.y*this.config.time_step*60000 + (pos.custom?0:24*60*60000);\n\t\t\t\t\tif (this._mode == \"month\") {\n\t\t\t\t\t\tresize_date = this._correct_shift(resize_date, false);\n\t\t\t\t\t\tif( this._drag_from_start ) {\n\t\t\t\t\t\t\tvar day = 24*60*60000;\n\t\t\t\t\t\t\tif( resize_date <= scheduler.date.date_part(new Date(end+day-1)).valueOf() ) // to get end time as 23:59:59 and then the day start\n\t\t\t\t\t\t\t\tstart = resize_date - day;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tend = resize_date;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(this.config.preserve_length) {\n\t\t\t\t\t\t\tif (pos.resize_from_start) {\n\t\t\t\t\t\t\t\tstart = scheduler._correct_drag_start_date(resize_date);\n\t\t\t\t\t\t\t\t// GS-2759: workaround for timeline with round_position and first and last hours\n\t\t\t\t\t\t\t\tif(obj.round_position && obj.first_hour && obj.last_hour && obj.x_unit == \"day\"){\n\t\t\t\t\t\t\t\t\tstart = new Date(start*1 + obj._start_correction);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tend = scheduler._correct_drag_end_date(resize_date, 0);\n\t\t\t\t\t\t\t\t// GS-2759: workaround for timeline with round_position and first and last hours\n\t\t\t\t\t\t\t\tif(obj.round_position && obj.first_hour && obj.last_hour && obj.x_unit == \"day\"){\n\t\t\t\t\t\t\t\t\tend = scheduler.date.date_part(new Date(end));\n\t\t\t\t\t\t\t\t\tend = new Date(end*1 - obj._end_correction);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// GS-2159: workaround for timeline with round_position and ignore_timeline\n\t\t\t\t\t\t\t\tif(obj.round_position && scheduler[\"ignore_\"+scheduler._mode] && obj.x_unit == \"day\"){\n\t\t\t\t\t\t\t\t\tconst ignore = this[\"ignore_\"+this._mode];\n\t\t\t\t\t\t\t\t\tlet tempEnd = scheduler.date.add(new Date(end), -obj.x_step, obj.x_unit);\n\t\t\t\t\t\t\t\t\tif(ignore(tempEnd)){\n\t\t\t\t\t\t\t\t\t\tend = tempEnd;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (pos.resize_from_start) {\n\t\t\t\t\t\t\t\tstart = resize_date;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tend = resize_date;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar end_day_start = this.date.date_part(new Date(ev.end_date.valueOf() - 1)).valueOf();\n\t\t\t\t\tvar end_day_date = new Date(end_day_start);\n\t\t\t\t\tvar firstHour = this.config.first_hour;\n\t\t\t\t\tvar lastHour = this.config.last_hour;\n\t\t\t\t\tvar maxY = (lastHour - firstHour) * (60/timeStep);\n\n\t\t\t\t\tthis.config.time_step = 1;\n\t\t\t\t\tvar precisePos = this._mouse_coords(e);\n\t\t\t\t\tthis.config.time_step = timeStep;\n\n\t\t\t\t\tvar minDate = pos.y*timeStep*60000;\n\t\t\t\t\tvar maxDate = Math.min(pos.y + 1, maxY)*timeStep*60000;\n\t\t\t\t\tvar preciseDate = precisePos.y*60000;\n\n\t\t\t\t\t// rounding end date to the closest time step\n\t\t\t\t\tif(Math.abs(minDate - preciseDate) > Math.abs(maxDate - preciseDate)){\n\t\t\t\t\t\tend = end_day_start + maxDate;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tend = end_day_start + minDate;\n\t\t\t\t\t}\n\t\t\t\t\tend = end + ((new Date(end)).getTimezoneOffset() - end_day_date.getTimezoneOffset()) * 60000;\n\t\t\t\t\tthis._els[\"dhx_cal_data\"][0].style.cursor=\"s-resize\";\n\t\t\t\t\tif (this._mode == \"week\" || this._mode == \"day\")\n\t\t\t\t\t\tend = this._correct_shift(end);\n\t\t\t\t}\n\t\t\t\tif (this._drag_mode == \"new-size\") {\n\t\t\t\t\tif (end <= this._drag_start){\n\t\t\t\t\t\tvar shift = pos.shift||((this._table_view && !pos.custom)?24*60*60000:0);\n\t\t\t\t\t\tstart = end-(pos.shift?0:shift);\n\t\t\t\t\t\tend = this._drag_start+(shift||(timeStep*60000));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart = this._drag_start;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (end<=start){\n\t\t\t\t\t\t//GS-2811: resizing the event with round_position from the right to the left\n\t\t\t\t\t\tif(obj && obj.round_position){\n\t\t\t\t\t\t\tif(obj.x_unit == \"hour\" || obj.x_unit == \"minute\"){\n\t\t\t\t\t\t\t\tend=scheduler.date.add(start, obj.x_step, obj.x_unit);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tend=scheduler.date.add(scheduler.date.date_part(new Date(start)), 1, obj.x_unit);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tend=start+timeStep*60000;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar new_end = new Date(end-1);\n\t\t\tvar new_start = new Date(start);\n\t\t\t//deny drag out of visible scheduler scale in timeline view\n\t\t\tif(this._drag_mode==\"move\" && scheduler.config.limit_drag_out &&\n\t\t\t\t(+new_start < +scheduler._min_date || +end > +scheduler._max_date)){\n\n\t\t\t\tif(+ev.start_date < +scheduler._min_date || +ev.end_date > +scheduler._max_date){\n\t\t\t\t\t// not move event if it's already outside time scale\n\t\t\t\t\tnew_start = new Date(ev.start_date);\n\t\t\t\t\tend = new Date(ev.end_date);\n\t\t\t\t}else{\n\n\t\t\t\t\tvar duration = end - new_start;\n\n\t\t\t\t\tif(+new_start < +scheduler._min_date){\n\t\t\t\t\t\tnew_start = new Date(scheduler._min_date);\n\t\t\t\t\t\tif (pos._ignores && this.config.preserve_length && this._table_view){\n\t\t\t\t\t\t\tnew_start = new Date(scheduler._correct_drag_start_date(new_start));\n\t\t\t\t\t\t\tif(obj._start_correction)\n\t\t\t\t\t\t\t\tnew_start = new Date(new_start.valueOf() + obj._start_correction);\n\t\t\t\t\t\t\tend = new Date(new_start*1 + this._get_fictional_event_length(new_start, this._drag_event._event_length, obj));\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tend = new Date(+new_start + duration);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tend = new Date(scheduler._max_date);\n\n\t\t\t\t\t\tif (pos._ignores && this.config.preserve_length && this._table_view){\n\t\t\t\t\t\t\tif(obj._end_correction)\n\t\t\t\t\t\t\t\tend = new Date(end.valueOf() - obj._end_correction);\n\t\t\t\t\t\t\tend = new Date(end*1 - this._get_fictional_event_length(end, 0, obj, true));\n\t\t\t\t\t\t\tnew_start = new Date(end*1 - this._get_fictional_event_length(end, this._drag_event._event_length, obj, true));\n\t\t\t\t\t\t\tif(this._ignores_detected){\n\t\t\t\t\t\t\t\tnew_start = scheduler.date.add(new_start, obj.x_step, obj.x_unit);\n\t\t\t\t\t\t\t\tend = new Date(end*1 - this._get_fictional_event_length(end, 0, obj, true));\n\t\t\t\t\t\t\t\tend = scheduler.date.add(end, obj.x_step, obj.x_unit);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tnew_start = new Date(+end - duration);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tvar new_end = new Date(end-1);\n\t\t\t}\n\n\n\n\t\t\t// fix event dates when resized to bottom of the column (day/week views)\n\t\t\tif(!this._table_view && this._dragEventBody &&\n\t\t\t\t!scheduler.config.all_timed &&\n\t\t\t\t((!scheduler._get_section_view() && pos.x != this._get_event_sday({start_date: new Date(start), end_date:new Date(start)})) || new Date(start).getHours() < this.config.first_hour)){\n\t\t\t\tvar duration = end - new_start;\n\t\t\t\tif (this._drag_mode == \"move\") {\n\t\t\t\t\tvar day = this._min_date.valueOf() + (pos.x * 24 * 60) * 60000;\n\t\t\t\t\tnew_start = new Date(day);\n\t\t\t\t\tnew_start.setHours(this.config.first_hour);\n\t\t\t\t\t//GS-2646: binding to duration\n\t\t\t\t\tif(+new_start <= +ev.start_date){\n\t\t\t\t\t\tend = new Date(+new_start + duration);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnew_start = new Date(+end - duration);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// fix event dates when resized to bottom of the column (day/week views)\n\t\t\tif(!this._table_view &&\n\t\t\t\t!scheduler.config.all_timed &&\n\t\t\t\t((!scheduler.getView() && pos.x != this._get_event_sday({start_date: new Date(end), end_date:new Date(end)})) || new Date(end).getHours() >= this.config.last_hour)){\n\t\t\t\tvar duration = end - new_start;\n\t\t\t\tvar day = this._min_date.valueOf()+(pos.x*24*60)*60000;\n\t\t\t\tend = scheduler.date.date_part(new Date(day));\n\t\t\t\tend.setHours(this.config.last_hour);\n\t\t\t\tnew_end = new Date(end-1);\n\t\t\t\tif(this._drag_mode == \"move\"){\n\t\t\t\t\t//GS-2646: binding to duration\n\t\t\t\t\tif(+new_start <= +ev.start_date){\n\t\t\t\t\t\tend = new Date(+new_start + duration);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnew_start = new Date(+end - duration);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//GS-2649: fix event dates when resized to bottom of the column (all_timed + day/week views)\n\t\t\tif(!this._table_view && scheduler.config.all_timed){\n\t\t\t\tlet day = this._min_date.valueOf()+(pos.x*24*60)*60000;\n\t\t\t\tif(new Date(scheduler._drag_start).getDay() != new Date(day)){\n\t\t\t\t\tday = new Date(scheduler._drag_start);\n\t\t\t\t}\n\t\t\t\tlet tempBorderBottomDate = new Date(day).setHours(this.config.last_hour);\n\t\t\t\tif (scheduler._drag_start && this._drag_mode == \"new-size\" && tempBorderBottomDate < new Date(end)){\n\t\t\t\t\tend = scheduler.date.date_part(new Date(day));\n\t\t\t\t\tend.setHours(this.config.last_hour);\n\t\t\t\t\tnew_end = new Date(end-1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//GS-2225: prevent out-of-borders situation for timeline with ignore_timeline\n\t\t\tif(this._table_view && scheduler[\"ignore_\"+this._mode] && (this._drag_mode==\"resize\" || this._drag_mode==\"new-size\") && +end > +scheduler._max_date){\n\t\t\t\tend = new Date(scheduler._max_date);\n\t\t\t\tconst ignore = this[\"ignore_\"+this._mode];\n\t\t\t\twhile (ignore(end)){\n\t\t\t\t\tend = scheduler.date.add(end, -obj.x_step, obj.x_unit);\n\t\t\t\t}\n\t\t\t\tend = scheduler.date.add(end, obj.x_step, obj.x_unit);\n\t\t\t}\n\n\t\t\t//prevent out-of-borders situation for day|week view\n\t\t\tif ( this._table_view || (new_end.getDate()==new_start.getDate() && new_end.getHours()<this.config.last_hour) || scheduler._allow_dnd ){\n\t\t\t\tev.start_date=new_start;\n\t\t\t\tev.end_date=new Date(end);\n\t\t\t\tif (this.config.update_render){\n\t\t\t\t\t//fix for repaint after dnd and scroll issue, #231\n\t\t\t\t\tvar sx = scheduler._els[\"dhx_cal_data\"][0].scrollTop;\n\t\t\t\t\tthis.update_view();\n\t\t\t\t\tscheduler._els[\"dhx_cal_data\"][0].scrollTop = sx;\n\t\t\t\t} else\n\t\t\t\t\tthis.updateEvent(this._drag_id);\n\t\t\t}\n\t\t\tif (this._table_view) {\n\t\t\t\tthis.for_rendered(this._drag_id,function(r){\n\t\t\t\t\tr.className+=\" dhx_in_move dhx_cal_event_drag\";\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onEventDrag\", [this._drag_id, this._drag_mode, e]);\n\t\t}\n\t}  else {\n\t\tif (scheduler.checkEvent(\"onMouseMove\")){\n\t\t\tvar id = this._locate_event(e.target||e.srcElement);\n\t\t\tthis.callEvent(\"onMouseMove\",[id,e]);\n\t\t}\n\t}\n};\nscheduler._on_mouse_down=function(e,src) {\n\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\n\t// let's ignore right mouse button then\n\tif (e.button == 2)\n\t\treturn;\n\n\tif (this.config.readonly || this._drag_mode) return;\n\tsrc = src||(e.target||e.srcElement);\n\tvar classname = scheduler._getClassName(src).split(\" \")[0];\n\n\tif (this.config.drag_event_body && classname == \"dhx_body\") {\n\t\tif(src.parentNode && src.parentNode.className.indexOf(\"dhx_cal_select_menu\") === -1){\n\t\t\tclassname = \"dhx_event_move\";\n\t\t\tthis._dragEventBody = true;\n\t\t}\n\t}\n\n\tswitch (classname) {\n\t\tcase \"dhx_cal_event_line\":\n\t\tcase \"dhx_cal_event_clear\":\n\t\t\tif (this._table_view)\n\t\t\t\tthis._drag_mode=\"move\"; //item in table mode\n\t\t\tbreak;\n\t\tcase \"dhx_event_move\":\n\t\tcase \"dhx_wa_ev_body\":\n\t\t\tthis._drag_mode=\"move\";\n\t\t\tbreak;\n\t\tcase \"dhx_event_resize\":\n\t\t\tthis._drag_mode=\"resize\";\n\t\t\tvar fullClass = scheduler._getClassName(src);\n\t\t\tif((fullClass).indexOf(\"dhx_event_resize_end\") < 0){\n\t\t\t\tscheduler._drag_from_start = true;\n\t\t\t}else{\n\t\t\t\tscheduler._drag_from_start = false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"dhx_scale_holder\":\n\t\tcase \"dhx_scale_holder_now\":\n\t\tcase \"dhx_month_body\":\n\t\tcase \"dhx_matrix_cell\":\n\t\tcase \"dhx_marked_timespan\":\n\t\t\tthis._drag_mode=\"create\";\n\t\t\tbreak;\n\t\tcase \"\":\n\t\t\tif (src.parentNode)\n\t\t\t\treturn scheduler._on_mouse_down(e,src.parentNode);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (!scheduler.checkEvent(\"onMouseDown\") || scheduler.callEvent(\"onMouseDown\", [classname, e])) {\n\t\t\t\tif (src.parentNode && src != this && classname != \"dhx_body\") {\n\t\t\t\t\treturn scheduler._on_mouse_down(e,src.parentNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._drag_mode=null;\n\t\t\tthis._drag_id=null;\n\t\t\tbreak;\n\t}\n\tif (this._drag_mode){\n\t\tvar id = this._locate_event(src);\n\t\tif (!this.config[\"drag_\"+this._drag_mode] || !this.callEvent(\"onBeforeDrag\",[id, this._drag_mode, e]))\n\t\t\tthis._drag_mode=this._drag_id=0;\n\t\telse {\n\t\t\tthis._drag_id= id;\n\n\t\t\tif (this._edit_id!=this._drag_id || (this._edit_id && this._drag_mode == \"create\"))\n\t\t\t\tthis._close_not_saved();\n\t\t\tif(!this._drag_mode)\n\t\t\t\treturn;\n\n\t\t\tthis._drag_event = scheduler._lame_clone(this.getEvent(this._drag_id) || {});\n\t\t\tthis._drag_pos = this._mouse_coords(e);\n\t\t}\n\t}\n\tthis._drag_start=null;\n};\n\n\nscheduler._get_private_properties = function(event){\n\tvar fields = {};\n\tfor(var i in event){\n\t\tif(i.indexOf(\"_\") === 0){\n\t\t\tfields[i] = true;\n\t\t}\n\t}\n\treturn fields;\n};\nscheduler._clear_temporary_properties = function(clean, flagged_event){\n\tvar initial = this._get_private_properties(clean);\n\tvar current_state = this._get_private_properties(flagged_event);\n\tfor(var i in current_state){\n\t\tif(!initial[i]){\n\t\t\tdelete flagged_event[i];\n\t\t}\n\t}\n};\n\n\nscheduler._on_mouse_up=function(e){\n\tif (e && e.button == 2 && this._mobile) return;\n\tif (this._drag_mode && this._drag_id){\n\t\tthis._els[\"dhx_cal_data\"][0].style.cursor=\"default\";\n\t\t//drop\n\n\t\tvar drag_id = this._drag_id;\n\t\tvar mode = this._drag_mode;\n\n\t\tvar moved = !this._drag_pos || this._drag_pos.has_moved;\n\t\tdelete this._drag_event._move_event_shift;\n\n\t\tvar ev=this.getEvent(this._drag_id);\n\t\tif (moved && (this._drag_event._dhx_changed || !this._drag_event.start_date || ev.start_date.valueOf()!=this._drag_event.start_date.valueOf() || ev.end_date.valueOf()!=this._drag_event.end_date.valueOf())){\n\t\t\tvar is_new=(this._drag_mode==\"new-size\");\n\t\t\tif (!this.callEvent(\"onBeforeEventChanged\",[ev, e, is_new, this._drag_event])){\n\t\t\t\tif (is_new)\n\t\t\t\t\tthis.deleteEvent(ev.id, true);\n\t\t\t\telse {\n\t\t\t\t\tthis._drag_event._dhx_changed = false;\n\t\t\t\t\tthis._clear_temporary_properties(ev, this._drag_event);\n\t\t\t\t\tscheduler._lame_copy(ev, this._drag_event);\n\t\t\t\t\tthis.updateEvent(ev.id);\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tthis._drag_id = this._drag_mode = null;\n\t\t\t\tif (is_new && this.config.edit_on_create){\n\t\t\t\t\tthis.unselect();\n\t\t\t\t\tthis._new_event=new Date();//timestamp of creation\n\t\t\t\t\t//if selection disabled - force lightbox usage\n\t\t\t\t\tif (this._table_view || this.config.details_on_create || !this.config.select || !this.isOneDayEvent(this.getEvent(drag_id))) {\n\t\t\t\t\t\tscheduler.callEvent(\"onDragEnd\", [drag_id, mode, e]);\n\t\t\t\t\t\treturn this.showLightbox(drag_id);\n\t\t\t\t\t}\n\t\t\t\t\tthis._drag_pos = true; //set flag to trigger full redraw\n\t\t\t\t\tthis._select_id = this._edit_id = drag_id;\n\t\t\t\t} else {\n\t\t\t\t\tif (!this._new_event)\n\t\t\t\t\t\tthis.callEvent(is_new?\"onEventAdded\":\"onEventChanged\",[drag_id,this.getEvent(drag_id)]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this._drag_pos && (this._drag_pos.has_moved || this._drag_pos === true)) {\n\t\t\tthis._drag_id = this._drag_mode = null; // set null to prevent _sorder recalculation for drag event\n\t\t\tthis.render_view_data(); //redraw even if there is no real changes - necessary for correct positioning item after drag\n\t\t}\n\t\tscheduler.callEvent(\"onDragEnd\", [drag_id, mode, e]);\n\t}\n\tthis._drag_id = null;\n\tthis._drag_mode=null;\n\tthis._drag_pos=null;\n\tthis._drag_event = null;\n\tthis._drag_from_start = null;\n};\n\nscheduler._trigger_dyn_loading = function(){\n\tif (this._load_mode && this._load()){\n\t\tthis._render_wait = true;\n\t\treturn true;\n\t}else{\n\t\treturn false;\n\t}\n};\nscheduler.update_view=function(){\n\tthis._reset_ignores();\n\tthis._update_nav_bar(\n\t\tthis.config.header,\n\t\tthis.$container.querySelector(\".dhx_cal_navline\"));\n\n\tvar view = this[this._mode + \"_view\"];\n\tif(view){\n\t\tview.call(this, true);\n\t}else{\n\t\tthis._reset_scale();\n\t}\n\n\tif (this._trigger_dyn_loading()){\n\t\treturn true;\n\t}\n\tthis.render_view_data();\n};\n\nscheduler.isViewExists = function(mode){\n\treturn !!(scheduler[mode+ \"_view\"] ||\n\t\t(scheduler.date[mode+ \"_start\"] && scheduler.templates[mode+ \"_date\"] && scheduler.templates[mode+ \"_scale_date\"]));\n};\n\nscheduler._set_aria_buttons_attrs = function(){\n\tvar buttonGroups = [\"dhx_cal_next_button\", \"dhx_cal_prev_button\", \"dhx_cal_tab\", \"dhx_cal_today_button\"];\n\tfor(var i = 0; i < buttonGroups.length; i++){\n\t\tvar group = this._els[buttonGroups[i]];\n\t\tfor(var j = 0; group && j < group.length; j++ ){\n\t\t\tvar name = group[j].getAttribute(\"data-tab\") || group[j].getAttribute(\"name\");\n\t\t\tvar label = this.locale.labels[buttonGroups[i]];\n\t\t\tif(name){\n\t\t\t\tlabel = this.locale.labels[name + \"_tab\"] || this.locale.labels[name] || label;\n\t\t\t}\n\t\t\tif(buttonGroups[i] == \"dhx_cal_next_button\"){\n\t\t\t\tlabel = this.locale.labels.next;\n\t\t\t}else if(buttonGroups[i] == \"dhx_cal_prev_button\"){\n\t\t\t\tlabel = this.locale.labels.prev;\n\t\t\t}\n\t\t\tthis._waiAria.headerButtonsAttributes(group[j], label || \"\");\n\t\t}\n\t}\n};\n\nscheduler.updateView = function(date, mode) {\n\n\tif (!this.$container) {\n\t\tthrow new Error(\"The scheduler is not initialized. \\n **scheduler.updateView** or **scheduler.setCurrentView** can be called only after **scheduler.init**\");\n\t}\n\n\tdate = date || this._date;\n\tmode = mode || this._mode;\n\tvar dhx_cal_data = 'dhx_cal_data';\n\n\tif(!this.locale.labels.icon_form){\n\t\tthis.locale.labels.icon_form = this.locale.labels.icon_edit;\n\t}\n\n\tvar container = this._obj;\n\tvar oldClass = \"dhx_scheduler_\" + this._mode;\n\tvar newClass = \"dhx_scheduler_\" + mode;\n\n\tif (!this._mode || (container.className.indexOf(oldClass) == -1)){\n\t\tcontainer.className += \" \" + newClass;\n\t} else {\n\t\tcontainer.className = container.className.replace(oldClass, newClass);\n\t}\n\n\tvar dhx_multi_day = 'dhx_multi_day';\n\n\tvar prev_scroll = (this._mode == mode && this.config.preserve_scroll) ? this._els[dhx_cal_data][0].scrollTop : false; // saving current scroll\n\n\tvar multidayScroll;\n\tif(this._els[dhx_multi_day] && this._els[dhx_multi_day][0]){\n\t\tmultidayScroll = this._els[dhx_multi_day][0].scrollTop;\n\t}\n\n\t//hide old custom view\n\tif (this[this._mode + \"_view\"] && mode && this._mode != mode)\n\t\tthis[this._mode + \"_view\"](false);\n\n\tthis._close_not_saved();\n\n\tif (this._els[dhx_multi_day]) {\n\t\tthis._els[dhx_multi_day][0].parentNode.removeChild(this._els[dhx_multi_day][0]);\n\t\tthis._els[dhx_multi_day] = null;\n\t}\n\n\tthis._mode = mode;\n\tthis._date = date;\n\tthis._table_view = (this._mode == \"month\");\n\n\tthis._dy_shift = 0;//correction for multiday section in week/day views\n\n\t//show new view\n\tthis.update_view();\n\n\tthis._set_aria_buttons_attrs();\n\n\tvar tabs = this._els[\"dhx_cal_tab\"];\n\tif(tabs){//calendar can work without view tabs\n\t\tfor (var i = 0; i < tabs.length; i++) {\n\t\t\tvar tab = tabs[i];\n\n\t\t\tif (tab.getAttribute(\"data-tab\") == this._mode || tab.getAttribute(\"name\") == this._mode + \"_tab\"){\n\t\t\t\ttab.classList.add(\"active\");\n\t\t\t\tthis._waiAria.headerToggleState(tab, true);\n\t\t\t}else{\n\t\t\t\ttab.classList.remove(\"active\");\n\t\t\t\tthis._waiAria.headerToggleState(tab, false);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (typeof prev_scroll == \"number\") // if we are updating or working with the same view scrollTop should be saved\n\t\tthis._els[dhx_cal_data][0].scrollTop = prev_scroll; // restoring original scroll\n\n\tif(typeof multidayScroll == \"number\" && this._els[dhx_multi_day] && this._els[dhx_multi_day][0]){\n\t\tthis._els[dhx_multi_day][0].scrollTop = multidayScroll;\n\t}\n\n};\nscheduler.setCurrentView = function(date, mode) {\n\tif (!this.callEvent(\"onBeforeViewChange\", [this._mode, this._date, mode || this._mode, date || this._date])) return;\n\tthis.updateView(date, mode);\n\tthis.callEvent(\"onViewChange\", [this._mode, this._date]);\n};\n\nscheduler.render = function(date, mode){\n\tscheduler.setCurrentView(date, mode);\n};\n\nscheduler._render_x_header = function(i,left,date,container, offset_top){\n\toffset_top = offset_top || 0;\n\t//header scale\n\tvar head=document.createElement(\"div\");\n\thead.className = \"dhx_scale_bar\";\n\n\tif(this.templates[this._mode+\"_scalex_class\"]){\n\t\t//GS-2314: '_scalex_class' - timeline has similar template, use the same name\n\t\thead.className += ' ' + this.templates[this._mode+\"_scalex_class\"](date);\n\t}\n\n\tvar width = this._cols[i];\n\n\tif (this._mode == \"month\" && i === 0 && this.config.left_border) {\n\t\thead.className += \" dhx_scale_bar_border\";\n\t\tleft = left+1;\n\t}\n\n\tthis.set_xy(head, width, this.xy.scale_height-1, left, offset_top);\n\n\tvar columnHeaderText = this.templates[this._mode+\"_scale_date\"](date,this._mode); //TODO - move in separate method\n\thead.innerHTML = columnHeaderText;\n\n\tthis._waiAria.dayHeaderAttr(head, columnHeaderText);\n\n\tcontainer.appendChild(head);\n};\n\nscheduler._get_columns_num = function(from, to){\n\tvar count = 7;\n\tif (!scheduler._table_view){\n\t\tvar count_n = scheduler.date[\"get_\"+scheduler._mode+\"_end\"];\n\t\tif (count_n) to = count_n(from);\n\t\tcount = Math.round((to.valueOf()-from.valueOf())/(1000*60*60*24));\n\t}\n\treturn count;\n};\nscheduler._get_timeunit_start = function(){\n\t//start date of currently displayed time unit(day, week,...)\n\treturn this.date[this._mode+\"_start\"](new Date(this._date.valueOf()));\n};\n\nscheduler._get_view_end = function(){\n\tvar dd = this._get_timeunit_start();\n\tvar ed = scheduler.date.add(dd, 1, this._mode);\n\tif (!scheduler._table_view){\n\t\tvar count_n = scheduler.date[\"get_\"+scheduler._mode+\"_end\"];\n\t\tif (count_n) ed = count_n(dd);\n\t}\n\treturn ed;\n};\nscheduler._calc_scale_sizes = function(width, from, to){//\n\t//calculates number of displayed columns(days/units/month view cols) and their widths\n\tvar rtl = this.config.rtl;\n\tvar summ = width; //border delta\n\tvar count = this._get_columns_num(from, to);\n\t//if (this.config.rtl) this._process_ignores(scheduler.date.add(to, -1, \"day\"), count, \"day\", -1);\n\t//else\n\tthis._process_ignores(from, count, \"day\", 1);\n\tvar realcount = count - this._ignores_detected;\n\tfor (var i=0; i<count; i++){\n\t\tif (this._ignores[i]){\n\t\t\tthis._cols[i] = 0;\n\t\t\trealcount++;\n\t\t} else {\n\t\t\tthis._cols[i]=Math.floor(summ/(realcount-i));\n\t\t}\n\t\tsumm-=this._cols[i];\n\t\tthis._colsS[i]=(this._cols[i-1]||0)+(this._colsS[i-1]||(this._table_view?0:(rtl ? this.xy.scroll_width : this.xy.scale_width)));\n\t\t//this._colsS[j]=(this._cols[rtl ? j+1 : (i-1)]||0)+(this._colsS[rtl ? j+1 : (i-1)]||(this._table_view?0:(rtl?this.xy.scroll_width:this.xy.scale_width)+2));\n\t}\n\tthis._colsS['col_length'] = count;\n\tthis._colsS[count] = (this._cols[count-1]+this._colsS[count-1]) || 0;\n\t//this._colsS[count] = (this._cols[rtl ? 0 : count-1]+this._colsS[rtl ? 0 : count-1]) || 0;\n};\n\nscheduler._set_scale_col_size = function(div, width, left){\n\tvar c = this.config;\n\tthis.set_xy(div, width, c.hour_size_px*(c.last_hour-c.first_hour), left+this.xy.scale_width + 1, 0);//-1 for border\n};\n\nscheduler._render_scales = function(header, data_area){\n\t//render columns in week/units view, or header in month view\n\tvar sd = new Date(scheduler._min_date),\n\t\ted = new Date(scheduler._max_date),\n\t\ttoday = this.date.date_part( scheduler._currentDate());\n\n\tvar summ = parseInt(header.style.width,10) - 1;\n\tvar d = new Date(this._min_date);\n\t// if (this.config.rtl) {\n\t// \td = new Date(scheduler.date.add(this._max_date, -1, \"day\"));\n\t// }\n\tvar count = this._get_columns_num(sd, ed);\n\tthis._calc_scale_sizes(summ, sd, ed);\n\tvar left=0;\n\n\theader.innerHTML = \"\";\n\tfor (var i=0; i<count; i++){\n\t\tif (!this._ignores[i]){\n\t\t\tthis._render_x_header(i,left,d,header);\n\t\t}\n\t\tif (!this._table_view){\n\t\t\tvar scales=document.createElement(\"div\");\n\t\t\tvar cls = \"dhx_scale_holder\";\n\t\t\tif (d.valueOf() == today.valueOf()) cls += \" dhx_scale_holder_now\";\n\n\t\t\tscales.setAttribute(\"data-column-index\", i);\n\t\t\tif (this._ignores_detected && this._ignores[i]){\n\t\t\t\tcls += \" dhx_scale_ignore\";\n\t\t\t}\n\n\t\t\tfor (let i=this.config.first_hour*1; i < this.config.last_hour; i++) {\n\t\t\t\tconst firstHalf = document.createElement(\"div\");\n\t\t\t\tfirstHalf.className=\"dhx_scale_time_slot dhx_scale_time_slot_hour_start\";\n\t\t\t\tfirstHalf.style.height=this.config.hour_size_px/2+\"px\";\n\t\t\t\t\n\t\t\t\tlet slotDate = new Date(d.getFullYear(), d.getMonth(), d.getDate(), i, 0);\n\t\t\t\tfirstHalf.setAttribute('data-slot-date', this.templates.format_date(slotDate));\n\n\t\t\t\tlet htmlContent = this.templates.time_slot_text(slotDate);\n\t\t\t\tif(htmlContent){\n\t\t\t\t\tfirstHalf.innerHTML = htmlContent;\n\t\t\t\t}\n\t\t\t\tlet cssClass = this.templates.time_slot_class(slotDate);\n\t\t\t\tif(cssClass){\n\t\t\t\t\tfirstHalf.classList.add(cssClass);\n\t\t\t\t}\n\n\t\t\t\tscales.appendChild(firstHalf);\n\n\t\t\t\tconst secondHalf = document.createElement(\"div\");\n\t\t\t\tsecondHalf.className=\"dhx_scale_time_slot\";\n\t\t\t\tslotDate = new Date(d.getFullYear(), d.getMonth(), d.getDate(), i, 30);\n\t\t\t\tsecondHalf.setAttribute('data-slot-date', this.templates.format_date(slotDate));\n\t\t\t\tsecondHalf.style.height=this.config.hour_size_px/2+\"px\";\n\t\t\t\thtmlContent = this.templates.time_slot_text(slotDate);\n\t\t\t\tif(htmlContent){\n\t\t\t\t\tsecondHalf.innerHTML = htmlContent;\n\t\t\t\t}\n\t\t\t\tcssClass = this.templates.time_slot_class(slotDate);\n\t\t\t\tif(cssClass){\n\t\t\t\t\tsecondHalf.classList.add(cssClass);\n\t\t\t\t}\n\t\t\t\tscales.appendChild(secondHalf);\n\t\t\t}\n\n\t\t\tscales.className = cls+\" \"+this.templates.week_date_class(d,today);\n\t\t\tthis._waiAria.dayColumnAttr(scales, d);\n\t\t\tthis._set_scale_col_size(scales, this._cols[i], left);\n\n\t\t\tdata_area.appendChild(scales);\n\t\t\tthis.callEvent(\"onScaleAdd\",[scales, d]);\n\t\t}\n\t\tleft+=this._cols[i];\n\t\t//if (this.config.rtl) d=this.date.add(d,-1,\"day\");\n\t\t//else\n\t\td=this.date.add(d,1,\"day\");\n\t\td = this.date.day_start(d);\n\t}\n};\n\nscheduler._getNavDateElement = function(){\n\treturn this.$container.querySelector(\".dhx_cal_date\");\n};\n\nscheduler._reset_scale=function(){\n\t//current mode doesn't support scales\n\t//we mustn't call reset_scale for such modes, so it just to be sure\n\tif (!this.templates[this._mode + \"_date\"]) return;\n\n\tvar header = this._els[\"dhx_cal_header\"][0];\n\tvar data_area = this._els[\"dhx_cal_data\"][0];\n\tvar c = this.config;\n\n\theader.innerHTML = \"\";\n\t//data_area.scrollTop = 0; //fix flickering in FF; makes IE8 flicker instead\n\tdata_area.innerHTML = \"\";\n\n\tvar str = ((c.readonly || (!c.drag_resize)) ? \" dhx_resize_denied\" : \"\") + ((c.readonly || (!c.drag_move)) ? \" dhx_move_denied\" : \"\");\n\tdata_area.className = \"dhx_cal_data\" + str;\n\n\tthis._scales = {};\n\tthis._cols = [];\t//store for data section\n\tthis._colsS = {height: 0};\n\tthis._dy_shift = 0;\n\n\tthis.set_sizes();\n\n\tvar d,sd;\n\tvar dd = this._get_timeunit_start(),\n\t\ted = scheduler._get_view_end();\n\n\td = sd = this._table_view ? scheduler.date.week_start(dd) : dd;\n\n\n\tthis._min_date=d;\n\n\tvar navBarDateStr = this.templates[this._mode+\"_date\"](dd,ed,this._mode);\n\n\tvar scaleElement = this._getNavDateElement();\n\tif(scaleElement){\n\t\tscaleElement.innerHTML = navBarDateStr;\n\t\tthis._waiAria.navBarDateAttr(scaleElement, navBarDateStr);\n\t}\n\n\tthis._max_date = ed;\n\tscheduler._render_scales(header, data_area);\n\n\tif (this._table_view) // month view\n\t\tthis._reset_month_scale(data_area,dd,sd);\n\telse{\n\t\tthis._reset_hours_scale(data_area,dd,sd);\n\t\tif (c.multi_day) {\n\t\t\tvar dhx_multi_day = 'dhx_multi_day';\n\n\t\t\tif(this._els[dhx_multi_day]) {\n\t\t\t\tthis._els[dhx_multi_day][0].parentNode.removeChild(this._els[dhx_multi_day][0]);\n\t\t\t\tthis._els[dhx_multi_day] = null;\n\t\t\t}\n\n\t\t\tvar c1 = document.createElement(\"div\");\n\t\t\tc1.className = dhx_multi_day;\n\t\t\tc1.style.visibility=\"hidden\";\n\t\t\tc1.style.display=\"none\";\n\t\t\tvar totalWidth = this._colsS[this._colsS.col_length];\n\t\t\tvar offset = c.rtl ? this.xy.scale_width : this.xy.scroll_width;\n\t\t\tvar hiddenWidth = Math.max(totalWidth + offset, 0);\n\t\t\tthis.set_xy(c1, hiddenWidth, 0, 0); // 2 extra borders, dhx_header has -1 bottom margin\n\t\t\tdata_area.parentNode.insertBefore(c1,data_area);\n\n\t\t\tvar c2 = c1.cloneNode(true);\n\t\t\tc2.className = dhx_multi_day+\"_icon\";\n\t\t\tc2.style.visibility=\"hidden\";\n\t\t\tc2.style.display=\"none\";\n\t\t\tthis.set_xy(c2, this.xy.scale_width + 1, 0, 0); // dhx_header has -1 bottom margin\n\n\t\t\tc1.appendChild(c2);\n\t\t\tthis._els[dhx_multi_day]=[c1,c2];\n\t\t\tscheduler.event(this._els[dhx_multi_day][0], \"click\", this._click.dhx_cal_data);\n\t\t}\n\t}\n};\nscheduler._reset_hours_scale=function(b,dd,sd){\n\tvar c=document.createElement(\"div\");\n\tc.className=\"dhx_scale_holder\";\n\n\tvar date = new Date(1980,1,1,this.config.first_hour,0,0);\n\tfor (var i=this.config.first_hour*1; i < this.config.last_hour; i++) {\n\t\tvar cc=document.createElement(\"div\");\n\t\tcc.className=\"dhx_scale_hour\";\n\t\tcc.style.height=this.config.hour_size_px+\"px\";\n\t\tvar width = this.xy.scale_width;\n\t\tif (this.config.left_border) {\n\t\t\tcc.className += \" dhx_scale_hour_border\";\n\t\t}\n\t\tcc.style.width = width + \"px\";\n\n\t\tvar content = scheduler.templates.hour_scale(date);\n\t\tcc.innerHTML = content;\n\t\tthis._waiAria.hourScaleAttr(cc, content);\n\n\t\tc.appendChild(cc);\n\t\tdate=this.date.add(date,1,\"hour\");\n\t}\n\tb.appendChild(c);\n\tif (this.config.scroll_hour)\n\t\tb.scrollTop = this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour);\n};\n\nscheduler._currentDate = function(){\n\tif(scheduler.config.now_date){\n\t\treturn new Date(scheduler.config.now_date);\n\t}\n\treturn new Date();\n};\n\nscheduler._reset_ignores = function(){\n\tthis._ignores={};\n\tthis._ignores_detected = 0;\n};\n\nscheduler._process_ignores = function(sd, n, mode, step, preserve){\n\tthis._reset_ignores();\n\tvar ignore = scheduler[\"ignore_\"+this._mode];\n\tif (ignore){\n\t\tvar ign_date = new Date(sd);\n\t\tfor (var i=0; i<n; i++){\n\t\t\tif (ignore(ign_date)){\n\t\t\t\tthis._ignores_detected += 1;\n\t\t\t\tthis._ignores[i] = true;\n\t\t\t\tif (preserve)\n\t\t\t\t\tn++;\n\t\t\t}\n\t\t\tign_date = scheduler.date.add(ign_date, step, mode);\n\t\t\tif(scheduler.date[mode + '_start'])\n\t\t\t\tign_date = scheduler.date[mode + '_start'](ign_date);\n\t\t}\n\t}\n};\n\nscheduler._render_month_scale = function(div, dd/*month start*/, sd/*view start*/, rows ){\n\t//renders month view layout\n\n\tvar ed=scheduler.date.add(dd,1,\"month\"),\n\t\tview_start = new Date(sd);\n\tvar cd = scheduler._currentDate();\n\t// GS-2801: since v7.2 date functions are now non-mutating \n\tcd = this.date.date_part(cd);\n\tsd = this.date.date_part(sd);\n\n\trows = rows || Math.ceil(Math.round((ed.valueOf()-sd.valueOf()) / (60*60*24*1000) ) / 7);\n\tvar tdwidths=[];\n\n\tfor (var i=0; i<=7; i++) {\n\t\tvar cell_width = this._cols[i] || 0;\n\t\tif(!isNaN(Number(cell_width))){\n\t\t\tcell_width = cell_width + \"px\";\n\t\t}\n\t\ttdwidths[i] = cell_width;\n\t}\n\n\tfunction getCellHeight(row){\n\t\tvar h = scheduler._colsS.height;\n\t\tif(scheduler._colsS.heights[row + 1] !== undefined ){\n\t\t\th = scheduler._colsS.heights[row + 1] - (scheduler._colsS.heights[row]||0);\n\t\t}\n\t\treturn h;\n\t}\n\n\n\tvar cellheight = 0;\n\n\tconst table = document.createElement(\"div\");\n\ttable.classList.add(\"dhx_cal_month_table\");\n\n\tvar rendered_dates = [];\n\tfor (var i=0; i<rows; i++){\n\t\tvar row = document.createElement(\"div\");\n\t\trow.classList.add(\"dhx_cal_month_row\");\n\t\trow.style.height = getCellHeight(i) + \"px\";\n\t\ttable.appendChild(row);\n\t\t// var row_height = Math.max(getCellHeight(i) - scheduler.xy.month_head_height, 0);\n\t\tfor (var j=0; j<7; j++) {\n\t\t\tvar cell = document.createElement(\"div\");\n\t\t\trow.appendChild(cell);\n\n\t\t\tvar cls = \"dhx_cal_month_cell\";\n\t\t\tif (sd<dd)\n\t\t\t\tcls += ' dhx_before';\n\t\t\telse if (sd>=ed)\n\t\t\t\tcls += ' dhx_after';\n\t\t\telse if (sd.valueOf()==cd.valueOf())\n\t\t\t\tcls += ' dhx_now';\n\n\t\t\tif (this._ignores_detected && this._ignores[j]){\n\t\t\t\tcls += \" dhx_scale_ignore\";\n\t\t\t}\n\n\t\t\tcell.className = cls + \" \" + this.templates.month_date_class(sd, cd);\n\n\t\t\tcell.setAttribute(\"data-cell-date\", scheduler.templates.format_date(sd));\n\t\t\tvar body_class = \"dhx_month_body\";\n\t\t\tvar head_class = \"dhx_month_head\";\n\t\t\tif (j === 0 && this.config.left_border) {\n\t\t\t\tbody_class += \" dhx_month_body_border\";\n\t\t\t\thead_class += \" dhx_month_head_border\";\n\t\t\t}\n\t\t\tif (!this._ignores_detected || !this._ignores[j]){\n\t\t\t\tcell.style.width = tdwidths[j];\n\t\t\t\tthis._waiAria.monthCellAttr(cell, sd);\n\n\t\t\t\tvar cellHead = document.createElement(\"div\");\n\t\t\t\tcellHead.style.height = scheduler.xy.month_head_height + \"px\";\n\t\t\t\tcellHead.className = head_class;\n\t\t\t\tcellHead.innerHTML = this.templates.month_day(sd);\n\t\t\t\tcell.appendChild(cellHead);\n\n\t\t\t\tvar cellBody = document.createElement(\"div\");\n\t\t\t\tcellBody.className = body_class;\n\t\t\t\t// cellBody.style.height = row_height + \"px\";\n\t\t\t\t// cellBody.style.width = tdwidths[j];\n\t\t\t\tcell.appendChild(cellBody);\n\n\t\t\t} else {\n\t\t\t\tcell.appendChild(document.createElement(\"div\"));\n\t\t\t\tcell.appendChild(document.createElement(\"div\"));\n\t\t\t}\n\t\t\trendered_dates.push(sd);\n\t\t\tvar bf1 = sd.getDate();\n\t\t\tsd=this.date.add(sd,1,\"day\");\n\t\t\tif (sd.getDate() - bf1 > 1)\n\t\t\t\tsd = new Date(sd.getFullYear(), sd.getMonth(), bf1 + 1, 12, 0);\n\t\t}\n\n\t\tscheduler._colsS.heights[i] = cellheight;\n\t\tcellheight += getCellHeight(i);\n\t}\n\n\tthis._min_date = view_start;\n\tthis._max_date = sd;\n\n\tdiv.innerHTML = \"\";\n\tdiv.appendChild(table);\n\n\tthis._scales = {};\n\tvar cells = div.querySelectorAll('[data-cell-date]');\n\tcells.forEach((cell) => {\n\t\tconst date = scheduler.templates.parse_date(cell.getAttribute(\"data-cell-date\"));\n\t\tconst body = cell.querySelector(\".dhx_month_body\");\n\t\tthis._scales[+date] = body;\n\t\tthis.callEvent(\"onScaleAdd\", [this._scales[+date], date]);\n\t});\n\n\treturn this._max_date;\n};\n\nscheduler._reset_month_scale=function(b,dd,sd,rows){\n\t//recalculates rows height and redraws month layout\n\tvar ed=scheduler.date.add(dd,1,\"month\");\n\t// GS-2801: since v7.2 date functions are now non-mutating \n\tsd = this.date.date_part(sd);\n\n\trows = rows || Math.ceil(Math.round((ed.valueOf()-sd.valueOf()) / (60*60*24*1000) ) / 7);\n\n\tvar height = (Math.floor(b.clientHeight/rows) - this.xy.month_head_height);\n\n\tthis._colsS.height = height + this.xy.month_head_height;\n\tthis._colsS.heights = [];\n\n\treturn scheduler._render_month_scale(b, dd, sd, rows);\n\n};\n\nscheduler.getView = function (viewName) {\n\tif (!viewName) {\n\t\tviewName = scheduler.getState().mode;\n\t}\n\tif (scheduler.matrix && scheduler.matrix[viewName]) {\n\t\treturn scheduler.matrix[viewName];\n\t}\n\n\tif (scheduler._props && scheduler._props[viewName]) {\n\t\treturn scheduler._props[viewName];\n\t}\n\n\treturn null;\n};\n\nscheduler.getLabel = function(property, key) {\n\tvar sections = this.config.lightbox.sections;\n\tfor (var i=0; i<sections.length; i++) {\n\t\tif(sections[i].map_to == property) {\n\t\t\tvar options = sections[i].options;\n\t\t\tfor (var j=0; j<options.length; j++) {\n\t\t\t\tif(options[j].key == key) {\n\t\t\t\t\treturn options[j].label;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn \"\";\n};\nscheduler.updateCollection = function(list_name, collection) {\n\tvar list = scheduler.serverList(list_name);\n\tif (!list) return false;\n\tlist.splice(0, list.length);\n\tlist.push.apply(list, collection || []);\n\tscheduler.callEvent(\"onOptionsLoad\", []);\n\tscheduler.resetLightbox();\n\tscheduler.hideCover();\n\treturn true;\n};\nscheduler._lame_clone = function(object, cache) {\n\tvar i, t, result; // iterator, types array, result\n\n\tcache = cache || [];\n\n\tfor (i=0; i<cache.length; i+=2)\n\t\tif(object === cache[i])\n\t\t\treturn cache[i+1];\n\n\tif (object && typeof object == \"object\") {\n\t\tresult = Object.create(object); // preserve prototype methods\n\t\tt = [Array,Date,Number,String,Boolean];\n\t\tfor (i=0; i<t.length; i++) {\n\t\t\tif (object instanceof t[i])\n\t\t\t\tresult = i ? new t[i](object) : new t[i](); // first one is array\n\t\t}\n\t\tcache.push(object, result);\n\t\tfor (i in object) {\n\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\n\t\t\t\tresult[i] = scheduler._lame_clone(object[i], cache);\n\t\t}\n\t}\n\treturn result || object;\n};\nscheduler._lame_copy = function(target, source) {\n\tfor (var key in source) {\n\t\tif (source.hasOwnProperty(key)) {\n\t\t\ttarget[key] = source[key];\n\t\t}\n\t}\n\treturn target;\n};\nscheduler._get_date_from_pos = function(pos) {\n\tvar start=this._min_date.valueOf()+(pos.y*this.config.time_step+(this._table_view?0:pos.x)*24*60)*60000;\n\t//if (this.config.rtl) start=scheduler.date.add(this._max_date, -1, \"day\").valueOf()+(pos.y*this.config.time_step-(this._table_view?0:pos.x)*24*60)*60000;\n\treturn new Date(this._correct_shift(start));\n};\n// n_ev - native event\nscheduler.getActionData = function(n_ev) {\n\tvar pos = this._mouse_coords(n_ev);\n\treturn {\n\t\tdate:this._get_date_from_pos(pos),\n\t\tsection:pos.section\n\t};\n};\nscheduler._focus = function(node, select){\n\tif (node && node.focus){\n\t\tif (this._mobile){\n\t\t\twindow.setTimeout(function(){\n\t\t\t\tnode.focus();\n\t\t\t},10);\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tif (select && node.select && node.offsetWidth) {\n\t\t\t\t\tnode.select();\n\t\t\t\t}\n\t\t\t\tnode.focus();\n\t\t\t} catch (e) {\n\t\t\t}\n\t\t}\n\t}\n};\n\nfunction getDaysDifference(startDate, endDate) {\n\tconst start = new Date(startDate);\n\tconst end = new Date(endDate);\n\tconst differenceInTime = end.getTime() - start.getTime();\n\tconst differenceInDays = differenceInTime / (1000 * 3600 * 24);\n\treturn Math.abs(differenceInDays);\n}\n\n//non-linear scales\nscheduler._get_real_event_length=function(startDate, endDate, config){ // config may be a timeline view or a configuration object\n\tvar eventLength = endDate - startDate;\n\n\t// excludedDuration - duration between [00:00, first_hour] and [last_hour, 23:59]\n\t// var excludedDuration = (config._start_correction + config._end_correction)||0;\n\tvar ignore = this[\"ignore_\"+this._mode];\n\n\tvar startColumnIndex = 0,\n\t\tendColumnIndex;\n\tif (config.render){\n\t\tstartColumnIndex = this._get_date_index(config, startDate);\n\t\tendColumnIndex = this._get_date_index(config, endDate);\n\n\t\tif(startDate.valueOf() < scheduler.getState().min_date.valueOf()){\n\t\t\tstartColumnIndex = -getDaysDifference(startDate, scheduler.getState().min_date);\n\t\t}\n\t\tif(endDate.valueOf() > scheduler.getState().max_date.valueOf()){\n\t\t\tendColumnIndex += getDaysDifference(endDate, scheduler.getState().max_date);\n\t\t}\n\t} else{\n\t\tendColumnIndex = Math.round(eventLength/60/60/1000/24);\n\t}\n\n\tvar last_column = true;\n\twhile (startColumnIndex < endColumnIndex){\n\t\tvar check = scheduler.date.add(endDate, -config.x_step, config.x_unit);\n\t\tif (ignore && ignore(endDate) && (!last_column || (last_column && ignore(check) ))){\n\t\t\teventLength -= (endDate-check);\n\n\t\t}else{\n\t\t\tlet excludedDuration = 0;\n\t\t\tconst intervalStart = new Date(Math.max(check.valueOf(), startDate.valueOf()));\n\t\t\tconst intervalEnd = endDate;\n\t\t\tconst leftCellCutOffStart = new Date(intervalStart.getFullYear(), intervalStart.getMonth(), intervalStart.getDate(), config.first_hour || 0);\n\t\t\tconst leftCellCutOffEnd = new Date(intervalStart.getFullYear(), intervalStart.getMonth(), intervalStart.getDate(), config.last_hour || 24);\n\t\t\tconst rightCellCutOffStart = new Date(endDate.getFullYear(), endDate.getMonth(), endDate.getDate(), config.first_hour || 0);\n\t\t\tconst rightCellCutOffEnd = new Date(endDate.getFullYear(), endDate.getMonth(), endDate.getDate(), config.last_hour || 24);\n\n\t\t\tif(intervalEnd.valueOf() > rightCellCutOffEnd.valueOf()){\n\t\t\t\texcludedDuration += intervalEnd - rightCellCutOffEnd;\n\t\t\t}\n\n\t\t\tif(intervalEnd.valueOf() > rightCellCutOffStart.valueOf()){\n\t\t\t\texcludedDuration += config._start_correction;\n\t\t\t} else {\n\t\t\t\texcludedDuration += intervalEnd.getHours()*60*60*1000 + intervalEnd.getMinutes()*60*1000;\n\t\t\t}\n\t\t\t// GS-2580: if the end date of the events is quals to the last_hour config, need to include that date\n\t\t\tif(intervalStart.valueOf() <= leftCellCutOffEnd.valueOf()){\n\t\t\t\texcludedDuration += config._end_correction;\n\t\t\t}\n\n\t\t\tif(intervalStart.valueOf() < leftCellCutOffStart.valueOf()){\n\t\t\t\texcludedDuration += (leftCellCutOffStart.valueOf() - intervalStart.valueOf());\n\t\t\t}\n\t\t\t\n\n\t\t\teventLength -= excludedDuration;\n\t\t\tlast_column = false;\n\t\t}\n\t\tendDate = check;\n\t\tendColumnIndex--;\n\t}\n\treturn eventLength;\n};\nscheduler._get_fictional_event_length=function(end_date, ev_length, obj, back){\n\tvar sd = new Date(end_date);\n\tvar dir = back ? -1 : 1;\n\n\t//get difference caused by first|last hour\n\tif (obj._start_correction || obj._end_correction){\n\t\tvar today;\n\t\tif (back)\n\t\t\ttoday = (sd.getHours()*60+sd.getMinutes()) - (obj.first_hour||0)*60;\n\t\telse\n\t\t\ttoday = (obj.last_hour||0)*60 - (sd.getHours()*60+sd.getMinutes());\n\t\tvar per_day = (obj.last_hour - obj.first_hour)*60;\n\t\tvar days = Math.ceil( (ev_length / (60*1000) - today ) / per_day);\n\t\tif(days < 0) days = 0;\n\t\tev_length += days * (24*60 - per_day) * 60 * 1000;\n\t}\n\n\tvar fd = new Date(end_date*1+ev_length*dir);\n\tvar ignore = this[\"ignore_\"+this._mode];\n\n\tvar start_slot = 0,\n\t\tend_slot;\n\tif (obj.render){\n\t\tstart_slot = this._get_date_index(obj, sd);\n\t\tend_slot = this._get_date_index(obj, fd);\n\t} else{\n\t\tend_slot = Math.round(ev_length/60/60/1000/24);\n\t}\n\t// GS-2159: workaround for timeline with round_position and ignore_timeline\n\tfunction condition() {\n\t\tconst isDayUnit = obj.x_unit === \"day\";\n    return isDayUnit ? start_slot * dir < end_slot * dir : start_slot * dir <= end_slot * dir ;\n\t}\n\twhile (condition()){\n\t\tvar check = scheduler.date.add(sd, obj.x_step*dir, obj.x_unit);\n\t\tif (ignore && ignore(sd)){\n\t\t\tev_length += (check-sd)*dir;\n\t\t\tend_slot += dir;\n\t\t}\n\n\t\tsd = check;\n\t\tstart_slot+=dir;\n\t}\n\n\treturn ev_length;\n};\n\nscheduler._get_section_view = function(){\n\treturn this.getView();\n};\n\nscheduler._get_section_property = function(){\n\tif(this.matrix && this.matrix[this._mode]){\n\t\treturn this.matrix[this._mode].y_property;\n\t}else if(this._props && this._props[this._mode]){\n\t\treturn this._props[this._mode].map_to;\n\t}\n\treturn null;\n};\n\nscheduler._is_initialized = function(){\n\tvar state = this.getState();\n\treturn (this._obj && state.date && state.mode);\n};\nscheduler._is_lightbox_open = function(){\n\tvar state = this.getState();\n\treturn state.lightbox_id !== null && state.lightbox_id !== undefined;\n};\n\n}","export default function extend(scheduler) {\n\n(function(){\n\n\t// eslint-disable-next-line no-control-regex\n\tvar htmlTags = new RegExp(\"<(?:.|\\n)*?>\", \"gm\");\n\tvar extraSpaces = new RegExp(\" +\", \"gm\");\n\n\tfunction stripHTMLLite(htmlText){\n\t\treturn (htmlText + \"\")\n\t\t\t.replace(htmlTags, \" \").\n\t\t\treplace(extraSpaces, \" \");\n\t}\n\n\tvar singleQuotes = new RegExp(\"'\", \"gm\");\n\tfunction escapeQuotes(text){\n\t\treturn (text + \"\").replace(singleQuotes, \"&#39;\");\n\t}\n\n\tscheduler._waiAria = {\n\t\tgetAttributeString: function(attr){\n\t\t\tvar attributes = [\" \"];\n\t\t\tfor(var i in attr){\n\t\t\t\tif(typeof attr[i] != \"function\" && typeof attr[i] != \"object\") {\n\t\t\t\t\tvar text = escapeQuotes(stripHTMLLite(attr[i]));\n\t\t\t\t\tattributes.push(i + \"='\" + text + \"'\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tattributes.push(\" \");\n\t\t\treturn attributes.join(\" \");\n\t\t},\n\t\tsetAttributes: function(div, values){\n\t\t\tfor(var i in values){\n\t\t\t\tdiv.setAttribute(i, stripHTMLLite(values[i]));\n\t\t\t}\n\t\t\treturn div;\n\t\t},\n\n\t\tlabelAttr: function(div, content){\n\t\t\treturn this.setAttributes(div, {\"aria-label\": content});\n\t\t},\n\t\tlabel: function(label){\n\t\t\treturn scheduler._waiAria.getAttributeString({\"aria-label\": label});\n\t\t},\n\n\t\t// day/week/units\n\n\t\thourScaleAttr: function(div, content){\n\t\t\tthis.labelAttr(div, content);\n\n\t\t},\n\t\tmonthCellAttr: function(div, date){\n\t\t\tthis.labelAttr(div, scheduler.templates.day_date(date));\n\t\t},\n\n\t\tnavBarDateAttr: function(div, content){\n\t\t\tthis.labelAttr(div, content);\n\t\t},\n\t\tdayHeaderAttr: function(div, content){\n\t\t\tthis.labelAttr(div, content);\n\t\t},\n\n\t\tdayColumnAttr: function(div, date){\n\t\t\tthis.dayHeaderAttr(div, scheduler.templates.day_date(date));\n\t\t},\n\n\t\theaderButtonsAttributes: function(div, label){\n\t\t\treturn this.setAttributes(div, {\"role\":\"button\", \"aria-label\":label});\n\t\t},\n\n\t\theaderToggleState: function(div, isActive){\n\t\t\treturn this.setAttributes(div, {\"aria-pressed\": isActive ? \"true\" : \"false\"});\n\t\t},\n\n\n\t\tgetHeaderCellAttr:function(dateString){\n\n\t\t\treturn scheduler._waiAria.getAttributeString({\"aria-label\": dateString});\n\t\t},\n\n\n\t\teventAttr: function(event, div){\n\t\t\tthis._eventCommonAttr(event, div);\n\t\t},\n\n\n\t\t_eventCommonAttr: function(event, div){\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(scheduler.templates.event_text(event.start_date, event.end_date, event)));\n\n\t\t\tif(scheduler.config.readonly){\n\t\t\t\tdiv.setAttribute(\"aria-readonly\", true);\n\n\t\t\t}\n\n\t\t\tif(event.$dataprocessor_class){\n\t\t\t\tdiv.setAttribute(\"aria-busy\", true);\n\t\t\t}\n\n\n\t\t\tdiv.setAttribute(\"aria-selected\",\n\t\t\t\t(scheduler.getState().select_id == event.id) ? \"true\" : \"false\");\n\t\t},\n\n\t\tsetEventBarAttr: function(event, div){\n\t\t\tthis._eventCommonAttr(event, div);\n\t\t},\n\n\t\t_getAttributes: function(attributeSetter, arg){\n\t\t\tvar result = {\n\t\t\t\tsetAttribute:function(name, value){\n\t\t\t\t\tthis[name] = value;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tattributeSetter.apply(this, [arg, result]);\n\t\t\treturn result;\n\n\t\t},\n\n\t\teventBarAttrString: function(event){\n\t\t\treturn this.getAttributeString(this._getAttributes(this.setEventBarAttr, event));\n\t\t},\n\n\n\n\t\tagendaHeadAttrString :function(){\n\t\t\treturn this.getAttributeString({role: \"row\"});\n\t\t},\n\t\tagendaHeadDateString :function(label){\n\t\t\treturn this.getAttributeString({role: \"columnheader\", \"aria-label\": label});\n\t\t},\n\t\tagendaHeadDescriptionString :function(label){\n\t\t\treturn this.agendaHeadDateString(label);\n\t\t},\n\t\tagendaDataAttrString: function(){\n\t\t\treturn this.getAttributeString({role: \"grid\"});\n\t\t},\n\t\tagendaEventAttrString: function(event){\n\t\t\tvar attrs = this._getAttributes(this._eventCommonAttr, event);\n\n\t\t\tattrs[\"role\"] = \"row\";\n\n\t\t\treturn this.getAttributeString(attrs);\n\n\t\t},\n\t\tagendaDetailsBtnString: function(){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":scheduler.locale.labels.icon_details});\n\t\t},\n\n\n\t\tgridAttrString: function(){\n\t\t\treturn this.getAttributeString({role: \"grid\"});\n\t\t},\n\n\t\tgridRowAttrString: function(event){\n\t\t\treturn this.agendaEventAttrString(event);\n\t\t},\n\n\t\tgridCellAttrString: function(event, column, value){\n\t\t\treturn this.getAttributeString({\"role\":\"gridcell\", \"aria-label\": [\n\t\t\t\t(column.label === undefined ? column.id : column.label),\n\t\t\t\t\": \",\n\t\t\t\tvalue\n\t\t\t]});\n\t\t},\n\n\t\tmapAttrString: function(){\n\t\t\treturn this.gridAttrString();\n\t\t},\n\t\tmapRowAttrString: function(event){\n\t\t\treturn this.gridRowAttrString(event);\n\t\t},\n\t\tmapDetailsBtnString: function(){\n\t\t\treturn this.agendaDetailsBtnString();\n\t\t},\n\n\t\tminicalHeader: function(div, headerId){\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"id\":headerId+\"\",\n\t\t\t\t\"aria-live\":\"assertice\",\n\t\t\t\t\"aria-atomic\":\"true\"\n\n\t\t\t});\n\t\t},\n\t\tminicalGrid: function(div, headerId){\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"aria-labelledby\":headerId+\"\",\n\t\t\t\t\"role\":\"grid\"\n\t\t\t});\n\t\t},\n\t\tminicalRow: function(div){\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"role\":\"row\"\n\t\t\t});\n\t\t},\n\t\tminicalDayCell: function(div, date){\n\t\t\tvar selected = (date.valueOf() < scheduler._max_date.valueOf() && date.valueOf() >= scheduler._min_date.valueOf());\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"role\":\"gridcell\",\n\t\t\t\t\"aria-label\": scheduler.templates.day_date(date),\n\t\t\t\t\"aria-selected\": selected ? \"true\" : \"false\"\n\t\t\t});\n\t\t},\n\t\tminicalHeadCell: function(div){\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"role\":\"columnheader\"\n\t\t\t});\n\t\t},\n\n\n\t\tweekAgendaDayCell: function(div, date){\n\t\t\tvar header = div.querySelector(\".dhx_wa_scale_bar\");\n\t\t\tvar content = div.querySelector(\".dhx_wa_day_data\");\n\t\t\tvar headerId = scheduler.uid() + \"\";\n\t\t\tthis.setAttributes(header, { \"id\": headerId});\n\t\t\tthis.setAttributes(content, { \"aria-labelledby\": headerId});\n\n\t\t},\n\t\tweekAgendaEvent: function(div, event){\n\t\t\tthis.eventAttr(event, div);\n\t\t},\n\n\t\tlightboxHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t},\n\n\t\tlightboxVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\tlightboxSectionButtonAttrString: function(label){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\n\t\t},\n\n\t\tyearHeader: function(div, headerId){\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"id\":headerId+\"\"\n\t\t\t});\n\t\t},\n\t\tyearGrid: function(div, headerId){\n\t\t\tthis.minicalGrid(div, headerId);\n\t\t},\n\t\tyearHeadCell: function(div){\n\t\t\treturn this.minicalHeadCell(div);\n\t\t},\n\t\tyearRow: function(div){\n\t\t\treturn this.minicalRow(div);\n\t\t},\n\t\tyearDayCell: function(div){\n\t\t\tthis.setAttributes(div, {\n\t\t\t\t\"role\":\"gridcell\"\n\t\t\t});\n\t\t},\n\n\t\tlightboxAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t\tdiv.firstChild.setAttribute(\"role\", \"heading\");\n\t\t},\n\n\t\tlightboxButtonAttrString:function(buttonName){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":scheduler.locale.labels[buttonName], \"tabindex\":\"0\"});\n\t\t},\n\t\teventMenuAttrString: function(iconName){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":scheduler.locale.labels[iconName]});\n\t\t},\n\t\tlightboxHeader: function(div, headerText){\n\t\t\tdiv.setAttribute(\"aria-label\", headerText);\n\t\t},\n\n\t\tlightboxSelectAttrString: function(time_option){\n\t\t\tvar label = \"\";\n\n\t\t\tswitch (time_option) {\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tlabel = scheduler.locale.labels.year;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tlabel = scheduler.locale.labels.month;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tlabel = scheduler.locale.labels.day;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%H:%i\":\n\t\t\t\t\tlabel = scheduler.locale.labels.hour + \" \" + scheduler.locale.labels.minute;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn scheduler._waiAria.getAttributeString({\"aria-label\": label});\n\t\t},\n\n\n\t\tmessageButtonAttrString: function(buttonLabel){\n\t\t\treturn \"tabindex='0' role='button' aria-label='\"+buttonLabel+\"'\";\n\t\t},\n\n\t\tmessageInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"alert\");\n\t\t\t//div.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tmessageModalAttr: function(div, uid){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tif(uid){\n\t\t\t\tdiv.setAttribute(\"aria-labelledby\", uid);\n\t\t\t}\n\n\t\t\t//\tdiv.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tquickInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t},\n\n\t\tquickInfoHeaderAttrString: function(){\n\t\t\treturn \" role='heading' \";\n\t\t},\n\n\t\tquickInfoHeader: function(div, header){\n\t\t\tdiv.setAttribute(\"aria-label\", header);\n\t\t},\n\n\t\tquickInfoButtonAttrString: function(label){\n\t\t\treturn scheduler._waiAria.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\n\t\t},\n\n\t\ttooltipAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"tooltip\");\n\t\t},\n\n\t\ttooltipVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\ttooltipHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t};\n\n\tfunction isDisabled(){\n\t\treturn !scheduler.config.wai_aria_attributes;\n\t}\n\n\tfor(var i in scheduler._waiAria){\n\t\tscheduler._waiAria[i] = (function(payload){\n\t\t\treturn function(){\n\t\t\t\tif(isDisabled()){\n\t\t\t\t\treturn \" \";\n\t\t\t\t}\n\t\t\t\treturn payload.apply(this, arguments);\n\t\t\t};\n\t\t})(scheduler._waiAria[i]);\n\t}\n\n\n})();\n\n}","export default function(scheduler){\n\treturn function assert(check, message){\n\t\tif (!check){\n\t\t\tif(scheduler.config.show_errors && scheduler.callEvent(\"onError\",[message]) !== false) {\n\t\t\t\tif (scheduler.message) {\n\t\t\t\t\tscheduler.message({type: \"error\", text: message, expire: -1});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tconsole.log(message);\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line no-debugger\n\t\t\t\tdebugger;\n\t\t\t}\n\t\t}\n\t};\n}","export default function extend(scheduler) {\n\nif (window.jQuery){\n\n(function( $ ){\n\tvar counter = 0;\n\tvar methods = [];\n\t$.fn.dhx_scheduler = function(config){\n\t\tif (typeof(config) === 'string') {\n\t\t\tif (methods[config] ) {\n\t\t\t\treturn methods[config].apply(this, []);\n\t\t\t}else {\n\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_scheduler');\n\t\t\t}\n\t\t} else {\n\t\t\tvar views = [];\n\t\t\tthis.each(function() {\n\t\t\t\tif (this && this.getAttribute){\n\t\t\t\t\tif (!this.getAttribute(\"dhxscheduler\")){\n\t\t\t\t\t\tvar name = \"scheduler\";\n\t\t\t\t\t\tif (counter){\n\t\t\t\t\t\t\tname = \"scheduler\" + (counter+1);\n\t\t\t\t\t\t\twindow[name] = Scheduler.getSchedulerInstance();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar comp  = window[name];\n\n\t\t\t\t\t\tthis.setAttribute(\"dhxscheduler\", name);\n\t\t\t\t\t\tfor (var key in config)\n\t\t\t\t\t\t\tif (key!=\"data\")\n\t\t\t\t\t\t\t\tcomp.config[key] = config[key];\n\n\t\t\t\t\t\tif (!this.getElementsByTagName(\"div\").length){\n\t\t\t\t\t\t\tthis.innerHTML = '<div class=\"dhx_cal_navline\"><div class=\"dhx_cal_prev_button\"></div><div class=\"dhx_cal_next_button\"></div><div class=\"dhx_cal_today_button\"></div><div class=\"dhx_cal_date\"></div><div class=\"dhx_cal_tab\" name=\"day_tab\" data-tab=\"day\" style=\"right:204px;\"></div><div class=\"dhx_cal_tab\" name=\"week_tab\" data-tab=\"week\" style=\"right:140px;\"></div><div class=\"dhx_cal_tab\" name=\"month_tab\" data-tab=\"month\" style=\"right:76px;\"></div></div><div class=\"dhx_cal_header\"></div><div class=\"dhx_cal_data\"></div>';\n\t\t\t\t\t\t\tthis.className += \" dhx_cal_container\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcomp.init(this, comp.config.date, comp.config.mode);\n\t\t\t\t\t\tif (config.data)\n\t\t\t\t\t\t\tcomp.parse(config.data);\n\n\t\t\t\t\t\tviews.push(comp);\n\t\t\t\t\t\tcounter++;\n\t\t\t\t\t} else\n\t\t\t\t\t\tviews.push(window[this.getAttribute(\"dhxscheduler\")]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (views.length === 1) return views[0];\n\t\t\treturn views;\n\t\t}\n\t};\n\n\n\n\n})(window.jQuery);\n\n}\n\n}","export default function extend(scheduler) {\n\nscheduler.destructor = function(){\n\tscheduler.callEvent(\"onDestroy\", []);\n\tthis.clearAll();\n\n\tif(this.$container){\n\t\t// FIXME: clear container or remove container\n\t\tthis.$container.innerHTML = \"\";\n\t\t// scheduler.$domHelpers.remove(this.$container);\n\t}\n\n\tif(this._eventRemoveAll){\n\t\tthis._eventRemoveAll();\n\t}\n\n\tif(this.resetLightbox){\n\t\tthis.resetLightbox();\n\t}\n\n\tif(this._dp && this._dp.destructor){\n\t\tthis._dp.destructor();\n\t}\n\n\t// detachAllEvents should be called last, because in components may be attached events\n\tthis.detachAllEvents();\n\n\tfor(var i in this){\n\t\tif(i.indexOf(\"$\") === 0){\n\t\t\tdelete this[i];\n\t\t}\n\t}\n\tscheduler.$destroyed = true;\n};\n\n}","import serialize from \"../common/url_serialize.js\";\n\nexport default function extend(scheduler) {\n\nscheduler.Promise = window.Promise; \n\nfunction createConfig(method, args) {\n\tvar result = {\n\t\tmethod: method\n\t};\n\n\tif (args.length === 0) {\n\t\tthrow new Error(\"Arguments list of query is wrong.\");\n\t}\n\tif (args.length === 1) {\n\t\tif (typeof args[0] === \"string\") {\n\t\t\tresult.url = args[0];\n\t\t\tresult.async = true;\n\t\t} else {\n\t\t\tresult.url = args[0].url;\n\t\t\tresult.async = (args[0].async || true);\n\t\t\tresult.callback = args[0].callback;\n\t\t\tresult.headers = args[0].headers;\n\t\t}\n\t\tif (method === \"POST\" || \"PUT\") {\n\t\t\tif (args[0].data) {\n\t\t\t\tif (typeof args[0].data !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[0].data);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[0].data;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tresult.url = args[0];\n\tswitch(method) {\n\t\tcase \"GET\":\n\t\tcase \"DELETE\":\n\t\t\tresult.callback = args[1];\n\t\t\tresult.headers = args[2];\n\t\tbreak;\n\t\tcase \"POST\":\n\t\tcase \"PUT\":\n\t\t\tif (args[1]) {\n\t\t\t\tif (typeof args[1] !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[1]);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[1];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t\tresult.callback = args[2];\n\t\t\tresult.headers = args[3];\n\t\tbreak;\n\t}\n\treturn result;\n}\nscheduler.ajax = {\n\t// if false - dhxr param will added to prevent caching on client side (default),\n\t// if true - do not add extra params\n\tcache: true,\n\n\t// default method for load/loadStruct, post/get allowed\n\tmethod: \"get\",\n\n\tserializeRequestParams: serialize,\n\tparse: function(data) {\n\t\tif (typeof data !== \"string\") return data;\n\n\t\tvar obj;\n\t\tdata = data.replace(/^[\\s]+/,\"\");\n\t\tif (typeof DOMParser !== \"undefined\" && !scheduler.$env.isIE) { // ff,ie9\n\t\t\tobj = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t} else if (typeof window.ActiveXObject !== \"undefined\") {\n\t\t\tobj = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\tobj.async = \"false\";\n\t\t\tobj.loadXML(data);\n\t\t}\n\t\treturn obj;\n\t},\n\txmltop: function(tagname, xhr, obj) {\n\t\tif (typeof xhr.status == \"undefined\" || xhr.status < 400) {\n\t\t\tvar xml = (!xhr.responseXML) ? this.parse(xhr.responseText || xhr) : (xhr.responseXML || xhr);\n\t\t\tif (xml && xml.documentElement !== null && !xml.getElementsByTagName(\"parsererror\").length) {\n\t\t\t\treturn xml.getElementsByTagName(tagname)[0];\n\t\t\t}\n\t\t}\n\t\tif (obj !== -1) scheduler.callEvent(\"onLoadXMLError\",[\"Incorrect XML\", arguments[1], obj]);\n\t\treturn document.createElement(\"DIV\");\n\t},\n\txpath: function(xpathExp, docObj) {\n\t\tif (!docObj.nodeName) docObj = docObj.responseXML || docObj;\n\t\tif (scheduler.$env.isIE) {\n\t\t\treturn docObj.selectNodes(xpathExp)||[];\n\t\t} else {\n\t\t\tvar rows = [];\n\t\t\tvar first;\n\t\t\tvar col = (docObj.ownerDocument||docObj).evaluate(xpathExp, docObj, null, XPathResult.ANY_TYPE, null);\n\n\t\t\twhile (true){\n\t\t\t\tfirst = col.iterateNext();\n\t\t\t\tif(first){\n\t\t\t\t\trows.push(first);\n\t\t\t\t}else{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn rows;\n\t\t}\n\t},\n\tquery: function(config) {\n\t\treturn this._call(\n\t\t\t(config.method || \"GET\"),\n\t\t\tconfig.url,\n\t\t\tconfig.data || \"\",\n\t\t\t(config.async || true),\n\t\t\tconfig.callback,\n\t\t\tconfig.headers\n\t\t);\n\t},\n\tget: function(url, onLoad, headers) {\n\t\tvar config = createConfig(\"GET\", arguments);\n\t\treturn this.query(config);\n\t},\n\tgetSync: function(url, headers) {\n\t\tvar config = createConfig(\"GET\", arguments);\n\t\tconfig.async = false;\n\t\treturn this.query(config);\n\t},\n\tput: function(url, postData, onLoad, headers) {\n\t\tvar config = createConfig(\"PUT\", arguments);\n\t\treturn this.query(config);\n\t},\n\tdel: function(url, onLoad, headers) {\n\t\t/**\n\t\t * https://tools.ietf.org/html/rfc7231#section-4.3.5\n\t\t * A payload within a DELETE request message has no defined semantics;\n\t\t * sending a payload body on a DELETE request might cause some existing\n\t\t * implementations to reject the request.\n\t\t */\n\t\tvar config = createConfig(\"DELETE\", arguments);\n\t\treturn this.query(config);\n\t},\n\tpost: function(url, postData, onLoad, headers) {\n\t\tif (arguments.length == 1) {\n\t\t\tpostData = \"\";\n\t\t} else if (arguments.length == 2 && typeof(postData) == \"function\") {\n\t\t\tonLoad = postData;\n\t\t\tpostData = \"\";\n\t\t}\n\t\tvar config = createConfig(\"POST\", arguments);\n\t\treturn this.query(config);\n\t},\n\tpostSync: function(url, postData, headers) {\n\t\tpostData = (postData === null ? \"\" : String(postData));\n\n\t\tvar config = createConfig(\"POST\", arguments);\n\t\tconfig.async = false;\n\t\treturn this.query(config);\n\t},\n\t_call: function(method, url, postData, async, onLoad, headers) {\n\t\treturn new scheduler.Promise((function(resolve, reject) {\n\t\t\tvar t = (typeof XMLHttpRequest !== undefined && !scheduler.$env.isIE ? new XMLHttpRequest() : new window.ActiveXObject(\"Microsoft.XMLHTTP\"));\n\t\t\tvar isQt = (navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null);\n\n\t\t\tif (!!async) {\n\t\t\t\tt.addEventListener(\"readystatechange\", function() {\n\t\t\t\t\tif ((t.readyState == 4) || (isQt && t.readyState == 3)) { // what for long response and status 404?\n\t\t\t\t\t\tif (t.status != 200 || t.responseText === \"\")\n\t\t\t\t\t\t\tif (!scheduler.callEvent(\"onAjaxError\", [t])) return;\n\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\tonLoad.apply(window, [{xmlDoc:t, filePath:url}]); // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(t);\n\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\tonLoad = null;\n\t\t\t\t\t\t\t\tt = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (method == \"GET\" && !this.cache) {\n\t\t\t\turl += (url.indexOf(\"?\")>=0?\"&\":\"?\")+\"dhxr\"+new Date().getTime()+\"=1\";\n\t\t\t}\n\n\t\t\tt.open(method, url, async);\n\n\t\t\tif (headers){\n\t\t\t\tfor (var key in headers)\n\t\t\t\t\tt.setRequestHeader(key, headers[key]);\n\t\t\t} else if (method.toUpperCase() == \"POST\" || method == \"PUT\" || method == \"DELETE\") {\n\t\t\t\tt.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\t\t\t} else if (method == \"GET\") {\n\t\t\t\tpostData = null;\n\t\t\t}\n\n\t\t\tt.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n\t\t\tt.send(postData);\n\n\t\t\tif (!async) return {xmlDoc:t, filePath:url}; // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t}.bind(this)));\n\t},\n\turlSeparator: function(str){\n\t\tif (str.indexOf(\"?\") != -1)\n\t\t\treturn \"&\";\n\t\telse\n\t\t\treturn \"?\";\n\t}\n};\n\nscheduler.$ajax = scheduler.ajax; // for old\n\n}","export default function extend(scheduler) {\n\n/*\n%e\tDay of the month without leading zeros (01..31)\n%d\tDay of the month, 2 digits with leading zeros (01..31)\n%j\tDay of the year, 3 digits with leading zeros (001..366)\n%a\tA textual representation of a day, two letters\n%W\tA full textual representation of the day of the week\n\n%c\tNumeric representation of a month, without leading zeros (0..12)\n%m\tNumeric representation of a month, with leading zeros (00..12)\n%b\tA short textual representation of a month, three letters (Jan..Dec)\n%M\tA full textual representation of a month, such as January or March (January..December)\n\n%y\tA two digit representation of a year (93..03)\n%Y\tA full numeric representation of a year, 4 digits (1993..03)\n*/\n\nscheduler.config={\n\tdefault_date: \"%j %M %Y\",\n\tmonth_date: \"%F %Y\",\n\tload_date: \"%Y-%m-%d\",\n\tweek_date: \"%l\",\n\tday_date: \"%D %j\",\n\thour_date: \"%H:%i\",\n\tmonth_day: \"%d\",\n\t//xml_date: \"%m/%d/%Y %H:%i\",\n\tdate_format: \"%Y-%m-%d %H:%i\",\n\tapi_date: \"%d-%m-%Y %H:%i\",\n\tparse_exact_format: false,\n\tpreserve_length:true,\n\ttime_step: 5,\n\tdisplayed_event_color: \"#ff4a4a\",\n\tdisplayed_event_text_color: \"#ffef80\",\n\twide_form: 0,\n\tday_column_padding: 8,\n\tuse_select_menu_space: true,\n\tfix_tab_position: true,\n\tstart_on_monday: true,\n\tfirst_hour: 0,\n\tlast_hour: 24,\n\treadonly: false,\n\tdrag_resize: true,\n\tdrag_move: true,\n\tdrag_create: true,\n\tdrag_event_body: true,\n\tdblclick_create: true,\n\tdetails_on_dblclick: true,\n\tedit_on_create: true,\n\tdetails_on_create: true,\n\theader: null,\n\thour_size_px: 44,\n\tresize_month_events:false,\n\tresize_month_timed:false,\n\tresponsive_lightbox: false,\n\tseparate_short_events: true,\n\trtl:false,\n\n\tcascade_event_display: false,\n\tcascade_event_count: 4,\n\tcascade_event_margin: 30,\n\n\tmulti_day:true,\n\tmulti_day_height_limit: 200,\n\n\tdrag_lightbox: true,\n\tpreserve_scroll: true,\n\tselect: true,\n\tundo_deleted: true,\n\tserver_utc: false,\n\ttouch:true,\n\ttouch_tip:true,\n\ttouch_drag:500,\n\ttouch_swipe_dates: false,\n\tquick_info_detached:true,\n\n\tpositive_closing: false,\n\t//header_datepicker: true,\n\tdrag_highlight: true,\n\tlimit_drag_out: false,\n\ticons_edit: [\"icon_save\", \"icon_cancel\"],\n\ticons_select: [\"icon_details\", \"icon_edit\", \"icon_delete\"],\n\tbuttons_right: [\"dhx_save_btn\", \"dhx_cancel_btn\"],\n\tbuttons_left: [\"dhx_delete_btn\"],\n\tlightbox: {\n\t\tsections: [\n\t\t\t{name: \"description\", map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t{name: \"time\", height: 72, type: \"time\", map_to: \"auto\"}\n\t\t]\n\t},\n\thighlight_displayed_event: true,\n\tleft_border: false,\n\n\tajax_error: \"alert\",//\"ignore\"|\"console\"\n\tdelay_render: 0,\n\ttimeline_swap_resize: true,\n\twai_aria_attributes: true,\n\twai_aria_application_role: true,\n\n\tcsp: \"auto\",\n\tevent_attribute: \"data-event-id\",\n\tshow_errors: true\n};\n\nscheduler.config.buttons_left.$initial = scheduler.config.buttons_left.join();\nscheduler.config.buttons_right.$initial = scheduler.config.buttons_right.join();\n\nscheduler._helpers = {\n\tparseDate: function parseDate(date) {\n\t\tvar parse = scheduler.templates.xml_date || scheduler.templates.parse_date;\n\t\treturn parse(date);\n\t},\n\tformatDate: function formatDate(date) {\n\t\tvar format = scheduler.templates.xml_format || scheduler.templates.format_date;\n\t\treturn format(date);\n\t}\n};\n\nscheduler.templates={};\nscheduler.init_templates=function(){\n\n\n\n\tvar d=scheduler.date.date_to_str;\n\tvar c=scheduler.config;\n\tvar f = function(a,b){\n\t\tfor (var c in b)\n\t\t\tif (!a[c]) a[c]=b[c];\n\t};\n\tf(scheduler.templates,{\n\t\tday_date:d(c.default_date),\n\t\tmonth_date:d(c.month_date),\n\t\tweek_date:function(d1,d2){\n\t\t\tif(c.rtl) {\n\t\t\t\treturn scheduler.templates.day_date(scheduler.date.add(d2,-1,\"day\"))+\" &ndash; \"+scheduler.templates.day_date(d1);\n\t\t\t} \n\t\t\treturn scheduler.templates.day_date(d1)+\" &ndash; \"+scheduler.templates.day_date(scheduler.date.add(d2,-1,\"day\"));\n\t\t},\n\t\tday_scale_date:d(c.default_date),\n\t\ttime_slot_text: function(date){\n\t\t\treturn \"\";\n\t\t},\n\t\ttime_slot_class: function(date){\n\t\t\treturn \"\";\n\t\t},\n\n\t\tmonth_scale_date:d(c.week_date),\n\t\tweek_scale_date:d(c.day_date),\n\t\thour_scale:d(c.hour_date),\n\t\ttime_picker:d(c.hour_date),\n\t\tevent_date:d(c.hour_date),\n\t\tmonth_day:d(c.month_day),\n\n\t\tload_format: d(c.load_date),\n\t//\txml_date:scheduler.date.str_to_date(c.xml_date,c.server_utc),\n\t//\txml_format:d(c.date_format,c.server_utc),\n\t\tformat_date: d(c.date_format, c.server_utc),\n\t\tparse_date:scheduler.date.str_to_date(c.date_format,c.server_utc),\n\t\tapi_date:scheduler.date.str_to_date(c.api_date, false, false),\n\t\tevent_header:function(start,end,ev){\n\n\t\t\tif(ev._mode === \"small\" || ev._mode === \"smallest\"){\n\t\t\t\treturn scheduler.templates.event_date(start);\n\t\t\t}else{\n\t\t\t\treturn scheduler.templates.event_date(start)+\" - \"+scheduler.templates.event_date(end);\n\t\t\t}\n\t\t},\n\t\tevent_text:function(start,end,ev){\n\t\t\treturn ev.text;\n\t\t},\n\t\tevent_class:function(start,end,ev){\n\t\t\treturn \"\";\n\t\t},\n\t\tmonth_date_class:function(d){\n\t\t\treturn \"\";\n\t\t},\n\t\tweek_date_class:function(d){\n\t\t\treturn \"\";\n\t\t},\n\t\tevent_bar_date:function(start,end,ev) {\n\t\t\treturn scheduler.templates.event_date(start);\n\t\t},\n\t\tevent_bar_text:function(start,end,ev){\n\t\t\treturn ev.text;\n\t\t},\n\t\tmonth_events_link : function(date, count){\n\t\t\treturn \"<a>View more(\"+count+\" events)</a>\";\n\t\t},\n\t\tdrag_marker_class : function(start, end, event){\n\t\t\treturn \"\";\n\t\t},\n\t\tdrag_marker_content : function(start, end, event){\n\t\t\treturn \"\";\n\t\t},\n\t\t/* Could be redifined */\n\t\ttooltip_date_format: scheduler.date.date_to_str(\"%Y-%m-%d %H:%i\"),\n\t\ttooltip_text: function(start, end, event) {\n\t\t\treturn \"<b>Event:</b> \" + event.text + \"<br/><b>Start date:</b> \" + scheduler.templates.tooltip_date_format(start) + \"<br/><b>End date:</b> \" + scheduler.templates.tooltip_date_format(end);\n\t\t},\n\n\t\tcalendar_month: d(\"%F %Y\"),\n\t\tcalendar_scale_date: d(\"%D\"),\n\t\tcalendar_date: d(\"%d\"),\n\t\tcalendar_time: d(\"%d-%m-%Y\")\n\n\t});\n\tthis.callEvent(\"onTemplatesReady\",[]);\n};\n\n\n}","export default function extend(scheduler) {\n\nscheduler._events = {};\nscheduler.clearAll = function() {\n\tthis._events = {};\n\tthis._loaded = {};\n\n\tthis._edit_id = null;\n\tthis._select_id = null;\n\tthis._drag_id = null;\n\tthis._drag_mode = null;\n\tthis._drag_pos = null;\n\tthis._new_event = null;\n\n\tthis.clear_view();\n\tthis.callEvent(\"onClearAll\", []);\n};\nscheduler.addEvent = function(start_date, end_date, text, id, extra_data) {\n\tif (!arguments.length)\n\t\treturn this.addEventNow();\n\tvar ev = start_date;\n\tif (arguments.length != 1) {\n\t\tev = extra_data || {};\n\t\tev.start_date = start_date;\n\t\tev.end_date = end_date;\n\t\tev.text = text;\n\t\tev.id = id;\n\t}\n\tev.id = ev.id || scheduler.uid();\n\tev.text = ev.text || \"\";\n\n\tif (typeof ev.start_date == \"string\")  ev.start_date = this.templates.api_date(ev.start_date);\n\tif (typeof ev.end_date == \"string\")  ev.end_date = this.templates.api_date(ev.end_date);\n\tvar d = (this.config.event_duration || this.config.time_step) * 60000;\n\t// GS-2548: events that less than time step, will have the minimal duration according to time step\n\tif (new Date(ev.end_date).valueOf() - new Date(ev.start_date).valueOf() <= d)\n\t\tev.end_date.setTime(ev.end_date.valueOf() + d);\n\n\tev.start_date.setMilliseconds(0);\n\tev.end_date.setMilliseconds(0);\n\n\tev._timed = this.isOneDayEvent(ev);\n\n\tvar is_new = !this._events[ev.id];\n\tthis._events[ev.id] = ev;\n\tthis.event_updated(ev);\n\tif (!this._loading)\n\t\tthis.callEvent(is_new ? \"onEventAdded\" : \"onEventChanged\", [ev.id, ev]);\n\treturn ev.id;\n};\nscheduler.deleteEvent = function(id, silent) {\n\tvar ev = this._events[id];\n\tif (!silent && (!this.callEvent(\"onBeforeEventDelete\", [id, ev]) || !this.callEvent(\"onConfirmedBeforeEventDelete\", [id, ev])))\n\t\treturn;\n\tif (ev) {\n\t\tif(scheduler.getState().select_id == id){\n\t\t\tscheduler.unselect();\n\t\t}\n\t\tdelete this._events[id];\n\t\tthis.event_updated(ev);\n\n\t\tif(this._drag_id == ev.id){\n\t\t\tthis._drag_id = null;\n\t\t\tthis._drag_mode=null;\n\t\t\tthis._drag_pos=null;\n\t\t}\n\t}\n\n\tthis.callEvent(\"onEventDeleted\", [id, ev]);\n};\nscheduler.getEvent = function(id) {\n\treturn this._events[id];\n};\nscheduler.setEvent = function(id, hash) {\n\tif(!hash.id)\n\t\thash.id = id;\n\n\tthis._events[id] = hash;\n};\nscheduler.for_rendered = function(id, method) {\n\tfor (var i = this._rendered.length - 1; i >= 0; i--)\n\t\tif (this._rendered[i].getAttribute(this.config.event_attribute) == id)\n\t\t\tmethod(this._rendered[i], i);\n};\nscheduler.changeEventId = function(id, new_id) {\n\tif (id == new_id) return;\n\tvar ev = this._events[id];\n\tif (ev) {\n\t\tev.id = new_id;\n\t\tthis._events[new_id] = ev;\n\t\tdelete this._events[id];\n\t}\n\tthis.for_rendered(id, function(r) {\n\t\tr.setAttribute(\"event_id\", new_id); // for backward compatibility\n\t\tr.setAttribute(scheduler.config.event_attribute, new_id);\n\t});\n\tif (this._select_id == id) this._select_id = new_id;\n\tif (this._edit_id == id) this._edit_id = new_id;\n\t//if (this._drag_id==id) this._drag_id=new_id;\n\tthis.callEvent(\"onEventIdChange\", [id, new_id]);\n};\n\n(function() {\n\tvar attrs = [\"text\", \"Text\", \"start_date\", \"StartDate\", \"end_date\", \"EndDate\"];\n\tvar create_getter = function(name) {\n\t\treturn function(id) { return (scheduler.getEvent(id))[name]; };\n\t};\n\tvar create_setter = function(name) {\n\t\treturn function(id, value) {\n\t\t\tvar ev = scheduler.getEvent(id);\n\t\t\tev[name] = value;\n\t\t\tev._changed = true;\n\t\t\tev._timed = this.isOneDayEvent(ev);\n\t\t\tscheduler.event_updated(ev, true);\n\t\t};\n\t};\n\tfor (var i = 0; i < attrs.length; i += 2) {\n\t\tscheduler[\"getEvent\" + attrs[i + 1]] = create_getter(attrs[i]);\n\t\tscheduler[\"setEvent\" + attrs[i + 1]] = create_setter(attrs[i]);\n\t}\n})();\n\nscheduler.event_updated = function(ev, force) {\n\tif (this.is_visible_events(ev))\n\t\tthis.render_view_data();\n\telse\n\t\tthis.clear_event(ev.id);\n};\nscheduler.is_visible_events = function(ev) {\n\tif(!this._min_date || !this._max_date){\n\t\treturn false;\n\t}\n\n\t//if in displayed dates\n\tvar in_visible_range = (ev.start_date.valueOf() < this._max_date.valueOf() && this._min_date.valueOf() < ev.end_date.valueOf());\n\n\tif(in_visible_range){\n\n\t\t//end dates are not between last/first hours\n\t\tvar evFirstHour = ev.start_date.getHours(),\n\t\t\tevLastHour = ev.end_date.getHours() + (ev.end_date.getMinutes()/60),\n\t\t\tlastHour = this.config.last_hour,\n\t\t\tfirstHour = this.config.first_hour;\n\n\t\tvar end_dates_visible = (this._table_view || !((evLastHour > lastHour || evLastHour <= firstHour) && (evFirstHour >= lastHour || evFirstHour < firstHour)));\n\n\t\tif(end_dates_visible){\n\t\t\treturn true;\n\t\t}else{\n\n\t\t\t//event is bigger than area hidden between last/first hours\n\t\t\tvar event_duration = (ev.end_date.valueOf() - ev.start_date.valueOf()) / (1000*60*60),//hours\n\t\t\t\thidden_duration = 24 - (this.config.last_hour - this.config.first_hour);\n\n\t\t\treturn !!((event_duration > hidden_duration) || (evFirstHour < lastHour && evLastHour > firstHour));\n\n\t\t}\n\t}else{\n\t\treturn false;\n\t}\n};\nscheduler.isOneDayEvent = function(ev) {\n\t// decrease by one ms so events that ends on midnight on the next day were still considered one day events\n\t// e.g. (09-02-2018 19:00 - 10-02-2018 00:00)\n\t// events >= 24h long are considered multiday\n\tvar checkEndDate = new Date(ev.end_date.valueOf() - 1);\n\treturn (\n\t\tev.start_date.getFullYear() === checkEndDate.getFullYear() &&\n\t\tev.start_date.getMonth() === checkEndDate.getMonth() &&\n\t\tev.start_date.getDate() === checkEndDate.getDate()\n\t) && ((ev.end_date.valueOf() - ev.start_date.valueOf()) < (1000 * 60 * 60 * 24));\n};\n\nscheduler.get_visible_events = function(only_timed) {\n\t//not the best strategy for sure\n\tvar stack = [];\n\n\tfor (var id in this._events)\n\t\tif (this.is_visible_events(this._events[id]))\n\t\t\tif (!only_timed || this._events[id]._timed)\n\t\t\t\tif (this.filter_event(id, this._events[id]))\n\t\t\t\t\tstack.push(this._events[id]);\n\n\treturn stack;\n};\nscheduler.filter_event = function(id, ev) {\n\tvar filter = this[\"filter_\" + this._mode];\n\treturn (filter) ? filter(id, ev) : true;\n};\nscheduler._is_main_area_event = function(ev){\n\treturn !!ev._timed;\n};\nscheduler.render_view_data = function(evs, hold) {\n\tvar full = false;\n\tif (!evs) {\n\t\tfull = true;\n\t\tif (this._not_render) {\n\t\t\tthis._render_wait = true;\n\t\t\treturn;\n\t\t}\n\t\tthis._render_wait = false;\n\n\t\tthis.clear_view();\n\t\tevs = this.get_visible_events(!(this._table_view || this.config.multi_day));\n\t}\n\tfor(var i= 0, len = evs.length; i < len; i++){\n\t\tthis._recalculate_timed(evs[i]);\n\t}\n\n\tif (this.config.multi_day && !this._table_view) {\n\n\t\tvar tvs = [];\n\t\tvar tvd = [];\n\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\tif (this._is_main_area_event(evs[i]))\n\t\t\t\ttvs.push(evs[i]);\n\t\t\telse\n\t\t\t\ttvd.push(evs[i]);\n\t\t}\n\n\t\tif(!this._els['dhx_multi_day']){\n\t\t\tvar message = scheduler._commonErrorMessages.unknownView(this._mode);\n\t\t\tthrow new Error(message);\n\t\t}\n\n\t\t// multiday events\n\t\tthis._rendered_location = this._els['dhx_multi_day'][0];\n\t\tthis._table_view = true;\n\t\tthis.render_data(tvd, hold);\n\t\tthis._table_view = false;\n\n\t\t// normal events\n\t\tthis._rendered_location = this._els['dhx_cal_data'][0];\n\t\tthis._table_view = false;\n\t\tthis.render_data(tvs, hold);\n\n\t} else {\n\t\tvar buffer = document.createDocumentFragment();\n\t\tvar renderedLocation = this._els['dhx_cal_data'][0];\n\t\tthis._rendered_location = buffer;\n\t\tthis.render_data(evs, hold);\n\t\trenderedLocation.appendChild(buffer);\n\t\tthis._rendered_location = renderedLocation;\n\n\t}\n\n\tif(full){\n\t\tthis.callEvent(\"onDataRender\", []);\n\t}\n};\n\n\nscheduler._view_month_day = function(e){\n\tvar date = scheduler.getActionData(e).date;\n\tif(!scheduler.callEvent(\"onViewMoreClick\", [date]))\n\t\treturn;\n\tscheduler.setCurrentView(date, \"day\");\n};\n\nscheduler._render_month_link = function(ev){\n\tvar parent = this._rendered_location;\n\tvar toRender = this._lame_clone(ev);\n\n\t//render links in each cell of multiday events\n\tfor(var d = ev._sday; d < ev._eday; d++){\n\n\t\ttoRender._sday = d;\n\t\ttoRender._eday = d+1;\n\n\t\tvar date = scheduler.date;\n\t\tvar curr = scheduler._min_date;\n\t\tcurr = date.add(curr, toRender._sweek, \"week\");\n\t\tcurr = date.add(curr, toRender._sday, \"day\");\n\t\tvar count = scheduler.getEvents(curr, date.add(curr, 1, \"day\")).length;\n\n\t\tvar pos = this._get_event_bar_pos(toRender);\n\t\tvar widt = (pos.x2 - pos.x);\n\n\t\tvar el = document.createElement(\"div\");\n\t\tscheduler.event(el, \"click\", function(e){scheduler._view_month_day(e);});\n\t\tel.className = \"dhx_month_link\";\n\t\tel.style.top = pos.y + \"px\";\n\t\tel.style.left = pos.x + \"px\";\n\t\tel.style.width = widt + \"px\";\n\t\tel.innerHTML = scheduler.templates.month_events_link(curr, count);\n\t\tthis._rendered.push(el);\n\n\t\tparent.appendChild(el);\n\t}\n};\n\nscheduler._recalculate_timed = function(id){\n\tif(!id) return;\n\tvar ev;\n\tif(typeof(id) != \"object\")\n\t\tev = this._events[id];\n\telse\n\t\tev = id;\n\tif(!ev) return;\n\tev._timed = scheduler.isOneDayEvent(ev);\n};\nscheduler.attachEvent(\"onEventChanged\", scheduler._recalculate_timed);\nscheduler.attachEvent(\"onEventAdded\", scheduler._recalculate_timed);\n\nscheduler.render_data = function(evs, hold) {\n\tevs = this._pre_render_events(evs, hold);\n\tvar containers = {};\n\tfor (var i = 0; i < evs.length; i++)\n\t\tif (this._table_view){\n\t\t\tif(scheduler._mode != 'month'){\n\t\t\t\tthis.render_event_bar(evs[i]);//may be multiday section on other views\n\t\t\t}else{\n\n\t\t\t\tvar max_evs = scheduler.config.max_month_events;\n\t\t\t\tif(max_evs !== max_evs*1 || evs[i]._sorder < max_evs){\n\t\t\t\t\t//of max number events per month cell is set and event can be rendered\n\t\t\t\t\tthis.render_event_bar(evs[i]);\n\t\t\t\t}else if(max_evs !== undefined && evs[i]._sorder == max_evs){\n\t\t\t\t\t//render 'view more' links\n\t\t\t\t\tscheduler._render_month_link(evs[i]);\n\t\t\t\t}else{\n\t\t\t\t\t//do not render events with ordinal number > maximum events per cell\n\t\t\t\t}\n\t\t\t}\n\n\n\n\t\t}else{\n\t\t\tvar ev = evs[i];\n\t\t\tvar parent = scheduler.locate_holder(ev._sday);\n\t\t\tif (!parent) continue; //attempt to render non-visible event\n\n\t\t\tif(!containers[ev._sday]){\n\t\t\t\tcontainers[ev._sday] = {\n\t\t\t\t\treal: parent,\n\t\t\t\t\tbuffer: document.createDocumentFragment(),\n\t\t\t\t\twidth: parent.clientWidth\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar container = containers[ev._sday];\n\t\t\tthis.render_event(ev, container.buffer, container.width);\n\t\t}\n\n\t\tfor(var i in containers){\n\t\t\tvar container = containers[i];\n\t\t\tif(container.real && container.buffer){\n\t\t\t\tcontainer.real.appendChild(container.buffer);\n\t\t\t}\n\t\t}\n};\n\nscheduler._get_first_visible_cell = function(cells) {\n\tfor (var i = 0; i < cells.length; i++) {\n\t\tif ((cells[i].className || \"\").indexOf(\"dhx_scale_ignore\") == -1) {\n\t\t\treturn cells[i];\n\t\t}\n\t}\n\t// if no visible cell found, return cells[0] to be more tolerant, since it's the original logic\n\treturn cells[0];\n};\n\nscheduler._pre_render_events = function(evs, hold) {\n\tvar hb = this.xy.bar_height;\n\tvar h_old = this._colsS.heights;\n\tvar h = this._colsS.heights = [0, 0, 0, 0, 0, 0, 0];\n\tvar data = this._els[\"dhx_cal_data\"][0];\n\n\tif (!this._table_view) {\n\t\tevs = this._pre_render_events_line(evs, hold); //ignore long events for now\n\t}\n\telse {\n\t\tevs = this._pre_render_events_table(evs, hold);\n\t}\n\tif (this._table_view) {\n\t\tif (hold)\n\t\t\tthis._colsS.heights = h_old;\n\t\telse {\n\t\t\tvar monthRows = data.querySelectorAll(\".dhx_cal_month_row\");\n\t\t\tif (monthRows.length) {\n\t\t\t\tfor (var i = 0; i < monthRows.length; i++) {\n\t\t\t\t\th[i]++;\n\t\t\t\t\tvar cells = monthRows[i].querySelectorAll(\".dhx_cal_month_cell\");\n\t\t\t\t\tvar cellHeight = this._colsS.height - this.xy.month_head_height;\n\t\t\t\t\tif ((h[i]) * hb > cellHeight) { // 22 - height of cell's header\n\t\t\t\t\t\t//we have overflow, update heights\n\n\t\t\t\t\t\tvar cHeight = cellHeight;\n\t\t\t\t\t\tif(this.config.max_month_events*1 !== this.config.max_month_events || h[i] <= this.config.max_month_events){\n\t\t\t\t\t\t\tcHeight = h[i] * hb;\n\t\t\t\t\t\t}else if( (this.config.max_month_events + 1) * hb > cellHeight){\n\t\t\t\t\t\t\tcHeight = (this.config.max_month_events + 1) * hb;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmonthRows[i].style.height = (cHeight + this.xy.month_head_height) + \"px\";\n\t\t\t\t\t}\n\n\t\t\t\t\th[i] = (h[i - 1] || 0) + scheduler._get_first_visible_cell(cells).offsetHeight;\n\t\t\t\t}\n\t\t\t\th.unshift(0);\n\t\t\t\tconst dataArea = this.$container.querySelector(\".dhx_cal_data\");\n\t\t\t\tif (dataArea.offsetHeight < dataArea.scrollHeight && !scheduler._colsS.scroll_fix && scheduler.xy.scroll_width) {\n\n\t\t\t\t\tvar scale_settings = scheduler._colsS,\n\t\t\t\t\t\tsum_width = scale_settings[scale_settings.col_length],\n\t\t\t\t\t\trow_heights = scale_settings.heights.slice();\n\n\t\t\t\t\tsum_width -= (scheduler.xy.scroll_width || 0);\n\t\t\t\t\tthis._calc_scale_sizes(sum_width, this._min_date, this._max_date);\n\t\t\t\t\tscheduler._colsS.heights = row_heights;\n\n\t\t\t\t\tthis.set_xy(this._els[\"dhx_cal_header\"][0], sum_width/*, this.xy.scale_height*/);\n\t\t\t\t\tscheduler._render_scales(this._els[\"dhx_cal_header\"][0]);\n\t\t\t\t\tscheduler._render_month_scale(this._els[\"dhx_cal_data\"][0], this._get_timeunit_start(), this._min_date);\n\n\t\t\t\t\tscale_settings.scroll_fix = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!evs.length && this._els[\"dhx_multi_day\"][0].style.visibility == \"visible\")\n\t\t\t\t\th[0] = -1;\n\t\t\t\tif (evs.length || h[0] == -1) {\n\t\t\t\t\t//shift days to have space for multiday events\n\t\t\t\t\t//var childs = evl.parentNode.childNodes;\n\n\t\t\t\t\t// +1 so multiday events would have 2px from top and 2px from bottom by default\n\t\t\t\t\tvar full_multi_day_height = (h[0] + 1) * hb + 4;\n\n\t\t\t\t\tvar used_multi_day_height = full_multi_day_height;\n\t\t\t\t\tvar used_multi_day_height_css = full_multi_day_height + \"px\";\n\t\t\t\t\tif (this.config.multi_day_height_limit) {\n\t\t\t\t\t\tused_multi_day_height = Math.min(full_multi_day_height, this.config.multi_day_height_limit) ;\n\t\t\t\t\t\tused_multi_day_height_css = used_multi_day_height + \"px\";\n\t\t\t\t\t}\n\n\t\t\t\t\tvar multi_day_section = this._els[\"dhx_multi_day\"][0];\n\t\t\t\t\tmulti_day_section.style.height = used_multi_day_height_css;\n\t\t\t\t\tmulti_day_section.style.visibility = (h[0] == -1 ? \"hidden\" : \"visible\");\n\t\t\t\t\tmulti_day_section.style.display = (h[0] == -1 ? \"none\" : \"\");\n\n\t\t\t\t\t// icon\n\t\t\t\t\tvar multi_day_icon = this._els[\"dhx_multi_day\"][1];\n\t\t\t\t\tmulti_day_icon.style.height = used_multi_day_height_css;\n\t\t\t\t\tmulti_day_icon.style.visibility = (h[0] == -1 ? \"hidden\" : \"visible\");\n\t\t\t\t\tmulti_day_icon.style.display = (h[0] == -1 ? \"none\" : \"\");\n\t\t\t\t\tmulti_day_icon.className = h[0] ? \"dhx_multi_day_icon\" : \"dhx_multi_day_icon_small\";\n\t\t\t\t\tthis._dy_shift = (h[0] + 1) * hb;\n\t\t\t\t\tif(this.config.multi_day_height_limit){\n\t\t\t\t\t\tthis._dy_shift = Math.min(this.config.multi_day_height_limit, this._dy_shift);\n\t\t\t\t\t}\n\t\t\t\t\th[0] = 0;\n\n\t\t\t\t\tif (used_multi_day_height != full_multi_day_height) {\n\n\t\t\t\t\t\tmulti_day_section.style.overflowY = \"auto\";\n\t\t\t\t\t//\tmulti_day_section.style.width = (parseInt(this._els[\"dhx_cal_navline\"][0].style.width)) + \"px\";\n\n\t\t\t\t\t\tmulti_day_icon.style.position = \"fixed\";\n\t\t\t\t\t\tmulti_day_icon.style.top = \"\";\n\t\t\t\t\t\tmulti_day_icon.style.left = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn evs;\n};\nscheduler._get_event_sday = function(ev) {\n\t// get day in current view\n\t// use rounding for 23 or 25 hour days on DST\n\tvar datePart = this.date.day_start(new Date(ev.start_date));\n\treturn Math.round((datePart.valueOf() - this._min_date.valueOf()) / (24 * 60 * 60 * 1000));\n};\nscheduler._get_event_mapped_end_date = function(ev) {\n\tvar end_date = ev.end_date;\n\tif (this.config.separate_short_events) {\n\t\tvar ev_duration = (ev.end_date - ev.start_date) / 60000; // minutes\n\t\tif (ev_duration < this._min_mapped_duration) {\n\t\t\tend_date = this.date.add(end_date, this._min_mapped_duration - ev_duration, \"minute\");\n\t\t}\n\t}\n\treturn end_date;\n};\nscheduler._pre_render_events_line = function(evs, hold){\n\tevs.sort(function(a, b) {\n\t\tif (a.start_date.valueOf() == b.start_date.valueOf())\n\t\t\treturn a.id > b.id ? 1 : -1;\n\t\treturn a.start_date > b.start_date ? 1 : -1;\n\t});\n\tvar days = []; //events by weeks\n\tvar evs_originals = [];\n\n\tthis._min_mapped_duration = Math.floor(this.xy.min_event_height * 60 / this.config.hour_size_px);  // values could change along the way\n\n\tfor (var i = 0; i < evs.length; i++) {\n\t\tvar ev = evs[i];\n\n\t\t//check date overflow\n\t\tvar sd = ev.start_date;\n\t\tvar ed = ev.end_date;\n\t\t//check scale overflow\n\t\tvar sh = sd.getHours();\n\t\tvar eh = ed.getHours();\n\t\tev._sday = this._get_event_sday(ev); // sday based on event start_date\n\t\tif (this._ignores[ev._sday]){\n\t\t\t//ignore event\n\t\t\tevs.splice(i,1);\n\t\t\ti--;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!days[ev._sday]) days[ev._sday] = [];\n\n\t\tif (!hold) {\n\t\t\tev._inner = false;\n\n\t\t\tvar stack = days[ev._sday];\n\n\t\t\twhile (stack.length) {\n\t\t\t\tvar t_ev = stack[stack.length - 1];\n\t\t\t\tvar t_end_date = this._get_event_mapped_end_date(t_ev);\n\t\t\t\tif (t_end_date.valueOf() <= ev.start_date.valueOf()) {\n\t\t\t\t\tstack.splice(stack.length - 1, 1);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar slot_index = stack.length;\n\t\t\tvar sorderSet = false;\n\t\t\tfor (var j = 0; j < stack.length; j++) {\n\t\t\t\tvar t_ev = stack[j];\n\t\t\t\tvar t_end_date = this._get_event_mapped_end_date(t_ev);\n\t\t\t\tif (t_end_date.valueOf() <= ev.start_date.valueOf()) {\n\t\t\t\t\tsorderSet = true;\n\t\t\t\t\tev._sorder = t_ev._sorder;\n\t\t\t\t\tslot_index = j;\n\t\t\t\t\tev._inner = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (stack.length)\n\t\t\t\tstack[stack.length - 1]._inner = true;\n\n\t\t\tif (!sorderSet) {\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tif (stack.length <= stack[stack.length - 1]._sorder) {\n\t\t\t\t\t\tif (!stack[stack.length - 1]._sorder)\n\t\t\t\t\t\t\tev._sorder = 0;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tfor (j = 0; j < stack.length; j++) {\n\t\t\t\t\t\t\t\tvar _is_sorder = false;\n\t\t\t\t\t\t\t\tfor (var k = 0; k < stack.length; k++) {\n\t\t\t\t\t\t\t\t\tif (stack[k]._sorder == j) {\n\t\t\t\t\t\t\t\t\t\t_is_sorder = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!_is_sorder) {\n\t\t\t\t\t\t\t\t\tev._sorder = j;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tev._inner = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar _max_sorder = stack[0]._sorder;\n\t\t\t\t\t\tfor (j = 1; j < stack.length; j++) {\n\t\t\t\t\t\t\tif (stack[j]._sorder > _max_sorder)\n\t\t\t\t\t\t\t\t_max_sorder = stack[j]._sorder;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tev._sorder = _max_sorder + 1;\n\t\t\t\t\t\tev._inner = false;\n\t\t\t\t\t}\n\n\t\t\t\t} else\n\t\t\t\t\tev._sorder = 0;\n\t\t\t}\n\n\t\t\tstack.splice(slot_index, slot_index == stack.length ? 0 : 1, ev);\n\n\t\t\tif (stack.length > (stack.max_count || 0)) {\n\t\t\t\tstack.max_count = stack.length;\n\t\t\t\tev._count = stack.length;\n\t\t\t} else {\n\t\t\t\tev._count = (ev._count) ? ev._count : 1;\n\t\t\t}\n\t\t}\n\n\t\tif (sh < this.config.first_hour || eh >= this.config.last_hour) {\n\t\t\t// Need to create copy of event as we will be changing it's start/end date\n\t\t\t// e.g. first_hour = 11 and event.start_date hours = 9. Need to preserve that info\n\t\t\tevs_originals.push(ev);\n\t\t\tevs[i] = ev = this._copy_event(ev);\n\n\t\t\tif (sh < this.config.first_hour) {\n\t\t\t\tev.start_date.setHours(this.config.first_hour);\n\t\t\t\tev.start_date.setMinutes(0);\n\t\t\t}\n\t\t\tif (eh >= this.config.last_hour) {\n\t\t\t\tev.end_date.setMinutes(0);\n\t\t\t\tev.end_date.setHours(this.config.last_hour);\n\t\t\t}\n\n\t\t\tif (ev.start_date > ev.end_date || sh == this.config.last_hour) {\n\t\t\t\tevs.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\tif (!hold) {\n\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\tevs[i]._count = days[evs[i]._sday].max_count;\n\t\t}\n\t\tfor (var i = 0; i < evs_originals.length; i++)\n\t\t\tevs_originals[i]._count = days[evs_originals[i]._sday].max_count;\n\t}\n\n\treturn evs;\n};\nscheduler._time_order = function(evs) {\n\tevs.sort(function(a, b) {\n\t\tif (a.start_date.valueOf() == b.start_date.valueOf()) {\n\t\t\tif (a._timed && !b._timed) return 1;\n\t\t\tif (!a._timed && b._timed) return -1;\n\t\t\treturn a.id > b.id ? 1 : -1;\n\t\t}\n\t\treturn a.start_date > b.start_date ? 1 : -1;\n\t});\n};\n\nscheduler._is_any_multiday_cell_visible = function(from, to, event){\n\tvar cols = this._cols.length;\n\tvar isAnyCellVisible = false;\n\tvar checkDate = from;\n\tvar noCells = true;\n\tvar lastDayEnd = new Date(to);\n\tif(scheduler.date.day_start(new Date(to)).valueOf() != to.valueOf()){\n\t\tlastDayEnd = scheduler.date.day_start(lastDayEnd);\n\t\tlastDayEnd = scheduler.date.add(lastDayEnd, 1, \"day\");\n\t}\n\twhile(checkDate < lastDayEnd){\n\t\tnoCells = false;\n\t\tvar cellIndex = this.locate_holder_day(checkDate, false, event);\n\t\tvar weekCellIndex = cellIndex % cols;\n\t\tif(!this._ignores[weekCellIndex]){\n\t\t\tisAnyCellVisible = true;\n\t\t\tbreak;\n\t\t}\n\t\tcheckDate = scheduler.date.add(checkDate, 1, \"day\");\n\t}\n\treturn noCells || isAnyCellVisible;\n};\n\nscheduler._pre_render_events_table = function(evs, hold) { // max - max height of week slot\n\tthis._time_order(evs);\n\tvar out = [];\n\tvar weeks = [\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[]\n\t]; //events by weeks\n\tvar max = this._colsS.heights;\n\tvar start_date;\n\tvar cols = this._cols.length;\n\tvar chunks_info = {};\n\n\tfor (var i = 0; i < evs.length; i++) {\n\t\tvar ev = evs[i];\n\t\tvar id = ev.id;\n\t\tif (!chunks_info[id]) {\n\t\t\tchunks_info[id] = {\n\t\t\t\tfirst_chunk: true,\n\t\t\t\tlast_chunk: true\n\t\t\t};\n\t\t}\n\t\tvar chunk_info = chunks_info[id];\n\t\tvar sd = (start_date || ev.start_date);\n\t\tvar ed = ev.end_date;\n\t\t//trim events which are crossing through current view\n\t\tif (sd < this._min_date) {\n\t\t\tchunk_info.first_chunk = false;\n\t\t\tsd = this._min_date;\n\t\t}\n\t\tif (ed > this._max_date) {\n\t\t\tchunk_info.last_chunk = false;\n\t\t\ted = this._max_date;\n\t\t}\n\n\t\tvar locate_s = this.locate_holder_day(sd, false, ev);\n\t\tev._sday = locate_s % cols;\n\t\t//skip single day events for ignored dates\n\t\tif (this._ignores[ev._sday] && ev._timed) continue;\n\n\t\tvar locate_e = this.locate_holder_day(ed, true, ev) || cols;\n\t\tev._eday = (locate_e % cols) || cols; //cols used to fill full week, when event end on monday\n\t\tev._length = locate_e - locate_s;\n\t\t//3600000 - compensate 1 hour during winter|summer time shift\n\t\tev._sweek = Math.floor((this._correct_shift(sd.valueOf(), 1) - this._min_date.valueOf()) / (60 * 60 * 1000 * 24 * cols));\n\n\t\tvar isAnyCellVisible = scheduler._is_any_multiday_cell_visible(sd, ed, ev);\n\n\t\tif(!isAnyCellVisible){\n\t\t\tstart_date = null;\n\t\t\tcontinue;\n\t\t}\n\n\t\t//current slot\n\t\tvar stack = weeks[ev._sweek];\n\t\t//check order position\n\t\tvar stack_line;\n\n\t\tfor (stack_line = 0; stack_line < stack.length; stack_line++)\n\t\t\tif (stack[stack_line]._eday <= ev._sday)\n\t\t\t\tbreak;\n\n\t\tif (!ev._sorder || !hold) {\n\t\t\tev._sorder = stack_line;\n\t\t}\n\n\t\tif (ev._sday + ev._length <= cols) {\n\t\t\tstart_date = null;\n\t\t\tout.push(ev);\n\t\t\tstack[stack_line] = ev;\n\t\t\t//get max height of slot\n\t\t\tmax[ev._sweek] = stack.length - 1;\n\t\t\tev._first_chunk = chunk_info.first_chunk;\n\t\t\tev._last_chunk = chunk_info.last_chunk;\n\t\t} else { // split long event in chunks\n\t\t\tvar copy = this._copy_event(ev);\n\t\t\tcopy.id = ev.id;\n\t\t\tcopy._length = cols - ev._sday;\n\t\t\tcopy._eday = cols;\n\t\t\tcopy._sday = ev._sday;\n\t\t\tcopy._sweek = ev._sweek;\n\t\t\tcopy._sorder = ev._sorder;\n\t\t\tcopy.end_date = this.date.add(sd, copy._length, \"day\");\n\t\t\tcopy._first_chunk = chunk_info.first_chunk;\n\t\t\tif (chunk_info.first_chunk) {\n\t\t\t\tchunk_info.first_chunk = false;\n\t\t\t}\n\n\t\t\tout.push(copy);\n\t\t\tstack[stack_line] = copy;\n\t\t\tstart_date = copy.end_date;\n\t\t\t//get max height of slot\n\t\t\tmax[ev._sweek] = stack.length - 1;\n\t\t\ti--;\n\t\t\tcontinue;  //repeat same step\n\t\t}\n\t}\n\treturn out;\n};\nscheduler._copy_dummy = function() {\n\tvar a = new Date(this.start_date);\n\tvar b = new Date(this.end_date);\n\tthis.start_date = a;\n\tthis.end_date = b;\n};\nscheduler._copy_event = function(ev) {\n\tthis._copy_dummy.prototype = ev;\n\treturn new this._copy_dummy();\n\t//return {start_date:ev.start_date, end_date:ev.end_date, text:ev.text, id:ev.id}\n};\nscheduler._rendered = [];\nscheduler.clear_view = function() {\n\tfor (var i = 0; i < this._rendered.length; i++) {\n\t\tvar obj = this._rendered[i];\n\t\tif (obj.parentNode) obj.parentNode.removeChild(obj);\n\t}\n\tthis._rendered = [];\n};\nscheduler.updateEvent = function(id) {\n\tvar ev = this.getEvent(id);\n\tthis.clear_event(id);\n\n\tif (ev && this.is_visible_events(ev) && this.filter_event(id, ev) && (this._table_view || this.config.multi_day || ev._timed)) {\n\t\tif (this.config.update_render){\n\t\t\tthis.render_view_data();\n\t\t}else{\n\t\t\tif(this.getState().mode == \"month\" && !this.getState().drag_id && !this.isOneDayEvent(ev)){\n\t\t\t\tthis.render_view_data();\n\t\t\t}else{\n\t\t\t\tthis.render_view_data([ev], true);\n\t\t\t}\n\t\t}\n\t}\n};\nscheduler.clear_event = function(id) {\n\tthis.for_rendered(id, function(node, i) {\n\t\tif (node.parentNode)\n\t\t\tnode.parentNode.removeChild(node);\n\t\tscheduler._rendered.splice(i, 1);\n\t});\n};\nscheduler._y_from_date = function(date){\n\tvar sm = date.getHours() * 60 + date.getMinutes();\n\treturn ((Math.round((sm * 60 * 1000 - this.config.first_hour * 60 * 60 * 1000) * this.config.hour_size_px / (60 * 60 * 1000))) % (this.config.hour_size_px * 24)); //42px/hour\n};\nscheduler._calc_event_y = function(ev, min_height){\n\tmin_height = min_height || 0;\n\tvar sm = ev.start_date.getHours() * 60 + ev.start_date.getMinutes();\n\tvar em = (ev.end_date.getHours() * 60 + ev.end_date.getMinutes()) || (scheduler.config.last_hour * 60);\n\tvar top = this._y_from_date(ev.start_date);\n\n\tvar height = Math.max(min_height, (em - sm) * this.config.hour_size_px / 60); //42px/hour\n\treturn {\n\t\ttop: top,\n\t\theight: height\n\t};\n};\nscheduler.render_event = function(ev, buffer, parentWidth) {\n\tvar menu = scheduler.xy.menu_width;\n\tvar menu_offset = (this.config.use_select_menu_space) ? 0 : menu;\n\tif (ev._sday < 0) return; //can occur in case of recurring event during time shift\n\n\tvar parent = scheduler.locate_holder(ev._sday);\n\tif (!parent) return; //attempt to render non-visible event\n\n\tbuffer = buffer || parent;\n\n\tvar pos_y = this._calc_event_y(ev, scheduler.xy.min_event_height);\n\tvar top = pos_y.top,\n\t\theight = pos_y.height;\n\n\tvar ev_count = ev._count || 1;\n\tvar ev_sorder = ev._sorder || 0;\n\n\tparentWidth = parentWidth || parent.clientWidth;\n\tif(this.config.day_column_padding){\n\t\tparentWidth -= this.config.day_column_padding;\n\t}\n\n\tvar width = Math.floor((parentWidth - menu_offset) / ev_count);\n\tvar left = ev_sorder * width + 1;\n\tif (!ev._inner) width = width * (ev_count - ev_sorder);\n\tif (this.config.cascade_event_display) {\n\t\tconst limit = this.config.cascade_event_count;\n\t\tconst margin = this.config.cascade_event_margin;\n\t\tlet right;\n\t\tlet marginRight = (ev_count - ev_sorder - 1) % limit * margin; \n\t\tlet marginLeft = ev_sorder % limit * margin; \n\t\tif (ev_count * margin < parentWidth - this.config.day_column_padding){\n\t\t\tright = (ev._inner) ? marginRight / 2: 0;\n\t\t} else {\n\t\t\tright = (ev._inner) ? marginRight / 3: 0;\n\t\t\tleft = marginLeft / 3;\n\t\t\tif (ev_count * margin / 2 > parentWidth - this.config.day_column_padding) {\n\t\t\t\tright = (ev._inner) ? marginRight / limit: 0;\n\t\t\t\tleft = marginLeft / limit;\n\t\t\t}\n\t\t}\n\t\twidth = Math.floor(parentWidth - menu_offset - left - right);\n\t}\n\n\tif(height < 30){\n\t\tev._mode = \"smallest\";\n\t}else if(height < 42){\n\t\tev._mode = \"small\";\n\t}else{\n\t\tev._mode = null;\n\t}\n\n\tvar d = this._render_v_bar(ev, menu_offset + left, top, width, height, ev._text_style, scheduler.templates.event_header(ev.start_date, ev.end_date, ev), scheduler.templates.event_text(ev.start_date, ev.end_date, ev));\n\t\n\tif(ev._mode === \"smallest\"){\n\t\td.classList.add(\"dhx_cal_event--xsmall\");\n\t}else if (ev._mode === \"small\"){\n\t\td.classList.add(\"dhx_cal_event--small\");\n\t}\n\n\tthis._waiAria.eventAttr(ev, d);\n\tthis._rendered.push(d);\n\tbuffer.appendChild(d);\n\n\tvar parentPosition = parseInt( this.config.rtl ? parent.style.right : parent.style.left, 10);\n\n\tleft = left + parentPosition + menu_offset;\n\n\tif (this._edit_id == ev.id) {\n\n\t\td.style.zIndex = 1; //fix overlapping issue\n\t\twidth = Math.max(width, scheduler.xy.editor_width);\n\t\td = document.createElement(\"div\");\n\t\td.setAttribute(\"event_id\", ev.id); // for backward compatibility\n\t\td.setAttribute(this.config.event_attribute, ev.id);\n\n\t\tthis._waiAria.eventAttr(ev, d);\n\n\t\td.className = \"dhx_cal_event dhx_cal_editor\";\n\t\tif (this.config.rtl) left++;\n\t\tthis.set_xy(d, width, height, left, top);\n\n\n\t\tif(ev.color){\n\t\t\td.style.setProperty(\"--dhx-scheduler-event-background\", ev.color);\n\t\t}\n\t\tvar tplClass = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\n\n\t\tif(tplClass){\n\t\t\td.className += \" \" + tplClass;\n\t\t}\n\t\tvar d2 = document.createElement(\"div\");\n\t\td2.style.cssText += \"overflow:hidden;height:100%\";\n\n\t\td.appendChild(d2);\n\t\tthis._els[\"dhx_cal_data\"][0].appendChild(d);\n\t\tthis._rendered.push(d);\n\n\t\td2.innerHTML = \"<textarea class='dhx_cal_editor'>\" + ev.text + \"</textarea>\";\n\t\tthis._editor = d2.querySelector(\"textarea\");\n\t\t\n\t\tscheduler.event(this._editor, \"keydown\", function(e) {\n\t\t\tif (e.shiftKey) return true;\n\t\t\tvar code = e.keyCode;\n\t\t\tif (code == scheduler.keys.edit_save) scheduler.editStop(true);\n\t\t\tif (code == scheduler.keys.edit_cancel) scheduler.editStop(false);\n\n\t\t\tif(code == scheduler.keys.edit_save || code == scheduler.keys.edit_cancel){\n\t\t\t\tif(e.preventDefault) e.preventDefault();\n\t\t\t}\n\t\t});\n\t\tscheduler.event(this._editor, \"selectstart\", function (e) {\n\t\t\te.cancelBubble = true;\n\t\t\treturn true;\n\t\t});\n\t\tscheduler._focus(this._editor, true);\n\t\t//IE and opera can add x-scroll during focusing\n\t\tthis._els[\"dhx_cal_data\"][0].scrollLeft = 0;\n\t}\n\tif (this.xy.menu_width !== 0 && this._select_id == ev.id) {\n\n\t\tif (this.config.cascade_event_display && this._drag_mode)\n\t\t\td.style.zIndex = 1; //fix overlapping issue for cascade view in case of dnd of selected event\n\t\tvar icons = this.config[\"icons_\" + ((this._edit_id == ev.id) ? \"edit\" : \"select\")];\n\t\tvar icons_str = \"\";\n\n\t\tvar ariaAttr;\n\n\t\tfor (var i = 0; i < icons.length; i++) {\n\t\t\tconst currentIcon = icons[i];\n\t\t\tariaAttr = this._waiAria.eventMenuAttrString(currentIcon);\n\t\t\ticons_str += `<div class='dhx_menu_icon ${currentIcon}' title='${this.locale.labels[currentIcon]}' ${ariaAttr}></div>`;\n\t\t}\n\t\tvar obj = this._render_v_bar(ev, left - menu - 1, top, menu, null, \"\", \"<div class='dhx_menu_head'></div>\", icons_str, true);\n\n\t\tif(ev.color){\n\t\t\tobj.style.setProperty(\"--dhx-scheduler-event-background\", ev.color);\n\t\t}\n\t\tif(ev.textColor){\n\t\t\tobj.style.setProperty(\"--dhx-scheduler-event-color\", ev.textColor);\n\t\t}\n\n\t\t//obj.style.left = left - menu + 1;\n\t\tthis._els[\"dhx_cal_data\"][0].appendChild(obj);\n\t\tthis._rendered.push(obj);\n\t}\n\tif(this.config.drag_highlight && this._drag_id == ev.id){\n\t\tthis.highlightEventPosition(ev);\n\t}\n};\nscheduler._render_v_bar = function (ev, x, y, w, h, style, contentA, contentB, bottom) {\n\tvar d = document.createElement(\"div\");\n\tvar id = ev.id;\n\tvar cs = (bottom) ? \"dhx_cal_event dhx_cal_select_menu\" : \"dhx_cal_event\";\n\n\tvar state = scheduler.getState();\n\tif(state.drag_id == ev.id){\n\t\tcs += \" dhx_cal_event_drag\";\n\t}\n\n\tif(state.select_id == ev.id){\n\t\tcs += \" dhx_cal_event_selected\";\n\t}\n\n\tvar cse = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\n\tif (cse) cs = cs + \" \" + cse;\n\n\tif(this.config.cascade_event_display) {\n\t\tcs += \" dhx_cal_event_cascade\";\n\t}\n\n\tvar boxWidth = w - 1;\n\tvar html = `<div event_id=\"${id}\" ${this.config.event_attribute}=\"${id}\" class=\"${cs}\"\n\t\t\t\tstyle=\"position:absolute; top:${y}px; ${((this.config.rtl) ? 'right:':'left:')}${x}px; width:${boxWidth}px; height:${h}px; ${(style || \"\")}\" \n\t\t\t\tdata-bar-start=\"${ev.start_date.valueOf()}\" data-bar-end=\"${ev.end_date.valueOf()}\">\n\t\t\t\t</div>`;\n\n\td.innerHTML = html;\n\n\tvar container = d.cloneNode(true).firstChild;\n\n\tif (!bottom && scheduler.renderEvent(container, ev, w, h, contentA, contentB)) {\n\t\tif(ev.color){\n\t\t\tcontainer.style.setProperty(\"--dhx-scheduler-event-background\", ev.color);\n\t\t}\n\t\tif(ev.textColor){\n\t\t\tcontainer.style.setProperty(\"--dhx-scheduler-event-color\", ev.textColor);\n\t\t}\n\n\t\treturn container;\n\t} else {\n\t\tcontainer = d.firstChild;\n\t\tif(ev.color){\n\t\t\tcontainer.style.setProperty(\"--dhx-scheduler-event-background\", ev.color);\n\t\t}\n\t\tif(ev.textColor){\n\t\t\tcontainer.style.setProperty(\"--dhx-scheduler-event-color\", ev.textColor);\n\t\t}\n\n\t\tvar inner_html = '<div class=\"dhx_event_move dhx_header\" >&nbsp;</div>';\n\t\tinner_html += '<div class=\"dhx_event_move dhx_title\">' + contentA + '</div>';\n\t\tinner_html += '<div class=\"dhx_body\">' + contentB + '</div>'; // +2 css specific, moved from render_event\n\n\t\tvar footer_class = \"dhx_event_resize dhx_footer\";\n\t\tif (bottom || ev._drag_resize === false)\n\t\t\tfooter_class = \"dhx_resize_denied \" + footer_class;\n\n\t\tinner_html += '<div class=\"' + footer_class + '\" style=\" width:' + (bottom ? ' margin-top:-1px;' : '') + '\" ></div>';\n\n\t\tcontainer.innerHTML = inner_html;\n\t}\n\n\treturn container;\n};\nscheduler.renderEvent = function(){\n\treturn false;\n};\nscheduler.locate_holder = function(day) {\n\tif (this._mode == \"day\") return this._els[\"dhx_cal_data\"][0].firstChild; //dirty\n\treturn this._els[\"dhx_cal_data\"][0].childNodes[day];\n};\nscheduler.locate_holder_day = function(date, past) {\n\tvar day = Math.floor((this._correct_shift(date, 1) - this._min_date) / (60 * 60 * 24 * 1000));\n\t//when locating end data of event , we need to use next day if time part was defined\n\tif (past && this.date.time_part(date)) day++;\n\treturn day;\n};\n\n\n\nscheduler._get_dnd_order = function(order, ev_height, max_height){\n\tif(!this._drag_event)\n\t\treturn order;\n\tif(!this._drag_event._orig_sorder)\n\t\tthis._drag_event._orig_sorder = order;\n\telse\n\t\torder = this._drag_event._orig_sorder;\n\n\tvar evTop = ev_height * order;\n\twhile((evTop + ev_height) > max_height){\n\t\torder--;\n\t\tevTop -= ev_height;\n\t}\n\torder = Math.max(order, 0);\n\treturn order;\n};\n//scheduler._get_event_bar_pos = function(sday, eday, week, drag){\nscheduler._get_event_bar_pos = function(ev){\n\tvar rtl = this.config.rtl;\n\tvar columns = this._colsS;\n\tvar x = columns[ev._sday];\n\tvar x2 = columns[ev._eday];\n\tif (rtl) {\n\t\tx = columns[columns.col_length] - columns[ev._eday] + columns[0];\n\t\tx2 = columns[columns.col_length] - columns[ev._sday] + columns[0];\n\t}\n\n\tif (x2 == x) x2 = columns[ev._eday + 1];\n\tvar hb = this.xy.bar_height;\n\n\tvar order = ev._sorder;\n\tif(ev.id == this._drag_id){\n\t\tvar cellHeight = columns.heights[ev._sweek + 1] - columns.heights[ev._sweek]- this.xy.month_head_height;//22 for month head height\n\t\torder = scheduler._get_dnd_order(order, hb, cellHeight);\n\t}\n\tvar y_event_offset =  order * hb;\n\tvar y = columns.heights[ev._sweek] + (columns.height ? (this.xy.month_scale_height + 2) : 2 ) + y_event_offset;\n\treturn {x:x, x2:x2, y:y};\n};\n\nscheduler.render_event_bar = function (ev) {\n\tvar parent = this._rendered_location;\n\tvar pos = this._get_event_bar_pos(ev);\n\tvar y = pos.y;\n\tvar x = pos.x;\n\tvar x2 = pos.x2;\n\t// resize for month mutliday events\n\tvar resize_handle = \"\";\n\n\t//events in ignored dates\n\n\tif (!x2) return;\n\n\tvar resizable = scheduler.config.resize_month_events && this._mode == \"month\" &&\n\t\t(!ev._timed || scheduler.config.resize_month_timed);\n\n\tvar d = document.createElement(\"div\");\n\tvar left_chunk = (ev.hasOwnProperty(\"_first_chunk\") && ev._first_chunk),\n\t\tright_chunk = (ev.hasOwnProperty(\"_last_chunk\") && ev._last_chunk);\n\n\tvar resize_left = resizable && (ev._timed || left_chunk);\n\tvar resize_right = resizable && (ev._timed || right_chunk);\n\n\tvar timed = true;\n\tvar cs = \"dhx_cal_event_clear\";\n\tif (!ev._timed || resizable) {\n\t\ttimed = false;\n\t\tcs = \"dhx_cal_event_line\";\n\t}\n\tif(left_chunk){\n\t\tcs += \" dhx_cal_event_line_start\";\n\t}\n\tif(right_chunk){\n\t\tcs += \" dhx_cal_event_line_end\";\n\t}\n\tif(resize_left){\n\t\tresize_handle += \"<div class='dhx_event_resize dhx_event_resize_start'></div>\";\n\t}\n\tif(resize_right){\n\t\tresize_handle += \"<div class='dhx_event_resize dhx_event_resize_end'></div>\";\n\t}\n\n\tvar cse = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\n\tif (cse){\n\t\tcs += \" \" + cse;\n\t}\n\n\tvar bg_color = (ev.color ? (\"--dhx-scheduler-event-background:\" + ev.color + \";\") : \"\");\n\tvar color = (ev.textColor ? (\"--dhx-scheduler-event-color:\" + ev.textColor + \";\") : \"\");\n\n\tvar style_text = [\n\t\t\"position:absolute\",\n\t\t\"top:\" + y + \"px\",\n\t\t\"left:\" + x + \"px\",\n\t\t\"width:\" + (x2 - x - (timed ? 1 : 0)) + \"px\",\n\t\t\"height:\" + (this.xy.bar_height - 2) + \"px\",\n\t\tcolor,\n\t\tbg_color,\n\t\t(ev._text_style || \"\")\n\t].join(\";\");\n\n\tvar html = \"<div event_id='\" + ev.id + \"' \" + this.config.event_attribute + \"='\" + ev.id + \"' class='\"+ cs + \"' style='\"+style_text+\"'\"+this._waiAria.eventBarAttrString(ev)+\">\";\n\tif (resizable) {\n\t\thtml += resize_handle;\n\t}\n\t// GS-2578: dnd temp event comes from parameter, and here we got already modified event\n\tif(scheduler.getState().mode == \"month\" && !ev._beforeEventChangedFlag){\n\t\tev = scheduler.getEvent(ev.id); // ev at this point could be a part (row in a month view) of a larger event\n\t}\n\n\tif (ev._timed){\n\t\thtml += `<span class='dhx_cal_event_clear_date'>${scheduler.templates.event_bar_date(ev.start_date, ev.end_date, ev)}</span>`;\n\t}\n\n\thtml += \"<div class='dhx_cal_event_line_content'>\";\n\thtml += scheduler.templates.event_bar_text(ev.start_date, ev.end_date, ev) + '</div>';\n\thtml += \"</div>\";\n\thtml += '</div>';\n\n\td.innerHTML = html;\n\n\tthis._rendered.push(d.firstChild);\n\tparent.appendChild(d.firstChild);\n};\n\nscheduler._locate_event = function(node) {\n\tvar id = null;\n\twhile (node && !id && node.getAttribute) {\n\t\tid = node.getAttribute(this.config.event_attribute);\n\t\tnode = node.parentNode;\n\t}\n\treturn id;\n};\n\nscheduler.edit = function(id) {\n\tif (this._edit_id == id) return;\n\tthis.editStop(false, id);\n\tthis._edit_id = id;\n\tthis.updateEvent(id);\n};\nscheduler.editStop = function(mode, id) {\n\tif (id && this._edit_id == id) return;\n\tvar ev = this.getEvent(this._edit_id);\n\tif (ev) {\n\t\tif (mode) ev.text = this._editor.value;\n\t\tthis._edit_id = null;\n\t\tthis._editor = null;\n\t\tthis.updateEvent(ev.id);\n\t\tthis._edit_stop_event(ev, mode);\n\t}\n};\nscheduler._edit_stop_event = function(ev, mode) {\n\tif (this._new_event) {\n\t\tif (!mode) {\n\t\t\tif (ev) // in case of custom lightbox user can already delete event\n\t\t\t\tthis.deleteEvent(ev.id, true);\n\t\t} else {\n\t\t\tthis.callEvent(\"onEventAdded\", [ev.id, ev]);\n\t\t}\n\t\tthis._new_event = null;\n\t} else {\n\t\tif (mode){\n\t\t\tthis.callEvent(\"onEventChanged\", [ev.id, ev]);\n\t\t}\n\t}\n};\n\nscheduler.getEvents = function(from, to) {\n\tvar result = [];\n\tfor (var a in this._events) {\n\t\tvar ev = this._events[a];\n\t\tif (ev && ( (!from && !to) || (ev.start_date < to && ev.end_date > from) ))\n\t\t\tresult.push(ev);\n\t}\n\treturn result;\n};\nscheduler.getRenderedEvent = function(id) {\n\tif (!id)\n\t\treturn;\n\tvar rendered_events = scheduler._rendered;\n\tfor (var i=0; i<rendered_events.length; i++) {\n\t\tvar rendered_event = rendered_events[i];\n\t\tif (rendered_event.getAttribute(scheduler.config.event_attribute) == id) {\n\t\t\treturn rendered_event;\n\t\t}\n\t}\n\treturn null;\n};\nscheduler.showEvent = function(id, mode) {\n\tvar section;\n\tif(id && typeof id === \"object\"){\n\t\tmode = id.mode;\n\t\tsection = id.section;\n\t\tid = id.section;\n\t}\n\tvar ev = (typeof id == \"number\" || typeof id == \"string\") ? scheduler.getEvent(id) : id;\n\tmode = mode||scheduler._mode;\n\n\tif (!ev || (this.checkEvent(\"onBeforeEventDisplay\") && !this.callEvent(\"onBeforeEventDisplay\", [ev, mode])))\n\t\treturn;\n\n\tvar scroll_hour = scheduler.config.scroll_hour;\n\tscheduler.config.scroll_hour = ev.start_date.getHours();\n\tvar preserve_scroll = scheduler.config.preserve_scroll;\n\tscheduler.config.preserve_scroll = false;\n\n\tvar original_color = ev.color;\n\tvar original_text_color = ev.textColor;\n\tif (scheduler.config.highlight_displayed_event) {\n\t\tev.color = scheduler.config.displayed_event_color;\n\t\tev.textColor = scheduler.config.displayed_event_text_color;\n\t}\n\n\tscheduler.setCurrentView(new Date(ev.start_date), mode);\n\n\tfunction restoreOriginalColors(){\n\t\tev.color = original_color;\n\t\tev.textColor = original_text_color;\n\t}\n\n\tscheduler.config.scroll_hour = scroll_hour;\n\tscheduler.config.preserve_scroll = preserve_scroll;\n\n\tif (scheduler.matrix && scheduler.matrix[mode]) {\n\t\tvar timeline = scheduler.getView();\n\t\tvar property = timeline.y_property;\n\n\t\tvar event = scheduler.getEvent(ev.id);\n\n\t\tif(event){\n\t\t\tif(!section){\n\t\t\t\tvar section = event[property];\n\t\t\t\tif(Array.isArray(section)){\n\t\t\t\t\tsection = section[0];\n\t\t\t\t}else if(typeof section === \"string\" && scheduler.config.section_delimiter && section.indexOf(scheduler.config.section_delimiter) > -1){\n\t\t\t\t\tsection = section.split(scheduler.config.section_delimiter)[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar top = timeline.getSectionTop(section);\n\t\t\tvar left = timeline.posFromDate(event.start_date);\n\t\t\tvar container = scheduler.$container.querySelector(\".dhx_timeline_data_wrapper\");\n\t\t\tleft = left - (container.offsetWidth - timeline.dx) / 2;\n\t\t\ttop = top - container.offsetHeight / 2 + timeline.dy/2;\n\n\t\t\tif (timeline._smartRenderingEnabled()) {\n\t\t\t\tvar handlerId = timeline.attachEvent(\"onScroll\", function(){\n\t\t\t\t\trestoreOriginalColors();\n\t\t\t\t\ttimeline.detachEvent(handlerId);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttimeline.scrollTo({\n\t\t\t\tleft: left,\n\t\t\t\ttop: top\n\t\t\t});\n\t\t\tif (!timeline._smartRenderingEnabled()) {\n\t\t\t\trestoreOriginalColors();\n\t\t\t}\n\t\t}\n\t}else{\n\t\trestoreOriginalColors();\n\t}\n\n\tscheduler.callEvent(\"onAfterEventDisplay\", [ev, mode]);\n};\n\n\n}","export default function extend(scheduler) {\n\n\nscheduler._append_drag_marker = function(m){\n\tif(m.parentNode) return;\n\tvar zone = scheduler._els[\"dhx_cal_data\"][0];\n\n\tvar scale = zone.lastChild;\n\tvar className = scheduler._getClassName(scale);\n\tif(className.indexOf(\"dhx_scale_holder\") < 0 && scale.previousSibling){\n\t\tscale = scale.previousSibling;\n\t}\n\n\tclassName = scheduler._getClassName(scale);\n\tif (scale && className.indexOf(\"dhx_scale_holder\") === 0) {\n\t\tscale.appendChild(m);\n\t}\n};\n\nscheduler._update_marker_position = function(m, event){\n\tvar size = scheduler._calc_event_y(event, 0);\n\tm.style.top = size.top + \"px\";\n\tm.style.height = size.height + \"px\";\n};\n\nscheduler.highlightEventPosition = function(event){\n\tvar m = document.createElement(\"div\");\n\n\tm.setAttribute(\"event_id\", event.id); // for backward compatibility\n\tm.setAttribute(this.config.event_attribute, event.id);\n\tthis._rendered.push(m);\n\tthis._update_marker_position(m, event);\n\n\tvar css = this.templates.drag_marker_class(event.start_date, event.end_date, event);\n\tvar html = this.templates.drag_marker_content(event.start_date, event.end_date, event);\n\tm.className = \"dhx_drag_marker\";\n\tif(css)\n\t\tm.className += \" \" + css;\n\tif(html)\n\t\tm.innerHTML = html;\n\tthis._append_drag_marker(m);\n};\n\n}","export default function extend(scheduler) {\n\nscheduler.getRootView = function() {\n\treturn {\n\t\tview: {\n\t\t\trender: function(){\n\t\t\t\treturn {\n\t\t\t\t\ttag: \"div\",\n\t\t\t\t\ttype: 1,\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tstyle: \"width:100%;height:100%;\"\n\t\t\t\t\t},\n\t\t\t\t\thooks: {\n\t\t\t\t\t\t\"didInsert\": function(){\n\t\t\t\t\t\t\tscheduler.setCurrentView();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tbody: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tel: this.el,\n\t\t\t\t\t\t\ttype: 1\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t},\n\t\t\tinit: function(){\n\t\t\t\tvar container = document.createElement(\"DIV\");\n\t\t\t\tcontainer.id = \"scheduler_\"+ scheduler.uid();\n\t\t\t\tcontainer.style.width = \"100%\";\n\t\t\t\tcontainer.style.height = \"100%\";\n\t\t\t\tcontainer.classList.add(\"dhx_cal_container\");\n\t\t\t\tcontainer.cmp = \"grid\";\n\t\t\t\tcontainer.innerHTML = '<div class=\"dhx_cal_navline\">' +\n\t\t\t\t\t'<div class=\"dhx_cal_prev_button\"></div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_next_button\"></div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_today_button\"></div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_date\"></div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_tab\" data-tab=\"day\"></div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_tab\" data-tab=\"week\"></div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_tab\" data-tab=\"month\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_header\">' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"dhx_cal_data\">' +\n\t\t\t\t\t'</div>';\n\t\t\t\tscheduler.init(container);\n\n\t\t\t\tthis.el = container;\n\t\t\t}\n\t\t},\n\t\ttype: 4\n\t};\n};\n\n}","import global from \"../global\";\n\nexport default function extend(scheduler) {\n\n(function(){\n\n\tvar setCurrentView = scheduler.setCurrentView,\n\t\tupdateView = scheduler.updateView;\n\tvar update_view_timer = null,\n\t\tcurr_view_timer = null;\n\n\tvar lazy_setCurrentView = function(date, mode){\n\t\tvar self = this;\n\t\tglobal.clearTimeout(curr_view_timer);\n\t\tglobal.clearTimeout(update_view_timer);\n\n\t\tvar oldDate = self._date,\n\t\t\toldMode = self._mode;\n\t\tupdateFlags(this, date, mode);\n\n\t\tcurr_view_timer = setTimeout(function(){\n\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!self.callEvent(\"onBeforeViewChange\", [oldMode, oldDate, mode || self._mode, date || self._date])){\n\t\t\t\tupdateFlags(self, oldDate, oldMode);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdateView.call(self, date, mode);\n\t\t\tself.callEvent(\"onViewChange\", [self._mode, self._date]);\n\n\t\t\tglobal.clearTimeout(update_view_timer);\n\t\t\tcurr_view_timer = 0;\n\t\t}, scheduler.config.delay_render);\n\t};\n\tvar lazy_updateView = function(date, mode){\n\t\tvar self = this,\n\t\t\tars = arguments;\n\n\t\tupdateFlags(this, date, mode);\n\n\t\tglobal.clearTimeout(update_view_timer);\n\t\tupdate_view_timer = setTimeout(function(){\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(curr_view_timer)\n\t\t\t\treturn;\n\n\t\t\tupdateView.apply(self, ars);\n\t\t}, scheduler.config.delay_render);\n\t};\n\tfunction updateFlags(scheduler, date, mode){\n\t\tif(date)\n\t\t\tscheduler._date = date;\n\t\tif(mode)\n\t\t\tscheduler._mode = mode;\n\n\t}\n\tscheduler.attachEvent(\"onSchedulerReady\", function(){\n\t\tif(scheduler.config.delay_render){\n\t\t\tscheduler.setCurrentView = lazy_setCurrentView;\n\t\t\tscheduler.updateView = lazy_updateView;\n\t\t}else{\n\t\t\tscheduler.setCurrentView = setCurrentView;\n\t\t\tscheduler.updateView = updateView;\n\t\t}\n\t});\n\n})();\n\n}","import global from \"../global\";\n\nexport default function extend(scheduler) {\n/*\nif (global.dataProcessor && !dataProcessor.prototype.init_original){\n\tdataProcessor.prototype.init_original=dataProcessor.prototype.init;\n\tdataProcessor.prototype.init=function(obj){\n\t\tthis.init_original(obj);\n\t\tobj._dataprocessor=this;\n\n\t\tthis.setTransactionMode(\"POST\",true);\n\t\tthis.serverProcessor+=(this.serverProcessor.indexOf(\"?\")!=-1?\"&\":\"?\")+\"editing=true\";\n\t};\n}*/\n\nscheduler.attachEvent(\"onSchedulerReady\", function(){\n\tif(typeof dhtmlxError !== \"undefined\") {\n\t\twindow.dhtmlxError.catchError(\"LoadXML\", function(a, b, c){\n\t\t\tvar message = c[0].responseText;\n\n\t\t\tswitch (scheduler.config.ajax_error){\n\t\t\t\tcase \"alert\":\n\t\t\t\t\tglobal.alert(message);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"console\":\n\t\t\t\t\tglobal.console.log(message);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n});\n\n\n}","import ar from \"./locale_ar\";\nimport be from \"./locale_be\";\nimport ca from \"./locale_ca\";\nimport cn from \"./locale_cn\";\nimport cs from \"./locale_cs\";\nimport da from \"./locale_da\";\nimport de from \"./locale_de\";\nimport el from \"./locale_el\";\nimport en from \"./locale_en\";\nimport es from \"./locale_es\";\nimport fi from \"./locale_fi\";\nimport fr from \"./locale_fr\";\nimport he from \"./locale_he\";\nimport hu from \"./locale_hu\";\nimport id from \"./locale_id\";\nimport it from \"./locale_it\";\nimport jp from \"./locale_jp\";\n\nimport LocaleManager from \"./locale_manager\";\n\nimport nb from \"./locale_nb\";\nimport nl from \"./locale_nl\";\nimport no from \"./locale_no\";\nimport pl from \"./locale_pl\";\nimport pt from \"./locale_pt\";\nimport ro from \"./locale_ro\";\nimport ru from \"./locale_ru\";\nimport si from \"./locale_si\";\nimport sk from \"./locale_sk\";\nimport sv from \"./locale_sv\";\nimport tr from \"./locale_tr\";\nimport ua from \"./locale_ua\";\n\nexport default function(){\n\treturn new LocaleManager({\n\t\ten,\n\t\tar,\n\t\tbe,\n\t\tca,\n\t\tcn,\n\t\tcs,\n\t\tda,\n\t\tde,\n\t\tel,\n\t\tes,\n\t\tfi,\n\t\tfr,\n\t\the,\n\t\thu,\n\t\tid,\n\t\tit,\n\t\tjp,\n\t\tnb,\n\t\tnl,\n\t\tno,\n\t\tpl,\n\t\tpt,\n\t\tro,\n\t\tru,\n\t\tsi,\n\t\tsk,\n\t\tsv,\n\t\ttr,\n\t\tua\n\t});\n}","export default class ExtensionsManager{\n\tconstructor(config){\n\t\tthis._extensions = {};\n\t\tfor(const i in config){\n\t\t\tthis._extensions[i] = config[i];\n\t\t}\n\t}\n\n\taddExtension(name, ext) {\n\t\tthis._extensions[name] = ext;\n\t}\n\n\tgetExtension(name) {\n\t\treturn this._extensions[name];\n\t}\n}","\nexport default function(){\n/* global dhtmlx */\nif (typeof dhtmlx != \"undefined\" && dhtmlx.attaches) {\n\tdhtmlx.attaches.attachScheduler = function (day, mode, tabs, scheduler) {\n\t\tvar tabs = tabs || '<div class=\"dhx_cal_tab\" name=\"day_tab\" data-tab=\"day\" style=\"right:204px;\"></div><div class=\"dhx_cal_tab\" name=\"week_tab\" data-tab=\"week\" style=\"right:140px;\"></div><div class=\"dhx_cal_tab\" name=\"month_tab\" data-tab=\"month\" style=\"right:76px;\"></div>';\n\t\tvar obj = document.createElement(\"DIV\");\n\t\tobj.id = \"dhxSchedObj_\" + this._genStr(12);\n\t\tobj.innerHTML = '<div id=\"' + obj.id + '\" class=\"dhx_cal_container\" style=\"width:100%; height:100%;\"><div class=\"dhx_cal_navline\"><div class=\"dhx_cal_prev_button\"></div><div class=\"dhx_cal_next_button\"></div><div class=\"dhx_cal_today_button\"></div><div class=\"dhx_cal_date\"></div>' + tabs + '</div><div class=\"dhx_cal_header\"></div><div class=\"dhx_cal_data\"></div></div>';\n\t\tdocument.body.appendChild(obj.firstChild);\n\n\t\tthis.attachObject(obj.id, false, true);\n\n\t\tthis.vs[this.av].sched = scheduler;\n\t\tthis.vs[this.av].schedId = obj.id;\n\t\tscheduler.setSizes = scheduler.updateView;\n\t\tscheduler.destructor = function () { };\n\t\tscheduler.init(obj.id, day, mode);\n\n\t\treturn this.vs[this._viewRestore()].sched;\n\t};\n}\n\n}","export default function extend(scheduler) {\n\n\n/**\n * helpers for Multisection and Daily timeline events\n * Preserve _sorder and _count calculated for virtual events, so event position won't change when it refreshed individually\n * @private\n */\n\nif (!scheduler._inited_multisection_copies) {\n\tscheduler.attachEvent(\"onEventIdChange\", function (old_id, new_id) {\n\t\tvar copies = this._multisection_copies;\n\t\tif (!copies) return;\n\n\t\tif (copies[old_id] && !copies[new_id]) {\n\t\t\tvar eventCopies = copies[old_id];\n\t\t\tdelete copies[old_id];\n\t\t\tcopies[new_id] = eventCopies;\n\t\t}\n\t});\n\tscheduler._inited_multisection_copies = true;\n}\n\nscheduler._register_copies_array = function(evs){\n\tfor(var i=0; i < evs.length; i++)\n\t\tthis._register_copy(evs[i]);\n};\nscheduler._register_copy = function(copy){\n\tif(!this._multisection_copies){\n\t\treturn;\n\t}\n\n\tif(!this._multisection_copies[copy.id]){\n\t\tthis._multisection_copies[copy.id] = {};\n\t}\n\tvar section = copy[this._get_section_property()];\n\tvar evs = this._multisection_copies[copy.id];\n\tevs[section] = copy;\n};\nscheduler._get_copied_event = function(event_id, section){\n\tif(!this._multisection_copies[event_id])\n\t\treturn null;\n\n\tif(this._multisection_copies[event_id][section])\n\t\treturn this._multisection_copies[event_id][section];\n\n\tvar parts = this._multisection_copies[event_id];\n\t//multisection event has not been rendered in this section, need retrieve state of one of rendered events\n\tif(scheduler._drag_event && scheduler._drag_event._orig_section && parts[scheduler._drag_event._orig_section]){\n\t\treturn parts[scheduler._drag_event._orig_section];\n\t}else{\n\t\tvar min_sorder = Infinity,\n\t\t\tev = null;\n\t\tfor(var i in parts){\n\t\t\tif(parts[i]._sorder < min_sorder){\n\t\t\t\tev = parts[i];\n\t\t\t\tmin_sorder = parts[i]._sorder;\n\t\t\t}\n\t\t}\n\t\treturn ev;\n\t}\n};\nscheduler._clear_copied_events = function(){\n\tthis._multisection_copies = {};\n};\n\nscheduler._restore_render_flags = function(section_evs){\n\tvar map_to = this._get_section_property();\n\tfor(var i=0; i < section_evs.length; i++){\n\t\tvar ev = section_evs[i];\n\t\tvar prev_state = scheduler._get_copied_event(ev.id, ev[map_to]);\n\t\tif(prev_state){\n\t\t\tfor(var p in prev_state){\n\t\t\t\tif(p.indexOf(\"_\") === 0){\n\t\t\t\t\tev[p] = prev_state[p];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n}","const externalDrag = {\n\tfrom_scheduler :null,\n\tto_scheduler: null,\n\tdrag_data:null,\n\tdrag_placeholder : null,\n\tdelete_dnd_holder : function(){\n\t\tvar node = this.drag_placeholder;\n\t\tif(!node)\n\t\t\treturn;\n\t\tif(node.parentNode)\n\t\t\tnode.parentNode.removeChild(node);\n\t\tdocument.body.className = document.body.className.replace(\" dhx_no_select\", \"\");\n\t\tthis.drag_placeholder = null;\n\t},\n\tcopy_event_node : function(event, scheduler){\n\t\tvar clone = null;\n\t\tfor (var i = 0; i < scheduler._rendered.length; i++){\n\t\t\tvar node = scheduler._rendered[i];\n\t\t\tif (node.getAttribute(scheduler.config.event_attribute) == event.id || node.getAttribute(scheduler.config.event_attribute) == scheduler._drag_id) {\n\t\t\t\tclone = node.cloneNode(true);\n\t\t\t\tclone.style.position = clone.style.top = clone.style.left = \"\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn clone || document.createElement(\"div\");\n\t},\n\tcreate_dnd_holder : function(event, scheduler){\n\t\tif(this.drag_placeholder)\n\t\t\treturn this.drag_placeholder;\n\n\t\tvar holder = document.createElement(\"div\");\n\t\tvar html = scheduler.templates.event_outside(event.start_date, event.end_date, event);\n\t\tif(html){\n\t\t\tholder.innerHTML = html;\n\t\t}else{\n\t\t\tholder.appendChild(this.copy_event_node(event, scheduler));\n\t\t}\n\n\t\tholder.className = \"dhx_drag_placeholder\";\n\t\tholder.style.position = \"absolute\";\n\t\tthis.drag_placeholder = holder;\n\t\tdocument.body.appendChild(holder);\n\t\tdocument.body.className += \" dhx_no_select\";\n\t\treturn holder;\n\t},\n\tmove_dnd_holder : function(e){\n\t\tvar pos = {x: e.clientX, y: e.clientY};\n\t\tthis.create_dnd_holder(this.drag_data.ev, this.from_scheduler);\n\t\tif(!this.drag_placeholder){\n\t\t\treturn;\n\t\t}\n\t\tvar x = pos.x,\n\t\t\ty = pos.y;\n\n\t\tvar html = document.documentElement,\n\t\t\tbody = document.body,\n\t\t\tholder = this.drag_placeholder;\n\n\t\tholder.style.left = 10 + x + (html && html.scrollLeft || body && body.scrollLeft || 0) - (html.clientLeft || 0) + \"px\";\n\t\tholder.style.top = 10 + y + (html && html.scrollTop || body && body.scrollTop || 0) - (html.clientTop || 0) + \"px\";\n\t},\n\tclear_scheduler_dnd : function(scheduler){\n\t\tscheduler._drag_id = scheduler._drag_pos = scheduler._drag_mode = scheduler._drag_event = scheduler._new_event = null;\n\t},\n\tstop_drag : function(scheduler){\n\t\tif(scheduler){\n\t\t\tthis.clear_scheduler_dnd(scheduler);\n\t\t}\n\t\tthis.delete_dnd_holder();\n\t\tthis.drag_data = null;\n\t},\n\tinject_into_scheduler : function(event, scheduler, dom_event){\n\t\tevent._count = 1; // reset order calculation for the new location (scheduler)\n\t\tevent._sorder = 0;\n\n\t\tif(event.event_pid && event.event_pid != \"0\") {\n\t\t\tevent.event_pid = null;\n\t\t\tevent.rec_type = event.rec_pattern = \"\";\n\t\t\tevent.event_length = 0;\n\t\t}\n\n\t\tscheduler._drag_event = event;\n\t\tscheduler._events[event.id] = event;\n\t\tscheduler._drag_id = event.id;\n\t\tscheduler._drag_mode = \"move\";\n\n\t\t//resolve event position\n\t\tif(dom_event)\n\t\t\tscheduler._on_mouse_move(dom_event);\n\t},\n\tstart_dnd : function(scheduler){\n\t\tif(!scheduler.config.drag_out)\n\t\t\treturn;\n\n\t\tthis.from_scheduler = scheduler;\n\t\tthis.to_scheduler = scheduler;\n\t\tvar drag = this.drag_data = {};\n\t\tdrag.ev = scheduler._drag_event;\n\t\tdrag.orig_id = scheduler._drag_event.id;\n\t},\n\tland_into_scheduler : function(scheduler, e){\n\t\tif(!scheduler.config.drag_in){\n\t\t\tthis.move_dnd_holder(e);\n\t\t\treturn false;\n\t\t}\n\n\t\tvar drag = this.drag_data;\n\n\t\tvar ev = scheduler._lame_clone(drag.ev); // _lame_clone - helper for deep copy\n\n\t\tif(scheduler != this.from_scheduler){\n\t\t\tev.id = scheduler.uid();\n\t\t\tvar duration = ev.end_date - ev.start_date;\n\t\t\tev.start_date = new Date(scheduler.getState().min_date);\n\t\t\tev.end_date = new Date(ev.start_date.valueOf() + duration);\n\t\t}else{\n\t\t\tev.id = this.drag_data.orig_id;\n\t\t\tev._dhx_changed = true;\n\t\t}\n\t\tthis.drag_data.target_id = ev.id;\n\t\tif(!scheduler.callEvent(\"onBeforeEventDragIn\", [ev.id, ev, e]))\n\t\t\treturn false;\n\t\tthis.to_scheduler = scheduler;\n\t\tthis.inject_into_scheduler(ev, scheduler, e);\n\t\tthis.delete_dnd_holder();\n\t\tscheduler.updateView();\n\t\tscheduler.callEvent(\"onEventDragIn\", [ev.id, ev, e]);\n\t\treturn true;\n\t},\n\n\tdrag_from_scheduler : function(scheduler, e){\n\t\tif(this.drag_data && scheduler._drag_id && scheduler.config.drag_out){\n\t\t\tif(!scheduler.callEvent(\"onBeforeEventDragOut\", [scheduler._drag_id, scheduler._drag_event, e])){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(this.to_scheduler == scheduler){\n\t\t\t\tthis.to_scheduler = null;\n\t\t\t}\n\t\t\t\n\t\t\tthis.create_dnd_holder(this.drag_data.ev, scheduler);\n\t\t\tvar id = scheduler._drag_id;\n\t\t\tthis.drag_data.target_id = null;\n\t\t\tdelete scheduler._events[id];\n\t\t\tthis.clear_scheduler_dnd(scheduler);\n\t\t\tscheduler.updateEvent(id);\n\t\t\tscheduler.callEvent(\"onEventDragOut\", [id, this.drag_data.ev, e]);\n\t\t\treturn true;\n\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t},\n\treset_event : function(event, scheduler){\n\t\tthis.inject_into_scheduler(event, scheduler);\n\t\tthis.stop_drag(scheduler);\n\t\tscheduler.updateView();\n\t},\n\tmove_permanently : function(original_event, moved_event, from, to){\n\t\tto.callEvent(\"onEventAdded\", [moved_event.id, moved_event]);\n\n\t\t// delete from original calendar\n\t\tthis.inject_into_scheduler(original_event, from);\n\t\tthis.stop_drag(from);\n\t\tif(original_event.event_pid && original_event.event_pid != \"0\") {\n\t\t\tfrom.callEvent(\"onConfirmedBeforeEventDelete\", [original_event.id]);\n\t\t\tfrom.updateEvent(moved_event.event_pid);\n\t\t} else {\n\t\t\tfrom.deleteEvent(original_event.id);\n\t\t}\n\t\tfrom.updateView();\n\t\tto.updateView();\n\t}\n};\n\nlet outerDragHandlerAttached = false;\nconst connectedSchedulers = [];\nfunction attachOuterDragHandler(scheduler) {\n\tscheduler.event(document.body, \"mousemove\", function(e) {\n\t\tvar dnd = externalDrag;\n\t\tvar target_scheduler = dnd.target_scheduler;\n\n\t\tif(target_scheduler){\n\t\t\tif(!dnd.from_scheduler){\n\t\t\t\t// start dragging event inside initial scheduler\n\t\t\t\tif(target_scheduler.getState().drag_mode == \"move\" && target_scheduler.config.drag_out){\n\t\t\t\t\tdnd.start_dnd(target_scheduler);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(target_scheduler._drag_id){\n\t\t\t\t\t// moving event inside target scheduler\n\t\t\t\t}else{\n\t\t\t\t\t// dragging event into target scheduler\n\t\t\t\t\tvar source = dnd.to_scheduler;//previos target scheduler\n\t\t\t\t\tif(!source || dnd.drag_from_scheduler(source, e)){\n\t\t\t\t\t\tdnd.land_into_scheduler(target_scheduler, e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}else if(dnd.from_scheduler){\n\t\t\tif(!dnd.to_scheduler){\n\t\t\t\t//dragging outside schedulers\n\t\t\t\tdnd.move_dnd_holder(e);\n\t\t\t}else{\n\t\t\t\t// dragging out of target scheduler\n\t\t\t\tdnd.drag_from_scheduler(dnd.to_scheduler, e);\n\t\t\t}\n\t\t}\n\n\t\tdnd.target_scheduler = null;\n\t});\n\tscheduler.event(document.body, \"mouseup\", function(e) {\n\t\tvar dnd = externalDrag;\n\t\tvar from = dnd.from_scheduler,\n\t\t\tto = dnd.to_scheduler;\n\n\t\tif(from){\n\t\t\tif(to && from == to){\n\t\t\t\t// drop back to the same calendar\n\t\t\t\tfrom.updateEvent(dnd.drag_data.target_id);\n\t\t\t}else if(to && from !== to){\n\t\t\t\t// drop to another scheduler\n\t\t\t\tvar original = dnd.drag_data.ev;\n\t\t\t\tvar ev = to.getEvent(dnd.drag_data.target_id);\n\t\t\t\tif(from.callEvent(\"onEventDropOut\", [original.id, original, to, e])){\n\t\t\t\t\tdnd.move_permanently(original, ev, from, to);\n\t\t\t\t}else{\n\t\t\t\t\tdnd.reset_event(original, from);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// drop outside schedulers\n\t\t\t\tvar original = dnd.drag_data.ev;\n\t\t\t\tif(from.callEvent(\"onEventDropOut\", [original.id, original, null, e])){\n\t\t\t\t\tdnd.reset_event(original, from);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdnd.stop_drag();\n\t\tdnd.current_scheduler = dnd.from_scheduler = dnd.to_scheduler = null;\n\t});\n\n}\n\nfunction processScheduler(scheduler){\n\tscheduler.attachEvent(\"onSchedulerReady\", function(){\n\t\tattachOuterDragHandler(scheduler);\n\t\touterDragHandlerAttached = true;\n\t}, {once: true});\n\n\tscheduler.attachEvent(\"onDestroy\", function(){\n\t\touterDragHandlerAttached = false;\n\t\tconst nextScheduler = connectedSchedulers.pop();\n\t\tif(nextScheduler){\n\t\t\tprocessScheduler(nextScheduler);\n\t\t}\n\t}, {once: true});\n}\n\nexport default function(scheduler){\n\tif(window.Scheduler && window.Scheduler.plugin){// if Scheduler factory is defined, not to confuse with the browser Scheduler object\n\t\twindow.Scheduler._outer_drag = externalDrag;// old private api compatibility\n\t}\n\n\tconnectedSchedulers.push(scheduler);\n\tif(!outerDragHandlerAttached) {\n\t\tprocessScheduler(scheduler);\n\t}\n\n\tscheduler.config.drag_in = true;\n\tscheduler.config.drag_out = true;\n\tscheduler.templates.event_outside = function(start, end, event){};\n\tvar dnd = externalDrag;\n\tscheduler.attachEvent(\"onTemplatesReady\", function(){\n\t\tscheduler.event(scheduler._obj, \"mousemove\", function(e){\n\t\t\tdnd.target_scheduler = scheduler;\n\t\t});\n\t\tscheduler.event(scheduler._obj, \"mouseup\", function(e){\n\t\t\tdnd.target_scheduler = scheduler;\n\t\t});\n\t});\n}","export default function(scheduler){\n\n\n\n(function(){\n\tvar modalsStack = [];\n\n\tfunction isModal(){\n\t\treturn !!(modalsStack.length);\n\t}\n\n\tfunction isChildOf(child, parent){\n\t\twhile(child && child != parent){\n\t\t\tchild = child.parentNode;\n\t\t}\n\n\t\treturn !!(child == parent);\n\t}\n\n\tfunction afterPopup(box){\n\t\tsetTimeout(function(){\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(!isModal() && !(isChildOf(document.activeElement, scheduler.$container))) {\n\t\t\t\tscheduler.focus();\n\t\t\t}\n\t\t}, 1);\n\t}\n\tfunction startModal(box){\n\t\tscheduler.eventRemove(box, \"keydown\", trapFocus);\n\t\tscheduler.event(box, \"keydown\", trapFocus);\n\t\tmodalsStack.push(box);\n\t\t//scheduler.$keyboardNavigation.dispatcher.disable();\n\t}\n\n\tfunction endModal(){\n\t\tvar box = modalsStack.pop();\n\t\tif(box) {\n\t\t\tscheduler.eventRemove(box, \"keydown\", trapFocus);\n\t\t}\n\t\tafterPopup(box);\n\n\t}\n\n\tfunction isTopModal(box){\n\t//\tif(dhtmlx._modalsStack.length){\n\t//\t\treturn box == dhtmlx._modalsStack[dhtmlx._modalsStack.length - 1];\n\t//\t}else{\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\n\t//\t}\n\n\t}\n\n\tfunction trapFocus(event){\n\t\tvar event = event || window.event;\n\t\tvar target = event.currentTarget;\n\t\tif(!isTopModal(target)) return;\n\n\t\tscheduler.$keyboardNavigation.trapFocus(target, event);\n\t}\n\n\tfunction traceLightbox(){\n\t\tstartModal(scheduler.getLightbox());\n\t}\n\n\tscheduler.attachEvent(\"onLightbox\", traceLightbox);\n\tscheduler.attachEvent(\"onAfterLightbox\", endModal);\n\n\tscheduler.attachEvent(\"onAfterQuickInfo\", function(){afterPopup();});\n\n\tif(!scheduler._keyNavMessagePopup) {\n\t\tscheduler._keyNavMessagePopup = true;\n\n\t\tvar focusElement = null;\n\t\tvar backupFocus = null;\n\t\tconst modalsStack = [];\n\t\tscheduler.attachEvent(\"onMessagePopup\", function(box){\n\t\t\tfocusElement = document.activeElement;\n\t\t\tbackupFocus = focusElement;\n\n\t\t\twhile(backupFocus && scheduler._getClassName(backupFocus).indexOf(\"dhx_cal_data\") < 0){\n\t\t\t\tbackupFocus = backupFocus.parentNode;\n\t\t\t}\n\t\t\tif(backupFocus){\n\t\t\t\tbackupFocus = backupFocus.parentNode;\n\t\t\t}\n\n\t\t\tscheduler.eventRemove(box, \"keydown\", trapFocus);\n\t\t\tscheduler.event(box, \"keydown\", trapFocus);\n\t\t\tmodalsStack.push(box);\n\t\t});\n\n\n\t\tscheduler.attachEvent(\"onAfterMessagePopup\", function () {\n\t\t\tvar box = modalsStack.pop();\n\t\t\tif(box) {\n\t\t\t\tscheduler.eventRemove(box, \"keydown\", trapFocus);\n\t\t\t}\n\t\t\tsetTimeout(function(){\n\t\t\t\tif(scheduler.$destroyed){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar currentTarget = document.activeElement;\n\t\t\t\twhile(currentTarget && scheduler._getClassName(currentTarget).indexOf(\"dhx_cal_light\") < 0){\n\t\t\t\t\tcurrentTarget = currentTarget.parentNode;\n\t\t\t\t}\n\t\t\t\tif(currentTarget)\n\t\t\t\t\treturn;\n\n\n\t\t\t\tif(focusElement && focusElement.parentNode){\n\t\t\t\t\tfocusElement.focus();\n\n\t\t\t\t}else if(backupFocus && backupFocus.parentNode){\n\t\t\t\t\tbackupFocus.focus();\n\t\t\t\t}\n\t\t\t\tfocusElement = null;\n\t\t\t\tbackupFocus = null;\n\n\t\t\t}, 1);\n\t\t});\n\t}\n\n\tscheduler.$keyboardNavigation.isModal = isModal;\n\n\n})();\n\n}","export default function(scheduler){\n\n//Initial idea and implementation by Steve MC\nscheduler._temp_key_scope = function (){\n\n\tscheduler.config.key_nav = true;\n\n\tscheduler.$keyboardNavigation._pasteDate = null; // used for copy and paste operations\n\tscheduler.$keyboardNavigation._pasteSection = null; // used for copy and paste operations\n\tvar isCopy = null;\n\n\tvar pos = {};\n\n\tif(!document.body){\n\t\tscheduler.event(window, \"load\", function(){\n\t\t\tscheduler.event(document.body, \"mousemove\", trackMousePosition);\n\t\t});\n\t}else{\n\t\tscheduler.event(document.body, \"mousemove\", trackMousePosition);\n\t}\n\n\tfunction trackMousePosition(event){\n\t\tevent = event || window.event;\n\t\tpos.x = event.clientX;\n\t\tpos.y = event.clientY;\n\t}\n\tfunction currentTarget(){\n\n\t\tvar mousePointer = false;\n\t\tvar keyNavPointer = false;\n\n\t\tvar target = document.elementFromPoint(pos.x, pos.y);\n\t\twhile(target && target != scheduler._obj){\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t\tmousePointer = !!(target == scheduler._obj);\n\n\t\tkeyNavPointer = scheduler.$keyboardNavigation.dispatcher.isEnabled();\n\n\t\treturn mousePointer || keyNavPointer;\n\t}\n\n\tscheduler.attachEvent(\"onMouseMove\", function(id,e){\n\t\tvar state = scheduler.getState();\n\n\t\t// make sure scheduler is fully initialized before calling scheduler.getActionData\n\t\tif(!(state.mode && state.min_date)){\n\t\t\treturn;\n\t\t}\n\t\tvar position = scheduler.getActionData(e);\n\t\tscheduler.$keyboardNavigation._pasteDate = position.date;\n\t\tscheduler.$keyboardNavigation._pasteSection = position.section;\n\t});\n\n\tfunction clear_event_after(ev){\n\t\tdelete ev.rec_type; delete ev.rec_pattern;\n\t\tdelete ev.event_pid; delete ev.event_length;\n\t}\n\n\tfunction copyEvent(ev){\n\t\treturn scheduler._lame_copy({}, ev);\n\t}\n\n\tscheduler._make_pasted_event = function(ev){\n\t\tvar date = scheduler.$keyboardNavigation._pasteDate;\n\t\tvar section = scheduler.$keyboardNavigation._pasteSection;\n\n\t\tvar event_duration = ev.end_date-ev.start_date;\n\n\t\tvar copy = copyEvent(ev);\n\t\tclear_event_after(copy);\n\t\tcopy.start_date = new Date(date);\n\t\tcopy.end_date = new Date(copy.start_date.valueOf() + event_duration);\n\n\t\tif(section){\n\t\t\tvar property = scheduler._get_section_property();\n\t\t\t// GS-2527: if the event has multiple sections, it will be inserted into the initial sections.\n\t\t\tif(scheduler.config.multisection && ev[property] && scheduler.isMultisectionEvent && scheduler.isMultisectionEvent(ev)) \n\t\t\t\tcopy[property] = ev[property]; // save initial set of resources for multisection view\n\t\t\telse\n\t\t\t\tcopy[property] = section;\n\t\t}\n\t\treturn copy;\n\t};\n\tscheduler._do_paste = function(is_copy, modified_ev, original_ev){\n\t\tif(scheduler.callEvent(\"onBeforeEventPasted\", [is_copy, modified_ev, original_ev]) === false){\n\t\t\treturn;\n\t\t}\n\t\tscheduler.addEvent(modified_ev);\n\t\tscheduler.callEvent(\"onEventPasted\", [is_copy, modified_ev, original_ev]);\n\t};\n\n\tscheduler._is_key_nav_active = function(){\n\t\tif(this._is_initialized() && !this._is_lightbox_open() && this.config.key_nav){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tfunction getSelectedEvent(){\n\t\tvar node = scheduler.$keyboardNavigation.dispatcher.getActiveNode();\n\t\tif(node && node.eventId) return node.eventId;\n\t\treturn scheduler._select_id;\n\t}\n\n\tscheduler.event(document, \"keydown\", function(e){\n\t\t// compatibility fix - scheduler focus on ctrl+v on mouse hover\n\t\tif(((e.ctrlKey || e.metaKey) && e.keyCode == 86) && scheduler._buffer_event && !scheduler.$keyboardNavigation.dispatcher.isEnabled()) {\n\t\t\tscheduler.$keyboardNavigation.dispatcher.isActive = currentTarget();\n\t\t}\n\t});\n\n\tscheduler._key_nav_copy_paste = function(e){\n\t\tif(!scheduler._is_key_nav_active()) return true;\n\n\t\tif (e.keyCode == 37 || e.keyCode == 39) { // Left, Right arrows\n\t\t\te.cancelBubble = true;\n\n\t\t\tvar next = scheduler.date.add(scheduler._date,(e.keyCode == 37 ? -1 : 1 ),scheduler._mode);\n\t\t\tscheduler.setCurrentView(next);\n\t\t\treturn true;\n\t\t}\n\n\t\tvar select_id = getSelectedEvent();\n\t\tif ((e.ctrlKey || e.metaKey) && e.keyCode == 67) {  // CTRL+C\n\t\t\tif (select_id) {\n\t\t\t\tscheduler._buffer_event = copyEvent(scheduler.getEvent(select_id));\n\t\t\t\tisCopy = true;\n\t\t\t\tscheduler.callEvent(\"onEventCopied\", [scheduler.getEvent(select_id)]);\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tif ((e.ctrlKey || e.metaKey) && e.keyCode == 88) { // CTRL+X\n\t\t\tif (select_id) {\n\t\t\t\tisCopy = false;\n\t\t\t\tvar ev = scheduler._buffer_event = copyEvent(scheduler.getEvent(select_id));\n\n\t\t\t\tscheduler.updateEvent(ev.id);\n\t\t\t\tscheduler.callEvent(\"onEventCut\", [ev]);\n\t\t\t}\n\t\t}\n\n\t\tif ((e.ctrlKey || e.metaKey) && e.keyCode == 86 && currentTarget(e)) {  // CTRL+V\n\t\t\tvar ev = scheduler._buffer_event ? scheduler.getEvent(scheduler._buffer_event.id) : scheduler._buffer_event;\n\t\t\tev = ev || scheduler._buffer_event;\n\n\t\t\tif (ev) {\n\t\t\t\tvar new_ev = scheduler._make_pasted_event(ev);\n\t\t\t\tif (isCopy) {\n\t\t\t\t\tnew_ev.id = scheduler.uid();\n\t\t\t\t\tscheduler._do_paste(isCopy, new_ev, ev);\n\t\t\t\t}\n\t\t\t\telse { // cut operation\n\t\t\t\t\tvar res = scheduler.callEvent(\"onBeforeEventChanged\",[new_ev, e, false, ev]);\n\t\t\t\t\tif (res) {\n\t\t\t\t\t\tscheduler._do_paste(isCopy, new_ev, ev);\n\t\t\t\t\t\tisCopy = true; // switch to copy after first paste operation\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t};\n};\nscheduler._temp_key_scope();\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.attachSchedulerHandlers = function(){\n\tvar dispatcher = scheduler.$keyboardNavigation.dispatcher;\n\n\tvar keyDownHandler = function(e){\n\t\tif(!scheduler.config.key_nav) return;\n\n\t\treturn dispatcher.keyDownHandler(e);\n\t};\n\n\tvar focusHandler = function () {\n\t\tdispatcher.keepScrollPosition(function () {\n\t\t\tdispatcher.focusGlobalNode();\n\t\t});\n\t};\n\n\tvar waitCall;\n\tscheduler.attachEvent(\"onDataRender\", function(){\n\t\tif(!scheduler.config.key_nav) return;\n\t\tif(!(dispatcher.isEnabled() && !scheduler.getState().editor_id)) return;\n\n\t\tclearTimeout(waitCall);\n\t\twaitCall = setTimeout(function(){\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(!dispatcher.isEnabled())\n\t\t\t\tdispatcher.enable();\n\t\t\treFocusActiveNode();\n\t\t});\n\t});\n\n\tvar reFocusActiveNode = function(){\n\t\tif(!dispatcher.isEnabled())\n\t\t\treturn;\n\n\t\tvar activeNode = dispatcher.getActiveNode();\n\t\tif(!activeNode)\n\t\t\treturn;\n\n\t\tif(!activeNode.isValid()){\n\t\t\tactiveNode = activeNode.fallback();\n\t\t}\n\n\t\tif(!activeNode || activeNode instanceof scheduler.$keyboardNavigation.MinicalButton || activeNode instanceof scheduler.$keyboardNavigation.MinicalCell)\n\t\t\treturn;\n\n\t\tdispatcher.keepScrollPosition(function () {\n\t\t\tactiveNode.focus(true);\n\t\t});\n\t};\n\n\tscheduler.attachEvent(\"onSchedulerReady\", function(){\n\t\tvar container = scheduler.$container;\n\t\tscheduler.eventRemove(document, \"keydown\", keyDownHandler);\n\t\tscheduler.eventRemove(container, \"mousedown\", mousedownHandler);\n\t\tscheduler.eventRemove(container, \"focus\", focusHandler);\n\n\n\t\tif(scheduler.config.key_nav){\n\n\t\t\tscheduler.event(document, \"keydown\", keyDownHandler);\n\t\t\tscheduler.event(container, \"mousedown\", mousedownHandler);\n\t\t\tscheduler.event(container, \"focus\", focusHandler);\n\n\t\t\tcontainer.setAttribute(\"tabindex\", \"0\");\n\n\t\t}else{\n\t\t\tcontainer.removeAttribute(\"tabindex\");\n\t\t}\n\t});\n\n\tfunction mousedownHandler(e){\n\t\tif(!scheduler.config.key_nav) return true;\n\n\t\tconst view = scheduler.getView();\n\t\tlet dataAreaClick = false;\n\t\tif (scheduler.getState().mode === \"month\") {\n\t\t\tdataAreaClick = scheduler.$keyboardNavigation.isChildOf(e.target || e.srcElement, scheduler.$container.querySelector(\".dhx_cal_month_table\"));\n\t\t} else if (view && view.layout === \"timeline\") {\n\t\t\tdataAreaClick = scheduler.$keyboardNavigation.isChildOf(e.target || e.srcElement, scheduler.$container.querySelector(\".dhx_timeline_data_col\"));\n\t\t} else {\n\t\t\tconst listOfScales = scheduler.$container.querySelectorAll(\".dhx_scale_holder\");\n\t\t\tconst arrOfScales = Array.from(listOfScales);\n\t\t\tdataAreaClick = arrOfScales.some(scale => scale === e.target.parentNode);\n\t\t}\n\n\t\tvar pos = scheduler.getActionData(e);\n\n\t\tvar focusNode;\n\t\tif(scheduler._locate_event(e.target || e.srcElement)){\n\t\t\tfocusNode = new scheduler.$keyboardNavigation.Event(scheduler._locate_event(e.target || e.srcElement));\n\t\t}else if(dataAreaClick){\n\t\t\tfocusNode = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\tif(pos.date && dataAreaClick){\n\t\t\t\tfocusNode = focusNode.nextSlot(new scheduler.$keyboardNavigation.TimeSlot(pos.date, null, pos.section));\n\t\t\t}\n\t\t}\n\n\t\tif(focusNode) {\n\t\t\tif (!dispatcher.isEnabled()) {\n\t\t\t\tdispatcher.activeNode = focusNode;\n\n\t\t\t} else {\n\t\t\t\tif (pos.date && dataAreaClick) {\n\t\t\t\t\tdispatcher.delay(function () {\n\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction focusEvent(evNode){\n\t\tif(!scheduler.config.key_nav) return;\n\t\tif(!dispatcher.isEnabled()) return;\n\n\n\t\tvar prevState = evNode;\n\t\tvar focusNode = new scheduler.$keyboardNavigation.Event(prevState.eventId);\n\t\tif(!focusNode.isValid()){\n\t\t\tvar lastStart = focusNode.start || prevState.start;\n\t\t\tvar lastEnd = focusNode.end || prevState.end;\n\t\t\tvar lastSection = focusNode.section || prevState.section;\n\n\t\t\tfocusNode = new scheduler.$keyboardNavigation.TimeSlot(lastStart, lastEnd, lastSection);\n\t\t\tif(!focusNode.isValid()){\n\t\t\t\tfocusNode = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\t}\n\t\t}\n\n\t\tdispatcher.setActiveNode(focusNode);\n\t\tvar node = dispatcher.getActiveNode();\n\t\tif(node && node.getNode && document.activeElement != node.getNode()){\n\t\t\tdispatcher.focusNode(dispatcher.getActiveNode());\n\t\t}\n\t}\n\n\n\tvar updateEvent = scheduler.updateEvent;\n\tscheduler.updateEvent = function(id){\n\t\tvar res = updateEvent.apply(this, arguments);\n\t\tif(scheduler.config.key_nav && dispatcher.isEnabled()){\n\t\t\tif(scheduler.getState().select_id == id){\n\t\t\t\tvar element = new scheduler.$keyboardNavigation.Event(id);\n\n\t\t\t\tif(!scheduler.getState().lightbox_id){\n\t\t\t\t\tfocusEvent(element);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\tscheduler.attachEvent(\"onEventDeleted\", function(id) {\n\t\tif(!scheduler.config.key_nav) return true;\n\t\tif(dispatcher.isEnabled()){\n\t\t\tvar activeNode = dispatcher.getActiveNode();\n\t\t\tif(activeNode.eventId == id){\n\t\t\t\tdispatcher.setActiveNode(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onClearAll\", function(){\n\t\tif(!scheduler.config.key_nav) return true;\n\t\tif(dispatcher.isEnabled()){\n\t\t\tif(dispatcher.getActiveNode() instanceof scheduler.$keyboardNavigation.Event){\n\t\t\t\tdispatcher.setActiveNode(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t}\n\t\t}\n\t});\n\n};\n\n}","/* eslint-disable  */\n\nexport default function dhtmlxError(type, name, params) {\n\tif (!this.catches)\n\t\tthis.catches = [];\n\n\treturn this;\n}\n\ndhtmlxError.prototype.catchError = function (type, func_name) {\n\tthis.catches[type] = func_name;\n};\n\ndhtmlxError.prototype.throwError = function (type, name, params) {\n\tif (this.catches[type])\n\t\treturn this.catches[type](type, name, params);\n\n\tif (this.catches[\"ALL\"])\n\t\treturn this.catches[\"ALL\"](type, name, params);\n\n\tglobal.alert(\"Error type: \" + arguments[0] + \"\\nDescription: \" + arguments[1]);\n\treturn null;\n};\n\n","import { IMapAdapter, ICalendarEvent, IMapSettings, IMapPosition} from \"./types\";\ndeclare let google: any;\n\nexport class GoogleMapAdapter implements IMapAdapter {\n\tprivate map: any;\n\tprivate scheduler: any;\n\tprivate settings: IMapSettings;\n\tprivate _markers: any[];\n\tprivate infoWindow: any;\n\tconstructor(scheduler: any) {\n\t\tthis.map = null;\n\t\tthis._markers = [];\n\t\tthis.scheduler = scheduler;\n\t}\n\tonEventClick(event: ICalendarEvent): void {\n\t\tif (this._markers && this._markers.length > 0) {\n\t\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\t\tif (event.id == this._markers[i].event.id) {\n\t\t\t\t\tlet zoom = this.settings.zoom_after_resolve || this.settings.initial_zoom;\n\t\t\t\t\tif (event.lat && event.lng){\n\t\t\t\t\t\tthis.map.setCenter({\n\t\t\t\t\t\t\tlat: event.lat, \n\t\t\t\t\t\t\tlng: event.lng,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.map.setZoom(zoom);\n\t\t\t\t\t} else {\t\t\t\t\t\t\n\t\t\t\t\t\tthis.map.setCenter({\n\t\t\t\t\t\t\tlat: this.settings.error_position.lat, \n\t\t\t\t\t\t\tlng: this.settings.error_position.lng,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.map.setZoom(zoom);\n\t\t\t\t\t}\n\t\t\t\t\tgoogle.maps.event.trigger(this._markers[i].marker, 'click');\n\t\t\t\t}\t\n\t\t\t}\n\t\t} \n\t}\n\n\tinitialize(container: HTMLElement, options: IMapSettings): void {\n\t\tthis.settings = options;\n\t\tlet scheduler = this.scheduler;\n\t\tlet mapOptions = {\n\t\t\tcenter: { lat: options.initial_position.lat, lng:  options.initial_position.lng },\n\t\t\tzoom: options.initial_zoom,\n\t\t\tmapId: container.id,\n\t\t\tscrollwheel: true,\n\t\t\tmapTypeId: options.type\n\t\t}\n\t\t// we need to reuse the google map to avoid leak memory\n\t\tif (this.map === null) {\n\t\t\tthis.map = new google.maps.Map(container, mapOptions);\n\t\t}\n\t\telse {\n\t\t\tlet map = this.map;\n\t\t\tcontainer.appendChild(this.map.__gm.messageOverlay);\n\t\t\tcontainer.appendChild(this.map.__gm.outerContainer);\n\t\t\tsetTimeout(function() {\n\t\t\t\tmap.setOptions({container: container.id});\n\t\t\t}, 500);\n\t\t}\n\t\tgoogle.maps.event.addListener(this.map, \"dblclick\", function(event) {\n\t\t\tconst geocoder = new google.maps.Geocoder();\n\t\n\t\t\tif (!scheduler.config.readonly && scheduler.config.dblclick_create) {\n\t\t\t\tlet point = event.latLng;\n\t\t\t\tgeocoder.geocode(\n\t\t\t\t\t{ 'latLng': point },\n\t\t\t\t\tfunction(results, status) {\n\t\t\t\t\t\tif (status == google.maps.GeocoderStatus.OK) {\n\t\t\t\t\t\t\tpoint = results[0].geometry.location;\n\t\t\t\t\t\t\tscheduler.addEventNow({\n\t\t\t\t\t\t\t\tlat: point.lat(),\n\t\t\t\t\t\t\t\tlng: point.lng(),\n\t\t\t\t\t\t\t\tevent_location: results[0].formatted_address,\n\t\t\t\t\t\t\t\tstart_date: scheduler.getState().date,\n\t\t\t\t\t\t\t\tend_date: scheduler.date.add(scheduler.getState().date, scheduler.config.time_step, \"minute\")\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('Geocode was not successful for the following reason: ' + status);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy(container: HTMLElement): void {\n\t\tgoogle.maps.event.clearInstanceListeners(window);\n\t\tgoogle.maps.event.clearInstanceListeners(document);\n\t\tgoogle.maps.event.clearInstanceListeners(container);\n\t\twhile (container.firstChild) {\n\t\t\tcontainer.firstChild.remove();\n\t\t}\n\t\tcontainer.innerHTML = \"\";\n\t}\n\n\tasync addEventMarker(event: ICalendarEvent): Promise<void> {\n\t\tlet config = {\n\t\t\ttitle: event.text,\n\t\t\tposition: {},\n\t\t\tmap: {}\n\t\t}\n\t\t\n\t\tif (event.lat && event.lng) {\n\t\t\tconfig.position = { lat: event.lat, lng: event.lng };\n\t\t} else {\n\t\t\tconfig.position = { lat: this.settings.error_position.lat, lng: this.settings.error_position.lng }\n\t\t}\n\t\tconst { AdvancedMarkerElement } = await google.maps.importLibrary(\"marker\");\n\t\tlet marker;\n\t\tif (this.scheduler.ext.mapView.createMarker) {\n\t\t\tconfig.map = this.map;\n\t\t\tmarker = this.scheduler.ext.mapView.createMarker(config);\n\t\t} else {\n\t\t\tmarker = new AdvancedMarkerElement(config);\n\t\t\tmarker.map = this.map;\n\t\t}\n\t\tmarker.setMap(this.map);\n\t\t//case for markeks which were deleted with DataProcessor\n\t\tif (event[\"!nativeeditor_status\"] == \"true_deleted\"){\n\t\t\tmarker.setMap(null);\n\t\t}\n\t\tgoogle.maps.event.addListener(marker, \"click\", () => {\n\t\t\tif (this.infoWindow) {\n\t\t\t\tthis.infoWindow.close();\n\t\t\t}\n\t\t\tthis.infoWindow = new google.maps.InfoWindow({maxWidth: this.settings.info_window_max_width});\n\t\t\tthis.infoWindow.setContent(this.scheduler.templates.map_info_content(event));\n\t\t\tthis.infoWindow.open({\n\t\t\t\tanchor: marker,\n\t\t\t\tmap: this.map,\n\t\t\t});\n\t\t});\n\t\tlet markerInfo = {event, ...config, marker};\n\t\tthis._markers.push(markerInfo);\n\t}\n\n\tremoveEventMarker(eventId: string): void {\n\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\tif (eventId == this._markers[i].event.id) {\n\t\t\t\tthis._markers[i].marker.setVisible(false);\n\t\t\t\tthis._markers[i].marker.setMap(null);\n\t\t\t\tthis._markers[i].marker.setPosition(null);\n\t\t\t\tthis._markers[i].marker = null;\n\t\t\t\tthis._markers.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateEventMarker(event: ICalendarEvent): void {\n\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\tif(this._markers[i].event.id == event.id) {\n\t\t\t\tthis._markers[i].event = event;\n\t\t\t\tthis._markers[i].position.lat = event.lat;\n\t\t\t\tthis._markers[i].position.lng = event.lng;\n\t\t\t\tthis._markers[i].text = event.text;\n\t\t\t\tlet latlng = new google.maps.LatLng(event.lat, event.lng);\n\t\t\t\tthis._markers[i].marker.setPosition(latlng);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearEventMarkers(): void {\n\t\tif (this._markers.length > 0) {\n\t\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\t\tthis._markers[i].marker.setMap(null);\n\t\t\t}\n\t\t\tthis._markers = [];\n\t\t}\n\t}\n\n\tsetView(latitude: number, longitude: number, zoom: number): void {\n\t\tthis.map.setCenter({\n\t\t\tlat: latitude, \n\t\t\tlng: longitude,\n\t\t});\n\t\tthis.map.setZoom(zoom);\n\t}\n\n\tasync resolveAddress(string: string): Promise<IMapPosition> {\n\t\tconst geocoder = new google.maps.Geocoder();\n\t\tlet position: any = await new Promise((resolve) => {\n\t\t\tgeocoder.geocode(\n\t\t\t\t{ 'address': string },\n\t\t\t\tfunction(results, status) {\n\t\t\t\t\tif (status == google.maps.GeocoderStatus.OK) {\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t lat: results[0].geometry.location.lat(),\n\t\t\t\t\t\t lng: results[0].geometry.location.lng()\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error('Geocode was not successful for the following reason: ' + status);\n\t\t\t\t\t\tresolve({});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t\treturn position;\n\t}\n\t\n}","import { IMapAdapter, ICalendarEvent, IMapSettings, IMapPosition} from \"./types\";\n\ndeclare let L: any\n\nexport class OpenStreetMapAdapter implements IMapAdapter {\n\tprivate map: any;\n\tprivate scheduler: any;\n\tprivate _markers: any[];\n\tprivate settings: IMapSettings;\n\tconstructor(scheduler: any) {\n\t\tthis.map = null;\n\t\tthis._markers = [];\n\t\tthis.scheduler = scheduler;\n\t}\n\tonEventClick(event: ICalendarEvent): void {\n\t\tif (this._markers && this._markers.length > 0) {\n\t\t\tfor (let i = 0; i <  this._markers.length; i++) {\n\t\t\t\tif (event.id ==  this._markers[i].event.id) {\n\t\t\t\t\tthis._markers[i].marker.openPopup();\n\t\t\t\t\tthis._markers[i].marker.closeTooltip();\n\t\t\t\t\tif (event.lat && event.lng) {\n\t\t\t\t\t\tthis.setView(event.lat, event.lng, this.settings.zoom_after_resolve || this.settings.initial_zoom);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.setView(this.settings.error_position.lat, this.settings.error_position.lng, this.settings.zoom_after_resolve || this.settings.initial_zoom);\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t}\n\t\t} \n\t}\n\n\tinitialize(container: HTMLElement, options: IMapSettings): void {\n\t\tlet scheduler = this.scheduler;\n\t\tlet mapWrapper = document.createElement('div');\n\t\tmapWrapper.className = 'mapWrapper';\n\t\tmapWrapper.id = 'mapWrapper';\n\t\tmapWrapper.style.width = container.style.width;\n\t\tmapWrapper.style.height = container.style.height;\n\t\tcontainer.appendChild(mapWrapper);\n\n\t\tlet map = L.map(mapWrapper, {\n\t\t\tcenter: L.latLng(options.initial_position.lat, options.initial_position.lng),\n\t\t\tzoom: options.initial_zoom,\n\t\t\tkeyboard: false // need to set false, due to bug with moving window\n\t\t});\n\t\tL.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\n\t\tmap.on(\"dblclick\", async function(e){\n\t\t\tconst settings = {\n\t\t\t\t\"method\": \"GET\",\n\t\t\t\theaders: {\n\t\t\t\t\t\"Accept-Language\":  \"en\",\n\t\t\t\t},\n\t\t\t};\n\t\t\tlet response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${e.latlng.lat}&lon=${e.latlng.lng}&format=json`, settings).then(response => response.json());\n\t\t\tif (response.address) {\n\t\t\t\tlet address = response.address.country;\n\t\t\t\tscheduler.addEventNow({\n\t\t\t\t\tlat: e.latlng.lat,\n\t\t\t\t\tlng: e.latlng.lng,\n\t\t\t\t\tevent_location: address,\n\t\t\t\t\tstart_date: scheduler.getState().date,\n\t\t\t\t\tend_date: scheduler.date.add(scheduler.getState().date, scheduler.config.time_step, \"minute\")\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.error(\"unable recieve a position of the event\", response.error);\n\t\t\t}\n\t\t});\n\t\tthis.map = map;\n\t\tthis.settings = options;\n\t}\n\n\tdestroy(container: HTMLElement): void {\n\t\tthis.map.remove();\n\t\twhile (container.firstChild) {\n\t\t\tcontainer.firstChild.remove();\n\t\t}\n\t\tcontainer.innerHTML = \"\";\n\t}\n\n\taddEventMarker(event: ICalendarEvent): void {\n\t\tconst myIcon = L.icon({\n\t\t\ticonUrl: 'https://unpkg.com/leaflet@1.0.3/dist/images/marker-icon.png',\n\t\t\ticonSize:     [25, 41],\n\t\t\tshadowSize:   [30, 65],\n\t\t\ticonAnchor:   [12, 41],\n\t\t\tshadowAnchor: [7, 65]\n\t\t});\n\t\tlet popupConfig = {\n\t\t\tminWidth: 180,\n\t\t\tmaxWidth: this.settings.info_window_max_width,\n\t\t}\n\t\tconst markerPopup = L.popup(popupConfig).setContent(this.scheduler.templates.map_info_content(event));\n\t\tconst tooltip = L.tooltip().setContent(event.text);\n\n\t\tlet markerConfig = [\n\t\t\tevent.lat,\n\t\t\tevent.lng\n\t\t]\n\t\t\n\t\tif (!event.lat || !event.lng) {\n\t\t\tmarkerConfig = [this.settings.error_position.lat, this.settings.error_position.lng];\n\t\t}\n\t\tconst marker = L.marker(markerConfig, {\n\t\t\ticon: myIcon\n\t\t}).bindPopup(markerPopup).bindTooltip(tooltip).addTo(this.map);\n\t\tconst markerInfo = {event, marker};\n\t\tthis._markers.push(markerInfo);\t\t\n\t}\n\n\tremoveEventMarker(eventId: string): void {\n\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\tif (eventId == this._markers[i].event.id) {\n\t\t\t\tthis.map.removeLayer(this._markers[i].marker);\n\t\t\t\tthis._markers.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateEventMarker(event: ICalendarEvent): void {\n\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\tif(this._markers[i].event.id == event.id) {\n\t\t\t\tthis._markers[i].event = event;\n\t\t\t\tif (!event.lat || !event.lng){\n\t\t\t\t\tthis._markers[i].marker.setLatLng([this.settings.error_position.lat, this.settings.error_position.lng]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._markers[i].marker.setLatLng([event.lat, event.lng]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclearEventMarkers(): void {\n\t\tif(this._markers) {\n\t\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\t\tthis.map.removeLayer(this._markers[i].marker); \n\t\t\t}\n\t\t\tthis._markers = [];\n\t\t}\n\t}\n\n\tsetView(latitude: number, longitude: number, zoom: number): void {\n\t\tthis.map.setView([latitude, longitude], zoom);\n\t}\n\n\tasync resolveAddress(string: string): Promise<IMapPosition> {\n\t\tconst settings = {\n\t\t\t\"method\": \"GET\",\n\t\t\theaders: {\n\t\t\t\t\"Accept-Language\":  \"en\",\n\t\t\t},\n\t\t};\n\t\tlet position:any = {};\n\t\tlet response = await fetch(`https://nominatim.openstreetmap.org/search?q=${string}&format=json`, settings).then(response => response.json());\n\t\tif (response && response.length) {\n\t\t\tposition.lat = +response[0].lat;\n\t\t\tposition.lng = +response[0].lon;\n\t\t} else {\n\t\t\tconsole.error(`Unable recieve a position of the event's location: ${string}`);\n\t\t}\n\t\treturn position;\n\t}\n}","import { IMapAdapter, ICalendarEvent, IMapSettings, IMapPosition} from \"./types\";\n\ndeclare let mapboxgl: any;\ndeclare let MapboxGeocoder: any;\n\nexport class MapboxAdapter implements IMapAdapter {\n\tprivate map: any;\n\tprivate scheduler: any;\n\tprivate settings: IMapSettings;\n\tprivate _markers: any[];\n\tconstructor(scheduler: any) {\n\t\tthis.map = null;\n\t\tthis._markers = [];\n\t\tthis.scheduler = scheduler;\n\t}\n\tonEventClick(event: ICalendarEvent): void {\n\t\tif (this._markers && this._markers.length > 0) {\n\t\t\tfor (let i = 0; i <  this._markers.length; i++) {\n                const popup = this._markers[i].marker.getPopup();\n                if (popup.isOpen()){\n                    popup.remove();\n                }\n\t\t\t\tif (event.id ==  this._markers[i].event.id) {\n\t\t\t\t\tthis._markers[i].marker.togglePopup();\n\t\t\t\t\tif (event.lat && event.lng) {\n\t\t\t\t\t\tthis.setView(event.lat, event.lng, this.settings.zoom_after_resolve || this.settings.initial_zoom);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.setView(this.settings.error_position.lat, this.settings.error_position.lng, this.settings.zoom_after_resolve || this.settings.initial_zoom);\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t}\n\t\t} \n\t}\n\n\tinitialize(container: HTMLElement, options: IMapSettings): void {\n        let scheduler = this.scheduler;\n\n\t\tmapboxgl.accessToken = options.accessToken;\n        const map = new mapboxgl.Map({\n            container: container, \n            center: [options.initial_position.lng, options.initial_position.lat], \n            zoom:  options.initial_zoom + 1, // problems with coordinates if zoom = 1\n        });\n        map.on(\"dblclick\",async function(e){\n\t\t\tlet response = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.lngLat.lng},${ e.lngLat.lat}.json?access_token=${options.accessToken}`).then(response => response.json());\n\t\t\tif (response.features){\n\t\t\t\tlet address = response.features[0].place_name;\n\t\t\t\tscheduler.addEventNow({\n\t\t\t\t\tlat: e.lngLat.lat,\n\t\t\t\t\tlng: e.lngLat.lng,\n\t\t\t\t\tevent_location: address,\n\t\t\t\t\tstart_date: scheduler.getState().date,\n\t\t\t\t\tend_date: scheduler.date.add(scheduler.getState().date, scheduler.config.time_step, \"minute\")\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.error(\"unable recieve a position of the event\");\n\t\t\t}\n\t\t});\n        this.map = map;\n        this.settings = options;\n\t}\n\n\tdestroy(container: HTMLElement): void {\n\t\tthis.map.remove();\n        while (container.firstChild) {\n\t\t\tcontainer.firstChild.remove();\n\t\t}\n        container.innerHTML = \"\";\n\t}\n\n\taddEventMarker(event: ICalendarEvent): void {\n        let config = [\n\t\t\tevent.lng,\n\t\t\tevent.lat\n\t\t]\n\t\t\n\t\tif (!event.lat || !event.lng) {\n\t\t\tconfig = [this.settings.error_position.lng, this.settings.error_position.lat];\n\t\t} \n\n\t\tconst popup = new mapboxgl.Popup({ offset: 25, focusAfterOpen: false})\n            .setMaxWidth(`${this.settings.info_window_max_width}px`) \n            .setHTML(this.scheduler.templates.map_info_content(event));\n        const marker = new mapboxgl.Marker()\n            .setLngLat(config)\n            .setPopup(popup)\n            .addTo(this.map);\n        const markerInfo = {event, marker};    \n        this._markers.push(markerInfo);\n\t}\n\n\tremoveEventMarker(eventId: string): void {\n\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\tif (eventId == this._markers[i].event.id) {\n\t\t\t\tthis._markers[i].marker.remove();\n                this._markers.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateEventMarker(event: ICalendarEvent): void {\n\t\tfor (let i = 0; i < this._markers.length; i++) {\n\t\t\tif(this._markers[i].event.id == event.id) {\n\t\t\t\tthis._markers[i].event = event;\n\t\t\t\tif (!event.lat || !event.lng){\n\t\t\t\t\tthis._markers[i].marker.setLngLat([this.settings.error_position.lng, this.settings.error_position.lat]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._markers[i].marker.setLngLat([event.lng, event.lat]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclearEventMarkers(): void {\n\t\tfor (let i = 0; i <this._markers.length; i++) {\n\t\t\tthis._markers[i].marker.remove();\n\t\t}\n\t\tthis._markers = [];\n\t}\n\n\tsetView(latitude: number, longitude: number, zoom: number): void {\n\t\tthis.map.setCenter([longitude, latitude]);\n        this.map.setZoom(zoom);\n\t}\n\n\tasync resolveAddress(string: string): Promise<IMapPosition> {\n\t\tlet response = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${string}.json?access_token=${this.settings.accessToken}`).then(response => response.json());\n\t\tlet position:any = {};\n\t\tif (response && response.features.length) {\n\t\t\tposition.lng = response.features[0].center[0];\n\t\t\tposition.lat = response.features[0].center[1];\n\t\t} else {\n\t\t\tconsole.error(`Unable recieve a position of the event's location: ${string}`);\n\t\t}\n\t\treturn position;\n\t}\n}","// =============================================================================\n// Weekday\n// =============================================================================\nexport var ALL_WEEKDAYS = [\n    'MO',\n    'TU',\n    'WE',\n    'TH',\n    'FR',\n    'SA',\n    'SU',\n];\nvar Weekday = /** @class */ (function () {\n    function Weekday(weekday, n) {\n        if (n === 0)\n            throw new Error(\"Can't create weekday with n == 0\");\n        this.weekday = weekday;\n        this.n = n;\n    }\n    Weekday.fromStr = function (str) {\n        return new Weekday(ALL_WEEKDAYS.indexOf(str));\n    };\n    // __call__ - Cannot call the object directly, do it through\n    // e.g. RRule.TH.nth(-1) instead,\n    Weekday.prototype.nth = function (n) {\n        return this.n === n ? this : new Weekday(this.weekday, n);\n    };\n    // __eq__\n    Weekday.prototype.equals = function (other) {\n        return this.weekday === other.weekday && this.n === other.n;\n    };\n    // __repr__\n    Weekday.prototype.toString = function () {\n        var s = ALL_WEEKDAYS[this.weekday];\n        if (this.n)\n            s = (this.n > 0 ? '+' : '') + String(this.n) + s;\n        return s;\n    };\n    Weekday.prototype.getJsWeekday = function () {\n        return this.weekday === 6 ? 0 : this.weekday + 1;\n    };\n    return Weekday;\n}());\nexport { Weekday };\n//# sourceMappingURL=weekday.js.map","// =============================================================================\n// Helper functions\n// =============================================================================\nimport { ALL_WEEKDAYS } from './weekday';\nexport var isPresent = function (value) {\n    return value !== null && value !== undefined;\n};\nexport var isNumber = function (value) {\n    return typeof value === 'number';\n};\nexport var isWeekdayStr = function (value) {\n    return typeof value === 'string' && ALL_WEEKDAYS.includes(value);\n};\nexport var isArray = Array.isArray;\n/**\n * Simplified version of python's range()\n */\nexport var range = function (start, end) {\n    if (end === void 0) { end = start; }\n    if (arguments.length === 1) {\n        end = start;\n        start = 0;\n    }\n    var rang = [];\n    for (var i = start; i < end; i++)\n        rang.push(i);\n    return rang;\n};\nexport var clone = function (array) {\n    return [].concat(array);\n};\nexport var repeat = function (value, times) {\n    var i = 0;\n    var array = [];\n    if (isArray(value)) {\n        for (; i < times; i++)\n            array[i] = [].concat(value);\n    }\n    else {\n        for (; i < times; i++)\n            array[i] = value;\n    }\n    return array;\n};\nexport var toArray = function (item) {\n    if (isArray(item)) {\n        return item;\n    }\n    return [item];\n};\nexport function padStart(item, targetLength, padString) {\n    if (padString === void 0) { padString = ' '; }\n    var str = String(item);\n    targetLength = targetLength >> 0;\n    if (str.length > targetLength) {\n        return String(str);\n    }\n    targetLength = targetLength - str.length;\n    if (targetLength > padString.length) {\n        padString += repeat(padString, targetLength / padString.length);\n    }\n    return padString.slice(0, targetLength) + String(str);\n}\n/**\n * Python like split\n */\nexport var split = function (str, sep, num) {\n    var splits = str.split(sep);\n    return num\n        ? splits.slice(0, num).concat([splits.slice(num).join(sep)])\n        : splits;\n};\n/**\n * closure/goog/math/math.js:modulo\n * Copyright 2006 The Closure Library Authors.\n * The % operator in JavaScript returns the remainder of a / b, but differs from\n * some other languages in that the result will have the same sign as the\n * dividend. For example, -1 % 8 == -1, whereas in some other languages\n * (such as Python) the result would be 7. This function emulates the more\n * correct modulo behavior, which is useful for certain applications such as\n * calculating an offset index in a circular list.\n *\n * @param {number} a The dividend.\n * @param {number} b The divisor.\n * @return {number} a % b where the result is between 0 and b (either 0 <= x < b\n * or b < x <= 0, depending on the sign of b).\n */\nexport var pymod = function (a, b) {\n    var r = a % b;\n    // If r and b differ in sign, add b to wrap the result to the correct sign.\n    return r * b < 0 ? r + b : r;\n};\n/**\n * @see: <http://docs.python.org/library/functions.html#divmod>\n */\nexport var divmod = function (a, b) {\n    return { div: Math.floor(a / b), mod: pymod(a, b) };\n};\nexport var empty = function (obj) {\n    return !isPresent(obj) || obj.length === 0;\n};\n/**\n * Python-like boolean\n *\n * @return {Boolean} value of an object/primitive, taking into account\n * the fact that in Python an empty list's/tuple's\n * boolean value is False, whereas in JS it's true\n */\nexport var notEmpty = function (obj) {\n    return !empty(obj);\n};\n/**\n * Return true if a value is in an array\n */\nexport var includes = function (arr, val) {\n    return notEmpty(arr) && arr.indexOf(val) !== -1;\n};\n//# sourceMappingURL=helpers.js.map","import { padStart } from './helpers';\nexport var datetime = function (y, m, d, h, i, s) {\n    if (h === void 0) { h = 0; }\n    if (i === void 0) { i = 0; }\n    if (s === void 0) { s = 0; }\n    return new Date(Date.UTC(y, m - 1, d, h, i, s));\n};\n/**\n * General date-related utilities.\n * Also handles several incompatibilities between JavaScript and Python\n *\n */\nexport var MONTH_DAYS = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n/**\n * Number of milliseconds of one day\n */\nexport var ONE_DAY = 1000 * 60 * 60 * 24;\n/**\n * @see: <http://docs.python.org/library/datetime.html#datetime.MAXYEAR>\n */\nexport var MAXYEAR = 9999;\n/**\n * Python uses 1-Jan-1 as the base for calculating ordinals but we don't\n * want to confuse the JS engine with milliseconds > Number.MAX_NUMBER,\n * therefore we use 1-Jan-1970 instead\n */\nexport var ORDINAL_BASE = datetime(1970, 1, 1);\n/**\n * Python: MO-SU: 0 - 6\n * JS: SU-SAT 0 - 6\n */\nexport var PY_WEEKDAYS = [6, 0, 1, 2, 3, 4, 5];\n/**\n * py_date.timetuple()[7]\n */\nexport var getYearDay = function (date) {\n    var dateNoTime = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n    return (Math.ceil((dateNoTime.valueOf() - new Date(date.getUTCFullYear(), 0, 1).valueOf()) /\n        ONE_DAY) + 1);\n};\nexport var isLeapYear = function (year) {\n    return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n};\nexport var isDate = function (value) {\n    return value instanceof Date;\n};\nexport var isValidDate = function (value) {\n    return isDate(value) && !isNaN(value.getTime());\n};\n/**\n * @return {Number} the date's timezone offset in ms\n */\nexport var tzOffset = function (date) {\n    return date.getTimezoneOffset() * 60 * 1000;\n};\n/**\n * @see: <http://www.mcfedries.com/JavaScript/DaysBetween.asp>\n */\nexport var daysBetween = function (date1, date2) {\n    // The number of milliseconds in one day\n    // Convert both dates to milliseconds\n    var date1ms = date1.getTime();\n    var date2ms = date2.getTime();\n    // Calculate the difference in milliseconds\n    var differencems = date1ms - date2ms;\n    // Convert back to days and return\n    return Math.round(differencems / ONE_DAY);\n};\n/**\n * @see: <http://docs.python.org/library/datetime.html#datetime.date.toordinal>\n */\nexport var toOrdinal = function (date) {\n    return daysBetween(date, ORDINAL_BASE);\n};\n/**\n * @see - <http://docs.python.org/library/datetime.html#datetime.date.fromordinal>\n */\nexport var fromOrdinal = function (ordinal) {\n    return new Date(ORDINAL_BASE.getTime() + ordinal * ONE_DAY);\n};\nexport var getMonthDays = function (date) {\n    var month = date.getUTCMonth();\n    return month === 1 && isLeapYear(date.getUTCFullYear())\n        ? 29\n        : MONTH_DAYS[month];\n};\n/**\n * @return {Number} python-like weekday\n */\nexport var getWeekday = function (date) {\n    return PY_WEEKDAYS[date.getUTCDay()];\n};\n/**\n * @see: <http://docs.python.org/library/calendar.html#calendar.monthrange>\n */\nexport var monthRange = function (year, month) {\n    var date = datetime(year, month + 1, 1);\n    return [getWeekday(date), getMonthDays(date)];\n};\n/**\n * @see: <http://docs.python.org/library/datetime.html#datetime.datetime.combine>\n */\nexport var combine = function (date, time) {\n    time = time || date;\n    return new Date(Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), time.getHours(), time.getMinutes(), time.getSeconds(), time.getMilliseconds()));\n};\nexport var clone = function (date) {\n    var dolly = new Date(date.getTime());\n    return dolly;\n};\nexport var cloneDates = function (dates) {\n    var clones = [];\n    for (var i = 0; i < dates.length; i++) {\n        clones.push(clone(dates[i]));\n    }\n    return clones;\n};\n/**\n * Sorts an array of Date or Time objects\n */\nexport var sort = function (dates) {\n    dates.sort(function (a, b) {\n        return a.getTime() - b.getTime();\n    });\n};\nexport var timeToUntilString = function (time, utc) {\n    if (utc === void 0) { utc = true; }\n    var date = new Date(time);\n    return [\n        padStart(date.getUTCFullYear().toString(), 4, '0'),\n        padStart(date.getUTCMonth() + 1, 2, '0'),\n        padStart(date.getUTCDate(), 2, '0'),\n        'T',\n        padStart(date.getUTCHours(), 2, '0'),\n        padStart(date.getUTCMinutes(), 2, '0'),\n        padStart(date.getUTCSeconds(), 2, '0'),\n        utc ? 'Z' : '',\n    ].join('');\n};\nexport var untilStringToDate = function (until) {\n    var re = /^(\\d{4})(\\d{2})(\\d{2})(T(\\d{2})(\\d{2})(\\d{2})Z?)?$/;\n    var bits = re.exec(until);\n    if (!bits)\n        throw new Error(\"Invalid UNTIL value: \".concat(until));\n    return new Date(Date.UTC(parseInt(bits[1], 10), parseInt(bits[2], 10) - 1, parseInt(bits[3], 10), parseInt(bits[5], 10) || 0, parseInt(bits[6], 10) || 0, parseInt(bits[7], 10) || 0));\n};\nvar dateTZtoISO8601 = function (date, timeZone) {\n    // date format for sv-SE is almost ISO8601\n    var dateStr = date.toLocaleString('sv-SE', { timeZone: timeZone });\n    // '2023-02-07 10:41:36'\n    return dateStr.replace(' ', 'T') + 'Z';\n};\nexport var dateInTimeZone = function (date, timeZone) {\n    var localTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n    // Date constructor can only reliably parse dates in ISO8601 format\n    var dateInLocalTZ = new Date(dateTZtoISO8601(date, localTimeZone));\n    var dateInTargetTZ = new Date(dateTZtoISO8601(date, timeZone !== null && timeZone !== void 0 ? timeZone : 'UTC'));\n    var tzOffset = dateInTargetTZ.getTime() - dateInLocalTZ.getTime();\n    return new Date(date.getTime() - tzOffset);\n};\n//# sourceMappingURL=dateutil.js.map","/**\n * This class helps us to emulate python's generators, sorta.\n */\nvar IterResult = /** @class */ (function () {\n    function IterResult(method, args) {\n        this.minDate = null;\n        this.maxDate = null;\n        this._result = [];\n        this.total = 0;\n        this.method = method;\n        this.args = args;\n        if (method === 'between') {\n            this.maxDate = args.inc\n                ? args.before\n                : new Date(args.before.getTime() - 1);\n            this.minDate = args.inc ? args.after : new Date(args.after.getTime() + 1);\n        }\n        else if (method === 'before') {\n            this.maxDate = args.inc ? args.dt : new Date(args.dt.getTime() - 1);\n        }\n        else if (method === 'after') {\n            this.minDate = args.inc ? args.dt : new Date(args.dt.getTime() + 1);\n        }\n    }\n    /**\n     * Possibly adds a date into the result.\n     *\n     * @param {Date} date - the date isn't necessarly added to the result\n     * list (if it is too late/too early)\n     * @return {Boolean} true if it makes sense to continue the iteration\n     * false if we're done.\n     */\n    IterResult.prototype.accept = function (date) {\n        ++this.total;\n        var tooEarly = this.minDate && date < this.minDate;\n        var tooLate = this.maxDate && date > this.maxDate;\n        if (this.method === 'between') {\n            if (tooEarly)\n                return true;\n            if (tooLate)\n                return false;\n        }\n        else if (this.method === 'before') {\n            if (tooLate)\n                return false;\n        }\n        else if (this.method === 'after') {\n            if (tooEarly)\n                return true;\n            this.add(date);\n            return false;\n        }\n        return this.add(date);\n    };\n    /**\n     *\n     * @param {Date} date that is part of the result.\n     * @return {Boolean} whether we are interested in more values.\n     */\n    IterResult.prototype.add = function (date) {\n        this._result.push(date);\n        return true;\n    };\n    /**\n     * 'before' and 'after' return only one date, whereas 'all'\n     * and 'between' an array.\n     *\n     * @return {Date,Array?}\n     */\n    IterResult.prototype.getValue = function () {\n        var res = this._result;\n        switch (this.method) {\n            case 'all':\n            case 'between':\n                return res;\n            case 'before':\n            case 'after':\n            default:\n                return (res.length ? res[res.length - 1] : null);\n        }\n    };\n    IterResult.prototype.clone = function () {\n        return new IterResult(this.method, this.args);\n    };\n    return IterResult;\n}());\nexport default IterResult;\n//# sourceMappingURL=iterresult.js.map","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","import { __extends } from \"tslib\";\nimport IterResult from './iterresult';\n/**\n * IterResult subclass that calls a callback function on each add,\n * and stops iterating when the callback returns false.\n */\nvar CallbackIterResult = /** @class */ (function (_super) {\n    __extends(CallbackIterResult, _super);\n    function CallbackIterResult(method, args, iterator) {\n        var _this = _super.call(this, method, args) || this;\n        _this.iterator = iterator;\n        return _this;\n    }\n    CallbackIterResult.prototype.add = function (date) {\n        if (this.iterator(date, this._result.length)) {\n            this._result.push(date);\n            return true;\n        }\n        return false;\n    };\n    return CallbackIterResult;\n}(IterResult));\nexport default CallbackIterResult;\n//# sourceMappingURL=callbackiterresult.js.map","export var Frequency;\n(function (Frequency) {\n    Frequency[Frequency[\"YEARLY\"] = 0] = \"YEARLY\";\n    Frequency[Frequency[\"MONTHLY\"] = 1] = \"MONTHLY\";\n    Frequency[Frequency[\"WEEKLY\"] = 2] = \"WEEKLY\";\n    Frequency[Frequency[\"DAILY\"] = 3] = \"DAILY\";\n    Frequency[Frequency[\"HOURLY\"] = 4] = \"HOURLY\";\n    Frequency[Frequency[\"MINUTELY\"] = 5] = \"MINUTELY\";\n    Frequency[Frequency[\"SECONDLY\"] = 6] = \"SECONDLY\";\n})(Frequency || (Frequency = {}));\nexport function freqIsDailyOrGreater(freq) {\n    return freq < Frequency.HOURLY;\n}\n//# sourceMappingURL=types.js.map","// =============================================================================\n// i18n\n// =============================================================================\nvar ENGLISH = {\n    dayNames: [\n        'Sunday',\n        'Monday',\n        'Tuesday',\n        'Wednesday',\n        'Thursday',\n        'Friday',\n        'Saturday',\n    ],\n    monthNames: [\n        'January',\n        'February',\n        'March',\n        'April',\n        'May',\n        'June',\n        'July',\n        'August',\n        'September',\n        'October',\n        'November',\n        'December',\n    ],\n    tokens: {\n        SKIP: /^[ \\r\\n\\t]+|^\\.$/,\n        number: /^[1-9][0-9]*/,\n        numberAsText: /^(one|two|three)/i,\n        every: /^every/i,\n        'day(s)': /^days?/i,\n        'weekday(s)': /^weekdays?/i,\n        'week(s)': /^weeks?/i,\n        'hour(s)': /^hours?/i,\n        'minute(s)': /^minutes?/i,\n        'month(s)': /^months?/i,\n        'year(s)': /^years?/i,\n        on: /^(on|in)/i,\n        at: /^(at)/i,\n        the: /^the/i,\n        first: /^first/i,\n        second: /^second/i,\n        third: /^third/i,\n        nth: /^([1-9][0-9]*)(\\.|th|nd|rd|st)/i,\n        last: /^last/i,\n        for: /^for/i,\n        'time(s)': /^times?/i,\n        until: /^(un)?til/i,\n        monday: /^mo(n(day)?)?/i,\n        tuesday: /^tu(e(s(day)?)?)?/i,\n        wednesday: /^we(d(n(esday)?)?)?/i,\n        thursday: /^th(u(r(sday)?)?)?/i,\n        friday: /^fr(i(day)?)?/i,\n        saturday: /^sa(t(urday)?)?/i,\n        sunday: /^su(n(day)?)?/i,\n        january: /^jan(uary)?/i,\n        february: /^feb(ruary)?/i,\n        march: /^mar(ch)?/i,\n        april: /^apr(il)?/i,\n        may: /^may/i,\n        june: /^june?/i,\n        july: /^july?/i,\n        august: /^aug(ust)?/i,\n        september: /^sep(t(ember)?)?/i,\n        october: /^oct(ober)?/i,\n        november: /^nov(ember)?/i,\n        december: /^dec(ember)?/i,\n        comma: /^(,\\s*|(and|or)\\s*)+/i,\n    },\n};\nexport default ENGLISH;\n//# sourceMappingURL=i18n.js.map","import ENGLISH from './i18n';\nimport { RRule } from '../rrule';\nimport { isArray, isNumber, isPresent } from '../helpers';\n// =============================================================================\n// Helper functions\n// =============================================================================\n/**\n * Return true if a value is in an array\n */\nvar contains = function (arr, val) {\n    return arr.indexOf(val) !== -1;\n};\nvar defaultGetText = function (id) { return id.toString(); };\nvar defaultDateFormatter = function (year, month, day) { return \"\".concat(month, \" \").concat(day, \", \").concat(year); };\n/**\n *\n * @param {RRule} rrule\n * Optional:\n * @param {Function} gettext function\n * @param {Object} language definition\n * @constructor\n */\nvar ToText = /** @class */ (function () {\n    function ToText(rrule, gettext, language, dateFormatter) {\n        if (gettext === void 0) { gettext = defaultGetText; }\n        if (language === void 0) { language = ENGLISH; }\n        if (dateFormatter === void 0) { dateFormatter = defaultDateFormatter; }\n        this.text = [];\n        this.language = language || ENGLISH;\n        this.gettext = gettext;\n        this.dateFormatter = dateFormatter;\n        this.rrule = rrule;\n        this.options = rrule.options;\n        this.origOptions = rrule.origOptions;\n        if (this.origOptions.bymonthday) {\n            var bymonthday = [].concat(this.options.bymonthday);\n            var bynmonthday = [].concat(this.options.bynmonthday);\n            bymonthday.sort(function (a, b) { return a - b; });\n            bynmonthday.sort(function (a, b) { return b - a; });\n            // 1, 2, 3, .., -5, -4, -3, ..\n            this.bymonthday = bymonthday.concat(bynmonthday);\n            if (!this.bymonthday.length)\n                this.bymonthday = null;\n        }\n        if (isPresent(this.origOptions.byweekday)) {\n            var byweekday = !isArray(this.origOptions.byweekday)\n                ? [this.origOptions.byweekday]\n                : this.origOptions.byweekday;\n            var days = String(byweekday);\n            this.byweekday = {\n                allWeeks: byweekday.filter(function (weekday) {\n                    return !weekday.n;\n                }),\n                someWeeks: byweekday.filter(function (weekday) {\n                    return Boolean(weekday.n);\n                }),\n                isWeekdays: days.indexOf('MO') !== -1 &&\n                    days.indexOf('TU') !== -1 &&\n                    days.indexOf('WE') !== -1 &&\n                    days.indexOf('TH') !== -1 &&\n                    days.indexOf('FR') !== -1 &&\n                    days.indexOf('SA') === -1 &&\n                    days.indexOf('SU') === -1,\n                isEveryDay: days.indexOf('MO') !== -1 &&\n                    days.indexOf('TU') !== -1 &&\n                    days.indexOf('WE') !== -1 &&\n                    days.indexOf('TH') !== -1 &&\n                    days.indexOf('FR') !== -1 &&\n                    days.indexOf('SA') !== -1 &&\n                    days.indexOf('SU') !== -1,\n            };\n            var sortWeekDays = function (a, b) {\n                return a.weekday - b.weekday;\n            };\n            this.byweekday.allWeeks.sort(sortWeekDays);\n            this.byweekday.someWeeks.sort(sortWeekDays);\n            if (!this.byweekday.allWeeks.length)\n                this.byweekday.allWeeks = null;\n            if (!this.byweekday.someWeeks.length)\n                this.byweekday.someWeeks = null;\n        }\n        else {\n            this.byweekday = null;\n        }\n    }\n    /**\n     * Test whether the rrule can be fully converted to text.\n     *\n     * @param {RRule} rrule\n     * @return {Boolean}\n     */\n    ToText.isFullyConvertible = function (rrule) {\n        var canConvert = true;\n        if (!(rrule.options.freq in ToText.IMPLEMENTED))\n            return false;\n        if (rrule.origOptions.until && rrule.origOptions.count)\n            return false;\n        for (var key in rrule.origOptions) {\n            if (contains(['dtstart', 'tzid', 'wkst', 'freq'], key))\n                return true;\n            if (!contains(ToText.IMPLEMENTED[rrule.options.freq], key))\n                return false;\n        }\n        return canConvert;\n    };\n    ToText.prototype.isFullyConvertible = function () {\n        return ToText.isFullyConvertible(this.rrule);\n    };\n    /**\n     * Perform the conversion. Only some of the frequencies are supported.\n     * If some of the rrule's options aren't supported, they'll\n     * be omitted from the output an \"(~ approximate)\" will be appended.\n     *\n     * @return {*}\n     */\n    ToText.prototype.toString = function () {\n        var gettext = this.gettext;\n        if (!(this.options.freq in ToText.IMPLEMENTED)) {\n            return gettext('RRule error: Unable to fully convert this rrule to text');\n        }\n        this.text = [gettext('every')];\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        this[RRule.FREQUENCIES[this.options.freq]]();\n        if (this.options.until) {\n            this.add(gettext('until'));\n            var until = this.options.until;\n            this.add(this.dateFormatter(until.getUTCFullYear(), this.language.monthNames[until.getUTCMonth()], until.getUTCDate()));\n        }\n        else if (this.options.count) {\n            this.add(gettext('for'))\n                .add(this.options.count.toString())\n                .add(this.plural(this.options.count) ? gettext('times') : gettext('time'));\n        }\n        if (!this.isFullyConvertible())\n            this.add(gettext('(~ approximate)'));\n        return this.text.join('');\n    };\n    ToText.prototype.HOURLY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        this.add(this.plural(this.options.interval) ? gettext('hours') : gettext('hour'));\n    };\n    ToText.prototype.MINUTELY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        this.add(this.plural(this.options.interval)\n            ? gettext('minutes')\n            : gettext('minute'));\n    };\n    ToText.prototype.DAILY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        if (this.byweekday && this.byweekday.isWeekdays) {\n            this.add(this.plural(this.options.interval)\n                ? gettext('weekdays')\n                : gettext('weekday'));\n        }\n        else {\n            this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n        }\n        if (this.origOptions.bymonth) {\n            this.add(gettext('in'));\n            this._bymonth();\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n        else if (this.origOptions.byhour) {\n            this._byhour();\n        }\n    };\n    ToText.prototype.WEEKLY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1) {\n            this.add(this.options.interval.toString()).add(this.plural(this.options.interval) ? gettext('weeks') : gettext('week'));\n        }\n        if (this.byweekday && this.byweekday.isWeekdays) {\n            if (this.options.interval === 1) {\n                this.add(this.plural(this.options.interval)\n                    ? gettext('weekdays')\n                    : gettext('weekday'));\n            }\n            else {\n                this.add(gettext('on')).add(gettext('weekdays'));\n            }\n        }\n        else if (this.byweekday && this.byweekday.isEveryDay) {\n            this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n        }\n        else {\n            if (this.options.interval === 1)\n                this.add(gettext('week'));\n            if (this.origOptions.bymonth) {\n                this.add(gettext('in'));\n                this._bymonth();\n            }\n            if (this.bymonthday) {\n                this._bymonthday();\n            }\n            else if (this.byweekday) {\n                this._byweekday();\n            }\n            if (this.origOptions.byhour) {\n                this._byhour();\n            }\n        }\n    };\n    ToText.prototype.MONTHLY = function () {\n        var gettext = this.gettext;\n        if (this.origOptions.bymonth) {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString()).add(gettext('months'));\n                if (this.plural(this.options.interval))\n                    this.add(gettext('in'));\n            }\n            else {\n                // this.add(gettext('MONTH'))\n            }\n            this._bymonth();\n        }\n        else {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n            }\n            this.add(this.plural(this.options.interval)\n                ? gettext('months')\n                : gettext('month'));\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday && this.byweekday.isWeekdays) {\n            this.add(gettext('on')).add(gettext('weekdays'));\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n    };\n    ToText.prototype.YEARLY = function () {\n        var gettext = this.gettext;\n        if (this.origOptions.bymonth) {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n                this.add(gettext('years'));\n            }\n            else {\n                // this.add(gettext('YEAR'))\n            }\n            this._bymonth();\n        }\n        else {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n            }\n            this.add(this.plural(this.options.interval) ? gettext('years') : gettext('year'));\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n        if (this.options.byyearday) {\n            this.add(gettext('on the'))\n                .add(this.list(this.options.byyearday, this.nth, gettext('and')))\n                .add(gettext('day'));\n        }\n        if (this.options.byweekno) {\n            this.add(gettext('in'))\n                .add(this.plural(this.options.byweekno.length)\n                ? gettext('weeks')\n                : gettext('week'))\n                .add(this.list(this.options.byweekno, undefined, gettext('and')));\n        }\n    };\n    ToText.prototype._bymonthday = function () {\n        var gettext = this.gettext;\n        if (this.byweekday && this.byweekday.allWeeks) {\n            this.add(gettext('on'))\n                .add(this.list(this.byweekday.allWeeks, this.weekdaytext, gettext('or')))\n                .add(gettext('the'))\n                .add(this.list(this.bymonthday, this.nth, gettext('or')));\n        }\n        else {\n            this.add(gettext('on the')).add(this.list(this.bymonthday, this.nth, gettext('and')));\n        }\n        // this.add(gettext('DAY'))\n    };\n    ToText.prototype._byweekday = function () {\n        var gettext = this.gettext;\n        if (this.byweekday.allWeeks && !this.byweekday.isWeekdays) {\n            this.add(gettext('on')).add(this.list(this.byweekday.allWeeks, this.weekdaytext));\n        }\n        if (this.byweekday.someWeeks) {\n            if (this.byweekday.allWeeks)\n                this.add(gettext('and'));\n            this.add(gettext('on the')).add(this.list(this.byweekday.someWeeks, this.weekdaytext, gettext('and')));\n        }\n    };\n    ToText.prototype._byhour = function () {\n        var gettext = this.gettext;\n        this.add(gettext('at')).add(this.list(this.origOptions.byhour, undefined, gettext('and')));\n    };\n    ToText.prototype._bymonth = function () {\n        this.add(this.list(this.options.bymonth, this.monthtext, this.gettext('and')));\n    };\n    ToText.prototype.nth = function (n) {\n        n = parseInt(n.toString(), 10);\n        var nth;\n        var gettext = this.gettext;\n        if (n === -1)\n            return gettext('last');\n        var npos = Math.abs(n);\n        switch (npos) {\n            case 1:\n            case 21:\n            case 31:\n                nth = npos + gettext('st');\n                break;\n            case 2:\n            case 22:\n                nth = npos + gettext('nd');\n                break;\n            case 3:\n            case 23:\n                nth = npos + gettext('rd');\n                break;\n            default:\n                nth = npos + gettext('th');\n        }\n        return n < 0 ? nth + ' ' + gettext('last') : nth;\n    };\n    ToText.prototype.monthtext = function (m) {\n        return this.language.monthNames[m - 1];\n    };\n    ToText.prototype.weekdaytext = function (wday) {\n        var weekday = isNumber(wday) ? (wday + 1) % 7 : wday.getJsWeekday();\n        return ((wday.n ? this.nth(wday.n) + ' ' : '') +\n            this.language.dayNames[weekday]);\n    };\n    ToText.prototype.plural = function (n) {\n        return n % 100 !== 1;\n    };\n    ToText.prototype.add = function (s) {\n        this.text.push(' ');\n        this.text.push(s);\n        return this;\n    };\n    ToText.prototype.list = function (arr, callback, finalDelim, delim) {\n        var _this = this;\n        if (delim === void 0) { delim = ','; }\n        if (!isArray(arr)) {\n            arr = [arr];\n        }\n        var delimJoin = function (array, delimiter, finalDelimiter) {\n            var list = '';\n            for (var i = 0; i < array.length; i++) {\n                if (i !== 0) {\n                    if (i === array.length - 1) {\n                        list += ' ' + finalDelimiter + ' ';\n                    }\n                    else {\n                        list += delimiter + ' ';\n                    }\n                }\n                list += array[i];\n            }\n            return list;\n        };\n        callback =\n            callback ||\n                function (o) {\n                    return o.toString();\n                };\n        var realCallback = function (arg) {\n            return callback && callback.call(_this, arg);\n        };\n        if (finalDelim) {\n            return delimJoin(arr.map(realCallback), delim, finalDelim);\n        }\n        else {\n            return arr.map(realCallback).join(delim + ' ');\n        }\n    };\n    return ToText;\n}());\nexport default ToText;\n//# sourceMappingURL=totext.js.map","import ENGLISH from './i18n';\nimport { RRule } from '../rrule';\n// =============================================================================\n// Parser\n// =============================================================================\nvar Parser = /** @class */ (function () {\n    function Parser(rules) {\n        this.done = true;\n        this.rules = rules;\n    }\n    Parser.prototype.start = function (text) {\n        this.text = text;\n        this.done = false;\n        return this.nextSymbol();\n    };\n    Parser.prototype.isDone = function () {\n        return this.done && this.symbol === null;\n    };\n    Parser.prototype.nextSymbol = function () {\n        var best;\n        var bestSymbol;\n        this.symbol = null;\n        this.value = null;\n        do {\n            if (this.done)\n                return false;\n            var rule = void 0;\n            best = null;\n            for (var name_1 in this.rules) {\n                rule = this.rules[name_1];\n                var match = rule.exec(this.text);\n                if (match) {\n                    if (best === null || match[0].length > best[0].length) {\n                        best = match;\n                        bestSymbol = name_1;\n                    }\n                }\n            }\n            if (best != null) {\n                this.text = this.text.substr(best[0].length);\n                if (this.text === '')\n                    this.done = true;\n            }\n            if (best == null) {\n                this.done = true;\n                this.symbol = null;\n                this.value = null;\n                return;\n            }\n        } while (bestSymbol === 'SKIP');\n        this.symbol = bestSymbol;\n        this.value = best;\n        return true;\n    };\n    Parser.prototype.accept = function (name) {\n        if (this.symbol === name) {\n            if (this.value) {\n                var v = this.value;\n                this.nextSymbol();\n                return v;\n            }\n            this.nextSymbol();\n            return true;\n        }\n        return false;\n    };\n    Parser.prototype.acceptNumber = function () {\n        return this.accept('number');\n    };\n    Parser.prototype.expect = function (name) {\n        if (this.accept(name))\n            return true;\n        throw new Error('expected ' + name + ' but found ' + this.symbol);\n    };\n    return Parser;\n}());\nexport default function parseText(text, language) {\n    if (language === void 0) { language = ENGLISH; }\n    var options = {};\n    var ttr = new Parser(language.tokens);\n    if (!ttr.start(text))\n        return null;\n    S();\n    return options;\n    function S() {\n        // every [n]\n        ttr.expect('every');\n        var n = ttr.acceptNumber();\n        if (n)\n            options.interval = parseInt(n[0], 10);\n        if (ttr.isDone())\n            throw new Error('Unexpected end');\n        switch (ttr.symbol) {\n            case 'day(s)':\n                options.freq = RRule.DAILY;\n                if (ttr.nextSymbol()) {\n                    AT();\n                    F();\n                }\n                break;\n            // FIXME Note: every 2 weekdays != every two weeks on weekdays.\n            // DAILY on weekdays is not a valid rule\n            case 'weekday(s)':\n                options.freq = RRule.WEEKLY;\n                options.byweekday = [RRule.MO, RRule.TU, RRule.WE, RRule.TH, RRule.FR];\n                ttr.nextSymbol();\n                AT();\n                F();\n                break;\n            case 'week(s)':\n                options.freq = RRule.WEEKLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    AT();\n                    F();\n                }\n                break;\n            case 'hour(s)':\n                options.freq = RRule.HOURLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'minute(s)':\n                options.freq = RRule.MINUTELY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'month(s)':\n                options.freq = RRule.MONTHLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'year(s)':\n                options.freq = RRule.YEARLY;\n                if (ttr.nextSymbol()) {\n                    ON();\n                    F();\n                }\n                break;\n            case 'monday':\n            case 'tuesday':\n            case 'wednesday':\n            case 'thursday':\n            case 'friday':\n            case 'saturday':\n            case 'sunday':\n                options.freq = RRule.WEEKLY;\n                var key = ttr.symbol\n                    .substr(0, 2)\n                    .toUpperCase();\n                options.byweekday = [RRule[key]];\n                if (!ttr.nextSymbol())\n                    return;\n                // TODO check for duplicates\n                while (ttr.accept('comma')) {\n                    if (ttr.isDone())\n                        throw new Error('Unexpected end');\n                    var wkd = decodeWKD();\n                    if (!wkd) {\n                        throw new Error('Unexpected symbol ' + ttr.symbol + ', expected weekday');\n                    }\n                    options.byweekday.push(RRule[wkd]);\n                    ttr.nextSymbol();\n                }\n                AT();\n                MDAYs();\n                F();\n                break;\n            case 'january':\n            case 'february':\n            case 'march':\n            case 'april':\n            case 'may':\n            case 'june':\n            case 'july':\n            case 'august':\n            case 'september':\n            case 'october':\n            case 'november':\n            case 'december':\n                options.freq = RRule.YEARLY;\n                options.bymonth = [decodeM()];\n                if (!ttr.nextSymbol())\n                    return;\n                // TODO check for duplicates\n                while (ttr.accept('comma')) {\n                    if (ttr.isDone())\n                        throw new Error('Unexpected end');\n                    var m = decodeM();\n                    if (!m) {\n                        throw new Error('Unexpected symbol ' + ttr.symbol + ', expected month');\n                    }\n                    options.bymonth.push(m);\n                    ttr.nextSymbol();\n                }\n                ON();\n                F();\n                break;\n            default:\n                throw new Error('Unknown symbol');\n        }\n    }\n    function ON() {\n        var on = ttr.accept('on');\n        var the = ttr.accept('the');\n        if (!(on || the))\n            return;\n        do {\n            var nth = decodeNTH();\n            var wkd = decodeWKD();\n            var m = decodeM();\n            // nth <weekday> | <weekday>\n            if (nth) {\n                // ttr.nextSymbol()\n                if (wkd) {\n                    ttr.nextSymbol();\n                    if (!options.byweekday)\n                        options.byweekday = [];\n                    options.byweekday.push(RRule[wkd].nth(nth));\n                }\n                else {\n                    if (!options.bymonthday)\n                        options.bymonthday = [];\n                    options.bymonthday.push(nth);\n                    ttr.accept('day(s)');\n                }\n                // <weekday>\n            }\n            else if (wkd) {\n                ttr.nextSymbol();\n                if (!options.byweekday)\n                    options.byweekday = [];\n                options.byweekday.push(RRule[wkd]);\n            }\n            else if (ttr.symbol === 'weekday(s)') {\n                ttr.nextSymbol();\n                if (!options.byweekday) {\n                    options.byweekday = [RRule.MO, RRule.TU, RRule.WE, RRule.TH, RRule.FR];\n                }\n            }\n            else if (ttr.symbol === 'week(s)') {\n                ttr.nextSymbol();\n                var n = ttr.acceptNumber();\n                if (!n) {\n                    throw new Error('Unexpected symbol ' + ttr.symbol + ', expected week number');\n                }\n                options.byweekno = [parseInt(n[0], 10)];\n                while (ttr.accept('comma')) {\n                    n = ttr.acceptNumber();\n                    if (!n) {\n                        throw new Error('Unexpected symbol ' + ttr.symbol + '; expected monthday');\n                    }\n                    options.byweekno.push(parseInt(n[0], 10));\n                }\n            }\n            else if (m) {\n                ttr.nextSymbol();\n                if (!options.bymonth)\n                    options.bymonth = [];\n                options.bymonth.push(m);\n            }\n            else {\n                return;\n            }\n        } while (ttr.accept('comma') || ttr.accept('the') || ttr.accept('on'));\n    }\n    function AT() {\n        var at = ttr.accept('at');\n        if (!at)\n            return;\n        do {\n            var n = ttr.acceptNumber();\n            if (!n) {\n                throw new Error('Unexpected symbol ' + ttr.symbol + ', expected hour');\n            }\n            options.byhour = [parseInt(n[0], 10)];\n            while (ttr.accept('comma')) {\n                n = ttr.acceptNumber();\n                if (!n) {\n                    throw new Error('Unexpected symbol ' + ttr.symbol + '; expected hour');\n                }\n                options.byhour.push(parseInt(n[0], 10));\n            }\n        } while (ttr.accept('comma') || ttr.accept('at'));\n    }\n    function decodeM() {\n        switch (ttr.symbol) {\n            case 'january':\n                return 1;\n            case 'february':\n                return 2;\n            case 'march':\n                return 3;\n            case 'april':\n                return 4;\n            case 'may':\n                return 5;\n            case 'june':\n                return 6;\n            case 'july':\n                return 7;\n            case 'august':\n                return 8;\n            case 'september':\n                return 9;\n            case 'october':\n                return 10;\n            case 'november':\n                return 11;\n            case 'december':\n                return 12;\n            default:\n                return false;\n        }\n    }\n    function decodeWKD() {\n        switch (ttr.symbol) {\n            case 'monday':\n            case 'tuesday':\n            case 'wednesday':\n            case 'thursday':\n            case 'friday':\n            case 'saturday':\n            case 'sunday':\n                return ttr.symbol.substr(0, 2).toUpperCase();\n            default:\n                return false;\n        }\n    }\n    function decodeNTH() {\n        switch (ttr.symbol) {\n            case 'last':\n                ttr.nextSymbol();\n                return -1;\n            case 'first':\n                ttr.nextSymbol();\n                return 1;\n            case 'second':\n                ttr.nextSymbol();\n                return ttr.accept('last') ? -2 : 2;\n            case 'third':\n                ttr.nextSymbol();\n                return ttr.accept('last') ? -3 : 3;\n            case 'nth':\n                var v = parseInt(ttr.value[1], 10);\n                if (v < -366 || v > 366)\n                    throw new Error('Nth out of range: ' + v);\n                ttr.nextSymbol();\n                return ttr.accept('last') ? -v : v;\n            default:\n                return false;\n        }\n    }\n    function MDAYs() {\n        ttr.accept('on');\n        ttr.accept('the');\n        var nth = decodeNTH();\n        if (!nth)\n            return;\n        options.bymonthday = [nth];\n        ttr.nextSymbol();\n        while (ttr.accept('comma')) {\n            nth = decodeNTH();\n            if (!nth) {\n                throw new Error('Unexpected symbol ' + ttr.symbol + '; expected monthday');\n            }\n            options.bymonthday.push(nth);\n            ttr.nextSymbol();\n        }\n    }\n    function F() {\n        if (ttr.symbol === 'until') {\n            var date = Date.parse(ttr.text);\n            if (!date)\n                throw new Error('Cannot parse until date:' + ttr.text);\n            options.until = new Date(date);\n        }\n        else if (ttr.accept('for')) {\n            options.count = parseInt(ttr.value[0], 10);\n            ttr.expect('number');\n            // ttr.expect('times')\n        }\n    }\n}\n//# sourceMappingURL=parsetext.js.map","import ToText from './totext';\nimport parseText from './parsetext';\nimport { RRule } from '../rrule';\nimport { Frequency } from '../types';\nimport ENGLISH from './i18n';\n/* !\n * rrule.js - Library for working with recurrence rules for calendar dates.\n * https://github.com/jakubroztocil/rrule\n *\n * Copyright 2010, Jakub Roztocil and Lars Schoning\n * Licenced under the BSD licence.\n * https://github.com/jakubroztocil/rrule/blob/master/LICENCE\n *\n */\n/**\n *\n * Implementation of RRule.fromText() and RRule::toText().\n *\n *\n * On the client side, this file needs to be included\n * when those functions are used.\n *\n */\n// =============================================================================\n// fromText\n// =============================================================================\n/**\n * Will be able to convert some of the below described rules from\n * text format to a rule object.\n *\n *\n * RULES\n *\n * Every ([n])\n * day(s)\n * | [weekday], ..., (and) [weekday]\n * | weekday(s)\n * | week(s)\n * | month(s)\n * | [month], ..., (and) [month]\n * | year(s)\n *\n *\n * Plus 0, 1, or multiple of these:\n *\n * on [weekday], ..., (or) [weekday] the [monthday], [monthday], ... (or) [monthday]\n *\n * on [weekday], ..., (and) [weekday]\n *\n * on the [monthday], [monthday], ... (and) [monthday] (day of the month)\n *\n * on the [nth-weekday], ..., (and) [nth-weekday] (of the month/year)\n *\n *\n * Plus 0 or 1 of these:\n *\n * for [n] time(s)\n *\n * until [date]\n *\n * Plus (.)\n *\n *\n * Definitely no supported for parsing:\n *\n * (for year):\n * in week(s) [n], ..., (and) [n]\n *\n * on the [yearday], ..., (and) [n] day of the year\n * on day [yearday], ..., (and) [n]\n *\n *\n * NON-TERMINALS\n *\n * [n]: 1, 2 ..., one, two, three ..\n * [month]: January, February, March, April, May, ... December\n * [weekday]: Monday, ... Sunday\n * [nth-weekday]: first [weekday], 2nd [weekday], ... last [weekday], ...\n * [monthday]: first, 1., 2., 1st, 2nd, second, ... 31st, last day, 2nd last day, ..\n * [date]:\n * - [month] (0-31(,) ([year])),\n * - (the) 0-31.(1-12.([year])),\n * - (the) 0-31/(1-12/([year])),\n * - [weekday]\n *\n * [year]: 0000, 0001, ... 01, 02, ..\n *\n * Definitely not supported for parsing:\n *\n * [yearday]: first, 1., 2., 1st, 2nd, second, ... 366th, last day, 2nd last day, ..\n *\n * @param {String} text\n * @return {Object, Boolean} the rule, or null.\n */\nvar fromText = function (text, language) {\n    if (language === void 0) { language = ENGLISH; }\n    return new RRule(parseText(text, language) || undefined);\n};\nvar common = [\n    'count',\n    'until',\n    'interval',\n    'byweekday',\n    'bymonthday',\n    'bymonth',\n];\nToText.IMPLEMENTED = [];\nToText.IMPLEMENTED[Frequency.HOURLY] = common;\nToText.IMPLEMENTED[Frequency.MINUTELY] = common;\nToText.IMPLEMENTED[Frequency.DAILY] = ['byhour'].concat(common);\nToText.IMPLEMENTED[Frequency.WEEKLY] = common;\nToText.IMPLEMENTED[Frequency.MONTHLY] = common;\nToText.IMPLEMENTED[Frequency.YEARLY] = ['byweekno', 'byyearday'].concat(common);\n// =============================================================================\n// Export\n// =============================================================================\nvar toText = function (rrule, gettext, language, dateFormatter) {\n    return new ToText(rrule, gettext, language, dateFormatter).toString();\n};\nvar isFullyConvertible = ToText.isFullyConvertible;\nexport { fromText, parseText, isFullyConvertible, toText };\n//# sourceMappingURL=index.js.map","import { __extends } from \"tslib\";\nimport { Frequency } from './types';\nimport { pymod, divmod, empty, includes } from './helpers';\nimport { getWeekday, MAXYEAR, monthRange } from './dateutil';\nvar Time = /** @class */ (function () {\n    function Time(hour, minute, second, millisecond) {\n        this.hour = hour;\n        this.minute = minute;\n        this.second = second;\n        this.millisecond = millisecond || 0;\n    }\n    Time.prototype.getHours = function () {\n        return this.hour;\n    };\n    Time.prototype.getMinutes = function () {\n        return this.minute;\n    };\n    Time.prototype.getSeconds = function () {\n        return this.second;\n    };\n    Time.prototype.getMilliseconds = function () {\n        return this.millisecond;\n    };\n    Time.prototype.getTime = function () {\n        return ((this.hour * 60 * 60 + this.minute * 60 + this.second) * 1000 +\n            this.millisecond);\n    };\n    return Time;\n}());\nexport { Time };\nvar DateTime = /** @class */ (function (_super) {\n    __extends(DateTime, _super);\n    function DateTime(year, month, day, hour, minute, second, millisecond) {\n        var _this = _super.call(this, hour, minute, second, millisecond) || this;\n        _this.year = year;\n        _this.month = month;\n        _this.day = day;\n        return _this;\n    }\n    DateTime.fromDate = function (date) {\n        return new this(date.getUTCFullYear(), date.getUTCMonth() + 1, date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.valueOf() % 1000);\n    };\n    DateTime.prototype.getWeekday = function () {\n        return getWeekday(new Date(this.getTime()));\n    };\n    DateTime.prototype.getTime = function () {\n        return new Date(Date.UTC(this.year, this.month - 1, this.day, this.hour, this.minute, this.second, this.millisecond)).getTime();\n    };\n    DateTime.prototype.getDay = function () {\n        return this.day;\n    };\n    DateTime.prototype.getMonth = function () {\n        return this.month;\n    };\n    DateTime.prototype.getYear = function () {\n        return this.year;\n    };\n    DateTime.prototype.addYears = function (years) {\n        this.year += years;\n    };\n    DateTime.prototype.addMonths = function (months) {\n        this.month += months;\n        if (this.month > 12) {\n            var yearDiv = Math.floor(this.month / 12);\n            var monthMod = pymod(this.month, 12);\n            this.month = monthMod;\n            this.year += yearDiv;\n            if (this.month === 0) {\n                this.month = 12;\n                --this.year;\n            }\n        }\n    };\n    DateTime.prototype.addWeekly = function (days, wkst) {\n        if (wkst > this.getWeekday()) {\n            this.day += -(this.getWeekday() + 1 + (6 - wkst)) + days * 7;\n        }\n        else {\n            this.day += -(this.getWeekday() - wkst) + days * 7;\n        }\n        this.fixDay();\n    };\n    DateTime.prototype.addDaily = function (days) {\n        this.day += days;\n        this.fixDay();\n    };\n    DateTime.prototype.addHours = function (hours, filtered, byhour) {\n        if (filtered) {\n            // Jump to one iteration before next day\n            this.hour += Math.floor((23 - this.hour) / hours) * hours;\n        }\n        for (;;) {\n            this.hour += hours;\n            var _a = divmod(this.hour, 24), dayDiv = _a.div, hourMod = _a.mod;\n            if (dayDiv) {\n                this.hour = hourMod;\n                this.addDaily(dayDiv);\n            }\n            if (empty(byhour) || includes(byhour, this.hour))\n                break;\n        }\n    };\n    DateTime.prototype.addMinutes = function (minutes, filtered, byhour, byminute) {\n        if (filtered) {\n            // Jump to one iteration before next day\n            this.minute +=\n                Math.floor((1439 - (this.hour * 60 + this.minute)) / minutes) * minutes;\n        }\n        for (;;) {\n            this.minute += minutes;\n            var _a = divmod(this.minute, 60), hourDiv = _a.div, minuteMod = _a.mod;\n            if (hourDiv) {\n                this.minute = minuteMod;\n                this.addHours(hourDiv, false, byhour);\n            }\n            if ((empty(byhour) || includes(byhour, this.hour)) &&\n                (empty(byminute) || includes(byminute, this.minute))) {\n                break;\n            }\n        }\n    };\n    DateTime.prototype.addSeconds = function (seconds, filtered, byhour, byminute, bysecond) {\n        if (filtered) {\n            // Jump to one iteration before next day\n            this.second +=\n                Math.floor((86399 - (this.hour * 3600 + this.minute * 60 + this.second)) /\n                    seconds) * seconds;\n        }\n        for (;;) {\n            this.second += seconds;\n            var _a = divmod(this.second, 60), minuteDiv = _a.div, secondMod = _a.mod;\n            if (minuteDiv) {\n                this.second = secondMod;\n                this.addMinutes(minuteDiv, false, byhour, byminute);\n            }\n            if ((empty(byhour) || includes(byhour, this.hour)) &&\n                (empty(byminute) || includes(byminute, this.minute)) &&\n                (empty(bysecond) || includes(bysecond, this.second))) {\n                break;\n            }\n        }\n    };\n    DateTime.prototype.fixDay = function () {\n        if (this.day <= 28) {\n            return;\n        }\n        var daysinmonth = monthRange(this.year, this.month - 1)[1];\n        if (this.day <= daysinmonth) {\n            return;\n        }\n        while (this.day > daysinmonth) {\n            this.day -= daysinmonth;\n            ++this.month;\n            if (this.month === 13) {\n                this.month = 1;\n                ++this.year;\n                if (this.year > MAXYEAR) {\n                    return;\n                }\n            }\n            daysinmonth = monthRange(this.year, this.month - 1)[1];\n        }\n    };\n    DateTime.prototype.add = function (options, filtered) {\n        var freq = options.freq, interval = options.interval, wkst = options.wkst, byhour = options.byhour, byminute = options.byminute, bysecond = options.bysecond;\n        switch (freq) {\n            case Frequency.YEARLY:\n                return this.addYears(interval);\n            case Frequency.MONTHLY:\n                return this.addMonths(interval);\n            case Frequency.WEEKLY:\n                return this.addWeekly(interval, wkst);\n            case Frequency.DAILY:\n                return this.addDaily(interval);\n            case Frequency.HOURLY:\n                return this.addHours(interval, filtered, byhour);\n            case Frequency.MINUTELY:\n                return this.addMinutes(interval, filtered, byhour, byminute);\n            case Frequency.SECONDLY:\n                return this.addSeconds(interval, filtered, byhour, byminute, bysecond);\n        }\n    };\n    return DateTime;\n}(Time));\nexport { DateTime };\n//# sourceMappingURL=datetime.js.map","import { __assign } from \"tslib\";\nimport { freqIsDailyOrGreater } from './types';\nimport { includes, notEmpty, isPresent, isNumber, isArray, isWeekdayStr, } from './helpers';\nimport { RRule, defaultKeys, DEFAULT_OPTIONS } from './rrule';\nimport { getWeekday, isDate, isValidDate } from './dateutil';\nimport { Weekday } from './weekday';\nimport { Time } from './datetime';\nexport function initializeOptions(options) {\n    var invalid = [];\n    var keys = Object.keys(options);\n    // Shallow copy for options and origOptions and check for invalid\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        if (!includes(defaultKeys, key))\n            invalid.push(key);\n        if (isDate(options[key]) && !isValidDate(options[key])) {\n            invalid.push(key);\n        }\n    }\n    if (invalid.length) {\n        throw new Error('Invalid options: ' + invalid.join(', '));\n    }\n    return __assign({}, options);\n}\nexport function parseOptions(options) {\n    var opts = __assign(__assign({}, DEFAULT_OPTIONS), initializeOptions(options));\n    if (isPresent(opts.byeaster))\n        opts.freq = RRule.YEARLY;\n    if (!(isPresent(opts.freq) && RRule.FREQUENCIES[opts.freq])) {\n        throw new Error(\"Invalid frequency: \".concat(opts.freq, \" \").concat(options.freq));\n    }\n    if (!opts.dtstart)\n        opts.dtstart = new Date(new Date().setMilliseconds(0));\n    if (!isPresent(opts.wkst)) {\n        opts.wkst = RRule.MO.weekday;\n    }\n    else if (isNumber(opts.wkst)) {\n        // cool, just keep it like that\n    }\n    else {\n        opts.wkst = opts.wkst.weekday;\n    }\n    if (isPresent(opts.bysetpos)) {\n        if (isNumber(opts.bysetpos))\n            opts.bysetpos = [opts.bysetpos];\n        for (var i = 0; i < opts.bysetpos.length; i++) {\n            var v = opts.bysetpos[i];\n            if (v === 0 || !(v >= -366 && v <= 366)) {\n                throw new Error('bysetpos must be between 1 and 366,' + ' or between -366 and -1');\n            }\n        }\n    }\n    if (!(Boolean(opts.byweekno) ||\n        notEmpty(opts.byweekno) ||\n        notEmpty(opts.byyearday) ||\n        Boolean(opts.bymonthday) ||\n        notEmpty(opts.bymonthday) ||\n        isPresent(opts.byweekday) ||\n        isPresent(opts.byeaster))) {\n        switch (opts.freq) {\n            case RRule.YEARLY:\n                if (!opts.bymonth)\n                    opts.bymonth = opts.dtstart.getUTCMonth() + 1;\n                opts.bymonthday = opts.dtstart.getUTCDate();\n                break;\n            case RRule.MONTHLY:\n                opts.bymonthday = opts.dtstart.getUTCDate();\n                break;\n            case RRule.WEEKLY:\n                opts.byweekday = [getWeekday(opts.dtstart)];\n                break;\n        }\n    }\n    // bymonth\n    if (isPresent(opts.bymonth) && !isArray(opts.bymonth)) {\n        opts.bymonth = [opts.bymonth];\n    }\n    // byyearday\n    if (isPresent(opts.byyearday) &&\n        !isArray(opts.byyearday) &&\n        isNumber(opts.byyearday)) {\n        opts.byyearday = [opts.byyearday];\n    }\n    // bymonthday\n    if (!isPresent(opts.bymonthday)) {\n        opts.bymonthday = [];\n        opts.bynmonthday = [];\n    }\n    else if (isArray(opts.bymonthday)) {\n        var bymonthday = [];\n        var bynmonthday = [];\n        for (var i = 0; i < opts.bymonthday.length; i++) {\n            var v = opts.bymonthday[i];\n            if (v > 0) {\n                bymonthday.push(v);\n            }\n            else if (v < 0) {\n                bynmonthday.push(v);\n            }\n        }\n        opts.bymonthday = bymonthday;\n        opts.bynmonthday = bynmonthday;\n    }\n    else if (opts.bymonthday < 0) {\n        opts.bynmonthday = [opts.bymonthday];\n        opts.bymonthday = [];\n    }\n    else {\n        opts.bynmonthday = [];\n        opts.bymonthday = [opts.bymonthday];\n    }\n    // byweekno\n    if (isPresent(opts.byweekno) && !isArray(opts.byweekno)) {\n        opts.byweekno = [opts.byweekno];\n    }\n    // byweekday / bynweekday\n    if (!isPresent(opts.byweekday)) {\n        opts.bynweekday = null;\n    }\n    else if (isNumber(opts.byweekday)) {\n        opts.byweekday = [opts.byweekday];\n        opts.bynweekday = null;\n    }\n    else if (isWeekdayStr(opts.byweekday)) {\n        opts.byweekday = [Weekday.fromStr(opts.byweekday).weekday];\n        opts.bynweekday = null;\n    }\n    else if (opts.byweekday instanceof Weekday) {\n        if (!opts.byweekday.n || opts.freq > RRule.MONTHLY) {\n            opts.byweekday = [opts.byweekday.weekday];\n            opts.bynweekday = null;\n        }\n        else {\n            opts.bynweekday = [[opts.byweekday.weekday, opts.byweekday.n]];\n            opts.byweekday = null;\n        }\n    }\n    else {\n        var byweekday = [];\n        var bynweekday = [];\n        for (var i = 0; i < opts.byweekday.length; i++) {\n            var wday = opts.byweekday[i];\n            if (isNumber(wday)) {\n                byweekday.push(wday);\n                continue;\n            }\n            else if (isWeekdayStr(wday)) {\n                byweekday.push(Weekday.fromStr(wday).weekday);\n                continue;\n            }\n            if (!wday.n || opts.freq > RRule.MONTHLY) {\n                byweekday.push(wday.weekday);\n            }\n            else {\n                bynweekday.push([wday.weekday, wday.n]);\n            }\n        }\n        opts.byweekday = notEmpty(byweekday) ? byweekday : null;\n        opts.bynweekday = notEmpty(bynweekday) ? bynweekday : null;\n    }\n    // byhour\n    if (!isPresent(opts.byhour)) {\n        opts.byhour = opts.freq < RRule.HOURLY ? [opts.dtstart.getUTCHours()] : null;\n    }\n    else if (isNumber(opts.byhour)) {\n        opts.byhour = [opts.byhour];\n    }\n    // byminute\n    if (!isPresent(opts.byminute)) {\n        opts.byminute =\n            opts.freq < RRule.MINUTELY ? [opts.dtstart.getUTCMinutes()] : null;\n    }\n    else if (isNumber(opts.byminute)) {\n        opts.byminute = [opts.byminute];\n    }\n    // bysecond\n    if (!isPresent(opts.bysecond)) {\n        opts.bysecond =\n            opts.freq < RRule.SECONDLY ? [opts.dtstart.getUTCSeconds()] : null;\n    }\n    else if (isNumber(opts.bysecond)) {\n        opts.bysecond = [opts.bysecond];\n    }\n    return { parsedOptions: opts };\n}\nexport function buildTimeset(opts) {\n    var millisecondModulo = opts.dtstart.getTime() % 1000;\n    if (!freqIsDailyOrGreater(opts.freq)) {\n        return [];\n    }\n    var timeset = [];\n    opts.byhour.forEach(function (hour) {\n        opts.byminute.forEach(function (minute) {\n            opts.bysecond.forEach(function (second) {\n                timeset.push(new Time(hour, minute, second, millisecondModulo));\n            });\n        });\n    });\n    return timeset;\n}\n//# sourceMappingURL=parseoptions.js.map","import { __assign } from \"tslib\";\nimport { Frequency } from './types';\nimport { Weekday } from './weekday';\nimport { untilStringToDate } from './dateutil';\nimport { Days } from './rrule';\nexport function parseString(rfcString) {\n    var options = rfcString\n        .split('\\n')\n        .map(parseLine)\n        .filter(function (x) { return x !== null; });\n    return __assign(__assign({}, options[0]), options[1]);\n}\nexport function parseDtstart(line) {\n    var options = {};\n    var dtstartWithZone = /DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\\s]+)/i.exec(line);\n    if (!dtstartWithZone) {\n        return options;\n    }\n    var tzid = dtstartWithZone[1], dtstart = dtstartWithZone[2];\n    if (tzid) {\n        options.tzid = tzid;\n    }\n    options.dtstart = untilStringToDate(dtstart);\n    return options;\n}\nfunction parseLine(rfcString) {\n    rfcString = rfcString.replace(/^\\s+|\\s+$/, '');\n    if (!rfcString.length)\n        return null;\n    var header = /^([A-Z]+?)[:;]/.exec(rfcString.toUpperCase());\n    if (!header) {\n        return parseRrule(rfcString);\n    }\n    var key = header[1];\n    switch (key.toUpperCase()) {\n        case 'RRULE':\n        case 'EXRULE':\n            return parseRrule(rfcString);\n        case 'DTSTART':\n            return parseDtstart(rfcString);\n        default:\n            throw new Error(\"Unsupported RFC prop \".concat(key, \" in \").concat(rfcString));\n    }\n}\nfunction parseRrule(line) {\n    var strippedLine = line.replace(/^RRULE:/i, '');\n    var options = parseDtstart(strippedLine);\n    var attrs = line.replace(/^(?:RRULE|EXRULE):/i, '').split(';');\n    attrs.forEach(function (attr) {\n        var _a = attr.split('='), key = _a[0], value = _a[1];\n        switch (key.toUpperCase()) {\n            case 'FREQ':\n                options.freq = Frequency[value.toUpperCase()];\n                break;\n            case 'WKST':\n                options.wkst = Days[value.toUpperCase()];\n                break;\n            case 'COUNT':\n            case 'INTERVAL':\n            case 'BYSETPOS':\n            case 'BYMONTH':\n            case 'BYMONTHDAY':\n            case 'BYYEARDAY':\n            case 'BYWEEKNO':\n            case 'BYHOUR':\n            case 'BYMINUTE':\n            case 'BYSECOND':\n                var num = parseNumber(value);\n                var optionKey = key.toLowerCase();\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                options[optionKey] = num;\n                break;\n            case 'BYWEEKDAY':\n            case 'BYDAY':\n                options.byweekday = parseWeekday(value);\n                break;\n            case 'DTSTART':\n            case 'TZID':\n                // for backwards compatibility\n                var dtstart = parseDtstart(line);\n                options.tzid = dtstart.tzid;\n                options.dtstart = dtstart.dtstart;\n                break;\n            case 'UNTIL':\n                options.until = untilStringToDate(value);\n                break;\n            case 'BYEASTER':\n                options.byeaster = Number(value);\n                break;\n            default:\n                throw new Error(\"Unknown RRULE property '\" + key + \"'\");\n        }\n    });\n    return options;\n}\nfunction parseNumber(value) {\n    if (value.indexOf(',') !== -1) {\n        var values = value.split(',');\n        return values.map(parseIndividualNumber);\n    }\n    return parseIndividualNumber(value);\n}\nfunction parseIndividualNumber(value) {\n    if (/^[+-]?\\d+$/.test(value)) {\n        return Number(value);\n    }\n    return value;\n}\nfunction parseWeekday(value) {\n    var days = value.split(',');\n    return days.map(function (day) {\n        if (day.length === 2) {\n            // MO, TU, ...\n            return Days[day]; // wday instanceof Weekday\n        }\n        // -1MO, +3FR, 1SO, 13TU ...\n        var parts = day.match(/^([+-]?\\d{1,2})([A-Z]{2})$/);\n        if (!parts || parts.length < 3) {\n            throw new SyntaxError(\"Invalid weekday string: \".concat(day));\n        }\n        var n = Number(parts[1]);\n        var wdaypart = parts[2];\n        var wday = Days[wdaypart].weekday;\n        return new Weekday(wday, n);\n    });\n}\n//# sourceMappingURL=parsestring.js.map","import { dateInTimeZone, timeToUntilString } from './dateutil';\nvar DateWithZone = /** @class */ (function () {\n    function DateWithZone(date, tzid) {\n        if (isNaN(date.getTime())) {\n            throw new RangeError('Invalid date passed to DateWithZone');\n        }\n        this.date = date;\n        this.tzid = tzid;\n    }\n    Object.defineProperty(DateWithZone.prototype, \"isUTC\", {\n        get: function () {\n            return !this.tzid || this.tzid.toUpperCase() === 'UTC';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DateWithZone.prototype.toString = function () {\n        var datestr = timeToUntilString(this.date.getTime(), this.isUTC);\n        if (!this.isUTC) {\n            return \";TZID=\".concat(this.tzid, \":\").concat(datestr);\n        }\n        return \":\".concat(datestr);\n    };\n    DateWithZone.prototype.getTime = function () {\n        return this.date.getTime();\n    };\n    DateWithZone.prototype.rezonedDate = function () {\n        if (this.isUTC) {\n            return this.date;\n        }\n        return dateInTimeZone(this.date, this.tzid);\n    };\n    return DateWithZone;\n}());\nexport { DateWithZone };\n//# sourceMappingURL=datewithzone.js.map","import { RRule, DEFAULT_OPTIONS } from './rrule';\nimport { includes, isPresent, isArray, isNumber, toArray } from './helpers';\nimport { Weekday } from './weekday';\nimport { timeToUntilString } from './dateutil';\nimport { DateWithZone } from './datewithzone';\nexport function optionsToString(options) {\n    var rrule = [];\n    var dtstart = '';\n    var keys = Object.keys(options);\n    var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n    for (var i = 0; i < keys.length; i++) {\n        if (keys[i] === 'tzid')\n            continue;\n        if (!includes(defaultKeys, keys[i]))\n            continue;\n        var key = keys[i].toUpperCase();\n        var value = options[keys[i]];\n        var outValue = '';\n        if (!isPresent(value) || (isArray(value) && !value.length))\n            continue;\n        switch (key) {\n            case 'FREQ':\n                outValue = RRule.FREQUENCIES[options.freq];\n                break;\n            case 'WKST':\n                if (isNumber(value)) {\n                    outValue = new Weekday(value).toString();\n                }\n                else {\n                    outValue = value.toString();\n                }\n                break;\n            case 'BYWEEKDAY':\n                /*\n                  NOTE: BYWEEKDAY is a special case.\n                  RRule() deconstructs the rule.options.byweekday array\n                  into an array of Weekday arguments.\n                  On the other hand, rule.origOptions is an array of Weekdays.\n                  We need to handle both cases here.\n                  It might be worth change RRule to keep the Weekdays.\n        \n                  Also, BYWEEKDAY (used by RRule) vs. BYDAY (RFC)\n        \n                  */\n                key = 'BYDAY';\n                outValue = toArray(value)\n                    .map(function (wday) {\n                    if (wday instanceof Weekday) {\n                        return wday;\n                    }\n                    if (isArray(wday)) {\n                        return new Weekday(wday[0], wday[1]);\n                    }\n                    return new Weekday(wday);\n                })\n                    .toString();\n                break;\n            case 'DTSTART':\n                dtstart = buildDtstart(value, options.tzid);\n                break;\n            case 'UNTIL':\n                outValue = timeToUntilString(value, !options.tzid);\n                break;\n            default:\n                if (isArray(value)) {\n                    var strValues = [];\n                    for (var j = 0; j < value.length; j++) {\n                        strValues[j] = String(value[j]);\n                    }\n                    outValue = strValues.toString();\n                }\n                else {\n                    outValue = String(value);\n                }\n        }\n        if (outValue) {\n            rrule.push([key, outValue]);\n        }\n    }\n    var rules = rrule\n        .map(function (_a) {\n        var key = _a[0], value = _a[1];\n        return \"\".concat(key, \"=\").concat(value.toString());\n    })\n        .join(';');\n    var ruleString = '';\n    if (rules !== '') {\n        ruleString = \"RRULE:\".concat(rules);\n    }\n    return [dtstart, ruleString].filter(function (x) { return !!x; }).join('\\n');\n}\nfunction buildDtstart(dtstart, tzid) {\n    if (!dtstart) {\n        return '';\n    }\n    return 'DTSTART' + new DateWithZone(new Date(dtstart), tzid).toString();\n}\n//# sourceMappingURL=optionstostring.js.map","import IterResult from './iterresult';\nimport { clone, cloneDates } from './dateutil';\nimport { isArray } from './helpers';\nfunction argsMatch(left, right) {\n    if (Array.isArray(left)) {\n        if (!Array.isArray(right))\n            return false;\n        if (left.length !== right.length)\n            return false;\n        return left.every(function (date, i) { return date.getTime() === right[i].getTime(); });\n    }\n    if (left instanceof Date) {\n        return right instanceof Date && left.getTime() === right.getTime();\n    }\n    return left === right;\n}\nvar Cache = /** @class */ (function () {\n    function Cache() {\n        this.all = false;\n        this.before = [];\n        this.after = [];\n        this.between = [];\n    }\n    /**\n     * @param {String} what - all/before/after/between\n     * @param {Array,Date} value - an array of dates, one date, or null\n     * @param {Object?} args - _iter arguments\n     */\n    Cache.prototype._cacheAdd = function (what, value, args) {\n        if (value) {\n            value = value instanceof Date ? clone(value) : cloneDates(value);\n        }\n        if (what === 'all') {\n            this.all = value;\n        }\n        else {\n            args._value = value;\n            this[what].push(args);\n        }\n    };\n    /**\n     * @return false - not in the cache\n     * @return null  - cached, but zero occurrences (before/after)\n     * @return Date  - cached (before/after)\n     * @return []    - cached, but zero occurrences (all/between)\n     * @return [Date1, DateN] - cached (all/between)\n     */\n    Cache.prototype._cacheGet = function (what, args) {\n        var cached = false;\n        var argsKeys = args ? Object.keys(args) : [];\n        var findCacheDiff = function (item) {\n            for (var i = 0; i < argsKeys.length; i++) {\n                var key = argsKeys[i];\n                if (!argsMatch(args[key], item[key])) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        var cachedObject = this[what];\n        if (what === 'all') {\n            cached = this.all;\n        }\n        else if (isArray(cachedObject)) {\n            // Let's see whether we've already called the\n            // 'what' method with the same 'args'\n            for (var i = 0; i < cachedObject.length; i++) {\n                var item = cachedObject[i];\n                if (argsKeys.length && findCacheDiff(item))\n                    continue;\n                cached = item._value;\n                break;\n            }\n        }\n        if (!cached && this.all) {\n            // Not in the cache, but we already know all the occurrences,\n            // so we can find the correct dates from the cached ones.\n            var iterResult = new IterResult(what, args);\n            for (var i = 0; i < this.all.length; i++) {\n                if (!iterResult.accept(this.all[i]))\n                    break;\n            }\n            cached = iterResult.getValue();\n            this._cacheAdd(what, cached, args);\n        }\n        return isArray(cached)\n            ? cloneDates(cached)\n            : cached instanceof Date\n                ? clone(cached)\n                : cached;\n    };\n    return Cache;\n}());\nexport { Cache };\n//# sourceMappingURL=cache.js.map","import { __spreadArray } from \"tslib\";\nimport { range, repeat } from './helpers';\n// =============================================================================\n// Date masks\n// =============================================================================\n// Every mask is 7 days longer to handle cross-year weekly periods.\nvar M365MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], repeat(1, 31), true), repeat(2, 28), true), repeat(3, 31), true), repeat(4, 30), true), repeat(5, 31), true), repeat(6, 30), true), repeat(7, 31), true), repeat(8, 31), true), repeat(9, 30), true), repeat(10, 31), true), repeat(11, 30), true), repeat(12, 31), true), repeat(1, 7), true);\nvar M366MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], repeat(1, 31), true), repeat(2, 29), true), repeat(3, 31), true), repeat(4, 30), true), repeat(5, 31), true), repeat(6, 30), true), repeat(7, 31), true), repeat(8, 31), true), repeat(9, 30), true), repeat(10, 31), true), repeat(11, 30), true), repeat(12, 31), true), repeat(1, 7), true);\nvar M28 = range(1, 29);\nvar M29 = range(1, 30);\nvar M30 = range(1, 31);\nvar M31 = range(1, 32);\nvar MDAY366MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], M31, true), M29, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31.slice(0, 7), true);\nvar MDAY365MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], M31, true), M28, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31, true), M30, true), M31, true), M30, true), M31, true), M31.slice(0, 7), true);\nvar NM28 = range(-28, 0);\nvar NM29 = range(-29, 0);\nvar NM30 = range(-30, 0);\nvar NM31 = range(-31, 0);\nvar NMDAY366MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], NM31, true), NM29, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31.slice(0, 7), true);\nvar NMDAY365MASK = __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], NM31, true), NM28, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31, true), NM30, true), NM31, true), NM30, true), NM31, true), NM31.slice(0, 7), true);\nvar M366RANGE = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366];\nvar M365RANGE = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365];\nvar WDAYMASK = (function () {\n    var wdaymask = [];\n    for (var i = 0; i < 55; i++)\n        wdaymask = wdaymask.concat(range(7));\n    return wdaymask;\n})();\nexport { WDAYMASK, M365MASK, M365RANGE, M366MASK, M366RANGE, MDAY365MASK, MDAY366MASK, NMDAY365MASK, NMDAY366MASK, };\n//# sourceMappingURL=masks.js.map","import { __assign } from \"tslib\";\nimport { datetime, getWeekday, isLeapYear, toOrdinal } from '../dateutil';\nimport { empty, repeat, pymod, includes } from '../helpers';\nimport { M365MASK, MDAY365MASK, NMDAY365MASK, WDAYMASK, M365RANGE, M366MASK, MDAY366MASK, NMDAY366MASK, M366RANGE, } from '../masks';\nexport function rebuildYear(year, options) {\n    var firstyday = datetime(year, 1, 1);\n    var yearlen = isLeapYear(year) ? 366 : 365;\n    var nextyearlen = isLeapYear(year + 1) ? 366 : 365;\n    var yearordinal = toOrdinal(firstyday);\n    var yearweekday = getWeekday(firstyday);\n    var result = __assign(__assign({ yearlen: yearlen, nextyearlen: nextyearlen, yearordinal: yearordinal, yearweekday: yearweekday }, baseYearMasks(year)), { wnomask: null });\n    if (empty(options.byweekno)) {\n        return result;\n    }\n    result.wnomask = repeat(0, yearlen + 7);\n    var firstwkst;\n    var wyearlen;\n    var no1wkst = (firstwkst = pymod(7 - yearweekday + options.wkst, 7));\n    if (no1wkst >= 4) {\n        no1wkst = 0;\n        // Number of days in the year, plus the days we got\n        // from last year.\n        wyearlen = result.yearlen + pymod(yearweekday - options.wkst, 7);\n    }\n    else {\n        // Number of days in the year, minus the days we\n        // left in last year.\n        wyearlen = yearlen - no1wkst;\n    }\n    var div = Math.floor(wyearlen / 7);\n    var mod = pymod(wyearlen, 7);\n    var numweeks = Math.floor(div + mod / 4);\n    for (var j = 0; j < options.byweekno.length; j++) {\n        var n = options.byweekno[j];\n        if (n < 0) {\n            n += numweeks + 1;\n        }\n        if (!(n > 0 && n <= numweeks)) {\n            continue;\n        }\n        var i = void 0;\n        if (n > 1) {\n            i = no1wkst + (n - 1) * 7;\n            if (no1wkst !== firstwkst) {\n                i -= 7 - firstwkst;\n            }\n        }\n        else {\n            i = no1wkst;\n        }\n        for (var k = 0; k < 7; k++) {\n            result.wnomask[i] = 1;\n            i++;\n            if (result.wdaymask[i] === options.wkst)\n                break;\n        }\n    }\n    if (includes(options.byweekno, 1)) {\n        // Check week number 1 of next year as well\n        // orig-TODO : Check -numweeks for next year.\n        var i = no1wkst + numweeks * 7;\n        if (no1wkst !== firstwkst)\n            i -= 7 - firstwkst;\n        if (i < yearlen) {\n            // If week starts in next year, we\n            // don't care about it.\n            for (var j = 0; j < 7; j++) {\n                result.wnomask[i] = 1;\n                i += 1;\n                if (result.wdaymask[i] === options.wkst)\n                    break;\n            }\n        }\n    }\n    if (no1wkst) {\n        // Check last week number of last year as\n        // well. If no1wkst is 0, either the year\n        // started on week start, or week number 1\n        // got days from last year, so there are no\n        // days from last year's last week number in\n        // this year.\n        var lnumweeks = void 0;\n        if (!includes(options.byweekno, -1)) {\n            var lyearweekday = getWeekday(datetime(year - 1, 1, 1));\n            var lno1wkst = pymod(7 - lyearweekday.valueOf() + options.wkst, 7);\n            var lyearlen = isLeapYear(year - 1) ? 366 : 365;\n            var weekst = void 0;\n            if (lno1wkst >= 4) {\n                lno1wkst = 0;\n                weekst = lyearlen + pymod(lyearweekday - options.wkst, 7);\n            }\n            else {\n                weekst = yearlen - no1wkst;\n            }\n            lnumweeks = Math.floor(52 + pymod(weekst, 7) / 4);\n        }\n        else {\n            lnumweeks = -1;\n        }\n        if (includes(options.byweekno, lnumweeks)) {\n            for (var i = 0; i < no1wkst; i++)\n                result.wnomask[i] = 1;\n        }\n    }\n    return result;\n}\nfunction baseYearMasks(year) {\n    var yearlen = isLeapYear(year) ? 366 : 365;\n    var firstyday = datetime(year, 1, 1);\n    var wday = getWeekday(firstyday);\n    if (yearlen === 365) {\n        return {\n            mmask: M365MASK,\n            mdaymask: MDAY365MASK,\n            nmdaymask: NMDAY365MASK,\n            wdaymask: WDAYMASK.slice(wday),\n            mrange: M365RANGE,\n        };\n    }\n    return {\n        mmask: M366MASK,\n        mdaymask: MDAY366MASK,\n        nmdaymask: NMDAY366MASK,\n        wdaymask: WDAYMASK.slice(wday),\n        mrange: M366RANGE,\n    };\n}\n//# sourceMappingURL=yearinfo.js.map","import { notEmpty, repeat, range, isPresent } from '../helpers';\nimport { Frequency } from '../types';\nimport { rebuildYear } from './yearinfo';\nimport { rebuildMonth } from './monthinfo';\nimport { easter } from './easter';\nimport { Time } from '../datetime';\nimport { datetime, sort, toOrdinal } from '../dateutil';\n// =============================================================================\n// Iterinfo\n// =============================================================================\nvar Iterinfo = /** @class */ (function () {\n    // eslint-disable-next-line no-empty-function\n    function Iterinfo(options) {\n        this.options = options;\n    }\n    Iterinfo.prototype.rebuild = function (year, month) {\n        var options = this.options;\n        if (year !== this.lastyear) {\n            this.yearinfo = rebuildYear(year, options);\n        }\n        if (notEmpty(options.bynweekday) &&\n            (month !== this.lastmonth || year !== this.lastyear)) {\n            var _a = this.yearinfo, yearlen = _a.yearlen, mrange = _a.mrange, wdaymask = _a.wdaymask;\n            this.monthinfo = rebuildMonth(year, month, yearlen, mrange, wdaymask, options);\n        }\n        if (isPresent(options.byeaster)) {\n            this.eastermask = easter(year, options.byeaster);\n        }\n    };\n    Object.defineProperty(Iterinfo.prototype, \"lastyear\", {\n        get: function () {\n            return this.monthinfo ? this.monthinfo.lastyear : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"lastmonth\", {\n        get: function () {\n            return this.monthinfo ? this.monthinfo.lastmonth : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"yearlen\", {\n        get: function () {\n            return this.yearinfo.yearlen;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"yearordinal\", {\n        get: function () {\n            return this.yearinfo.yearordinal;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"mrange\", {\n        get: function () {\n            return this.yearinfo.mrange;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"wdaymask\", {\n        get: function () {\n            return this.yearinfo.wdaymask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"mmask\", {\n        get: function () {\n            return this.yearinfo.mmask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"wnomask\", {\n        get: function () {\n            return this.yearinfo.wnomask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"nwdaymask\", {\n        get: function () {\n            return this.monthinfo ? this.monthinfo.nwdaymask : [];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"nextyearlen\", {\n        get: function () {\n            return this.yearinfo.nextyearlen;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"mdaymask\", {\n        get: function () {\n            return this.yearinfo.mdaymask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Iterinfo.prototype, \"nmdaymask\", {\n        get: function () {\n            return this.yearinfo.nmdaymask;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Iterinfo.prototype.ydayset = function () {\n        return [range(this.yearlen), 0, this.yearlen];\n    };\n    Iterinfo.prototype.mdayset = function (_, month) {\n        var start = this.mrange[month - 1];\n        var end = this.mrange[month];\n        var set = repeat(null, this.yearlen);\n        for (var i = start; i < end; i++)\n            set[i] = i;\n        return [set, start, end];\n    };\n    Iterinfo.prototype.wdayset = function (year, month, day) {\n        // We need to handle cross-year weeks here.\n        var set = repeat(null, this.yearlen + 7);\n        var i = toOrdinal(datetime(year, month, day)) - this.yearordinal;\n        var start = i;\n        for (var j = 0; j < 7; j++) {\n            set[i] = i;\n            ++i;\n            if (this.wdaymask[i] === this.options.wkst)\n                break;\n        }\n        return [set, start, i];\n    };\n    Iterinfo.prototype.ddayset = function (year, month, day) {\n        var set = repeat(null, this.yearlen);\n        var i = toOrdinal(datetime(year, month, day)) - this.yearordinal;\n        set[i] = i;\n        return [set, i, i + 1];\n    };\n    Iterinfo.prototype.htimeset = function (hour, _, second, millisecond) {\n        var _this = this;\n        var set = [];\n        this.options.byminute.forEach(function (minute) {\n            set = set.concat(_this.mtimeset(hour, minute, second, millisecond));\n        });\n        sort(set);\n        return set;\n    };\n    Iterinfo.prototype.mtimeset = function (hour, minute, _, millisecond) {\n        var set = this.options.bysecond.map(function (second) { return new Time(hour, minute, second, millisecond); });\n        sort(set);\n        return set;\n    };\n    Iterinfo.prototype.stimeset = function (hour, minute, second, millisecond) {\n        return [new Time(hour, minute, second, millisecond)];\n    };\n    Iterinfo.prototype.getdayset = function (freq) {\n        switch (freq) {\n            case Frequency.YEARLY:\n                return this.ydayset.bind(this);\n            case Frequency.MONTHLY:\n                return this.mdayset.bind(this);\n            case Frequency.WEEKLY:\n                return this.wdayset.bind(this);\n            case Frequency.DAILY:\n                return this.ddayset.bind(this);\n            default:\n                return this.ddayset.bind(this);\n        }\n    };\n    Iterinfo.prototype.gettimeset = function (freq) {\n        switch (freq) {\n            case Frequency.HOURLY:\n                return this.htimeset.bind(this);\n            case Frequency.MINUTELY:\n                return this.mtimeset.bind(this);\n            case Frequency.SECONDLY:\n                return this.stimeset.bind(this);\n        }\n    };\n    return Iterinfo;\n}());\nexport default Iterinfo;\n//# sourceMappingURL=index.js.map","import { RRule } from '../rrule';\nimport { empty, repeat, pymod } from '../helpers';\nexport function rebuildMonth(year, month, yearlen, mrange, wdaymask, options) {\n    var result = {\n        lastyear: year,\n        lastmonth: month,\n        nwdaymask: [],\n    };\n    var ranges = [];\n    if (options.freq === RRule.YEARLY) {\n        if (empty(options.bymonth)) {\n            ranges = [[0, yearlen]];\n        }\n        else {\n            for (var j = 0; j < options.bymonth.length; j++) {\n                month = options.bymonth[j];\n                ranges.push(mrange.slice(month - 1, month + 1));\n            }\n        }\n    }\n    else if (options.freq === RRule.MONTHLY) {\n        ranges = [mrange.slice(month - 1, month + 1)];\n    }\n    if (empty(ranges)) {\n        return result;\n    }\n    // Weekly frequency won't get here, so we may not\n    // care about cross-year weekly periods.\n    result.nwdaymask = repeat(0, yearlen);\n    for (var j = 0; j < ranges.length; j++) {\n        var rang = ranges[j];\n        var first = rang[0];\n        var last = rang[1] - 1;\n        for (var k = 0; k < options.bynweekday.length; k++) {\n            var i = void 0;\n            var _a = options.bynweekday[k], wday = _a[0], n = _a[1];\n            if (n < 0) {\n                i = last + (n + 1) * 7;\n                i -= pymod(wdaymask[i] - wday, 7);\n            }\n            else {\n                i = first + (n - 1) * 7;\n                i += pymod(7 - wdaymask[i] + wday, 7);\n            }\n            if (first <= i && i <= last)\n                result.nwdaymask[i] = 1;\n        }\n    }\n    return result;\n}\n//# sourceMappingURL=monthinfo.js.map","export function easter(y, offset) {\n    if (offset === void 0) { offset = 0; }\n    var a = y % 19;\n    var b = Math.floor(y / 100);\n    var c = y % 100;\n    var d = Math.floor(b / 4);\n    var e = b % 4;\n    var f = Math.floor((b + 8) / 25);\n    var g = Math.floor((b - f + 1) / 3);\n    var h = Math.floor(19 * a + b - d - g + 15) % 30;\n    var i = Math.floor(c / 4);\n    var k = c % 4;\n    var l = Math.floor(32 + 2 * e + 2 * i - h - k) % 7;\n    var m = Math.floor((a + 11 * h + 22 * l) / 451);\n    var month = Math.floor((h + l - 7 * m + 114) / 31);\n    var day = ((h + l - 7 * m + 114) % 31) + 1;\n    var date = Date.UTC(y, month - 1, day + offset);\n    var yearStart = Date.UTC(y, 0, 1);\n    return [Math.ceil((date - yearStart) / (1000 * 60 * 60 * 24))];\n}\n//# sourceMappingURL=easter.js.map","import { combine, fromOrdinal, sort } from '../dateutil';\nimport { pymod, isPresent, includes } from '../helpers';\nexport function buildPoslist(bysetpos, timeset, start, end, ii, dayset) {\n    var poslist = [];\n    for (var j = 0; j < bysetpos.length; j++) {\n        var daypos = void 0;\n        var timepos = void 0;\n        var pos = bysetpos[j];\n        if (pos < 0) {\n            daypos = Math.floor(pos / timeset.length);\n            timepos = pymod(pos, timeset.length);\n        }\n        else {\n            daypos = Math.floor((pos - 1) / timeset.length);\n            timepos = pymod(pos - 1, timeset.length);\n        }\n        var tmp = [];\n        for (var k = start; k < end; k++) {\n            var val = dayset[k];\n            if (!isPresent(val))\n                continue;\n            tmp.push(val);\n        }\n        var i = void 0;\n        if (daypos < 0) {\n            i = tmp.slice(daypos)[0];\n        }\n        else {\n            i = tmp[daypos];\n        }\n        var time = timeset[timepos];\n        var date = fromOrdinal(ii.yearordinal + i);\n        var res = combine(date, time);\n        // XXX: can this ever be in the array?\n        // - compare the actual date instead?\n        if (!includes(poslist, res))\n            poslist.push(res);\n    }\n    sort(poslist);\n    return poslist;\n}\n//# sourceMappingURL=poslist.js.map","import { freqIsDailyOrGreater } from '../types';\nimport { combine, fromOrdinal, MAXYEAR } from '../dateutil';\nimport Iterinfo from '../iterinfo/index';\nimport { RRule } from '../rrule';\nimport { buildTimeset } from '../parseoptions';\nimport { notEmpty, includes, isPresent } from '../helpers';\nimport { DateWithZone } from '../datewithzone';\nimport { buildPoslist } from './poslist';\nimport { DateTime } from '../datetime';\nexport function iter(iterResult, options) {\n    var dtstart = options.dtstart, freq = options.freq, interval = options.interval, until = options.until, bysetpos = options.bysetpos;\n    var count = options.count;\n    if (count === 0 || interval === 0) {\n        return emitResult(iterResult);\n    }\n    var counterDate = DateTime.fromDate(dtstart);\n    var ii = new Iterinfo(options);\n    ii.rebuild(counterDate.year, counterDate.month);\n    var timeset = makeTimeset(ii, counterDate, options);\n    for (;;) {\n        var _a = ii.getdayset(freq)(counterDate.year, counterDate.month, counterDate.day), dayset = _a[0], start = _a[1], end = _a[2];\n        var filtered = removeFilteredDays(dayset, start, end, ii, options);\n        if (notEmpty(bysetpos)) {\n            var poslist = buildPoslist(bysetpos, timeset, start, end, ii, dayset);\n            for (var j = 0; j < poslist.length; j++) {\n                var res = poslist[j];\n                if (until && res > until) {\n                    return emitResult(iterResult);\n                }\n                if (res >= dtstart) {\n                    var rezonedDate = rezoneIfNeeded(res, options);\n                    if (!iterResult.accept(rezonedDate)) {\n                        return emitResult(iterResult);\n                    }\n                    if (count) {\n                        --count;\n                        if (!count) {\n                            return emitResult(iterResult);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            for (var j = start; j < end; j++) {\n                var currentDay = dayset[j];\n                if (!isPresent(currentDay)) {\n                    continue;\n                }\n                var date = fromOrdinal(ii.yearordinal + currentDay);\n                for (var k = 0; k < timeset.length; k++) {\n                    var time = timeset[k];\n                    var res = combine(date, time);\n                    if (until && res > until) {\n                        return emitResult(iterResult);\n                    }\n                    if (res >= dtstart) {\n                        var rezonedDate = rezoneIfNeeded(res, options);\n                        if (!iterResult.accept(rezonedDate)) {\n                            return emitResult(iterResult);\n                        }\n                        if (count) {\n                            --count;\n                            if (!count) {\n                                return emitResult(iterResult);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.interval === 0) {\n            return emitResult(iterResult);\n        }\n        // Handle frequency and interval\n        counterDate.add(options, filtered);\n        if (counterDate.year > MAXYEAR) {\n            return emitResult(iterResult);\n        }\n        if (!freqIsDailyOrGreater(freq)) {\n            timeset = ii.gettimeset(freq)(counterDate.hour, counterDate.minute, counterDate.second, 0);\n        }\n        ii.rebuild(counterDate.year, counterDate.month);\n    }\n}\nfunction isFiltered(ii, currentDay, options) {\n    var bymonth = options.bymonth, byweekno = options.byweekno, byweekday = options.byweekday, byeaster = options.byeaster, bymonthday = options.bymonthday, bynmonthday = options.bynmonthday, byyearday = options.byyearday;\n    return ((notEmpty(bymonth) && !includes(bymonth, ii.mmask[currentDay])) ||\n        (notEmpty(byweekno) && !ii.wnomask[currentDay]) ||\n        (notEmpty(byweekday) && !includes(byweekday, ii.wdaymask[currentDay])) ||\n        (notEmpty(ii.nwdaymask) && !ii.nwdaymask[currentDay]) ||\n        (byeaster !== null && !includes(ii.eastermask, currentDay)) ||\n        ((notEmpty(bymonthday) || notEmpty(bynmonthday)) &&\n            !includes(bymonthday, ii.mdaymask[currentDay]) &&\n            !includes(bynmonthday, ii.nmdaymask[currentDay])) ||\n        (notEmpty(byyearday) &&\n            ((currentDay < ii.yearlen &&\n                !includes(byyearday, currentDay + 1) &&\n                !includes(byyearday, -ii.yearlen + currentDay)) ||\n                (currentDay >= ii.yearlen &&\n                    !includes(byyearday, currentDay + 1 - ii.yearlen) &&\n                    !includes(byyearday, -ii.nextyearlen + currentDay - ii.yearlen)))));\n}\nfunction rezoneIfNeeded(date, options) {\n    return new DateWithZone(date, options.tzid).rezonedDate();\n}\nfunction emitResult(iterResult) {\n    return iterResult.getValue();\n}\nfunction removeFilteredDays(dayset, start, end, ii, options) {\n    var filtered = false;\n    for (var dayCounter = start; dayCounter < end; dayCounter++) {\n        var currentDay = dayset[dayCounter];\n        filtered = isFiltered(ii, currentDay, options);\n        if (filtered)\n            dayset[currentDay] = null;\n    }\n    return filtered;\n}\nfunction makeTimeset(ii, counterDate, options) {\n    var freq = options.freq, byhour = options.byhour, byminute = options.byminute, bysecond = options.bysecond;\n    if (freqIsDailyOrGreater(freq)) {\n        return buildTimeset(options);\n    }\n    if ((freq >= RRule.HOURLY &&\n        notEmpty(byhour) &&\n        !includes(byhour, counterDate.hour)) ||\n        (freq >= RRule.MINUTELY &&\n            notEmpty(byminute) &&\n            !includes(byminute, counterDate.minute)) ||\n        (freq >= RRule.SECONDLY &&\n            notEmpty(bysecond) &&\n            !includes(bysecond, counterDate.second))) {\n        return [];\n    }\n    return ii.gettimeset(freq)(counterDate.hour, counterDate.minute, counterDate.second, counterDate.millisecond);\n}\n//# sourceMappingURL=index.js.map","import { isValidDate } from './dateutil';\nimport IterResult from './iterresult';\nimport CallbackIterResult from './callbackiterresult';\nimport { fromText, parseText, toText, isFullyConvertible } from './nlp/index';\nimport { Frequency, } from './types';\nimport { parseOptions, initializeOptions } from './parseoptions';\nimport { parseString } from './parsestring';\nimport { optionsToString } from './optionstostring';\nimport { Cache } from './cache';\nimport { Weekday } from './weekday';\nimport { iter } from './iter/index';\n// =============================================================================\n// RRule\n// =============================================================================\nexport var Days = {\n    MO: new Weekday(0),\n    TU: new Weekday(1),\n    WE: new Weekday(2),\n    TH: new Weekday(3),\n    FR: new Weekday(4),\n    SA: new Weekday(5),\n    SU: new Weekday(6),\n};\nexport var DEFAULT_OPTIONS = {\n    freq: Frequency.YEARLY,\n    dtstart: null,\n    interval: 1,\n    wkst: Days.MO,\n    count: null,\n    until: null,\n    tzid: null,\n    bysetpos: null,\n    bymonth: null,\n    bymonthday: null,\n    bynmonthday: null,\n    byyearday: null,\n    byweekno: null,\n    byweekday: null,\n    bynweekday: null,\n    byhour: null,\n    byminute: null,\n    bysecond: null,\n    byeaster: null,\n};\nexport var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n/**\n *\n * @param {Options?} options - see <http://labix.org/python-dateutil/#head-cf004ee9a75592797e076752b2a889c10f445418>\n * - The only required option is `freq`, one of RRule.YEARLY, RRule.MONTHLY, ...\n * @constructor\n */\nvar RRule = /** @class */ (function () {\n    function RRule(options, noCache) {\n        if (options === void 0) { options = {}; }\n        if (noCache === void 0) { noCache = false; }\n        // RFC string\n        this._cache = noCache ? null : new Cache();\n        // used by toString()\n        this.origOptions = initializeOptions(options);\n        var parsedOptions = parseOptions(options).parsedOptions;\n        this.options = parsedOptions;\n    }\n    RRule.parseText = function (text, language) {\n        return parseText(text, language);\n    };\n    RRule.fromText = function (text, language) {\n        return fromText(text, language);\n    };\n    RRule.fromString = function (str) {\n        return new RRule(RRule.parseString(str) || undefined);\n    };\n    RRule.prototype._iter = function (iterResult) {\n        return iter(iterResult, this.options);\n    };\n    RRule.prototype._cacheGet = function (what, args) {\n        if (!this._cache)\n            return false;\n        return this._cache._cacheGet(what, args);\n    };\n    RRule.prototype._cacheAdd = function (what, value, args) {\n        if (!this._cache)\n            return;\n        return this._cache._cacheAdd(what, value, args);\n    };\n    /**\n     * @param {Function} iterator - optional function that will be called\n     * on each date that is added. It can return false\n     * to stop the iteration.\n     * @return Array containing all recurrences.\n     */\n    RRule.prototype.all = function (iterator) {\n        if (iterator) {\n            return this._iter(new CallbackIterResult('all', {}, iterator));\n        }\n        var result = this._cacheGet('all');\n        if (result === false) {\n            result = this._iter(new IterResult('all', {}));\n            this._cacheAdd('all', result);\n        }\n        return result;\n    };\n    /**\n     * Returns all the occurrences of the rrule between after and before.\n     * The inc keyword defines what happens if after and/or before are\n     * themselves occurrences. With inc == True, they will be included in the\n     * list, if they are found in the recurrence set.\n     *\n     * @return Array\n     */\n    RRule.prototype.between = function (after, before, inc, iterator) {\n        if (inc === void 0) { inc = false; }\n        if (!isValidDate(after) || !isValidDate(before)) {\n            throw new Error('Invalid date passed in to RRule.between');\n        }\n        var args = {\n            before: before,\n            after: after,\n            inc: inc,\n        };\n        if (iterator) {\n            return this._iter(new CallbackIterResult('between', args, iterator));\n        }\n        var result = this._cacheGet('between', args);\n        if (result === false) {\n            result = this._iter(new IterResult('between', args));\n            this._cacheAdd('between', result, args);\n        }\n        return result;\n    };\n    /**\n     * Returns the last recurrence before the given datetime instance.\n     * The inc keyword defines what happens if dt is an occurrence.\n     * With inc == True, if dt itself is an occurrence, it will be returned.\n     *\n     * @return Date or null\n     */\n    RRule.prototype.before = function (dt, inc) {\n        if (inc === void 0) { inc = false; }\n        if (!isValidDate(dt)) {\n            throw new Error('Invalid date passed in to RRule.before');\n        }\n        var args = { dt: dt, inc: inc };\n        var result = this._cacheGet('before', args);\n        if (result === false) {\n            result = this._iter(new IterResult('before', args));\n            this._cacheAdd('before', result, args);\n        }\n        return result;\n    };\n    /**\n     * Returns the first recurrence after the given datetime instance.\n     * The inc keyword defines what happens if dt is an occurrence.\n     * With inc == True, if dt itself is an occurrence, it will be returned.\n     *\n     * @return Date or null\n     */\n    RRule.prototype.after = function (dt, inc) {\n        if (inc === void 0) { inc = false; }\n        if (!isValidDate(dt)) {\n            throw new Error('Invalid date passed in to RRule.after');\n        }\n        var args = { dt: dt, inc: inc };\n        var result = this._cacheGet('after', args);\n        if (result === false) {\n            result = this._iter(new IterResult('after', args));\n            this._cacheAdd('after', result, args);\n        }\n        return result;\n    };\n    /**\n     * Returns the number of recurrences in this set. It will have go trough\n     * the whole recurrence, if this hasn't been done before.\n     */\n    RRule.prototype.count = function () {\n        return this.all().length;\n    };\n    /**\n     * Converts the rrule into its string representation\n     *\n     * @see <http://www.ietf.org/rfc/rfc2445.txt>\n     * @return String\n     */\n    RRule.prototype.toString = function () {\n        return optionsToString(this.origOptions);\n    };\n    /**\n     * Will convert all rules described in nlp:ToText\n     * to text.\n     */\n    RRule.prototype.toText = function (gettext, language, dateFormatter) {\n        return toText(this, gettext, language, dateFormatter);\n    };\n    RRule.prototype.isFullyConvertibleToText = function () {\n        return isFullyConvertible(this);\n    };\n    /**\n     * @return a RRule instance with the same freq and options\n     * as this one (cache is not cloned)\n     */\n    RRule.prototype.clone = function () {\n        return new RRule(this.origOptions);\n    };\n    // RRule class 'constants'\n    RRule.FREQUENCIES = [\n        'YEARLY',\n        'MONTHLY',\n        'WEEKLY',\n        'DAILY',\n        'HOURLY',\n        'MINUTELY',\n        'SECONDLY',\n    ];\n    RRule.YEARLY = Frequency.YEARLY;\n    RRule.MONTHLY = Frequency.MONTHLY;\n    RRule.WEEKLY = Frequency.WEEKLY;\n    RRule.DAILY = Frequency.DAILY;\n    RRule.HOURLY = Frequency.HOURLY;\n    RRule.MINUTELY = Frequency.MINUTELY;\n    RRule.SECONDLY = Frequency.SECONDLY;\n    RRule.MO = Days.MO;\n    RRule.TU = Days.TU;\n    RRule.WE = Days.WE;\n    RRule.TH = Days.TH;\n    RRule.FR = Days.FR;\n    RRule.SA = Days.SA;\n    RRule.SU = Days.SU;\n    RRule.parseString = parseString;\n    RRule.optionsToString = optionsToString;\n    return RRule;\n}());\nexport { RRule };\n//# sourceMappingURL=rrule.js.map","import { __assign } from \"tslib\";\nimport { RRule } from './rrule';\nimport { RRuleSet } from './rruleset';\nimport { untilStringToDate } from './dateutil';\nimport { includes, split } from './helpers';\nimport { parseString, parseDtstart } from './parsestring';\n/**\n * RRuleStr\n * To parse a set of rrule strings\n */\nvar DEFAULT_OPTIONS = {\n    dtstart: null,\n    cache: false,\n    unfold: false,\n    forceset: false,\n    compatible: false,\n    tzid: null,\n};\nexport function parseInput(s, options) {\n    var rrulevals = [];\n    var rdatevals = [];\n    var exrulevals = [];\n    var exdatevals = [];\n    var parsedDtstart = parseDtstart(s);\n    var dtstart = parsedDtstart.dtstart;\n    var tzid = parsedDtstart.tzid;\n    var lines = splitIntoLines(s, options.unfold);\n    lines.forEach(function (line) {\n        var _a;\n        if (!line)\n            return;\n        var _b = breakDownLine(line), name = _b.name, parms = _b.parms, value = _b.value;\n        switch (name.toUpperCase()) {\n            case 'RRULE':\n                if (parms.length) {\n                    throw new Error(\"unsupported RRULE parm: \".concat(parms.join(',')));\n                }\n                rrulevals.push(parseString(line));\n                break;\n            case 'RDATE':\n                var _c = (_a = /RDATE(?:;TZID=([^:=]+))?/i.exec(line)) !== null && _a !== void 0 ? _a : [], rdateTzid = _c[1];\n                if (rdateTzid && !tzid) {\n                    tzid = rdateTzid;\n                }\n                rdatevals = rdatevals.concat(parseRDate(value, parms));\n                break;\n            case 'EXRULE':\n                if (parms.length) {\n                    throw new Error(\"unsupported EXRULE parm: \".concat(parms.join(',')));\n                }\n                exrulevals.push(parseString(value));\n                break;\n            case 'EXDATE':\n                exdatevals = exdatevals.concat(parseRDate(value, parms));\n                break;\n            case 'DTSTART':\n                break;\n            default:\n                throw new Error('unsupported property: ' + name);\n        }\n    });\n    return {\n        dtstart: dtstart,\n        tzid: tzid,\n        rrulevals: rrulevals,\n        rdatevals: rdatevals,\n        exrulevals: exrulevals,\n        exdatevals: exdatevals,\n    };\n}\nfunction buildRule(s, options) {\n    var _a = parseInput(s, options), rrulevals = _a.rrulevals, rdatevals = _a.rdatevals, exrulevals = _a.exrulevals, exdatevals = _a.exdatevals, dtstart = _a.dtstart, tzid = _a.tzid;\n    var noCache = options.cache === false;\n    if (options.compatible) {\n        options.forceset = true;\n        options.unfold = true;\n    }\n    if (options.forceset ||\n        rrulevals.length > 1 ||\n        rdatevals.length ||\n        exrulevals.length ||\n        exdatevals.length) {\n        var rset_1 = new RRuleSet(noCache);\n        rset_1.dtstart(dtstart);\n        rset_1.tzid(tzid || undefined);\n        rrulevals.forEach(function (val) {\n            rset_1.rrule(new RRule(groomRruleOptions(val, dtstart, tzid), noCache));\n        });\n        rdatevals.forEach(function (date) {\n            rset_1.rdate(date);\n        });\n        exrulevals.forEach(function (val) {\n            rset_1.exrule(new RRule(groomRruleOptions(val, dtstart, tzid), noCache));\n        });\n        exdatevals.forEach(function (date) {\n            rset_1.exdate(date);\n        });\n        if (options.compatible && options.dtstart)\n            rset_1.rdate(dtstart);\n        return rset_1;\n    }\n    var val = rrulevals[0] || {};\n    return new RRule(groomRruleOptions(val, val.dtstart || options.dtstart || dtstart, val.tzid || options.tzid || tzid), noCache);\n}\nexport function rrulestr(s, options) {\n    if (options === void 0) { options = {}; }\n    return buildRule(s, initializeOptions(options));\n}\nfunction groomRruleOptions(val, dtstart, tzid) {\n    return __assign(__assign({}, val), { dtstart: dtstart, tzid: tzid });\n}\nfunction initializeOptions(options) {\n    var invalid = [];\n    var keys = Object.keys(options);\n    var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n    keys.forEach(function (key) {\n        if (!includes(defaultKeys, key))\n            invalid.push(key);\n    });\n    if (invalid.length) {\n        throw new Error('Invalid options: ' + invalid.join(', '));\n    }\n    return __assign(__assign({}, DEFAULT_OPTIONS), options);\n}\nfunction extractName(line) {\n    if (line.indexOf(':') === -1) {\n        return {\n            name: 'RRULE',\n            value: line,\n        };\n    }\n    var _a = split(line, ':', 1), name = _a[0], value = _a[1];\n    return {\n        name: name,\n        value: value,\n    };\n}\nfunction breakDownLine(line) {\n    var _a = extractName(line), name = _a.name, value = _a.value;\n    var parms = name.split(';');\n    if (!parms)\n        throw new Error('empty property name');\n    return {\n        name: parms[0].toUpperCase(),\n        parms: parms.slice(1),\n        value: value,\n    };\n}\nfunction splitIntoLines(s, unfold) {\n    if (unfold === void 0) { unfold = false; }\n    s = s && s.trim();\n    if (!s)\n        throw new Error('Invalid empty string');\n    // More info about 'unfold' option\n    // Go head to http://www.ietf.org/rfc/rfc2445.txt\n    if (!unfold) {\n        return s.split(/\\s/);\n    }\n    var lines = s.split('\\n');\n    var i = 0;\n    while (i < lines.length) {\n        // TODO\n        var line = (lines[i] = lines[i].replace(/\\s+$/g, ''));\n        if (!line) {\n            lines.splice(i, 1);\n        }\n        else if (i > 0 && line[0] === ' ') {\n            lines[i - 1] += line.slice(1);\n            lines.splice(i, 1);\n        }\n        else {\n            i += 1;\n        }\n    }\n    return lines;\n}\nfunction validateDateParm(parms) {\n    parms.forEach(function (parm) {\n        if (!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(parm)) {\n            throw new Error('unsupported RDATE/EXDATE parm: ' + parm);\n        }\n    });\n}\nfunction parseRDate(rdateval, parms) {\n    validateDateParm(parms);\n    return rdateval.split(',').map(function (datestr) { return untilStringToDate(datestr); });\n}\n//# sourceMappingURL=rrulestr.js.map","import { __extends } from \"tslib\";\nimport { RRule } from './rrule';\nimport { sort, timeToUntilString } from './dateutil';\nimport { includes } from './helpers';\nimport { iterSet } from './iterset';\nimport { rrulestr } from './rrulestr';\nimport { optionsToString } from './optionstostring';\nfunction createGetterSetter(fieldName) {\n    var _this = this;\n    return function (field) {\n        if (field !== undefined) {\n            _this[\"_\".concat(fieldName)] = field;\n        }\n        if (_this[\"_\".concat(fieldName)] !== undefined) {\n            return _this[\"_\".concat(fieldName)];\n        }\n        for (var i = 0; i < _this._rrule.length; i++) {\n            var field_1 = _this._rrule[i].origOptions[fieldName];\n            if (field_1) {\n                return field_1;\n            }\n        }\n    };\n}\nvar RRuleSet = /** @class */ (function (_super) {\n    __extends(RRuleSet, _super);\n    /**\n     *\n     * @param {Boolean?} noCache\n     * The same stratagy as RRule on cache, default to false\n     * @constructor\n     */\n    function RRuleSet(noCache) {\n        if (noCache === void 0) { noCache = false; }\n        var _this = _super.call(this, {}, noCache) || this;\n        _this.dtstart = createGetterSetter.apply(_this, ['dtstart']);\n        _this.tzid = createGetterSetter.apply(_this, ['tzid']);\n        _this._rrule = [];\n        _this._rdate = [];\n        _this._exrule = [];\n        _this._exdate = [];\n        return _this;\n    }\n    RRuleSet.prototype._iter = function (iterResult) {\n        return iterSet(iterResult, this._rrule, this._exrule, this._rdate, this._exdate, this.tzid());\n    };\n    /**\n     * Adds an RRule to the set\n     *\n     * @param {RRule}\n     */\n    RRuleSet.prototype.rrule = function (rrule) {\n        _addRule(rrule, this._rrule);\n    };\n    /**\n     * Adds an EXRULE to the set\n     *\n     * @param {RRule}\n     */\n    RRuleSet.prototype.exrule = function (rrule) {\n        _addRule(rrule, this._exrule);\n    };\n    /**\n     * Adds an RDate to the set\n     *\n     * @param {Date}\n     */\n    RRuleSet.prototype.rdate = function (date) {\n        _addDate(date, this._rdate);\n    };\n    /**\n     * Adds an EXDATE to the set\n     *\n     * @param {Date}\n     */\n    RRuleSet.prototype.exdate = function (date) {\n        _addDate(date, this._exdate);\n    };\n    /**\n     * Get list of included rrules in this recurrence set.\n     *\n     * @return List of rrules\n     */\n    RRuleSet.prototype.rrules = function () {\n        return this._rrule.map(function (e) { return rrulestr(e.toString()); });\n    };\n    /**\n     * Get list of excluded rrules in this recurrence set.\n     *\n     * @return List of exrules\n     */\n    RRuleSet.prototype.exrules = function () {\n        return this._exrule.map(function (e) { return rrulestr(e.toString()); });\n    };\n    /**\n     * Get list of included datetimes in this recurrence set.\n     *\n     * @return List of rdates\n     */\n    RRuleSet.prototype.rdates = function () {\n        return this._rdate.map(function (e) { return new Date(e.getTime()); });\n    };\n    /**\n     * Get list of included datetimes in this recurrence set.\n     *\n     * @return List of exdates\n     */\n    RRuleSet.prototype.exdates = function () {\n        return this._exdate.map(function (e) { return new Date(e.getTime()); });\n    };\n    RRuleSet.prototype.valueOf = function () {\n        var result = [];\n        if (!this._rrule.length && this._dtstart) {\n            result = result.concat(optionsToString({ dtstart: this._dtstart }));\n        }\n        this._rrule.forEach(function (rrule) {\n            result = result.concat(rrule.toString().split('\\n'));\n        });\n        this._exrule.forEach(function (exrule) {\n            result = result.concat(exrule\n                .toString()\n                .split('\\n')\n                .map(function (line) { return line.replace(/^RRULE:/, 'EXRULE:'); })\n                .filter(function (line) { return !/^DTSTART/.test(line); }));\n        });\n        if (this._rdate.length) {\n            result.push(rdatesToString('RDATE', this._rdate, this.tzid()));\n        }\n        if (this._exdate.length) {\n            result.push(rdatesToString('EXDATE', this._exdate, this.tzid()));\n        }\n        return result;\n    };\n    /**\n     * to generate recurrence field such as:\n     * DTSTART:19970902T010000Z\n     * RRULE:FREQ=YEARLY;COUNT=2;BYDAY=TU\n     * RRULE:FREQ=YEARLY;COUNT=1;BYDAY=TH\n     */\n    RRuleSet.prototype.toString = function () {\n        return this.valueOf().join('\\n');\n    };\n    /**\n     * Create a new RRuleSet Object completely base on current instance\n     */\n    RRuleSet.prototype.clone = function () {\n        var rrs = new RRuleSet(!!this._cache);\n        this._rrule.forEach(function (rule) { return rrs.rrule(rule.clone()); });\n        this._exrule.forEach(function (rule) { return rrs.exrule(rule.clone()); });\n        this._rdate.forEach(function (date) { return rrs.rdate(new Date(date.getTime())); });\n        this._exdate.forEach(function (date) { return rrs.exdate(new Date(date.getTime())); });\n        return rrs;\n    };\n    return RRuleSet;\n}(RRule));\nexport { RRuleSet };\nfunction _addRule(rrule, collection) {\n    if (!(rrule instanceof RRule)) {\n        throw new TypeError(String(rrule) + ' is not RRule instance');\n    }\n    if (!includes(collection.map(String), String(rrule))) {\n        collection.push(rrule);\n    }\n}\nfunction _addDate(date, collection) {\n    if (!(date instanceof Date)) {\n        throw new TypeError(String(date) + ' is not Date instance');\n    }\n    if (!includes(collection.map(Number), Number(date))) {\n        collection.push(date);\n        sort(collection);\n    }\n}\nfunction rdatesToString(param, rdates, tzid) {\n    var isUTC = !tzid || tzid.toUpperCase() === 'UTC';\n    var header = isUTC ? \"\".concat(param, \":\") : \"\".concat(param, \";TZID=\").concat(tzid, \":\");\n    var dateString = rdates\n        .map(function (rdate) { return timeToUntilString(rdate.valueOf(), isUTC); })\n        .join(',');\n    return \"\".concat(header).concat(dateString);\n}\n//# sourceMappingURL=rruleset.js.map","import { DateWithZone } from './datewithzone';\nimport { iter } from './iter';\nimport { sort } from './dateutil';\nexport function iterSet(iterResult, _rrule, _exrule, _rdate, _exdate, tzid) {\n    var _exdateHash = {};\n    var _accept = iterResult.accept;\n    function evalExdate(after, before) {\n        _exrule.forEach(function (rrule) {\n            rrule.between(after, before, true).forEach(function (date) {\n                _exdateHash[Number(date)] = true;\n            });\n        });\n    }\n    _exdate.forEach(function (date) {\n        var zonedDate = new DateWithZone(date, tzid).rezonedDate();\n        _exdateHash[Number(zonedDate)] = true;\n    });\n    iterResult.accept = function (date) {\n        var dt = Number(date);\n        if (isNaN(dt))\n            return _accept.call(this, date);\n        if (!_exdateHash[dt]) {\n            evalExdate(new Date(dt - 1), new Date(dt + 1));\n            if (!_exdateHash[dt]) {\n                _exdateHash[dt] = true;\n                return _accept.call(this, date);\n            }\n        }\n        return true;\n    };\n    if (iterResult.method === 'between') {\n        evalExdate(iterResult.args.after, iterResult.args.before);\n        iterResult.accept = function (date) {\n            var dt = Number(date);\n            if (!_exdateHash[dt]) {\n                _exdateHash[dt] = true;\n                return _accept.call(this, date);\n            }\n            return true;\n        };\n    }\n    for (var i = 0; i < _rdate.length; i++) {\n        var zonedDate = new DateWithZone(_rdate[i], tzid).rezonedDate();\n        if (!iterResult.accept(new Date(zonedDate.getTime())))\n            break;\n    }\n    _rrule.forEach(function (rrule) {\n        iter(iterResult, rrule.options);\n    });\n    var res = iterResult._result;\n    sort(res);\n    switch (iterResult.method) {\n        case 'all':\n        case 'between':\n            return res;\n        case 'before':\n            return ((res.length && res[res.length - 1]) || null);\n        case 'after':\n        default:\n            return ((res.length && res[0]) || null);\n    }\n}\n//# sourceMappingURL=iterset.js.map","/* autoscroll start */\n\nexport default function(scheduler){\n\nlet scrollInterval = 10;\n\nlet interval = null;\nlet startPos = null;\n\nfunction getRelativeCoordinates (e, parent) {\n\tconst view = scheduler.matrix[scheduler._mode];\n\tconst pos = {};\n\tconst offset = {};\n\tlet container = parent;\n\n\tpos.x = !!e.touches ? e.touches[ 0 ].pageX : e.pageX;\n\tpos.y = !! e.touches ? e.touches[ 0 ].pageY : e.pageY;\n\n\toffset.left = container.offsetLeft + view.dx;\n\toffset.top = container.offsetTop;\n\n\twhile ( container ) {\n\n\t\toffset.left += container.offsetLeft;\n\t\toffset.top += container.offsetTop;\n\n\t\tcontainer = container.offsetParent;\n\t}\n\n\treturn {\n\t\tx : pos.x - offset.left,\n\t\ty : pos.y - offset.top\n\t};\n}\n\nfunction autoscrollInterval(event){\n\tif(interval)\n\t\tclearInterval(interval);\n\n\tconst view = scheduler.matrix[scheduler._mode];\n\tif(!view)\n\t\treturn;\n\tscheduler._schedulerOuter =  scheduler.$container.querySelector(\".dhx_timeline_data_wrapper\");\n\tif (!view.scrollable){\n\t\tscheduler._schedulerOuter = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t}\n\n\tconst eventPos = {\n\t\tpageX: !!event.touches ? event.touches[0].pageX : event.pageX,\n\t\tpageY: !!event.touches ? event.touches[0].pageY : event.pageY\n\t};\n\tinterval = setInterval(function(){tick(eventPos);}, scrollInterval);\n}\n\nscheduler.attachEvent(\"onDestroy\", function(){\n\tclearInterval(interval);\n});\n\nfunction tick(e){\n\tif(!scheduler.getState().drag_id) {\n\t\tclearInterval(interval);\n\t\tstartPos = null;\n\t\treturn;\n\t}\n\n\tconst view = scheduler.matrix[scheduler._mode];\n\tif(!view)\n\t\treturn;\n\n\n\t\n\tconst viewport = scheduler._schedulerOuter;\n\tconst box = getRelativeCoordinates(e, viewport);\n\n\tconst availWidth = viewport.offsetWidth - view.dx;\n\tconst availHeight = viewport.offsetHeight;\n\n\tconst posX = box.x;\n\tconst posY = box.y;\n\n\tlet settings = view.autoscroll || {};\n\tif(settings === true){\n\t\tsettings = {};\n\t}\n\n\tscheduler._merge(settings, {\n\t\trange_x: 200,// px to edge\n\t\trange_y: 100,\n\t\tspeed_x: 20,// speed\n\t\tspeed_y: 10\n\t});\n\n\tlet scrollLeft = need_scroll(posX, availWidth, startPos ? startPos.x : 0, settings.range_x);\n\tif(!view.scrollable){\n\t\tscrollLeft = 0;\n\t}\n\tlet scrollTop = need_scroll(posY, availHeight, startPos ? startPos.y : 0, settings.range_y);\n\n\tif((scrollTop || scrollLeft) && !startPos){\n\t\tstartPos = {\n\t\t\tx: posX,\n\t\t\ty: posY\n\t\t};\n\n\t\tscrollLeft = 0;\n\t\tscrollTop = 0;\n\t}\n\n\tscrollLeft = scrollLeft * settings.speed_x;\n\tscrollTop = scrollTop * settings.speed_y;\n\n\tif(scrollLeft && scrollTop){\n\t\tif(Math.abs(scrollLeft / 5) > Math.abs(scrollTop)){\n\t\t\tscrollTop = 0;\n\t\t}else if(Math.abs(scrollTop / 5) > Math.abs(scrollLeft)){\n\t\t\tscrollLeft = 0;\n\t\t}\n\t}\n\n\tif(scrollLeft || scrollTop){\n\t\tstartPos.started = true;\n\t\tscroll(scrollLeft, scrollTop);\n\t}else{\n\t\tclearInterval(interval);\n\t}\n}\n\nfunction need_scroll(pos, boxSize, startCoord, scrollRange){\n\tif(pos < scrollRange && (!startPos || startPos.started || pos < startCoord)){\n\t\treturn -1;\n\t}else if(boxSize - pos < scrollRange && (!startPos || startPos.started || pos > startCoord)){\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nfunction scroll(left, top){\n\tconst viewport = scheduler._schedulerOuter;\n\tif(top){\n\t\tviewport.scrollTop += top;\n\t}\n\tif (left){ // + 40 - adjust height of that movement was correct\n\t\tviewport.scrollLeft += left;\n\t}\n}\n\n\nvar evId = scheduler.attachEvent(\"onSchedulerReady\", function(){\n\tif (scheduler.matrix) {\n\t\tscheduler.event(document.body, \"mousemove\", autoscrollInterval);\n\t\tscheduler.detachEvent(evId);\n\t}\n});\n\n/* autoscroll end */\n\n}","export default (function(){\n\treturn function create(){\n\t\tvar modes = {\n\t\t\t\"minMax\":\"[0;max]\",\n\t\t\t\"maxMin\":\"[max;0]\",\n\t\t\t\"nMaxMin\":\"[-max;0]\"\n\t\t};\n\t\t\n\t\tfunction createTestElement(){\n\t\t\tvar container = document.createElement(\"div\");\n\t\t\tcontainer.style.cssText = \t\"direction: rtl;\" + \n\t\t\t\t\t\t\t\t\t\t\"overflow: auto;\" +\n\t\t\t\t\t\t\t\t\t\t\"width:100px;\" +\n\t\t\t\t\t\t\t\t\t\t\"height: 100px;\" +\n\t\t\t\t\t\t\t\t\t\t\"position:absolute;\" +\n\t\t\t\t\t\t\t\t\t\t\"top: -100500px;\" +\n\t\t\t\t\t\t\t\t\t\t\"left: -100500px;\";\n\t\t\tvar content = document.createElement(\"div\");\n\t\t\tcontent.style.cssText = \"width: 100500px;height: 1px;\";\n\t\t\tcontainer.appendChild(content);\n\t\t\treturn container;\n\t\t}\n\n\t\tfunction detectScrollMode(){\n\t\t\tvar result = modes.minMax;\n\t\t\tvar demoElement = createTestElement();\n\t\t\tdocument.body.appendChild(demoElement);\n\n\t\t\tvar initialScroll = demoElement.scrollLeft;\n\t\t\tif(initialScroll > 0){\n\t\t\t\t// scrollLeft goes from zero (left) to maximum value (right), the same way as in ltr mode\n\t\t\t\t// probably chrome\n\t\t\t\tresult = modes.minMax;\n\t\t\t}else{\n\t\t\t\tdemoElement.scrollLeft = -50;\n\t\t\t\tif(demoElement.scrollLeft === -50){\n\t\t\t\t\t// scrollLeft goes from negative max (left) to zero (right)\n\t\t\t\t\t// probably FF\n\t\t\t\t\tresult = modes.nMaxMin; \n\t\t\t\t}else{\n\t\t\t\t\t// scrollLeft goes from max (left) to zero (right)\n\t\t\t\t\t// probably IE\n\t\t\t\t\tresult = modes.maxMin; \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdocument.body.removeChild(demoElement);\n\t\t\treturn result;\n\t\t}\n\n\t\tfunction normalizeValue(value, scrollWidth){\n\t\t\tvar mode = getMode();\n\t\t\tif(mode === modes.nMaxMin){\n\t\t\t\tif(value){\n\t\t\t\t\treturn -value;\n\t\t\t\t}else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}else if (mode === modes.minMax){\n\t\t\t\treturn scrollWidth - value;\n\t\t\t}else {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\n\n\t\tfunction getScrollValue(element){\n\t\t\t//const direction = \"ltr\";\n\t\t\tvar direction = getComputedStyle(element).direction;\n\t\t\tif(!direction || direction === \"ltr\"){\n\t\t\t\treturn element.scrollLeft;\n\t\t\t}else {\n\t\t\t\tvar maxScroll = element.scrollWidth - element.offsetWidth;\n\t\t\t\treturn normalizeValue(element.scrollLeft, maxScroll);\n\t\t\t}\n\t\t}\n\n\t\tfunction setScrollValue(element, value){\n\t\t\t//const direction = \"ltr\";\n\t\t\tvar direction = getComputedStyle(element).direction;\n\t\t\tif(!direction || direction === \"ltr\"){\n\t\t\t\telement.scrollLeft = value;\n\t\t\t}else {\n\t\t\t\tvar maxScroll = element.scrollWidth - element.offsetWidth;\n\t\t\t\tvar normalized = normalizeValue(value, maxScroll);\n\t\t\t\telement.scrollLeft = normalized;\n\t\t\t}\n\t\t}\n\n\t\tvar currentMode;\n\t\tfunction getMode(){\n\t\t\tif(!currentMode){\n\t\t\t\tcurrentMode = detectScrollMode();\n\t\t\t}\n\t\t\treturn currentMode;\n\t\t}\n\t\treturn {\n\t\t\tmodes: modes,\n\t\t\tgetMode: getMode,\n\t\t\tnormalizeValue: normalizeValue,\n\t\t\tgetScrollValue: getScrollValue,\n\t\t\tsetScrollValue: setScrollValue\n\t\t};\n\t};\n})();","interface IViewPosition{\n\ttop: number;\n\tleft: number;\n}\n\ninterface IViewBox extends IViewPosition{\n\twidth: number;\n\theight: number;\n\tbottom: number;\n\tright: number;\n}\n\nexport class Tooltip {\n\tprivate _root: HTMLElement;\n\tprivate _tooltipNode: HTMLElement | null;\n\tprivate _scheduler: any;\n\n\tconstructor(scheduler: any){\n\t\tthis._scheduler = scheduler;\n\t}\n\n\tgetNode() : HTMLElement {\n\t\tconst scheduler = this._scheduler;\n\t\tif (!this._tooltipNode){\n\t\t\tthis._tooltipNode = document.createElement(\"div\");\n\t\t\tthis._tooltipNode.className = \"dhtmlXTooltip scheduler_tooltip tooltip\";\n\n\t\t\tscheduler._waiAria.tooltipAttr(this._tooltipNode);\n\t\t}\n\t\tif(scheduler.config.rtl){\n\t\t\tthis._tooltipNode.classList.add(\"dhtmlXTooltip_rtl\");\n\t\t} else{\n\t\t\tthis._tooltipNode.classList.remove(\"dhtmlXTooltip_rtl\");\n\t\t}\n\t\treturn this._tooltipNode;\n\t}\n\n\tsetViewport(node: HTMLElement):Tooltip{\n\t\tthis._root = node;\n\t\treturn this;\n\t}\n\n\tshow(left: number, top: number): Tooltip;\n\tshow(event: MouseEvent): Tooltip;\n\tshow(left: number | MouseEvent, top?: number): Tooltip {\n\t\tconst scheduler = this._scheduler;\n\t\tconst domHelpers = scheduler.$domHelpers;\n\t\tconst container = document.body;\n\t\tconst node = this.getNode();\n\n\t\tif(!domHelpers.isChildOf(node, container)){\n\t\t\tthis.hide();\n\t\t\tcontainer.appendChild(node);\n\t\t}\n\n\t\tif (this._isLikeMouseEvent(left)) {\n\t\t\tconst position = this._calculateTooltipPosition(left as MouseEvent);\n\t\t\ttop = position.top;\n\t\t\tleft = position.left;\n\t\t}\n\n\t\tnode.style.top = top + \"px\";\n\t\tnode.style.left = left + \"px\";\n\n\t\tscheduler._waiAria.tooltipVisibleAttr(node);\n\t\treturn this;\n\t}\n\thide() : Tooltip{\n\t\tconst scheduler = this._scheduler;\n\t\tconst node = this.getNode();\n\t\tif(node && node.parentNode){\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t\tscheduler._waiAria.tooltipHiddenAttr(node);\n\t\treturn this;\n\t}\n\n\tsetContent(html: string) : Tooltip{\n\t\tconst node = this.getNode();\n\t\tnode.innerHTML = html;\n\t\treturn this;\n\t}\n\n\t// it is for salesforce, because it proxies event to it own events\n\tprivate _isLikeMouseEvent(event: any): boolean {\n\t\tif (!event || typeof event !== \"object\") {\n\t\t\treturn false;\n\t\t}\n\t\treturn \"clientX\" in event && \"clientY\" in event;\n\t}\n\n\tprivate _getViewPort() : HTMLElement {\n\t\treturn this._root || document.body;\n\t}\n\n\n\tprivate _calculateTooltipPosition(event: MouseEvent): IViewPosition{\n\t\tconst scheduler = this._scheduler;\n\t\tconst domHelpers = scheduler.$domHelpers;\n\t\t// top/left coordinates inside the viewport by mouse position\n\t\tconst viewport =  this._getViewPortSize();\n\t\tconst tooltipNode = this.getNode();\n\t\tconst tooltip: IViewBox = {\n\t\t\ttop:0,\n\t\t\tleft: 0,\n\t\t\twidth: tooltipNode.offsetWidth,\n\t\t\theight: tooltipNode.offsetHeight,\n\t\t\tbottom: 0,\n\t\t\tright: 0\n\t\t};\n\n\t\tconst offsetX = scheduler.config.tooltip_offset_x;\n\t\tconst offsetY = scheduler.config.tooltip_offset_y;\n\n\t\tconst container = document.body;\n\t\tconst mouse = domHelpers.getRelativeEventPosition(event, container);\n\t\tconst containerPos = domHelpers.getNodePosition(container);\n\t\tmouse.y += containerPos.y; // to fix margin collapsing\n\n\t\ttooltip.top = mouse.y;\n\t\ttooltip.left = mouse.x;\n\t\ttooltip.top += offsetY;\n\t\ttooltip.left += offsetX;\n\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\ttooltip.right = tooltip.left + tooltip.width;\n\n\t\tconst scrollTop = window.scrollY + container.scrollTop; // to fix margin collapsing\n\t\t// edge cases when the tooltip element can be partially hidden by edges of the viewport\n\t\tif(tooltip.top < viewport.top - scrollTop){\n\t\t\ttooltip.top = viewport.top;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}else if(tooltip.bottom > viewport.bottom){\n\t\t\ttooltip.bottom = viewport.bottom;\n\t\t\ttooltip.top = tooltip.bottom - tooltip.height;\n\t\t}\n\n\t\tif(tooltip.left < viewport.left){\n\t\t\ttooltip.left = viewport.left;\n\t\t\ttooltip.right = viewport.left + tooltip.width;\n\t\t}else if(tooltip.right > viewport.right){\n\t\t\ttooltip.right = viewport.right;\n\t\t\ttooltip.left = tooltip.right - tooltip.width;\n\t\t}\n\n\t\tif(mouse.x >= tooltip.left && mouse.x <= tooltip.right) {\n\t\t\ttooltip.left = mouse.x - tooltip.width - offsetX;\n\t\t\ttooltip.right = tooltip.left + tooltip.width;\n\t\t}\n\n\t\tif(mouse.y >= tooltip.top && mouse.y <= tooltip.bottom) {\n\t\t\ttooltip.top = mouse.y - tooltip.height - offsetY;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}\n\t\t// GS-2816: when tooltip width is greater than viewport width\n\t\tif(tooltip.left < 0 ){\n\t\t\ttooltip.left = 0;\n\t\t}\n\t\tif(tooltip.right < 0 ){\n\t\t\ttooltip.right = 0;\n\t\t}\n\n\t\treturn tooltip;\n\t}\n\n\tprivate _getViewPortSize() : IViewBox {\n\t\tconst scheduler = this._scheduler;\n\t\tconst domHelpers = scheduler.$domHelpers;\n\t\tconst container = this._getViewPort();\n\t\tlet viewport = container;\n\t\tlet scrollTop = window.scrollY + document.body.scrollTop;\n\t\tlet scrollLeft = window.scrollX + document.body.scrollLeft;\n\t\tlet pos;\n\t\t// support for the initial tooltip mode where the tooltip element was attached to the data area of scheduler\n\t\tif(container === scheduler.$event_data){\n\t\t\tviewport = scheduler.$event;\n\t\t\tscrollTop = 0;\n\t\t\tscrollLeft = 0;\n\t\t\tpos = domHelpers.getNodePosition(scheduler.$event);\n\t\t}else{\n\t\t\tpos = domHelpers.getNodePosition(viewport);\n\t\t}\n\t\treturn {\n\t\t\tleft:pos.x + scrollLeft,\n\t\t\ttop: pos.y + scrollTop,\n\t\t\twidth: pos.width,\n\t\t\theight: pos.height,\n\t\t\tbottom: pos.y + pos.height + scrollTop,\n\t\t\tright: pos.x + pos.width + scrollLeft\n\t\t};\n\t}\n}\n","import * as utils from \"../../core/utils/utils\";\nimport { Tooltip } from \"./tooltip\";\n\ninterface ITrackerTarget {\n\tselector: string;\n\tonmouseenter: (event: MouseEvent, node: HTMLElement) => void;\n\tonmousemove: (event: MouseEvent, node: HTMLElement) => void;\n\tonmouseleave: (event: MouseEvent, node: HTMLElement) => void;\n\tglobal: boolean;\n}\n\ninterface ITooltipConfig {\n\tselector: string;\n\thtml: (event: MouseEvent, node: HTMLElement) => string;\n\tglobal: boolean;\n}\n\nexport class TooltipManager{\n\ttooltip: Tooltip;\n\tprotected _domEvents: any;\n\tprivate _listeners: object = {};\n\tprivate _scheduler: any;\n\tprivate delayShow: any;\n\tprivate delayHide: any;\n\n\tconstructor(scheduler: any) {\n\t\tthis.tooltip = new Tooltip(scheduler);\n\t\tthis._scheduler = scheduler;\n\t\tthis._domEvents = scheduler._createDomEventScope();\n\t\tthis._initDelayedFunctions();\n\t}\n\n\tdestructor(): void{\n\t\tthis.tooltip.hide();\n\t\tthis._domEvents.detachAll();\n\t}\n\thideTooltip(): void{\n\t\tthis.delayHide();\n\t}\n\tattach(config: ITrackerTarget): void {\n\t\tlet root = document.body;\n\t\tconst scheduler = this._scheduler;\n\t\tconst domHelpers = scheduler.$domHelpers;\n\t\tif(!config.global){\n\t\t\troot = scheduler.$root;\n\t\t}\n\n\t\tlet watchableTarget = null;\n\t\tconst handler = (event) => {\n\t\t\tconst eventTarget = domHelpers.getTargetNode(event);\n\t\t\tconst targetNode = domHelpers.closest(eventTarget, config.selector);\n\t\t\tif(domHelpers.isChildOf(eventTarget, this.tooltip.getNode())){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst doOnMouseEnter = () => {\n\t\t\t\twatchableTarget = targetNode;\n\t\t\t\tconfig.onmouseenter(event, targetNode);\n\t\t\t};\n\t\t\t// GS-2377: to show tooltip after touch and hide it when touch is outside the events\n\t\t\tif (scheduler._mobile && scheduler.config.touch_tooltip){\n\t\t\t\tif(targetNode){\n\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t} else {\n\t\t\t\t\tconfig.onmouseleave(event, targetNode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(watchableTarget){\n\t\t\t\tif(targetNode && targetNode === watchableTarget){\n\t\t\t\t\tconfig.onmousemove(event, targetNode);\n\t\t\t\t}else{\n\t\t\t\t\tconfig.onmouseleave(event, watchableTarget);\n\t\t\t\t\twatchableTarget = null;\n\n\t\t\t\t\tif(targetNode && targetNode !== watchableTarget){\n\t\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(targetNode){\n\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.detach(config.selector);\n\t\tthis._domEvents.attach(root, \"mousemove\", handler);\n\t\tthis._listeners[config.selector] = {\n\t\t\tnode: root,\n\t\t\thandler\n\t\t};\n\t}\n\n\tdetach(selector: string): void {\n\t\tconst listener = this._listeners[selector];\n\t\tif(listener){\n\t\t\tthis._domEvents.detach(listener.node, \"mousemove\", listener.handler);\n\t\t}\n\t}\n\n\ttooltipFor(config: ITooltipConfig): void {\n\t\tconst cloneDomEvent = (event: MouseEvent) => {\n\t\t\tlet clone = event;\n\t\t\t// making events survive timeout in ie\n\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\tif(document[\"createEventObject\"] && !document.createEvent){\n\t\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\t\tclone = document[\"createEventObject\"](event);\n\t\t\t}\n\t\t\treturn clone;\n\t\t};\n\t\tthis._initDelayedFunctions();\n\t\tthis.attach({\n\t\t\tselector: config.selector,\n\t\t\tglobal: config.global,\n\t\t\tonmouseenter:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmousemove:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}else{\n\t\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\t\tthis.delayHide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmouseleave:() => {\n\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\tthis.delayHide();\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate _initDelayedFunctions(){\n\t\tconst scheduler = this._scheduler;\n\t\t// reset delayed functions in order to apply current values of tooltip_timeout\n\t\tif(this.delayShow){\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t}\n\t\tif(this.delayHide){\n\t\t\tthis.delayHide.$cancelTimeout();\n\t\t}\n\t\tthis.tooltip.hide();\n\t\t\n\t\tthis.delayShow = (utils as any).default.delay((event: MouseEvent, html: string) => {\n\t\t\tif(scheduler.callEvent(\"onBeforeTooltip\", [event]) === false) {\n\t\t\t\tthis.tooltip.hide();\n\t\t\t} else {\n\t\t\t\tthis.tooltip.setContent(html);\n\t\t\t\tthis.tooltip.show(event);\n\t\t\t}\n\t\t}, scheduler.config.tooltip_timeout || 1);\n\n\t\tthis.delayHide = (utils as any).default.delay(() => {\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\tthis.tooltip.hide();\n\t\t}, scheduler.config.tooltip_hide_timeout || 1);\n\t}\n\n}","import active_links from \"./active_links\";\nimport agenda_legacy from \"./agenda_legacy_view\";\nimport agenda_view from \"./agenda\";\nimport all_timed from \"./all_timed\";\nimport collision from \"./collision\";\nimport container_autoresize from \"./container_autoresize\";\nimport cookie from \"./cookie\";\nimport daytimeline from \"./daytimeline\";\nimport drag_between from \"./drag_between\";\nimport editors from \"./editors\";\nimport expand from \"./expand\";\nimport grid_view from \"./grid_view\";\nimport html_templates from \"./html_templates\";\nimport key_nav from \"./key_nav\";\nimport layer from \"./layer\";\nimport legacy from \"./legacy\";\nimport limit from \"./limit\";\nimport map_view from \"./map_view\";\nimport minical from \"./minical\";\nimport monthheight from \"./monthheight\";\nimport multisection from \"./multisection\";\nimport multiselect from \"./multiselect\";\nimport multisource from \"./multisource\";\nimport mvc from \"./mvc\";\nimport outerdrag from \"./outerdrag\";\nimport pdf from \"./pdf\";\nimport quick_info from \"./quick_info\";\nimport readonly from \"./readonly\";\nimport recurring from \"./recurring\";\nimport recurring_legacy from \"./recurring_legacy\";\nimport serialize from \"./serialize\";\nimport timeline from \"./timeline\";\nimport tooltip from \"./tooltip\";\nimport treetimeline from \"./treetimeline\";\nimport units from \"./units\";\nimport url from \"./url\";\nimport week_agenda from \"./week_agenda\";\nimport wp from \"./wp\";\nimport year_view from \"./year_view\";\nimport export_api from \"./export_api\";\n\nexport default {\n\tactive_links,\n\tagenda_legacy,\n\tagenda_view,\n\tall_timed,\n\tcollision,\n\tcontainer_autoresize,\n\tcookie,\n\tdaytimeline,\n\tdrag_between,\n\teditors,\n\texpand,\n\texport_api,\n\tgrid_view,\n\thtml_templates,\n\tkey_nav,\n\tlayer,\n\tlegacy,\n\tlimit,\n\tmap_view,\n\tminical,\n\tmonthheight,\n\tmultisection,\n\tmultiselect,\n\tmultisource,\n\tmvc,\n\touterdrag,\n\tpdf,\n\tquick_info,\n\treadonly,\n\trecurring,\n\trecurring_legacy,\n\tserialize,\n\ttimeline,\n\ttooltip,\n\ttreetimeline,\n\tunits,\n\turl,\n\tweek_agenda,\n\twp,\n\tyear_view\n};","export default function(scheduler){\n\nscheduler.config.active_link_view = \"day\";\nscheduler._active_link_click = function(e){\n\tvar start = e.target;\n\tvar to = start.getAttribute(\"data-link-date\");\n\tvar s_d = scheduler.date.str_to_date(scheduler.config.api_date, false, true);\n\tif (to) {\n\t\tscheduler.setCurrentView(s_d(to), scheduler.config.active_link_view);\n\t\tif (e && e.preventDefault)\n\t\t\te.preventDefault();\n\t\treturn false;\n\t}\n};\nscheduler.attachEvent(\"onTemplatesReady\", function() {\n\tvar do_wrapper = function(key, fullname){\n\t\tfullname = fullname || (key+\"_scale_date\");\n\n\t\tif(!scheduler.templates['_active_links_old_'+ fullname]){\n\t\t\tscheduler.templates['_active_links_old_'+ fullname] = scheduler.templates[fullname];\n\t\t}\n\t\tvar week_x = scheduler.templates['_active_links_old_'+ fullname];\n\t\tvar d_s = scheduler.date.date_to_str(scheduler.config.api_date);\n\t\tscheduler.templates[fullname] = function(date) {\n\t\t\treturn \"<a data-link-date='\" + d_s(date) + \"' href='#'>\" + week_x(date) + \"</a>\";\n\t\t};\n\t};\n\n\tdo_wrapper(\"week\");\n\tdo_wrapper(\"\", \"month_day\");\n\tif (this.matrix){\n\t\tfor (var key in this.matrix)\n\t\t\tdo_wrapper(key);\n\t}\n\n\tthis._detachDomEvent(this._obj, \"click\", scheduler._active_link_click);\n\tscheduler.event(this._obj, \"click\", scheduler._active_link_click);\n});\n\n}","export default function(scheduler){\n\nscheduler.date.add_agenda_legacy = function(date){\n\treturn scheduler.date.add(date, 1, \"year\");\n};\n\nscheduler.templates.agenda_legacy_time = function(start,end,ev){\n\tif (ev._timed)\n\t\treturn this.day_date(ev.start_date, ev.end_date, ev)+\" \"+this.event_date(start);\n\telse\n\t\treturn scheduler.templates.day_date(start)+\" &ndash; \"+scheduler.templates.day_date(end);\n};\nscheduler.templates.agenda_legacy_text = function(start,end,event){\n\treturn event.text;\n};\nscheduler.templates.agenda_legacy_date = function(){ return \"\"; };\n\nscheduler.date.agenda_legacy_start=function(){ return scheduler.date.date_part(scheduler._currentDate()); };\n\nscheduler.attachEvent(\"onTemplatesReady\",function() {\n\tvar old_dblclick_dhx_cal_data = scheduler.dblclick_dhx_cal_data;\n\tscheduler.dblclick_dhx_cal_data = function() {\n\t\tif (this._mode == \"agenda_legacy\") {\n\t\t\tif (!this.config.readonly && this.config.dblclick_create)\n\t\t\t\tthis.addEventNow();\n\t\t} else {\n\t\t\tif (old_dblclick_dhx_cal_data)\n\t\t\t\treturn old_dblclick_dhx_cal_data.apply(this, arguments);\n\t\t}\n\t};\n\n\n\tvar old = scheduler.render_data;\n\tscheduler.render_data=function(evs){\n\t\tif (this._mode == \"agenda_legacy\")\n\t\t\tfill_agenda_tab();\n\t\telse\n\t\t\treturn old.apply(this,arguments);\n\t};\n\n\tvar old_render_view_data = scheduler.render_view_data;\n\tscheduler.render_view_data = function(){\n\t\tif(this._mode == \"agenda_legacy\") {\n\t\t\tscheduler._agendaScrollTop = scheduler._els[\"dhx_cal_data\"][0].childNodes[0].scrollTop;\n\t\t\tscheduler._els[\"dhx_cal_data\"][0].childNodes[0].scrollTop = 0;\n\t\t}\n\t\treturn old_render_view_data.apply(this,arguments);\n\t};\n\n\n\n\tfunction set_full_view(mode){\n\t\tif (mode){\n\t\t\tvar l = scheduler.locale.labels;\n\n\t\t\tvar rowAttr = scheduler._waiAria.agendaHeadAttrString();\n\t\t\tvar dateHeader = scheduler._waiAria.agendaHeadDateString(l.date);\n\t\t\tvar descriptionHeader = scheduler._waiAria.agendaHeadDescriptionString(l.description);\n\n\t\t\tscheduler._els[\"dhx_cal_header\"][0].innerHTML=\"<div \"+rowAttr+\" class='dhx_agenda_line dhx_agenda_line_header'>\" +\n\t\t\t\t\"<div \"+dateHeader+\">\"+l.date+\"</div>\" +\n\t\t\t\t\"<span class = 'description_header' style='padding-left:25px' \"+descriptionHeader+\">\"+l.description+\"</span>\" +\n\t\t\t\t\"</div>\";\n\t\t\tscheduler._table_view=true;\n\t\t\tscheduler.set_sizes();\n\t\t}\n\t}\n\n\tfunction fill_agenda_tab(){\n\t\t//select events for which data need to be printed\n\n\t\tvar events = scheduler.get_visible_events();\n\t\tevents.sort(function(a,b){ return a.start_date>b.start_date?1:-1;});\n\n\t\tvar tableAttr = scheduler._waiAria.agendaDataAttrString();\n\t\tvar agendaEventAttrString;\n\t\t//generate html for the view\n\t\tvar html=\"<div class='dhx_agenda_area' \"+tableAttr+\">\";\n\t\tfor (var i=0; i<events.length; i++){\n\t\t\tvar ev = events[i];\n\t\t\tvar bg_color = (ev.color?(\"--dhx-scheduler-event-background:\"+ev.color+\";\"):\"\");\n\t\t\tvar color = (ev.textColor?(\"--dhx-scheduler-event-color:\"+ev.textColor+\";\"):\"\");\n\t\t\tvar ev_class = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\n\n\t\t\tagendaEventAttrString = scheduler._waiAria.agendaEventAttrString(ev);\n\t\t\tvar agendaDetailsButtonAttr = scheduler._waiAria.agendaDetailsBtnString();\n\n\t\t\thtml+=\"<div \"+agendaEventAttrString+\" class='dhx_agenda_line\"+(ev_class?' '+ev_class:'')+\n\t\t\t\t\t\"' event_id='\"+ev.id+\"' \"+scheduler.config.event_attribute+\"='\"+ev.id+\"' style='\"+color+\"\"+bg_color+\"\"+\n\t\t\t\t\t(ev._text_style||\"\")+\"'><div class='dhx_agenda_event_time'>\"+\n\t\t\t\t\t(scheduler.config.rtl ? scheduler.templates.agenda_time(ev.end_date,ev.start_date, ev):scheduler.templates.agenda_time(ev.start_date, ev.end_date,ev))+\n\t\t\t\t\t\"</div>\";\n\t\t\thtml+=`<div ${agendaDetailsButtonAttr} class='dhx_event_icon icon_details'><svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t<path d=\"M15.4444 16.4H4.55556V7.6H15.4444V16.4ZM13.1111 2V3.6H6.88889V2H5.33333V3.6H4.55556C3.69222 3.6 3 4.312 3 5.2V16.4C3 16.8243 3.16389 17.2313 3.45561 17.5314C3.74733 17.8314 4.143 18 4.55556 18H15.4444C15.857 18 16.2527 17.8314 16.5444 17.5314C16.8361 17.2313 17 16.8243 17 16.4V5.2C17 4.312 16.3 3.6 15.4444 3.6H14.6667V2H13.1111ZM13.8889 10.8H10V14.8H13.8889V10.8Z\" fill=\"#A1A4A6\"/>\n\t\t\t</svg></div>`;\n\t\t\thtml+=\"<span>\"+scheduler.templates.agenda_text(ev.start_date, ev.end_date, ev)+\"</span></div>\";\n\t\t}\n\t\thtml+=\"<div class='dhx_v_border'></div></div>\";\n\n\t\t//render html\n\t\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = html;\n\t\tscheduler._els[\"dhx_cal_data\"][0].childNodes[0].scrollTop = scheduler._agendaScrollTop||0;\n\n\t\t// setting up dhx_v_border size\n\t\tvar agenda_area = scheduler._els[\"dhx_cal_data\"][0].childNodes[0];\n\t\tvar v_border = agenda_area.childNodes[agenda_area.childNodes.length-1];\n\t\tv_border.style.height = (agenda_area.offsetHeight < scheduler._els[\"dhx_cal_data\"][0].offsetHeight) ? \"100%\" : (agenda_area.offsetHeight+\"px\");\n\n\t\tvar t=scheduler._els[\"dhx_cal_data\"][0].firstChild.childNodes;\n\n\t\tvar dateElement = scheduler._getNavDateElement();\n\t\tif(dateElement){\n\t\t\tdateElement.innerHTML=scheduler.templates.agenda_date(scheduler._min_date, scheduler._max_date, scheduler._mode);\n\t\t}\n\n\t\tscheduler._rendered=[];\n\t\tfor (var i=0; i < t.length-1; i++)\n\t\t\tscheduler._rendered[i]=t[i];\n\n\t}\n\n\tscheduler.agenda_legacy_view=function(mode){\n\t\tscheduler._min_date = scheduler.config.agenda_start||scheduler.date.agenda_legacy_start(scheduler._date);\n\t\tscheduler._max_date = scheduler.config.agenda_end||scheduler.date.add_agenda_legacy(scheduler._min_date, 1);\n\n\t\tset_full_view(mode);\n\t\tif (mode){\n\t\t\tscheduler._cols = null;\n\t\t\tscheduler._colsS = null;\n\t\t\tscheduler._table_view = true;\n\t\t\t//agenda tab activated\n\t\t\tfill_agenda_tab();\n\t\t} else {\n\t\t\tscheduler._table_view = false;\n\t\t\t//agenda tab de-activated\n\t\t}\n\t};\n});\n\n\n}","export default function(scheduler){\n\n\tscheduler.date.add_agenda = function(date, inc){\n\t\treturn scheduler.date.add(date, 1*inc, \"month\");\n\t};\n\t\n\tscheduler.templates.agenda_time = function(start,end,ev){\n\t\tif (ev._timed){\n\t\t\treturn `${this.event_date(start)} - ${this.event_date(end)}`;\n\t\t}else{\n\t\t\treturn scheduler.locale.labels.full_day;\n\t\t}\n\t};\n\tscheduler.templates.agenda_text = function(start,end,ev){\n\t\treturn ev.text;\n\t};\n\n\tconst dayDateToStr = scheduler.date.date_to_str(\"%F %j\");\n\tconst dayDowToStr = scheduler.date.date_to_str(\"%l\");\n\n\tscheduler.templates.agenda_day = function(date){ \n\t\treturn `<div class=\"dhx_agenda_day_date\">${dayDateToStr(date)}</div>\n\t\t<div class=\"dhx_agenda_day_dow\">${dayDowToStr(date)}</div>`;\n\t};\n\tscheduler.templates.agenda_date = function(start, end){ \n\t\treturn scheduler.templates.month_date(scheduler.getState().date); \n\t};\n\t\n\tscheduler.date.agenda_start=function(date){\n\t\treturn scheduler.date.month_start(new Date(date));\n\t};\n\n\tlet scrollTop = 0;\n\t\n\tscheduler.attachEvent(\"onTemplatesReady\",function() {\n\t\tvar old_dblclick_dhx_cal_data = scheduler.dblclick_dhx_cal_data;\n\t\tscheduler.dblclick_dhx_cal_data = function() {\n\t\t\tif (this._mode == \"agenda\") {\n\t\t\t\tif (!this.config.readonly && this.config.dblclick_create)\n\t\t\t\t\tthis.addEventNow();\n\t\t\t} else {\n\t\t\t\tif (old_dblclick_dhx_cal_data)\n\t\t\t\t\treturn old_dblclick_dhx_cal_data.apply(this, arguments);\n\t\t\t}\n\t\t};\n\t\n\t\n\t\tvar old = scheduler.render_data;\n\t\tscheduler.render_data=function(evs){\n\t\t\tif (this._mode == \"agenda\")\n\t\t\t\tfill_agenda_tab();\n\t\t\telse\n\t\t\t\treturn old.apply(this,arguments);\n\t\t};\n\t\n\t\tvar old_render_view_data = scheduler.render_view_data;\n\t\tscheduler.render_view_data = function(){\n\t\t\tif(this._mode == \"agenda\") {\n\t\t\t\tscrollTop = scheduler._els[\"dhx_cal_data\"][0].scrollTop;\n\t\t\t\tscheduler._els[\"dhx_cal_data\"][0].scrollTop = 0;\n\t\t\t}\n\t\t\treturn old_render_view_data.apply(this,arguments);\n\t\t};\n\n\t\tfunction fill_agenda_tab(){\n\t\t\tconst events = scheduler.get_visible_events();\n\t\t\tevents.sort(function(a,b){ return a.start_date>b.start_date?1:-1;});\n\n\t\t\tconst eventsInDays = {};\n\t\t\tlet currDate = scheduler.getState().min_date;\n\t\t\tconst maxDate = scheduler.getState().max_date;\n\t\t\twhile(currDate.valueOf() < maxDate.valueOf()){\n\t\t\t\teventsInDays[currDate.valueOf()] = [];\n\t\t\t\tcurrDate = scheduler.date.add(currDate, 1, \"day\");\n\t\t\t}\n\n\t\t\tlet anyEvents = false;\n\n\t\t\tevents.forEach((ev) => {\n\t\t\t\tlet eventStart = scheduler.date.day_start(new Date(ev.start_date)); \n\t\t\t\twhile (eventStart.valueOf() < ev.end_date.valueOf()) {\n\t\t\t\t\tif (eventsInDays[eventStart.valueOf()]) {\n\t\t\t\t\t\teventsInDays[eventStart.valueOf()].push(ev);\n\t\t\t\t\t\tanyEvents = true;\n\t\t\t\t\t}\n\t\t\t\t\teventStart = scheduler.date.day_start(scheduler.date.add(eventStart, 1, \"day\"));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(!anyEvents){\n\t\t\t\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = renderEmptyView();\n\t\t\t}else{\n\t\t\t\tlet html = \"\";\n\t\t\t\tfor(let day in eventsInDays){\n\t\t\t\t\tif(scheduler.ignore_agenda && scheduler.ignore_agenda(new Date(day*1))){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\thtml += renderDay(new Date(day*1), eventsInDays[day]);\n\t\t\t\t}\n\n\t\t\t\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = html;\n\t\t\t}\n\n\t\t\tscheduler._els[\"dhx_cal_data\"][0].scrollTop = scrollTop;\n\t\t\t\n\t\t\tlet t = scheduler._els[\"dhx_cal_data\"][0].querySelectorAll(\".dhx_cal_agenda_event_line\");\n\t\t\tscheduler._rendered = [];\n\t\t\tfor (var i = 0; i < t.length - 1; i++) {\n\t\t\t\tscheduler._rendered[i] = t[i];\n\t\t\t}\n\t\t}\n\n\t\n\n\t\tfunction renderEmptyView(){\n\t\t\treturn `<div class=\"dhx_cal_agenda_no_events\">${scheduler.locale.labels.agenda_tab}</div>`;\n\t\t}\n\n\t\tfunction renderDay(day, events) {\n\t\t\tif(!events.length){\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\tlet html = `\n<div class=\"dhx_cal_agenda_day\" data-date=\"${scheduler.templates.format_date(day)}\" data-day=\"${day.getDay()}\">\n\t<div class=\"dhx_cal_agenda_day_header\">${scheduler.templates.agenda_day(day)}</div>\n\t<div class=\"dhx_cal_agenda_day_events\">\n`;\n\n\t\t\tevents.forEach((calendarEvent) => {\n\t\t\t\thtml += renderOneEvent(day, calendarEvent);\n\t\t\t});\n\n\t\t\thtml += `</div></div>`;\n\t\t\treturn html;\n\t\t}\n\n\t\tfunction renderOneEvent(day, calendarEvent){\n\t\t\tconst dates = scheduler.templates.agenda_time(calendarEvent.start_date, calendarEvent.end_date, calendarEvent);\n\t\t\tconst selectedId = scheduler.getState().select_id;\n\t\t\tconst cls = scheduler.templates.event_class(calendarEvent.start_date, calendarEvent.end_date, calendarEvent);\n\t\t\tconst description = scheduler.templates.agenda_text(calendarEvent.start_date, calendarEvent.end_date, calendarEvent);\n\n\t\t\tlet style = \"\";\n\t\t\tif(calendarEvent.color || calendarEvent.textColor){\n\t\t\t\tconst bg = (calendarEvent.color ? (\"--dhx-scheduler-event-background:\" + calendarEvent.color + \";\") : \"\");\n\t\t\t\tconst color = (calendarEvent.textColor ? (\"--dhx-scheduler-event-color:\" + calendarEvent.textColor + \";\") : \"\");\n\t\t\t\tstyle = ` style=\"${bg}${color}\" `;\n\t\t\t}\n\n\t\t\treturn `<div class=\"dhx_cal_agenda_event_line ${cls||\"\"} ${calendarEvent.id == selectedId ? \"dhx_cal_agenda_event_line_selected\" : \"\"}\" ${style} ${scheduler.config.event_attribute}=\"${calendarEvent.id}\">\n\t<div class=\"dhx_cal_agenda_event_line_marker\"></div>\n\t<div class=\"dhx_cal_agenda_event_line_time\">${dates}</div>\n\t<div class=\"dhx_cal_agenda_event_line_text\">${description}</div>\n</div>`;\n\t\t}\n\t\n\t\tscheduler.agenda_view=function(mode){\n\t\t\tif (mode){\n\t\t\t\tscheduler._min_date = scheduler.config.agenda_start || scheduler.date.agenda_start(scheduler._date);\n\t\t\t\tscheduler._max_date = scheduler.config.agenda_end || scheduler.date.add_agenda(scheduler._min_date, 1);\n\t\t\t\tscheduler._cols = null;\n\t\t\t\tscheduler._colsS = null;\n\t\t\t\tscheduler._table_view = true;\n\n\t\t\t\tconst dateHeader = scheduler._getNavDateElement();\n\t\t\t\tdateHeader.innerHTML = scheduler.templates.agenda_date(scheduler._date);\n\t\t\t\t//agenda tab activated\n\t\t\t\tfill_agenda_tab();\n\t\t\t} else {\n\t\t\t\tscheduler._table_view = false;\n\t\t\t\t//agenda tab de-activated\n\t\t\t}\n\t\t};\n\t});\n\n\t// scheduler.attachEvent(\"onEventSelected\", function(id){\n\t// \tconst oldSelected = scheduler.$container.querySelectorAll(\".dhx_cal_agenda_event_line_selected\");\n\t// \toldSelected.forEach((el) => {\n\t// \t\tel.classList.remove(\"dhx_cal_agenda_event_line_selected\");\n\t// \t});\n\n\t// \tconst selected = scheduler.$container.querySelector(`[${scheduler.config.event_attribute}=\"${id}\"]`);\n\t// \tif(selected){\n\t// \t\tselected.classList.add(\"dhx_cal_agenda_event_line_selected\");\n\t// \t}\n\t// });\n\t\n\t\n}","export default function(scheduler){\n\n\tscheduler.config.all_timed = \"short\";\n\tscheduler.config.all_timed_month = false;\n\n\tscheduler.ext.allTimed = {\n\t\tisMainAreaEvent: function(ev){\n\t\t\treturn !!(ev._timed || scheduler.config.all_timed === true || (scheduler.config.all_timed == \"short\" && is_event_short(ev)) );\n\t\t}\n\t};\n\n\tvar is_event_short = function (ev) {\n\t\tif(!((ev.end_date - ev.start_date)/(1000*60*60) >= 24)){\n\t\t\treturn true;\n\t\t}\n\n\t\t// short event shouldn't disappear to multiday area during dnd-resize\n\t\tif(scheduler._drag_mode == \"resize\" && scheduler._drag_id == ev.id){\n\t\t\treturn true;\n\t\t}\n\t\treturn \tfalse;\n\t};\n\n\t// copy of usual events and recurring instances;\n\t// regular copy causes problems with recurrings which have series event as a prototype\n\tscheduler._safe_copy = function(event){\n\t\tvar proto = null,\n\t\t\tcopy = scheduler._copy_event(event);\n\t\tif(event.event_pid){\n\t\t\tproto = scheduler.getEvent(event.event_pid);\n\t\t}\n\n\t\tif (proto && proto.isPrototypeOf(event)) {\n\t\t\tdelete copy.event_length;\n\t\t\tdelete copy.event_pid;\n\t\t\tdelete copy.rec_pattern;\n\t\t\tdelete copy.rec_type;\n\t\t}\n\n\t\treturn copy;\n\t};\n\n\tvar old_prerender_events_line = scheduler._pre_render_events_line;\n\tvar old_prerender_events_table = scheduler._pre_render_events_table;\n\n\tvar prerender_events = function (evs, hold) {\n\t\tif (!this._table_view) {\n\t\t\treturn old_prerender_events_line.call(this, evs, hold);\n\t\t}\n\n\t\treturn old_prerender_events_table.call(this, evs, hold);\n\t};\n\n\tscheduler._pre_render_events_line = scheduler._pre_render_events_table = function(evs, hold){\n\t\tif (!this.config.all_timed ||\n\t\t\t(this._table_view && this._mode != \"month\") ||\n\t\t\t(this._mode == \"month\" && !this.config.all_timed_month))\n\t\t\treturn prerender_events.call(this, evs, hold);\n\n\t\tfor (var i=0; i < evs.length; i++) {\n\t\t\tvar ev=evs[i];\n\n\t\t\tif (ev._timed)\n\t\t\t\tcontinue;\n\n\t\t\tif (this.config.all_timed == \"short\") {\n\t\t\t\tif (!is_event_short(ev)) {\n\t\t\t\t\tif (this._mode != \"month\") {\n\t\t\t\t\t\tevs.splice(i--, 1);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar ce = this._safe_copy(ev); // current event (event for one specific day) is copy of original with modified dates\n\t\t\tif(!ev._virtual){\n\t\t\t\tce._first_chunk = true;\n\t\t\t}else{\n\t\t\t\tce._first_chunk = false;\n\t\t\t}\n\t\t\tce._drag_resize = false;\n\t\t\tce._virtual = true;\n\t\t\tce.start_date = new Date(ce.start_date); // as lame copy doesn't copy date objects\n\n\t\t\tif (!isOvernightEvent(ev)) {\n\t\t\t\tce.end_date = new Date(ev.end_date);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tce.end_date = getNextDay(ce.start_date);\n\t\t\t\tif (this.config.last_hour != 24) { // if specific last_hour was set (e.g. 20)\n\t\t\t\t\tce.end_date = setDateTime(ce.start_date, this.config.last_hour);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar event_changed = false;\n\t\t\tif (ce.start_date < this._max_date && ce.end_date > this._min_date && ce.start_date < ce.end_date) {\n\t\t\t\tevs[i] = ce; // adding another event in collection\n\t\t\t\tevent_changed = true;\n\t\t\t}\n\t\t//\tif (ce.start_date > ce.end_date) {\n\t\t//\t\tevs.splice(i--,1);\n\t\t//\t}\n\n\t\t\tvar re = this._safe_copy(ev); // remaining event, copy of original with modified start_date (making range more narrow)\n\t\t\tre._virtual = true;\n\t\t\tre.end_date = new Date(re.end_date);\n\t\t\tif (re.start_date < this._min_date)\n\t\t\t\tre.start_date = setDateTime(this._min_date, this.config.first_hour);// as we are starting only with whole hours\n\t\t\telse\n\t\t\t\tre.start_date = setDateTime(getNextDay(ev.start_date), this.config.first_hour);\n\n\t\t\tif (re.start_date < this._max_date && re.start_date < re.end_date) {\n\t\t\t\tif (event_changed){\n\t\t\t\t\tevs.splice(i+1,0,re);//insert part\n\t\t\t\t}else {\n\t\t\t\t\tevs[i--] = re;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tre._last_chunk = false;\n\t\t\t}else{\n\t\t\t\tce._last_chunk = true;\n\t\t\t\tce._drag_resize = true;\n\t\t\t}\n\n\t\t}\n\t\t// in case of all_timed pre_render is not applied to the original event\n\t\t// so we need to force redraw in case of dnd\n\t\tvar redraw = (this._drag_mode == 'move')?false:hold;\n\t\treturn prerender_events.call(this, evs, redraw);\n\n\n\t\tfunction isOvernightEvent(ev){\n\t\t\tvar next_day = getNextDay(ev.start_date);\n\t\t\treturn (+ev.end_date > +next_day);\n\t\t}\n\t\tfunction getNextDay(date){\n\t\t\tvar next_day = scheduler.date.add(date, 1, \"day\");\n\t\t\tnext_day = scheduler.date.date_part(next_day);\n\t\t\treturn next_day;\n\t\t}\n\t\tfunction setDateTime(date, hours){\n\t\t\tvar val = scheduler.date.date_part(new Date(date));\n\t\t\tval.setHours(hours);\n\t\t\treturn val;\n\t\t}\n\t};\n\tvar old_get_visible_events = scheduler.get_visible_events;\n\tscheduler.get_visible_events = function(only_timed){\n\t\tif (!(this.config.all_timed && this.config.multi_day))\n\t\t\treturn old_get_visible_events.call(this, only_timed);\n\t\treturn old_get_visible_events.call(this, false); // only timed = false\n\t};\n\tscheduler.attachEvent(\"onBeforeViewChange\", function (old_mode, old_date, mode, date) {\n\t\tscheduler._allow_dnd = (mode == \"day\" || mode == \"week\" || scheduler.getView(mode));\n\t\treturn true;\n\t});\n\n\tscheduler._is_main_area_event = function(ev){\n\t\treturn scheduler.ext.allTimed.isMainAreaEvent(ev);\n\t};\n\n\tvar oldUpdate = scheduler.updateEvent;\n\tscheduler.updateEvent = function(id){\n\t\t// full redraw(update_render=true) messes events order while dnd.\n\t\t// individual redraw(update_render=false) of multiday event, which happens on select/unselect, expands event to full width of the cell and can be fixes only with full redraw.\n\t\t// so for now full redraw is always enabled for not-dnd updates\n\t\tvar ev = scheduler.getEvent(id);\n\t\tvar fullRedrawNeeded;\n\t\tvar initial;\n\t\tif(ev) {\n\t\t\tfullRedrawNeeded = (scheduler.config.all_timed && !(scheduler.isOneDayEvent(scheduler._events[id]) || scheduler.getState().drag_id));\n\t\t\tif (fullRedrawNeeded) {\n\t\t\t\tinitial = scheduler.config.update_render;\n\t\t\t\tscheduler.config.update_render = true;\n\t\t\t}\n\t\t}\n\t\toldUpdate.apply(scheduler, arguments);\n\n\t\tif(ev) {\n\t\t\tif (fullRedrawNeeded) {\n\t\t\t\tscheduler.config.update_render = initial;\n\t\t\t}\n\t\t}\n\t};\n\n}","export default function(scheduler){\n\nlet temp_section;\nlet before;\n\nscheduler.config.collision_limit = 1;\n\nfunction _setTempSection(event_id) { // for custom views (matrix, timeline, units)\n\tconst checked_mode = scheduler._get_section_view();\n\tif(checked_mode && event_id){\n\t\ttemp_section = scheduler.getEvent(event_id)[scheduler._get_section_property()];\n\t}\n}\n\nscheduler.attachEvent(\"onBeforeDrag\",function(id){\n\t_setTempSection(id);\n\treturn true;\n});\nscheduler.attachEvent(\"onBeforeLightbox\",function(id){\n\tconst ev = scheduler.getEvent(id);\n\tbefore = [ev.start_date, ev.end_date];\n\t_setTempSection(id);\n\treturn true;\n});\nscheduler.attachEvent(\"onEventChanged\",function(id){\n\tif (!id || !scheduler.getEvent(id)) return true;\n\tconst ev = scheduler.getEvent(id);\n\tif (!scheduler.checkCollision(ev)){\n\t\tif (!before) return false;\n\t\tev.start_date = before[0];\n\t\tev.end_date = before[1];\n\t\tev._timed=this.isOneDayEvent(ev);\n\t}\n\treturn true;\n});\nscheduler.attachEvent(\"onBeforeEventChanged\",function(ev,e,is_new){\n\treturn scheduler.checkCollision(ev);\n});\nscheduler.attachEvent(\"onEventAdded\",function(id,ev) {\n\tconst result = scheduler.checkCollision(ev);\n\tif (!result)\n\t\tscheduler.deleteEvent(id);\n});\nscheduler.attachEvent(\"onEventSave\",function(id, edited_ev, is_new){\n\tedited_ev = scheduler._lame_clone(edited_ev);\n\tedited_ev.id = id;\n\n\t//lightbox may not have 'time' section\n\tif(!(edited_ev.start_date && edited_ev.end_date)){\n\t\tconst ev = scheduler.getEvent(id);\n\t\tedited_ev.start_date = new Date(ev.start_date);\n\t\tedited_ev.end_date = new Date(ev.end_date);\n\t}\n\n\tif((edited_ev.rrule && !edited_ev.recurring_event_id) || edited_ev.rec_type){\n\t\tscheduler._roll_back_dates(edited_ev);\n\t}\n\treturn scheduler.checkCollision(edited_ev); // in case user creates event on one date but then edited it another\n});\n\nscheduler._check_sections_collision = function(first, second){\n\tconst map_to = scheduler._get_section_property();\n\tif (first[map_to] == second[map_to] && first.id != second.id)\n\t\treturn true;\n\treturn false;\n};\n\nscheduler.checkCollision = function(ev) {\n\tlet evs = [];\n\tconst collision_limit = scheduler.config.collision_limit;\n\n\tif (ev.rec_type) {\n\t\tlet evs_dates = scheduler.getRecDates(ev);\n\t\tfor (let k = 0; k < evs_dates.length; k++) {\n\t\t\tlet tevs = scheduler.getEvents(evs_dates[k].start_date,evs_dates[k].end_date);\n\t\t\tfor (let j = 0; j < tevs.length; j++) {\n\t\t\t\tif ((tevs[j].event_pid || tevs[j].id) != ev.id)\n\t\t\t\t\tevs.push(tevs[j]);\n\t\t\t}\n\t\t}\n\t} else if (ev.rrule) {\n\t\tlet evs_dates = scheduler.getRecDates(ev);\n\t\tfor (let k = 0; k < evs_dates.length; k++) {\n\t\t\tlet tevs = scheduler.getEvents(evs_dates[k].start_date,evs_dates[k].end_date);\n\t\t\tfor (let j = 0; j < tevs.length; j++) {\n\t\t\t\tif ((String(tevs[j].id).split(\"#\")[0] || tevs[j].id) != ev.id)\n\t\t\t\t\tevs.push(tevs[j]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tevs = scheduler.getEvents(ev.start_date, ev.end_date);\n\t\tfor (let i = 0; i < evs.length; i++) {\n\t\t\tlet concurrent = evs[i];\n\t\t\t// for recurring legacy\n\t\t\tif (concurrent.id == ev.id || (concurrent.event_length && [concurrent.event_pid, concurrent.event_length].join(\"#\") == ev.id)) {\n\t\t\t\tevs.splice(i,1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//for recurring rrule\n\t\t\tif (concurrent.recurring_event_id && [concurrent.recurring_event_id, concurrent._pid_time].join(\"#\") == ev.id) {\n\t\t\t\tevs.splice(i,1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tconst checked_mode = scheduler._get_section_view();\n\tconst map_to = scheduler._get_section_property();\n\n\tlet single = true;\n\tif (checked_mode) { // custom view\n\t\tlet count = 0;\n\n\t\tfor (let i = 0; i < evs.length; i++){\n\t\t\tif (evs[i].id != ev.id && this._check_sections_collision(evs[i], ev))\n\t\t\t\tcount++;\n\t\t}\n\n\t\tif (count >= collision_limit) {\n\n\t\t\tsingle = false;\n\t\t}\n\t}\n\telse {\n\t\tif ( evs.length >= collision_limit )\n\t\t\tsingle = false;\n\t}\n\tif (!single) {\n\t\tlet res = !scheduler.callEvent(\"onEventCollision\",[ev,evs]);\n\t\tif (!res) {\n\t\t\tev[map_to] = temp_section||ev[map_to]; // from _setTempSection for custom views\n\t\t}\n\t\treturn res;\n\t}\n\treturn single;\n\n};\n\n}","export default function(scheduler){\n\n\tscheduler.config.container_autoresize = true;\n\tscheduler.config.month_day_min_height = 90;\n\tscheduler.config.min_grid_size = 25;\n\tscheduler.config.min_map_size = 400;\n\n\tvar old_pre_render_event = scheduler._pre_render_events;\n\n\t//need for temporary disabling without modifying public config\n\tvar active = true;\n\tvar total_height = 0;\n\tvar multiday_height = 0;\n\n\tscheduler._pre_render_events = function(evs, hold) {\n\t\tif (!(scheduler.config.container_autoresize && active)) {\n\t\t\treturn old_pre_render_event.apply(this, arguments);\n\t\t}\n\n\t\tvar hb = this.xy.bar_height;\n\t\tvar h_old = this._colsS.heights;\n\t\tvar h = this._colsS.heights = [0, 0, 0, 0, 0, 0, 0];\n\t\tvar data = this._els[\"dhx_cal_data\"][0];\n\n\t\tif (!this._table_view)\n\t\t\tevs = this._pre_render_events_line(evs, hold); //ignore long events for now\n\t\telse\n\t\t\tevs = this._pre_render_events_table(evs, hold);\n\n\t\tif (this._table_view) {\n\t\t\tif (hold){\n\t\t\t\tthis._colsS.heights = h_old;\n\t\t\t} else {\n\t\t\t\tvar evl = data.firstChild;\n\t\t\t\tconst rows = evl.querySelectorAll(\".dhx_cal_month_row\");\n\t\t\t\tif (rows && rows.length) {\n\t\t\t\t\tfor (var i = 0; i < rows.length; i++) {\n\t\t\t\t\t\th[i]++;\n\n\t\t\t\t\t\tif ((h[i]) * hb > this._colsS.height - this.xy.month_head_height) { // 22 - height of cell's header\n\t\t\t\t\t\t\t//we have overflow, update heights\n\t\t\t\t\t\t\tvar cells = rows[i].querySelectorAll(\".dhx_cal_month_cell\");\n\n\t\t\t\t\t\t\tvar cHeight = this._colsS.height - this.xy.month_head_height;\n\t\t\t\t\t\t\tif(this.config.max_month_events*1 !== this.config.max_month_events || h[i] <= this.config.max_month_events){\n\t\t\t\t\t\t\t\tcHeight = h[i] * hb;\n\t\t\t\t\t\t\t}else if( (this.config.max_month_events + 1) * hb > this._colsS.height - this.xy.month_head_height){\n\t\t\t\t\t\t\t\tcHeight = (this.config.max_month_events + 1) * hb;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trows[i].style.height = (cHeight + this.xy.month_head_height) + \"px\";\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\tfor (var j = 0; j < cells.length; j++) {\n\t\t\t\t\t\t\t\tcells[j].childNodes[1].style.height = cHeight + \"px\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\th[i] = (h[i - 1] || 0) + cells[0].offsetHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\th[i] = (h[i - 1] || 0) + rows[i].querySelectorAll(\".dhx_cal_month_cell\")[0].offsetHeight;\n\t\t\t\t\t}\n\t\t\t\t\th.unshift(0);\n\t\t\t\t\tif (evl.parentNode.offsetHeight < evl.parentNode.scrollHeight && !evl._h_fix) {\n\t\t\t\t\t\t//we have v-scroll, decrease last day cell\n\n\t\t\t\t\t\t// NO CHECK SHOULD BE MADE ON VERTICAL SCROLL\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!evs.length && this._els[\"dhx_multi_day\"][0].style.visibility == \"visible\")\n\t\t\t\t\t\th[0] = -1;\n\t\t\t\t\tif (evs.length || h[0] == -1) {\n\t\t\t\t\t\t//shift days to have space for multiday events\n\t\t\t\t\t\t//var childs = evl.parentNode.childNodes;\n\t\t\t\t\t\tvar dh = ((h[0] + 1) * hb + 1); // +1 so multiday events would have 2px from top and 2px from bottom by default\n\t\t\t\t\t\tif(multiday_height != dh + 1) {\n\t\t\t\t\t\t\tthis._obj.style.height = (total_height - multiday_height + dh - 1) + \"px\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdh += \"px\";\n\t\t\t\t\t\tconst navHeight = this._els[\"dhx_cal_navline\"][0].offsetHeight;\n\t\t\t\t\t\tconst headerHeight =  this._els[\"dhx_cal_header\"][0].offsetHeight;\n\t\t\t\t\t\tdata.style.height = (this._obj.offsetHeight - navHeight - headerHeight - (this.xy.margin_top || 0)) + 'px';\n\t\t\t\t\t\tvar last = this._els[\"dhx_multi_day\"][0];\n\t\t\t\t\t\tlast.style.height = dh;\n\t\t\t\t\t\tlast.style.visibility = (h[0] == -1 ? \"hidden\" : \"visible\");\n\t\t\t\t\t\tlast.style.display = (h[0] == -1 ? \"none\" : \"\");\n\t\t\t\t\t\tlast = this._els[\"dhx_multi_day\"][1];\n\t\t\t\t\t\tlast.style.height = dh;\n\t\t\t\t\t\tlast.style.visibility = (h[0] == -1 ? \"hidden\" : \"visible\");\n\t\t\t\t\t\tlast.style.display = (h[0] == -1 ? \"none\" : \"\");\n\n\t\t\t\t\t\tlast.className = h[0] ? \"dhx_multi_day_icon\" : \"dhx_multi_day_icon_small\";\n\t\t\t\t\t\tthis._dy_shift = (h[0] + 1) * hb;\n\t\t\t\t\t\th[0] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn evs;\n\t};\n\n\tvar checked_divs = [\"dhx_cal_navline\", \"dhx_cal_header\", \"dhx_multi_day\", \"dhx_cal_data\"];\n\tvar updateContainterHeight = function(is_repaint) {\n\t\ttotal_height = 0;\n\t\tfor (var i = 0; i < checked_divs.length; i++) {\n\n\t\t\tvar className = checked_divs[i];\n\t\t\tvar checked_div = (scheduler._els[className]) ? scheduler._els[className][0] : null;\n\t\t\tvar height = 0;\n\t\t\tswitch (className) {\n\t\t\t\tcase \"dhx_cal_navline\":\n\t\t\t\tcase \"dhx_cal_header\":\n\t\t\t\t\theight = checked_div.offsetHeight;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"dhx_multi_day\":\n\t\t\t\t\theight = (checked_div) ? checked_div.offsetHeight - 1 : 0;\n\t\t\t\t\tmultiday_height = height;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"dhx_cal_data\":\n\t\t\t\t\tvar mode = scheduler.getState().mode;\n\n\t\t\t\t\tif(checked_div.childNodes[1] && mode != \"month\") {\n\t\t\t\t\t\tlet maxHeight = 0;\n\t\t\t\t\t\tfor(let i = 0; i < checked_div.childNodes.length; i++){\n\t\t\t\t\t\t\tif(checked_div.childNodes[i].offsetHeight > maxHeight){\n\t\t\t\t\t\t\t\tmaxHeight = checked_div.childNodes[i].offsetHeight;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\theight = maxHeight;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\theight = Math.max(checked_div.offsetHeight - 1, checked_div.scrollHeight);\n\t\t\t\t\t}\n\t\t\t\t\tif (mode == \"month\") {\n\t\t\t\t\t\tif (scheduler.config.month_day_min_height && !is_repaint) {\n\t\t\t\t\t\t\tvar rows_length = checked_div.querySelectorAll(\".dhx_cal_month_row\").length;\n\t\t\t\t\t\t\theight = rows_length * scheduler.config.month_day_min_height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (is_repaint) {\n\t\t\t\t\t\t\tchecked_div.style.height = height + \"px\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (mode == \"year\"){\n\t\t\t\t\t\theight = 190 * scheduler.config.year_y;\n\t\t\t\t\t}\n\t\t\t\t\telse if(mode == \"agenda\"){\n\t\t\t\t\t\theight = 0;\n\t\t\t\t\t\t// GS-2790: if there is no events the height should have the default value\n\t\t\t\t\t\tif(checked_div.children && checked_div.children.length){\n\t\t\t\t\t\t\tif(checked_div.children.length === 1 && checked_div.children[0].classList.contains(\"dhx_cal_agenda_no_events\")){\n\t\t\t\t\t\t\t\theight = 300;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor(var j = 0; j < checked_div.children.length; j++){\n\t\t\t\t\t\t\t\t\theight += checked_div.children[j].offsetHeight;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(height + 2 < scheduler.config.min_grid_size){\n\t\t\t\t\t\t\theight = scheduler.config.min_grid_size;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\theight += 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (mode == \"week_agenda\"){\n\t\t\t\t\t\tvar min_height = scheduler.xy.week_agenda_scale_height + scheduler.config.min_grid_size,\n\t\t\t\t\t\t\tcur_height;\n\n\t\t\t\t\t\tvar column;\n\t\t\t\t\t\tfor(var k = 0; k < checked_div.childNodes.length; k++){\n\t\t\t\t\t\t\tcolumn = checked_div.childNodes[k];\n\t\t\t\t\t\t\tfor(var j = 0; j < column.childNodes.length; j++) {\n\t\t\t\t\t\t\t\tvar innerHeight = 0,\n\t\t\t\t\t\t\t\t\teventsContainer = column.childNodes[j].childNodes[1];\n\n\t\t\t\t\t\t\t\tfor(var g =0; g < eventsContainer.childNodes.length; g++){\n\t\t\t\t\t\t\t\t\tinnerHeight += eventsContainer.childNodes[g].offsetHeight;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tcur_height = innerHeight + scheduler.xy.week_agenda_scale_height;\n\t\t\t\t\t\t\t\tcur_height = (k == 1 && (j == 2 || j == 3)) ? cur_height * 2 : cur_height; // for last two cells;\n\n\t\t\t\t\t\t\t\tif (cur_height > min_height) {\n\t\t\t\t\t\t\t\t\tmin_height = cur_height;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\theight = min_height * 3;\n\t\t\t\t\t}\n\t\t\t\t\telse if(mode == \"map\") {\n\t\t\t\t\t\theight = 0;\n\t\t\t\t\t\tvar evs = checked_div.querySelectorAll(\".dhx_map_line\");\n\n\t\t\t\t\t\tfor (var j = 0; j < evs.length; j++) {\n\t\t\t\t\t\t\theight += evs[j].offsetHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (height + 2 < scheduler.config.min_map_size) {\n\t\t\t\t\t\t\theight = scheduler.config.min_map_size;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\theight += 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if(scheduler._gridView) {\n\t\t\t\t\t\theight = 0;\n\n\t\t\t\t\t\tif (checked_div.childNodes[1].childNodes[0].childNodes && checked_div.childNodes[1].childNodes[0].childNodes.length) {\n\t\t\t\t\t\t\tvar evs = checked_div.childNodes[1].childNodes[0].childNodes[0].childNodes;\n\n\t\t\t\t\t\t\tfor (var j = 0; j < evs.length; j++) {\n\t\t\t\t\t\t\t\theight += evs[j].offsetHeight;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\theight += 2;\n\n\t\t\t\t\t\t\tif(height < scheduler.config.min_grid_size){\n\t\t\t\t\t\t\t\theight = scheduler.config.min_grid_size;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\theight = scheduler.config.min_grid_size;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (scheduler.matrix && scheduler.matrix[mode]) {\n\t\t\t\t\t\tif (is_repaint) {\n\t\t\t\t\t\t\theight += 0;\n\t\t\t\t\t\t\tchecked_div.style.height = height + \"px\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\theight = 0;\n\t\t\t\t\t\t\tvar cfg = scheduler.matrix[mode];\n\t\t\t\t\t\t\tvar rows = cfg.y_unit;\n\t\t\t\t\t\t\tfor(var r=0; r < rows.length; r++){\n\t\t\t\t\t\t\t\theight += cfg.getSectionHeight(rows[r].key);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Check and add extra height to avoid events hiding by the horizontal scrollbar\n\t\t\t\t\t\t\tif(scheduler.$container.clientWidth != scheduler.$container.scrollWidth){\n\t\t\t\t\t\t\t\theight += getScrollSize();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\theight -= 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (mode == \"day\" || mode == \"week\" || (scheduler._props && scheduler._props[mode])) {\n\t\t\t\t\t\theight += 2;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\theight += 1;\n\t\t\ttotal_height += height;\n\t\t}\n\t\tscheduler._obj.style.height = (total_height) + \"px\";\n\n\t\tif (!is_repaint)\n\t\t\tscheduler.updateView();\n\t};\n\n\tfunction callUpdate(){\n\t\tactive = false;\n\t\tscheduler.callEvent(\"onAfterSchedulerResize\", []);\n\t\tactive = true;\n\t}\n\n\tvar conditionalUpdateContainerHeight = function() {\n\t\tif(!(scheduler.config.container_autoresize && active))\n\t\t\treturn true;\n\n\t\tvar mode = scheduler.getState().mode;\n\n\t\tif(!mode) {\n\t\t\treturn true;\n\t\t}\n\n\t\tvar asyncRepaint = window.requestAnimationFrame || window.setTimeout;\n\t\tvar scrollTop = document.documentElement.scrollTop;\n\n\t\tasyncRepaint(function() {\n\t\t\tif(scheduler.$destroyed || !scheduler.$initialized){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tupdateContainterHeight();\n\t\t});\n\n\t\tif ( (scheduler.matrix && scheduler.matrix[mode]) || mode == \"month\") {\n\t\t\tasyncRepaint(function() {\n\t\t\t\tif(scheduler.$destroyed || !scheduler.$initialized){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tupdateContainterHeight(true);\n\t\t\t\tdocument.documentElement.scrollTop = scrollTop;\n\t\t\t\tcallUpdate();\n\t\t\t}, 1);\n\t\t}else{\n\t\t\tcallUpdate();\n\t\t}\n\t};\n\n\tscheduler.attachEvent(\"onBeforeViewChange\", function(){\n\t\tvar autosizeEnabled = scheduler.config.container_autoresize;\n\t\tif(!scheduler.xy.$original_scroll_width){\n\t\t\tscheduler.xy.$original_scroll_width = scheduler.xy.scroll_width;\n\t\t}\n\n\t\tscheduler.xy.scroll_width = autosizeEnabled ? 0 : scheduler.xy.$original_scroll_width;\n\n\t\tif(scheduler.matrix){\n\t\t\tfor(var i in scheduler.matrix){\n\t\t\t\tvar timeline = scheduler.matrix[i];\n\t\t\t\tif(!timeline.$original_section_autoheight){\n\t\t\t\t\ttimeline.$original_section_autoheight = timeline.section_autoheight;\n\t\t\t\t}\n\t\t\t\tif(autosizeEnabled){\n\t\t\t\t\ttimeline.section_autoheight = false;\n\t\t\t\t}else{\n\t\t\t\t\ttimeline.section_autoheight = timeline.$original_section_autoheight;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onViewChange\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onXLE\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onEventChanged\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onEventCreated\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onEventAdded\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onEventDeleted\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onAfterSchedulerResize\", conditionalUpdateContainerHeight);\n\tscheduler.attachEvent(\"onClearAll\", conditionalUpdateContainerHeight);\n\n\t//disable container autoresize when expanded\n\tscheduler.attachEvent(\"onBeforeExpand\", function(){\n\t\tactive = false;\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onBeforeCollapse\", function(){\n\t\tactive = true;\n\t\treturn true;\n\t});\n\t// helper function\n\tfunction getScrollSize() {\n\t\tvar div = document.createElement(\"div\");\n\t\tdiv.style.cssText = \"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\n\n\t\tdocument.body.appendChild(div);\n\t\tvar size = div.offsetWidth - div.clientWidth;\n\t\tdocument.body.removeChild(div);\n\t\treturn size;\n\t}\n\n\n}","export default function(scheduler){\n\tfunction setCookie(name,cookie_param,value) {\n\t\tvar str = name + \"=\" + value +  (cookie_param?(\"; \"+cookie_param):\"\");\n\t\tdocument.cookie = str;\n\t}\n\tfunction getCookie(name) {\n\t\tvar search = name + \"=\";\n\t\tif (document.cookie.length > 0) {\n\t\t\tvar offset = document.cookie.indexOf(search);\n\t\t\tif (offset != -1) {\n\t\t\t\toffset += search.length;\n\t\t\t\tvar end = document.cookie.indexOf(\";\", offset);\n\t\t\t\tif (end == -1)\n\t\t\t\t\tend = document.cookie.length;\n\t\t\t\treturn document.cookie.substring(offset, end);\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tfunction getCookieName(scheduler) {\n\t\treturn (scheduler._obj.id || \"scheduler\") + \"_settings\";\n\t}\n\n\tvar first = true;\n\tscheduler.attachEvent(\"onBeforeViewChange\",function(oldMode,oldDate,mode,date){\n\t\t// if Url plugin is enabled - explicit url values should have more priority than cookies\n\t\tif (first && scheduler._get_url_nav){\n\t\t\tvar urlNavigationPlugin = scheduler._get_url_nav();\n\t\t\tif(urlNavigationPlugin.date || urlNavigationPlugin.mode || urlNavigationPlugin.event){\n\t\t\t\tfirst = false;\n\t\t\t}\n\t\t}\n\n\t\tvar cookie = getCookieName(scheduler);\n\n\t\tif (first){\n\t\t\tfirst = false;\n\t\t\tvar schedulerCookie = getCookie(cookie);\n\t\t\tif (schedulerCookie){\n\n\t\t\t\tif(!scheduler._min_date){\n\t\t\t\t\t//otherwise scheduler will have incorrect date until timeout\n\t\t\t\t\t//it can cause js error with 'onMouseMove' handler of key_nav.js\n\t\t\t\t\tscheduler._min_date = date;\n\t\t\t\t}\n\n\t\t\t\tschedulerCookie = unescape(schedulerCookie).split(\"@\");\n\t\t\t\tschedulerCookie[0] = this._helpers.parseDate(schedulerCookie[0]);\n\t\t\t\tvar view = this.isViewExists(schedulerCookie[1]) ? schedulerCookie[1] : mode,\n\t\t\t\t\tdate = !isNaN(+schedulerCookie[0]) ? schedulerCookie[0] : date;\n\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tif(scheduler.$destroyed){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tscheduler.setCurrentView(date,view);\n\t\t\t\t},1);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onViewChange\", function (newMode , newDate){\n\t\tvar cookie = getCookieName(scheduler);\n\t\tvar text = escape(this._helpers.formatDate(newDate)+\"@\"+(newMode));\n\t\tsetCookie(cookie,\"expires=Sun, 31 Jan 9999 22:00:00 GMT\",text);\n\t});\n\n\t// As we are blocking first render above there could be a problem in case of dynamic loading and rendering of visible data in general ('from'/'to' won't be defined)\n\tvar old_load = scheduler._load;\n\tscheduler._load = function() {\n\t\tvar args = arguments;\n\n\t\tif (!scheduler._date) {\n\t\t\tvar that = this;\n\t\t\twindow.setTimeout(function() {\n\t\t\t\told_load.apply(that, args);\n\t\t\t},1);\n\t\t} else {\n\t\t\told_load.apply(this, args);\n\t\t}\n\t};\n}","\nimport virtual_events_helpers from \"../core/virtual_events_helpers\";\n\nexport default function(scheduler){\n\tvirtual_events_helpers(scheduler);\n\tvar old_timeline = scheduler.createTimelineView;\n\n\tscheduler.createTimelineView = function (config) {\n\t\tif(config.render != 'days'){\n\t\t\told_timeline.apply(this, arguments);\n\t\t\treturn;\n\t\t}\n\n\t\tvar name = config.name;\n\n\t\tvar property = config.y_property = \"timeline-week\" + name;\n\t\tconfig.y_unit = [];\n\t\tconfig.render = \"bar\";\n\t\tconfig.days = config.days || 7;\n\n\t\told_timeline.call(this, config);\n\n\t\tscheduler.templates[name + \"_scalex_class\"] = function(){};\n\t\tscheduler.templates[name + \"_scaley_class\"] = function(){};\n\t\tscheduler.templates[name+\"_scale_label\"] = function(section_id, section_label, section_options){\n\t\t\treturn scheduler.templates.day_date(section_label);\n\t\t};\n\n\t\tscheduler.date[name + \"_start\"] = function (date) {\n\t\t\tdate = scheduler.date.week_start(date);\n\t\t\tdate = scheduler.date.add(date, config.x_step*config.x_start, config.x_unit);\n\t\t\treturn date;\n\t\t};\n\t\tscheduler.date[\"add_\" + name] = function (date, inc) {\n\t\t\treturn scheduler.date.add(date, inc*config.days, \"day\");\n\t\t};\n\n\t\tfunction initSections(){\n\t\t\tvar date = new Date(scheduler.getState().date);\n\t\t\tvar ds = scheduler.date[name + \"_start\"](date);\n\n\t\t\tds = scheduler.date.date_part(ds);\n\n\t\t\tvar list = [];\n\t\t\tvar obj = scheduler.matrix[name];\n\t\t\tobj.y_unit = list;\n\t\t\tobj.order = {};\n\n\t\t\tfor (var i = 0; i < config.days; i++) {\n\t\t\t\tlist.push({ key: +ds, label: ds });\n\n\t\t\t\tobj.order[obj.y_unit[i].key] = i;\n\t\t\t\tds = scheduler.date.add(ds, 1, \"day\");\n\t\t\t}\n\t\t}\n\t\tvar renderMatrix = scheduler._renderMatrix;\n\t\tscheduler._renderMatrix = function(mode, refresh){\n\t\t\tif(mode){\n\t\t\t\tinitSections();\n\t\t\t}\n\t\t\trenderMatrix.apply(this, arguments);\n\t\t};\n\n\t\t//copy all properties(not only hasOwnProperty)\n\t\tfunction copy_values(ev) {\n\t\t\tvar res = {};\n\t\t\tfor (var i in ev)\n\t\t\t\tres[i] = ev[i];\n\t\t\treturn res;\n\t\t}\n\t\t//ignore fake section id in week view\n\t\tvar oldCollision = scheduler.checkCollision;\n\t\tscheduler.checkCollision = function (ev) {\n\t\t\tif (ev[property]) {\n\t\t\t\tvar ev = copy_values(ev);\n\t\t\t\tdelete ev[property];\n\t\t\t}\n\t\t\treturn oldCollision.apply(scheduler, [ev]);\n\t\t};\n\n\n\t\tscheduler.attachEvent(\"onBeforeDrag\", function (id, drag_mode, e) {\n\t\t\tvar trg = e.target || e.srcElement;\n\t\t\tvar className = scheduler._getClassName(trg);\n\t\t\tif (drag_mode == 'resize') {\n\t\t\t\tif (className.indexOf(\"dhx_event_resize_end\") < 0) {\n\t\t\t\t\tscheduler._w_line_drag_from_start = true;\n\t\t\t\t} else {\n\t\t\t\t\tscheduler._w_line_drag_from_start = false;\n\t\t\t\t}\n\t\t\t}else if(drag_mode == 'move'){\n\t\t\t\tif (className.indexOf(\"no_drag_move\") >= 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t\tvar old_mouse = scheduler[\"mouse_\" + name];\n\t\tscheduler[\"mouse_\" + name] = function (pos) {\n\t\t\tvar move_delta;\n\t\t\t\tif(this._drag_event)\n\t\t\t\tmove_delta = this._drag_event._move_delta;\n\t\t\t\t\n\t\t\tvar obj = scheduler.matrix[this._mode];\n\n\t\t\tif (obj.scrollable  && !pos.converted) {\n\t\t\t\tpos.converted =1;\n\t\t\t\tpos.x -= - obj._x_scroll;\n\t\t\t\tpos.y += obj._y_scroll;\n\t\t\t} \n\n\t\t\tif(move_delta === undefined && scheduler._drag_mode == \"move\"){\n\t\t\t\t\n\t\t\t\tvar pos_copy = {y : pos.y};\n\t\t\t\tscheduler._resolve_timeline_section(obj, pos_copy);\n\t\t\t\tvar x = pos.x - obj.dx;\n\n\t\t\t\tvar end_date = new Date(pos_copy.section);\n\t\t\t\tset_time_part(scheduler._timeline_drag_date(obj, x), end_date);\n\t\t\t\tvar drag_event = scheduler._drag_event;\n\n\t\t\t\tvar ev = this.getEvent(this._drag_id);\n\t\t\t\tif(ev){\n\t\t\t\t\tdrag_event._move_delta = (ev.start_date-end_date)/60000;\n\t\t\t\t\tif (this.config.preserve_length && pos._ignores){\n\t\t\t\t\t\tdrag_event._move_delta = this._get_real_event_length(ev.start_date,end_date, obj);\n\t\t\t\t\t\tdrag_event._event_length = this._get_real_event_length(ev.start_date,ev.end_date, obj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pos = old_mouse.apply(scheduler, arguments);\n\t\t\tif (scheduler._drag_mode && scheduler._drag_mode != \"move\") {\n\n\t\t\t\tvar dat = null;\n\t\t\t\tif (scheduler._drag_event && scheduler._drag_event['timeline-week' + name]) {\n\t\t\t\t\tdat = new Date(scheduler._drag_event['timeline-week' + name]);\n\t\t\t\t} else {\n\t\t\t\t\tdat = new Date(pos.section);\n\t\t\t\t}\n\n\t\t\t\tpos.y += Math.round((dat - scheduler.date.date_part(new Date(scheduler._min_date))) / (1000 * 60 * this.config.time_step));\n\n\t\t\t\tif (scheduler._drag_mode == \"resize\") {\n\n\t\t\t\t\tpos.resize_from_start = scheduler._w_line_drag_from_start;\n\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (scheduler._drag_event) {\n\t\t\t\t\tvar days_y = Math.floor(Math.abs(pos.y / (24 * 60 / scheduler.config.time_step)));\n\t\t\t\t\tdays_y *= pos.y > 0 ? 1 : -1;\n\t\t\t\t\tpos.y = pos.y % (24 * 60 / scheduler.config.time_step);\n\t\t\t\t\tvar st_date = scheduler.date.date_part(new Date(scheduler._min_date));\n\t\t\t\t\tif (st_date.valueOf() != new Date(pos.section).valueOf()) {\n\t\t\t\t\t\tpos.x = Math.floor((pos.section - st_date) / (24 * 60 * 60000));\n\t\t\t\t\t\tpos.x += days_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn pos;\n\t\t};\n\n\t\tscheduler.attachEvent(\"onEventCreated\", function (id, e) {\n\t\t\tif (scheduler._events[id]) {\n\t\t\t\tdelete scheduler._events[id][property];//section of week-timeline is generated during rendering. storing it with data-items causes side-effects in collision ext\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\tscheduler.attachEvent(\"onBeforeEventChanged\", function (ev, e, flag, ev_old) {\n\t\t\tif (scheduler._events[ev.id]) {\n\t\t\t\tdelete scheduler._events[ev.id][property];//section of week-timeline is generated during rendering. storing it with data-items causes side-effects in collision ext\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tvar oldUpdateTimelineSection = scheduler._update_timeline_section;\n\t\tscheduler._update_timeline_section = function(action){\n\t\t\tvar event, storedEv;\n\t\t\tif (this._mode == name) {\n\t\t\t\tevent = action.event;\n\t\t\t\tif(event){\n\t\t\t\t\tstoredEv = scheduler._get_copied_event(event.id, scheduler.date.day_start(new Date(event.start_date.valueOf())));\n\t\t\t\t\tif(storedEv){\n\t\t\t\t\t\taction.event._sorder = storedEv._sorder;\n\t\t\t\t\t\taction.event._count = storedEv._count;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\toldUpdateTimelineSection.apply(this, arguments);\n\t\t\tif(event && storedEv){\n\t\t\t\tstoredEv._count = event._count;\n\t\t\t\tstoredEv._sorder = event._sorder;\n\t\t\t}\n\t\t};\n\n\t\tvar oldRender = scheduler.render_view_data;\n\t\tscheduler.render_view_data = function (evs, hold) {\n\t\t\tif (this._mode == name) {\n\t\t\t\tif (evs) {\n\t\t\t\t\tevs = week_line_dates(evs);\n\t\t\t\t\tscheduler._restore_render_flags(evs);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn oldRender.apply(scheduler, [evs, hold]);\n\t\t};\n\t\tvar old_get_evs = scheduler.get_visible_events;\n\t\tscheduler.get_visible_events = function () {\n\t\t\tif (this._mode == name) {\n\t\t\t\tthis._clear_copied_events();\n\t\t\t\tscheduler._max_date = scheduler.date.date_part(scheduler.date.add(scheduler._min_date, config.days, \"day\"));\n\t\t\t\tvar evs = old_get_evs.apply(scheduler, arguments);\n\n\t\t\t\tevs = week_line_dates(evs);\n\t\t\t\tscheduler._register_copies_array(evs);\n\t\t\t\treturn evs;\n\t\t\t}\n\t\t\treturn old_get_evs.apply(scheduler, arguments);\n\t\t};\n\n\t\tvar old_add_event_now = scheduler.addEventNow;\n\t\tscheduler.addEventNow = function (event) {\n\t\t\tif (scheduler.getState().mode == name) {\n\t\t\t\tif (event[property]) {\n\t\t\t\t\tvar dat = new Date(event[property]);\n\t\t\t\t\tset_date_part(dat, event.start_date);\n\t\t\t\t\tset_date_part(dat, event.end_date);\n\n\t\t\t\t} else {\n\t\t\t\t\tvar date = new Date(event.start_date);\n\t\t\t\t\tevent[property] = +scheduler.date.date_part(date);\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\treturn old_add_event_now.apply(scheduler, arguments);\n\t\t};\n\n\t\tfunction set_date_part(source, target) {\n\t\t\t// reset to start of the month in order to prevent month change when target is on 31th day, and source month has only 30 days\n\t\t\ttarget.setDate(1);\n\n\t\t\ttarget.setFullYear(source.getFullYear());\n\t\t\ttarget.setMonth(source.getMonth());\n\t\t\ttarget.setDate(source.getDate());\n\t\t}\n\n\t\tfunction week_line_dates(evs) {\n\t\t\tvar res = [];\n\t\t\tfor (var i =0; i < evs.length; i++) {\n\t\t\t\tvar ev = copy_timeline_event(evs[i]);\n\t\t\t\tif(!scheduler.isOneDayEvent(ev)){\n\n\t\t\t\t\tvar to = new Date(Math.min(+ev.end_date, +scheduler._max_date)),\n\t\t\t\t\t\tfrom = new Date(Math.max(+ev.start_date, +scheduler._min_date));\n\n\t\t\t\t\tvar multiday_chunks = [];\n\t\t\t\t\twhile(+from < +to){\n\t\t\t\t\t\tvar chunk = copy_timeline_event(ev);\n\t\t\t\t\t\tchunk.start_date = from;\n\t\t\t\t\t\tchunk.end_date = new Date(Math.min(+get_next_day(chunk.start_date), +to));\n\t\t\t\t\t\tfrom = get_next_day(from);\n\t\t\t\t\t\tweek_line_ev_date(chunk);\n\t\t\t\t\t\tres.push(chunk);\n\t\t\t\t\t\tmultiday_chunks.push(chunk);\n\t\t\t\t\t}\n\n\t\t\t\t\tset_resize_options(multiday_chunks, ev);\n\t\t\t\t}else{\n\t\t\t\t\tweek_line_ev_date(ev);\n\t\t\t\t\tres.push(ev);\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\n\t\tfunction set_resize_options(chunks, original){\n\t\t\tvar first = false;\n\t\t\tvar last = false;\n\t\t\tfor(var i = 0, len = chunks.length; i < len; i++){\n\t\t\t\tvar chunk = chunks[i];\n\t\t\t\tfirst = +chunk._w_start_date == +original.start_date;\n\t\t\t\tlast =  +chunk._w_end_date == +original.end_date;\n\n\t\t\t\tchunk._no_resize_start = chunk._no_resize_end = true;\n\n\t\t\t\tif(first){\n\t\t\t\t\tchunk._no_resize_start = false;\n\t\t\t\t}\n\t\t\t\tif(last)\n\t\t\t\t\tchunk._no_resize_end = false;\n\t\t\t}\n\t\t}\n\n\t\tfunction copy_timeline_event(ev){\n\t\t\tvar par = scheduler.getEvent(ev.event_pid);\n\t\t\tif (par && par.isPrototypeOf(ev)) {\n\t\t\t\tev = scheduler._copy_event(ev);\n\t\t\t\tdelete ev.event_length;\n\t\t\t\tdelete ev.event_pid;\n\t\t\t\tdelete ev.rec_pattern;\n\t\t\t\tdelete ev.rec_type;\n\t\t\t} else {\n\t\t\t\tev = scheduler._lame_clone(ev);\n\t\t\t}\n\t\t\treturn ev;\n\t\t}\n\t\tfunction week_line_ev_date(ev) {\n\t\t\tif (ev._w_start_date && ev._w_end_date) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar date = scheduler.date,\n\t\t\t\tstart = ev._w_start_date = new Date(ev.start_date),\n\t\t\t\tend = ev._w_end_date = new Date(ev.end_date);\n\t\t\tev[property] = +date.date_part(ev.start_date);\n\n\t\t\tif (!ev._count)\n\t\t\t\tev._count = 1;\n\t\t\tif (!ev._sorder)\n\t\t\t\tev._sorder = 0;\n\n\t\t\tvar duration = end - start;\n\t\t\tev.start_date = new Date(scheduler._min_date);\n\t\t\tset_time_part(start, ev.start_date);\n\t\t\tev.end_date = new Date(+ev.start_date + duration);\n\t\t\t//set_time_part(end, ev.end_date);\n\n\t\t\tif(start.getTimezoneOffset() != end.getTimezoneOffset()){\n\t\t\t\tev.end_date = new Date(ev.end_date.valueOf() + (start.getTimezoneOffset() - end.getTimezoneOffset())*(1000*60));\n\t\t\t}\n\t\t}\n\n\t\tfunction set_time_part(source, target) {\n\t\t\ttarget.setMinutes(source.getMinutes());\n\t\t\ttarget.setHours(source.getHours());\n\t\t}\n\t\tfunction get_next_day(date){\n\t\t\tvar next_day = scheduler.date.add(date, 1, \"day\");\n\t\t\tnext_day = scheduler.date.date_part(next_day);\n\t\t\treturn next_day;\n\t\t}\n\n\t\tvar old_render_marked_timespan = scheduler._render_marked_timespan;\n\t\tscheduler._render_marked_timespan = function() {\n\t\t\tif (scheduler._mode == name) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn old_render_marked_timespan.apply(this, arguments);\n\t\t};\n\t};\n\n}","export default function(scheduler){\n/* global dhtmlXCombo */\nscheduler.form_blocks['combo']={\n\trender:function(sns) {\n\t\tif (!sns.cached_options)\n\t\t\tsns.cached_options = {};\n\t\t//GS-2458: set height from config.sections\n\t\tconst sectionHeight = sns.height ? `style='height:${sns.height}px;'` : '';\n\t\tvar res = '';\n\t\tres += `<div class='${sns.type}' ${sectionHeight}></div>`;\n\t\treturn res;\n\t},\n\tset_value:function(node,value,ev,config){\n\t\t(function(){\n\t\t\tresetCombo();\n\t\t\tvar id = scheduler.attachEvent(\"onAfterLightbox\",function(){\n\t\t\t\t// otherwise destructor will never be called after form reset(e.g. in readonly event mode)\n\t\t\t\tresetCombo();\n\t\t\t\tscheduler.detachEvent(id);\n\t\t\t});\n\t\t\tfunction resetCombo(){\n\t\t\t\tif(node._combo && node._combo.DOMParent) {\n\t\t\t\t\tvar combo = node._combo;\n\t\t\t\t\tif(combo.unload){\n\t\t\t\t\t\tcombo.unload();\n\t\t\t\t\t}else if(combo.destructor){\n\t\t\t\t\t\tcombo.destructor();\n\t\t\t\t\t}\n\t\t\t\t\t// dhtmlxCombo 4.1.0 bug\n\t\t\t\t\tcombo.DOMParent = combo.DOMelem = null;\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t\twindow.dhx_globalImgPath = config.image_path||'/';\n\t\tnode._combo = new dhtmlXCombo(node, config.name, node.offsetWidth-8);\n\t\tif (config.onchange)\n\t\t\tnode._combo.attachEvent(\"onChange\", config.onchange);\n\n\t\tif (config.options_height)\n\t\t\tnode._combo.setOptionHeight(config.options_height);\n\t\tvar combo = node._combo;\n\t\tcombo.enableFilteringMode(config.filtering, config.script_path||null, !!config.cache);\n\n\t\tif (!config.script_path) { // script-side filtration is used\n\t\t\tvar all_options = [];\n\t\t\tfor (var i = 0; i < config.options.length; i++) {\n\t\t\t\tvar option = config.options[i];\n\t\t\t\tvar single_option = [\n\t\t\t\t\toption.key,\n\t\t\t\t\toption.label,\n\t\t\t\t\toption.css\n\t\t\t\t];\n\t\t\t\tall_options.push(single_option);\n\t\t\t}\n\t\t\tcombo.addOption(all_options);\n\t\t\tif (ev[config.map_to]) {\n\t\t\t\tvar index = combo.getIndexByValue(ev[config.map_to]);\n\t\t\t\tcombo.selectOption(index);\n\t\t\t}\n\t\t} else { // server-side filtration is used\n\t\t\tvar selected_id = ev[config.map_to];\n\t\t\tif (selected_id) {\n\t\t\t\tif (config.cached_options[selected_id]) {\n\t\t\t\t\tcombo.addOption(selected_id, config.cached_options[selected_id]);\n\t\t\t\t\tcombo.disable(1);\n\t\t\t\t\tcombo.selectOption(0);\n\t\t\t\t\tcombo.disable(0);\n\t\t\t\t} else {\n\t\t\t\t\tscheduler.ajax.get(config.script_path+\"?id=\"+selected_id+\"&uid=\"+scheduler.uid(), function(result){\n\t\t\t\t\t\tvar responseText = result.xmlDoc.responseText;\n\t\t\t\t\t\tvar label;\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tvar res = JSON.parse(responseText);\n\t\t\t\t\t\t\tlabel = res.options[0].text;\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tvar option = scheduler.ajax.xpath(\"//option\", result.xmlDoc)[0];\n\t\t\t\t\t\t\tlabel = option.childNodes[0].nodeValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.cached_options[selected_id] = label;\n\t\t\t\t\t\tcombo.addOption(selected_id, label);\n\t\t\t\t\t\tcombo.disable(1);\n\t\t\t\t\t\tcombo.selectOption(0);\n\t\t\t\t\t\tcombo.disable(0);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcombo.setComboValue(\"\");\n\t\t\t}\n\t\t}\n\t},\n\tget_value:function(node,ev,config) {\n\t\tvar selected_id = node._combo.getSelectedValue(); // value = key\n\t\tif (config.script_path) {\n\t\t\tconfig.cached_options[selected_id] = node._combo.getSelectedText();\n\t\t}\n\t\treturn selected_id;\n\t},\n\tfocus:function(node){\n\t}\n};\n\nscheduler.form_blocks['radio']={\n\trender:function(sns) {\n\t\tvar res = '';\n\t\tres += `<div class='dhx_cal_ltext dhx_cal_radio ${sns.vertical ? \"dhx_cal_radio_vertical\": \"\"}' style='height:${sns.height}px;'>`;\n\t\tfor (var i=0; i<sns.options.length; i++) {\n\t\t\tvar id = scheduler.uid();\n\t\t\tres += \"<label class='dhx_cal_radio_item' for='\"+id+\"'><input id='\"+id+\"' type='radio' name='\"+sns.name+\"' value='\"+sns.options[i].key+\"'><span>\"+\" \"+sns.options[i].label+\"</span></label>\";\n\t\t}\n\t\tres += \"</div>\";\n\n\t\treturn res;\n\t},\n\tset_value:function(node,value,ev,config){\n\t\tvar radiobuttons = node.getElementsByTagName('input');\n\t\tfor (var i = 0; i < radiobuttons.length; i++) {\n\t\t\tradiobuttons[i].checked = false;\n\t\t\tvar checked_value = ev[config.map_to]||value;\n\t\t\tif (radiobuttons[i].value == checked_value) {\n\t\t\t\tradiobuttons[i].checked = true;\n\t\t\t}\n\t\t}\n\t},\n\tget_value:function(node,ev,config){\n\t\tvar radiobuttons = node.getElementsByTagName('input');\n\t\tfor(var i=0; i<radiobuttons.length; i++) {\n\t\t\tif(radiobuttons[i].checked) {\n\t\t\t\treturn radiobuttons[i].value;\n\t\t\t}\n\t\t}\n\t},\n\tfocus:function(node){\n\t}\n};\n\nscheduler.form_blocks['checkbox']={\n\trender:function(sns) {\n\t\tif (scheduler.config.wide_form)\n\t\t\treturn '<div class=\"dhx_cal_wide_checkbox\"></div>';\n\t\telse\n\t\t\treturn '';\n\t},\n\tset_value:function(node,value,ev,config){\n\t\tnode=scheduler._lightbox.querySelector(`#${config.id}`);\n\t\t//GS-2458: set height from config.sections\n\t\tif(config.height){\n\t\t\tnode.style.height = `${config.height}px`;\n\t\t}\n\t\tvar id = scheduler.uid();\n\t\tvar isChecked = (typeof config.checked_value != \"undefined\") ? value == config.checked_value : !!value;\n\t\tnode.className += \" dhx_cal_checkbox\";\n\t\tvar check_html = \"<input id='\"+id+\"' type='checkbox' value='true' name='\"+config.name+\"'\"+((isChecked)?\"checked='true'\":'')+\"'>\";\n\t\tvar label_html = \"<label for='\"+id+\"'>\"+(scheduler.locale.labels[\"section_\"+config.name]||config.name)+\"</label>\";\n\t\tif (scheduler.config.wide_form){\n\t\t\tnode.innerHTML = label_html;\n\t\t\tnode.nextSibling.innerHTML=check_html;\n\t\t} else\n\t\t\tnode.innerHTML=check_html+label_html;\n\n\t\tif (config.handler) {\n\t\t\tvar checkbox = node.getElementsByTagName('input')[0];\n\t\t\tif(checkbox.$_eventAttached){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcheckbox.$_eventAttached = true;\n\t\t\tscheduler.event(checkbox, \"click\", config.handler);\n\t\t\t//checkbox.onclick = config.handler;\n\t\t}\n\t},\n\tget_value:function(node,ev,config){\n\t\tnode=scheduler._lightbox.querySelector(`#${config.id}`);\n\t\tvar checkbox = node.getElementsByTagName('input')[0]; // moved to the header\n\t\tif (!checkbox)\n\t\t\tcheckbox = node.nextSibling.getElementsByTagName('input')[0];\n\t\treturn (checkbox.checked)?(config.checked_value||true):(config.unchecked_value||false);\n\t},\n\tfocus:function(node){\n\t}\n};\n\n\n}","export default function(scheduler){\n\nscheduler.ext.fullscreen = {\n\ttoggleIcon: null\n};\n\nscheduler.expand = function() {\n\tif(!scheduler.callEvent(\"onBeforeExpand\", []))\n\t\treturn;\n\tvar t = scheduler._obj;\n\tdo {\n\t\tt._position = t.style.position || \"\";\n\t\tt.style.position = \"static\";\n\t} while ((t = t.parentNode) && t.style);\n\tt = scheduler._obj;\n\tt.style.position = \"absolute\";\n\tt._width = t.style.width;\n\tt._height = t.style.height;\n\tt.style.width = t.style.height = \"100%\";\n\tt.style.top = t.style.left = \"0px\";\n\n\tvar top = document.body;\n\ttop.scrollTop = 0;\n\n\ttop = top.parentNode;\n\tif (top)\n\t\ttop.scrollTop = 0;\n\tdocument.body._overflow = document.body.style.overflow || \"\";\n\tdocument.body.style.overflow = \"hidden\";\n\tscheduler._maximize();\n\tscheduler.callEvent(\"onExpand\", []);\n};\nscheduler.collapse = function() {\n\tif(!scheduler.callEvent(\"onBeforeCollapse\", []))\n\t\treturn;\n\tvar t = scheduler._obj;\n\tdo {\n\t\tt.style.position = t._position;\n\t} while ((t = t.parentNode) && t.style);\n\tt = scheduler._obj;\n\tt.style.width = t._width;\n\tt.style.height = t._height;\n\tdocument.body.style.overflow = document.body._overflow;\n\tscheduler._maximize();\n\tscheduler.callEvent(\"onCollapse\", []);\n};\nscheduler.attachEvent(\"onTemplatesReady\", function() {\n\tvar t = document.createElement(\"div\");\n\tt.className = \"dhx_expand_icon\";\n\tscheduler.ext.fullscreen.toggleIcon = t;\n\tt.innerHTML = `<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t<g>\n\t<line x1=\"0.5\" y1=\"5\" x2=\"0.5\" y2=\"3.0598e-08\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line y1=\"0.5\" x2=\"5\" y2=\"0.5\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line x1=\"0.5\" y1=\"11\" x2=\"0.5\" y2=\"16\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line y1=\"15.5\" x2=\"5\" y2=\"15.5\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line x1=\"11\" y1=\"0.5\" x2=\"16\" y2=\"0.5\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line x1=\"15.5\" y1=\"2.18557e-08\" x2=\"15.5\" y2=\"5\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line x1=\"11\" y1=\"15.5\" x2=\"16\" y2=\"15.5\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t<line x1=\"15.5\" y1=\"16\" x2=\"15.5\" y2=\"11\" stroke=\"var(--dhx-scheduler-base-colors-icons)\"/>\n\t</g>\n\t</svg>\n\t`;\n\tscheduler._obj.appendChild(t);\n\tscheduler.event(t, \"click\",  function() {\n\t\tif (!scheduler.expanded)\n\t\t\tscheduler.expand(); else\n\t\t\tscheduler.collapse();\n\t});\n});\nscheduler._maximize = function() {\n\tthis.expanded = !this.expanded;\n\tif(this.expanded){\n\t\tthis.ext.fullscreen.toggleIcon.classList.add(\"dhx_expand_icon--expanded\");\n\t\t\n\t}else{\n\t\tthis.ext.fullscreen.toggleIcon.classList.remove(\"dhx_expand_icon--expanded\");\n\t}\n\t\n\t//scheduler.ext.fullscreen.toggleIcon.style.backgroundPosition = \"0 \" + (this.expanded ? \"0\" : \"18\") + \"px\";\n\n\tvar directions = ['left', 'top'];\n\tfor (var i = 0; i < directions.length; i++) {\n\t\t//var margin = scheduler.xy['margin_' + directions[i]];\n\t\tvar prev_margin = scheduler['_prev_margin_' + directions[i]];\n\t\tif (scheduler.xy['margin_' + directions[i]]) {\n\t\t\tscheduler['_prev_margin_' + directions[i]] = scheduler.xy['margin_' + directions[i]];\n\t\t\tscheduler.xy['margin_' + directions[i]] = 0;\n\t\t} else {\n\t\t\tif (prev_margin) {\n\t\t\t\tscheduler.xy['margin_' + directions[i]] = scheduler['_prev_margin_' + directions[i]];\n\t\t\t\tdelete scheduler['_prev_margin_' + directions[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tscheduler.setCurrentView();\n};\n\n\n}\n","export default function(scheduler){\n\n\n(function(){\n\nfunction defaults(obj, std){\n\tfor (var key in std)\n\t\tif (!obj[key])\n\t\t\tobj[key] = std[key];\n\treturn obj;\n}\n\nfunction getElementSizes(element, scheduler) {\n\tvar sizes = {};\n\telement = scheduler._els[element];\n\tif (element && element[0]) {\n\t\tsizes.x = element[0].scrollWidth;\n\t\tsizes.y = element[0].scrollHeight;\n\t} else {\n\t\tsizes.x = 0;\n\t\tsizes.y = 0;\n\t}\n\treturn sizes;\n}\n\n//compatibility for new versions of scheduler\nif(!window.dhtmlxAjax){\n\twindow.dhtmlxAjax = {\n\t\tpost: function(url, data, callback){\n\t\t\treturn window.dhx4.ajax.post(url, data, callback);\n\t\t},\n\t\tget: function(url, callback){\n\t\t\treturn window.ajax.get(url, callback);\n\t\t}\n\t};\n}\n\nfunction add_export_methods(scheduler){\n\n\tscheduler.exportToPDF = function(config){\n\t\tconfig = defaults((config || {}), {\n\t\t\tname:\"calendar.pdf\",\n\t\t\tformat:\"A4\",\n\t\t\torientation:\"landscape\",\n\t\t\tdpi:96,\n\t\t\tzoom:1,\n\t\t\trtl: scheduler.config.rtl\n\t\t});\n\t\tconfig.html = this._export_html(config);\n\t\tconfig.mode = this.getState().mode;\n\t\tthis._send_to_export(config, \"pdf\");\n\t};\n\n\tscheduler.exportToPNG = function(config){\n\t\tconfig = defaults((config || {}), {\n\t\t\tname:\"calendar.png\",\n\t\t\tformat:\"A4\",\n\t\t\torientation:\"landscape\",\n\t\t\tdpi:96,\n\t\t\tzoom:1,\n\t\t\trtl: scheduler.config.rtl\n\t\t});\n\t\tconfig.html = this._export_html(config);\n\t\tconfig.mode = this.getState().mode;\n\t\tthis._send_to_export(config, \"png\");\n\t};\n\n\tscheduler.exportToICal = function(config){\n\t\tconfig = defaults((config || {}), {\n\t\t\tname:\"calendar.ical\",\n\t\t\tdata:this._serialize_plain(null, config)\n\t\t});\n\t\tthis._send_to_export(config, \"ical\");\n\t};\n\n\tscheduler.exportToExcel = function(config){\n\t\tconfig = defaults((config || {}), {\n\t\t\tname:\"calendar.xlsx\",\n\t\t\ttitle:\"Events\",\n\t\t\tdata:this._serialize_plain( this.templates.xml_format, config),\n\t\t\tcolumns:this._serialize_columns()\n\t\t});\n\t\tthis._send_to_export(config, \"excel\");\n\t};\n\n\tscheduler._ajax_to_export = function(data, type, callback){\n\t\tdelete data.callback;\n\t\tvar url = data.server || \"https://export.dhtmlx.com/scheduler\";\n\n\t\twindow.dhtmlxAjax.post(url,\n\t\t\t\"type=\"+type+\"&store=1&data=\"+encodeURIComponent(JSON.stringify(data)),\n\t\t\tfunction(loader){\n\t\t\t\tvar fail = loader.xmlDoc.status > 400;\n\t\t\t\tvar info = null;\n\n\t\t\t\tif (!fail){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tinfo = JSON.parse(loader.xmlDoc.responseText);\n\t\t\t\t\t}catch(e){}\n\t\t\t\t}\n\t\t\t\tcallback(info);\n\t\t\t}\n\t\t);\n\t};\n\n\tscheduler._plain_export_copy = function(source, format){\n\t\tvar target = {};\n\t\tfor (var key in source)\n\t\t\ttarget[key] = source[key];\n\n\t\ttarget.start_date = format(target.start_date);\n\t\ttarget.end_date = format(target.end_date);\n\t\ttarget.$text = this.templates.event_text(source.start_date, source.end_date, source);\n\n\t\treturn target;\n\t};\n\n\tscheduler._serialize_plain = function(format, config){\n\t\tformat = format || scheduler.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\n\t\tvar events;\n\t\tif (config && config.start && config.end)\n\t\t\tevents = scheduler.getEvents(config.start, config.end);\n\t\telse\n\t\t\tevents = scheduler.getEvents();\n\n\t\tvar data = [];\n\t\tfor (var i = 0; i< events.length; i++)\n\t\t\tdata[i] = this._plain_export_copy(events[i], format);\n\n\t\treturn data;\n\t};\n\n\tscheduler._serialize_columns = function(){\n\t\treturn [\n\t\t\t{ id:\"start_date\", header:\"Start Date\", width:30 },\n\t\t\t{ id:\"end_date\", header:\"End Date\", width:30 },\n\t\t\t{ id:\"$text\", header:\"Text\", width:100 }\n\t\t];\n\t};\n\n\tscheduler._send_to_export = function(data, type){\n\t\tif(!data.version){\n\t\t\tdata.version = scheduler.version;\n\t\t}\n\n\t\tif(!data.skin){\n\t\t\tdata.skin = scheduler.skin;\n\t\t}\n\n\t\tif (data.callback)\n\t\t\t\treturn scheduler._ajax_to_export(data, type, data.callback);\n\n\t\tvar form = this._create_hidden_form();\n\n\t\tform.firstChild.action = data.server || \"https://export.dhtmlx.com/scheduler\";\n\t\tform.firstChild.childNodes[0].value = JSON.stringify(data);\n\t\tform.firstChild.childNodes[1].value = type;\n\t\tform.firstChild.submit();\n\t};\n\n\tscheduler._create_hidden_form = function(){\n\t\tif (!this._hidden_export_form){\n\t\t\tvar t = this._hidden_export_form = document.createElement(\"div\");\n\t\t\tt.style.display = \"none\";\n\t\t\tt.innerHTML = \"<form method='POST' target='_blank'><input type='text' name='data'><input type='hidden' name='type' value=''></form>\";\n\t\t\tdocument.body.appendChild(t);\n\t\t}\n\t\treturn this._hidden_export_form;\n\t};\n\n\tscheduler._get_export_size = function(format, orientation, zoom, dpi, header, footer, scales) {\n\n\t\tdpi = parseInt(dpi)/25.4 || 4;\n\n\t\tvar sizes = {\n\t\t\t\"A5\":{ x:148, y:210 },\n\t\t\t\"A4\":{ x:210, y:297 },\n\t\t\t\"A3\":{ x:297, y:420 },\n\t\t\t\"A2\":{ x:420, y:594 },\n\t\t\t\"A1\":{ x:594, y:841 },\n\t\t\t\"A0\":{ x:841, y:1189 }\n\t\t};\n\n\t\tvar dataX = getElementSizes(\"dhx_cal_data\", this).x;\n\t\tvar dataY = getElementSizes(\"dhx_cal_data\", this).y;\n\t\tvar headY = getElementSizes(\"dhx_cal_header\", this).y;\n\t\tvar multY = getElementSizes(\"dhx_multi_day\", this).y;\n\n\t\tvar cSize = {\n\t\t\ty: dataY + headY + multY\n\t\t};\n\n\t\tif (format === \"full\") {\n\t\t\tcSize.x = dataX;\n\t\t} else {\n\t\t\tcSize.x = Math.floor( (orientation === \"landscape\" ? sizes[format].y : sizes[format].x) * dpi );\n\t\t}\n\n\t\tif (scales) {\n\t\t\tcSize.x *= (parseFloat(scales.x) || 1);\n\t\t\tcSize.y *= (parseFloat(scales.y) || 1);\n\t\t}\n\n\t\treturn cSize;\n\t};\n\n\tfunction getTimeline() {\n\t\tvar mode = scheduler.getState().mode;\n\t\tif (scheduler.matrix && scheduler.matrix[mode]) {\n\t\t\treturn scheduler.matrix[mode];\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction getInitialSizes() {\n\t\tvar smartRendering = undefined,\n\t\t\tscrollable = undefined;\n\n\t\tvar timeline = getTimeline();\n\t\tif (timeline) {\n\t\t\tscrollable = timeline.scrollable;\n\t\t\tsmartRendering = timeline.smart_rendering;\n\t\t}\n\n\t\treturn {\n\t\t\tnav_height: scheduler.xy.nav_height,\n\t\t\tscroll_width: scheduler.xy.scroll_width,\n\t\t\tstyle_width: scheduler._obj.style.width,\n\t\t\tstyle_height: scheduler._obj.style.height,\n\t\t\ttimeline_scrollable: scrollable,\n\t\t\ttimeline_smart_rendering: smartRendering\n\t\t};\n\t}\n\n\tfunction setExportSizes(size, initialSizes) {\n\t\tscheduler._obj.style.width  = size.x + \"px\";\n\t\tscheduler._obj.style.height = size.y + \"px\";\n\n\t\tscheduler.xy.nav_height = 0;\n\t\tscheduler.xy.scroll_width = 0;\n\n\t\tvar timeline = getTimeline();\n\t\tif (initialSizes.timeline_scrollable || initialSizes.timeline_smart_rendering) {\n\n\t\t\ttimeline.scrollable = false;\n\t\t\ttimeline.smart_rendering = false;\n\t\t}\n\t}\n\n\tfunction setInitialSizes(initialSizes) {\n\t\tscheduler.xy.scroll_width = initialSizes.scroll_width;\n\t\tscheduler.xy.nav_height = initialSizes.nav_height;\n\t\tscheduler._obj.style.width  = initialSizes.style_width;\n\t\tscheduler._obj.style.height = initialSizes.style_height;\n\n\t\tvar timeline = getTimeline();\n\t\tif (initialSizes.timeline_scrollable || initialSizes.timeline_smart_rendering) {\n\t\t\ttimeline.scrollable = initialSizes.timeline_scrollable;\n\t\t\ttimeline.smart_rendering = initialSizes.timeline_smart_rendering;\n\t\t}\n\t}\n\n\tscheduler._export_html = function (obj) {\n\t\tvar initialSizes = getInitialSizes();\n\t\tvar size = scheduler._get_export_size(obj.format, obj.orientation, obj.zoom, obj.dpi, obj.header, obj.footer, obj.scales);\n\n\t\tvar html = \"\";\n\t\ttry {\n\t\t\tsetExportSizes(size, initialSizes);\n\t\t\tscheduler.setCurrentView();\n\t\t\thtml = scheduler._obj.innerHTML;\n\t\t} catch (e) {\n\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(e);\n\t\t} finally {\n\t\t\tsetInitialSizes(initialSizes);\n\t\t\tscheduler.setCurrentView();\n\t\t}\n\n\t\treturn html;\n\t};\n\n}\n\nadd_export_methods(scheduler);\n\n\n})();\n\n}","export default function(scheduler){\n\n(function(){\n\tscheduler._grid = {\n\t\tnames: {},\n\t\tsort_rules:{\n\t\t\t\"int\":function(a,b, getVal){ return getVal(a)*1 < getVal(b)*1?1:-1; },\n\t\t\t\"str\":function(a,b, getVal){ return getVal(a) < getVal(b)?1:-1; },\n\t\t\t\"date\":function(a,b, getVal){ return new Date(getVal(a))< new Date(getVal(b))?1:-1; }\n\t\t},\n\t\t_getObjName:function(name){\n\t\t\treturn \"grid_\"+name;\n\t\t},\n\t\t_getViewName:function(objName){\n\t\t\treturn objName.replace(/^grid_/,'');\n\t\t}\n\t};\n}\n)();\n/*\nobj={\n    name:'grid_name'\n\tfields:[\n                  { id:\"id\", label:\"Id\", width:80, sort:\"int/date/str\", template:function(start_date, end_date, ev){ return \"\"}, align:\"right/left/center\" },\n                  { id:\"text\", label:\"Text\", width:'*', css:\"class_name\", sort:function(a,b){ return 1 or -1}, valign:'top/bottom/middle' }\n                  ...\n            ],\n\tfrom:new Date(0),\n\tto:Date:new Date(9999,1,1),\n\trowHeight:int,\n\tpaging:true/false,\n\tselect:true/false\n}\n*/\n\n\nscheduler.createGridView=function(obj){\n\tvar name = obj.name || 'grid';\n\tvar objName = scheduler._grid._getObjName(name);\n\n\tscheduler._grid.names[name] = name;\n\tscheduler.config[name + '_start'] = obj.from || (new Date(0));\n\tscheduler.config[name + '_end'] = obj.to || (new Date(9999,1,1));\n\n\tscheduler[objName] = obj;\n\tscheduler[objName].defPadding = 8;\n\tscheduler[objName].columns = scheduler[objName].fields;\n\tscheduler[objName].unit = obj.unit || \"month\";\n\tscheduler[objName].step = obj.step || 1;\n\tdelete scheduler[objName].fields;\n\tfunction isValidSize(size){\n\t\treturn !(size !== undefined && (size*1 != size || size < 0));\n\t}\n\n\tvar cols = scheduler[objName].columns;\n\tfor(var i=0; i < cols.length; i++){\n\t\tif(isValidSize(cols[i].width))\n\t\t\tcols[i].initialWidth = cols[i].width;\n\t\tif(!isValidSize(cols[i].paddingLeft))\n\t\t\tdelete cols[i].paddingLeft;\n\t\tif(!isValidSize(cols[i].paddingRight))\n\t\t\tdelete cols[i].paddingRight;\n\t}\n\n\tscheduler[objName].select = obj.select === undefined ? true : obj.select;\n\tif(scheduler.locale.labels[name +'_tab'] === undefined)\n\t\tscheduler.locale.labels[name +'_tab'] = scheduler[objName].label || scheduler.locale.labels.grid_tab;\n\n\tscheduler[objName]._selected_divs = [];\n\n\tscheduler.date[name+'_start']=function(d){\n\t\tif(scheduler.date[obj.unit+'_start'])\n\t\t\treturn scheduler.date[obj.unit+'_start'](d);\n\t\telse\n\t\t\treturn (d);\n\t};\n\tscheduler.date['add_' + name] = function(date, inc){\n\t\treturn scheduler.date.add(date, inc*scheduler[objName].step, scheduler[objName].unit);\n\t};\n\n\tscheduler.templates[name+\"_date\"] = function(start, end){\n\t\tif (scheduler.config.rtl) {\n\t\t\treturn scheduler.templates.day_date(end)+\" - \"+scheduler.templates.day_date(start);\n\t\t} else {\n\t\t\treturn scheduler.templates.day_date(start)+\" - \"+scheduler.templates.day_date(end);\n\t\t}\n\t};\n\tscheduler.templates[name + '_full_date'] = function(start,end,ev){\n\t\tif (scheduler.isOneDayEvent(ev)) {\n\t\t\treturn this[name + '_single_date'](start);\n\t\t} else if (scheduler.config.rtl) {\n\t\t\treturn scheduler.templates.day_date(end)+\" &ndash; \"+scheduler.templates.day_date(start);\n\t\t} else {\n\t\t\treturn scheduler.templates.day_date(start)+\" &ndash; \"+scheduler.templates.day_date(end);\n\t\t}\n\t};\n\tscheduler.templates[name + '_single_date'] = function(date){\n\t\treturn scheduler.templates.day_date(date)+\" \"+this.event_date(date);\n\t};\n\tscheduler.templates[name + '_field'] = function(field_name, event){\n\t\treturn event[field_name];\n\t};\n\n\tscheduler.attachEvent(\"onTemplatesReady\",function(){\n\t\tscheduler.attachEvent(\"onEventSelected\", function(id){\n\t\t\tif(this._mode == name && scheduler[objName].select ){\n\t\t\t\tscheduler._grid.selectEvent(id, name);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tscheduler.attachEvent(\"onEventUnselected\", function(id){\n\t\t\tif(this._mode == name && scheduler[objName].select ){\n\t\t\t\tscheduler._grid.unselectEvent('', name);\n\t\t\t}\n\t\t});\n\n\t\tvar old = scheduler.render_data;\n\t\tscheduler.render_data=function(evs){\n\t\t\tif (this._mode == name)\n\t\t\t\tscheduler._grid._fill_grid_tab(objName);\n\t\t\telse\n\t\t\t\treturn old.apply(this,arguments);\n\t\t};\n\n\t\tvar old_render_view_data = scheduler.render_view_data;\n\t\tscheduler.render_view_data=function(){\n\t\t\tvar data_container = scheduler._els[\"dhx_cal_data\"][0].lastChild;\n\t\t\tif(this._mode == name && data_container) {\n\t\t\t\tscheduler._grid._gridScrollTop = data_container.scrollTop;\n\t\t\t}\n\n\t\t\treturn old_render_view_data.apply(this,arguments);\n\t\t};\n});\n\n\n\tscheduler[name+'_view']=function(mode){\n\t\tscheduler._grid._sort_marker = null;\n\t\tdelete scheduler._gridView;\n\t\tscheduler._grid._gridScrollTop = 0;\n\t\tscheduler._rendered=[];\n\t\tscheduler[objName]._selected_divs = [];\n\n\t\tif (mode){\n\t\t\tvar min = null,\n\t\t\t\tmax = null;\n\t\t\tvar view = scheduler[objName];\n\t\t\tif(view.paging){\n\t\t\t\tmin = scheduler.date[name+'_start'](new Date(scheduler._date));\n\t\t\t\tmax = scheduler.date['add_'+name](min, 1);\n\t\t\t}else{\n\t\t\t\tmin = scheduler.config[name + '_start'];\n\t\t\t\tmax = scheduler.config[name + '_end'];\n\t\t\t}\n\n\t\t\tscheduler._min_date = min;\n\t\t\tscheduler._max_date = max;\n\n\t\t\tscheduler._grid.set_full_view(objName);\n\n\t\t\tvar header = \"\";\n\t\t\tif(+min > +new Date(0) && +max < +(new Date(9999,1,1))){\n\t\t\t\theader = scheduler.templates[name+\"_date\"](min, max);\n\t\t\t}\n\n\t\t\tvar dateElement = scheduler._getNavDateElement();\n\t\t\tif(dateElement){\n\t\t\t\tdateElement.innerHTML=header;\n\t\t\t}\n\n\t\t\t//grid tab activated\n\t\t\tscheduler._gridView = objName;\n\t\t} else {\n\t\t\t//grid tab de-activated\n\t\t}\n\t};\n\n\n};\n\n\nscheduler.dblclick_dhx_grid_area=function(){\n\tif (!this.config.readonly && this.config.dblclick_create)\n\t\tthis.addEventNow();\n};\n\nif(scheduler._click.dhx_cal_header){\n\tscheduler._old_header_click = scheduler._click.dhx_cal_header;\n}\nscheduler._click.dhx_cal_header=function(e){\n\tif(scheduler._gridView){\n\t\tvar event = e||window.event;\n\n\t\tvar column = scheduler._grid._get_target_column(event, scheduler._gridView);\n\t\tscheduler._grid._toggle_sort_state(scheduler._gridView, column.id);\n\t\tscheduler.clear_view();\n\t\tscheduler._grid._fill_grid_tab(scheduler._gridView);\n\t}\n\telse if(scheduler._old_header_click)\n\t\treturn scheduler._old_header_click.apply(this,arguments);\n};\n\nscheduler._grid.selectEvent = function(id, view_name){\n\tif(scheduler.callEvent(\"onBeforeRowSelect\",[id])){\n\t\tvar objName = scheduler._grid._getObjName(view_name);\n\n\t\tscheduler.for_rendered(id, function(event_div){\n\t\t\tevent_div.classList.add(\"dhx_grid_event_selected\");\n\t\t\tscheduler[objName]._selected_divs.push(event_div);\n\t\t});\n\t//\tscheduler._select_id = id;\n\t}\n};\n\nscheduler._grid._unselectDiv= function(div){\n\tdiv.className = div.classList.remove(\"dhx_grid_event_selected\");\n};\nscheduler._grid.unselectEvent = function(id, view_name){\n\tvar objName = scheduler._grid._getObjName(view_name);\n\tif(!objName || !scheduler[objName]._selected_divs)\n\t\treturn;\n\n\tif(!id){\n\t\tfor(var i=0; i<scheduler[objName]._selected_divs.length; i++)\n\t\t\tscheduler._grid._unselectDiv(scheduler[objName]._selected_divs[i]);\n\n\t\tscheduler[objName]._selected_divs = [];\n\n\t}else{\n\t\tfor(var i=0; i<scheduler[objName]._selected_divs.length; i++)\n\t\t\tif(scheduler[objName]._selected_divs[i].getAttribute(scheduler.config.event_attribute) == id){\n\t\t\t\tscheduler._grid._unselectDiv(scheduler[objName]._selected_divs[i]);\n\t\t\t\tscheduler[objName]._selected_divs.slice(i,1);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n};\n\nscheduler._grid._get_target_column = function(event, objName){\n\tvar targ = event.originalTarget || event.srcElement;\n\tvar className = scheduler._getClassName(targ);\n\tif(className == 'dhx_grid_view_sort')\n\t\ttarg = targ.parentNode;\n\n\tvar index = 0;\n\tfor(var i =0; i < targ.parentNode.childNodes.length; i++){\n\t\tif(targ.parentNode.childNodes[i] == targ){\n\t\t\tindex = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn scheduler[objName].columns[index];\n};\n\nscheduler._grid._get_sort_state = function(objName){\n\tvar grid = scheduler[objName];\n\treturn grid.sort;\n};\n\nscheduler._grid._toggle_sort_state = function(objName, column){\n\tvar sort = this._get_sort_state(objName);\n\tvar grid = scheduler[objName];\n\n\tif(sort && sort.column == column){\n\t\tsort.direction = sort.direction == \"asc\" ? \"desc\" : \"asc\";\n\t}else{\n\t\tgrid.sort = {\n\t\t\tcolumn: column,\n\t\t\tdirection: \"desc\"\n\t\t};\n\t}\n};\n\nscheduler._grid._get_sort_value_for_column = function(column){\n\tvar value = null;\n\tif(column.template){\n\t\tvar template = column.template;\n\t\tvalue = function(ev){\n\t\t\treturn template(ev.start_date, ev.end_date, ev);\n\t\t};\n\t}else{\n\t\tvar field = column.id;\n\t\tif(field == \"date\")\n\t\t\tfield = \"start_date\";\n\t\tvalue = function(ev){ return ev[field]; };\n\t}\n\treturn value;\n};\n\nscheduler._grid.draw_sort_marker = function(columns, sort){\n\n\tif(scheduler._grid._sort_marker){\n\t\tscheduler._grid._sort_marker.className = scheduler._grid._sort_marker.className.replace(/( )?dhx_grid_sort_(asc|desc)/, '');\n\t\tscheduler._grid._sort_marker.removeChild(scheduler._grid._sort_marker.lastChild);\n\t}\n\n\tif(sort){\n\t\tvar node = scheduler._grid._get_column_node(columns, sort.column);\n\n\t\tnode.className += \" dhx_grid_sort_\"+ sort.direction;\n\t\tscheduler._grid._sort_marker = node;\n\t\tvar html = \"<div class='dhx_grid_view_sort' style='left:\"+(+node.style.width.replace('px','') -15+node.offsetLeft)+\"px'>&nbsp;</div>\";\n\t\tnode.innerHTML += html;\n\t}\n};\n\nscheduler._grid.sort_grid=function(sort){\n\n\tsort = sort || {direction:'desc', value:function(ev){return ev.start_date;}, rule:scheduler._grid.sort_rules['date']};\n\n\tvar events = scheduler.get_visible_events();\n\n\tevents.sort(function(a,b){return sort.rule(a,b,sort.value);});\n\tif(sort.direction == 'asc'){\n\t\tevents = events.reverse();\n\t}\n\treturn events;\n};\n\n\n\nscheduler._grid.set_full_view = function(mode){\n\tif (mode){\n\t\t//var l = scheduler.locale.labels;\n\t\tvar html =scheduler._grid._print_grid_header(mode);\n\n\t\tscheduler._els[\"dhx_cal_header\"][0].innerHTML= html;\n\t\tscheduler._table_view=true;\n\t\tscheduler.set_sizes();\n\t}\n};\nscheduler._grid._calcPadding = function(column, parent){\n\treturn (column.paddingLeft !== undefined ? 1*column.paddingLeft : scheduler[parent].defPadding) +\n\t\t(column.paddingRight !== undefined ? 1*column.paddingRight : scheduler[parent].defPadding);\n};\n\nscheduler._grid._getStyles = function(column, items){\n\tvar cell_style = [], style = \"\";\n\tfor(var i=0; items[i]; i++ ){\n\t\tstyle = items[i] + \":\";\n\t\tswitch (items[i]){\n\t\t\tcase \"text-align\":\n\t\t\t\tif(column.align)\n\t\t\t\t\tcell_style.push(style+column.align);\n\t\t\t\tbreak;\n\t\t\tcase \"vertical-align\":\n\t\t\t\tif(column.valign)\n\t\t\t\t\tcell_style.push(style+column.valign);\n\t\t\t\tbreak;\n\t\t\tcase \"padding-left\":\n\t\t\t\tif(column.paddingLeft !== undefined)\n\t\t\t\t\tcell_style.push(style+(column.paddingLeft||'0') + \"px\");\n\t\t\t\tbreak;\n\t\t\tcase \"padding-right\":\n\t\t\t\tif(column.paddingRight !== undefined)\n\t\t\t\t\tcell_style.push(style+(column.paddingRight||'0') + \"px\");\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn cell_style;\n};\n\nscheduler._grid._get_column_node = function(columns, id){\n\tvar index = -1;\n\tfor(var i = 0; i < columns.length; i++){\n\t\tif(columns[i].id == id){\n\t\t\tindex = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(index < 0) return null;\n\n\treturn scheduler._obj.querySelectorAll(\".dhx_grid_line > div\")[index];\n};\n\nscheduler._grid._get_sort_rule = function(objName){\n\tvar grid = scheduler[objName];\n\tvar sort = this._get_sort_state(objName);\n\tvar sortRule;\n\tif(sort){\n\t\tvar column;\n\n\t\tfor(var i = 0; i < grid.columns.length; i++){\n\t\t\tif(grid.columns[i].id == sort.column){\n\t\t\t\tcolumn = grid.columns[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(column){\n\t\t\tvar value = scheduler._grid._get_sort_value_for_column(column);\n\n\t\t\tvar rule = column.sort;\n\t\t\tif(typeof rule != 'function'){\n\t\t\t\trule = scheduler._grid.sort_rules[rule] || scheduler._grid.sort_rules['str'];\n\t\t\t}\n\n\t\t\tsortRule = {direction: sort.direction, rule: rule, value: value};\n\t\t}\n\t}\n\treturn sortRule;\n};\n\nscheduler._grid._fill_grid_tab = function(objName){\n\tvar grid = scheduler[objName];\n\tvar sort = this._get_sort_state(objName);\n\n\tvar sortRule = this._get_sort_rule(objName);\n\n\tif(sortRule) {\n\t\tscheduler._grid.draw_sort_marker(grid.columns, sort);\n\t}\n\n\t//get current date\n\t//var date = scheduler._date;\n\t//select events for which data need to be printed\n\tvar events = scheduler._grid.sort_grid(sortRule);\n\n\t//generate html for the view\n\tvar columns = scheduler[objName].columns;\n\n\tvar html = \"<div>\";\n\tvar left = -1;//column borders at the same pos as header borders...\n\tfor(var i=0; i < columns.length; i++){\n\t//\tvar padding = scheduler._grid._calcPadding(columns[i], objName);\n\t\tleft +=columns[i].width;// + padding;\n\t\tif(i < columns.length - 1){\n\t\t\tvar pos = scheduler.config.rtl ? \"right\" : \"left\";\n\t\t\thtml += \"<div class='dhx_grid_v_border' style='\"+ pos + \":\" + left + \"px'></div>\";\n\t\t}\n\t}\n\thtml += \"</div>\";\n\n\tvar ariaAttr = scheduler._waiAria.gridAttrString();\n\thtml +=\"<div class='dhx_grid_area'><table \"+ariaAttr+\">\";\n\n\tfor (var i=0; i<events.length; i++){\n\t\thtml += scheduler._grid._print_event_row(events[i], objName);\n\t}\n\n\thtml +=\"</table></div>\";\n\t//render html\n\n\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = html;\n\tscheduler._els[\"dhx_cal_data\"][0].lastChild.scrollTop = scheduler._grid._gridScrollTop||0;\n\n\tvar t=scheduler._els[\"dhx_cal_data\"][0].getElementsByTagName(\"tr\");\n\n\tscheduler._rendered=[];\n\tfor (var i=0; i < t.length; i++){\n\t\tscheduler._rendered[i]=t[i];\n\t}\n\n};\n\nscheduler._grid._getCellContent = function(event, column){\n\tvar value;\n\tvar viewName = scheduler.getState().mode;\n\n\tif(column.template){\n\t\tvalue = column.template(event.start_date, event.end_date, event);\n\t}else if(column.id == 'date'){\n\t\tvalue = scheduler.templates[viewName + '_full_date'](event.start_date, event.end_date, event);\n\t}else if(column.id == 'start_date' || column.id == 'end_date' ){\n\t\tvalue = scheduler.templates[viewName + '_single_date'](event[column.id]);\n\t}else{\n\t\tvalue = scheduler.templates[viewName + '_field'](column.id, event);\n\t}\n\treturn value;\n};\n\nscheduler._grid._print_event_row = function(ev, objName){\n\n\tvar styles = [];\n\tif(ev.color)\n\t\tstyles.push(\"--dhx-scheduler-event-background:\"+ev.color);\n\tif(ev.textColor)\n\t\tstyles.push(\"--dhx-scheduler-event-color:\"+ev.textColor);\n\tif(ev._text_style)\n\t\tstyles.push(ev._text_style);\n\tif(scheduler[objName]['rowHeight'])\n\t\t\tstyles.push('height:'+scheduler[objName]['rowHeight'] + 'px');\n\n\tvar style = \"\";\n\tif(styles.length){\n\t\tstyle = \"style='\"+styles.join(\";\")+\"'\";\n\t}\n\n\tvar columns = scheduler[objName].columns;\n\tvar ev_class = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\n\tif(scheduler.getState().select_id == ev.id){\n\t\tev_class += \" dhx_grid_event_selected\";\n\t}\n\n\tvar ariaRowAttr = scheduler._waiAria.gridRowAttrString(ev);\n\n\tvar html =\"<tr \"+ariaRowAttr+\" class='dhx_grid_event\"+(ev_class? ' '+ev_class:'')+\"' event_id='\"+ev.id+\"' \"+scheduler.config.event_attribute+\"='\"+ev.id+\"' \" + style + \">\";\n\n\t//var name = scheduler._grid._getViewName(objName);\n\tvar availStyles = [\"text-align\", \"vertical-align\", \"padding-left\",\"padding-right\"];\n\tfor(var i =0; i < columns.length; i++){\n\t\tvar value = scheduler._grid._getCellContent(ev, columns[i]);\n\t\tvar ariaCellAttribute = scheduler._waiAria.gridCellAttrString(ev, columns[i], value);\n\n\t\tvar cell_style = scheduler._grid._getStyles(columns[i], availStyles);\n\n\t\tvar className = columns[i].css ? (\" class=\\\"\"+columns[i].css+\"\\\"\") : \"\";\n\n\t\thtml+= \"<td \"+ariaCellAttribute+\" style='width:\"+ (columns[i].width )+\"px;\"+cell_style.join(\";\")+\"' \"+className+\">\"+value+\"</td>\";\n\n\t}\n\thtml+=\"<td class='dhx_grid_dummy'></td></tr>\";\n\n\treturn html;\n};\n\nscheduler._grid._print_grid_header = function(objName){\n\tvar head = \"<div class='dhx_grid_line'>\";\n\n\tvar columns = scheduler[objName].columns;\n\tvar widths = [];\n\n\tvar unsized_columns = columns.length;\n\tvar avail_width = scheduler._obj.clientWidth - 2*columns.length -20;//-20 for possible scrollbar, -length for borders\n\tfor(var ind=0; ind < columns.length; ind++){\n\n\t\tvar val = columns[ind].initialWidth*1;\n\t\tif(!isNaN(val) && columns[ind].initialWidth !== '' && columns[ind].initialWidth !== null && typeof columns[ind].initialWidth != 'boolean'){\n\n\t\t\tunsized_columns--;\n\t\t\tavail_width -= val;\n\t\t\twidths[ind] = val;\n\t\t}else {\n\t\t\twidths[ind] = null;\n\t\t}\n\t}\n\n\tvar unsized_width = Math.floor(avail_width / unsized_columns);\n\tvar availStyles = [\"text-align\",  \"padding-left\",\"padding-right\"];\n\tfor(var i=0; i < columns.length; i++){\n\t\tvar column_width = !widths[i] ? unsized_width : widths[i];\n\t\tcolumns[i].width = column_width /*- scheduler._grid._calcPadding(columns[i], objName)*/;\n\t\tvar cell_style = scheduler._grid._getStyles(columns[i], availStyles);\n\t\thead += \"<div class='dhx_grid_column_label' style='line-height: \"+scheduler.xy.scale_height+\"px;width:\"+(columns[i].width)+\"px;\"+cell_style.join(\";\")+\"'>\" + (columns[i].label === undefined ? columns[i].id : columns[i].label) + \"</div>\";\n\t}\n\thead +=\"</div>\";\n\n\treturn head;\n};\n\n\n}","export default function(scheduler){\n\nscheduler.attachEvent(\"onTemplatesReady\",function(){\n\tvar els = document.body.getElementsByTagName(\"DIV\");\n\tfor (var i=0; i < els.length; i++) {\n\t\tvar cs = els[i].className||\"\";\n\t\tcs = cs.split(\":\");\n\t\tif (cs.length == 2 && cs[0] == \"template\"){\n\t\t\tvar code = \"return \\\"\"+(els[i].innerHTML||\"\").replace(/\\\\/g, \"\\\\\\\\\").replace(/\"/g,\"\\\\\\\"\").replace(/[\\n\\r]+/g,\"\")+\"\\\";\";\n\t\t\tcode = unescape(code).replace(/\\{event\\.([a-z]+)\\}/g,function(all,mask){\n\t\t\t\treturn '\"+ev.'+mask+'+\"';\n\t\t\t});\n\t\t\tscheduler.templates[cs[1]]=Function(\"start\",\"end\",\"ev\",code);\n\t\t\tels[i].style.display='none';\n\t\t}\n\t}\n});\n\n}","import keyboard_shortcuts from \"./keyboard_navigation/common/keyboard_shortcuts\";\nimport eventhandler from \"./keyboard_navigation/common/eventhandler\";\nimport trap_modal_focus from \"./keyboard_navigation/common/trap_modal_focus\";\nimport marker from \"./keyboard_navigation/marker\";\nimport scheduler_node from \"./keyboard_navigation/elements/scheduler_node\";\nimport nav_node from \"./keyboard_navigation/elements/nav_node\";\nimport header_cell from \"./keyboard_navigation/elements/header_cell\";\nimport event from \"./keyboard_navigation/elements/event\";\nimport time_slot from \"./keyboard_navigation/elements/time_slot\";\nimport minical_button from \"./keyboard_navigation/elements/minical_button\";\nimport minical_cell from \"./keyboard_navigation/elements/minical_cell\";\nimport data_area from \"./keyboard_navigation/elements/data_area\";\nimport modals from \"./keyboard_navigation/modals\";\nimport core from \"./keyboard_navigation/core\";\nimport key_nav_legacy from \"./keyboard_navigation/key_nav_legacy\";\n\n\nimport scheduler_handlers from \"./keyboard_navigation/scheduler_handlers\";\nimport minical_handlers from \"./keyboard_navigation/minical_handlers\";\n\nexport default function(scheduler){\n\t\tscheduler.config.key_nav = true;\n\t\tscheduler.config.key_nav_step = 30;\n\t\tscheduler.addShortcut = function(shortcut, handler, scope){\n\t\t\tvar scopeObject = getScope(scope);\n\t\t\tif(scopeObject){\n\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\n\t\t\t}\n\t\t};\n\n\t\tscheduler.getShortcutHandler = function(shortcut, scope){\n\t\t\tvar scopeObject = getScope(scope);\n\t\t\tif(scopeObject){\n\t\t\t\tvar commands = scheduler.$keyboardNavigation.shortcuts.parse(shortcut);\n\t\t\t\tif(commands.length){\n\t\t\t\t\treturn scopeObject.prototype.findHandler(commands[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tscheduler.removeShortcut = function(shortcut, scope){\n\t\t\tvar scopeObject = getScope(scope);\n\t\t\tif(scopeObject){\n\t\t\t\tscopeObject.prototype.unbind(shortcut);\n\t\t\t}\n\t\t};\n\n\t\tscheduler.focus = function(){\n\t\t\tif(!scheduler.config.key_nav){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar disp = scheduler.$keyboardNavigation.dispatcher;\n\t\t\tdisp.enable();\n\t\t\tvar activeNode = disp.getActiveNode();\n\t\t\tif(!activeNode || activeNode instanceof scheduler.$keyboardNavigation.MinicalButton || activeNode instanceof scheduler.$keyboardNavigation.MinicalCell){\n\t\t\t\tdisp.setDefaultNode();\n\t\t\t}else{\n\t\t\t\tdisp.focusNode(disp.getActiveNode());\n\t\t\t}\n\t\t};\n\n\t\tfunction getScope(mode){\n\t\t\tvar scopes = {\n\t\t\t\t\"minicalButton\":scheduler.$keyboardNavigation.MinicalButton,\n\t\t\t\t\"minicalDate\":scheduler.$keyboardNavigation.MinicalCell,\n\t\t\t\t\"scheduler\":scheduler.$keyboardNavigation.SchedulerNode,\n\t\t\t\t\"dataArea\": scheduler.$keyboardNavigation.DataArea,\n\t\t\t\t\"timeSlot\": scheduler.$keyboardNavigation.TimeSlot,\n\t\t\t\t\"event\": scheduler.$keyboardNavigation.Event\n\t\t\t};\n\n\t\t\tvar searchMap = {};\n\t\t\tfor(var i in scopes)\n\t\t\t\tsearchMap[i.toLowerCase()] = scopes[i];\n\n\t\t\tmode = (mode + \"\").toLowerCase();\n\n\t\t\treturn searchMap[mode] || scopes.scheduler;\n\t\t}\n\n\t\tscheduler.$keyboardNavigation = {};\n\n\t\tscheduler._compose = function(){\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\n\t\t\tvar res = {};\n\t\t\tfor(var i = 0; i < parts.length; i++){\n\t\t\t\tvar obj = parts[i];\n\t\t\t\tif(typeof obj == \"function\"){\n\t\t\t\t\tobj = new obj();\n\t\t\t\t}\n\n\t\t\t\tfor(var p in obj){\n\t\t\t\t\tres[p] = obj[p];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\n\t\tkeyboard_shortcuts(scheduler);\n\t\teventhandler(scheduler);\n\t\ttrap_modal_focus(scheduler);\n\t\tmarker(scheduler);\n\t\tscheduler_node(scheduler);\n\t\tnav_node(scheduler);\n\t\theader_cell(scheduler);\n\t\tevent(scheduler);\n\t\ttime_slot(scheduler);\n\t\tminical_button(scheduler);\n\t\tminical_cell(scheduler);\n\t\tdata_area(scheduler);\n\t\tmodals(scheduler);\n\t\tcore(scheduler);\n\t\tkey_nav_legacy(scheduler);\n\n\t\t(function(){\n\t\t\tscheduler_handlers(scheduler);\n\t\t\tminical_handlers(scheduler);\n\n\t\t\tvar dispatcher = scheduler.$keyboardNavigation.dispatcher;\n\n\t\t\tscheduler.$keyboardNavigation.attachSchedulerHandlers();\n\n\t\t\tif(scheduler.renderCalendar){\n\t\t\t\t// if minical ext loaded before key nav ext - patch it now\n\t\t\t\tscheduler.$keyboardNavigation.patchMinicalendar();\n\t\t\t}else{\n\t\t\t\t// otherwise - wait until everything is loaded and try again\n\t\t\t\tvar attachOnce = scheduler.attachEvent(\"onSchedulerReady\", function(){\n\t\t\t\t\tscheduler.detachEvent(attachOnce);\n\t\t\t\t\tscheduler.$keyboardNavigation.patchMinicalendar();\n\t\t\t\t});\n\t\t\t}\n\n\n\n\t\t\tfunction isSchedulerSelected(){\n\t\t\t\tif(!scheduler.config.key_nav) return;\n\n\t\t\t\tvar enable;\n\t\t\t\tvar focusElement = document.activeElement;\n\t\t\t\t// halt key nav when focus is outside scheduler or in quick info popup\n\t\t\t\tif(!focusElement || scheduler.utils.dom.locateCss(focusElement, \"dhx_cal_quick_info\", false)){\n\t\t\t\t\tenable = false;\n\t\t\t\t}else{\n\t\t\t\t\tenable = scheduler.$keyboardNavigation.isChildOf(focusElement, scheduler.$container) || scheduler.$keyboardNavigation.isMinical(focusElement);\n\t\t\t\t}\n\n\t\t\t\treturn enable;\n\t\t\t}\n\n\n\n\t\t\tfunction changeState(enable){\n\t\t\t\tif(enable && !dispatcher.isEnabled()){\n\t\t\t\t\tdispatcher.enable();\n\t\t\t\t}else if(!enable && dispatcher.isEnabled()){\n\t\t\t\t\tdispatcher.disable();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst intervalId = setInterval(function(){\n\t\t\t\tif(!scheduler.$container || !scheduler.$keyboardNavigation.isChildOf(scheduler.$container, document.body)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar enable = isSchedulerSelected();\n\n\t\t\t\tif(enable){\n\t\t\t\t\tchangeState(enable);\n\t\t\t\t}else if(!enable && dispatcher.isEnabled()){\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tif(scheduler.$destroyed){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// doublecheck in case checking is done in handler before focus element is repainted\n\t\t\t\t\t\tif(scheduler.config.key_nav){\n\t\t\t\t\t\t\tchangeState(isSchedulerSelected());\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tscheduler.$container.removeAttribute(\"tabindex\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, 100);\n\t\t\t\t}\n\t\t\t}, 500);\n\t\t\tscheduler.attachEvent(\"onDestroy\", function(){\n\t\t\t\tclearInterval(intervalId);\n\t\t\t});\n\t\t})();\n\t}\n\n\n","export default function(scheduler){\n\nscheduler.$keyboardNavigation.shortcuts = {\n\tcreateCommand: function(){\n\t\treturn {\n\t\t\tmodifiers:{\n\t\t\t\t\"shift\": false,\n\t\t\t\t\"alt\": false,\n\t\t\t\t\"ctrl\": false,\n\t\t\t\t\"meta\": false\n\t\t\t},\n\t\t\tkeyCode: null\n\t\t};\n\t},\n\tparse: function(shortcut){\n\t\tvar commands = [];\n\n\t\tvar expr = this.getExpressions(this.trim(shortcut));\n\t\tfor(var i = 0; i < expr.length; i++){\n\t\t\tvar words = this.getWords(expr[i]);\n\n\t\t\tvar command = this.createCommand();\n\n\t\t\tfor(var j = 0; j < words.length; j++){\n\t\t\t\tif(this.commandKeys[words[j]]){\n\t\t\t\t\tcommand.modifiers[words[j]] = true;\n\t\t\t\t}else if(this.specialKeys[words[j]]){\n\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\n\t\t\t\t}else{\n\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcommands.push(command);\n\t\t}\n\t\treturn commands;\n\t},\n\n\tgetCommandFromEvent: function(domEvent){\n\t\tvar command = this.createCommand();\n\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\n\t\tcommand.modifiers.alt = !!domEvent.altKey;\n\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\n\t\tcommand.modifiers.meta = !!domEvent.metaKey;\n\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\n\n\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\n\t\t\t// numpad keys 96-105 -> 48-57\n\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\n\t\t}\n\n\t\tvar printableKey = String.fromCharCode(command.keyCode );\n\t\tif(printableKey){\n\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\n\t\t}\n\t\treturn command;\n\t},\n\n\tgetHashFromEvent: function(domEvent){\n\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\n\t},\n\n\tgetHash: function(command){\n\t\tvar parts = [];\n\t\tfor(var i in command.modifiers){\n\t\t\tif(command.modifiers[i]){\n\t\t\t\tparts.push(i);\n\t\t\t}\n\t\t}\n\t\tparts.push(command.keyCode);\n\n\t\treturn parts.join(this.junctionChar);\n\t},\n\n\tgetExpressions: function(shortcut){\n\t\treturn shortcut.split(this.junctionChar);\n\t},\n\tgetWords: function(term){\n\t\treturn term.split(this.combinationChar);\n\t},\n\ttrim: function(shortcut){\n\t\treturn shortcut.replace(/\\s/g, \"\");\n\t},\n\tjunctionChar:\",\",\n\tcombinationChar:\"+\",\n\tcommandKeys:{\n\t\t\"shift\": 16,\n\t\t\"alt\": 18,\n\t\t\"ctrl\": 17,\n\t\t\"meta\": true\n\t},\n\tspecialKeys:{\n\t\t\"backspace\": 8,\n\t\t\"tab\": 9,\n\t\t\"enter\": 13,\n\t\t\"esc\": 27,\n\t\t\"space\": 32,\n\t\t\"up\": 38,\n\t\t\"down\": 40,\n\t\t\"left\": 37,\n\t\t\"right\": 39,\n\t\t\"home\": 36,\n\t\t\"end\": 35,\n\t\t\"pageup\": 33,\n\t\t\"pagedown\": 34,\n\t\t\"delete\": 46,\n\t\t\"insert\": 45,\n\t\t\"plus\":107,\n\t\t\"f1\": 112,\n\t\t\"f2\": 113,\n\t\t\"f3\": 114,\n\t\t\"f4\": 115,\n\t\t\"f5\": 116,\n\t\t\"f6\": 117,\n\t\t\"f7\": 118,\n\t\t\"f8\": 119,\n\t\t\"f9\": 120,\n\t\t\"f10\": 121,\n\t\t\"f11\": 122,\n\t\t\"f12\": 123\n\t}\n};\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.EventHandler = {\n\t_handlers: null,\n\tfindHandler: function(command){\n\t\tif(!this._handlers) this._handlers = {};\n\t\tvar shortcuts = scheduler.$keyboardNavigation.shortcuts;\n\t\tvar hash = shortcuts.getHash(command);\n\n\t\treturn this._handlers[hash];\n\t},\n\n\tdoAction: function(command, e){\n\t\tvar handler = this.findHandler(command);\n\t\tif(handler){\n\t\t\thandler.call(this, e);\n\n\t\t\tif (e.preventDefault) e.preventDefault();\n\t\t\telse e.returnValue = false;\n\n\t\t}\n\t},\n\tbind: function(shortcut, handler){\n\t\tif(!this._handlers) this._handlers = {};\n\n\t\tvar shortcuts = scheduler.$keyboardNavigation.shortcuts;\n\n\t\tvar commands = shortcuts.parse(shortcut);\n\t\tfor(var i = 0; i < commands.length; i++){\n\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\n\t\t}\n\t},\n\tunbind: function(shortcut){\n\t\tvar shortcuts = scheduler.$keyboardNavigation.shortcuts;\n\n\t\tvar commands = shortcuts.parse(shortcut);\n\t\tfor(var i = 0; i < commands.length; i++){\n\t\t\tif(this._handlers[shortcuts.getHash(commands[i])]){\n\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\n\t\t\t}\n\t\t}\n\t},\n\n\tbindAll: function(map){\n\t\tfor(var i in map){\n\t\t\tthis.bind(i, map[i]);\n\t\t}\n\t},\n\tinitKeys: function(){\n\t\tif(!this._handlers)\n\t\t\tthis._handlers = {};\n\t\tif(this.keys){\n\t\t\tthis.bindAll(this.keys);\n\t\t}\n\t}\n};\n\n}","export default function(scheduler){\n\n(function(){\n\tscheduler.$keyboardNavigation.getFocusableNodes = scheduler._getFocusableNodes;\n\n\tscheduler.$keyboardNavigation.trapFocus = function trapFocus(root, e){\n\t\tif(e.keyCode != 9) return false;\n\n\t\tvar focusable = scheduler.$keyboardNavigation.getFocusableNodes(root);\n\t\tvar currentFocus = document.activeElement;\n\t\tvar currentIndex = -1;\n\t\tfor(var i = 0; i < focusable.length; i++){\n\t\t\tif(focusable[i] == currentFocus){\n\t\t\t\tcurrentIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tvar nextIndex, nextItem;\n\t\tif(e.shiftKey){\n\n\t\t\t// back tab\n\t\t\t// go to the last element if we focused on the first\n\t\t\tnextIndex = (currentIndex <= 0) ? (focusable.length - 1) : (currentIndex - 1);\n\n\t\t\tnextItem = focusable[nextIndex];\n\t\t\tif(nextItem){\n\t\t\t\tnextItem.focus();\n\t\t\t\te.preventDefault();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t}else{\n\t\t\t// forward tab\n\t\t\t// forward tab from last element should go back to the first element\n\t\t\tnextIndex = (currentIndex >= focusable.length - 1) ? 0 : (currentIndex + 1);\n\t\t\tnextItem = focusable[nextIndex];\n\t\t\tif(nextItem){\n\t\t\t\tnextItem.focus();\n\t\t\t\te.preventDefault();\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\t};\n})();\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.marker = {\n\tclear: function(){\n\t\tvar divs = scheduler.$container.querySelectorAll(\".dhx_focus_slot\");\n\t\tfor(var i = 0; i < divs.length; i++){\n\t\t\tdivs[i].parentNode.removeChild(divs[i]);\n\t\t}\n\t},\n\tcreateElement: function(){\n\t\tvar element = document.createElement(\"div\");\n\t\telement.setAttribute(\"tabindex\", -1);\n\t\telement.className = \"dhx_focus_slot\";\n\t\treturn element;\n\t},\n\n\trenderMultiple: function(start, end, method){\n\t\tvar divs = [];\n\t\tvar currentStart = new Date(start);\n\t\tvar currentEnd = new Date(Math.min(end.valueOf(), scheduler.date.add(scheduler.date.day_start(new Date(start)), 1, \"day\").valueOf()));\n\t\twhile(currentStart.valueOf() < end.valueOf()){\n\n\t\t\tdivs = divs.concat(method.call(this, currentStart, new Date(Math.min(currentEnd.valueOf(), end.valueOf()))));\n\t\t\tcurrentStart = scheduler.date.day_start(scheduler.date.add(currentStart, 1, \"day\"));\n\n\t\t\tcurrentEnd = scheduler.date.day_start(scheduler.date.add(currentStart, 1, \"day\"));\n\t\t\tcurrentEnd = new Date(Math.min(currentEnd.valueOf(), end.valueOf()));\n\t\t}\n\n\t\treturn divs;\n\t},\n\n\n\trender: function(start, end, section){\n\t\tthis.clear();\n\t\tvar divs = [];\n\n\t\tvar modes = scheduler.$keyboardNavigation.TimeSlot.prototype._modes;\n\t\tvar view = scheduler.$keyboardNavigation.TimeSlot.prototype._getMode();\n\t\tswitch (view){\n\t\t\tcase modes.units:\n\t\t\t\tdivs = this.renderVerticalMarker(start, end, section);\n\t\t\t\tbreak;\n\t\t\tcase modes.timeline:\n\t\t\t\tdivs = this.renderTimelineMarker(start, end, section);\n\t\t\t\tbreak;\n\t\t\tcase modes.year:\n\t\t\t\tdivs = divs.concat(this.renderMultiple(start, end, this.renderYearMarker));\n\t\t\t\tbreak;\n\t\t\tcase modes.month:\n\t\t\t\tdivs = this.renderMonthMarker(start, end);\n\t\t\t\tbreak;\n\t\t\tcase modes.weekAgenda:\n\t\t\t\tdivs = divs.concat(this.renderMultiple(start, end, this.renderWeekAgendaMarker));\n\t\t\t\tbreak;\n\t\t\tcase modes.list:\n\t\t\t\tdivs = this.renderAgendaMarker(start, end);\n\t\t\t\tbreak;\n\t\t\tcase modes.dayColumns:\n\t\t\t\tdivs = divs.concat(this.renderMultiple(start, end, this.renderVerticalMarker));\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.addWaiAriaLabel(divs, start, end, section);\n\t\tthis.addDataAttributes(divs, start, end, section);\n\n\t\tfor(var i = divs.length - 1; i >= 0; i--){\n\t\t\tif(divs[i].offsetWidth){\n\t\t\t\treturn divs[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\taddDataAttributes: function(divs, start, end, section){\n\t\tvar dateToStr = scheduler.date.date_to_str(scheduler.config.api_date);\n\n\t\tvar from = dateToStr(start),\n\t\t\tto = dateToStr(end);\n\n\t\tfor(var i = 0; i < divs.length; i++){\n\t\t\tdivs[i].setAttribute(\"data-start-date\", from);\n\t\t\tdivs[i].setAttribute(\"data-end-date\", to);\n\t\t\tif(section){\n\t\t\t\tdivs[i].setAttribute(\"data-section\", section);\n\t\t\t}\n\t\t}\n\t},\n\n\taddWaiAriaLabel: function(divs, start, end, section){\n\t\tvar label = \"\";\n\t\tvar state = scheduler.getState();\n\t\tvar mode = state.mode;\n\n\t\tvar dateTimeLabel = false;\n\n\t\tlabel += scheduler.templates.day_date(start);\n\n\t\tif((scheduler.date.day_start(new Date(start)).valueOf() != start.valueOf())){\n\t\t\tlabel += \" \" + scheduler.templates.hour_scale(start);\n\t\t\tdateTimeLabel = true;\n\t\t}\n\n\t\tif((scheduler.date.day_start(new Date(start)).valueOf() != scheduler.date.day_start(new Date(end)).valueOf())){\n\n\t\t\tlabel += \" - \" + scheduler.templates.day_date(end);\n\t\t\tif(dateTimeLabel || (scheduler.date.day_start(new Date(end)).valueOf() != end.valueOf())){\n\t\t\t\tlabel += \" \" + scheduler.templates.hour_scale(end);\n\t\t\t}\n\t\t}\n\n\t\tif(section){\n\t\t\tif(scheduler.matrix && scheduler.matrix[mode]){\n\t\t\t\tconst timeline = scheduler.matrix[mode];\n\t\t\t\tconst sectionObject = timeline.y_unit[timeline.order[section]];\n\t\t\t\tlabel += \", \" + scheduler.templates[mode + \"_scale_label\"](sectionObject.key, sectionObject.label, sectionObject);\n\t\t\t}else if(scheduler._props && scheduler._props[mode]){\n\t\t\t\tconst units = scheduler._props[mode];\n\t\t\t\tconst sectionObject = units.options[units.order[section]];\n\n\t\t\t\tlabel += \", \" + scheduler.templates[mode + \"_scale_text\"](sectionObject.key, sectionObject.label, sectionObject);\n\t\t\t}\n\t\t}\n\n\n\t\tfor(var i = 0; i < divs.length; i++){\n\t\t\tscheduler._waiAria.setAttributes(divs[i], {\n\t\t\t\t\"aria-label\": label,\n\t\t\t\t\"aria-live\": \"polite\"\n\t\t\t});\n\t\t}\n\t},\n\n\trenderWeekAgendaMarker: function(start_date, end_date){\n\t\tvar divs = scheduler.$container.querySelectorAll(\".dhx_wa_day_cont .dhx_wa_scale_bar\");\n\n\t\tvar currDate = scheduler.date.week_start(new Date(scheduler.getState().min_date));\n\n\t\tvar index = -1;\n\t\tvar markerDate = scheduler.date.day_start(new Date(start_date));\n\t\tfor(var i = 0; i < divs.length; i++){\n\t\t\tindex++;\n\t\t\tif(scheduler.date.day_start(new Date(currDate)).valueOf() == markerDate.valueOf()){\n\t\t\t\tbreak;\n\t\t\t}else{\n\t\t\t\tcurrDate = scheduler.date.add(currDate, 1, \"day\");\n\t\t\t}\n\t\t}\n\t\tif(index != -1) return this._wrapDiv(divs[index]);\n\t\treturn [];\n\t},\n\n\t_wrapDiv: function(cell){\n\t\tvar marker = this.createElement();\n\t\tmarker.style.top = cell.offsetTop + \"px\";\n\t\tmarker.style.left = cell.offsetLeft + \"px\";\n\t\tmarker.style.width = cell.offsetWidth + \"px\";\n\t\tmarker.style.height = cell.offsetHeight + \"px\";\n\t\tcell.appendChild(marker);\n\t\treturn [marker];\n\t},\n\trenderYearMarker: function(start_date, end_date){\n\t\tvar cell = scheduler._get_year_cell(start_date);\n\t\tcell.style.position = \"relative\";\n\t\tvar marker = this.createElement();\n\t\tmarker.style.top = \"0px\";\n\t\tmarker.style.left = \"0px\";\n\t\tmarker.style.width = \"100%\";\n\t\tmarker.style.height = \"100%\";\n\t\tcell.appendChild(marker);\n\t\treturn [marker];\n\t},\n\n\trenderAgendaMarker: function(start_date, end_date){\n\t\tvar block = this.createElement();\n\t\tblock.style.height = \"1px\";\n\t\tblock.style.width = \"100%\";\n\t\tblock.style.opacity = 1;\n\t\tblock.style.top = \"0px\";\n\t\tblock.style.left = \"0px\";\n\t\tscheduler.$container.querySelector(\".dhx_cal_data\").appendChild(block);\n\t\treturn [block];\n\t},\n\n\trenderTimelineMarker: function(start_date, end_date, section){\n\t\tvar view_opts = scheduler._lame_copy({}, scheduler.matrix[scheduler._mode]);\n\t\tvar areas = view_opts._scales;\n\t\t//timespans must always use actual position, not rounded\n\t\tview_opts.round_position = false;\n\t\tvar blocks = [];\n\n\t\tvar min_date = start_date ? new Date(start_date) : scheduler._min_date;\n\t\tvar max_date = end_date ? new Date(end_date) : scheduler._max_date;\n\n\t\tif(min_date.valueOf() < scheduler._min_date.valueOf())\n\t\t\tmin_date = new Date(scheduler._min_date);\n\t\tif(max_date.valueOf() > scheduler._max_date.valueOf())\n\t\t\tmax_date = new Date(scheduler._max_date);\n\n\t\tif(!view_opts._trace_x) return blocks;\n\n\t\tfor(var i = 0; i < view_opts._trace_x.length; i++){\n\t\t\tif(scheduler._is_column_visible(view_opts._trace_x[i]))\n\t\t\t\tbreak;\n\t\t}\n\t\tif(i == view_opts._trace_x.length)\n\t\t\treturn blocks;\n\n\t\tvar area = areas[section];\n\n\t\tif (!(min_date < end_date && max_date > start_date))\n\t\t\treturn blocks;\n\n\t\tvar block = this.createElement();\n\n\t\tlet start_pos;\n\t\tlet end_pos;\n\n\t\tfunction set_date_part(source, target) {\n\t\t\t// reset to start of the month in order to prevent month change when target is on 31th day, and source month has only 30 days\n\t\t\ttarget.setDate(1);\n\n\t\t\ttarget.setFullYear(source.getFullYear());\n\t\t\ttarget.setMonth(source.getMonth());\n\t\t\ttarget.setDate(source.getDate());\n\t\t}\n\n\t\tif(!scheduler.getView().days){\n\t\t\tstart_pos = scheduler._timeline_getX({start_date: start_date}, false, view_opts);\n\t\t\tend_pos = scheduler._timeline_getX({start_date: end_date}, false, view_opts);\n\t\t}else{\n\t\t\t// daytimeline\n\t\t\tconst tempStart = new Date(start_date);\n\t\t\tset_date_part(scheduler._min_date, tempStart);\n\t\t\tconst tempEnd = new Date(end_date);\n\t\t\tset_date_part(scheduler._min_date, tempEnd);\n\t\t\tstart_pos = scheduler._timeline_getX({start_date: tempStart}, false, view_opts);\n\t\t\tend_pos = scheduler._timeline_getX({start_date: tempEnd}, false, view_opts);\n\t\t}\n\n\t\tvar height = ((view_opts._section_height[section]-1) || (view_opts.dy - 1));\n\n\t\tvar top = 0;\n\t\tif (scheduler._isRender('cell')){\n\t\t\ttop = area.offsetTop;\n\t\t\tstart_pos += view_opts.dx;\n\t\t\tend_pos += view_opts.dx;\n\t\t\tarea = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t}else{\n\n\t\t}\n\t\tvar width = Math.max(1, end_pos - start_pos - 1);\n\t\tlet direction = \"left\";\n\t\tif(scheduler.config.rtl){\n\t\t\tdirection = \"right\";\n\t\t}\n\t\tblock.style.cssText = `height:${height}px; ${direction}:${start_pos}px; width:${width}px; top:${top}px;`;\n\n\t\tif(area){\n\t\t\tarea.appendChild(block);\n\t\t\tblocks.push(block);\n\t\t}\n\n\t\treturn blocks;\n\t},\n\n\trenderMonthCell: function(date){\n\t\tvar cells = scheduler.$container.querySelectorAll(\".dhx_month_head\");\n\n\t\tvar divs = [];\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tdivs.push(cells[i].parentNode);\n\t\t}\n\n\t\tvar firstDate = scheduler.date.week_start(new Date(scheduler.getState().min_date));\n\n\t\tvar index = -1;\n\t\tvar weekNumber = 0;\n\t\tvar dayIndex = -1;\n\t\tvar currDate = firstDate;\n\t\tvar markerDate = scheduler.date.day_start(new Date(date));\n\t\tfor(var i = 0; i < divs.length; i++){\n\t\t\tindex++;\n\n\t\t\tif(dayIndex == 6){\n\t\t\t\tweekNumber++;\n\t\t\t\tdayIndex = 0;\n\t\t\t}else{\n\t\t\t\tdayIndex++;\n\t\t\t}\n\n\t\t\tif(scheduler.date.day_start(new Date(currDate)).valueOf() == markerDate.valueOf()){\n\t\t\t\tbreak;\n\t\t\t}else{\n\t\t\t\tcurrDate = scheduler.date.add(currDate, 1, \"day\");\n\t\t\t}\n\t\t}\n\n\t\tif(index == -1){\n\t\t\treturn [];\n\t\t}\n\n\t\tvar left = scheduler._colsS[dayIndex];\n\t\tvar top = scheduler._colsS.heights[weekNumber];\n\n\t\tvar div = this.createElement();\n\t\tdiv.style.top = top + \"px\";\n\t\tdiv.style.left = left + \"px\";\n\t\tdiv.style.width = scheduler._cols[dayIndex] + \"px\";\n\t\tdiv.style.height = ((scheduler._colsS.heights[weekNumber + 1] - top) || scheduler._colsS.height) + \"px\" ;\n\n\n\t\tvar container = scheduler.$container.querySelector(\".dhx_cal_data\");\n\n\t\tvar datatable = container.querySelector(\".dhx_cal_month_table\");\n\t\tif(datatable.nextSibling){\n\t\t\tcontainer.insertBefore(div, datatable.nextSibling);\n\t\t}else{\n\t\t\tcontainer.appendChild(div);\n\t\t}\n\t\treturn div;\n\t},\n\trenderMonthMarker: function(start_date, end_date){\n\t\tvar res = [];\n\t\tvar currentDate = start_date;\n\t\twhile(currentDate.valueOf() < end_date.valueOf()){\n\t\t\tres.push(this.renderMonthCell(currentDate));\n\t\t\tcurrentDate = scheduler.date.add(currentDate, 1, \"day\");\n\t\t}\n\t\treturn res;\n\t},\n\n\trenderVerticalMarker: function(start_date, end_date, section){\n\t\tvar index = scheduler.locate_holder_day(start_date);\n\n\t\tvar divs = [];\n\t\tvar area = null;\n\n\t\tvar c = scheduler.config;\n\t\tif(scheduler._ignores[index]) return divs;\n\n\t\tif (scheduler._props && scheduler._props[scheduler._mode] && section) {\n\t\t\tvar view = scheduler._props[scheduler._mode];\n\t\t\tindex = view.order[section];\n\n\t\t\tvar inner_index = view.order[section];\n\t\t\tif(!(view.days > 1)){\n\t\t\t\tindex = inner_index;\n\t\t\t\tif (view.size && (index > view.position+view.size)) {\n\t\t\t\t\tindex = 0;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t//var units_l = view.size || view.options.length;\n\n\t\t\t\tindex = scheduler.locate_holder_day(start_date) + inner_index;\n\t\t\t\t//index = index*units_l + inner_index;\n\t\t\t}\n\t\t}\n\t\tarea = scheduler.locate_holder(index);\n\t\tif(!area || area.querySelector(\".dhx_scale_hour\")){\n\t\t\t// hour scale instead of date column\n\t\t\treturn document.createElement(\"div\");\n\t\t}\n\n\t\tvar start = Math.max((start_date.getHours()*60 + start_date.getMinutes()), c.first_hour*60);\n\n\n\t\tvar end = Math.min((end_date.getHours()*60 + end_date.getMinutes()), c.last_hour*60);\n\t\tif(!end && (scheduler.date.day_start(new Date(end_date)).valueOf() > scheduler.date.day_start(new Date(start_date)).valueOf())){\n\t\t\tend = c.last_hour*60;\n\t\t}\n\n\t\tif (end <= start) {\n\t\t\treturn [];\n\t\t}\n\n\t\tvar block = this.createElement();\n\n\t\t// +1 for working with section which really takes up whole height (as % would be == 0)\n\t\tvar all_hours_height = scheduler.config.hour_size_px*c.last_hour + 1;\n\t\tvar hour_ms = 60*60*1000;\n\t\tblock.style.top = (Math.round((start*60*1000-scheduler.config.first_hour*hour_ms)*scheduler.config.hour_size_px/hour_ms) % all_hours_height) + \"px\";\n\t\tblock.style.lineHeight = block.style.height = Math.max((Math.round(((end-start)*60*1000)*scheduler.config.hour_size_px/hour_ms)) % all_hours_height, 1)+\"px\";\n\t\tblock.style.width = \"100%\";\n\t\tarea.appendChild(block);\n\t\tdivs.push(block);\n\t\treturn divs[0];\n\n\t}\n};\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.SchedulerNode = function(){};\n\nscheduler.$keyboardNavigation.SchedulerNode.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.EventHandler,\n\t{\n\t\tgetDefaultNode: function(){\n\t\t\tvar node = new scheduler.$keyboardNavigation.TimeSlot();\n\n\t\t\tif(!node.isValid()){\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\t_modes:{\n\t\t\tmonth: \"month\",\n\t\t\tyear: \"year\",\n\t\t\tdayColumns: \"dayColumns\",\n\t\t\ttimeline:\"timeline\",\n\t\t\tunits:\"units\",\n\t\t\tweekAgenda: \"weekAgenda\",\n\t\t\tlist: \"list\"\n\t\t},\n\t\tgetMode: function(){\n\t\t\tvar state = scheduler.getState();\n\n\t\t\tvar mode = state.mode;\n\t\t\tif((scheduler.matrix && scheduler.matrix[mode])){\n\t\t\t\treturn this._modes.timeline;\n\t\t\t} else if((scheduler._props && scheduler._props[mode])){\n\t\t\t\treturn this._modes.units;\n\t\t\t}else if(mode == \"month\"){\n\t\t\t\treturn this._modes.month;\n\t\t\t}else if(mode == \"year\"){\n\t\t\t\treturn this._modes.year;\n\t\t\t}else if(mode == \"week_agenda\"){\n\t\t\t\treturn this._modes.weekAgenda;\n\t\t\t}else if(mode == \"map\" || mode == \"agenda\" || (scheduler._grid && scheduler[\"grid_\" + mode])){\n\t\t\t\treturn this._modes.list;\n\t\t\t}else{\n\t\t\t\treturn this._modes.dayColumns;\n\t\t\t}\n\t\t},\n\n\t\tfocus: function(){\n\t\t\tscheduler.focus();\n\t\t},\n\n\t\tblur: function(){\n\n\t\t},\n\n\t\tdisable: function(){\n\t\t\tscheduler.$container.setAttribute(\"tabindex\", \"0\");\n\t\t},\n\t\tenable: function(){\n\t\t\tif(scheduler.$container)\n\t\t\t\tscheduler.$container.removeAttribute(\"tabindex\");\n\t\t},\n\t\tisEnabled: function(){\n\t\t\treturn scheduler.$container.hasAttribute(\"tabindex\");\n\t\t},\n\n\n\t\t_compareEvents: function(a, b){\n\t\t\tif (a.start_date.valueOf() == b.start_date.valueOf())\n\t\t\t\treturn a.id > b.id ? 1 : -1;\n\t\t\treturn a.start_date.valueOf() > b.start_date.valueOf() ? 1 : -1;\n\t\t},\n\n\t\t_pickEvent: function(from, to, startId, reverse){\n\t\t\tvar range = scheduler.getState();\n\t\t\tfrom = new Date(Math.max(range.min_date.valueOf(), from.valueOf()));\n\t\t\tto = new Date(Math.min(range.max_date.valueOf(), to.valueOf()));\n\n\t\t\tvar evs = scheduler.getEvents(from, to);\n\t\t\tevs.sort(this._compareEvents);\n\t\t\tif(reverse){\n\t\t\t\tevs = evs.reverse();\n\t\t\t}\n\n\t\t\tvar trim = !!startId;\n\t\t\tfor(var i =0; i < evs.length && trim; i++){\n\t\t\t\tif(evs[i].id == startId){\n\t\t\t\t\ttrim = false;\n\t\t\t\t}\n\t\t\t\tevs.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\n\t\t\tfor(var i = 0; i < evs.length; i++){\n\t\t\t\tvar eventElement = new scheduler.$keyboardNavigation.Event(evs[i].id);\n\t\t\t\tif(eventElement.getNode())\n\t\t\t\t\treturn evs[i];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tnextEventHandler: function(id){\n\t\t\tvar activeNode = scheduler.$keyboardNavigation.dispatcher.activeNode;\n\n\t\t\tvar startId = id || (activeNode && activeNode.eventId);\n\n\t\t\tvar nextEvent = null;\n\t\t\tif(startId && scheduler.getEvent(startId)){\n\t\t\t\tvar currEvent = scheduler.getEvent(startId);\n\n\t\t\t\tnextEvent = scheduler.$keyboardNavigation.SchedulerNode.prototype._pickEvent(\n\t\t\t\t\tcurrEvent.start_date,\n\t\t\t\t\tscheduler.date.add(currEvent.start_date, 1, \"year\"),\n\t\t\t\t\tcurrEvent.id,\n\t\t\t\t\tfalse\n\t\t\t\t);\n\n\t\t\t}\n\t\t\tif(!nextEvent && !id){\n\t\t\t\tvar visibleDates = scheduler.getState();\n\n\t\t\t\tnextEvent = scheduler.$keyboardNavigation.SchedulerNode.prototype._pickEvent(\n\t\t\t\t\tvisibleDates.min_date,\n\t\t\t\t\tscheduler.date.add(visibleDates.min_date, 1, \"year\"),\n\t\t\t\t\tnull,\n\t\t\t\t\tfalse\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(nextEvent){\n\n\t\t\t\tvar nextEv = new scheduler.$keyboardNavigation.Event(nextEvent.id);\n\t\t\t\tif(!nextEv.isValid()){// not visible event\n\t\t\t\t\tthis.nextEventHandler(nextEvent.id);\n\t\t\t\t}else{\n\t\t\t\t\tif(activeNode){activeNode.blur();}\n\t\t\t\t\tscheduler.$keyboardNavigation.dispatcher.setActiveNode(nextEv);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tprevEventHandler: function(id){\n\t\t\tvar activeNode = scheduler.$keyboardNavigation.dispatcher.activeNode;\n\n\t\t\tvar startId = id || (activeNode && activeNode.eventId);\n\n\t\t\tvar nextEvent = null;\n\t\t\tif(startId && scheduler.getEvent(startId)){\n\t\t\t\tvar currEvent = scheduler.getEvent(startId);\n\n\t\t\t\tnextEvent = scheduler.$keyboardNavigation.SchedulerNode.prototype._pickEvent(\n\t\t\t\t\tscheduler.date.add(currEvent.end_date, -1, \"year\"),\n\t\t\t\t\tcurrEvent.end_date,\n\t\t\t\t\tcurrEvent.id,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\tif(!nextEvent && !id){\n\t\t\t\tvar visibleDates = scheduler.getState();\n\n\t\t\t\tnextEvent = scheduler.$keyboardNavigation.SchedulerNode.prototype._pickEvent(\n\t\t\t\t\tscheduler.date.add(visibleDates.max_date, -1, \"year\"),\n\t\t\t\t\tvisibleDates.max_date,\n\t\t\t\t\tnull,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(nextEvent){\n\t\t\t\tvar nextEv = new scheduler.$keyboardNavigation.Event(nextEvent.id);\n\t\t\t\tif(!nextEv.isValid()){// not visible event\n\t\t\t\t\tthis.prevEventHandler(nextEvent.id);\n\t\t\t\t}else{\n\t\t\t\t\tif(activeNode){activeNode.blur();}\n\t\t\t\t\tscheduler.$keyboardNavigation.dispatcher.setActiveNode(nextEv);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tkeys: {\n\n\t\t\t\"alt+1, alt+2, alt+3, alt+4, alt+5, alt+6, alt+7, alt+8, alt+9\": function(e){\n\t\t\t\tvar tabs = scheduler.$keyboardNavigation.HeaderCell.prototype.getNodes(\".dhx_cal_navline .dhx_cal_tab\");\n\t\t\t\tvar key = e.key;\n\t\t\t\tif(key === undefined){\n\t\t\t\t\tkey = e.keyCode - 48;\n\t\t\t\t}\n\t\t\t\tif(tabs[key*1 - 1]){\n\t\t\t\t\ttabs[key*1 - 1].click();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t\"ctrl+left,meta+left\": function(e){\n\t\t\t\tscheduler._click.dhx_cal_prev_button();\n\t\t\t},\n\t\t\t\"ctrl+right,meta+right\": function(e){\n\t\t\t\tscheduler._click.dhx_cal_next_button();\n\t\t\t},\n\t\t\t\"ctrl+up,meta+up\":function(e){\n\t\t\t\tvar dataArea = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t\t\tdataArea.scrollTop -= 20;\n\t\t\t},\n\t\t\t\"ctrl+down,meta+down\": function(e){\n\t\t\t\tvar dataArea = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t\t\tdataArea.scrollTop += 20;\n\t\t\t},\n\n\n\t\t\t\"e\": function(){\n\t\t\t\tthis.nextEventHandler();\n\t\t\t},\n\n\t\t\t\"home\": function(){\n\t\t\t\tscheduler.setCurrentView(new Date());\n\t\t\t},\n\n\t\t\t\"shift+e\": function(){\n\t\t\t\tthis.prevEventHandler();\n\t\t\t},\n\n\t\t\t\"ctrl+enter,meta+enter\": function(){\n\t\t\t\tscheduler.addEventNow({start_date: new Date(scheduler.getState().date)});\n\t\t\t},\n\n\t\t\t\"ctrl+c,meta+c\": function(e){\n\t\t\t\tscheduler._key_nav_copy_paste(e);\n\t\t\t},\n\t\t\t\"ctrl+v,meta+v\": function(e){\n\t\t\t\tscheduler._key_nav_copy_paste(e);\n\t\t\t},\n\t\t\t\"ctrl+x,meta+x\": function(e){\n\t\t\t\tscheduler._key_nav_copy_paste(e);\n\t\t\t}\n\n\t\t}\n\t}\n);\n\nscheduler.$keyboardNavigation.SchedulerNode.prototype.bindAll(scheduler.$keyboardNavigation.SchedulerNode.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.KeyNavNode = function(){};\n\nscheduler.$keyboardNavigation.KeyNavNode.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.EventHandler,\n\t{\n\t\tisValid: function(){\n\t\t\treturn true;\n\t\t},\n\t\tfallback: function(){\n\t\t\treturn null;\n\t\t},\n\n\t\tmoveTo: function (element) {\n\t\t\tscheduler.$keyboardNavigation.dispatcher.setActiveNode(element);\n\t\t},\n\n\t\tcompareTo: function(b){\n\t\t\t// good enough comparison of two random objects\n\t\t\tif(!b) return false;\n\t\t\tfor(var i in this){\n\t\t\t\tif(!!this[i] != !!b[i]) return false;\n\n\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\n\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\n\t\t\t\tif(canStringifyThat != canStringifyThis) return false;\n\t\t\t\tif(!(canStringifyThat && canStringifyThis)) {\n\t\t\t\t\tif(b[i] != this[i]) return false;\n\t\t\t\t}else{\n\t\t\t\t\tif(b[i].toString() != this[i].toString())\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\tgetNode: function(){},\n\t\tfocus: function(){\n\t\t\tvar node = this.getNode();\n\t\t\tif(node){\n\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t//node.className += \" scheduler_focused\";\n\t\t\t\tif(node.focus) node.focus();\n\t\t\t}\n\n\t\t},\n\t\tblur: function(){\n\t\t\tvar node = this.getNode();\n\t\t\tif(node){\n\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t//node.className = (node.className || \"\").replace(/ ?scheduler_focused/g, \"\");\n\t\t\t}\n\t\t}\n\t}\n\n);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.HeaderCell = function(index){\n\tthis.index = index || 0;\n};\n\nscheduler.$keyboardNavigation.HeaderCell.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.KeyNavNode,\n\t{\n\t\tgetNode: function(index){\n\t\t\tindex = index || this.index || 0;\n\t\t\tvar nodes = this.getNodes();\n\t\t\tif(nodes[index]) return nodes[index];\n\t\t},\n\n\t\tgetNodes: function(selector){\n\t\t\tselector = selector || [\n\t\t\t\t\t\".dhx_cal_navline .dhx_cal_prev_button\",\n\t\t\t\t\t\".dhx_cal_navline .dhx_cal_next_button\",\n\t\t\t\t\t\".dhx_cal_navline .dhx_cal_today_button\",\n\t\t\t\t\t\".dhx_cal_navline .dhx_cal_tab\"\n\t\t\t\t].join(\", \");\n\n\t\t\tvar nodes = Array.prototype.slice.call(scheduler.$container.querySelectorAll(selector));\n\t\t\tnodes.sort(function(a, b){\n\t\t\t\treturn a.offsetLeft - b.offsetLeft;\n\t\t\t});\n\t\t\treturn nodes;\n\t\t},\n\n\t\t_handlers:null,\n\n\t\tisValid: function(){\n\t\t\treturn !!this.getNode(this.index);\n\t\t},\n\t\tfallback:function(){\n\t\t\tvar defaultCell = this.getNode(0);\n\t\t\tif(!defaultCell){\n\t\t\t\tdefaultCell = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\t}\n\t\t\treturn defaultCell;\n\t\t},\n\n\t\tkeys: {\n\t\t\t\"left\": function(){\n\t\t\t\tvar newIndex = this.index - 1;\n\t\t\t\tif(newIndex < 0){\n\t\t\t\t\tnewIndex = this.getNodes().length - 1;\n\t\t\t\t}\n\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.HeaderCell(newIndex));\n\n\t\t\t},\n\t\t\t\"right\": function () {\n\t\t\t\tvar newIndex = this.index + 1;\n\t\t\t\tif(newIndex >= this.getNodes().length){\n\t\t\t\t\tnewIndex = 0;\n\t\t\t\t}\n\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.HeaderCell(newIndex));\n\t\t\t},\n\t\t\t\"down\": function () {\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t},\n\n\t\t\t\"enter\": function(){\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif(node){\n\t\t\t\t\tnode.click();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n);\n\nscheduler.$keyboardNavigation.HeaderCell.prototype.bindAll(scheduler.$keyboardNavigation.HeaderCell.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.Event = function(id){\n\tthis.eventId = null;\n\tif(scheduler.getEvent(id)){\n\t\tvar ev = scheduler.getEvent(id);\n\t\tthis.start = new Date(ev.start_date);\n\t\tthis.end = new Date(ev.end_date);\n\n\t\tthis.section = this._getSection(ev);\n\t\tthis.eventId = id;\n\t}\n};\n\nscheduler.$keyboardNavigation.Event.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.KeyNavNode,\n\t{\n\t\t_getNodes: function(){\n\t\t\treturn Array.prototype.slice.call(scheduler.$container.querySelectorAll(\"[\"+scheduler.config.event_attribute+\"]\"));\n\t\t},\n\n\t\t_modes: scheduler.$keyboardNavigation.SchedulerNode.prototype._modes,\n\n\t\tgetMode: scheduler.$keyboardNavigation.SchedulerNode.prototype.getMode,\n\n\t\t_handlers: null,\n\t\tisValid: function(){\n\t\t\treturn !!(scheduler.getEvent(this.eventId) && this.getNode());\n\t\t},\n\t\tfallback: function(){\n\t\t\tvar eventNode = this._getNodes()[0];\n\t\t\tvar defaultElement = null;\n\t\t\tif(!eventNode || !(scheduler._locate_event(eventNode))){\n\t\t\t\tdefaultElement = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\t}else{\n\t\t\t\tvar id = scheduler._locate_event(eventNode);\n\t\t\t\tdefaultElement = new scheduler.$keyboardNavigation.Event(id);\n\t\t\t}\n\n\t\t\treturn defaultElement;\n\t\t},\n\n\t\tisScrolledIntoView: function (el) {\n\t\t\tvar eventBox = el.getBoundingClientRect();\n\t\t\tvar viewPort = scheduler.$container.querySelector(\".dhx_cal_data\").getBoundingClientRect();\n\t\t\t\n\t\t\tif(eventBox.bottom < viewPort.top || eventBox.top > viewPort.bottom){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\tgetNode: function(){\n\n\t\t\tvar idSelector = \"[\"+scheduler.config.event_attribute+\"='\"+this.eventId+\"']\";\n\n\t\t\tvar inlineEditor = scheduler.$keyboardNavigation.dispatcher.getInlineEditor(this.eventId);\n\t\t\tif(inlineEditor){// is inline editor visible\n\t\t\t\treturn inlineEditor;\n\t\t\t}else{\n\t\t\t\tif(scheduler.isMultisectionEvent && scheduler.isMultisectionEvent(scheduler.getEvent(this.eventId))){\n\t\t\t\t\tvar nodes = scheduler.$container.querySelectorAll(idSelector);\n\t\t\t\t\tfor(var i = 0; i < nodes.length; i++){\n\t\t\t\t\t\tif(this.isScrolledIntoView(nodes[i])){\n\t\t\t\t\t\t\treturn nodes[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn nodes[0];\n\t\t\t\t}else{\n\t\t\t\t\treturn scheduler.$container.querySelector(idSelector);\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t}\n\n\t\t},\n\n\t\tfocus: function(){\n\t\t\tvar event = scheduler.getEvent(this.eventId);\n\n\t\t\tvar calendar = scheduler.getState();\n\t\t\tif(event.start_date.valueOf() > calendar.max_date.valueOf() || event.end_date.valueOf() <= calendar.min_date.valueOf()){\n\t\t\t\tscheduler.setCurrentView(event.start_date);\n\t\t\t}\n\n\t\t\tvar node = this.getNode();\n\t\t\tif (this.isScrolledIntoView(node)) {\n\t\t\t\tscheduler.$keyboardNavigation.dispatcher.keepScrollPosition((function(){\n\t\t\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this);\n\t\t\t\t}).bind(this));\n\t\t\t} else {\n\t\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this);\n\t\t\t}\n\n\t\t},\n\t\tblur: function(){\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this);\n\t\t},\n\n\n\t\t_getSection: function(ev){\n\t\t\tvar section = null;\n\t\t\tvar mode = scheduler.getState().mode;\n\t\t\tif(scheduler.matrix && scheduler.matrix[mode]){\n\t\t\t\tvar timeline = scheduler.matrix[scheduler.getState().mode];\n\t\t\t\tsection = ev[timeline.y_property];\n\t\t\t}else if(scheduler._props && scheduler._props[mode]){\n\t\t\t\tvar unit = scheduler._props[mode];\n\t\t\t\tsection = ev[unit.map_to];\n\t\t\t}\n\t\t\treturn section;\n\t\t},\n\t\t_moveToSlot: function(dir){\n\t\t\tvar ev = scheduler.getEvent(this.eventId);\n\t\t\tif(ev){\n\t\t\t\tvar section =this._getSection(ev);\n\t\t\t\tvar slot = new scheduler.$keyboardNavigation.TimeSlot(ev.start_date, null, section);\n\t\t\t\tthis.moveTo(slot.nextSlot(slot, dir));\n\t\t\t}else{\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t}\n\t\t},\n\n\t\tkeys: {\n\t\t\t\"left\": function(){\n\t\t\t\tthis._moveToSlot(\"left\");\n\t\t\t},\n\n\t\t\t\"right\": function () {\n\t\t\t\tthis._moveToSlot(\"right\");\n\t\t\t},\n\t\t\t\"down\": function () {\n\t\t\t\tif(this.getMode() == this._modes.list){\n\t\t\t\t\tscheduler.$keyboardNavigation.SchedulerNode.prototype.nextEventHandler();\n\t\t\t\t}else {\n\t\t\t\t\tthis._moveToSlot(\"down\");\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t\"space\": function(){\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif(node && node.click){\n\t\t\t\t\tnode.click();\n\t\t\t\t}else{\n\t\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t\"up\": function () {\n\t\t\t\tif(this.getMode() == this._modes.list){\n\t\t\t\t\tscheduler.$keyboardNavigation.SchedulerNode.prototype.prevEventHandler();\n\t\t\t\t}else {\n\t\t\t\t\tthis._moveToSlot(\"up\");\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t\"delete\": function(){\n\t\t\t\tif(scheduler.getEvent(this.eventId)) {\n\t\t\t\t\tscheduler._click.buttons[\"delete\"](this.eventId);\n\t\t\t\t}else{\n\t\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// open lightbox\n\t\t\t\"enter\": function () {\n\t\t\t\tif(scheduler.getEvent(this.eventId)) {\n\t\t\t\t\tscheduler.showLightbox(this.eventId);\n\t\t\t\t}else{\n\t\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n);\nscheduler.$keyboardNavigation.Event.prototype.bindAll(scheduler.$keyboardNavigation.Event.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.TimeSlot = function(from, to, section, movingDate){\n\tvar state = scheduler.getState();\n\tvar timeline = scheduler.matrix && scheduler.matrix[state.mode];\n\n\tif(!from){\n\t\tfrom = this.getDefaultDate();\n\t}\n\n\tif(!to){\n\n\t\tif(timeline){\n\t\t\tto = scheduler.date.add(from, timeline.x_step, timeline.x_unit);\n\t\t}else{\n\t\t\tto = scheduler.date.add(from, scheduler.config.key_nav_step, \"minute\");\n\t\t}\n\n\t}\n\n\tthis.section = section || this._getDefaultSection();\n\tthis.start_date = new Date(from);\n\tthis.end_date = new Date(to);\n\tthis.movingDate = movingDate || null;\n};\n\nscheduler.$keyboardNavigation.TimeSlot.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.KeyNavNode,\n\t{\n\t\t_handlers:null,\n\n\t\tgetDefaultDate: function(){\n\t\t\tvar from;\n\t\t\tvar state = scheduler.getState();\n\t\t\tvar visibleTime = new Date(state.date);\n\t\t\tvisibleTime.setSeconds(0);\n\t\t\tvisibleTime.setMilliseconds(0);\n\n\t\t\tvar nowTime = new Date();\n\t\t\tnowTime.setSeconds(0);\n\t\t\tnowTime.setMilliseconds(0);\n\n\t\t\tvar timeline = scheduler.matrix && scheduler.matrix[state.mode];\n\t\t\tvar showNowTime = false;\n\t\t\tif(visibleTime.valueOf() === nowTime.valueOf()){\n\t\t\t\tshowNowTime = true;\n\t\t\t}\n\n\t\t\tif(timeline){\n\t\t\t\tif(showNowTime){\n\t\t\t\t\tif(timeline.x_unit === \"day\"){\n\t\t\t\t\t\tnowTime.setHours(0);\n\t\t\t\t\t\tnowTime.setMinutes(0);\n\t\t\t\t\t}else if(timeline.x_unit === \"hour\"){\n\t\t\t\t\t\tnowTime.setMinutes(0);\n\t\t\t\t\t}\n\t\t\t\t\tfrom = nowTime;\n\t\t\t\t}else{\n\t\t\t\t\tfrom = scheduler.date[timeline.name + \"_start\"](new Date(state.date));\n\t\t\t\t}\n\n\t\t\t\tfrom = this.findVisibleColumn(from);\n\t\t\t}else{\n\t\t\t\tfrom = new Date(scheduler.getState().min_date);\n\t\t\t\tif(showNowTime){\n\t\t\t\t\tfrom = nowTime;\n\t\t\t\t}\n\t\t\t\tfrom = this.findVisibleColumn(from);\n\t\t\t\tif(!showNowTime){\n\t\t\t\t\tfrom.setHours(scheduler.config.first_hour);\n\t\t\t\t}\n\n\t\t\t\tif(!scheduler._table_view){\n\t\t\t\t\tvar dataContainer = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t\t\t\tif(dataContainer.scrollTop){\n\t\t\t\t\t\tfrom.setHours(scheduler.config.first_hour + Math.ceil(dataContainer.scrollTop / scheduler.config.hour_size_px));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn from;\n\t\t},\n\n\t\tclone: function(timeslot){\n\t\t\treturn new scheduler.$keyboardNavigation.TimeSlot(timeslot.start_date, timeslot.end_date, timeslot.section, timeslot.movingDate);\n\t\t},\n\t\t_getMultisectionView: function(){\n\t\t\tvar state = scheduler.getState();\n\t\t\tvar view;\n\t\t\tif(scheduler._props && scheduler._props[state.mode]) {\n\t\t\t\tview = scheduler._props[state.mode];\n\t\t\t}else if(scheduler.matrix && scheduler.matrix[state.mode]){\n\t\t\t\tview = scheduler.matrix[state.mode];\n\t\t\t}\n\t\t\treturn view;\n\t\t},\n\n\t\t_getDefaultSection: function(){\n\t\t\tvar section = null;\n\t\t\tvar view = this._getMultisectionView();\n\t\t\tif(view && !section){\n\t\t\t\tsection = this._getNextSection();\n\t\t\t}\n\t\t\treturn section;\n\t\t},\n\n\t\t_getNextSection: function(sectionId, dir){\n\t\t\tvar view = this._getMultisectionView();\n\t\t\tvar currentIndex = view.order[sectionId];\n\t\t\tvar nextIndex = currentIndex;\n\t\t\tif(currentIndex !== undefined){\n\t\t\t\tnextIndex =  currentIndex + dir;\n\t\t\t}else{\n\t\t\t\tnextIndex = (view.size && view.position) ? view.position : 0;\n\t\t\t}\n\n\t\t\tif(nextIndex < 0){\n\t\t\t\tnextIndex = 0;\n\t\t\t}\n\t\t\tvar options = view.options || view.y_unit;\n\n\t\t\tif(nextIndex >= options.length){\n\t\t\t\tnextIndex = options.length - 1;\n\t\t\t}\n\t\t\t//nextIndex = nextIndex < 0 ? nextIndex = (view.options || view.y_unit).length -1 : nextIndex;\n\n\t\t\tif(options[nextIndex]){\n\t\t\t\treturn options[nextIndex].key;\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\n\n\t\tisValid: function(){\n\t\t\tvar state = scheduler.getState();\n\t\t\tvar isInRange = !(this.start_date.valueOf() < state.min_date.valueOf() || this.start_date.valueOf() >= state.max_date.valueOf());\n\n\t\t\tif(!isInRange) return false;\n\n\n\t\t\tif(!this.isVisible(this.start_date, this.end_date)) return false;\n\n\t\t\tvar view = this._getMultisectionView();\n\n\t\t\tif(view){\n\t\t\t\treturn (view.order[this.section] !== undefined);\n\t\t\t}else{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t},\n\n\t\tfallback:function(){\n\n\t\t\tvar defaultSlot = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\tif(!defaultSlot.isValid()){\n\t\t\t\treturn new scheduler.$keyboardNavigation.DataArea();\n\t\t\t}else{\n\t\t\t\treturn defaultSlot;\n\t\t\t}\n\t\t},\n\n\t\tgetNodes: function(){\n\t\t\treturn Array.prototype.slice.call(scheduler.$container.querySelectorAll(\".dhx_focus_slot\"));\n\t\t},\n\t\tgetNode: function(){\n\t\t\treturn this.getNodes()[0];\n\t\t},\n\n\t\tfocus: function(){\n\t\t\tif(this.section && scheduler.getView() && scheduler.getView().smart_rendering && scheduler.getView().scrollTo && !scheduler.$container.querySelector(`[data-section-id=\"${this.section}\"]`)){\n\t\t\t\tscheduler.getView().scrollTo({section: this.section});\n\t\t\t}\n\t\t\tscheduler.$keyboardNavigation.marker.render(this.start_date, this.end_date, this.section);\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this);\n\t\t\tscheduler.$keyboardNavigation._pasteDate = this.start_date;\n\t\t\tscheduler.$keyboardNavigation._pasteSection = this.section;\n\n\t\t},\n\t\tblur: function(){\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this);\n\t\t\tscheduler.$keyboardNavigation.marker.clear();\n\t\t},\n\n\t\t_modes: scheduler.$keyboardNavigation.SchedulerNode.prototype._modes,\n\n\t\t_getMode: scheduler.$keyboardNavigation.SchedulerNode.prototype.getMode,\n\n\t\taddMonthDate: function(date, dir, extend){\n\t\t\tvar res;\n\t\t\tswitch (dir){\n\t\t\t\tcase \"up\":\n\t\t\t\t\tres = scheduler.date.add(date, -1, \"week\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tres = scheduler.date.add(date, 1, \"week\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tres = scheduler.date.day_start(scheduler.date.add(date, -1, \"day\"));\n\t\t\t\t\tres = this.findVisibleColumn(res, -1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tres = scheduler.date.day_start(scheduler.date.add(date, 1, \"day\"));\n\t\t\t\t\tres = this.findVisibleColumn(res, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tres = scheduler.date.day_start(new Date(date));\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvar state = scheduler.getState();\n\t\t\tif(date.valueOf() < state.min_date.valueOf() || (!extend && date.valueOf() >= state.max_date.valueOf())){\n\t\t\t\tres = new Date(state.min_date);\n\t\t\t}\n\n\t\t\treturn res;\n\t\t},\n\n\t\tnextMonthSlot: function(slot, dir, extend){\n\n\t\t\tvar start, end;\n\t\t\tstart = this.addMonthDate(slot.start_date, dir, extend);\n\n\t\t\tstart.setHours(scheduler.config.first_hour);\n\t\t\tend = new Date(start);\n\t\t\tend.setHours(scheduler.config.last_hour);\n\t\t\treturn {start_date: start, end_date: end};\n\t\t},\n\n\t\t_alignTimeSlot: function(date, minDate, unit, step){\n\t\t\tvar currentDate = new Date(minDate);\n\t\t\twhile(currentDate.valueOf() < date.valueOf()){\n\t\t\t\tcurrentDate = scheduler.date.add(currentDate, step, unit);\n\t\t\t}\n\n\t\t\tif(currentDate.valueOf() > date.valueOf()){\n\t\t\t\tcurrentDate = scheduler.date.add(currentDate, -step, unit);\n\t\t\t}\n\n\t\t\treturn currentDate;\n\t\t},\n\n\t\tnextTimelineSlot: function(slot, dir, extend){\n\t\t\tvar state = scheduler.getState();\n\t\t\tvar view = scheduler.matrix[state.mode];\n\n\t\t\tvar startDate  = this._alignTimeSlot(slot.start_date, scheduler.date[view.name + \"_start\"](new Date(slot.start_date)), view.x_unit, view.x_step);\n\t\t\tvar endDate = this._alignTimeSlot(slot.end_date, scheduler.date[view.name + \"_start\"](new Date(slot.end_date)), view.x_unit, view.x_step);\n\n\t\t\tif(endDate.valueOf() <= startDate.valueOf()){\n\t\t\t\tendDate = scheduler.date.add(startDate, view.x_step, view.x_unit);\n\t\t\t}\n\t\t\tvar newPos = this.clone(slot);\n\t\t\tnewPos.start_date = startDate;\n\t\t\tnewPos.end_date = endDate;\n\t\t\tnewPos.section = slot.section || this._getNextSection();\n\n\n\t\t\tswitch (dir){\n\t\t\t\tcase \"up\":\n\t\t\t\t\tnewPos.section = this._getNextSection(slot.section, -1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tnewPos.section = this._getNextSection(slot.section, +1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tnewPos.start_date = this.findVisibleColumn(scheduler.date.add(newPos.start_date, -view.x_step, view.x_unit), -1);\n\t\t\t\t\tnewPos.end_date = scheduler.date.add(newPos.start_date, view.x_step, view.x_unit);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tnewPos.start_date = this.findVisibleColumn(scheduler.date.add(newPos.start_date, view.x_step, view.x_unit), 1);\n\t\t\t\t\tnewPos.end_date = scheduler.date.add(newPos.start_date, view.x_step, view.x_unit);\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(newPos.start_date.valueOf() < state.min_date.valueOf() || newPos.start_date.valueOf() >= state.max_date.valueOf()){\n\t\t\t\tif(extend && newPos.start_date.valueOf() >= state.max_date.valueOf()){\n\t\t\t\t\tnewPos.start_date = new Date(state.max_date);\n\t\t\t\t}else{\n\t\t\t\t\tnewPos.start_date = scheduler.date[state.mode + \"_start\"](scheduler.date.add(state.date, dir == \"left\" ? -1 : 1, state.mode));\n\t\t\t\t\tnewPos.end_date = scheduler.date.add(newPos.start_date, view.x_step, view.x_unit);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn newPos;\n\t\t},\n\n\t\tnextUnitsSlot: function(slot, dir, extend){\n\t\t\tvar newPos = this.clone(slot);\n\t\t\tnewPos.section = slot.section || this._getNextSection();\n\n\t\t\tvar section = slot.section || this._getNextSection();\n\t\t\tvar state = scheduler.getState();\n\t\t\tvar view = scheduler._props[state.mode];\n\t\t\tswitch (dir){\n\t\t\t\tcase \"left\":\n\t\t\t\t\tsection = this._getNextSection(slot.section, -1);\n\t\t\t\t\tvar optionsCount = view.size ? (view.size - 1) : view.options.length;\n\n\t\t\t\t\tif(view.days > 1 && (view.order[section] == optionsCount - 1)){\n\t\t\t\t\t\tif(scheduler.date.add(slot.start_date, -1, \"day\").valueOf() >= state.min_date.valueOf()){\n\t\t\t\t\t\t\tnewPos = this.nextDaySlot(slot, dir, extend);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tsection = this._getNextSection(slot.section, 1);\n\t\t\t\t\tif(view.days > 1 && !view.order[section]){\n\t\t\t\t\t\tif(scheduler.date.add(slot.start_date, 1, \"day\").valueOf() < state.max_date.valueOf()){\n\t\t\t\t\t\t\tnewPos = this.nextDaySlot(slot, dir, extend);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnewPos = this.nextDaySlot(slot, dir, extend);\n\t\t\t\t\tsection = slot.section;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnewPos.section = section;\n\t\t\treturn newPos;\n\t\t},\n\n\t\t_moveDate: function(oldDate, dir){\n\t\t\tvar newDate = this.findVisibleColumn(scheduler.date.add(oldDate, dir, \"day\"), dir);\n\t\t\tnewDate.setHours(oldDate.getHours());\n\t\t\tnewDate.setMinutes(oldDate.getMinutes());\n\t\t\treturn newDate;\n\t\t},\n\n\t\tisBeforeLastHour: function(date, isStartDate){\n\t\t\tvar minutes = date.getMinutes(),\n\t\t\t\thours = date.getHours(),\n\t\t\t\tlast_hour = scheduler.config.last_hour;\n\t\t\treturn (hours < last_hour || (!isStartDate && ((last_hour == 24 || hours == last_hour) && !minutes)));\n\t\t},\n\t\tisAfterFirstHour: function(date, isStartDate){\n\t\t\tvar minutes = date.getMinutes(),\n\t\t\t\thours = date.getHours(),\n\t\t\t\tfirst_hour = scheduler.config.first_hour,\n\t\t\t\tlast_hour = scheduler.config.last_hour;\n\t\t\treturn (hours >= first_hour || (!isStartDate && (!minutes && ((!hours &&  last_hour == 24) || (hours == last_hour)))));\n\t\t},\n\t\tisInVisibleDayTime: function(date, isStartDate){\n\t\t\treturn (this.isBeforeLastHour(date, isStartDate) && this.isAfterFirstHour(date, isStartDate));\n\t\t},\n\n\t\tnextDaySlot: function(slot, dir, extend){\n\t\t\tvar start, end;\n\n\t\t\tvar key_nav_step = scheduler.config.key_nav_step;\n\n\t\t\tvar date = this._alignTimeSlot(slot.start_date, scheduler.date.day_start(new Date(slot.start_date)), \"minute\", key_nav_step);\n\n\n\t\t\tvar oldStart = slot.start_date;\n\n\t\t\tswitch (dir){\n\t\t\t\tcase \"up\":\n\t\t\t\t\tstart = scheduler.date.add(date, -key_nav_step, \"minute\");\n\n\t\t\t\t\tif(!this.isInVisibleDayTime(start, true)){\n\t\t\t\t\t\tif (!extend || this.isInVisibleDayTime(oldStart, true)) {\n\n\t\t\t\t\t\t\tvar toNextDay = true;\n\t\t\t\t\t\t\tif(extend && scheduler.date.date_part(new Date(start)).valueOf() != scheduler.date.date_part(new Date(oldStart)).valueOf())\n\t\t\t\t\t\t\t\ttoNextDay = false;\n\t\t\t\t\t\t\tif(toNextDay)\n\t\t\t\t\t\t\t\tstart = this.findVisibleColumn(scheduler.date.add(slot.start_date, -1, \"day\"), -1);\n\n\t\t\t\t\t\t\tstart.setHours(scheduler.config.last_hour);\n\t\t\t\t\t\t\tstart.setMinutes(0);\n\t\t\t\t\t\t\tstart = scheduler.date.add(start, -key_nav_step, \"minute\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tend = scheduler.date.add(start, key_nav_step, \"minute\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tstart = scheduler.date.add(date, key_nav_step, \"minute\");\n\n\t\t\t\t\tvar testEnd = extend ? start : scheduler.date.add(start, key_nav_step, \"minute\");\n\t\t\t\t\tif(!this.isInVisibleDayTime(testEnd, false)){\n\t\t\t\t\t\tif(!extend || this.isInVisibleDayTime(oldStart, false)) {\n\t\t\t\t\t\t\tif (!extend) {\n\t\t\t\t\t\t\t\tstart = this.findVisibleColumn(scheduler.date.add(slot.start_date, 1, \"day\"), 1);\n\t\t\t\t\t\t\t\tstart.setHours(scheduler.config.first_hour);\n\t\t\t\t\t\t\t\tstart.setMinutes(0);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar toNextDay = true;\n\t\t\t\t\t\t\t\tif (scheduler.date.date_part(new Date(oldStart)).valueOf() == oldStart.valueOf()) {\n\t\t\t\t\t\t\t\t\ttoNextDay = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (toNextDay) {\n\t\t\t\t\t\t\t\t\tstart = this.findVisibleColumn(scheduler.date.add(slot.start_date, 1, \"day\"), 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstart.setHours(scheduler.config.first_hour);\n\t\t\t\t\t\t\t\tstart.setMinutes(0);\n\t\t\t\t\t\t\t\tstart = scheduler.date.add(start, key_nav_step, \"minute\");\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tend = scheduler.date.add(start, key_nav_step, \"minute\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"left\":\n\t\t\t\t\tstart = this._moveDate(slot.start_date, -1);\n\t\t\t\t\tend = this._moveDate(slot.end_date, -1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tstart = this._moveDate(slot.start_date, 1);\n\t\t\t\t\tend = this._moveDate(slot.end_date, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tstart = date;\n\t\t\t\t\tend = scheduler.date.add(start, key_nav_step, \"minute\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn {start_date: start, end_date: end};\n\t\t},\n\t\tnextWeekAgendaSlot: function(slot, dir){\n\t\t\tvar start, end;\n\t\t\tvar state = scheduler.getState();\n\n\t\t\tswitch (dir){\n\t\t\t\tcase \"down\":\n\t\t\t\tcase \"left\":\n\t\t\t\t\tstart = scheduler.date.day_start(scheduler.date.add(slot.start_date, -1, \"day\"));\n\t\t\t\t\tstart = this.findVisibleColumn(start, -1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"up\":\n\t\t\t\tcase \"right\":\n\t\t\t\t\tstart = scheduler.date.day_start(scheduler.date.add(slot.start_date, 1, \"day\"));\n\t\t\t\t\tstart = this.findVisibleColumn(start, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tstart = scheduler.date.day_start(slot.start_date);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(slot.start_date.valueOf() < state.min_date.valueOf() || slot.start_date.valueOf() >= state.max_date.valueOf()){\n\t\t\t\tstart = new Date(state.min_date);\n\n\t\t\t}\n\t\t\tend = new Date(start);\n\t\t\tend.setHours(scheduler.config.last_hour);\n\t\t\treturn {start_date: start, end_date: end};\n\t\t},\n\t\tnextAgendaSlot: function(slot, dir){\n\t\t\treturn {start_date: slot.start_date, end_date: slot.end_date};\n\t\t},\n\n\n\t\tisDateVisible: function(date){\n\t\t\tif(!scheduler._ignores_detected)\n\t\t\t\treturn true;\n\n\t\t\tvar timeline = scheduler.matrix && scheduler.matrix[scheduler.getState().mode];\n\n\t\t\tvar index;\n\t\t\tif(timeline){\n\t\t\t\tindex = scheduler._get_date_index(timeline, date);\n\t\t\t}else{\n\t\t\t\tindex = scheduler.locate_holder_day(date);\n\t\t\t}\n\n\t\t\treturn !scheduler._ignores[index];\n\t\t},\n\n\t\tfindVisibleColumn: function(start, dir){\n\t\t\tvar date = start;\n\t\t\tdir = dir || 1;\n\t\t\tvar range = scheduler.getState();\n\n\t\t\twhile(!this.isDateVisible(date) && ((dir > 0 && date.valueOf() <= range.max_date.valueOf()) || (dir < 0 && date.valueOf() >= range.min_date.valueOf()))){\n\t\t\t\tdate = this.nextDateColumn(date, dir);\n\t\t\t}\n\n\t\t\treturn date;\n\t\t},\n\n\t\tnextDateColumn: function(start, dir){\n\t\t\tdir = dir || 1;\n\t\t\tvar timeline = scheduler.matrix && scheduler.matrix[scheduler.getState().mode];\n\n\t\t\tvar date;\n\t\t\tif(timeline){\n\t\t\t\tdate = scheduler.date.add(start, dir * timeline.x_step, timeline.x_unit);\n\t\t\t}else{\n\t\t\t\tdate = scheduler.date.day_start(scheduler.date.add(start, dir, \"day\"));\n\t\t\t}\n\n\t\t\treturn date;\n\t\t},\n\n\t\tisVisible:function(from, to){\n\t\t\tif(!scheduler._ignores_detected)\n\t\t\t\treturn true;\n\n\t\t\tvar current = new Date(from);\n\n\t\t\twhile(current.valueOf() < to.valueOf()){\n\t\t\t\tif(this.isDateVisible(current)) return true;\n\t\t\t\tcurrent = this.nextDateColumn(current);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tnextSlot: function(slot, dir, view, extend){\n\t\t\tvar next;\n\t\t\tview = view || this._getMode();\n\n\t\t\tvar tempSlot = scheduler.$keyboardNavigation.TimeSlot.prototype.clone(slot);\n\n\t\t\tswitch (view){\n\t\t\t\tcase this._modes.units:\n\t\t\t\t\tnext = this.nextUnitsSlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.timeline:\n\t\t\t\t\tnext = this.nextTimelineSlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.year:\n\t\t\t\t\tnext = this.nextMonthSlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.month:\n\t\t\t\t\tnext = this.nextMonthSlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.weekAgenda:\n\t\t\t\t\tnext = this.nextWeekAgendaSlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.list:\n\t\t\t\t\tnext = this.nextAgendaSlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.dayColumns:\n\t\t\t\t\tnext = this.nextDaySlot(tempSlot, dir, extend);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(next.start_date.valueOf() >= next.end_date.valueOf()){\n\t\t\t\tnext = this.nextSlot(next, dir, view);\n\t\t\t}\n\n\t\t\treturn scheduler.$keyboardNavigation.TimeSlot.prototype.clone(next);\n\n\t\t},\n\n\t\textendSlot: function(slot, dir){\n\t\t\tvar view = this._getMode();\n\t\t\tvar next;\n\t\t\tswitch (view){\n\t\t\t\tcase this._modes.units:\n\t\t\t\t\tif(dir == \"left\" || dir == \"right\"){\n\t\t\t\t\t\tnext = this.nextUnitsSlot(slot, dir);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnext = this.extendUnitsSlot(slot, dir);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.timeline:\n\t\t\t\t\tif(dir == \"down\" || dir == \"up\"){\n\t\t\t\t\t\tnext = this.nextTimelineSlot(slot, dir);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnext = this.extendTimelineSlot(slot, dir);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.year:\n\t\t\t\t\tnext = this.extendMonthSlot(slot, dir);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.month:\n\t\t\t\t\tnext = this.extendMonthSlot(slot, dir);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.dayColumns:\n\t\t\t\t\tnext = this.extendDaySlot(slot, dir);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this._modes.weekAgenda:\n\t\t\t\t\tnext = this.extendWeekAgendaSlot(slot, dir);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnext = slot;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvar range = scheduler.getState();\n\t\t\tif(next.start_date.valueOf() < range.min_date.valueOf()){\n\t\t\t\tnext.start_date = this.findVisibleColumn(range.min_date);\n\t\t\t\tnext.start_date.setHours(scheduler.config.first_hour);\n\t\t\t}\n\n\t\t\tif(next.end_date.valueOf() > range.max_date.valueOf()){\n\t\t\t//\tnext.end_date =  new Date(slot.end_date);\n\t\t\t\tnext.end_date = this.findVisibleColumn(range.max_date, -1);\n\t\t\t}\n\n\n\t\t\treturn scheduler.$keyboardNavigation.TimeSlot.prototype.clone(next);\n\t\t},\n\n\t\textendTimelineSlot: function(slot, direction){\n\t\t\treturn this.extendGenericSlot({\n\t\t\t\t\"left\":\"start_date\",\n\t\t\t\t\"right\":\"end_date\"\n\t\t\t\t},\n\t\t\t\tslot,\n\t\t\t\tdirection,\n\t\t\t\t\"timeline\"\n\t\t\t);\n\t\t},\n\n\t\textendWeekAgendaSlot: function(slot, direction){\n\t\t\treturn this.extendGenericSlot({\n\t\t\t\t\t\"left\":\"start_date\",\n\t\t\t\t\t\"right\":\"end_date\"\n\t\t\t\t},\n\t\t\t\tslot,\n\t\t\t\tdirection,\n\t\t\t\t\"weekAgenda\"\n\t\t\t);\n\t\t},\n\n\t\textendGenericSlot: function(allowedDirections, slot, direction, type){\n\t\t\tvar next;\n\t\t\tvar moveDate = slot.movingDate;\n\n\t\t\tif(!moveDate){\n\t\t\t\tmoveDate = allowedDirections[direction];\n\t\t\t}\n\n\t\t\tif(!moveDate || !allowedDirections[direction]){\n\t\t\t\treturn slot;\n\t\t\t}\n\n\t\t\tif(direction){\n\t\t\t\tnext = this.nextSlot({start_date: slot[moveDate], section: slot.section}, direction, type, true);\n\n\t\t\t\tif(next.start_date.valueOf() == slot.start_date.valueOf()){\n\t\t\t\t\tnext = this.nextSlot({start_date: next.start_date, section:next.section}, direction, type, true);\n\t\t\t\t}\n\n\t\t\t\tnext.movingDate = moveDate;\n\t\t\t}else{\n\t\t\t\treturn scheduler.$keyboardNavigation.TimeSlot.prototype.clone(slot);\n\t\t\t}\n\n\t\t\tvar newDates = this.extendSlotDates(slot, next, next.movingDate);\n\n\t\t\tif(newDates.end_date.valueOf() <= newDates.start_date.valueOf()){\n\t\t\t\tnext.movingDate = next.movingDate == \"end_date\" ? \"start_date\" : \"end_date\";\n\t\t\t}\n\t\t\tnewDates = this.extendSlotDates(slot, next, next.movingDate);\n\n\t\t\tnext.start_date = newDates.start_date;\n\t\t\tnext.end_date = newDates.end_date;\n\t\t\treturn next;\n\t\t},\n\n\t\textendSlotDates: function(oldSlot, newSlot, dateDirection){\n\t\t\tvar res = {start_date:null, end_date:null};\n\n\t\t\tif(dateDirection == \"start_date\"){\n\t\t\t\tres.start_date = newSlot.start_date;\n\t\t\t\tres.end_date = oldSlot.end_date;\n\t\t\t}else{\n\t\t\t\tres.start_date = oldSlot.start_date;\n\t\t\t\tres.end_date = newSlot.start_date;\n\t\t\t}\n\t\t\treturn res;\n\n\t\t},\n\n\t\textendMonthSlot: function(slot, direction){\n\t\t\tvar slot = this.extendGenericSlot({\n\t\t\t\t\t\"up\":\"start_date\",\n\t\t\t\t\t\"down\":\"end_date\",\n\t\t\t\t\t\"left\":\"start_date\",\n\t\t\t\t\t\"right\":\"end_date\"\n\t\t\t\t},\n\t\t\t\tslot,\n\t\t\t\tdirection,\n\t\t\t\t\"month\"\n\t\t\t);\n\n\t\t\tslot.start_date.setHours(scheduler.config.first_hour);\n\t\t\tslot.end_date = scheduler.date.add(slot.end_date, -1, \"day\");\n\t\t\tslot.end_date.setHours(scheduler.config.last_hour);\n\t\t\treturn slot;\n\t\t},\n\n\t\textendUnitsSlot: function(slot, direction){\n\t\t\tvar next;\n\n\t\t\tswitch (direction){\n\t\t\t\tcase \"down\":\n\t\t\t\tcase \"up\":\n\t\t\t\t\tnext = this.extendDaySlot(slot, direction);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnext = slot;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnext.section = slot.section;\n\t\t\treturn next;\n\t\t},\n\t\textendDaySlot: function(slot, direction){\n\t\t\treturn this.extendGenericSlot({\n\t\t\t\t\t\"up\":\"start_date\",\n\t\t\t\t\t\"down\":\"end_date\",\n\t\t\t\t\t\"left\":\"start_date\",\n\t\t\t\t\t\"right\":\"end_date\"\n\t\t\t\t},\n\t\t\t\tslot,\n\t\t\t\tdirection,\n\t\t\t\t\"dayColumns\"\n\t\t\t);\n\t\t},\n\n\t\tscrollSlot: function(dir){\n\t\t\tvar state = scheduler.getState();\n\n\t\t\tvar slot = this.nextSlot(this, dir);\n\t\t\tif(slot.start_date.valueOf() < state.min_date.valueOf() || slot.start_date.valueOf() >= state.max_date.valueOf()){\n\t\t\t\tscheduler.setCurrentView(new Date(slot.start_date));\n\t\t\t}\n\n\t\t\tthis.moveTo(slot);\n\t\t},\n\n\t\tkeys: {\n\t\t\t\"left\": function(){\n\t\t\t\tthis.scrollSlot(\"left\");\n\t\t\t},\n\t\t\t\"right\": function () {\n\t\t\t\tthis.scrollSlot(\"right\");\n\t\t\t},\n\t\t\t\"down\": function () {\n\n\t\t\t\tvar mode =  this._getMode();\n\t\t\t\tif(mode == this._modes.list){\n\t\t\t\t\tscheduler.$keyboardNavigation.SchedulerNode.prototype.nextEventHandler();\n\t\t\t\t}else{\n\t\t\t\t\tthis.scrollSlot(\"down\");\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t\"up\": function () {\n\t\t\t\tvar mode =  this._getMode();\n\t\t\t\tif(mode == this._modes.list){\n\t\t\t\t\tscheduler.$keyboardNavigation.SchedulerNode.prototype.prevEventHandler();\n\t\t\t\t}else{\n\t\t\t\t\tthis.scrollSlot(\"up\");\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t\"shift+down\":function(){\n\t\t\t\tthis.moveTo(this.extendSlot(this, \"down\"));\n\t\t\t},\n\t\t\t\"shift+up\":function(){\n\t\t\t\tthis.moveTo(this.extendSlot(this, \"up\"));\n\t\t\t},\n\t\t\t\"shift+right\":function(){\n\t\t\t\tthis.moveTo(this.extendSlot(this, \"right\"));\n\t\t\t},\n\t\t\t\"shift+left\":function(){\n\t\t\t\tthis.moveTo(this.extendSlot(this, \"left\"));\n\t\t\t},\n\n\n\t\t\t\"enter\": function(){\n\t\t\t\tvar obj = {start_date: new Date(this.start_date), end_date: new Date(this.end_date)};\n\n\t\t\t\tvar mode = scheduler.getState().mode;\n\t\t\t\tif(scheduler.matrix && scheduler.matrix[mode]){\n\n\t\t\t\t\tvar timeline = scheduler.matrix[scheduler.getState().mode];\n\t\t\t\t\tobj[timeline.y_property] = this.section;\n\t\t\t\t}else if(scheduler._props && scheduler._props[mode]){\n\t\t\t\t\tvar unit = scheduler._props[mode];\n\t\t\t\t\tobj[unit.map_to] = this.section;\n\t\t\t\t}\n\n\t\t\t\tscheduler.addEventNow(obj);\n\t\t\t}\n\t\t}\n\t}\n);\n\nscheduler.$keyboardNavigation.TimeSlot.prototype.bindAll(scheduler.$keyboardNavigation.TimeSlot.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.MinicalButton = function(div, index){\n\tthis.container = div;\n\tthis.index = index || 0;\n};\n\nscheduler.$keyboardNavigation.MinicalButton.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.KeyNavNode,\n\t{\n\n\t\tisValid: function(){\n\t\t\tvar container = this.container;\n\t\t\treturn !!container.offsetWidth;// valid if container is visible\n\t\t},\n\n\t\tfallback: function(){\n\t\t\tvar defaultSlot = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\tif(defaultSlot.isValid()){\n\t\t\t\treturn defaultSlot;\n\t\t\t}else{\n\t\t\t\treturn new scheduler.$keyboardNavigation.DataArea();\n\t\t\t}\n\t\t},\n\t\tfocus: function(){\n\t\t\tscheduler.$keyboardNavigation.dispatcher.globalNode.disable();\n\t\t\tthis.container.removeAttribute(\"tabindex\");\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this);\n\n\t\t},\n\t\tblur: function(){\n\t\t\tthis.container.setAttribute(\"tabindex\", \"0\");\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this);\n\t\t},\n\t\tgetNode: function(){\n\t\t\tif(!this.index){\n\t\t\t\treturn this.container.querySelector(\".dhx_cal_prev_button\");\n\t\t\t}else{\n\t\t\t\treturn this.container.querySelector(\".dhx_cal_next_button\");\n\t\t\t}\n\t\t},\n\n\t\tkeys: {\n\t\t\t\"right\": function(e){\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.MinicalButton(this.container, this.index ? 0 : 1));\n\t\t\t},\n\t\t\t\"left\": function(e){\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.MinicalButton(this.container, this.index ? 0 : 1));\n\t\t\t},\n\t\t\t\"down\": function(){\n\t\t\t\tvar next = new scheduler.$keyboardNavigation.MinicalCell(this.container, 0, 0);\n\t\t\t\tif(next && !next.isValid()){\n\t\t\t\t\tnext = next.fallback();\n\t\t\t\t}\n\n\t\t\t\tthis.moveTo(next);\n\t\t\t},\n\t\t\t\"enter\": function(e){\n\t\t\t\tthis.getNode().click();\n\t\t\t}\n\t\t}\n\t}\n);\n\nscheduler.$keyboardNavigation.MinicalButton.prototype.bindAll(scheduler.$keyboardNavigation.MinicalButton.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.MinicalCell = function(div, row, col){\n\tthis.container = div;\n\tthis.row = row || 0;\n\tthis.col = col || 0;\n};\n\nscheduler.$keyboardNavigation.MinicalCell.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.KeyNavNode,\n\t{\n\n\t\tisValid: function(){\n\t\t\tvar grid = this._getGrid();\n\t\t\treturn !!(grid[this.row] && grid[this.row][this.col]);\n\t\t},\n\t\tfallback: function(){\n\t\t\tvar row = this.row;\n\t\t\tvar col = this.col;\n\t\t\tvar grid = this._getGrid();\n\t\t\tif(!grid[row]){\n\t\t\t\trow = 0;\n\t\t\t}\n\t\t\tvar dir = true;\n\t\t\tif(row > grid.length / 2){\n\t\t\t\tdir = false;\n\t\t\t}\n\n\t\t\tif(!grid[row]){\n\t\t\t\tvar defaultSlot = new scheduler.$keyboardNavigation.TimeSlot();\n\t\t\t\tif(defaultSlot.isValid()){\n\t\t\t\t\treturn defaultSlot;\n\t\t\t\t}else{\n\t\t\t\t\treturn new scheduler.$keyboardNavigation.DataArea();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(dir){\n\t\t\t\tfor(var c = col; grid[row] && c < grid[row].length; c++){\n\t\t\t\t\tif(!grid[row][c] && c == grid[row].length - 1){\n\t\t\t\t\t\trow++;\n\t\t\t\t\t\tcol = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(grid[row][c]){\n\t\t\t\t\t\treturn new scheduler.$keyboardNavigation.MinicalCell(this.container, row, c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tfor(var c = col; grid[row] && c < grid[row].length; c--){\n\t\t\t\t\tif(!grid[row][c] && !c){\n\t\t\t\t\t\trow--;\n\t\t\t\t\t\tcol = grid[row].length - 1;\n\t\t\t\t\t}\n\t\t\t\t\tif(grid[row][c]){\n\t\t\t\t\t\treturn new scheduler.$keyboardNavigation.MinicalCell(this.container, row, c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn new scheduler.$keyboardNavigation.MinicalButton(this.container, 0);\n\t\t},\n\t\tfocus: function(){\n\t\t\tscheduler.$keyboardNavigation.dispatcher.globalNode.disable();\n\n\t\t\tthis.container.removeAttribute(\"tabindex\");\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this);\n\t\t},\n\t\tblur: function(){\n\t\t\tthis.container.setAttribute(\"tabindex\", \"0\");\n\t\t\tscheduler.$keyboardNavigation.KeyNavNode.prototype.blur.apply(this);\n\t\t},\n\t\t_getNode: function(row, col){\n\t\t\treturn this.container.querySelector(\".dhx_year_body tr:nth-child(\"+(row + 1) + \") td:nth-child(\"+(col + 1)+\")\");\n\t\t},\n\t\tgetNode: function(){\n\t\t\treturn this._getNode(this.row, this.col);\n\t\t},\n\n\t\t_getGrid: function(){\n\t\t\tvar rows = this.container.querySelectorAll(\".dhx_year_body tr\");\n\t\t\tvar grid = [];\n\t\t\tfor(var i = 0; i < rows.length; i++){\n\t\t\t\tgrid[i] = [];\n\t\t\t\tvar row = rows[i];\n\t\t\t\tvar cells = row.querySelectorAll(\"td\");\n\t\t\t\tfor(var c = 0; c < cells.length; c++){\n\t\t\t\t\tvar cell = cells[c];\n\t\t\t\t\tvar enabled = true;\n\t\t\t\t\tvar css = scheduler._getClassName(cell);\n\t\t\t\t\tif(css.indexOf(\"dhx_after\") > -1 || css.indexOf(\"dhx_before\") > -1 || css.indexOf(\"dhx_scale_ignore\") > -1){\n\t\t\t\t\t\tenabled = false;\n\t\t\t\t\t}\n\t\t\t\t\tgrid[i][c] = enabled;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn grid;\n\t\t},\n\n\n\t\tkeys: {\n\t\t\t\"right\": function(e){\n\t\t\t\tvar grid = this._getGrid();\n\t\t\t\tvar newRow = this.row;\n\t\t\t\tvar newCol = this.col + 1;\n\t\t\t\tif(!grid[newRow] || !grid[newRow][newCol]){\n\t\t\t\t\tif(grid[newRow + 1]){\n\t\t\t\t\t\tnewRow = newRow + 1;\n\t\t\t\t\t\tnewCol = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnewCol = this.col;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar next = new scheduler.$keyboardNavigation.MinicalCell(this.container, newRow, newCol);\n\t\t\t\tif(!next.isValid()){\n\t\t\t\t\tnext = next.fallback();\n\t\t\t\t}\n\n\t\t\t\tthis.moveTo(next);\n\t\t\t},\n\t\t\t\"left\": function(e){\n\t\t\t\tvar grid = this._getGrid();\n\t\t\t\tvar newRow = this.row;\n\t\t\t\tvar newCol = this.col - 1;\n\t\t\t\tif(!grid[newRow] || !grid[newRow][newCol]){\n\t\t\t\t\tif(grid[newRow - 1]){\n\t\t\t\t\t\tnewRow = newRow - 1;\n\t\t\t\t\t\tnewCol = grid[newRow].length - 1;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnewCol = this.col;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar next = new scheduler.$keyboardNavigation.MinicalCell(this.container, newRow, newCol);\n\t\t\t\tif(!next.isValid()){\n\t\t\t\t\tnext = next.fallback();\n\t\t\t\t}\n\n\t\t\t\tthis.moveTo(next);\n\t\t\t},\n\t\t\t\"down\": function(){\n\t\t\t\tvar grid = this._getGrid();\n\t\t\t\tvar newRow = this.row + 1;\n\t\t\t\tvar newCol = this.col;\n\n\t\t\t\tif(!grid[newRow] || !grid[newRow][newCol]){\n\t\t\t\t\tnewRow = this.row;\n\t\t\t\t}\n\n\t\t\t\tvar next = new scheduler.$keyboardNavigation.MinicalCell(this.container, newRow, newCol);\n\t\t\t\tif(!next.isValid()){\n\t\t\t\t\tnext = next.fallback();\n\t\t\t\t}\n\n\t\t\t\tthis.moveTo(next);\n\t\t\t},\n\t\t\t\"up\": function(){\n\t\t\t\tvar grid = this._getGrid();\n\t\t\t\tvar newRow = this.row - 1;\n\t\t\t\tvar newCol = this.col;\n\n\t\t\t\tif(!grid[newRow] || !grid[newRow][newCol]){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tif(this.col > grid[this.row].length / 2){\n\t\t\t\t\t\tindex = 1;\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.MinicalButton(this.container, index));\n\t\t\t\t}else{\n\t\t\t\t\tvar next = new scheduler.$keyboardNavigation.MinicalCell(this.container, newRow, newCol);\n\t\t\t\t\tif(!next.isValid()){\n\t\t\t\t\t\tnext = next.fallback();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.moveTo(next);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t\"enter\": function(e){\n\t\t\t\tthis.getNode().querySelector(\".dhx_month_head\").click();\n\t\t\t}\n\t\t}\n\t}\n);\n\nscheduler.$keyboardNavigation.MinicalCell.prototype.bindAll(scheduler.$keyboardNavigation.MinicalCell.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.DataArea = function(index){\n\tthis.index = index || 0;\n};\n\nscheduler.$keyboardNavigation.DataArea.prototype = scheduler._compose(\n\tscheduler.$keyboardNavigation.KeyNavNode,\n\t{\n\t\tgetNode: function(index){\n\t\t\treturn scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t},\n\n\t\t_handlers:null,\n\n\t\tisValid: function(){\n\t\t\treturn true;\n\t\t},\n\t\tfallback:function(){\n\t\t\treturn this;\n\t\t},\n\n\t\tkeys: {\n\t\t\t\"up,down,right,left\":function(){\n\t\t\t\tthis.moveTo(new scheduler.$keyboardNavigation.TimeSlot());\n\t\t\t}\n\t\t}\n\t}\n);\n\nscheduler.$keyboardNavigation.DataArea.prototype.bindAll(scheduler.$keyboardNavigation.DataArea.prototype.keys);\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation.dispatcher = {\n\tisActive: false,\n\tactiveNode: null,\n\tglobalNode: new scheduler.$keyboardNavigation.SchedulerNode(),\n\n\tkeepScrollPosition: function (callback) {\n\t\tvar top, left;\n\n\t\tvar scrollable = scheduler.$container.querySelector(\".dhx_timeline_scrollable_data\");\n\t\tif(!scrollable){\n\t\t\tscrollable = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t}\n\n\t\tif(scrollable){\n\t\t\ttop = scrollable.scrollTop;\n\t\t\tleft = scrollable.scrollLeft;\n\t\t}\n\n\t\tcallback();\n\n\t\tif(scrollable){\n\t\t\tscrollable.scrollTop = top;\n\t\t\tscrollable.scrollLeft = left;\n\t\t}\n\t},\n\tenable: function(){\n\t\tif(!scheduler.$container){\n\t\t\t// do nothing if not initialized\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isActive = true;\n\t\tvar self = this;\n\t\tthis.keepScrollPosition(function () {\n\t\t\tself.globalNode.enable();\n\t\t\tself.setActiveNode(self.getActiveNode());\n\t\t});\n\t},\n\n\tdisable: function(){\n\t\tthis.isActive = false;\n\t\tthis.globalNode.disable();\n\t},\n\n\tisEnabled: function(){\n\t\treturn !!this.isActive;\n\t},\n\n\tgetDefaultNode: function(){\n\t\treturn this.globalNode.getDefaultNode();\n\t},\n\n\tsetDefaultNode: function() {\n\t\tthis.setActiveNode(this.getDefaultNode());\n\t},\n\n\tgetActiveNode: function(){\n\t\tvar node = this.activeNode;\n\t\tif(node && !node.isValid()){\n\t\t\tnode = node.fallback();\n\t\t}\n\t\treturn node;\n\t},\n\n\tfocusGlobalNode: function(){\n\t\tthis.blurNode(this.globalNode);\n\t\tthis.focusNode(this.globalNode);\n\t},\n\n\tsetActiveNode: function(el){\n\t\tif(!el || !el.isValid())\n\t\t\treturn;\n\n\t\tif(this.activeNode){\n\t\t\tif(this.activeNode.compareTo(el)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif(this.isEnabled()){\n\t\t\tthis.blurNode(this.activeNode);\n\t\t\tthis.activeNode = el;\n\t\t\tthis.focusNode(this.activeNode);\n\t\t}\n\t},\n\n\tfocusNode: function(el){\n\t\tif(el && el.focus){\n\t\t\tel.focus();\n\t\t\tif(el.getNode && document.activeElement != el.getNode()){\n\t\t\t\tthis.setActiveNode(new scheduler.$keyboardNavigation.DataArea());\n\t\t\t}\n\t\t}\n\t},\n\tblurNode: function(el){\n\t\tif(el && el.blur){\n\t\t\tel.blur();\n\t\t}\n\t},\n\n\tgetInlineEditor: function(id){\n\t\tvar editor = scheduler.$container.querySelector(\".dhx_cal_editor[\"+scheduler.config.event_attribute+\"='\"+id+\"'] textarea\");\n\t\tif(editor && editor.offsetWidth){\n\t\t\t// if exists and visible\n\t\t\treturn editor;\n\t\t}\n\t\treturn null;\n\t},\n\n\tkeyDownHandler: function (e) {\n\n\t\tif(e.defaultPrevented){\n\t\t\treturn;\n\t\t}\n\n\t\tvar activeElement = this.getActiveNode();\n\n\t\tif(scheduler.$keyboardNavigation.isModal() &&\n\t\t\t!(activeElement && activeElement.container && scheduler.utils.dom.locateCss({target:activeElement.container}, \"dhx_minical_popup\", false)))\n\t\t\treturn;\n\n\t\tif(scheduler.getState().editor_id && this.getInlineEditor(scheduler.getState().editor_id))\n\t\t\treturn;\n\n\t\tif (!this.isEnabled())\n\t\t\treturn;\n\n\t\te = e || window.event;\n\n\t\tvar schedulerNode = this.globalNode;\n\n\t\tvar command = scheduler.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\n\n\t\tif(!activeElement){\n\t\t\tthis.setDefaultNode();\n\t\t}else if(activeElement.findHandler(command)){\n\t\t\tactiveElement.doAction(command, e);\n\t\t}else if(schedulerNode.findHandler(command)){\n\t\t\tschedulerNode.doAction(command, e);\n\t\t}\n\n\t},\n\n\t_timeout: null,\n\tdelay: function(callback, delay){\n\n\t\tclearTimeout(this._timeout);\n\t\tthis._timeout = setTimeout(callback, delay || 1);\n\n\t}\n};\n\n}","export default function(scheduler){\n\nscheduler.$keyboardNavigation._minicalendars = [];\n\nscheduler.$keyboardNavigation.isMinical = function(node){\n\tvar minicalendars = scheduler.$keyboardNavigation._minicalendars;\n\tfor(var i = 0; i < minicalendars.length; i++){\n\t\tif(this.isChildOf(node, minicalendars[i]))\n\t\t\treturn true;\n\t}\n\treturn false;\n};\n\nscheduler.$keyboardNavigation.isChildOf = function(child, parent){\n\twhile(child && child !== parent){\n\t\tchild = child.parentNode;\n\t}\n\n\treturn !!(child === parent);\n};\n\nscheduler.$keyboardNavigation.patchMinicalendar = function(){\n\tvar dispatcher = scheduler.$keyboardNavigation.dispatcher;\n\n\tfunction focusMinical(e){\n\t\tvar target = e.target;\n\n\t\tdispatcher.enable();\n\t\tdispatcher.setActiveNode(new scheduler.$keyboardNavigation.MinicalButton(target, 0));\n\t}\n\n\tfunction minicalClick(e){\n\t\tvar target = e.target || e.srcElement;\n\n\t\tvar prev = scheduler.utils.dom.locateCss(e, \"dhx_cal_prev_button\", false);\n\t\tvar next = scheduler.utils.dom.locateCss(e, \"dhx_cal_next_button\", false);\n\t\tvar cell = scheduler.utils.dom.locateCss(e, \"dhx_year_body\", false);\n\n\t\tvar rowIndex = 0;\n\t\tvar cellIndex = 0;\n\t\tif(cell){\n\t\t\tvar tr;\n\t\t\tvar td;\n\t\t\tvar current = target;\n\t\t\twhile(current && current.tagName.toLowerCase() != \"td\"){\n\t\t\t\tcurrent = current.parentNode;\n\t\t\t}\n\t\t\tif(current){\n\t\t\t\ttd = current;\n\t\t\t\ttr = td.parentNode;\n\t\t\t}\n\n\t\t\tif(tr && td){\n\t\t\t\tvar rows = tr.parentNode.querySelectorAll(\"tr\");\n\t\t\t\tfor(var i = 0; i < rows.length; i++){\n\t\t\t\t\tif(rows[i] == tr){\n\t\t\t\t\t\trowIndex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar cells = tr.querySelectorAll(\"td\");\n\t\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\t\tif(cells[i] == td){\n\t\t\t\t\t\tcellIndex = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar root = e.currentTarget;\n\t\tdispatcher.delay(function(){\n\t\t\tif(prev || next || cell){\n\n\t\t\t\tvar element;\n\t\t\t\tif(prev){\n\t\t\t\t\telement = new scheduler.$keyboardNavigation.MinicalButton(root, 0);\n\t\t\t\t\tdispatcher.setActiveNode(new scheduler.$keyboardNavigation.MinicalButton(root, 0));\n\t\t\t\t}else if(next){\n\t\t\t\t\telement = new scheduler.$keyboardNavigation.MinicalButton(root, 1);\n\t\t\t\t}else if(cell){\n\t\t\t\t\telement = new scheduler.$keyboardNavigation.MinicalCell(root, rowIndex, cellIndex);\n\n\t\t\t\t}\n\n\t\t\t\tif(element){\n\n\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\tif(element.isValid()){\n\t\t\t\t\t\tdispatcher.activeNode = null;\n\t\t\t\t\t\tdispatcher.setActiveNode(element);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\t}\n\n\tif(scheduler.renderCalendar){\n\t\tvar renderMinical = scheduler.renderCalendar;\n\t\tscheduler.renderCalendar = function(){\n\t\t\tvar cal = renderMinical.apply(this, arguments);\n\t\t\tvar minicalendars = scheduler.$keyboardNavigation._minicalendars;\n\n\t\t\tscheduler.eventRemove(cal, \"click\", minicalClick);\n\t\t\tscheduler.event(cal, \"click\", minicalClick);\n\n\t\t\tscheduler.eventRemove(cal, \"focus\", focusMinical);\n\t\t\tscheduler.event(cal, \"focus\", focusMinical);\n\n\t\t\tvar added = false;\n\t\t\tfor(var i = 0; i < minicalendars.length; i++){\n\t\t\t\tif(minicalendars[i] == cal){\n\t\t\t\t\tadded = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!added)\n\t\t\t\tminicalendars.push(cal);\n\n\t\t\tif(dispatcher.isEnabled()){\n\t\t\t\tvar node = dispatcher.getActiveNode();\n\t\t\t\tif(node && node.container == cal){\n\t\t\t\t\tdispatcher.focusNode(node);\n\t\t\t\t}else{\n\t\t\t\t\tcal.setAttribute(\"tabindex\", \"0\");\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcal.setAttribute(\"tabindex\", \"0\");\n\t\t\t}\n\t\t\treturn cal;\n\t\t};\n\t}\n\n\tif(scheduler.destroyCalendar){\n\t\tvar destroyMinical = scheduler.destroyCalendar;\n\t\tscheduler.destroyCalendar = function(cal, force){\n\t\t\tcal = cal || (scheduler._def_count ? scheduler._def_count.firstChild : null);\n\t\t\tvar res = destroyMinical.apply(this, arguments);\n\n\t\t\tif(!cal || !cal.parentNode){\n\t\t\t\tvar minicalendars = scheduler.$keyboardNavigation._minicalendars;\n\t\t\t\tfor(var i = 0; i < minicalendars.length; i++){\n\t\t\t\t\tif(minicalendars[i] == cal){\n\t\t\t\t\t\tscheduler.eventRemove(minicalendars[i], \"focus\", focusMinical);\n\t\t\t\t\t\tminicalendars.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn res;\n\t\t};\n\t}\n};\n\n}","export default function(scheduler){\n\nscheduler.attachEvent(\"onTemplatesReady\",function(){\n\n\tthis.layers.sort(function(a, b){\n\t\treturn a.zIndex - b.zIndex;\n\t});\n\n\tscheduler._dp_init=function(dp){\n\t\tdp._methods=[\"_set_event_text_style\",\"\",\"changeEventId\",\"deleteEvent\"];\n\n\t\tthis.attachEvent(\"onEventAdded\",function(id){\n\t\t\tif (!this._loading && this.validId(id) && this.getEvent(id) && this.getEvent(id).layer == dp.layer)\n\t\t\t\tdp.setUpdated(id,true,\"inserted\");\n\t\t});\n\t\tthis.attachEvent(\"onBeforeEventDelete\",function(id){\n\t\t\tif(this.getEvent(id) && this.getEvent(id).layer == dp.layer) {\n\t\t\t\tif (!this.validId(id)) return;\n\t\t\t\tvar z=dp.getState(id);\n\n\t\t\t\tif (z==\"inserted\" || this._new_event) {  dp.setUpdated(id,false);\t\treturn true; }\n\t\t\t\tif (z==\"deleted\")  return false;\n\t\t\t\tif (z==\"true_deleted\")  return true;\n\n\t\t\t\tdp.setUpdated(id,true,\"deleted\");\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse return true;\n\t\t});\n\t\tthis.attachEvent(\"onEventChanged\",function(id){\n\t\t\tif (!this._loading && this.validId(id) && this.getEvent(id) && this.getEvent(id).layer == dp.layer)\n\t\t\t\tdp.setUpdated(id,true,\"updated\");\n\t\t});\n\n\t\tdp._getRowData=function(id,pref){\n\t\t\tvar ev=this.obj.getEvent(id);\n\t\t\tvar data = {};\n\n\t\t\tfor (var a in ev){\n\t\t\t\tif (a.indexOf(\"_\")===0) continue;\n\t\t\t\tif (ev[a] && ev[a].getUTCFullYear) //not very good, but will work\n\t\t\t\t\tdata[a] = this.obj._helpers.formatDate(ev[a]);\n\t\t\t\telse\n\t\t\t\t\tdata[a] = ev[a];\n\t\t\t}\n\t\t\treturn data;\n\t\t};\n\t\tdp._clearUpdateFlag=function(){};\n\n\t\tdp.attachEvent(\"insertCallback\", scheduler._update_callback);\n\t\tdp.attachEvent(\"updateCallback\", scheduler._update_callback);\n\t\tdp.attachEvent(\"deleteCallback\", function(upd, id) {\n\t\t\tthis.obj.setUserData(id, this.action_param, \"true_deleted\");\n\t\t\tthis.obj.deleteEvent(id);\n\t\t});\n\t};\n\n\t(function() {\n        var _cloneObj = function(obj){\n            if(obj === null || typeof(obj) != 'object')\n                return obj;\n            var temp = new obj.constructor();\n            for(var key in obj)\n                temp[key] = _cloneObj(obj[key]);\n            return temp;\n        };\n\n\t\tscheduler._dataprocessors = [];\n\t\tscheduler._layers_zindex = {};\n\t\tfor(var i=0; i<scheduler.layers.length; i++) {\n\t\t\tscheduler.config['lightbox_'+scheduler.layers[i].name] = { };\n            scheduler.config['lightbox_'+scheduler.layers[i].name].sections = _cloneObj(scheduler.config.lightbox.sections);\n\t\t\tscheduler._layers_zindex[scheduler.layers[i].name] = scheduler.config.initial_layer_zindex||5 + i*3;\n\t\t\tif(scheduler.layers[i].url) {\n\t\t\t\tvar dp = scheduler.createDataProcessor({\n\t\t\t\t\turl: scheduler.layers[i].url\n\t\t\t\t});\n\t\t\t\tdp.layer = scheduler.layers[i].name;\n\t\t\t\tscheduler._dataprocessors.push(dp);\n\t\t\t\tscheduler._dataprocessors[i].init(scheduler);\n\t\t\t}\n\t\t\tif(scheduler.layers[i].isDefault)\n\t\t\t\tscheduler.defaultLayer = scheduler.layers[i].name;\n\t\t}\n\t})();\n\n\n\tscheduler.showLayer = function(tlayer) {\n\t\tthis.toggleLayer(tlayer, true);\n\t};\n\n\tscheduler.hideLayer = function(tlayer) {\n\t\tthis.toggleLayer(tlayer, false);\n\t};\n\n\tscheduler.toggleLayer = function(tlayer, visible) { // visible is optional\n\t\tvar layer = this.getLayer(tlayer);\n\n\t\tif(typeof visible != 'undefined')\n\t\t\tlayer.visible = !!visible;\n\t\telse\n\t\t\tlayer.visible = !layer.visible;\n\n\t\tthis.setCurrentView(this._date, this._mode);\n\t};\n\n\tscheduler.getLayer = function(tlayer) { // either string with layer name or event with layer property\n\t\tvar layer,\n\t\t\tlayer_name;\n\t\tif(typeof tlayer == 'string')\n\t\t\tlayer_name = tlayer;\n\t\tif(typeof tlayer == 'object')\n\t\t\tlayer_name = tlayer.layer;\n\t\tfor (var i=0; i<scheduler.layers.length; i++) {\n\t\t\tif(scheduler.layers[i].name == layer_name)\n\t\t\t\tlayer = scheduler.layers[i];\n\t\t}\n\t\treturn layer;\n\t};\n\n\tscheduler.attachEvent(\"onBeforeLightbox\", function (event_id){\n\t\tvar ev = this.getEvent(event_id);\n        this.config.lightbox.sections = this.config['lightbox_'+ev.layer].sections;\n        scheduler.resetLightbox();\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onClick\", function (event_id, native_event_object){\n\t\tvar ev = scheduler.getEvent(event_id);\n        return !scheduler.getLayer(ev.layer).noMenu;\n\t});\n\n\tscheduler.attachEvent('onEventCollision', function(ev, evs) {\n\t\tvar layer = this.getLayer(ev);\n\t\tif(!layer.checkCollision)\n\t\t\treturn false;\n\t\tvar count = 0;\n\t\tfor(var i = 0; i<evs.length; i++) {\n\t\t\tif(evs[i].layer == layer.name && evs[i].id != ev.id)\n\t\t\t\tcount++;\n\t\t}\n\t\treturn (count >= scheduler.config.collision_limit);\n\t});\n\n\tscheduler.addEvent=function(start_date,end_date,text,id,extra_data){\n\t\tvar ev=start_date;\n\t\tif (arguments.length!=1){\n\t\t\tev=extra_data||{};\n\t\t\tev.start_date=start_date;\n\t\t\tev.end_date=end_date;\n\t\t\tev.text=text;\n\t\t\tev.id=id;\n\t\t\tev.layer = this.defaultLayer;\n\t\t}\n\t\tev.id = ev.id||scheduler.uid();\n\t\tev.text = ev.text||\"\";\n\n\n\t\tif (typeof ev.start_date == \"string\")  ev.start_date=this.templates.api_date(ev.start_date);\n\t\tif (typeof ev.end_date == \"string\")  ev.end_date=this.templates.api_date(ev.end_date);\n\t\tev._timed=this.isOneDayEvent(ev);\n\n\t\tvar is_new=!this._events[ev.id];\n\t\tthis._events[ev.id]=ev;\n\t\tthis.event_updated(ev);\n\t\tif (!this._loading)\n\t\t\tthis.callEvent(is_new?\"onEventAdded\":\"onEventChanged\",[ev.id,ev]);\n\t};\n\n\tthis._evs_layer = {};\n\tfor (var i = 0; i < this.layers.length; i++) { // array in object for each layer\n\t\tthis._evs_layer[this.layers[i].name] = [];\n\t}\n\n\tscheduler.addEventNow=function(start,end,e){\n\t\tvar base = {};\n\t\tif (typeof start == \"object\"){\n\t\t\tbase = start;\n\t\t\tstart = null;\n\t\t}\n\n\t\tvar d = (this.config.event_duration||this.config.time_step)*60000;\n\t\tif (!start) start = Math.round((scheduler._currentDate()).valueOf()/d)*d;\n\t\tvar start_date = new Date(start);\n\t\tif (!end){\n\t\t\tvar start_hour = this.config.first_hour;\n\t\t\tif (start_hour > start_date.getHours()){\n\t\t\t\tstart_date.setHours(start_hour);\n\t\t\t\tstart = start_date.valueOf();\n\t\t\t}\n\t\t\tend = start+d;\n\t\t}\n\n\n\t\tbase.start_date = base.start_date||start_date;\n\t\tbase.end_date =  base.end_date||new Date(end);\n\t\tbase.text = base.text||this.locale.labels.new_event;\n\t\tbase.id = this._drag_id = this.uid();\n\t\tbase.layer = this.defaultLayer;\n\t\tthis._drag_mode=\"new-size\";\n\n\t\tthis._loading=true;\n\t\tthis.addEvent(base);\n\t\tthis.callEvent(\"onEventCreated\",[this._drag_id,e]);\n\t\tthis._loading=false;\n\n\t\tthis._drag_event={}; //dummy , to trigger correct event updating logic\n\t\tthis._on_mouse_up(e);\n\t};\n\n\tscheduler._t_render_view_data = function(events) { // helper\n\t\tif (this.config.multi_day && !this._table_view) {\n\t\t\tvar tvs = [];\n\t\t\tvar tvd = [];\n\t\t\tfor (var k = 0; k < events.length; k++) {\n\t\t\t\tif (events[k]._timed)\n\t\t\t\t\ttvs.push(events[k]);\n\t\t\t\telse\n\t\t\t\t\ttvd.push(events[k]);\n\t\t\t}\n\t\t\tthis._table_view = true;\n\t\t\tthis.render_data(tvd);\n\t\t\tthis._table_view = false;\n\t\t\tthis.render_data(tvs);\n\t\t}\n\t\telse\n\t\t\tthis.render_data(events);\n\t};\n\n\tscheduler.render_view_data = function(){\n\t\tif (this._not_render) {\n\t\t\tthis._render_wait = true;\n\t\t\treturn;\n\t\t}\n\t\tthis._render_wait = false;\n\n\t\tthis.clear_view();\n\n\t\tthis._evs_layer = {};\n\t\tfor (var i = 0; i < this.layers.length; i++) { // array in object for each layer\n\t\t\tthis._evs_layer[this.layers[i].name] = [];\n\t\t}\n\n\t\tvar evs = this.get_visible_events();\n\t\tfor (var i = 0; i < evs.length; i++) { // filling layer arrays with events\n\t\t\tif(this._evs_layer[evs[i].layer])\n\t\t\t\tthis._evs_layer[evs[i].layer].push(evs[i]);\n\t\t}\n\n\t\tif(this._mode == 'month') { // old logic is used\n\t\t\tvar tevs = [];\n\t\t\tfor (var i = 0; i < this.layers.length; i++) {\n\t\t\t\tif (this.layers[i].visible)\n\t\t\t\t\ttevs = tevs.concat(this._evs_layer[this.layers[i].name]);\n\t\t\t}\n\t\t\tthis._t_render_view_data(tevs);\n\t\t}\n\t\telse { // week, day; should use new logic\n\t\t\tfor (var i = 0; i < this.layers.length; i++) {\n\t\t\t\tif (this.layers[i].visible) {\n\t\t\t\t\tvar evs_layer = this._evs_layer[this.layers[i].name];\n\t\t\t\t\tthis._t_render_view_data(evs_layer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tscheduler._render_v_bar=function(ev,x,y,w,h,style,contentA,contentB,bottom){\n\t\tvar id = ev.id;\n\n\t\tif(contentA.indexOf('<div class=') == -1)\n\t\t\tcontentA = (scheduler.templates['event_header_'+ev.layer])?scheduler.templates['event_header_'+ev.layer](ev.start_date,ev.end_date,ev):contentA;\n\t\tif(contentB.indexOf('<div class=') == -1)\n\t\tcontentB = (scheduler.templates['event_text_'+ev.layer])?scheduler.templates['event_text_'+ev.layer](ev.start_date,ev.end_date,ev):contentB;\n\n\t\tvar d=document.createElement(\"div\");\n\t\tvar cs = \"dhx_cal_event\";\n\t\tvar cse = (scheduler.templates['event_class_'+ev.layer])?scheduler.templates['event_class_'+ev.layer](ev.start_date,ev.end_date,ev):scheduler.templates.event_class(ev.start_date,ev.end_date,ev);\n\t\tif (cse) cs=cs+\" \"+cse;\n\n\t\tvar borderBox = scheduler._border_box_events();\n\n\t\tvar borderBoxWidth = w - 2;\n\t\tvar boxWidth = borderBox ? borderBoxWidth : (w-4),\n\t\theaderWidth = borderBox ? borderBoxWidth : (w-6),\n\t\tbodyWidth = borderBox ? borderBoxWidth : (w-14),\n\t\tfooterWidth = borderBox ? (borderBoxWidth - 2) : (w-8);\n\n\t\tvar bodyHeight = borderBox ? (h - this.xy.event_header_height) : (h-30 + 1);\n\n\t\tvar html='<div event_id=\"'+id+'\" '+scheduler.config.event_attribute+'=\"'+id+'\" class=\"'+cs+'\" style=\"position:absolute; top:'+y+'px; left:'+x+'px; width:'+boxWidth+'px; height:'+h+'px;'+(style||\"\")+'\">';\n\t\thtml+='<div class=\"dhx_header\" style=\" width:'+headerWidth+'px;\" >&nbsp;</div>';\n\t\thtml+='<div class=\"dhx_title\">'+contentA+'</div>';\n\t\thtml+='<div class=\"dhx_body\" style=\" width:'+bodyWidth+'px; height:'+bodyHeight+'px;\">'+contentB+'</div>';\n\t\thtml+='<div class=\"dhx_footer\" style=\" width:'+footerWidth+'px;'+(bottom?' margin-top:-1px;':'')+'\" ></div></div>';\n\n\t\td.innerHTML=html;\n\t\td.style.zIndex = 100;\n\t\treturn d.firstChild;\n\t};\n\n\tscheduler.render_event_bar=function(ev){\n\t\tvar parent=this._els[\"dhx_cal_data\"][0];\n\n\t\tvar x=this._colsS[ev._sday];\n\t\tvar x2=this._colsS[ev._eday];\n\t\tif (x2==x) x2=this._colsS[ev._eday+1];\n\t\tvar hb = this.xy.bar_height;\n\n\t\tvar y=this._colsS.heights[ev._sweek]+(this._colsS.height?(this.xy.month_scale_height+2):2)+ev._sorder*hb;\n\n\t\tvar d=document.createElement(\"div\");\n\t\tvar cs = ev._timed?\"dhx_cal_event_clear\":\"dhx_cal_event_line\";\n\t\tvar cse = (scheduler.templates['event_class_'+ev.layer])?scheduler.templates['event_class_'+ev.layer](ev.start_date,ev.end_date,ev):scheduler.templates.event_class(ev.start_date,ev.end_date,ev);\n\t\tif (cse) cs=cs+\" \"+cse;\n\n\t\tvar html='<div event_id=\"'+ev.id+'\" '+this.config.event_attribute+'=\"'+ev.id+'\" class=\"'+cs+'\" style=\"position:absolute; top:'+y+'px; left:'+x+'px; width:'+(x2-x-15)+'px;'+(ev._text_style||\"\")+'\">';\n\n\t\tif (ev._timed)\n\t\t\thtml+=(scheduler.templates['event_bar_date_'+ev.layer])?scheduler.templates['event_bar_date_'+ev.layer](ev.start_date,ev.end_date,ev):scheduler.templates.event_bar_date(ev.start_date,ev.end_date,ev);\n\t\thtml+=( (scheduler.templates['event_bar_text_'+ev.layer])?scheduler.templates['event_bar_text_'+ev.layer](ev.start_date,ev.end_date,ev):scheduler.templates.event_bar_text(ev.start_date,ev.end_date,ev) + '</div>)');\n\t\thtml+='</div>';\n\n\t\td.innerHTML=html;\n\n\t\tthis._rendered.push(d.firstChild);\n\t\tparent.appendChild(d.firstChild);\n\t};\n\n\tscheduler.render_event=function(ev){\n\t\tvar menu = scheduler.xy.menu_width;\n\t\tif(scheduler.getLayer(ev.layer).noMenu)\n\t\t\tmenu = 0;\n\n\t\tif (ev._sday<0) return; //can occur in case of recurring event during time shift\n\t\tvar parent=scheduler.locate_holder(ev._sday);\n\t\tif (!parent) return; //attempt to render non-visible event\n\t\tvar sm = ev.start_date.getHours()*60+ev.start_date.getMinutes();\n\t\tvar em = (ev.end_date.getHours()*60+ev.end_date.getMinutes())||(scheduler.config.last_hour*60);\n\n\t\tvar top = (Math.round((sm*60*1000-this.config.first_hour*60*60*1000)*this.config.hour_size_px/(60*60*1000)))%(this.config.hour_size_px*24)+1; //42px/hour\n\t\tvar height = Math.max(scheduler.xy.min_event_height,(em-sm)*this.config.hour_size_px/60)+1; //42px/hour\n\t\t\n\t\tvar width=Math.floor((parent.clientWidth-menu)/ev._count);\n\t\tvar left=ev._sorder*width+1;\n\t\tif (!ev._inner) width=width*(ev._count-ev._sorder);\n\n\n\n\t\tvar d=this._render_v_bar(ev.id,menu+left,top,width,height,ev._text_style,scheduler.templates.event_header(ev.start_date,ev.end_date,ev),scheduler.templates.event_text(ev.start_date,ev.end_date,ev));\n\n\t\tthis._rendered.push(d);\n\t\tparent.appendChild(d);\n\n\t\tleft=left+parseInt(parent.style.left,10)+menu;\n\n\t\ttop+=this._dy_shift; //corrupt top, to include possible multi-day shift\n\t\td.style.zIndex = this._layers_zindex[ev.layer];\n\n\t\tif (this._edit_id==ev.id){\n\t\t\td.style.zIndex = parseInt(d.style.zIndex)+1; //fix overlapping issue\n\t\t\tvar new_zIndex = d.style.zIndex;\n\t\t\twidth=Math.max(width-4,scheduler.xy.editor_width);\n\t\t\tvar d=document.createElement(\"div\");\n\t\t\td.setAttribute(\"event_id\",ev.id); // for backward compatibility\n\t\t\td.setAttribute(this.config.event_attribute,ev.id);\n\t\t\tthis.set_xy(d,width,height-20,left,top+14);\n\t\t\td.className=\"dhx_cal_editor\";\n\t\t\td.style.zIndex = new_zIndex;\n\t\t\tvar d2=document.createElement(\"div\");\n\t\t\tthis.set_xy(d2,width-6,height-26);\n\t\t\td2.style.cssText+=\";margin:2px 2px 2px 2px;overflow:hidden;\";\n\n\n\t\t\td2.style.zIndex = new_zIndex;\n\t\t\td.appendChild(d2);\n\t\t\tthis._els[\"dhx_cal_data\"][0].appendChild(d);\n\t\t\tthis._rendered.push(d);\n\n\t\t\td2.innerHTML=\"<textarea class='dhx_cal_editor'>\"+ev.text+\"</textarea>\";\n\n\t\t\tthis._editor=d2.firstChild;\n\t\t\tthis._editor.addEventListener(\"keypress\", function(e){\n\t\t\t\tif (e.shiftKey) return true;\n\t\t\t\tvar code= e.keyCode;\n\t\t\t\tif (code==scheduler.keys.edit_save) scheduler.editStop(true);\n\t\t\t\tif (code==scheduler.keys.edit_cancel) scheduler.editStop(false);\n\t\t\t});\n\t\t\tthis._editor.addEventListener(\"selectstart\", function(e){ e.cancelBubble=true; return true; });\n\t\t\td2.firstChild.focus();\n\t\t\t//IE and opera can add x-scroll during focusing\n\t\t\tthis._els[\"dhx_cal_data\"][0].scrollLeft=0;\n\t\t\td2.firstChild.select();\n\t\t}\n\t\tif (this._select_id==ev.id){\n\t\t\td.style.zIndex = parseInt(d.style.zIndex)+1; //fix overlapping issue\n\t\t\tvar icons=this.config[\"icons_\"+((this._edit_id==ev.id)?\"edit\":\"select\")];\n\t\t\tvar icons_str=\"\";\n\t\t\tfor (var i=0; i<icons.length; i++)\n\t\t\t\ticons_str+=\"<div class='dhx_menu_icon \"+icons[i]+\"' title='\"+this.locale.labels[icons[i]]+\"'></div>\";\n\t\t\tvar obj = this._render_v_bar(ev.id,left-menu+1,top,menu,icons.length*20+26,\"\",\"<div class='dhx_menu_head'></div>\",icons_str,true);\n\t\t\tobj.style.left=left-menu+1;\n\t\t\tobj.style.zIndex = d.style.zIndex;\n\t\t\tthis._els[\"dhx_cal_data\"][0].appendChild(obj);\n\t\t\tthis._rendered.push(obj);\n\t\t}\n\n\t};\n\n    scheduler.filter_agenda = function(id, event) {\n        var layer = scheduler.getLayer(event.layer);\n        return (layer && layer.visible);\n    };\n});\n\n\n}","import definition from \"../legacy/dhtmlxcommon\";\n\n\nexport default function(scheduler){\n\tdefinition();\n}","import global from \"../global\";\nimport dhtmlxErrorConstructor from \"./dhtmlx_error\";\nexport default function extend() {\n\n/* eslint-disable  */\n\nif (!global.dhtmlx) {\n\tglobal.dhtmlx = function (obj) {\n\t\tfor (var a in obj) dhtmlx[a] = obj[a];\n\t\treturn dhtmlx; //simple singleton\n\t};\n}\nlet dhtmlx = global.dhtmlx;\n\ndhtmlx.extend_api = function (name, map, ext) {\n\tvar t = global[name];\n\tif (!t) return; //component not defined\n\tglobal[name] = function (obj) {\n\t\tvar that;\n\n\t\tif (obj && typeof obj == \"object\" && !obj.tagName) {\n\t\t\tthat = t.apply(this, (map._init ? map._init(obj) : arguments));\n\t\t\t//global settings\n\t\t\tfor (var a in dhtmlx)\n\t\t\t\tif (map[a]) this[map[a]](dhtmlx[a]);\n\t\t\t//local settings\n\t\t\tfor (var a in obj) {\n\t\t\t\tif (map[a]) this[map[a]](obj[a]);\n\t\t\t\telse if (a.indexOf(\"on\") === 0) {\n\t\t\t\t\tthis.attachEvent(a, obj[a]);\n\t\t\t\t}\n\t\t\t}\n\t\t} else\n\t\t\tthat = t.apply(this, arguments);\n\t\tif (map._patch) map._patch(this);\n\t\treturn that || this;\n\t};\n\tglobal[name].prototype = t.prototype;\n\tif (ext)\n\t\tdhtmlXHeir(global[name].prototype, ext);\n};\n\n// TODO: remove\nglobal.dhtmlxAjax = {\n\tget: function (url, callback) {\n\t\tvar t = new dtmlXMLLoaderObject(true);\n\t\tt.async = (arguments.length < 3);\n\t\tt.waitCall = callback;\n\t\tt.loadXML(url);\n\t\treturn t;\n\t},\n\tpost: function (url, post, callback) {\n\t\tvar t = new dtmlXMLLoaderObject(true);\n\t\tt.async = (arguments.length < 4);\n\t\tt.waitCall = callback;\n\t\tt.loadXML(url, true, post);\n\t\treturn t;\n\t},\n\tgetSync: function (url) {\n\t\treturn this.get(url, null, true);\n\t},\n\tpostSync: function (url, post) {\n\t\treturn this.post(url, post, null, true);\n\t}\n};\n\n\n// TODO: remove\n/**\n *\t @desc: xmlLoader object\n\t*\t @type: private\n\t*\t @param: funcObject - xml parser function\n\t*\t @param: object - jsControl object\n\t*\t @param: async - sync/async mode (async by default)\n\t*\t @param: rSeed - enable/disable random seed ( prevent IE caching)\n\t*\t @topic: 0\n\t*/\nfunction dtmlXMLLoaderObject(funcObject, dhtmlObject, async, rSeed) {\n\tthis.xmlDoc = \"\";\n\n\tif (typeof (async) != \"undefined\")\n\t\tthis.async = async;\n\telse\n\t\tthis.async = true;\n\n\tthis.onloadAction = funcObject || null;\n\tthis.mainObject = dhtmlObject || null;\n\tthis.waitCall = null;\n\tthis.rSeed = rSeed || false;\n\treturn this;\n}\n\nglobal.dtmlXMLLoaderObject = dtmlXMLLoaderObject;\n\ndtmlXMLLoaderObject.count = 0;\n\n/**\n *\t @desc: xml loading handler\n\t*\t @type: private\n\t*\t @param: dtmlObject - xmlLoader object\n\t*\t @topic: 0\n\t*/\ndtmlXMLLoaderObject.prototype.waitLoadFunction = function (dhtmlObject) {\n\tvar once = true;\n\tthis.check = function () {\n\t\tif ((dhtmlObject) && (dhtmlObject.onloadAction)) {\n\t\t\tif ((!dhtmlObject.xmlDoc.readyState) || (dhtmlObject.xmlDoc.readyState == 4)) {\n\t\t\t\tif (!once)\n\t\t\t\t\treturn;\n\n\t\t\t\tonce = false; //IE 5 fix\n\t\t\t\tdtmlXMLLoaderObject.count++;\n\t\t\t\tif (typeof dhtmlObject.onloadAction == \"function\")\n\t\t\t\t\tdhtmlObject.onloadAction(dhtmlObject.mainObject, null, null, null, dhtmlObject);\n\n\t\t\t\tif (dhtmlObject.waitCall) {\n\t\t\t\t\tdhtmlObject.waitCall.call(this, dhtmlObject);\n\t\t\t\t\tdhtmlObject.waitCall = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\treturn this.check;\n};\n\n/**\n *\t @desc: return XML top node\n\t*\t @param: tagName - top XML node tag name (not used in IE, required for Safari and Mozilla)\n\t*\t @type: private\n\t*\t @returns: top XML node\n\t*\t @topic: 0\n\t*/\ndtmlXMLLoaderObject.prototype.getXMLTopNode = function (tagName, oldObj) {\n\tvar z;\n\n\tif (this.xmlDoc.responseXML) {\n\t\tvar temp = this.xmlDoc.responseXML.getElementsByTagName(tagName);\n\t\tif (temp.length === 0 && tagName.indexOf(\":\") != -1)\n\t\t\tvar temp = this.xmlDoc.responseXML.getElementsByTagName((tagName.split(\":\"))[1]);\n\t\tz = temp[0];\n\t} else\n\t\tz = this.xmlDoc.documentElement;\n\n\tif (z) {\n\t\tthis._retry = false;\n\t\treturn z;\n\t}\n\n\tif (!this._retry && _isIE) {\n\t\tthis._retry = true;\n\t\tvar oldObj = this.xmlDoc;\n\t\tthis.loadXMLString(this.xmlDoc.responseText.replace(/^[\\s]+/, \"\"), true);\n\t\treturn this.getXMLTopNode(tagName, oldObj);\n\t}\n\n\tdhtmlxError.throwError(\"LoadXML\", \"Incorrect XML\", [\n\t\t(oldObj || this.xmlDoc),\n\t\tthis.mainObject\n\t]);\n\n\treturn document.createElement(\"div\");\n};\n\n/**\n *\t @desc: load XML from string\n\t*\t @type: private\n\t*\t @param: xmlString - xml string\n\t*\t @topic: 0\n\t*/\ndtmlXMLLoaderObject.prototype.loadXMLString = function (xmlString, silent) {\n\n\tif (!_isIE) {\n\t\tvar parser = new DOMParser();\n\t\tthis.xmlDoc = parser.parseFromString(xmlString, \"text/xml\");\n\t} else {\n\t\tthis.xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n\t\tthis.xmlDoc.async = this.async;\n\t\tthis.xmlDoc.onreadystatechange = function () { };\n\t\tthis.xmlDoc[\"loadXM\" + \"L\"](xmlString);\n\t}\n\n\tif (silent)\n\t\treturn;\n\n\tif (this.onloadAction)\n\t\tthis.onloadAction(this.mainObject, null, null, null, this);\n\n\tif (this.waitCall) {\n\t\tthis.waitCall();\n\t\tthis.waitCall = null;\n\t}\n};\n/**\n *\t @desc: load XML\n\t*\t @type: private\n\t*\t @param: filePath - xml file path\n\t*\t @param: postMode - send POST request\n\t*\t @param: postVars - list of vars for post request\n\t*\t @topic: 0\n\t*/\ndtmlXMLLoaderObject.prototype.loadXML = function (filePath, postMode, postVars, rpc) {\n\tif (this.rSeed)\n\t\tfilePath += ((filePath.indexOf(\"?\") != -1) ? \"&\" : \"?\") + \"a_dhx_rSeed=\" + (new Date()).valueOf();\n\tthis.filePath = filePath;\n\n\tif ((!_isIE) && (global.XMLHttpRequest))\n\t\tthis.xmlDoc = new XMLHttpRequest();\n\telse {\n\t\tthis.xmlDoc = new ActiveXObject(\"Microsoft.XMLHTTP\");\n\t}\n\n\tif (this.async)\n\t\tthis.xmlDoc.onreadystatechange = new this.waitLoadFunction(this);\n\tif (typeof postMode == \"string\")\n\t\tthis.xmlDoc.open(postMode, filePath, this.async);\n\telse\n\t\tthis.xmlDoc.open(postMode ? \"POST\" : \"GET\", filePath, this.async);\n\n\tif (rpc) {\n\t\tthis.xmlDoc.setRequestHeader(\"User-Agent\", \"dhtmlxRPC v0.1 (\" + navigator.userAgent + \")\");\n\t\tthis.xmlDoc.setRequestHeader(\"Content-type\", \"text/xml\");\n\t}\n\n\telse if (postMode)\n\t\tthis.xmlDoc.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\n\tthis.xmlDoc.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\tthis.xmlDoc.send(null || postVars);\n\n\tif (!this.async)\n\t\t(new this.waitLoadFunction(this))();\n};\n/**\n *\t @desc: destructor, cleans used memory\n\t*\t @type: private\n\t*\t @topic: 0\n\t*/\ndtmlXMLLoaderObject.prototype.destructor = function () {\n\tthis._filterXPath = null;\n\tthis._getAllNamedChilds = null;\n\tthis._retry = null;\n\tthis.async = null;\n\tthis.rSeed = null;\n\tthis.filePath = null;\n\tthis.onloadAction = null;\n\tthis.mainObject = null;\n\tthis.xmlDoc = null;\n\tthis.doXPath = null;\n\tthis.doXPathOpera = null;\n\tthis.doXSLTransToObject = null;\n\tthis.doXSLTransToString = null;\n\tthis.loadXML = null;\n\tthis.loadXMLString = null;\n\t// this.waitLoadFunction = null;\n\tthis.doSerialization = null;\n\tthis.xmlNodeToJSON = null;\n\tthis.getXMLTopNode = null;\n\tthis.setXSLParamValue = null;\n\treturn null;\n};\n\ndtmlXMLLoaderObject.prototype.xmlNodeToJSON = function (node) {\n\tvar t = {};\n\tfor (var i = 0; i < node.attributes.length; i++)\n\t\tt[node.attributes[i].name] = node.attributes[i].value;\n\tt[\"_tagvalue\"] = node.firstChild ? node.firstChild.nodeValue : \"\";\n\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\tvar name = node.childNodes[i].tagName;\n\t\tif (name) {\n\t\t\tif (!t[name]) t[name] = [];\n\t\t\tt[name].push(this.xmlNodeToJSON(node.childNodes[i]));\n\t\t}\n\t}\n\treturn t;\n};\n\nfunction dhtmlDragAndDropObject() {\n\tif (global.dhtmlDragAndDrop)\n\t\treturn global.dhtmlDragAndDrop;\n\n\tthis.lastLanding = 0;\n\tthis.dragNode = 0;\n\tthis.dragStartNode = 0;\n\tthis.dragStartObject = 0;\n\tthis.tempDOMU = null;\n\tthis.tempDOMM = null;\n\tthis.waitDrag = 0;\n\tglobal.dhtmlDragAndDrop = this;\n\n\treturn this;\n}\n\nglobal.dhtmlDragAndDropObject = dhtmlDragAndDropObject;\n\ndhtmlDragAndDropObject.prototype.removeDraggableItem = function (htmlNode) {\n\thtmlNode.onmousedown = null;\n\thtmlNode.dragStarter = null;\n\thtmlNode.dragLanding = null;\n};\n\ndhtmlDragAndDropObject.prototype.addDraggableItem = function (htmlNode, dhtmlObject) {\n\thtmlNode.onmousedown = this.preCreateDragCopy;\n\thtmlNode.dragStarter = dhtmlObject;\n\tthis.addDragLanding(htmlNode, dhtmlObject);\n};\n\ndhtmlDragAndDropObject.prototype.addDragLanding = function (htmlNode, dhtmlObject) {\n\thtmlNode.dragLanding = dhtmlObject;\n};\n\ndhtmlDragAndDropObject.prototype.preCreateDragCopy = function (e) {\n\tif ((e || global.event) && (e || event).button == 2)\n\t\treturn;\n\n\tif (global.dhtmlDragAndDrop.waitDrag) {\n\t\tglobal.dhtmlDragAndDrop.waitDrag = 0;\n\t\tdocument.body.onmouseup = global.dhtmlDragAndDrop.tempDOMU;\n\t\tdocument.body.onmousemove = global.dhtmlDragAndDrop.tempDOMM;\n\t\treturn false;\n\t}\n\n\tif (global.dhtmlDragAndDrop.dragNode)\n\t\tglobal.dhtmlDragAndDrop.stopDrag(e);\n\n\tglobal.dhtmlDragAndDrop.waitDrag = 1;\n\tglobal.dhtmlDragAndDrop.tempDOMU = document.body.onmouseup;\n\tglobal.dhtmlDragAndDrop.tempDOMM = document.body.onmousemove;\n\tglobal.dhtmlDragAndDrop.dragStartNode = this;\n\tglobal.dhtmlDragAndDrop.dragStartObject = this.dragStarter;\n\tdocument.body.onmouseup = global.dhtmlDragAndDrop.preCreateDragCopy;\n\tdocument.body.onmousemove = global.dhtmlDragAndDrop.callDrag;\n\tglobal.dhtmlDragAndDrop.downtime = new Date().valueOf();\n\n\n\tif ((e) && (e.preventDefault)) {\n\t\te.preventDefault();\n\t\treturn false;\n\t}\n\treturn false;\n};\n\ndhtmlDragAndDropObject.prototype.callDrag = function (e) {\n\tif (!e)\n\t\te = global.event;\n\tvar dragger = global.dhtmlDragAndDrop;\n\tif ((new Date()).valueOf() - dragger.downtime < 100) return;\n\n\t//if ((e.button == 0)&&(_isIE))\n\t//\treturn dragger.stopDrag();\n\n\tif (!dragger.dragNode) {\n\t\tif (dragger.waitDrag) {\n\t\t\tdragger.dragNode = dragger.dragStartObject._createDragNode(dragger.dragStartNode, e);\n\n\t\t\tif (!dragger.dragNode)\n\t\t\t\treturn dragger.stopDrag();\n\n\t\t\tdragger.dragNode.onselectstart = function () { return false; };\n\t\t\tdragger.gldragNode = dragger.dragNode;\n\t\t\tdocument.body.appendChild(dragger.dragNode);\n\t\t\tdocument.body.onmouseup = dragger.stopDrag;\n\t\t\tdragger.waitDrag = 0;\n\t\t\tdragger.dragNode.pWindow = global;\n\t\t\tdragger.initFrameRoute();\n\t\t}\n\t\telse return dragger.stopDrag(e, true);\n\t}\n\n\tif (dragger.dragNode.parentNode != global.document.body && dragger.gldragNode) {\n\t\tvar grd = dragger.gldragNode;\n\n\t\tif (dragger.gldragNode.old)\n\t\t\tgrd = dragger.gldragNode.old;\n\n\t\t//if (!document.all) dragger.calculateFramePosition();\n\t\tgrd.parentNode.removeChild(grd);\n\t\tvar oldBody = dragger.dragNode.pWindow;\n\n\t\tif (grd.pWindow && grd.pWindow.dhtmlDragAndDrop.lastLanding)\n\t\t\tgrd.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(grd.pWindow.dhtmlDragAndDrop.lastLanding);\n\n\t\t//\t\tvar oldp=dragger.dragNode.parentObject;\n\t\tif (_isIE) {\n\t\t\tvar div = document.createElement(\"div\");\n\t\t\tdiv.innerHTML = dragger.dragNode.outerHTML;\n\t\t\tdragger.dragNode = div.childNodes[0];\n\t\t} else\n\t\t\tdragger.dragNode = dragger.dragNode.cloneNode(true);\n\n\t\tdragger.dragNode.pWindow = global;\n\t\t//\t\tdragger.dragNode.parentObject=oldp;\n\n\t\tdragger.gldragNode.old = dragger.dragNode;\n\t\tdocument.body.appendChild(dragger.dragNode);\n\t\toldBody.dhtmlDragAndDrop.dragNode = dragger.dragNode;\n\t}\n\n\tdragger.dragNode.style.left = e.clientX + 15 +\n\t\t(dragger.fx ? dragger.fx * (-1) : 0) +\n\t\t(document.body.scrollLeft || document.documentElement.scrollLeft) + \"px\";\n\tdragger.dragNode.style.top = e.clientY + 3 +\n\t\t(dragger.fy ? dragger.fy * (-1) : 0) +\n\t\t(document.body.scrollTop || document.documentElement.scrollTop) + \"px\";\n\n\tvar z;\n\tif (!e.srcElement)\n\t\tz = e.target;\n\telse\n\t\tz = e.srcElement;\n\tdragger.checkLanding(z, e);\n};\n\ndhtmlDragAndDropObject.prototype.calculateFramePosition = function (n) {\n\t//this.fx = 0, this.fy = 0;\n\tif (global.name) {\n\t\tvar el = parent.frames[global.name].frameElement.offsetParent;\n\t\tvar fx = 0;\n\t\tvar fy = 0;\n\n\t\twhile (el) {\n\t\t\tfx += el.offsetLeft;\n\t\t\tfy += el.offsetTop;\n\t\t\tel = el.offsetParent;\n\t\t}\n\n\t\tif ((parent.dhtmlDragAndDrop)) {\n\t\t\tvar ls = parent.dhtmlDragAndDrop.calculateFramePosition(1);\n\t\t\tfx += ls.split('_')[0] * 1;\n\t\t\tfy += ls.split('_')[1] * 1;\n\t\t}\n\n\t\tif (n)\n\t\t\treturn fx + \"_\" + fy;\n\t\telse\n\t\t\tthis.fx = fx;\n\t\tthis.fy = fy;\n\t}\n\treturn \"0_0\";\n};\n\ndhtmlDragAndDropObject.prototype.checkLanding = function (htmlObject, e) {\n\tif ((htmlObject) && (htmlObject.dragLanding)) {\n\t\tif (this.lastLanding)\n\t\t\tthis.lastLanding.dragLanding._dragOut(this.lastLanding);\n\t\tthis.lastLanding = htmlObject;\n\t\tthis.lastLanding = this.lastLanding.dragLanding._dragIn(this.lastLanding, this.dragStartNode, e.clientX,\n\t\t\te.clientY, e);\n\t\tthis.lastLanding_scr = (_isIE ? e.srcElement : e.target);\n\t} else {\n\t\tif ((htmlObject) && (htmlObject.tagName != \"BODY\"))\n\t\t\tthis.checkLanding(htmlObject.parentNode, e);\n\t\telse {\n\t\t\tif (this.lastLanding)\n\t\t\t\tthis.lastLanding.dragLanding._dragOut(this.lastLanding, e.clientX, e.clientY, e);\n\t\t\tthis.lastLanding = 0;\n\n\t\t\tif (this._onNotFound)\n\t\t\t\tthis._onNotFound();\n\t\t}\n\t}\n};\n\ndhtmlDragAndDropObject.prototype.stopDrag = function (e, mode) {\n\tvar dragger = global.dhtmlDragAndDrop;\n\n\tif (!mode) {\n\t\tdragger.stopFrameRoute();\n\t\tvar temp = dragger.lastLanding;\n\t\tdragger.lastLanding = null;\n\n\t\tif (temp)\n\t\t\ttemp.dragLanding._drag(dragger.dragStartNode, dragger.dragStartObject, temp,\n\t\t\t\t(_isIE ? event.srcElement : e.target));\n\t}\n\tdragger.lastLanding = null;\n\n\tif ((dragger.dragNode) && (dragger.dragNode.parentNode == document.body))\n\t\tdragger.dragNode.parentNode.removeChild(dragger.dragNode);\n\tdragger.dragNode = 0;\n\tdragger.gldragNode = 0;\n\tdragger.fx = 0;\n\tdragger.fy = 0;\n\tdragger.dragStartNode = 0;\n\tdragger.dragStartObject = 0;\n\tdocument.body.onmouseup = dragger.tempDOMU;\n\tdocument.body.onmousemove = dragger.tempDOMM;\n\tdragger.tempDOMU = null;\n\tdragger.tempDOMM = null;\n\tdragger.waitDrag = 0;\n};\n\ndhtmlDragAndDropObject.prototype.stopFrameRoute = function (win) {\n\tif (win)\n\t\tglobal.dhtmlDragAndDrop.stopDrag(1, 1);\n\n\tfor (var i = 0; i < global.frames.length; i++) {\n\t\ttry {\n\t\t\tif ((global.frames[i] != win) && (global.frames[i].dhtmlDragAndDrop))\n\t\t\t\tglobal.frames[i].dhtmlDragAndDrop.stopFrameRoute(global);\n\t\t} catch (e) { }\n\t}\n\n\ttry {\n\t\tif ((parent.dhtmlDragAndDrop) && (parent != global) && (parent != win))\n\t\t\tparent.dhtmlDragAndDrop.stopFrameRoute(global);\n\t} catch (e) { }\n};\n\ndhtmlDragAndDropObject.prototype.initFrameRoute = function (win, mode) {\n\tif (win) {\n\t\tglobal.dhtmlDragAndDrop.preCreateDragCopy();\n\t\tglobal.dhtmlDragAndDrop.dragStartNode = win.dhtmlDragAndDrop.dragStartNode;\n\t\tglobal.dhtmlDragAndDrop.dragStartObject = win.dhtmlDragAndDrop.dragStartObject;\n\t\tglobal.dhtmlDragAndDrop.dragNode = win.dhtmlDragAndDrop.dragNode;\n\t\tglobal.dhtmlDragAndDrop.gldragNode = win.dhtmlDragAndDrop.dragNode;\n\t\tglobal.document.body.onmouseup = global.dhtmlDragAndDrop.stopDrag;\n\t\tglobal.waitDrag = 0;\n\n\t\tif (((!_isIE) && (mode)) && ((!_isFF) || (_FFrv < 1.8)))\n\t\t\tglobal.dhtmlDragAndDrop.calculateFramePosition();\n\t}\n\ttry {\n\t\tif ((parent.dhtmlDragAndDrop) && (parent != global) && (parent != win))\n\t\t\tparent.dhtmlDragAndDrop.initFrameRoute(global);\n\t} catch (e) { }\n\n\tfor (var i = 0; i < global.frames.length; i++) {\n\t\ttry {\n\t\t\tif ((global.frames[i] != win) && (global.frames[i].dhtmlDragAndDrop))\n\t\t\t\tglobal.frames[i].dhtmlDragAndDrop.initFrameRoute(global, ((!win || mode) ? 1 : 0));\n\t\t} catch (e) { }\n\t}\n};\n\nvar _isFF = false;\nvar _isIE = false;\nvar _isOpera = false;\nvar _isKHTML = false;\nvar _isMacOS = false;\nvar _isChrome = false;\nvar _FFrv = false;\nvar _KHTMLrv = false;\nvar _OperaRv = false;\n\nif (navigator.userAgent.indexOf('Macintosh') != -1)\n\t_isMacOS = true;\n\n\nif (navigator.userAgent.toLowerCase().indexOf('chrome') > -1)\n\t_isChrome = true;\n\nif ((navigator.userAgent.indexOf('Safari') != -1) || (navigator.userAgent.indexOf('Konqueror') != -1)) {\n\t_KHTMLrv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf('Safari') + 7, 5));\n\n\tif (_KHTMLrv > 525) { //mimic FF behavior for Safari 3.1+\n\t\t_isFF = true;\n\t\t_FFrv = 1.9;\n\t} else\n\t\t_isKHTML = true;\n} else if (navigator.userAgent.indexOf('Opera') != -1) {\n\t_isOpera = true;\n\t_OperaRv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf('Opera') + 6, 3));\n}\n\n\nelse if (navigator.appName.indexOf(\"Microsoft\") != -1) {\n\t_isIE = true;\n\tif ((navigator.appVersion.indexOf(\"MSIE 8.0\") != -1 || navigator.appVersion.indexOf(\"MSIE 9.0\") != -1 || navigator.appVersion.indexOf(\"MSIE 10.0\") != -1) && document.compatMode != \"BackCompat\") {\n\t\t_isIE = 8;\n\t}\n} else if (navigator.appName == 'Netscape' && navigator.userAgent.indexOf(\"Trident\") != -1) {\n\t//ie11\n\t_isIE = 8;\n} else {\n\t_isFF = true;\n\t_FFrv = parseFloat(navigator.userAgent.split(\"rv:\")[1]);\n}\n\n\n//multibrowser Xpath processor\ndtmlXMLLoaderObject.prototype.doXPath = function (xpathExp, docObj, namespace, result_type) {\n\tif (_isKHTML || (!_isIE && !global.XPathResult))\n\t\treturn this.doXPathOpera(xpathExp, docObj);\n\n\tif (_isIE) { //IE\n\t\tif (!docObj)\n\t\t\tif (!this.xmlDoc.nodeName)\n\t\t\t\tdocObj = this.xmlDoc.responseXML;\n\t\t\telse\n\t\t\t\tdocObj = this.xmlDoc;\n\n\t\tif (!docObj)\n\t\t\tdhtmlxError.throwError(\"LoadXML\", \"Incorrect XML\", [\n\t\t\t\t(docObj || this.xmlDoc),\n\t\t\t\tthis.mainObject\n\t\t\t]);\n\n\t\tif (namespace)\n\t\t\tdocObj.setProperty(\"SelectionNamespaces\", \"xmlns:xsl='\" + namespace + \"'\"); //\n\n\t\tif (result_type == 'single') {\n\t\t\treturn docObj.selectSingleNode(xpathExp);\n\t\t}\n\t\telse {\n\t\t\treturn docObj.selectNodes(xpathExp) || new Array(0);\n\t\t}\n\t} else { //Mozilla\n\t\tvar nodeObj = docObj;\n\n\t\tif (!docObj) {\n\t\t\tif (!this.xmlDoc.nodeName) {\n\t\t\t\tdocObj = this.xmlDoc.responseXML;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdocObj = this.xmlDoc;\n\t\t\t}\n\t\t}\n\n\t\tif (!docObj)\n\t\t\tdhtmlxError.throwError(\"LoadXML\", \"Incorrect XML\", [\n\t\t\t\t(docObj || this.xmlDoc),\n\t\t\t\tthis.mainObject\n\t\t\t]);\n\n\t\tif (docObj.nodeName.indexOf(\"document\") != -1) {\n\t\t\tnodeObj = docObj;\n\t\t}\n\t\telse {\n\t\t\tnodeObj = docObj;\n\t\t\tdocObj = docObj.ownerDocument;\n\t\t}\n\t\tvar retType = XPathResult.ANY_TYPE;\n\n\t\tif (result_type == 'single')\n\t\t\tretType = XPathResult.FIRST_ORDERED_NODE_TYPE;\n\t\tvar rowsCol = [];\n\t\tvar col = docObj.evaluate(xpathExp, nodeObj, function (pref) {\n\t\t\treturn namespace;\n\t\t}, retType, null);\n\n\t\tif (retType == XPathResult.FIRST_ORDERED_NODE_TYPE) {\n\t\t\treturn col.singleNodeValue;\n\t\t}\n\t\tvar thisColMemb = col.iterateNext();\n\n\t\twhile (thisColMemb) {\n\t\t\trowsCol[rowsCol.length] = thisColMemb;\n\t\t\tthisColMemb = col.iterateNext();\n\t\t}\n\t\treturn rowsCol;\n\t}\n};\n\n\nglobal.dhtmlxError = new dhtmlxErrorConstructor();\n\n\n//opera fake, while 9.0 not released\n//multibrowser Xpath processor\ndtmlXMLLoaderObject.prototype.doXPathOpera = function (xpathExp, docObj) {\n\t//this is fake for Opera\n\tvar z = xpathExp.replace(/[\\/]+/gi, \"/\").split('/');\n\tvar obj = null;\n\tvar i = 1;\n\n\tif (!z.length)\n\t\treturn [];\n\n\tif (z[0] == \".\")\n\t\tobj = [docObj]; else if (z[0] === \"\") {\n\t\t\tobj = (this.xmlDoc.responseXML || this.xmlDoc).getElementsByTagName(z[i].replace(/\\[[^\\]]*\\]/g, \"\"));\n\t\t\ti++;\n\t\t} else\n\t\treturn [];\n\n\tfor (i; i < z.length; i++)obj = this._getAllNamedChilds(obj, z[i]);\n\n\tif (z[i - 1].indexOf(\"[\") != -1)\n\t\tobj = this._filterXPath(obj, z[i - 1]);\n\treturn obj;\n};\n\ndtmlXMLLoaderObject.prototype._filterXPath = function (a, b) {\n\tvar c = [];\n\tvar b = b.replace(/[^\\[]*\\[\\@/g, \"\").replace(/[\\[\\]\\@]*/g, \"\");\n\n\tfor (var i = 0; i < a.length; i++)\n\t\tif (a[i].getAttribute(b))\n\t\t\tc[c.length] = a[i];\n\n\treturn c;\n};\n\ndtmlXMLLoaderObject.prototype._getAllNamedChilds = function (a, b) {\n\tvar c = [];\n\n\tif (_isKHTML)\n\t\tb = b.toUpperCase();\n\n\tfor (var i = 0; i < a.length; i++)for (var j = 0; j < a[i].childNodes.length; j++) {\n\t\tif (_isKHTML) {\n\t\t\tif (a[i].childNodes[j].tagName && a[i].childNodes[j].tagName.toUpperCase() == b)\n\t\t\t\tc[c.length] = a[i].childNodes[j];\n\t\t}\n\n\t\telse if (a[i].childNodes[j].tagName == b)\n\t\t\tc[c.length] = a[i].childNodes[j];\n\t}\n\n\treturn c;\n};\n\nfunction dhtmlXHeir(a, b) {\n\tfor (var c in b)\n\t\tif (typeof (b[c]) == \"function\")\n\t\t\ta[c] = b[c];\n\treturn a;\n}\n\nif (typeof (global.dhtmlxEvent) == 'undefined') {\n\tglobal.dhtmlxEvent = function dhtmlxEvent(el, event, handler) {\n\t\tif (el.addEventListener)\n\t\t\tel.addEventListener(event, handler, false);\n\n\t\telse if (el.attachEvent)\n\t\t\tel.attachEvent(\"on\" + event, handler);\n\t};\n}\n\n//============= XSL Extension ===================================\n\ndtmlXMLLoaderObject.prototype.xslDoc = null;\ndtmlXMLLoaderObject.prototype.setXSLParamValue = function (paramName, paramValue, xslDoc) {\n\tif (!xslDoc)\n\t\txslDoc = this.xslDoc;\n\n\tif (xslDoc.responseXML)\n\t\txslDoc = xslDoc.responseXML;\n\tvar item =\n\t\tthis.doXPath(\"/xsl:stylesheet/xsl:variable[@name='\" + paramName + \"']\", xslDoc,\n\t\t\t\"http:/\\/www.w3.org/1999/XSL/Transform\", \"single\");\n\n\tif (item)\n\t\titem.firstChild.nodeValue = paramValue;\n};\n\ndtmlXMLLoaderObject.prototype.doXSLTransToObject = function (xslDoc, xmlDoc) {\n\tif (!xslDoc)\n\t\txslDoc = this.xslDoc;\n\n\tif (xslDoc.responseXML)\n\t\txslDoc = xslDoc.responseXML;\n\n\tif (!xmlDoc)\n\t\txmlDoc = this.xmlDoc;\n\n\tif (xmlDoc.responseXML)\n\t\txmlDoc = xmlDoc.responseXML;\n\n\n\tvar result;\n\t//Mozilla\n\tif (!_isIE) {\n\t\tif (!this.XSLProcessor) {\n\t\t\tthis.XSLProcessor = new XSLTProcessor();\n\t\t\tthis.XSLProcessor.importStylesheet(xslDoc);\n\t\t}\n\t\tresult = this.XSLProcessor.transformToDocument(xmlDoc);\n\t} else {\n\t\tresult = new ActiveXObject(\"Msxml2.DOMDocument.3.0\");\n\t\ttry {\n\t\t\txmlDoc.transformNodeToObject(xslDoc, result);\n\t\t} catch (e) {\n\t\t\tresult = xmlDoc.transformNode(xslDoc);\n\t\t}\n\t}\n\treturn result;\n};\n\ndtmlXMLLoaderObject.prototype.doXSLTransToString = function (xslDoc, xmlDoc) {\n\tvar res = this.doXSLTransToObject(xslDoc, xmlDoc);\n\tif (typeof (res) == \"string\")\n\t\treturn res;\n\treturn this.doSerialization(res);\n};\n\ndtmlXMLLoaderObject.prototype.doSerialization = function (xmlDoc) {\n\tif (!xmlDoc)\n\t\txmlDoc = this.xmlDoc;\n\tif (xmlDoc.responseXML)\n\t\txmlDoc = xmlDoc.responseXML;\n\tif (!_isIE) {\n\t\tvar xmlSerializer = new XMLSerializer();\n\t\treturn xmlSerializer.serializeToString(xmlDoc);\n\t} else\n\t\treturn xmlDoc.xml;\n};\n\n/**\n *   @desc:\n *   @type: private\n */\nglobal.dhtmlxEventable = function (obj) {\n\tobj.attachEvent = function (name, catcher, callObj) {\n\t\tname = 'ev_' + name.toLowerCase();\n\t\tif (!this[name])\n\t\t\tthis[name] = new this.eventCatcher(callObj || this);\n\n\t\treturn (name + ':' + this[name].addEvent(catcher)); //return ID (event name & event ID)\n\t};\n\tobj.callEvent = function (name, arg0) {\n\t\tname = 'ev_' + name.toLowerCase();\n\t\tif (this[name])\n\t\t\treturn this[name].apply(this, arg0);\n\t\treturn true;\n\t};\n\tobj.checkEvent = function (name) {\n\t\treturn (!!this['ev_' + name.toLowerCase()]);\n\t};\n\tobj.eventCatcher = function (obj) {\n\t\tvar dhx_catch = [];\n\t\tvar z = function () {\n\t\t\tvar res = true;\n\t\t\tfor (var i = 0; i < dhx_catch.length; i++) {\n\t\t\t\tif (dhx_catch[i]) {\n\t\t\t\t\tvar zr = dhx_catch[i].apply(obj, arguments);\n\t\t\t\t\tres = res && zr;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\t\tz.addEvent = function (ev) {\n\t\t\tif (typeof (ev) != \"function\")\n\t\t\t\tthrow new Error(`Invalid argument addEvent(${ev})`);\n\t\t\tif (ev)\n\t\t\t\treturn dhx_catch.push(ev) - 1;\n\t\t\treturn false;\n\t\t};\n\t\tz.removeEvent = function (id) {\n\t\t\tdhx_catch[id] = null;\n\t\t};\n\t\treturn z;\n\t};\n\tobj.detachEvent = function (id) {\n\t\tif (id) {\n\t\t\tvar list = id.split(':');//get EventName and ID\n\t\t\tthis[list[0]].removeEvent(list[1]); //remove event\n\t\t}\n\t};\n\tobj.detachAllEvents = function () {\n\t\tfor (var name in this) {\n\t\t\tif (name.indexOf(\"ev_\") === 0) {\n\t\t\t\tthis.detachEvent(name);\n\t\t\t\tthis[name] = null;\n\t\t\t}\n\t\t}\n\t};\n\tobj = null;\n};\n\n}","export default function(scheduler){\n\nscheduler.config.limit_start = null;\nscheduler.config.limit_end   = null;\nscheduler.config.limit_view  = false;\nscheduler.config.check_limits = true;\n\nscheduler._temp_limit_scope = function(){\n\tvar before = null;\n\tvar dhx_time_block = \"dhx_time_block\";\n\n\tscheduler.attachEvent(\"onBeforeViewChange\",function(om,od,nm,nd){\n\n\t\tfunction isBlocked(date, mode){\n\t\t\tvar limit_start = scheduler.config.limit_start,\n\t\t\t\tlimit_end = scheduler.config.limit_end,\n\t\t\t\tdate_end =  scheduler.date.add(date,1,mode);\n\n\t\t\treturn (date.valueOf() > limit_end.valueOf() || date_end <= limit_start.valueOf());\n\t\t}\n\n\t\tif (scheduler.config.limit_view){\n\t\t\tnd = nd||od; nm = nm||om;\n\t\t\tif (isBlocked(nd, nm) && !(od.valueOf() == nd.valueOf())){\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif(scheduler.$destroyed){\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tvar resetDate = !isBlocked(od, nm) ? od : scheduler.config.limit_start;\n\n\t\t\t\t\tscheduler.setCurrentView(!isBlocked(resetDate, nm) ? resetDate : null, nm);\n\t\t\t\t},1);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onMouseDown\", function(classname) {\n\t\treturn !(classname == dhx_time_block);\n\t});\n\tscheduler.attachEvent(\"onBeforeDrag\",function(id){\n\t\tif (!id) return true;\n\t\treturn scheduler.checkLimitViolation(scheduler.getEvent(id));\n\t});\n\tscheduler.attachEvent(\"onClick\", function (event_id, native_event_object){\n\t\treturn scheduler.checkLimitViolation(scheduler.getEvent(event_id));\n    });\n\tscheduler.attachEvent(\"onBeforeLightbox\",function(id){\n\n\t\tvar ev = scheduler.getEvent(id);\n\t\tbefore = [ev.start_date, ev.end_date];\n\t\treturn scheduler.checkLimitViolation(ev);\n\t});\n\tscheduler.attachEvent(\"onEventSave\", function(id, data, is_new_event) {\n\n\t\t//lightbox may not have 'time' section\n\t\tif(!(data.start_date && data.end_date)){\n\t\t\tvar ev = scheduler.getEvent(id);\n\t\t\tdata.start_date = new Date(ev.start_date);\n\t\t\tdata.end_date = new Date(ev.end_date);\n\t\t}\n\n\t\tif(data.rec_type){\n\t\t\t//_roll_back_dates modifies start_date of recurring event, need to check limits after modification\n\t\t\t// use a copy to keep original event unchanged\n\t\t\tvar data_copy = scheduler._lame_clone(data);\n\t\t\tscheduler._roll_back_dates(data_copy);\n\t\t\treturn scheduler.checkLimitViolation(data_copy);\n\t\t}\n\t\treturn scheduler.checkLimitViolation(data);\n\t});\n\tscheduler.attachEvent(\"onEventAdded\",function(id){\n\t\tif (!id) return true;\n\t\tvar ev = scheduler.getEvent(id);\n\t\tif (!scheduler.checkLimitViolation(ev) && scheduler.config.limit_start && scheduler.config.limit_end) {\n\t\t\t//if newly created event is outside of limited time - crop it, leaving only allowed time\n\t\t\tif (ev.start_date < scheduler.config.limit_start) {\n\t\t\t\tev.start_date = new Date(scheduler.config.limit_start);\n\t\t\t}\n\t\t\tif (ev.start_date.valueOf() >= scheduler.config.limit_end.valueOf()) {\n\t\t\t\tev.start_date = this.date.add(scheduler.config.limit_end, -1, \"day\");\n\t\t\t}\n\t\t\tif (ev.end_date < scheduler.config.limit_start) {\n\t\t\t\tev.end_date = new Date(scheduler.config.limit_start);\n\t\t\t}\n\t\t\tif (ev.end_date.valueOf() >= scheduler.config.limit_end.valueOf()) {\n\t\t\t\tev.end_date = this.date.add(scheduler.config.limit_end, -1, \"day\");\n\t\t\t}\n\t\t\tif (ev.start_date.valueOf() >= ev.end_date.valueOf()) {\n\t\t\t\tev.end_date = this.date.add(ev.start_date, (this.config.event_duration||this.config.time_step), \"minute\");\n\t\t\t}\n\t\t\tev._timed=this.isOneDayEvent(ev);\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventChanged\",function(id){\n\t\tif (!id) return true;\n\t\tvar ev = scheduler.getEvent(id);\n\t\tif (!scheduler.checkLimitViolation(ev)){\n\t\t\tif (!before) return false;\n\t\t\tev.start_date = before[0];\n\t\t\tev.end_date = before[1];\n\t\t\tev._timed=this.isOneDayEvent(ev);\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onBeforeEventChanged\",function(ev, native_object, is_new){\n\t\treturn scheduler.checkLimitViolation(ev);\n\t});\n\tscheduler.attachEvent(\"onBeforeEventCreated\", function(ev) { // native event\n\t\tvar start_date = scheduler.getActionData(ev).date;\n\t\tvar event = {\n\t\t\t_timed: true,\n\t\t\tstart_date: start_date,\n\t\t\tend_date: scheduler.date.add(start_date, scheduler.config.time_step, \"minute\")\n\t\t};\n\t\treturn scheduler.checkLimitViolation(event);\n\t});\n\n\tscheduler.attachEvent(\"onViewChange\", function(){\n\t\tscheduler._mark_now();\n\t});\n\n\tscheduler.attachEvent(\"onAfterSchedulerResize\", function(){\n\t\twindow.setTimeout(function(){ \n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tscheduler._mark_now(); \n\t\t}, 1);\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onTemplatesReady\", function() {\n\t\tscheduler._mark_now_timer = window.setInterval(function() {\n\t\t\tif(!scheduler._is_initialized())\n\t\t\t\treturn;\n\t\t\tscheduler._mark_now();\n\t\t}, 60000);\n\t});\n\n\tscheduler.attachEvent(\"onDestroy\", function(){\n\t\tclearInterval(scheduler._mark_now_timer);\n\t});\n\n};\nscheduler._temp_limit_scope();\n\n\n}","import  { GoogleMapAdapter } from \"./gMapAdapter\";\nimport { OpenStreetMapAdapter } from \"./osmMapAdapter\";\nimport { MapboxAdapter } from \"./mapboxAdapter\";\nimport { IMapAdapter, ICalendarEvent, IMapSettings } from \"./types\";\n\ndeclare let google: any;\n\nexport default function(scheduler: any){\n\t\nlet mapAdapter: IMapAdapter | null = null;\nlet eventHandlerIds: number[] = [];\nconst adapters: { [name:string]: IMapAdapter } = {\n\tgoogleMap: new GoogleMapAdapter(scheduler),\n\topenStreetMaps: new OpenStreetMapAdapter(scheduler),\n\tmapbox: new MapboxAdapter(scheduler)\n}\n\nif(!scheduler.ext){\n\tscheduler.ext = {};\n}\nscheduler.ext.mapView = {\n\tcreateAdapter: function():IMapAdapter{\n\t\treturn adapters[scheduler.config.map_view_provider];\n\t},\n\tcreateMarker: function(config){\n\t\treturn new google.maps.Marker(config);\n\t},\n\tcurrentAdapter: null,\n\tadapters\n};\nscheduler._latLngUpdate  = false;  // flag for updating events which don't have event.lat and event.lng\nscheduler._eventLocationChanged = false;  // flag for checking if the location of the event is changed\nscheduler.config.map_view_provider = \"googleMap\";\nscheduler.config.map_settings = {\n\tinitial_position: {\n\t   lat: 48.724,\n\t   lng: 8.215\n\t},\n\terror_position: {\n\t   lat: 15,\n\t   lng: 15\n\t},\n\tinitial_zoom: 1,\n\tzoom_after_resolve: 15,\n\tinfo_window_max_width: 300,\n\tresolve_user_location: true,\n\tresolve_event_location: true,\n\tview_provider: \"googleMap\"\n}\nif (scheduler.config.map_initial_position) {\n\tscheduler.config.map_settings.initial_position = {\n\t\tlat: scheduler.config.map_initial_position.lat(),\n\t\tlng: scheduler.config.map_initial_position.lng(), \n\t};\n}\n\nif (scheduler.config.map_error_position) {\n\tscheduler.config.map_settings.error_position = {\n\t\tlat: scheduler.config.map_error_position.lat(),\n\t\tlng: scheduler.config.map_error_position.lng(), \n\t};\n}\n\nscheduler.xy.map_date_width = 188; // date column width\nscheduler.xy.map_icon_width = 25; // event details icon width\nscheduler.xy.map_description_width = 400; // description column width\nscheduler.date.add_map = function(date, inc, mode) {\n\treturn (new Date(date.valueOf()));\n};\nscheduler.templates.map_date = function(dd, ed, mode) {\n\treturn '';\n};\nscheduler.templates.map_time = function(start, end, ev) {\n\tif (scheduler.config.rtl && !ev._timed) {\n\t\treturn scheduler.templates.day_date(end) + \" &ndash; \" + scheduler.templates.day_date(start);\n\t} else if (ev._timed) {\n\t\treturn this.day_date(ev.start_date, ev.end_date, ev) + \" \" + this.event_date(start);\n\t} else {\n\t\treturn scheduler.templates.day_date(start) + \" &ndash; \" + scheduler.templates.day_date(end);\n\t}\n};\nscheduler.templates.map_text = function(start, end, ev) {\n\treturn ev.text;\n};\nscheduler.templates.map_info_content = function(event){\n    return `<div><b>Event's text:</b> ${event.text}\n\t\t\t\t<div><b>Location:</b> ${event.event_location}</div>\n\t\t\t\t<div><b>Starts:</b> ${scheduler.templates.tooltip_date_format(event.start_date)}</div>\n\t\t\t\t<div><b>Ends:</b> ${scheduler.templates.tooltip_date_format(event.end_date)}</div>\n\t\t\t</div>`;\n};\nscheduler.date.map_start = function(d) {\n\treturn d;\n};\n\nfunction setupMapView(scheduler) {\n\t// Initialization logic, possibly including creation of a new mapAdapter\n\tmapAdapter = scheduler.ext.mapView.createAdapter();\n\tattachSchedulerEvents();\n}\nasync function addEventWithLocation(event: ICalendarEvent, mapAdapter: IMapAdapter){\n\tlet coordinates = await mapAdapter.resolveAddress(event.event_location);\n\tevent.lat = coordinates.lat;\n\tevent.lng = coordinates.lng;\n\tmapAdapter.removeEventMarker(String(event.id));\n\tmapAdapter.addEventMarker(event);\n\treturn event;\n}\nfunction setUserLocation(options: IMapSettings, adapter: IMapAdapter): void{\n\tif (options.resolve_user_location) {\n\t\tif (navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition(function(position) {\n\t\t\t\tadapter.setView(position.coords.latitude, position.coords.longitude, options.zoom_after_resolve ||  options.initial_zoom);\n\t\t\t});\n\t\t}\n\t} else {\n\t\tadapter.setView(options.initial_position.lat, options.initial_position.lng, options.initial_zoom);\n\t}\n}\nscheduler.dblclick_dhx_map_area = function(e) {\n\tlet eventNode = e.target.closest(`[${scheduler.config.event_attribute}]`);\n\tif (eventNode){\n\t\tlet eventId = eventNode.getAttribute(`${scheduler.config.event_attribute}`);\n\t\tscheduler.showLightbox(eventId);\n\t}\n\tif (!this.config.readonly && this.config.dblclick_create && !eventNode) {\n\t\tthis.addEventNow({\n\t\t\tstart_date:  scheduler.config.map_start,\n\t\t\tend_date: scheduler.date.add( scheduler.config.map_start, scheduler.config.time_step, \"minute\"),\n\t\t});\n\t}\t\n};\n\nfunction attachSchedulerEvents() { \n  eventHandlerIds.push(\n\tscheduler.attachEvent(\"onEventSave\",function(id,ev,is_new){\n\t\tlet unmodifiedEvent = scheduler.getEvent(id);\n\t\tif (unmodifiedEvent && unmodifiedEvent.event_location != ev.event_location) {\n\t\t\tscheduler._eventLocationChanged = true;\n\t\t}\n\t\treturn true;\n\t}),\n    scheduler.attachEvent(\"onEventChanged\", (id, event) => {\n\t\tconst {start_date, end_date} = event;\n\t\tconst {min_date, max_date} = scheduler.getState();\n\t\tif(start_date.valueOf() < max_date.valueOf() && end_date.valueOf() > min_date.valueOf()){\n\t\t\tif (mapAdapter) {\n\t\t\t\tif (scheduler.config.map_settings.resolve_event_location && event.event_location && !scheduler._latLngUpdate ) {\n\t\t\t\t \taddEventWithLocation(event, mapAdapter);\n\t\t\t\t} else {\n\t\t\t\t\tmapAdapter.updateEventMarker(event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tscheduler._latLngUpdate  = false;\n\t\treturn true;\n    }),\n\tscheduler.attachEvent(\"onEventIdChange\", function(old_id,new_id){\n\t\tlet newIdEvent = scheduler.getEvent(new_id);\n\t\tmapAdapter?.removeEventMarker(old_id);\n\t\tmapAdapter?.addEventMarker(newIdEvent);\n\t}),\n    scheduler.attachEvent(\"onEventAdded\", (id, event) => {\n\t\tconst {start_date, end_date} = event;\n\t\tconst {min_date, max_date} = scheduler.getState();\n\t\tif(start_date.valueOf() < max_date.valueOf() && end_date.valueOf() > min_date.valueOf()){\n      \t\tif (mapAdapter) {\n\t\t\t\tif (scheduler.config.map_settings.resolve_event_location && event.event_location && scheduler._eventLocationChanged) {\n\t\t\t\t\taddEventWithLocation(event, mapAdapter);\n\t\t\t\t\tscheduler._eventLocationChanged = false;\n\t\t\t\t} else {\n\t\t\t\t\tmapAdapter.addEventMarker(event);\n\t\t\t\t\tmapAdapter.onEventClick(event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    }),\n    scheduler.attachEvent(\"onClick\", function (id, e){\n\t\tconst event = scheduler.getEvent(id);\n\t\tif (mapAdapter && event) mapAdapter.onEventClick(event);\n\t\treturn false;\n    }),\n    scheduler.attachEvent(\"onBeforeEventDelete\", (id, event) => {\n\t\tif (mapAdapter) {\n\t\t\tmapAdapter.removeEventMarker(id);\n\t\t}\n\t\treturn true;\n    })\n  );\n}\nfunction detachSchedulerEvents() {\n\teventHandlerIds.forEach(id => scheduler.detachEvent(id));\n\teventHandlerIds = [];\n}\n\nscheduler.attachEvent(\"onSchedulerReady\", function() {\n\n\tif(scheduler.config.map_initial_zoom !== undefined){\n\t\tscheduler.config.map_settings.initial_zoom = scheduler.config.map_initial_zoom;\n\t}\n\tif(scheduler.config.map_zoom_after_resolve  !== undefined){\n\t\tscheduler.config.map_settings.zoom_after_resolve = scheduler.config.map_zoom_after_resolve;\n\t}\n\tif(scheduler.config.map_infowindow_max_width !== undefined){\n\t\tscheduler.config.map_settings.info_window_max_width = scheduler.config.map_infowindow_max_width;\n\t}\n\tif(scheduler.config.map_resolve_user_location !== undefined){\n\t\tscheduler.config.map_settings.resolve_user_location = scheduler.config.map_resolve_user_location;\n\t}\n\tif(scheduler.config.map_view_provider !== undefined){\n\t\tscheduler.config.map_settings.view_provider = scheduler.config.map_view_provider;\n\t}\n\tif(scheduler.config.map_type !== undefined){\n\t\tscheduler.config.map_settings.type = scheduler.config.map_type;\n\t}\n\tif(scheduler.config.map_resolve_event_location !== undefined){\n\t\tscheduler.config.map_settings.resolve_event_location = scheduler.config.map_resolve_event_location;\n\t}\n\tscheduler.ext.mapView.currentAdapter = scheduler.config.map_view_provider;\n\n\tlet map = document.createElement('div');\n\tmap.className = 'mapContainer';\n\tmap.id = 'mapContainer';\n\tmap.style.display = \"none\";\n\tmap.style.zIndex = \"1\";\n\tscheduler._obj.appendChild(map);\n\n\tconst old = scheduler.render_data;\n\tscheduler.render_data = function(evs, hold) {\n\t\tif (this._mode == \"map\") {\n\t\t\tfill_map_tab();\n\t\t\tlet events = scheduler.get_visible_events();\n\t\t\tif (mapAdapter) {\n\t\t\t\tmapAdapter.clearEventMarkers();\n\t\t\t\tevents.forEach((event) => mapAdapter?.addEventMarker(event));\n\t\t\t}\n\t\t} else\n\t\t\treturn old.apply(this, arguments);\n\t};\n\n\tscheduler.map_view = function(mode) {\n\t\tscheduler._els.dhx_cal_data[0].style.width = (scheduler.xy.map_date_width + scheduler.xy.map_description_width + 1) + 'px';\n\t\tscheduler._min_date = scheduler.config.map_start || (scheduler._currentDate());\n\t\tscheduler._max_date = scheduler.config.map_end || scheduler.date.add(scheduler._currentDate(), 1, \"year\");\n\t\tscheduler._table_view = true;\n\t\tset_full_view(mode);\n\t\tlet mapContainer = document.getElementById('mapContainer');\n\t\t_setMapSize('mapContainer');\n\n\t\t// creating the new logic\n\t\tif (mode && mapContainer) {\n\t\t\tmap.style.display = 'block';\n\t\t\tfill_map_tab();\n\t\t\t// case to display several maps and has the opportunity to switch between them\n\t\t\tif (scheduler.config.map_view_provider == scheduler.ext.mapView.currentAdapter) {\n\t\t\t\tmapAdapter?.destroy(mapContainer);\n\t\t\t\tsetupMapView(scheduler);\n\t\t\t\tmapAdapter?.initialize(mapContainer, scheduler.config.map_settings);\n\t\t\t} else {\n\t\t\t\tmapAdapter?.destroy(mapContainer);\n\t\t\t\tsetupMapView(scheduler);\n\t\t\t\tmapAdapter?.initialize(mapContainer, scheduler.config.map_settings);\n\t\t\t \tscheduler.ext.mapView.currentAdapter = scheduler.config.map_view_provider;\n\t\t\t}\n\t\t\tif(mapAdapter) {\n\t\t\t\tsetUserLocation(scheduler.config.map_settings, mapAdapter);\n\t\t\t}\t\n\t\t} else {\n\t\t\tmap.style.display = 'none';\n\t\t\tscheduler._els.dhx_cal_data[0].style.width = \"100%\";\n\t\t \tif (mapAdapter && mapContainer ) {\n\t\t\t\tmapAdapter.destroy(mapContainer);\n\t\t\t\tmapAdapter = null;\n\t\t\t\tscheduler.ext.mapView.currentAdapter = scheduler.config.map_view_provider;\n\t\t    }\n\t\t  \tdetachSchedulerEvents();\n\t\t}\n\t};\n\n\tfunction _setMapSize(elem_id) { //input - map's div id\n\t\tlet map = document.getElementById(elem_id);\n\t\tif (map) {\n\t\t\tconst nav_height = scheduler.$container.querySelector(\".dhx_cal_navline\").offsetHeight;\n\t\t\tlet height = scheduler.$container.querySelector(\".dhx_cal_data\").offsetHeight + scheduler.$container.querySelector(\".dhx_cal_header\").offsetHeight;\n\t\t\tif (height < 0)\n\t\t\t\theight = 0;\n\t\t\tlet width = scheduler._x - scheduler.xy.map_date_width - scheduler.xy.map_description_width - 1;\n\t\t\tif (width < 0)\n\t\t\t\twidth = 0;\n\t\t\tmap.style.height = height + 'px';\n\t\t\tmap.style.width = width + 'px';\n\t\t\tmap.style.position = \"absolute\";\n\t\t\tmap.style.top = nav_height + \"px\";\n\t\t\tif (scheduler.config.rtl) {\n\t\t\t\tmap.style.marginRight = (scheduler.xy.map_date_width + scheduler.xy.map_description_width + 1) + 'px';\n\t\t\t} else {\n\t\t\t\tmap.style.marginLeft = (scheduler.xy.map_date_width + scheduler.xy.map_description_width + 1) + 'px';\n\t\t\t}\n\t\t\tmap.style.marginTop = (scheduler.xy.nav_height + 2) + 'px';\n\t\t}\n\t}\t\n\tfunction fill_map_tab() {\n\t\t//select events for which data need to be printed\n\t\tlet events = scheduler.get_visible_events();\n\t\tevents.sort(function(a, b) {\n\t\t\tif(a.start_date.valueOf()==b.start_date.valueOf())\n\t\t\t\treturn a.id>b.id?1:-1;\n\t\t\treturn a.start_date>b.start_date?1:-1;\n\t\t});\n\n\t\t//generate html for the view\n\t\tlet ariaAttr = scheduler._waiAria.mapAttrString();\n\n\t\tlet html = \"<div \"+ariaAttr+\" class='dhx_map_area'>\";\n\t\tfor (let i = 0; i < events.length; i++) {\n\t\t\tlet ev = events[i];\n\t\t\tlet event_class = (ev.id == scheduler._selected_event_id) ? 'dhx_map_line highlight' : 'dhx_map_line';\n\t\t\tlet bg_color = (ev.color ? (\"--dhx-scheduler-event-background:\" + ev.color + \";\") : \"\");\n\t\t\tlet color = (ev.textColor ? (\"--dhx-scheduler-event-color:\" + ev.textColor + \";\") : \"\");\n\n\t\t\tlet ariaAttr = scheduler._waiAria.mapRowAttrString(ev);\n\t\t\tlet ariaButtonAttr = scheduler._waiAria.mapDetailsBtnString();\n\n\t\t\thtml += \"<div \"+ariaAttr+\" class='\" + event_class + \"' event_id='\" + ev.id + \"' \"+scheduler.config.event_attribute+\"='\"+ev.id+\"' style='\" + bg_color + \"\" + color + \"\" + (ev._text_style || \"\") + \" width: \" + (scheduler.xy.map_date_width + scheduler.xy.map_description_width + 2) + \"px;'><div class='dhx_map_event_time' style='width: \" + scheduler.xy.map_date_width + \"px;' >\" + scheduler.templates.map_time(ev.start_date, ev.end_date, ev) + \"</div>\";\n\t\t\thtml += `<div ${ariaButtonAttr} class='dhx_event_icon icon_details'><svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t<path d=\"M15.4444 16.4H4.55556V7.6H15.4444V16.4ZM13.1111 2V3.6H6.88889V2H5.33333V3.6H4.55556C3.69222 3.6 3 4.312 3 5.2V16.4C3 16.8243 3.16389 17.2313 3.45561 17.5314C3.74733 17.8314 4.143 18 4.55556 18H15.4444C15.857 18 16.2527 17.8314 16.5444 17.5314C16.8361 17.2313 17 16.8243 17 16.4V5.2C17 4.312 16.3 3.6 15.4444 3.6H14.6667V2H13.1111ZM13.8889 10.8H10V14.8H13.8889V10.8Z\" fill=\"#A1A4A6\"/>\n\t\t\t</svg></div>`;\n\t\t\thtml += \"<div class='line_description' style='width:\" + (scheduler.xy.map_description_width - scheduler.xy.map_icon_width) + \"px;'>\" + scheduler.templates.map_text(ev.start_date, ev.end_date, ev) + \"</div></div>\"; // -25 = icon size 20 and padding 5\n\t\t}\n\t\thtml += \"<div class='dhx_v_border' style=\"+(scheduler.config.rtl ? \"'right: \" : \"'left: \") + (scheduler.xy.map_date_width - 1) + \"px;'></div><div class='dhx_v_border_description'></div></div>\";\n\n\t\t//render html\n\t\tscheduler._els[\"dhx_cal_data\"][0].scrollTop = 0; //fix flickering in FF\n\t\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = html;\n\t//\tscheduler._els[\"dhx_cal_data\"][0].style.width = (scheduler.xy.map_date_width + scheduler.xy.map_description_width + 1) + 'px';\n\n\t\tlet t = scheduler._els[\"dhx_cal_data\"][0].firstChild.childNodes;\n\n\t\tlet dateElement = scheduler._getNavDateElement();\n\t\tif(dateElement){\n\t\t\tdateElement.innerHTML=scheduler.templates[scheduler._mode + \"_date\"](scheduler._min_date, scheduler._max_date, scheduler._mode);\n\t\t}\n\n\t\tscheduler._rendered = [];\n\t\tfor (let i = 0; i < t.length - 2; i++) {\n\t\t\tscheduler._rendered[i] = t[i];\n\t\t}\n\t}\n\tfunction set_full_view(mode) {\n\t\tif (mode) {\n\t\t\tconst l = scheduler.locale.labels;\n\t\t\tscheduler._els[\"dhx_cal_header\"][0].innerHTML = \"<div class='dhx_map_head' style='width: \" + \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(scheduler.xy.map_date_width + scheduler.xy.map_description_width + 2) + \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"px;' ><div class='headline_date' style='width: \" + \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tscheduler.xy.map_date_width + \"px;'>\" + l.date + \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"</div><div class='headline_description' style='width: \" + \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tscheduler.xy.map_description_width + \"px;'>\" + l.description + \"</div></div>\";\n\t\t\tscheduler._table_view = true;\n\t\t\tscheduler.set_sizes();\n\t\t}\n\t}\n\t\n\tscheduler.attachEvent(\"onLocationError\", function (id){\n\t\talert(\"Location can't be found\");\n\t\treturn google.maps.LatLng(51.477840, -0.001492); \n\t\t//the coordinates of the Greenwich Royal Observatory\n\t})\n\tlet _updateEventLocation = async function(event) {\n\t\tif (mapAdapter){\n\t\t\tconst coordinates = await mapAdapter.resolveAddress(event.event_location);\n\t\t\tif (coordinates.lat && coordinates.lng) {\n\t\t\t\tevent.lat = +coordinates.lat;\n\t\t\t\tevent.lng = +coordinates.lng;\n\t\t\t} else {\n\t\t\t\tscheduler.callEvent(\"onLocationError\", [event.id]);\n\t\t\t\tevent.lng = scheduler.config.map_settings.error_position.lng;\n\t\t\t\tevent.lat = scheduler.config.map_settings.error_position.lat;\n\t\t\t}\n\t\t\tscheduler._latLngUpdate = true;\n\t\t\tscheduler.callEvent(\"onEventChanged\", [event.id, event]);\n\t\t}\n\t};\n\tlet _delay = function(method, object, params, delay) {\n\t\tsetTimeout(function() {\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet ret = method.apply(object, params);\n\t\t\tmethod = object = params = null;\n\t\t\treturn ret;\n\t\t}, delay || 1);\n\t};\n\tscheduler._event_resolve_delay = 1500;\n\tscheduler.attachEvent(\"onEventLoading\", function(event) {\n\t\tif (event.lat && event.lng) {\n\t\t\tevent.lat = +event.lat;\n\t\t\tevent.lng = +event.lng;\n\t\t}\n\t\tif (scheduler.config.map_settings.resolve_event_location && event.event_location && !event.lat && !event.lng) { // don't delete !event.lat && !event.lng as location could change\n\t\t\tscheduler._event_resolve_delay += 1500;\n\t\t\t_delay(_updateEventLocation, this, [event], scheduler._event_resolve_delay);\n\t\t}\n\t\treturn true;\n\t});\n})\n\n}","export default function(scheduler){\n\nconst minicalDomEvents = scheduler._createDomEventScope();\n\t\n\nscheduler.config.minicalendar = {\n\tmark_events: true\n};\nscheduler._synced_minicalendars = [];\nscheduler.renderCalendar = function(obj, _prev, is_refresh) {\n\tvar cal = null;\n\tvar date = obj.date || (scheduler._currentDate());\n\tif (typeof date == \"string\")\n\t\tdate = this.templates.api_date(date);\n\n\tif (!_prev) {\n\t\tvar cont = obj.container;\n\t\tvar pos = obj.position;\n\n\t\tif (typeof cont == \"string\")\n\t\t\tcont = document.getElementById(cont);\n\n\t\tif (typeof pos == \"string\")\n\t\t\tpos = document.getElementById(pos);\n\t\tif (pos && (typeof pos.left == \"undefined\" && typeof pos.right == \"undefined\")) {\n\t\t\tvar tpos = scheduler.$domHelpers.getOffset(pos);\n\t\t\tpos = {\n\t\t\t\ttop: tpos.top + pos.offsetHeight,\n\t\t\t\tleft: tpos.left\n\t\t\t};\n\t\t}\n\t\tif (!cont)\n\t\t\tcont = scheduler._get_def_cont(pos);\n\n\t\tcal = this._render_calendar(cont, date, obj);\n\t\n\t\tif (!cal.$_eventAttached) {\n\t\t\tcal.$_eventAttached = true;\n\t\t\tminicalDomEvents.attach(cal, \"click\", (function(e) {\n\t\t\t\tvar src = e.target || e.srcElement;\n\n\t\t\t\tvar $dom = scheduler.$domHelpers;\n\t\t\t\tif ($dom.closest(src, \".dhx_month_head\")) {\n\t\t\t\t\tif (!$dom.closest(src, \".dhx_after\") && !$dom.closest(src, \".dhx_before\")) {\n\n\t\t\t\t\t\tvar cellRoot = $dom.closest(src, \"[data-cell-date]\");\n\t\t\t\t\t\tvar dateAttribute = cellRoot.getAttribute(\"data-cell-date\");\n\t\t\t\t\t\tvar newDate = scheduler.templates.parse_date(dateAttribute);\n\t\t\t\t\t\n\t\t\t\t\t\tscheduler.unmarkCalendar(this);\n\t\t\t\t\t\tscheduler.markCalendar(this, newDate, \"dhx_calendar_click\");\n\t\t\t\t\t\tthis._last_date = newDate;\n\n\t\t\t\t\t\tif(this.conf.events && this.conf.events.onDateClick){\n\t\t\t\t\t\t\tthis.conf.events.onDateClick.call(this, newDate, e);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.conf.handler) this.conf.handler.call(scheduler, newDate, this);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).bind(cal));\n\n\t\t\tminicalDomEvents.attach(cal, \"mouseover\", (function(e) {\n\t\t\t\tconst target = e.target;\n\n\t\t\t\tif (target.classList.contains('dhx_cal_month_cell')) {\n\t\t\t\t\tvar dateAttribute = target.getAttribute(\"data-cell-date\");\n\t\t\t\t\tvar newDate = scheduler.templates.parse_date(dateAttribute);\n\t\t\t\n\t\t\t\t\tif(this.conf.events && this.conf.events.onDateMouseOver){\n\t\t\t\t\t\tthis.conf.events.onDateMouseOver.call(this, newDate, e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).bind(cal));\n\t\t}\n\t\n\t} else {\n\t\tcal = this._render_calendar(_prev.parentNode, date, obj, _prev);\n\t\tscheduler.unmarkCalendar(cal);\n\t}\n\n\tif (scheduler.config.minicalendar.mark_events) {\n\t\tvar start = scheduler.date.month_start(date);\n\t\tvar end = scheduler.date.add(start, 1, \"month\");\n\t\tvar evs = this.getEvents(start, end);\n\t\tvar filter = this[\"filter_\" + this._mode];\n\t\tvar markedDates = {};\n\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\tvar ev = evs[i];\n\t\t\tif (filter && !filter(ev.id, ev))\n\t\t\t\tcontinue;\n\t\t\tvar d = ev.start_date;\n\t\t\tif (d.valueOf() < start.valueOf())\n\t\t\t\td = start;\n\t\t\td = scheduler.date.date_part(new Date(d.valueOf()));\n\t\t\twhile (d < ev.end_date) {\n\t\t\t\tif(!markedDates[+d]) {\n\t\t\t\t\tmarkedDates[+d] = true;\n\t\t\t\t\tthis.markCalendar(cal, d, \"dhx_year_event\");\n\t\t\t\t}\n\t\t\t\td = this.date.add(d, 1, \"day\");\n\t\t\t\tif (d.valueOf() >= end.valueOf())\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tthis._markCalendarCurrentDate(cal);\n\n\tcal.conf = obj;\n\tif (obj.sync && !is_refresh)\n\t\tthis._synced_minicalendars.push(cal);\n\n\tif(!cal.conf._on_xle_handler){\n\t\tcal.conf._on_xle_handler = scheduler.attachEvent(\"onXLE\", function refreshOnLoad(){\n\t\t\tscheduler.updateCalendar(cal, cal.conf.date);\n\t\t});\n\t}\n\n\tif(this.config.wai_aria_attributes && this.config.wai_aria_application_role){\n\t\tcal.setAttribute(\"role\", \"application\");\n\t}\n\n\treturn cal;\n};\nscheduler._get_def_cont = function(pos) {\n\tif (!this._def_count) {\n\t\tthis._def_count = document.createElement(\"div\");\n\t\tthis._def_count.className = \"dhx_minical_popup\";\n\t\tscheduler.event(this._def_count, \"click\", function(e) { e.cancelBubble = true; });\n\t\tdocument.body.appendChild(this._def_count);\n\t}\n\n\tif(pos.left){\n\t\tthis._def_count.style.left = pos.left + \"px\";\n\t}\n\tif(pos.right){\n\t\tthis._def_count.style.right = pos.right + \"px\";\n\t}\n\tif(pos.top){\n\t\tthis._def_count.style.top = pos.top + \"px\";\n\t}\n\tif(pos.bottom){\n\t\tthis._def_count.style.bottom = pos.bottom + \"px\";\n\t}\n\n\tthis._def_count._created = new Date();\n\n\treturn this._def_count;\n};\nscheduler._locateCalendar = function(cal, date) {\n\tif (typeof date == \"string\")\n\t\tdate = scheduler.templates.api_date(date);\n\n\tif(+date > +cal._max_date || +date < +cal._min_date)\n\t\treturn null;\n\n\tvar table = cal.querySelector(\".dhx_year_body\").childNodes[0];\n\n\tvar weekNum = 0;\n\tvar dat = new Date(cal._min_date);\n\twhile(+this.date.add(dat, 1, \"week\") <= +date){\n\t\tdat = this.date.add(dat, 1, \"week\");\n\t\tweekNum++;\n\t}\n\n\tvar sm = scheduler.config.start_on_monday;\n\tvar day = (date.getDay() || (sm ? 7 : 0)) - (sm ? 1 : 0);\n\n\tconst dayCell = table.querySelector(`.dhx_cal_month_row:nth-child(${weekNum + 1}) .dhx_cal_month_cell:nth-child(${day + 1})`);\n\tif(dayCell) {\n\t\treturn dayCell.firstChild;\n\t} else {\n\t\treturn null;\n\t}\n};\nscheduler.markCalendar = function(cal, date, css) {\n\tvar div = this._locateCalendar(cal, date);\n\tif(!div)\n\t\treturn;\n\n\tdiv.className += \" \" + css;\n};\nscheduler.unmarkCalendar = function(cal, date, css) {\n\tdate = date || cal._last_date;\n\tcss = css || \"dhx_calendar_click\";\n\tif (!date) return;\n\tvar el = this._locateCalendar(cal, date);\n\tif(!el)\n\t\treturn;\n\tel.className = (el.className || \"\").replace(RegExp(css, \"g\"));\n};\nscheduler._week_template = function(width) {\n\tvar summ = (width || 250);\n\tvar left = 0;\n\n\tvar week_template = document.createElement(\"div\");\n\tvar dummy_date = this.date.week_start(scheduler._currentDate());\n\tfor (var i = 0; i < 7; i++) {\n\t\tthis._cols[i] = Math.floor(summ / (7 - i));\n\t\tthis._render_x_header(i, left, dummy_date, week_template);\n\t\tdummy_date = this.date.add(dummy_date, 1, \"day\");\n\t\tsumm -= this._cols[i];\n\t\tleft += this._cols[i];\n\t}\n\tweek_template.lastChild.className += \" dhx_scale_bar_last\";\n\treturn week_template;\n};\nscheduler.updateCalendar = function(obj, sd) {\n\tif(obj.conf.date && obj.conf.events){\n\t\tif(obj.conf.events.onBeforeMonthChange){\n\t\t\tconst res = obj.conf.events.onBeforeMonthChange.call(obj, obj.conf.date, sd, obj);\n\t\t\tif(res === false){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\tconst oldDate = obj.conf.date;\n\n\tobj.conf.date = sd;\n\tthis.renderCalendar(obj.conf, obj, true);\n\tif(obj.conf.events){\n\t\tif(obj.conf.events.onMonthChange){\n\t\t\tobj.conf.events.onMonthChange.call(obj, oldDate, sd);\n\t\t}\n\t}\n};\nscheduler._mini_cal_arrows = [\"&nbsp;\", \"&nbsp;\"];\nscheduler._render_calendar = function(obj, sd, conf, previous) {\n\t/*store*/\n\tvar ts = scheduler.templates;\n\tvar temp = this._cols;\n\tthis._cols = [];\n\tvar temp2 = this._mode;\n\tthis._mode = \"calendar\";\n\tvar temp3 = this._colsS;\n\tthis._colsS = {height: 0};\n\tvar temp4 = new Date(this._min_date);\n\tvar temp5 = new Date(this._max_date);\n\tvar temp6 = new Date(scheduler._date);\n\tvar temp7 = ts.month_day;\n\tvar temp8 = this._ignores_detected; this._ignores_detected = 0;\n\tts.month_day = ts.calendar_date;\n\n\tsd = this.date.month_start(sd);\n\tvar week_template = this._week_template(obj.offsetWidth - 1 - this.config.minicalendar.padding );\n\n\tvar d;\n\tif (previous){\n\t\td = previous;\n\t} else {\n\t\td = document.createElement(\"div\");\n\t\td.className = \"dhx_cal_container dhx_mini_calendar\";\n\t\tif (this.config.rtl) d.className += \" dhx_cal_container_rtl\";\n\t}\n\td.setAttribute(\"date\", this._helpers.formatDate(sd));\n\td.innerHTML = \"<div class='dhx_year_month'></div>\" +\n\t\t\t\"<div class='dhx_year_grid\" +\n\t\t\t(scheduler.config.rtl ? \" dhx_grid_rtl'>\" : \"'>\") +\n\t\t\t\"<div class='dhx_year_week'>\"+(week_template ? week_template.innerHTML : \"\")+\"</div>\" +\n\t\t\t\"<div class='dhx_year_body'></div>\" +\n\t\t\"</div>\";\n\tvar header = d.querySelector(\".dhx_year_month\");\n\tvar weekHeader = d.querySelector(\".dhx_year_week\");\n\tvar body = d.querySelector(\".dhx_year_body\");\n\n\theader.innerHTML = this.templates.calendar_month(sd);\n\tif (conf.navigation) {\n\t\tvar move_minicalendar_date = function(calendar, diff) {\n\t\t\tvar date = scheduler.date.add(calendar._date, diff, \"month\");\n\t\t\tscheduler.updateCalendar(calendar, date);\n\t\t\tif (scheduler._date.getMonth() == calendar._date.getMonth() && scheduler._date.getFullYear() == calendar._date.getFullYear()) {\n\t\t\t\tscheduler._markCalendarCurrentDate(calendar);\n\t\t\t}\n\t\t};\n\n\t\tvar css_classnames = [\"dhx_cal_prev_button\", \"dhx_cal_next_button\"];\n\t\tvar css_texts = [\"left:1px;top:4px;position:absolute;\", \"left:auto; right:1px;top:4px;position:absolute;\"];\n\t\tvar diffs = [-1, 1];\n\t\tvar handler = function(diff) {\n\t\t\treturn function() {\t\n\t\t\t\tif (conf.sync) {\n\t\t\t\t\tvar calendars = scheduler._synced_minicalendars;\n\t\t\t\t\tfor (var k = 0; k < calendars.length; k++) {\n\t\t\t\t\t\tmove_minicalendar_date(calendars[k], diff);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (scheduler.config.rtl) {\n\t\t\t\t\t\tdiff = -diff;\n\t\t\t\t\t}\n\t\t\t\t\tmove_minicalendar_date(d, diff);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tvar labels = [scheduler.locale.labels.prev, scheduler.locale.labels.next];\n\t\tfor (var j = 0; j < 2; j++) {\n\t\t\tvar arrow = document.createElement(\"div\");\n\t\t\t//var diff = diffs[j];\n\t\t\tarrow.className = css_classnames[j];\n\n\t\t\tscheduler._waiAria.headerButtonsAttributes(arrow, labels[j]);\n\n\t\t\tarrow.style.cssText = css_texts[j];\n\t\t\tarrow.innerHTML = this._mini_cal_arrows[j];\n\t\t\theader.appendChild(arrow);\n\t\t\tminicalDomEvents.attach(arrow, \"click\", handler(diffs[j]));\n\t\t}\n\t}\n\td._date = new Date(sd);\n\n\td.week_start = (sd.getDay() - (this.config.start_on_monday ? 1 : 0) + 7) % 7;\n\n\tvar dd = d._min_date = this.date.week_start(sd);\n\td._max_date = this.date.add(d._min_date, 6, \"week\");\n\n\tthis._reset_month_scale(body, sd, dd, 6);\n\n\tif (!previous)\n\t\tobj.appendChild(d);\n\n\tweekHeader.style.height = (weekHeader.childNodes[0].offsetHeight - 1) + \"px\"; // dhx_year_week should have height property so that day dates would get correct position. dhx_year_week height = height of it's child (with the day name)\n\n\tvar headerId = scheduler.uid();\n\tscheduler._waiAria.minicalHeader(header, headerId);\n\tscheduler._waiAria.minicalGrid(d.querySelector(\".dhx_year_grid\"), headerId);\n\tscheduler._waiAria.minicalRow(weekHeader);\n\n\tvar dayHeaders = weekHeader.querySelectorAll(\".dhx_scale_bar\");\n\tfor(var i = 0; i < dayHeaders.length; i++){\n\t\tscheduler._waiAria.minicalHeadCell(dayHeaders[i]);\n\t}\n\tvar dayCells = body.querySelectorAll(\".dhx_cal_month_cell\");\n\tvar firstDate = new Date(dd);\n\tfor(var i = 0; i < dayCells.length; i++){\n\n\t\tscheduler._waiAria.minicalDayCell(dayCells[i], new Date(firstDate));\n\t\tfirstDate = scheduler.date.add(firstDate, 1, \"day\");\n\t}\n\n\tscheduler._waiAria.minicalHeader(header, headerId);\n\n\t/*restore*/\n\tthis._cols = temp;\n\tthis._mode = temp2;\n\tthis._colsS = temp3;\n\tthis._min_date = temp4;\n\tthis._max_date = temp5;\n\tscheduler._date = temp6;\n\tts.month_day = temp7;\n\tthis._ignores_detected = temp8;\n\treturn d;\n};\nscheduler.destroyCalendar = function(cal, force) {\n\tif (!cal && this._def_count && this._def_count.firstChild) {\n\t\tif (force || (new Date()).valueOf() - this._def_count._created.valueOf() > 500)\n\t\t\tcal = this._def_count.firstChild;\n\t}\n\tif (!cal) return;\n\tminicalDomEvents.detachAll();\n\t//cal.onclick = null;\n\tcal.innerHTML = \"\";\n\tif (cal.parentNode)\n\t\tcal.parentNode.removeChild(cal);\n\tif (this._def_count)\n\t\tthis._def_count.style.top = \"-1000px\";\n\n\tif(cal.conf && cal.conf._on_xle_handler)\n\t\tscheduler.detachEvent(cal.conf._on_xle_handler);\n};\nscheduler.isCalendarVisible = function() {\n\tif (this._def_count && parseInt(this._def_count.style.top, 10) > 0)\n\t\treturn this._def_count;\n\treturn false;\n};\n\nscheduler.attachEvent(\"onTemplatesReady\", function() {\n\tscheduler.event(document.body, \"click\", function() { scheduler.destroyCalendar(); });\n}, {once: true});\n\n\n\nscheduler.form_blocks.calendar_time = {\n\trender: function(sns) {\n\t\tvar html = \"<span class='dhx_minical_input_wrapper'><input class='dhx_readonly dhx_minical_input' type='text' readonly='true'></span>\";\n\n\t\tvar cfg = scheduler.config;\n\t\tvar dt = this.date.date_part(scheduler._currentDate());\n\n\t\tvar last = 24 * 60, first = 0;\n\t\tif (cfg.limit_time_select) {\n\t\t\tfirst = 60 * cfg.first_hour;\n\t\t\tlast = 60 * cfg.last_hour + 1;  // to include \"17:00\" option if time select is limited\n\t\t}\n\t\tdt.setHours(first / 60);\n\n\t\tsns._time_values = [];\n\t\thtml += \" <select class='dhx_lightbox_time_select'>\";\n\t\tfor (var i = first; i < last; i += this.config.time_step * 1) { // `<` to exclude last \"00:00\" option\n\t\t\tvar time = this.templates.time_picker(dt);\n\t\t\thtml += \"<option value='\" + i + \"'>\" + time + \"</option>\";\n\t\t\tsns._time_values.push(i);\n\t\t\tdt = this.date.add(dt, this.config.time_step, \"minute\");\n\t\t}\n\t\thtml += \"</select>\";\n\n\t\t//var full_day = scheduler.config.full_day;\n\n\t\treturn \"<div class='dhx_section_time dhx_lightbox_minical'>\" + html + \"<span class='dhx_lightbox_minical_spacer'> &nbsp;&ndash;&nbsp; </span>\" + html + \"</div>\";\n\t},\n\tset_value: function(node, value, ev, config) {\n\n\t\tvar inputs = node.getElementsByTagName(\"input\");\n\t\tvar selects = node.getElementsByTagName(\"select\");\n\t\tvar start_date,\n\t\t\tend_date;\n\n\t\tvar _init_once = function(inp, date, number) {\n\t\t\tscheduler.event(inp, \"click\", function() {\n\t\t\t\tscheduler.destroyCalendar(null, true);\n\t\t\t\tscheduler.renderCalendar({\n\t\t\t\t\tposition: inp,\n\t\t\t\t\tdate: new Date(this._date),\n\t\t\t\t\tnavigation: true,\n\t\t\t\t\thandler: function(new_date) {\n\t\t\t\t\t\tinp.value = scheduler.templates.calendar_time(new_date);\n\t\t\t\t\t\tinp._date = new Date(new_date);\n\t\t\t\t\t\tscheduler.destroyCalendar();\n\t\t\t\t\t\tif (scheduler.config.event_duration && scheduler.config.auto_end_date && number === 0) { //first element = start date\n\t\t\t\t\t\t\t_update_minical_select();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tif (scheduler.config.full_day) {\n\t\t\tif (!node._full_day) {\n\t\t\t\tvar html = \"<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> \" + scheduler.locale.labels.full_day + \"&nbsp;</label></input>\";\n\t\t\t\tif (!scheduler.config.wide_form)\n\t\t\t\t\thtml = node.previousSibling.innerHTML + html;\n\t\t\t\tnode.previousSibling.innerHTML = html;\n\t\t\t\tnode._full_day = true;\n\t\t\t}\n\t\t\tvar input = node.previousSibling.getElementsByTagName(\"input\")[0];\n\n\t\t\tvar isFulldayEvent = (scheduler.date.time_part(ev.start_date) === 0 && scheduler.date.time_part(ev.end_date) === 0);\n\t\t\tinput.checked = isFulldayEvent;\n\n\t\t\tselects[0].disabled = input.checked;\n\t\t\tselects[1].disabled = input.checked;\n\n\t\t\tif (!input.$_eventAttached) {\n\t\t\t\tinput.$_eventAttached = true;\n\t\t\t\tscheduler.event(input, \"click\", function() {\n\t\t\t\t\tif (input.checked === true) {\n\t\t\t\t\t\tvar obj = {};\n\t\t\t\t\t\tscheduler.form_blocks.calendar_time.get_value(node, obj);\n\n\t\t\t\t\t\tstart_date = scheduler.date.date_part(obj.start_date);\n\t\t\t\t\t\tend_date = scheduler.date.date_part(obj.end_date);\n\n\t\t\t\t\t\tif (+end_date == +start_date || (+end_date >= +start_date && (ev.end_date.getHours() !== 0 || ev.end_date.getMinutes() !== 0)))\n\t\t\t\t\t\t\tend_date = scheduler.date.add(end_date, 1, \"day\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tstart_date = null;\n\t\t\t\t\t\tend_date = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar start = start_date || ev.start_date;\n\t\t\t\t\tvar end = end_date || ev.end_date;\n\t\t\t\t\t_attach_action(inputs[0], start);\n\t\t\t\t\t_attach_action(inputs[1], end);\n\t\t\t\t\tselects[0].value = start.getHours() * 60 + start.getMinutes();\n\t\t\t\t\tselects[1].value = end.getHours() * 60 + end.getMinutes();\n\n\t\t\t\t\tselects[0].disabled = input.checked;\n\t\t\t\t\tselects[1].disabled = input.checked;\n\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (scheduler.config.event_duration && scheduler.config.auto_end_date) {\n\n\t\t\tvar _update_minical_select = function () {\n\t\t\t\tif (!(scheduler.config.auto_end_date && scheduler.config.event_duration)){\n\t\t\t\t\t// setting may be disabled after the handler is attached\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstart_date = scheduler.date.add(inputs[0]._date, selects[0].value, \"minute\");\n\t\t\t\tend_date = new Date(start_date.getTime() + (scheduler.config.event_duration * 60 * 1000));\n\n\t\t\t\tinputs[1].value = scheduler.templates.calendar_time(end_date);\n\t\t\t\tinputs[1]._date = scheduler.date.date_part(new Date(end_date));\n\n\t\t\t\tselects[1].value = end_date.getHours() * 60 + end_date.getMinutes();\n\t\t\t};\n\n\t\t\tif(!selects[0].$_eventAttached){\n\t\t\t\tselects[0].addEventListener(\"change\", _update_minical_select); // only update on first select should trigger update so user could define other end date if he wishes too\n\t\t\t}\n\t\t}\n\n\t\tfunction _attach_action(inp, date, number) {\n\t\t\t_init_once(inp, date, number);\n\t\t\tinp.value = scheduler.templates.calendar_time(date);\n\t\t\tinp._date = scheduler.date.date_part(new Date(date));\n\t\t}\n\n\t\t_attach_action(inputs[0], ev.start_date, 0);\n\t\t_attach_action(inputs[1], ev.end_date, 1);\n\t\t_init_once = function() {};\n\n\t\tfunction _round_minutes(date) {\n\t\t\tvar time_values = config._time_values;\n\t\t\tvar direct_value = date.getHours() * 60 + date.getMinutes();\n\t\t\tvar fixed_value = direct_value;\n\t\t\tvar value_found = false;\n\n\t\t\tfor (var k = 0; k < time_values.length; k++) {\n\t\t\t\tvar t_v = time_values[k];\n\t\t\t\tif (t_v === direct_value) {\n\t\t\t\t\tvalue_found = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (t_v < direct_value)\n\t\t\t\t\tfixed_value = t_v;\n\t\t\t}\n\n\t\t\tif(!(value_found || fixed_value))\n\t\t\t\treturn -1;\n\n\t\t\treturn (value_found) ? direct_value : fixed_value;\n\t\t}\n\n\t\tselects[0].value = _round_minutes(ev.start_date);\n\t\tselects[1].value = _round_minutes(ev.end_date);\n\n\t},\n\tget_value: function(node, ev) {\n\t\tvar inputs = node.getElementsByTagName(\"input\");\n\t\tvar selects = node.getElementsByTagName(\"select\");\n\n\t\tev.start_date = scheduler.date.add(inputs[0]._date, selects[0].value, \"minute\");\n\t\tev.end_date = scheduler.date.add(inputs[1]._date, selects[1].value, \"minute\");\n\n\t\tif (ev.end_date <= ev.start_date)\n\t\t\tev.end_date = scheduler.date.add(ev.start_date, scheduler.config.time_step, \"minute\");\n\t\treturn {\n\t\t\tstart_date: new Date(ev.start_date),\n\t\t\tend_date: new Date(ev.end_date)\n\t\t};\n\t},\n\tfocus: function(node) {\n\t}\n};\nscheduler.linkCalendar = function(calendar, datediff) {\n\tvar action = function() {\n\t\tvar date = scheduler._date;\n\t\tvar dateNew = new Date(date.valueOf());\n\t\tif (datediff) dateNew = datediff(dateNew);\n\t\tdateNew.setDate(1);\n\t\tscheduler.updateCalendar(calendar, dateNew);\n\t\treturn true;\n\t};\n\n\tscheduler.attachEvent(\"onViewChange\", action);\n\tscheduler.attachEvent(\"onXLE\", action);\n\tscheduler.attachEvent(\"onEventAdded\", action);\n\tscheduler.attachEvent(\"onEventChanged\", action);\n\tscheduler.attachEvent(\"onEventDeleted\", action);\n\taction();\n};\n\nscheduler._markCalendarCurrentDate = function(calendar) {\n\tvar state = scheduler.getState();\n\tvar from = state.min_date;\n\tvar to = state.max_date;\n\tvar mode = state.mode;\n\n\tvar month_start = scheduler.date.month_start(new Date(calendar._date));\n\tvar month_end = scheduler.date.add(month_start, 1, \"month\");\n\n\tvar noHighlight = {\n\t\t\"month\":true,\n\t\t\"year\":true,\n\t\t\"agenda\":true,\n\t\t\"grid\":true\n\t};\n\t// no need to highlight current dates for a large range views - agenda, year, etc.\n\tif(noHighlight[mode] || (from.valueOf() <= month_start.valueOf() && to.valueOf() >= month_end.valueOf())){\n\t\treturn;\n\t}\n\n\tvar current = from;\n\twhile(current.valueOf() < to.valueOf()){\n\t\tif (month_start.valueOf() <= current.valueOf() && month_end > current) {\n\t\t\tscheduler.markCalendar(calendar, current, \"dhx_calendar_click\");\n\t\t}\n\t\tcurrent = scheduler.date.add(current, 1, \"day\");\n\t}\n};\n\nscheduler.attachEvent(\"onEventCancel\", function(){\n\tscheduler.destroyCalendar(null, true);\n});\n\nscheduler.attachEvent(\"onDestroy\", function(){\n\tscheduler.destroyCalendar();\n});\n\n}","export default function(scheduler){\n\nscheduler.attachEvent(\"onTemplatesReady\",function(){\n\tscheduler.xy.scroll_width = 0;\n\n\tvar old = scheduler.render_view_data;\n\tscheduler.render_view_data=function(){\n\t\tvar data = this._els[\"dhx_cal_data\"][0];\n\t\tdata.firstChild._h_fix = true;\n\n\t\told.apply(scheduler,arguments);\n\n\n\n\t\tvar height = parseInt(data.style.height);\n\t\tdata.style.height=\"1px\";\n\t\tdata.style.height=data.scrollHeight+\"px\";\n\n\t\tthis._obj.style.height = this._obj.clientHeight + data.scrollHeight - height + \"px\";\n\t};\n\n\tvar old_s=scheduler._reset_month_scale;\n\tscheduler._reset_month_scale=function(a,b,c,d){\n\t\tvar dummy = {clientHeight:100};\n\t\told_s.apply(scheduler,[dummy,b,c,d]);\n\t\ta.innerHTML = dummy.innerHTML;\n\t};\n\n});\n\n}","import virtual_events_helpers from \"../core/virtual_events_helpers\";\n\nexport default function(scheduler){\n\nscheduler.config.multisection = true;\nscheduler.config.multisection_shift_all = true;\nscheduler.config.section_delimiter = \",\";\nscheduler.attachEvent(\"onSchedulerReady\", function(){\n\tvirtual_events_helpers(scheduler);\n\t// #include core/virtual_events_helpers.js\n\n\tvar old_unit = scheduler._update_unit_section;\n\tscheduler._update_unit_section = function(action){\n\t\treturn scheduler._update_sections(action, old_unit);\n\t};\n\tvar old_timeline = scheduler._update_timeline_section;\n\tscheduler._update_timeline_section =function(action){\n\t\treturn scheduler._update_sections(action, old_timeline);\n\t};\n\n\n\tscheduler.isMultisectionEvent = function(ev){\n\t\tif(ev && this._get_multisection_view()){\n\t\t\tvar units = this._get_event_sections(ev);\n\t\t\treturn (units.length > 1);\n\t\t}\n\t\treturn false;\n\t};\n\n\tscheduler._get_event_sections = function(event){\n\t\tvar mapping = this._get_section_property();\n\t\tvar units = event[mapping] || \"\";\n\t\treturn this._parse_event_sections(units);\n\t};\n\tscheduler._parse_event_sections = function(value){\n\t\tif(value instanceof Array){\n\t\t\treturn value;\n\t\t}else{\n\t\t\treturn value.toString().split(scheduler.config.section_delimiter);\n\t\t}\n\t};\n\n\tscheduler._clear_copied_events();\n\n\tscheduler._split_events = function(evs) {\n\t\tvar stack = [];\n\t\tvar pr = this._get_multisection_view();\n\n\t\tif(pr) {\n\t\t\tfor (var i=0; i<evs.length; i++) {\n\t\t\t\tscheduler._split_one_event(evs[i], pr, stack);\n\t\t\t}\n\t\t}else{\n\t\t\tstack = evs;\n\t\t}\n\t\treturn stack;\n\t};\n\n\tscheduler._split_one_event = function(event, view, stack) {\n\t\tconst units = this._get_event_sections(event);\n\t\tconst mapping = this._get_section_property();\n\n\t\tif(units.length > 1) {\n\t\t\tfor (var j=0; j<units.length; j++) {\n\t\t\t\tif(typeof view.order[units[j]] === \"undefined\")\n\t\t\t\t\tcontinue;\n\n\t\t\t\tconst ev = scheduler._copy_event(event);\n\t\t\t\tev[mapping] = units[j];\n\t\t\t\tstack.push(ev);\n\t\t\t}\n\t\t} else {\n\t\t\tstack.push(event);\n\t\t}\n\t};\n\n\n\tscheduler._get_multisection_view = function(){\n\t\tif(!this.config.multisection){\n\t\t\treturn false;\n\t\t}else{\n\t\t\treturn scheduler._get_section_view();\n\t\t}\n\t};\n\n\tvar vis_evs = scheduler.get_visible_events;\n\tscheduler.get_visible_events = function(only_timed) {\n\t\tthis._clear_copied_events();\n\t\tvar evs = vis_evs.apply(this,arguments);\n\n\t\tif (this._get_multisection_view()){\n\t\t\tevs = this._split_events(evs);\n\n\t\t\tfor(var i=0; i <evs.length; i++){\n\t\t\t\tif(!this.is_visible_events(evs[i])){\n\t\t\t\t\tevs.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._register_copies_array(evs);\n\t\t}\n\n\t\treturn evs;\n\t};\n\n\tscheduler._rendered_events = {};\n\tvar old_view_data = scheduler.render_view_data;\n\tscheduler.render_view_data = function(evs, hold) {\n\t\tif (this._get_multisection_view() && evs) {\n\t\t\t//render single event during dnd, restore flags that were calculated during full render\n\t\t\tevs = this._split_events(evs);\n\t\t\tthis._restore_render_flags(evs);\n\t\t}\n\n\t\treturn old_view_data.apply(this,[evs, hold]);\n\t};\n\n\tscheduler._update_sections = function(action, def_handler){\n\t\tvar view = action.view,\n\t\t\tevent = action.event,\n\t\t\tpos = action.pos;\n\t\t//\tdrag_single = true;\n\t\t//view - timeline or units view object. both stores displayed sections in 'view.order' hash\n\t\t// pos - mouse position, calculated in _mouse_coords method\n\t\t// event - scheduler event\n\n\t\tif(!scheduler.isMultisectionEvent(event)){\n\t\t\tdef_handler.apply(scheduler, [action]);\n\t\t}else{\n\t\t\tif(!scheduler._drag_event._orig_section){\n\t\t\t\tscheduler._drag_event._orig_section = pos.section;\n\t\t\t}\n\n\t\t\tif(scheduler._drag_event._orig_section != pos.section){\n\t\t\t\tvar shift = (view.order[pos.section] - view.order[scheduler._drag_event._orig_section]);\n\t\t\t\tif(shift){\n\t\t\t\t\tvar sections = this._get_event_sections(event);\n\t\t\t\t\tvar new_sections = [];\n\t\t\t\t\tvar shifted = true;\n\t\t\t\t\tif(scheduler.config.multisection_shift_all){\n\t\t\t\t\t\tfor(var i=0; i<sections.length; i++){\n\t\t\t\t\t\t\tvar new_section = scheduler._shift_sections(view, sections[i], shift);\n\t\t\t\t\t\t\tif(new_section !== null){\n\t\t\t\t\t\t\t\tnew_sections[i] = new_section;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tnew_sections = sections;\n\t\t\t\t\t\t\t\tshifted = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfor(var i=0; i<sections.length; i++){\n\t\t\t\t\t\t\t// if section is occupied return\n\t\t\t\t\t\t\tif(sections[i] == pos.section){\n\t\t\t\t\t\t\t\tnew_sections = sections;\n\t\t\t\t\t\t\t\tshifted = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// find and shift only one section\n\t\t\t\t\t\t\tif(sections[i] == scheduler._drag_event._orig_section){\n\t\t\t\t\t\t\t\tvar new_section = scheduler._shift_sections(view, sections[i], shift);\n\t\t\t\t\t\t\t\tif(new_section !== null){\n\t\t\t\t\t\t\t\t\tnew_sections[i] = new_section;\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tnew_sections = sections;\n\t\t\t\t\t\t\t\t\tshifted = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tnew_sections[i] = sections[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(shifted)\n\t\t\t\t\t\tscheduler._drag_event._orig_section = pos.section;\n\t\t\t\t\t\n\t\t\t\t\tevent[scheduler._get_section_property()] = new_sections.join(scheduler.config.section_delimiter);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t};\n\n\tscheduler._shift_sections = function(matrix, orig_section, shift){\n\t\tvar orig_order = null;\n\t\tvar units=  matrix.y_unit || matrix.options;\n\t\tfor(var i=0; i < units.length; i++){\n\t\t\tif(units[i].key == orig_section){\n\t\t\t\torig_order = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tvar new_unit = units[orig_order + shift];\n\t\tif(!new_unit){\n\t\t\treturn null;\n\t\t}\n\n\t\treturn new_unit.key;\n\t};\n\n\n\t// limit extension\n\n\tvar old_get_blocked_zones = scheduler._get_blocked_zones;\n\tscheduler._get_blocked_zones = function(timespans, property, day_index, day_value, timespan_type){\n\t\tif(property && this.config.multisection){\n\t\t\tproperty = this._parse_event_sections(property);\n\t\t\tvar zones = [];\n\t\t\tfor(var i =0; i < property.length; i++){\n\t\t\t\tzones = zones.concat(old_get_blocked_zones.apply(this, [timespans, property[i], day_index, day_value, timespan_type]));\n\t\t\t}\n\t\t\treturn zones;\n\t\t}else{\n\t\t\treturn old_get_blocked_zones.apply(this, arguments);\n\t\t}\n\t};\n\n\n\t// collision extension\n\tvar old_check_secions_collision = scheduler._check_sections_collision;\n\n\tscheduler._check_sections_collision = function(a, b){\n\t\tif(this.config.multisection && this._get_section_view()){\n\t\t\ta = this._split_events([a]);\n\t\t\tb = this._split_events([b]);\n\n\t\t\tvar collision = false;\n\t\t\tfor(var a_ind = 0, a_len = a.length; a_ind < a_len; a_ind++){\n\t\t\t\tif(collision){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tfor(var b_ind = 0, b_len = b.length; b_ind < b_len; b_ind++){\n\t\t\t\t\tif(old_check_secions_collision.apply(this, [a[a_ind], b[b_ind]])){\n\t\t\t\t\t\tcollision = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn collision;\n\t\t}else{\n\t\t\treturn old_check_secions_collision.apply(this, arguments);\n\t\t}\n\t};\n});\n\n}","export default function(scheduler){\n\n\nfunction parseXMLOptions(loader, config){\n\tvar items = scheduler.ajax.xpath(\"//data/item\", loader.xmlDoc);\n\tvar ids = {};\n\tfor (var i = 0; i < items.length; i++) {\n\t\tids[items[i].getAttribute(config.map_to)] = true;\n\t}\n\treturn ids;\n}\n\nfunction parseJSONOptions(loader, config){\n\ttry{\n\t\tvar items = JSON.parse(loader.xmlDoc.responseText);\n\t\tvar ids = {};\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tvar option = items[i];\n\n\t\t\tids[option.value || option.key || option.id] = true;\n\t\t}\n\t\treturn ids;\n\t}catch(e){\n\t\treturn null;\n\t}\n}\n\nscheduler.form_blocks[\"multiselect\"]={\n\trender:function(sns) {\n\t\tvar css = \"dhx_multi_select_control dhx_multi_select_\"+sns.name;\n\t\tif(!!sns.vertical){\n\t\t\tcss += \" dhx_multi_select_control_vertical\";\n\t\t}\n\n\t\tvar _result = \"<div class='\"+css+\"' style='overflow: auto; height: \"+sns.height+\"px; position: relative;' >\";\n\t\tfor (var i=0; i<sns.options.length; i++) {\n\t\t\t_result += \"<label><input type='checkbox' value='\"+sns.options[i].key+\"'/>\"+sns.options[i].label+\"</label>\";\n\t\t}\n\t\t_result += \"</div>\";\n\t\treturn _result;\n\t},\n\tset_value:function(node,value,ev,config){\n\n\t\tvar _children = node.getElementsByTagName('input');\n\t\tfor(var i=0;i<_children.length;i++) {\n\t\t\t_children[i].checked = false; //unchecking all inputs on the form\n\t\t}\n\n\t\tfunction _mark_inputs(ids) { // ids = [ 0: undefined, 1: undefined, 2: true, 'custom_name': false ... ]\n\t\t\tvar _children = node.getElementsByTagName('input');\n\t\t\tfor(var i=0;i<_children.length; i++) {\n\t\t\t\t_children[i].checked = !! ids[_children[i].value];\n\t\t\t}\n\t\t}\n\n\t\tvar _ids = {};\n\t\tif (ev[config.map_to]) {\n\t\t\tvar results = (ev[config.map_to] + \"\").split(config.delimiter || scheduler.config.section_delimiter || \",\");\n\t\t\tfor (var i = 0; i < results.length; i++) {\n\t\t\t\t_ids[results[i]] = true;\n\t\t\t}\n\t\t\t_mark_inputs(_ids);\n\t\t} else {\n\t\t\tif (scheduler._new_event || !config.script_url)\n\t\t\t\treturn;\n\t\t\tvar divLoading = document.createElement('div');\n\t\t\tdivLoading.className = 'dhx_loading';\n\t\t\tdivLoading.style.cssText = \"position: absolute; top: 40%; left: 40%;\";\n\t\t\tnode.appendChild(divLoading);\n\n\t\t\tvar url = [\n\t\t\t\tconfig.script_url,\n\t\t\t\t(config.script_url.indexOf(\"?\") == -1 ? \"?\" : \"&\"),\n\t\t\t\t'dhx_crosslink_' + config.map_to + '=' + ev.id + '&uid=' + scheduler.uid()\n\t\t\t].join(\"\");\n\n\t\t\tscheduler.ajax.get(url, function(loader) {\n\t\t\t\tvar options = parseJSONOptions(loader, config);\n\t\t\t\tif(!options){\n\t\t\t\t\toptions = parseXMLOptions(loader, config);\n\t\t\t\t}\n\t\t\t\t_mark_inputs(options);\n\t\t\t\tnode.removeChild(divLoading);\n\t\t\t});\n\t\t}\n\t},\n\tget_value:function(node,ev,config){\n\t\tvar _result = [];\n\t\tvar _children = node.getElementsByTagName(\"input\");\n\t\tfor(var i=0;i<_children.length;i++) {\n\t\t\tif(_children[i].checked)\n\t\t\t\t_result.push(_children[i].value);\n\t\t}\n\t\treturn _result.join(config.delimiter || scheduler.config.section_delimiter || \",\");\n\t},\n\n\tfocus:function(node){\n\t}\n};\n\n}","export default function(scheduler){\n\n\n\tfunction backup(obj){\n\t\tvar t = function(){};\n\t\tt.prototype = obj;\n\t\treturn t;\n\t}\n\n\tvar old = scheduler._load;\n\tscheduler._load=function(url,from){\n\t\turl=url||this._load_url;\n\t\tif (typeof url == \"object\"){\n\t\t\tvar t = backup(this._loaded);\n\t\t\tfor (var i=0; i < url.length; i++) {\n\t\t\t\tthis._loaded=new t();\n\t\t\t\told.call(this,url[i],from);\n\t\t\t}\n\t\t} else\n\t\t\told.apply(this,arguments);\n\t};\n\n}","export default function(scheduler){\n\t/* global Backbone */\n\tvar cfg = {\n\t\tuse_id : false\n\t};\n\n\t//remove private properties\n\tfunction sanitize(ev){\n\t\tvar obj = {};\n\t\tfor (var key in ev)\n\t\t\tif (key.indexOf(\"_\") !== 0)\n\t\t\t\tobj[key] = ev[key];\n\n\t\tif (!cfg.use_id)\n\t\t\tdelete obj.id;\n\n\t\treturn obj;\n\t}\n\n\tvar update_timer;\n\tfunction update_view(){\n\t\tclearTimeout(update_timer);\n\t\tupdate_timer = setTimeout(function(){\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tscheduler.updateView();\n\t\t},1);\n\t}\n\n\tfunction _start_ext_load(cal){\n\t\tcal._loading = true;\n\t\tcal._not_render = true;\n\n\t\tcal.callEvent(\"onXLS\", []);\n\t}\n\tfunction _finish_ext_load(cal){\n\t\tcal._not_render = false;\n\t\tif (cal._render_wait)\n\t\t\tcal.render_view_data();\n\t\tcal._loading = false;\n\n\t\tcal.callEvent(\"onXLE\", []);\n\t}\n\n\n\tfunction _get_id(model){\n\t\treturn cfg.use_id ? model.id : model.cid;\n\t}\n\nscheduler.backbone = function(events, config){\n\tif (config) cfg = config;\n\n\tevents.bind(\"change\", function(model, info){\n\t\tvar cid = _get_id(model);\n\t\tvar ev = scheduler._events[cid] = model.toJSON();\n\t\tev.id = cid;\n\n\t\tscheduler._init_event(ev);\n\t\tupdate_view();\n\t});\n\tevents.bind(\"remove\", function(model, changes){\n\t\tvar cid = _get_id(model);\n\t\tif (scheduler._events[cid])\n\t\t\tscheduler.deleteEvent(cid);\n\t});\n\n\tvar queue = [];\n\tfunction add_from_queue(){\n\t\tif(scheduler.$destroyed){\n\t\t\treturn true;\n\t\t}\n\t\tif (queue.length){\n\t\t\tscheduler.parse(queue, \"json\");\n\t\t\tqueue = [];\n\t\t}\n\t}\n\n\tevents.bind(\"add\", function(model, changes){\n\t\tvar cid = _get_id(model);\n\t\tif (!scheduler._events[cid]){\n\t\t\tvar ev =  model.toJSON();\n\t\t\tev.id = cid;\n\t\t\tscheduler._init_event(ev);\n\n\t\t\tqueue.push(ev);\n\t\t\tif (queue.length == 1)\n\t\t\t\tsetTimeout(add_from_queue,1);\n\t\t}\n\t});\n\n\tevents.bind(\"request\", function(obj){\n\t\tif (obj instanceof Backbone.Collection)\n\t\t\t_start_ext_load(scheduler);\n\t});\n\tevents.bind(\"sync\", function(obj){\n\t\tif (obj instanceof Backbone.Collection)\n\t\t\t_finish_ext_load(scheduler);\n\t});\n\tevents.bind(\"error\", function(obj){\n\t\tif (obj instanceof Backbone.Collection)\n\t\t\t_finish_ext_load(scheduler);\n\t});\n\n\n\tscheduler.attachEvent(\"onEventCreated\", function(id){\n\t\tvar ev = new events.model(scheduler.getEvent(id));\n\t\tscheduler._events[id] = ev.toJSON();\n\t\tscheduler._events[id].id = id;\n\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onEventAdded\", function(id){\n\t\tif (!events.get(id)){\n\t\t\tvar data = sanitize(scheduler.getEvent(id));\n\t\t\tvar model = new events.model(data);\n\n\t\t\tvar cid = _get_id(model);\n\t\t\tif (cid != id)\n\t\t\t\tthis.changeEventId(id, cid);\n\t\t\tevents.add(model);\n\t\t\tevents.trigger(\"scheduler:add\", model);\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventChanged\", function(id){\n\t\tvar ev = events.get(id);\n\t\tvar upd = sanitize(scheduler.getEvent(id));\n\n\t\tev.set(upd);\n\t\tevents.trigger(\"scheduler:change\", ev);\n\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventDeleted\", function(id){\n\t\tvar model = events.get(id);\n\t\tif (model){\n\t\t\tevents.trigger(\"scheduler:remove\", model);\n\t\t\tevents.remove(id);\n\t\t}\n\t\treturn true;\n\t});\n};\n\n}","export default function(scheduler){\n\n\t/* global dhtmlDragAndDropObject, dhtmlx */\n// lame old code doesn't provide raw event object\n\tscheduler.attachEvent(\"onTemplatesReady\", function() {\n\t\tvar dragger = (new dhtmlDragAndDropObject());\n\t\tvar old = dragger.stopDrag;\n\t\tvar last_event;\n\t\tdragger.stopDrag = function(e) {\n\t\t\tlast_event = e;\n\t\t\treturn old.apply(this, arguments);\n\t\t};\n\n\t\tfunction on_drop(sourceHtmlObject, dhtmlObject, targetHtmlObject, targetHtml) {\n\n\t\t\tif (scheduler.checkEvent(\"onBeforeExternalDragIn\") && !scheduler.callEvent(\"onBeforeExternalDragIn\", [sourceHtmlObject, dhtmlObject, targetHtmlObject, targetHtml, last_event]))\n\t\t\t\treturn;\n\n\t\t\tvar temp = scheduler.attachEvent(\"onEventCreated\", function (id) {\n\t\t\t\tif (!scheduler.callEvent(\"onExternalDragIn\", [id, sourceHtmlObject, last_event])) {\n\t\t\t\t\tthis._drag_mode = this._drag_id = null;\n\t\t\t\t\tthis.deleteEvent(id);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar action_data = scheduler.getActionData(last_event);\n\t\t\tvar event_data = {\n\t\t\t\tstart_date: new Date(action_data.date)\n\t\t\t};\n\n\t\t\t// custom views, need to assign section id, fix dates\n\t\t\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\t\t\tvar view_options = scheduler.matrix[scheduler._mode];\n\t\t\t\tevent_data[view_options.y_property] = action_data.section;\n\n\t\t\t\tvar pos = scheduler._locate_cell_timeline(last_event);\n\t\t\t\tevent_data.start_date = view_options._trace_x[pos.x];\n\t\t\t\tevent_data.end_date = scheduler.date.add(event_data.start_date, view_options.x_step, view_options.x_unit);\n\t\t\t}\n\t\t\tif (scheduler._props && scheduler._props[scheduler._mode]) {\n\t\t\t\tevent_data[scheduler._props[scheduler._mode].map_to] = action_data.section;\n\t\t\t}\n\n\t\t\tscheduler.addEventNow(event_data);\n\n\t\t\tscheduler.detachEvent(temp);\n\t\t}\n\n\t\tdragger.addDragLanding(scheduler._els[\"dhx_cal_data\"][0], {\n\t\t\t_drag: function(sourceHtmlObject, dhtmlObject, targetHtmlObject, targetHtml) {\n\t\t\t\ton_drop(sourceHtmlObject, dhtmlObject, targetHtmlObject, targetHtml);\n\t\t\t},\n\t\t\t_dragIn: function(htmlObject, shtmlObject) {\n\t\t\t\treturn htmlObject;\n\t\t\t},\n\t\t\t_dragOut: function(htmlObject) {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t});\n\n\t\tif(dhtmlx.DragControl) {\n\t\t\tdhtmlx.DragControl.addDrop(scheduler._els[\"dhx_cal_data\"][0], {\n\t\t\t\tonDrop: function (source, target, d, e) {\n\t\t\t\t\tvar sourceDhtmlx = dhtmlx.DragControl.getMaster(source);\n\t\t\t\t\tlast_event = e;\n\t\t\t\t\ton_drop(source, sourceDhtmlx, target, e.target || e.srcElement);\n\t\t\t\t},\n\n\t\t\t\tonDragIn: function (source, target, e) {\n\t\t\t\t\treturn target;\n\t\t\t\t}\n\t\t\t}, true);\n\t\t}\n\t});\n\n}","export default function(scheduler){\n\n\tvar dx, dy,\n\t\thtml_regexp = new RegExp(\"<[^>]*>\", \"g\"),\n\t\tnewline_regexp = new RegExp(\"<br[^>]*>\", \"g\");\n\n\tfunction clean_html(val) {\n\t\treturn val.replace(newline_regexp, \"\\n\").replace(html_regexp, \"\");\n\t}\n\n\tfunction x_norm(x, offset) {\n\t\tx = parseFloat(x);\n\t\toffset = parseFloat(offset);\n\t\tif (!isNaN(offset)) x -= offset;\n\n\t\tvar w = colsWidth(x);\n\t\tx = x - w.width + w.cols*dx;\n\t\treturn isNaN(x)?\"auto\":(100*x/(dx));\n\t}\n\n\tfunction x_norm_event(x, offset, is_left) {\n\t\tx = parseFloat(x);\n\t\toffset = parseFloat(offset);\n\t\tif (!isNaN(offset) && is_left) x -= offset;\n\n\t\tvar w = colsWidth(x);\n\t\tx = x - w.width + w.cols*dx;\n\t\treturn isNaN(x)?\"auto\":(100*x/(dx-(!isNaN(offset)?offset:0)));\n\t}\n\tfunction colsWidth(width) {\n\t\tvar r = 0;\n\t\tvar header = scheduler._els.dhx_cal_header[0].childNodes;\n\t\tvar els = header[1] ? header[1].childNodes : header[0].childNodes;\n\t\tfor (var i = 0; i < els.length; i++) {\n\t\t\tvar el = els[i].style ? els[i] : els[i].parentNode;\n\t\t\tvar w = parseFloat(el.style.width);\n\t\t\tif (width > w){\n\t\t\t\twidth -= (w+1);\n\t\t\t\tr+=(w+1);\n\t\t\t}\n\t\t\telse\n\t\t\t\tbreak;\n\t\t}\n\t\treturn { width: r, cols: i };\n\t}\n\n\tfunction y_norm(y) {\n\t\ty = parseFloat(y);\n\t\tif (isNaN(y)) return \"auto\";\n\t\treturn 100 * y / dy;\n\t}\n\n\tfunction get_style(node, style){\n\t\treturn (window.getComputedStyle?(window.getComputedStyle(node, null)[style]):(node.currentStyle?node.currentStyle[style]:null))||\"\";\n\t}\n\n\tfunction de_day(node, n) {\n\t\tvar x = parseInt(node.style.left, 10);\n\n\t\tfor (var dx = 0; dx < scheduler._cols.length; dx++) {\n\t\t\tx -= scheduler._cols[dx];\n\t\t\tif (x < 0) return dx;\n\t\t}\n\t\treturn n;\n\t}\n\n\tfunction de_week(node, n) {\n\t\tvar y = parseInt(node.style.top, 10);\n\t\tfor (var dy = 0; dy < scheduler._colsS.heights.length; dy++)\n\t\t\tif (scheduler._colsS.heights[dy] > y) return dy;\n\t\treturn n;\n\t}\n\n\tfunction xml_start(tag) {\n\t\treturn tag ? \"<\"+tag+\">\" : \"\";\n\t}\n\tfunction xml_end(tag) {\n\t\treturn tag ? \"</\"+tag+\">\" : \"\";\n\t}\n\n\tfunction xml_top(tag, profile, header, footer) {\n\t\tvar xml = \"<\"+tag+\" profile='\" + profile + \"'\";\n\t\tif (header)\n\t\t\txml += \" header='\" + header + \"'\";\n\t\tif (footer)\n\t\t\txml += \" footer='\" + footer + \"'\";\n\t\txml += \">\";\n\t\treturn xml;\n\t}\n\n\tfunction xml_body_header() {\n\t\tvar xml = \"\";\n\t\t// detects if current mode is timeline\n\t\tvar mode = scheduler._mode;\n\t\tif (scheduler.matrix && scheduler.matrix[scheduler._mode])\n\t\t\tmode = (scheduler.matrix[scheduler._mode].render == \"cell\") ? \"matrix\" : \"timeline\";\n\t\txml += \"<scale mode='\" + mode + \"' today='\" + scheduler._els.dhx_cal_date[0].innerHTML + \"'>\";\n\n\t\tif (scheduler._mode == \"week_agenda\") {\n\t\t\tvar xh = scheduler._els.dhx_cal_data[0].getElementsByTagName(\"DIV\");\n\t\t\tfor (var i = 0; i < xh.length; i++)\n\t\t\t\tif (xh[i].className == \"dhx_wa_scale_bar\")\n\t\t\t\t\txml += \"<column>\" + clean_html(xh[i].innerHTML) + \"</column>\";\n\t\t} else if (scheduler._mode == \"agenda\" || scheduler._mode == \"map\") {\n\t\t\tvar xh = scheduler._els.dhx_cal_header[0].childNodes[0].childNodes;\n\n\t\t\txml += \"<column>\" + clean_html(xh[0].innerHTML) + \"</column><column>\" + clean_html(xh[1].innerHTML) + \"</column>\";\n\t\t} else if (scheduler._mode == \"year\") {\n\t\t\tvar xh = scheduler._els.dhx_cal_data[0].childNodes;\n\t\t\tfor (var i = 0; i < xh.length; i++) {\n\t\t\t\txml += \"<month label='\" + clean_html(xh[i].querySelector(\".dhx_year_month\").innerHTML) + \"'>\";\n\t\t\t\txml += xml_month_scale(xh[i].querySelector(\".dhx_year_week\").childNodes);\n\t\t\t\txml += xml_month(xh[i].querySelector(\".dhx_year_body\"));\n\t\t\t\txml += \"</month>\";\n\t\t\t}\n\t\t} else {\n\t\t\txml += \"<x>\";\n\t\t\tvar xh = scheduler._els.dhx_cal_header[0].childNodes;\n\t\t\txml += xml_month_scale(xh);\n\t\t\txml += \"</x>\";\n\n\t\t\tvar yh = scheduler._els.dhx_cal_data[0];\n\t\t\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\t\t\txml += \"<y>\";\n\t\t\t\tfor (var i = 0; i < yh.firstChild.rows.length; i++) {\n\t\t\t\t\tvar el = yh.firstChild.rows[i];\n\t\t\t\t\txml += \"<row><![CDATA[\" + clean_html(el.cells[0].innerHTML) + \"]]></row>\";\n\t\t\t\t}\n\t\t\t\txml += \"</y>\";\n\t\t\t\tdy = yh.firstChild.rows[0].cells[0].offsetHeight;\n\t\t\t} else if (yh.firstChild.tagName == \"TABLE\") {\n\t\t\t\txml += xml_month(yh);\n\t\t\t} else {\n\t\t\t\tyh = yh.childNodes[yh.childNodes.length - 1];\n\t\t\t\twhile (yh.className.indexOf(\"dhx_scale_holder\") == -1)\n\t\t\t\t\tyh = yh.previousSibling;\n\t\t\t\tyh = yh.childNodes;\n\n\t\t\t\txml += \"<y>\";\n\t\t\t\tfor (var i = 0; i < yh.length; i++)\n\t\t\t\t\txml += \"\\n<row><![CDATA[\" + clean_html(yh[i].innerHTML) + \"]]></row>\";\n\t\t\t\txml += \"</y>\";\n\t\t\t\tdy = yh[0].offsetHeight;\n\t\t\t}\n\t\t}\n\t\txml += \"</scale>\";\n\t\treturn xml;\n\t}\n\n\tfunction xml_month(yh) {\n\t\tvar xml = \"\";\n\t\tvar r = yh.querySelectorAll(\"tr\");\n\t\tfor (var i = 0; i < r.length; i++) {\n\t\t\tvar days = [];\n\t\t\tvar cells = r[i].querySelectorAll(\"td\");\n\n\t\t\tfor (var j = 0; j < cells.length; j++)\n\t\t\t\tdays.push(cells[j].querySelector(\".dhx_month_head\").innerHTML);\n\n\t\t\txml += \"\\n<row height='\" + cells[0].offsetHeight + \"'><![CDATA[\" + clean_html(days.join(\"|\")) + \"]]></row>\";\n\t\t\tdy = cells[0].offsetHeight;\n\t\t}\n\t\treturn xml;\n\t}\n\n\tfunction xml_month_scale(xh) {\n\t\tvar xhs,\n\t\t\txml = \"\";\n\t\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\t\tif (scheduler.matrix[scheduler._mode].second_scale)\n\t\t\t\txhs = xh[1].childNodes;\n\n\t\t\txh = xh[0].childNodes;\n\t\t}\n\n\t\tfor (var i = 0; i < xh.length; i++)\n\t\t\txml += \"\\n<column><![CDATA[\" + clean_html(xh[i].innerHTML) + \"]]></column>\";\n\t\tdx = xh[0].offsetWidth;\n\n\t\tif (xhs) {\n\t\t\tvar width = 0;\n\t\t\tvar top_width = xh[0].offsetWidth;\n\t\t\tvar top_col = 1;\n\t\t\tfor (var i = 0; i < xhs.length; i++) {\n\t\t\t\txml += \"\\n<column second_scale='\" + top_col + \"'><![CDATA[\" + clean_html(xhs[i].innerHTML) + \"]]></column>\";\n\t\t\t\twidth += xhs[i].offsetWidth;\n\t\t\t\tif (width >= top_width) {\n\t\t\t\t\ttop_width += (xh[top_col] ? xh[top_col].offsetWidth : 0);\n\t\t\t\t\ttop_col++;\n\t\t\t\t}\n\t\t\t\tdx = xhs[0].offsetWidth;\n\t\t\t}\n\t\t}\n\t\treturn xml;\n\t}\n\n\tfunction xml_body(colors) {\n\t\tvar xml = \"\";\n\t\tvar evs = scheduler._rendered;\n\t\tvar matrix = scheduler.matrix && scheduler.matrix[scheduler._mode];\n\n\t\tif (scheduler._mode == \"agenda\" || scheduler._mode == \"map\") {\n\n\t\t\tfor (var i = 0; i < evs.length; i++)\n                xml += \"<event><head><![CDATA[\" + clean_html(evs[i].childNodes[0].innerHTML) + \"]]></head><body><![CDATA[\" + clean_html(evs[i].childNodes[2].innerHTML) + \"]]></body></event>\";\n\n\t\t} else if (scheduler._mode == \"week_agenda\") {\n\n\t\t\tfor (var i = 0; i < evs.length; i++)\n\t\t\t\txml += \"<event day='\" + evs[i].parentNode.getAttribute(\"day\") + \"'><body>\" + clean_html(evs[i].innerHTML) + \"</body></event>\";\n\n\t\t} else if (scheduler._mode == \"year\") {\n\n\t\t\tvar evs = scheduler.get_visible_events();\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar d = evs[i].start_date;\n\t\t\t\tif (d.valueOf() < scheduler._min_date.valueOf())\n\t\t\t\t\td = scheduler._min_date;\n\n\t\t\t\twhile (d < evs[i].end_date) {\n\t\t\t\t\tvar m = d.getMonth() + 12 * (d.getFullYear() - scheduler._min_date.getFullYear()) - scheduler.week_starts._month;\n\t\t\t\t\tvar day = scheduler.week_starts[m] + d.getDate() - 1;\n\t\t\t\t\tvar text_color = colors ? get_style(scheduler._get_year_cell(d), \"color\") : \"\";\n\t\t\t\t\tvar bg_color = colors ? get_style(scheduler._get_year_cell(d), \"backgroundColor\") : \"\";\n\n\t\t\t\t\txml += \"<event day='\" + (day % 7) + \"' week='\" + Math.floor(day / 7) + \"' month='\" + m + \"' backgroundColor='\" + bg_color + \"' color='\" + text_color + \"'></event>\";\n\t\t\t\t\td = scheduler.date.add(d, 1, \"day\");\n\t\t\t\t\tif (d.valueOf() >= scheduler._max_date.valueOf())\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (matrix && matrix.render == \"cell\") {\n\t\t\tvar evs = scheduler._els.dhx_cal_data[0].getElementsByTagName(\"TD\");\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar text_color = colors ? get_style(evs[i], \"color\") : \"\";\n\t\t\t\tvar bg_color = colors ? get_style(evs[i], \"backgroundColor\") : \"\";\n\t\t\t\txml += \"\\n<event><body backgroundColor='\" + bg_color + \"' color='\" + text_color + \"'><![CDATA[\" + clean_html(evs[i].innerHTML) + \"]]></body></event>\";\n\t\t\t}\n\t\t} else {\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar zx, zdx;\n\t\t\t\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\t\t\t\t// logic for timeline view\n\t\t\t\t\tzx = x_norm(evs[i].style.left);\n\t\t\t\t\tzdx = x_norm(evs[i].offsetWidth)-1;\n\t\t\t\t} else {\n\t\t\t\t\t// we should use specific logic for day/week/units view\n\t\t\t\t\tvar left_norm = scheduler.config.use_select_menu_space ? 0 : 26;\n\t\t\t\t\tzx = x_norm_event(evs[i].style.left, left_norm, true);\n\t\t\t\t\tzdx = x_norm_event(evs[i].style.width, left_norm)-1;\n\t\t\t\t}\n\t\t\t\tif (isNaN(zdx * 1)) continue;\n\t\t\t\tvar zy = y_norm(evs[i].style.top);\n\t\t\t\tvar zdy = y_norm(evs[i].style.height);\n\n\t\t\t\tvar e_type = evs[i].className.split(\" \")[0].replace(\"dhx_cal_\", \"\");\n\t\t\t\tif (e_type === 'dhx_tooltip_line') continue;\n\n\t\t\t\tvar dets = scheduler.getEvent(evs[i].getAttribute(scheduler.config.event_attribute));\n                if (!dets) continue;\n\t\t\t\tvar day = dets._sday;\n\t\t\t\tvar week = dets._sweek;\n\t\t\t\tvar length = dets._length || 0;\n\n\t\t\t\tif (scheduler._mode == \"month\") {\n\t\t\t\t\tzdy = parseInt(evs[i].offsetHeight, 10);\n\t\t\t\t\tzy = parseInt(evs[i].style.top, 10) - scheduler.xy.month_head_height;\n\n\t\t\t\t\tday = de_day(evs[i], day);\n\t\t\t\t\tweek = de_week(evs[i], week);\n\t\t\t\t} else if (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\t\t\t\tday = 0;\n\t\t\t\t\tvar el = evs[i].parentNode.parentNode.parentNode;\n\t\t\t\t\tweek = el.rowIndex;\n\t\t\t\t\tvar dy_copy = dy;\n\t\t\t\t\tdy = evs[i].parentNode.offsetHeight;\n\t\t\t\t\tzy = y_norm(evs[i].style.top);\n\t\t\t\t\tzy -= zy * 0.2;\n\t\t\t\t\tdy = dy_copy;\n\t\t\t\t} else {\n\t\t\t\t\tif (evs[i].parentNode == scheduler._els.dhx_cal_data[0]) continue;\n\t\t\t\t\tvar parent = scheduler._els[\"dhx_cal_data\"][0].childNodes[0];\n\t\t\t\t\tvar offset = parseFloat(parent.className.indexOf(\"dhx_scale_holder\") != -1 ? parent.style.left : 0);\n\t\t\t\t\tzx += x_norm(evs[i].parentNode.style.left, offset);\n\t\t\t\t}\n\n\t\t\t\txml += \"\\n<event week='\" + week + \"' day='\" + day + \"' type='\" + e_type + \"' x='\" + zx + \"' y='\" + zy + \"' width='\" + zdx + \"' height='\" + zdy + \"' len='\" + length + \"'>\";\n\n\t\t\t\tif (e_type == \"event\") {\n\t\t\t\t\txml += \"<header><![CDATA[\" + clean_html(evs[i].childNodes[1].innerHTML) + \"]]></header>\";\n\t\t\t\t\tvar text_color = colors ? get_style(evs[i].childNodes[2], \"color\") : \"\";\n\t\t\t\t\tvar bg_color = colors ? get_style(evs[i].childNodes[2], \"backgroundColor\") : \"\";\n\t\t\t\t\txml += \"<body backgroundColor='\" + bg_color + \"' color='\" + text_color + \"'><![CDATA[\" + clean_html(evs[i].childNodes[2].innerHTML) + \"]]></body>\";\n\t\t\t\t} else {\n\t\t\t\t\tvar text_color = colors ? get_style(evs[i], \"color\") : \"\";\n\t\t\t\t\tvar bg_color = colors ? get_style(evs[i], \"backgroundColor\") : \"\";\n\t\t\t\t\txml += \"<body backgroundColor='\" + bg_color + \"' color='\" + text_color + \"'><![CDATA[\" + clean_html(evs[i].innerHTML) + \"]]></body>\";\n\t\t\t\t}\n\t\t\t\txml += \"</event>\";\n\t\t\t}\n\t\t\t}\n\n\t\treturn xml;\n\t}\n\n\tfunction toXML(start, end, view, mode, header, footer){\n\t\tvar colors = false;\n\t\tif (mode == \"fullcolor\") {\n\t\t\tcolors = true;\n\t\t\tmode = \"color\";\n\t\t}\n\n\t\tmode = mode || \"color\";\n\n\t\tvar xml = \"\";\n\t\tif (start) {\n\n\t\t\tvar original_date = scheduler._date;\n\t\t\tvar original_mode = scheduler._mode;\n\t\t\tend = scheduler.date[view+\"_start\"](end);\n\t\t\tend = scheduler.date[\"get_\"+view+\"_end\"] ? scheduler.date[\"get_\"+view+\"_end\"](end) : scheduler.date.add(end, 1, view);\n\n\t\t\txml = xml_top(\"pages\", mode, header, footer);\n\t\t\tfor (var temp_date = new Date(start); +temp_date < +end; temp_date = this.date.add(temp_date, 1, view)) {\n\t\t\t\tthis.setCurrentView(temp_date, view);\n\t\t\t\txml += xml_start(\"page\") + xml_body_header().replace(\"\\u2013\", \"-\") + xml_body(colors) + xml_end(\"page\");\n\t\t\t}\n\t\t\txml += xml_end(\"pages\");\n\n\t\t\tthis.setCurrentView(original_date, original_mode);\n\t\t} else {\n\t\t\txml = xml_top(\"data\", mode, header, footer) + xml_body_header().replace(\"\\u2013\", \"-\") + xml_body(colors) + xml_end(\"data\");\n\t\t}\n\t\treturn xml;\n\t}\n\tscheduler.getPDFData = toXML;\n\tfunction send_xml(xml, url){\n\t\tvar uid = scheduler.uid();\n\t\tvar d = document.createElement(\"div\");\n\t\td.style.display = \"none\";\n\t\tdocument.body.appendChild(d);\n\n\t\td.innerHTML = '<form id=\"' + uid + '\" method=\"post\" target=\"_blank\" action=\"' + url + '\" accept-charset=\"utf-8\" enctype=\"application/x-www-form-urlencoded\"><input type=\"hidden\" name=\"mycoolxmlbody\"/> </form>';\n\t\tdocument.getElementById(uid).firstChild.value = encodeURIComponent(xml);\n\t\tdocument.getElementById(uid).submit();\n\t\td.parentNode.removeChild(d);\n\t}\n\n\tfunction to_pdf(start, end, view, url, mode, header, footer) {\n\t\tvar xml = \"\";\n\t\tif(typeof mode == \"object\"){\n\t\t\txml = schedulersToPdf(mode);\n\t\t}else{\n\t\t\txml = toXML.apply(this, [start, end, view, mode, header, footer]);\n\t\t}\n\n\t\tsend_xml(xml, url);\n\t}\n\n\tfunction schedulersToPdf(objects){\n\t\tvar xml = \"<data>\";\n\t\tfor(var i=0; i < objects.length; i++){\n\t\t\txml += objects[i].source.getPDFData(objects[i].start, objects[i].end, objects[i].view, objects[i].mode, objects[i].header, objects[i].footer);\n\t\t}\n\t\txml += \"</data>\";\n\t\treturn xml;\n\t}\n\n\t/*\n\t * scheduler.toPDF(url, mode, header, footer) - for a single scheduler\n\t * scheduler.toPDF(url, [scheduler1, scheduler2,...]) - for multiple schedulers\n\t * example:\n\t * scheduler.toPDF(\"generate.ashx\", [\n\t *     { source: scheduler1, mode: \"color\" },\n\t *     { source: scheduler2, mode: \"gray\", view:\"week\", start:new Date(2013, 06, 1), end:new Date(2013, 06, 28) },\n\t *     { source: scheduler3 }\n\t * ]);\n\t *\n\t */\n\tscheduler.toPDF = function(url, mode, header, footer) {\n\t\treturn to_pdf.apply(this, [null, null, null, url, mode, header, footer]);\n\t};\n\tscheduler.toPDFRange = function(start, end, view, url, mode, header, footer) {\n\t\tif (typeof start == \"string\") {\n\t\t\tstart = scheduler.templates.api_date(start);\n\t\t\tend = scheduler.templates.api_date(end);\n\t\t}\n\n\t\treturn to_pdf.apply(this, arguments);\n\t};\n\n}","export default function(scheduler){\n\nscheduler.config.icons_select = [\"icon_form\", \"icon_delete\"];\nscheduler.config.details_on_create = true;\nscheduler.config.show_quick_info = true;\nscheduler.xy.menu_width = 0;\n\n\n\nlet clickedElementPosition = null;\nscheduler.attachEvent(\"onSchedulerReady\", function(){\n\tconst container = scheduler.$container;\n\tif(container._$quickInfoHandler){\n\t\treturn;\n\t}else{\n\t\tcontainer._$quickInfoHandler = true;\n\t\t// store coordinates of clicked segment of an event\n\t\t// in case multi section events or multi-line month events\n\t\tscheduler.event(container, \"mousedown\", function(e){\n\t\t\tconst eventElement = e.target.closest(`[${scheduler.config.event_attribute}]`);\n\t\t\tif (eventElement) {\n\t\t\t\tclickedElementPosition = {\n\t\t\t\t\tid: eventElement.getAttribute(scheduler.config.event_attribute),\n\t\t\t\t\tposition: getPositionInsideScheduler(eventElement)\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t\tscheduler.attachEvent(\"onDestroy\", () => {\n\t\t\tdelete container._$quickInfoHandler;\n\t\t});\n\t}\n});\n\nscheduler.attachEvent(\"onClick\", function(id){\n\tif(!scheduler.config.show_quick_info){\n\t\treturn;\n\t}\n\tscheduler.showQuickInfo(id);\n\treturn true;\n});\n\n(function(){\n\t// pass `force` argument in order to hide quick info synchronously\n\t// so it won't affect showQuickInfo call that can follow\n\tvar events = [\"onEmptyClick\", \"onViewChange\", \"onLightbox\", \"onBeforeEventDelete\", \"onBeforeDrag\"];\n\tvar hiding_function = function(){\n\t\tscheduler.hideQuickInfo(true);\n\t\treturn true;\n\t};\n\tfor (var i=0; i<events.length; i++){\n\t\tscheduler.attachEvent(events[i], hiding_function);\n\t}\n})();\n\nscheduler.templates.quick_info_title = function(start, end, ev){ return ev.text.substr(0,50); };\nscheduler.templates.quick_info_content = function(start, end, ev){ return ev.details || \"\"; };\nscheduler.templates.quick_info_date = function(start, end, ev){\n\tif (scheduler.isOneDayEvent(ev) && scheduler.config.rtl){\n\t\treturn scheduler.templates.day_date(start, end, ev) + \" \" +scheduler.templates.event_header(end, start, ev);\n\t} else if (scheduler.isOneDayEvent(ev)) {\n\t\treturn scheduler.templates.day_date(start, end, ev) + \" \" +scheduler.templates.event_header(start, end, ev);\n\t} else if (scheduler.config.rtl) {\n\t\treturn scheduler.templates.week_date(end, start, ev);\n\t} else {\n\t\treturn scheduler.templates.week_date(start, end, ev);\n\t}\n};\n\nscheduler.showQuickInfo = function(id){\n\tif (id == this._quick_info_box_id) return;\n\tthis.hideQuickInfo(true);\n\tif(this.callEvent(\"onBeforeQuickInfo\", [id]) === false){\n\t\treturn;\n\t}\n\n\tlet pos;\n\tif(clickedElementPosition && clickedElementPosition.id == id){\n\t\tpos = clickedElementPosition.position;\n\t} else {\n\t\tpos = this._get_event_counter_part(id);\n\t}\n\n\n\tif (pos){\n\t\tthis._quick_info_box = this._init_quick_info(pos);\n\t\tthis._fill_quick_data(id);\n\t\tthis._show_quick_info(pos);\n\n\t\tthis.callEvent(\"onQuickInfo\", [id]);\n\t}\n};\n\n(function(){\n\nfunction cssTimeToMs(time) {\n\ttime = time || \"\";\n\n\tvar num = parseFloat(time),\n\t\tunit = time.match(/m?s/),\n\t\tmilliseconds;\n\n\tif (unit) {\n\t\tunit = unit[0];\n\t}\n\n\tswitch (unit) {\n\t\tcase \"s\": // seconds\n\t\t\tmilliseconds = num * 1000;\n\t\t\tbreak;\n\t\tcase \"ms\": // milliseconds\n\t\t\tmilliseconds = num;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tmilliseconds = 0;\n\t\t\tbreak;\n\t}\n\n\treturn milliseconds;\n}\n\nscheduler.hideQuickInfo = function(forced){\n\tvar qi = this._quick_info_box;\n\tvar eventId = this._quick_info_box_id;\n\tthis._quick_info_box_id = 0;\n\n\tif (qi && qi.parentNode){\n\t\tvar width = qi.offsetWidth;\n\t\tif (scheduler.config.quick_info_detached) {\n\t\t\tthis.callEvent(\"onAfterQuickInfo\", [eventId]);\n\t\t\treturn qi.parentNode.removeChild(qi);\n\t\t}\n\n\t\tif (qi.style.right == \"auto\")\n\t\t\tqi.style.left = -width + \"px\";\n\t\telse\n\t\t\tqi.style.right = -width + \"px\";\n\n\t\tif (forced) {\n\t\t\tqi.parentNode.removeChild(qi);\n\t\t}else{\n\n\t\t\tvar style;\n\t\t\tif(window.getComputedStyle){\n\t\t\t\tstyle = window.getComputedStyle(qi, null);\n\t\t\t}else if(qi.currentStyle){\n\t\t\t\tstyle = qi.currentStyle;\n\t\t\t}\n\t\t\tvar delay = cssTimeToMs(style[\"transition-delay\"]) + cssTimeToMs(style[\"transition-duration\"]);\n\t\t\tsetTimeout(function(){\n\t\t\t\tif(qi.parentNode){\n\t\t\t\t\tqi.parentNode.removeChild(qi);\n\t\t\t\t}\n\t\t\t}, delay);\n\t\t}\n\n\t\tthis.callEvent(\"onAfterQuickInfo\", [eventId]);\n\t}\n};\n\n})();\n\nscheduler.event(window, \"keydown\", function(e){\n\tif (e.keyCode == 27)\n\t\tscheduler.hideQuickInfo();\n});\n\nscheduler._show_quick_info = function(pos){\n\tvar qi = scheduler._quick_info_box;\n\tscheduler._obj.appendChild(qi);\n\tvar width = qi.offsetWidth;\n\tvar height = qi.offsetHeight;\n\n\tif (scheduler.config.quick_info_detached){\n\t\tvar left = pos.left - pos.dx*(width - pos.width);\n\t\tif(scheduler.getView() && scheduler.getView()._x_scroll){\n\t\t\t// scrollable timeline\n\t\t\tif(scheduler.config.rtl){\n\t\t\t\tleft += scheduler.getView()._x_scroll;\n\t\t\t}else{\n\t\t\t\tleft -= scheduler.getView()._x_scroll;\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\tvar right = left + width;\n\t\tif(right > window.innerWidth){\n\t\t\tleft = window.innerWidth - width;\n\t\t}\n\t\tleft = Math.max(0, left);\n\n\t\tqi.style.left = left + \"px\";\n\t\tqi.style.top = pos.top - (pos.dy?height:-pos.height) + \"px\";\n\t} else {\n\n\t\tconst dataPos = scheduler.$container.querySelector('.dhx_cal_data').offsetTop;\n\t\tqi.style.top = dataPos + 20 + \"px\";\n\t\tif (pos.dx == 1){\n\t\t\tqi.style.right = \"auto\";\n\t\t\tqi.style.left = -width + \"px\";\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tqi.style.left = \"-10px\";\n\t\t\t},1);\n\t\t} else {\n\t\t\tqi.style.left = \"auto\";\n\t\t\tqi.style.right = -width + \"px\";\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tqi.style.right = \"-10px\";\n\t\t\t},1);\n\t\t}\n\t\tqi.className = qi.className.replace(\" dhx_qi_left\",\"\").replace(\" dhx_qi_right\",\"\")+\" dhx_qi_\"+(pos.dx==1?\"left\":\"right\");\n\t}\n\n\tqi.ontransitionend = () => {\n\t\tfitQIInsideWindow(qi);\n\t\tqi.ontransitionend = null;\n\t};\n\tsetTimeout(() => {\n\t\tfitQIInsideWindow(qi);\n\t}, 1);\n};\n\nfunction fitQIInsideWindow(quickInfoPopup){\n\tconst popupRect = quickInfoPopup.getBoundingClientRect();\n\tconst containerRect = scheduler.$container.getBoundingClientRect();\n\n\t// calculate the bottom offset of the Quick Info relative to the scheduler container\n\tconst offsetBottom = containerRect.bottom - popupRect.bottom;\n\n\t// If the popup extends outside the scheduler container, adjust its top position\n\tif (offsetBottom < 0) {\n\t\tquickInfoPopup.style.top = `${parseFloat(quickInfoPopup.style.top) + offsetBottom}px`;\n\t}\n}\n\nscheduler.attachEvent(\"onTemplatesReady\", function(){\n\tscheduler.hideQuickInfo();\n\tif(this._quick_info_box){\n\t\tvar box = this._quick_info_box;\n\t\tif(box.parentNode){\n\t\t\tbox.parentNode.removeChild(box);\n\t\t}\n\t\tthis._quick_info_box = null;\n\t}\n});\nscheduler._quick_info_onscroll_handler = function(e){\n\tscheduler.hideQuickInfo();\n};\nscheduler._init_quick_info = function(){\n\tif (!this._quick_info_box){\n\n\n\t\tvar qi = this._quick_info_box = document.createElement(\"div\");\n\n\t\tthis._waiAria.quickInfoAttr(qi);\n\n\t\tqi.className = \"dhx_cal_quick_info\";\n\t\tif (scheduler.$testmode)\n\t\t\tqi.className += \" dhx_no_animate\";\n\t\tif (scheduler.config.rtl) qi.className += \" dhx_quick_info_rtl\";\n\t//title\n\t\tvar ariaAttr = this._waiAria.quickInfoHeaderAttrString();\n\t\tvar html = `\n\t\t<div class=\"dhx_cal_qi_tcontrols\">\n\t\t\t<a class=\"dhx_cal_qi_close_btn scheduler_icon close\"></a>\n\t\t</div>\n\t\t<div class=\"dhx_cal_qi_title\" ${ariaAttr}>\n\t\t\t\t\n\t\t\t\t<div class=\"dhx_cal_qi_tcontent\"></div>\n\t\t\t\t<div class=\"dhx_cal_qi_tdate\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"dhx_cal_qi_content\"></div>`;\n\n\t//buttons\n\t\thtml += \"<div class=\\\"dhx_cal_qi_controls\\\">\";\n\t\tvar buttons = scheduler.config.icons_select;\n\t\t\tfor (var i = 0; i < buttons.length; i++) {\n\t\t\t\tvar ariaAttr = this._waiAria.quickInfoButtonAttrString(this.locale.labels[buttons[i]]);\n\t\t\t\thtml += `<div ${ariaAttr} class=\"dhx_qi_big_icon ${buttons[i]}\" title=\"${scheduler.locale.labels[buttons[i]]}\">\n\t\t\t\t<div class='dhx_menu_icon ${buttons[i]}'></div><div>${scheduler.locale.labels[buttons[i]]}</div></div>`;\n\t\t\t}\n\t\t// }\n\t\thtml += \"</div>\";\n\n\t\tqi.innerHTML = html;\n\t\tscheduler.event(qi, \"click\", function(ev){\n\t\t\tscheduler._qi_button_click(ev.target || ev.srcElement);\n\t\t});\n\t\tif (scheduler.config.quick_info_detached){\n\t\t\tscheduler._detachDomEvent(scheduler._els[\"dhx_cal_data\"][0], \"scroll\", scheduler._quick_info_onscroll_handler);\n\t\t\tscheduler.event(scheduler._els[\"dhx_cal_data\"][0], \"scroll\", scheduler._quick_info_onscroll_handler);\n\t\t}\n\t}\n\n\treturn this._quick_info_box;\n};\n\nscheduler._qi_button_click = function(node){\n\tvar box = scheduler._quick_info_box;\n\tif (!node || node == box) return;\n\n\tif(node.closest(\".dhx_cal_qi_close_btn\")){\n\t\tscheduler.hideQuickInfo();\n\t\treturn;\n\t}\n\n\tvar mask = scheduler._getClassName(node);\n\tif (mask.indexOf(\"_icon\")!=-1){\n\t\tvar id = scheduler._quick_info_box_id;\n\t\tscheduler._click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\n\t} else\n\t\tscheduler._qi_button_click(node.parentNode);\n};\n\nfunction getPositionInsideScheduler(element){\n\tlet left = 0;\n\tlet top = 0;\n\n\tlet node = element;\n\twhile (node && node != scheduler._obj){\n\t\tleft += node.offsetLeft;\n\t\ttop += node.offsetTop-node.scrollTop;\n\t\tnode = node.offsetParent;\n\t}\n\tif(node){\n\t\tlet dx = (left + element.offsetWidth/2) > (scheduler._x/2) ? 1 : 0;\n\t\tlet dy = (top + element.offsetHeight/2) > (scheduler._y/2) ? 1 : 0;\n\n\t\treturn { left:left, top:top, dx:dx, dy:dy,\n\t\t\twidth:element.offsetWidth, height:element.offsetHeight };\n\t}\n\treturn 0;\n}\n\nscheduler._get_event_counter_part = function(id){\n\tvar domEv = scheduler.getRenderedEvent(id);\n\treturn getPositionInsideScheduler(domEv);\n};\n\nscheduler._fill_quick_data  = function(id){\n\tvar ev = scheduler.getEvent(id);\n\tvar qi = scheduler._quick_info_box;\n\n\tscheduler._quick_info_box_id = id;\n\n//title content\n\n\tvar header = {\n\t\tcontent: scheduler.templates.quick_info_title(ev.start_date, ev.end_date, ev),\n\t\tdate: scheduler.templates.quick_info_date(ev.start_date, ev.end_date, ev)\n\t};\n\tvar titleContent = qi.querySelector(\".dhx_cal_qi_tcontent\");\n\ttitleContent.innerHTML = `<span>${header.content}</span>`;\n\tvar titleDate = qi.querySelector(\".dhx_cal_qi_tdate\");\n\ttitleDate.innerHTML = header.date;\n\n\tscheduler._waiAria.quickInfoHeader(qi, [header.content, header.date].join(\" \"));\n\n//main content\n\tvar main = qi.querySelector(\".dhx_cal_qi_content\");\n\tconst mainContent = scheduler.templates.quick_info_content(ev.start_date, ev.end_date, ev);\n\tif(mainContent){\n\t\tmain.classList.remove(\"dhx_hidden\");\n\t\tmain.innerHTML = mainContent;\n\t}else{\n\t\tmain.classList.add(\"dhx_hidden\");\n\t}\n};\n\n\n}","export default function(scheduler){\n\t\nscheduler.attachEvent(\"onTemplatesReady\", function() {\n\tvar originalRecurringSetValue;\n\tif (scheduler.form_blocks.recurring) {\n\t\toriginalRecurringSetValue = scheduler.form_blocks.recurring.set_value;\n\t}\n\tvar original_left_buttons = scheduler.config.buttons_left.slice();\n\tvar original_right_buttons = scheduler.config.buttons_right.slice();\n\n\tscheduler.attachEvent(\"onBeforeLightbox\", function(id) {\n\t\tif (this.config.readonly_form || this.getEvent(id).readonly) {\n\t\t\tthis.config.readonly_active = true;\n\t\t}\n\t\telse {\n\t\t\tthis.config.readonly_active = false;\n\t\t\tscheduler.config.buttons_left = original_left_buttons.slice();\n\t\t\tscheduler.config.buttons_right = original_right_buttons.slice();\n\t\n\t\t\t// initial value\n\t\t\tif(scheduler.form_blocks.recurring) {\n\t\t\t\tscheduler.form_blocks.recurring.set_value = originalRecurringSetValue;\n\t\t\t}\n\t\t}\n\n\t\tif (this.config.readonly_active) {\n\t\t\tvar forbidden_buttons = [\"dhx_delete_btn\", \"dhx_save_btn\"];\n\t\t\tvar button_arrays = [scheduler.config.buttons_left, scheduler.config.buttons_right];\n\t\t\tfor (var i = 0; i < forbidden_buttons.length; i++) {\n\t\t\t\tvar forbidden_button = forbidden_buttons[i];\n\t\t\t\tfor (var k = 0; k < button_arrays.length; k++) {\n\t\t\t\t\tvar button_array = button_arrays[k];\n\t\t\t\t\tvar index = -1;\n\t\t\t\t\tfor (var p = 0; p < button_array.length; p++) {\n\t\t\t\t\t\tif (button_array[p] == forbidden_button) {\n\t\t\t\t\t\t\tindex = p;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\tbutton_array.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.resetLightbox();\n\n\t\treturn true;\n\t});\n\n\tfunction txt_replace(tag, d, n, text) {\n\t\tvar txts = d.getElementsByTagName(tag);\n\t\tvar txtt = n.getElementsByTagName(tag);\n\t\tfor (var i = txtt.length - 1; i >= 0; i--) {\n\t\t\tvar n = txtt[i];\n\t\t\tif (!text){\n\t\t\t\tn.disabled = true;\n\t\t\t\t//radio and checkboxes loses state after .cloneNode in IE\n\t\t\t\tif(d.checked)\n\t\t\t\t\tn.checked = true;\n\t\t\t}else {\n\t\t\t\tvar t = document.createElement(\"span\");\n\t\t\t\tt.className = \"dhx_text_disabled\";\n\t\t\t\tt.innerHTML = text(txts[i]);\n\t\t\t\tn.parentNode.insertBefore(t, n);\n\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t}\n\t\t}\n\t}\n\n\tvar old = scheduler._fill_lightbox;\n\tscheduler._fill_lightbox = function() {\n\n\t\tvar lb = this.getLightbox();\n\t\tif (this.config.readonly_active) {\n\t\t\tlb.style.visibility = 'hidden';\n\t\t\t// lightbox should have actual sizes before rendering controls\n\t\t\t// currently only matters for dhtmlxCombo\n\t\t\tlb.style.display = 'block';\n\t\t}\n\t\tvar res = old.apply(this, arguments);\n\t\tif (this.config.readonly_active) {\n\t\t\t//reset visibility and display\n\t\t\tlb.style.visibility = '';\n\t\t\tlb.style.display = 'none';\n\t\t}\n\n\t\tif (this.config.readonly_active) {\n\n\t\t\tvar originalForm = this.getLightbox();\n\t\t\tvar readonlyForm = this._lightbox_r = originalForm.cloneNode(true);\n\t\t\treadonlyForm.id = scheduler.uid();\n\t\t\treadonlyForm.className += \" dhx_cal_light_readonly\";\n\t\t\ttxt_replace(\"textarea\", originalForm, readonlyForm, function(a) {\n\t\t\t\treturn a.value;\n\t\t\t});\n\t\t\ttxt_replace(\"input\", originalForm, readonlyForm, false);\n\t\t\ttxt_replace(\"select\", originalForm, readonlyForm, function(a) {\n\t\t\t\tif(!a.options.length) return \"\";\n\t\t\t\treturn a.options[Math.max((a.selectedIndex || 0), 0)].text;\n\t\t\t});\n\n\t\t\toriginalForm.parentNode.insertBefore(readonlyForm, originalForm);\n\n\t\t\tthis.showCover(readonlyForm);\n\t\t\tif (scheduler._lightbox)\n\t\t\t\tscheduler._lightbox.parentNode.removeChild(scheduler._lightbox);\n\t\t\tthis._lightbox = readonlyForm;\n\n\t\t\tif (scheduler.config.drag_lightbox)\n\t\t\t\tscheduler.event(readonlyForm.firstChild, \"mousedown\", scheduler._ready_to_dnd);\n\t\t\t\t\n\t\t\tscheduler._init_lightbox_events();\n\t\t\tthis.setLightboxSize();\n\t\t}\n\t\treturn res;\n\t};\n\n\tvar hold = scheduler.hide_lightbox;\n\tscheduler.hide_lightbox = function() {\n\t\tif (this._lightbox_r) {\n\t\t\tthis._lightbox_r.parentNode.removeChild(this._lightbox_r);\n\t\t\tthis._lightbox_r = this._lightbox = null;\n\t\t}\n\n\t\treturn hold.apply(this, arguments);\n\t};\n});\n\n\n}","import { RRule, rrulestr } from 'rrule';\n\nexport default function (scheduler) {\n\n\tfunction clearMilliseconds(date) {\n\t\treturn new Date(\n\t\t\tdate.getFullYear(),\n\t\t\tdate.getMonth(),\n\t\t\tdate.getDate(),\n\t\t\tdate.getHours(),\n\t\t\tdate.getMinutes(),\n\t\t\tdate.getSeconds(),\n\t\t\t0\n\t\t);\n\t}\n\n\tfunction isDeletedOccurrence(event) {\n\t\treturn !!event.deleted;\n\t}\n\n\tfunction isSeries(event) {\n\t\treturn !!event.rrule && !event.recurring_event_id;\n\t}\n\n\tfunction clearRecurringProperties(event) {\n\t\tevent.rrule = \"\";\n\t\tevent.original_start = null;\n\t\tevent.recurring_event_id = null;\n\t\tevent.duration = null;\n\t\tevent.deleted = null;\n\t}\n\n\tfunction createException(ev) {\n\t\tlet id = ev.id.split(\"#\");\n\n\t\tlet nid = scheduler.uid();\n\t\tscheduler._not_render = true;\n\t\tlet nev = scheduler._copy_event(ev);\n\t\tnev.id = nid;\n\t\tnev.recurring_event_id = id[0];\n\n\t\tlet timestamp = id[1];\n\n\t\tnev.original_start = new Date(Number(timestamp));\n\n\t\tscheduler._add_rec_marker(nev, timestamp);\n\t\tscheduler.addEvent(nev);\n\t\tscheduler._not_render = false;\n\t}\n\n\tfunction toUTCDate(date){\n\t\treturn new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(),date.getSeconds()));\n\t}\n\n\tfunction setUTCPartsToDate(d) {\n\t\treturn new Date(\n\t\t\td.getUTCFullYear(),\n\t\t\td.getUTCMonth(),\n\t\t\td.getUTCDate(),\n\t\t\td.getUTCHours(),\n\t\t\td.getUTCMinutes(),\n\t\t\td.getUTCSeconds()\n\t\t);\n\t}\n\n\tfunction updateFollowingEventsRRULE(ev){\n\t\tif(ev.rrule.includes(\";UNTIL=\")){\n\t\t\tev.rrule = ev.rrule.split(\";UNTIL=\")[0];\n\t\t}\n\t\tlet parsedRRule = rrulestr(`RRULE:${ev.rrule};UNTIL=${toIcalString(ev._end_date || ev.end_date)}`, { dtstart: ev.start_date });\n\t\tlet newRRULE = new RRule(parsedRRule.origOptions).toString().replace(\"RRULE:\", \"\");\n\t\tnewRRULE = newRRULE.split(\"\\n\")[1];\n\t\tev.rrule = newRRULE;\n\t}\n\t// need to remove BYDAY from rrule to avoid incorrect checkboxes in lightbox\n\tfunction updateFollowingWithWEEKLY(id, ev){\n\t\tif(!ev){\n\t\t\tev = scheduler.getEvent(id);\n\t\t}\n\t\tlet rruleStringparts = ev.rrule.split(\";\");\n\t\tlet updatedRRULE = [];\n\t\tfor (let i = 0; i < rruleStringparts.length; i++) {\n\t\t\tlet splited = rruleStringparts[i].split(\"=\");\n\t\t\tlet code = splited[0];\n\t\t\tlet name = splited[1];\n\t\t\tif (code === \"BYDAY\") {\n\t\t\t\t// case when rrule WEEKLY;BYDAY with one specified day\n\t\t\t\tif(!(ev.rrule.includes(\"WEEKLY\") && name.length > 3)){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tupdatedRRULE.push(code);\n\t\t\tupdatedRRULE.push(\"=\");\n\t\t\tupdatedRRULE.push(name);\n\t\t\tupdatedRRULE.push(\";\");\n\t\t}\n\t\tupdatedRRULE.pop(); // delete last ;\n\t\tev.rrule = updatedRRULE.join(\"\");\n\t}\n\n\tscheduler._isFollowing = function(id){\n\t\tlet ev = scheduler.getEvent(id);\n\t\treturn !!(ev && ev._thisAndFollowing);\n\t};\n\n\tscheduler._isFirstOccurrence = function(ev){\n\t\t// check for first copy dummy\n\t\tif(scheduler._is_virtual_event(ev.id)){\n\t\t\tlet pid = ev.id.split(\"#\")[0];\n\t\t\tlet recEvent = scheduler.getEvent(pid);\n\t\t\treturn !!(recEvent.start_date.valueOf() === ev.start_date.valueOf());\n\t\t}\n\t};\n\n\tscheduler._isExceptionFirstOccurrence = function(ev){\n\t\t// check for first exception \n\t\tif(scheduler._is_modified_occurrence(ev)){\n\t\t\tlet pid = ev.recurring_event_id;\n\t\t\tlet recEvent = scheduler.getEvent(pid);\n\t\t\treturn !!(ev.original_start && ev.original_start.valueOf() && ev.original_start.valueOf() === recEvent.start_date.valueOf());\n\t\t}\n\t};\n\n\tscheduler._rec_temp = [];\n\tscheduler._rec_markers_pull = {};\n\tscheduler._rec_markers = {};\n\tscheduler._add_rec_marker = function (ev, time) {\n\t\tev._pid_time = time;\n\t\tthis._rec_markers[ev.id] = ev;\n\t\tif (!this._rec_markers_pull[ev.event_pid]) this._rec_markers_pull[ev.event_pid] = {};\n\t\tthis._rec_markers_pull[ev.event_pid][time] = ev;\n\t};\n\tscheduler._get_rec_marker = function (time, id) {\n\t\tlet ch = this._rec_markers_pull[id];\n\t\tif (ch) return ch[time];\n\t\treturn null;\n\t};\n\tscheduler._get_rec_markers = function (id) {\n\t\treturn (this._rec_markers_pull[id] || []);\n\t};\n\n\t(function () {\n\t\tvar old_add_event = scheduler.addEvent;\n\t\tscheduler.addEvent = function (start_date, end_date, text, id, extra_data) {\n\t\t\tvar ev_id = old_add_event.apply(this, arguments);\n\n\t\t\tif (ev_id && scheduler.getEvent(ev_id)) {\n\t\t\t\tvar ev = scheduler.getEvent(ev_id);\n\n\t\t\t\tif (ev.start_date) {\n\t\t\t\t\tev.start_date = clearMilliseconds(ev.start_date);\n\t\t\t\t}\n\t\t\t\tif (ev.end_date) {\n\t\t\t\t\tev.end_date = clearMilliseconds(ev.end_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ev_id;\n\t\t};\n\t})();\n\n\tscheduler.attachEvent(\"onEventLoading\", function (event) {\n\n\t\tif (event.original_start && !event.original_start.getFullYear) {\n\t\t\tevent.original_start = scheduler.templates.parse_date(event.original_start);\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onEventIdChange\", function (id, new_id) {\n\t\tif (this._ignore_call) return;\n\t\tthis._ignore_call = true;\n\n\t\tif (scheduler._rec_markers[id]) {\n\t\t\t//important for for correct work of scheduler.getEvents(from, to) and collision detection\n\t\t\tscheduler._rec_markers[new_id] = scheduler._rec_markers[id];\n\t\t\tdelete scheduler._rec_markers[id];\n\t\t}\n\n\t\tif (scheduler._rec_markers_pull[id]) {\n\t\t\tscheduler._rec_markers_pull[new_id] = scheduler._rec_markers_pull[id];\n\t\t\tdelete scheduler._rec_markers_pull[id];\n\t\t}\n\n\t\tfor (var i = 0; i < this._rec_temp.length; i++) {\n\t\t\tvar tev = this._rec_temp[i];\n\t\t\tif (this._is_virtual_event(tev.id) && tev.id.split(\"#\")[0] == id) {\n\t\t\t\ttev.recurring_event_id = new_id;\n\t\t\t\tthis.changeEventId(tev.id, new_id + \"#\" + tev.id.split(\"#\")[1]);\n\t\t\t}\n\t\t}\n\n\t\tfor (var i in this._rec_markers) {\n\t\t\tvar tev = this._rec_markers[i];\n\t\t\tif (tev.recurring_event_id == id) {\n\t\t\t\ttev.recurring_event_id = new_id;\n\t\t\t\ttev._pid_changed = true;\n\t\t\t}\n\t\t}\n\n\t\tvar el = scheduler._rec_markers[new_id];\n\t\tif (el && el._pid_changed) {\n\t\t\tdelete el._pid_changed;\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (scheduler.$destroyed) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tscheduler.callEvent(\"onEventChanged\", [new_id, scheduler.getEvent(new_id)]);\n\t\t\t}, 1);\n\t\t}\n\n\t\tdelete this._ignore_call;\n\t});\n\tfunction setPropsForFirstOccurrence(ev, occurrence){\n\t\tev._end_date = ev.end_date;\n\t\tif (scheduler._isExceptionFirstOccurrence(occurrence)){\n\t\t\tev.start_date = occurrence.start_date;\n\t\t\tev.end_date = new Date(occurrence.start_date.valueOf() + ev.duration * 1000);\n\t\t\tev._start_date = occurrence.original_start;\n\t\t\tev._modified = true;\n\t\t} else {\n\t\t\tev.end_date = new Date(occurrence.start_date.valueOf() + ev.duration * 1000);\n\t\t\tev.start_date = occurrence.start_date;\n\t\t\tev._firstOccurrence = true;\n\t\t}\n\t\tev._thisAndFollowing = occurrence.id;\n\t}\n\n\tfunction setPropsForStorageEvent(index, data, ev, tempEvent) {\n\t\t//  index based on whether it's an exception\n\t\tconst targetIndex = ev._modified ? tempEvent.id : index;\n\n\t\tscheduler._events[targetIndex] = {\n\t\t\t...tempEvent,\n\t\t\ttext: data.text,\n\t\t\tduration: data.duration,\n\t\t\tstart_date: data.start_date,\n\t\t\trrule: data.rrule,\n\t\t\tend_date: tempEvent._end_date,\n\t\t\t_start_date: tempEvent.start_date,\n\t\t\t_thisAndFollowing: null,\n\t\t\t_end_date: null\n\t\t};\n\t\n\t\t// If it's an exception, delete the it from storage\n\t\tif (ev._modified) {\n\t\t\tdelete scheduler._events[index];\n\t\t}\n\t\n\t\tscheduler.callEvent(\"onEventChanged\", [scheduler._events[targetIndex].id, scheduler._events[targetIndex]]);\n\t}\n\n\tfunction deleteExceptionFromStorage(exception) {\n\t\tfor (const i in scheduler._events) {\n\t\t\tlet tev = scheduler._events[i];\n\t\t\tif(tev.id == exception.id){\n\t\t\t\tdelete scheduler._events[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction updateTextEvents(id, data){\n\t\tfor (let i in scheduler._events) {\n\t\t\tlet tev = scheduler._events[i];\n\t\t\tif (tev.recurring_event_id == id || (scheduler._is_virtual_event(tev.id) && tev.id.split(\"#\")[0] == id)) {\n\t\t\t\ttev.text = data.text;\n\t\t\t\tscheduler.updateEvent(tev.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction deleteEventFromSeries(idTimestamp, ev) {\n\t\tlet id = idTimestamp;\n\t\tlet originalStartTimestamp = new Date(ev.original_start).valueOf(); // GS-2643: in case if an exception has already came from backend\n\t\tidTimestamp = String(id).split(\"#\") || ev._pid_time || originalStartTimestamp; // id can be number\n\t\tlet nid = scheduler.uid();\n\t\tlet tid = (idTimestamp[1]) ? idTimestamp[1] : (ev._pid_time || originalStartTimestamp);\n\t\tlet nev = scheduler._copy_event(ev);\n\t\tnev.id = nid;\n\t\tnev.recurring_event_id = ev.recurring_event_id || idTimestamp[0];\n\t\tnev.original_start = new Date(Number(tid));\n\t\tnev.deleted = true;\n\t\tscheduler.addEvent(nev);\n\t}\n\n\tscheduler.attachEvent(\"onConfirmedBeforeEventDelete\", function (id) {\n\t\tvar ev = this.getEvent(id);\n\t\tif (this._is_virtual_event(id) || (this._is_modified_occurrence(ev) && !isDeletedOccurrence(ev))) {\n\t\t\tdeleteEventFromSeries(id, ev);\n\t\t} else {\n\t\t\tif (isSeries(ev) && this._lightbox_id)\n\t\t\t\tthis._roll_back_dates(ev);\n\n\t\t\tvar sub = this._get_rec_markers(id);\n\t\t\tfor (var i in sub) {\n\t\t\t\tif (sub.hasOwnProperty(i)) {\n\t\t\t\t\tid = sub[i].id;\n\t\t\t\t\tif (this.getEvent(id))\n\t\t\t\t\t\tthis.deleteEvent(id, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onEventDeleted\", function (id, ev) {\n\t\tif (!this._is_virtual_event(id) && this._is_modified_occurrence(ev)) {\n\t\t\tif (!scheduler._events[id]) {\n\t\t\t\tev.deleted = true;\n\t\t\t\tthis.setEvent(id, ev);\n\t\t\t\tscheduler.render();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction removeTempDraggedEvent(){\n\t\tfor (const i in scheduler._events) {\n\t\t\tif(i === \"$dnd_recurring_placeholder\"){\n\t\t\t\tdelete scheduler._events[i];\n\t\t\t}\n\t\t}\n\t\tscheduler.render();\n\t}\n\n\tscheduler.attachEvent(\"onBeforeEventChanged\", function(ev, e, is_new, original){\n\t\tif(!is_new && ev && (scheduler._is_virtual_event(ev.id) || scheduler._is_modified_occurrence(ev))){\n\t\t\tif (original.start_date.getDate() !== ev.start_date.getDate()){\n\t\t\t\tev._beforeEventChangedFlag = \"edit\";\n\t\t\t} else {\n\t\t\t\tev._beforeEventChangedFlag = \"ask\";\n\t\t\t}\n\t\t\t// check collision before create\n\t\t\tif (!scheduler.config.collision_limit || scheduler.checkCollision(ev)) {\n\t\t\t\tscheduler._events[\"$dnd_recurring_placeholder\"] = scheduler._lame_clone(ev); // adding temp event to the event store\n\t\t\t\tscheduler._showRequiredModalBox(ev.id, ev._beforeEventChangedFlag);\n\t\t\t\treturn false;\n\t\t\t}\t\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onEventChanged\", function (id, event) {\n\t\tif (this._loading) return true;\n\n\t\tlet ev = this.getEvent(id);\n\t\tif (this._is_virtual_event(id)) {\n\t\t\tcreateException(ev);\n\n\t\t} else {\n\t\t\tif (ev.start_date) {\n\t\t\t\tev.start_date = clearMilliseconds(ev.start_date);\n\t\t\t}\n\t\t\tif (ev.end_date) {\n\t\t\t\tev.end_date = clearMilliseconds(ev.end_date);\n\t\t\t}\n\n\t\t\tif (isSeries(ev) && this._lightbox_id) {\n\t\t\t\tif(ev._removeFollowing || this._isFollowing(id)){\n\t\t\t\t\tev._removeFollowing = null;\n\t\t\t\t} else {\n\t\t\t\t\tthis._roll_back_dates(ev);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar sub = this._get_rec_markers(id);\n\t\t\tfor (var i in sub) {\n\t\t\t\tif (sub.hasOwnProperty(i)) {\n\t\t\t\t\tdelete this._rec_markers[sub[i].id];\n\t\t\t\t\tthis.deleteEvent(sub[i].id, true);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdelete this._rec_markers_pull[id];\n\n\t\t\t// it's possible that after editing event is no longer exists, in such case we need to remove _select_id flag\n\t\t\tvar isEventFound = false;\n\t\t\tfor (var k = 0; k < this._rendered.length; k++) {\n\t\t\t\tif (this._rendered[k].getAttribute(this.config.event_attribute) == id)\n\t\t\t\t\tisEventFound = true;\n\t\t\t}\n\t\t\tif (!isEventFound)\n\t\t\t\tthis._select_id = null;\n\t\t}\n\t\tremoveTempDraggedEvent();\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventAdded\", function (id) {\n\t\tif (!this._loading) {\n\t\t\tvar ev = this.getEvent(id);\n\t\t\tif (isSeries(ev)) {\n\t\t\t\tthis._roll_back_dates(ev);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventSave\", function (id, data, is_new_event) {\n\t\tlet ev = this.getEvent(id);\n\t\tlet tempEvent = scheduler._lame_clone(ev); // copy of the event before it have been cut\n\t\tlet tempDataRRULE = data.rrule; // copy for following events\n\t\tif (ev && isSeries(ev)){\n\t\t\t//GS-2578: FollowingEvents\n\t\t\tif(!is_new_event && (this._isFollowing(id))){\n\t\t\t\t// removing FollowingEvents\n\t\t\t\tif (ev._removeFollowing) {\n\t\t\t\t\tlet occurrence = scheduler.getEvent(ev._thisAndFollowing);\n\t\t\t\t\tif (occurrence && (ev._firstOccurrence || ev._modified)) {\n\t\t\t\t\t\tscheduler.hideLightbox();\n\t\t\t\t\t\tscheduler.deleteEvent(ev.id);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// cut off main rec event\n\t\t\t\t\t\tev.end_date = new Date(ev.start_date.valueOf() - 1000);\n\t\t\t\t\t\tev._end_date = ev._shorten_end_date;\n\t\t\t\t\t\tev.start_date = ev._start_date;\n\t\t\t\t\t\tev._shorten = true;\n\t\t\t\t\t\tupdateFollowingEventsRRULE(ev);\n\t\t\t\t\t\tscheduler.callEvent(\"onEventChanged\", [ev.id, ev]);\n\t\t\t\t\t\t// need to delete exceptions\n\t\t\t\t\t\tlet occurrence = scheduler.getEvent(ev._thisAndFollowing);\n\t\t\t\t\t\tif (occurrence) {\n\t\t\t\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\t\t\t\tif (tev.recurring_event_id === id) {\n\t\t\t\t\t\t\t\t\tif (tev.start_date.valueOf() > tempEvent.start_date.valueOf()) {\n\t\t\t\t\t\t\t\t\t\tdeleteEventFromSeries(tev.id, tev);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tscheduler.hideLightbox();\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\tlet occurrence = scheduler.getEvent(ev._thisAndFollowing);\n\t\t\t\t\t// case first occurence is a copy dummy\n\t\t\t\t\tif(occurrence && ev._firstOccurrence){\n\t\t\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\t\t\tif (tev.id == ev.id) {\n\t\t\t\t\t\t\t\tsetPropsForStorageEvent(i, data, ev, tempEvent);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t// case first occurrence is a exception\n\t\t\t\t\t} else if (occurrence && ev._modified){\n\t\t\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\t\t\tif(tev.recurring_event_id == id && tev.id == tempEvent._thisAndFollowing){\n\t\t\t\t\t\t\t\tsetPropsForStorageEvent(i, data, ev, tempEvent);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// case for exception\n\t\t\t\t\t\tif (scheduler._is_modified_occurrence(occurrence)){\n\t\t\t\t\t\t\tdeleteExceptionFromStorage(occurrence);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// cut off main rec event\n\t\t\t\t\t\tev.end_date = ev._shorten_end_date;\n\t\t\t\t\t\tev._end_date = ev._shorten_end_date;\n\t\t\t\t\t\tev.start_date = ev._start_date;\n\t\t\t\t\t\tev._shorten = true;\n\t\t\t\t\t\tupdateFollowingEventsRRULE(ev);\n\t\t\t\t\t\tscheduler.callEvent(\"onEventChanged\", [ev.id, ev]);\n\t\t\t\t\t\t// creating FollowingEvents\n\t\t\t\t\t\tlet followingEv = {...tempEvent};\n\t\t\t\t\t\tfollowingEv.text = data.text;\n\t\t\t\t\t\tfollowingEv.duration = data.duration;\n\t\t\t\t\t\tfollowingEv.rrule = tempDataRRULE;\n\t\t\t\t\t\tfollowingEv._start_date = null;\n\t\t\t\t\t\tfollowingEv.id = scheduler.uid();\n\t\t\t\t\t\tscheduler.addEvent(followingEv.start_date, followingEv.end_date, followingEv.text, followingEv.id, followingEv);\n\t\t\t\t\t}\n\t\t\t\t\t// if following events updates only text, we update text in all copy dummies and exceptions\n\t\t\t\t\tif (!is_new_event){\n\t\t\t\t\t\tupdateTextEvents(id, data);\n\t\t\t\t\t}\n\t\t\t\t\tscheduler.hideLightbox();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// if rec event updates only text, we update text in all copy dummies and exceptions\n\t\tif (!is_new_event){\n\t\t\tupdateTextEvents(id, data);\n\t\t}\n\t\t// case for dragged occurence that is temp event\n\t\tif (tempEvent._ocr && tempEvent._beforeEventChangedFlag){\n\t\t\tev.start_date = tempEvent.start_date; \n\t\t\tev.end_date = tempEvent.end_date; \n\t\t\tev._start_date = tempEvent._start_date;\n\t\t\tev._end_date = tempEvent._end_date;\n\t\t\tscheduler.updateEvent(ev.id);\n\t\t\treturn true;\n\t\t}\n\t\t\tthis._select_id = null;\n\t\t\tremoveTempDraggedEvent();\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventCreated\", function (id) {\n\t\tvar ev = this.getEvent(id);\n\t\tif (!isSeries(ev)) {\n\t\t\tclearRecurringProperties(ev);\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventCancel\", function (id) {\n\t\tvar ev = this.getEvent(id);\n\t\tif (isSeries(ev)) {\n\t\t\tthis._roll_back_dates(ev);\n\t\t\t// a bit expensive, but we need to be sure that event re-rendered, because view can be corrupted by resize , during edit process\n\t\t\tthis.render_view_data();\n\t\t}\n        removeTempDraggedEvent();\n\t});\n\tscheduler._roll_back_dates = function (ev) {\n\t\t//// !!!!! calc temp properties\n\t\tif (ev.start_date) {\n\t\t\tev.start_date = clearMilliseconds(ev.start_date);\n\t\t}\n\t\tif (ev.end_date) {\n\t\t\tev.end_date = clearMilliseconds(ev.end_date);\n\t\t}\n\t\tif (ev._end_date) {\n\t\t\tif (!ev._shorten){\n\t\t\t\tev.duration = Math.round((ev.end_date.valueOf() - ev.start_date.valueOf()) / 1000);\n\t\t\t}\n\t\t\tev.end_date = ev._end_date;\n\t\t}\n\t\tif (ev._start_date) {\n\t\t\tev.start_date.setMonth(0);\n\t\t\tev.start_date.setDate(ev._start_date.getDate());\n\t\t\tev.start_date.setMonth(ev._start_date.getMonth());\n\t\t\tev.start_date.setFullYear(ev._start_date.getFullYear());\n\t\t\tif (this._isFollowing(ev.id)){\n\t\t\t\tev.start_date.setHours(ev._start_date.getHours());\n\t\t\t\tev.start_date.setMinutes(ev._start_date.getMinutes());\n\t\t\t\tev.start_date.setSeconds(ev._start_date.getSeconds());\n\t\t\t}\n\t\t}\n\t\tev._thisAndFollowing = null;\n\t\tif(ev._shorten_end_date)\n\t\t\tev._shorten_end_date = null;\n\t\tif(ev._removeFollowing)\n\t\t\tev._removeFollowing = null;\n\t\tif(ev._firstOccurrence)\n\t\t\tev._firstOccurrence = null;\n\t\tif(ev._modified)\n\t\t\tev._modified = null;\n\t};\n\n\tscheduler._is_virtual_event = function (id) {\n\t\treturn id.toString().indexOf(\"#\") != -1;\n\t};\n\tscheduler._is_modified_occurrence = function (ev) {\n\t\treturn (ev.recurring_event_id && ev.recurring_event_id != \"0\");\n\t};\n\n\tscheduler.showLightbox_rec = scheduler.showLightbox;\n\tscheduler.showLightbox = function (id) {\n\t\tconst locale = this.locale;\n\t\tlet formSetting = scheduler.config.lightbox_recurring;\n\t\tlet ev = this.getEvent(id);\n\t\tlet pid = ev.recurring_event_id;\n\t\tlet isVirtual = this._is_virtual_event(id);\n\t\tif (isVirtual) {\n\t\t\tpid = id.split(\"#\")[0];\n\t\t}\n\n\t\tconst showRequiredLightbox = function (id, type) {\n\t\t\tconst occurrence = scheduler.getEvent(id);\n\t\t\tconst event = scheduler.getEvent(pid);\n\t\t\tconst view = scheduler.getView();\n\t\t\t// for timeline and units\n\t\t\tif (view && occurrence[view.y_property]){\n\t\t\t\tevent[view.y_property] = occurrence[view.y_property];\n\t\t\t}\n\t\t\tif (view && occurrence[view.property]){\n\t\t\t\tevent[view.property] = occurrence[view.property];\n\t\t\t}\n\n\t\t\tif (type === \"Occurrence\") {\n\t\t\t\treturn scheduler.showLightbox_rec(id);\n\t\t\t}\n\n\t\t\tif (type === \"Following\"){\n\t\t\t\t// case when  first occurrence is an exception\n\t\t\t\tif(scheduler._isExceptionFirstOccurrence(occurrence)){\n\t\t\t\t\tsetPropsForFirstOccurrence(event, occurrence);\n\t\t\t\t\treturn scheduler.showLightbox_rec(pid);\n\t\t\t\t}\n\t\t\t\t// for the first occurrence\n\t\t\t\tif (scheduler._isFirstOccurrence(occurrence)){\n\t\t\t\t\tsetPropsForFirstOccurrence(event, occurrence);\n\t\t\t\t\treturn scheduler.showLightbox_rec(pid);\n\t\t\t\t} else {\n\t\t\t\t\t// editing series\n\t\t\t\t\tevent._end_date = event.end_date;\n\t\t\t\t\tconst originalStart = occurrence.original_start || occurrence.start_date;\n\t\t\t\t\tevent._shorten_end_date = new Date(originalStart.valueOf() - 1000);\n\t\t\t\t\tevent.end_date = new Date(occurrence.start_date.valueOf() + event.duration * 1000);\n\t\t\t\t\tevent._start_date = event.start_date;\n\t\t\t\t\tevent.start_date = occurrence.start_date;\n\t\t\t\t\tevent._thisAndFollowing = occurrence.id;\n\n\t\t\t\t\t// to indicate that occurence was created by drag\n\t\t\t\t\tif(ev._beforeEventChangedFlag){\n\t\t\t\t\t\tevent._beforeEventChangedFlag = ev._beforeEventChangedFlag;\n\t\t\t\t\t\tevent._shorten_end_date = new Date(originalStart.valueOf() - 1000);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn scheduler.showLightbox_rec(pid);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (type === \"AllEvents\"){\n\t\t\t\t// for the first occurrence that is exception\n\t\t\t\tif(scheduler._isExceptionFirstOccurrence(occurrence)){\n\t\t\t\t\tsetPropsForFirstOccurrence(event, occurrence);\n\t\t\t\t\treturn scheduler.showLightbox_rec(pid);\n\t\t\t\t}\n\t\t\t\t// for the first occurrence GS-2710\n\t\t\t\tif (scheduler._isFirstOccurrence(occurrence)){\n\t\t\t\t\tsetPropsForFirstOccurrence(event, occurrence);\n\t\t\t\t\treturn scheduler.showLightbox_rec(pid);\n\t\t\t\t}\n\t\t\t\t// for n-part of series\n\t\t\t\tconst tempStart = new Date(event.start_date);\n\t\t\t\tevent._end_date = event.end_date;\n\t\t\t\tevent._start_date = tempStart;\n\t\t\t\tevent.start_date.setHours(occurrence.start_date.getHours());\n\t\t\t\tevent.start_date.setMinutes(occurrence.start_date.getMinutes());\n\t\t\t\tevent.start_date.setSeconds(occurrence.start_date.getSeconds());\n\t\t\t\tevent.end_date = new Date(event.start_date.valueOf() + event.duration * 1000);\n\t\t\t\tevent._thisAndFollowing = null;\n\t\t\t\treturn scheduler.showLightbox_rec(pid);\n\t\t\t}\n\t\t};\n\t\tif ((pid || pid * 1 === 0) && isSeries(ev)) {\n\t\t\t// direct API call on series id\n\t\t\treturn showRequiredLightbox(id, \"AllEvents\");\n\t\t}\n\n\t\tif (!pid || pid === '0' || ((!locale.labels.confirm_recurring || formSetting == 'instance') || (formSetting == 'series' && !isVirtual))) {\n\t\t\t// editing instance or non recurring event\n\t\t\treturn this.showLightbox_rec(id);\n\t\t}\n\n\t\tif (formSetting === 'ask') {\n\t\t\tconst locale = scheduler.locale;\n\t\t\tshowModalbox([\n\t\t\t\t{value: \"Occurrence\", label: locale.labels.button_edit_occurrence, checked: true,\n\t\t\t\t\tcallback: () => showRequiredLightbox(id, \"Occurrence\")},\n\t\t\t\t{value: \"Following\", label: locale.labels.button_edit_occurrence_and_following,\n\t\t\t\t\tcallback: () => showRequiredLightbox(id, \"Following\")},\n\t\t\t\t{value: \"AllEvents\", label: locale.labels.button_edit_series,\n\t\t\t\t\tcallback: () => showRequiredLightbox(id, \"AllEvents\")}\n\t\t\t]);\n\t\t}\n\t};\n\n\tfunction showModalbox(options, callback){\n\t\tconst locale = scheduler.locale;\n\t\tconst haveChecked = options.find(o => o.checked);\n\t\tif(!haveChecked){\n\t\t\toptions[0].checked = true;\n\t\t}\n\t\tconst callbacks = options.reduce((result, o) => {\n\t\t\tresult[o.value] = o.callback;\n\t\t\treturn result;\n\t\t}, {});\n\t\tscheduler.modalbox({\n\t\t\ttext: `<div class=\"dhx_edit_recurrence_options\">\n\t\t\t\t${options.map((option) => `<label class=\"dhx_styled_radio\">\n\t\t\t\t\t<input type=\"radio\" value=\"${option.value}\" name=\"option\" ${option.checked ? \"checked\" : \"\"}>\n\t\t\t\t\t${option.label}\n\t\t\t\t</label>`).join(\"\")}\n\t\t\t</div>`,\n\t\t\ttype: \"recurring_mode\",\n\t\t\ttitle: locale.labels.confirm_recurring,\n\t\t\twidth: \"auto\",\n\t\t\tposition: \"middle\",\n\t\t\tbuttons: [\n\t\t\t\t{label: locale.labels.message_ok, value:\"ok\", css:\"rec_ok\"},\n\t\t\t\t{label: locale.labels.message_cancel, value: \"cancel\"}\n\t\t\t],\n\t\t\tcallback: function (value, e) {\n\t\t\t\tif(callback){\n\t\t\t\t\tcallback(value, e);\n\t\t\t\t}\n\t\t\t\tif(value === \"cancel\"){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst box = e.target.closest(\".scheduler_modal_box\");\n\t\t\t\tconst checked = box.querySelector(\"input[type='radio']:checked\");\n\t\t\t\tlet selectedOption;\n\t\t\t\tif(checked){\n\t\t\t\t\tselectedOption = checked.value;\n\t\t\t\t}\n\t\t\t\tif(selectedOption){\n\t\t\t\t\tcallbacks[selectedOption]();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t}\n\tscheduler._showRequiredModalBox = function(id, type) {\n\t\tlet buttons;\n\n\t\tconst locale = scheduler.locale;\n\t\tlet occurrence = scheduler.getEvent(id);\n\t\tlet pid = occurrence.recurring_event_id;\n\t\t\n\t\tlet isVirtual = scheduler._is_virtual_event(occurrence.id);\n\t\tif (isVirtual) {\n\t\t\tpid = occurrence.id.split(\"#\")[0];\n\t\t}\n\t\tlet event = scheduler.getEvent(pid);\n\t\tconst view = scheduler.getView();\n\t\tlet tempEvent = scheduler._lame_clone(event);\n\t\t// for timeline and units\n\t\tif (view && occurrence[view.y_property]){\n\t\t\ttempEvent[view.y_property] = occurrence[view.y_property];\n\t\t}\n\t\tif (view && occurrence[view.property]){\n\t\t\ttempEvent[view.property] = occurrence[view.property];\n\t\t}\n\t\t// for case with edit following events\n\t\tlet tempStartDate;\n\t\tlet tempEndDate;\n\t\tif (occurrence && occurrence._beforeEventChangedFlag){\n\t\t\ttempStartDate = occurrence.start_date;\n\t\t\ttempEndDate = occurrence.end_date;\n\t\t}\n\t\tconst handleOccurrence = function(occurrence){\n\t\t\tlet tempEvent = {...event, ...scheduler.getEvent(\"$dnd_recurring_placeholder\")};\n\t\t\tif (tempEndDate && tempStartDate) {\n\t\t\t\ttempEvent.start_date = tempStartDate;\n\t\t\t\ttempEvent.end_date = tempEndDate;\n\t\t\t\ttempEvent._beforeEventChangedFlag = occurrence._beforeEventChangedFlag;\n\t\t\t\ttempEvent._ocr = true;\n\t\t\t}\n\t\t\t// check collision before create\n\t\t\tif (!scheduler.config.collision_limit || scheduler.checkCollision(tempEvent)) {\n\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\tif(i === \"$dnd_recurring_placeholder\"){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(tev.id == tempEvent.id){\n\t\t\t\t\t\tscheduler._events[i] = {...tempEvent};\n\t\t\t\t\t\tscheduler.callEvent(\"onEventChanged\", [scheduler._events[i].id, scheduler._events[i]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tconst handleFollowing = function(occurrence){\n\t\t\tlet initialOccurrence = scheduler._lame_clone(occurrence);\n\t\t\tif (tempEndDate && tempStartDate) {\n\t\t\t\toccurrence._start_date = occurrence.start_date;\n\t\t\t\toccurrence.start_date = tempStartDate;\n\t\t\t\toccurrence.end_date = tempEndDate;\n\t\t\t}\n\t\t\t// for the first occurrence\n\t\t\tif (scheduler._isFirstOccurrence(initialOccurrence) || scheduler._isExceptionFirstOccurrence(initialOccurrence)){\n\t\t\t\tif(scheduler._isExceptionFirstOccurrence(initialOccurrence)){\n\t\t\t\t\tdeleteExceptionFromStorage(initialOccurrence);\n\t\t\t\t}\n\t\t\t\ttempEvent._start_date = event.start_date;\n\t\t\t\ttempEvent.start_date = occurrence.start_date;\n\t\t\t\ttempEvent.duration = (+occurrence.end_date - +occurrence.start_date) / 1000;\n\t\t\t\ttempEvent._beforeEventChangedFlag = occurrence._beforeEventChangedFlag;\n\t\t\t\t// to avoid problem with weekly events\n\t\t\t\tif (tempEvent.rrule){\n\t\t\t\t\tupdateFollowingWithWEEKLY(tempEvent.id, tempEvent);\n\t\t\t\t}\n\t\t\t\t// check collision before create\n\t\t\t\tif (!scheduler.config.collision_limit || scheduler.checkCollision(tempEvent)) {\n\t\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\t\tif(tev.id == tempEvent.id){\n\t\t\t\t\t\t\tscheduler._events[i] = {...tempEvent};\n\t\t\t\t\t\t\tscheduler.callEvent(\"onEventChanged\", [scheduler._events[i].id, scheduler._events[i]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// editing series\n\t\t\t\ttempEvent._end_date = event.end_date;\n\t\t\t\tconst originalStart = occurrence.original_start || scheduler.date.date_part(new Date(occurrence._start_date));\n\t\t\t\ttempEvent._shorten_end_date = new Date(originalStart.valueOf() - 1000);\n\t\t\t\ttempEvent.end_date = occurrence.end_date;\n\t\t\t\ttempEvent._start_date = event.start_date;\n\t\t\t\ttempEvent.start_date = occurrence.start_date;\n\t\t\t\ttempEvent._thisAndFollowing = occurrence.id;\n\t\t\t\t// to avoid problem with weekly events\n\t\t\t\tif (tempEvent.rrule){\n\t\t\t\t\tupdateFollowingWithWEEKLY(tempEvent.id, tempEvent);\n\t\t\t\t}\n\n\t\t\t\t// check collision before create\n\t\t\t\tlet tempEnd = tempEvent.end_date;\n\t\t\t\ttempEvent.end_date = tempEvent._end_date;\n\t\t\t\tif (!scheduler.config.collision_limit || scheduler.checkCollision(tempEvent)) {\n\t\t\t\t\ttempEvent.end_date = tempEnd;\n\t\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\t\tif(tev.id == tempEvent.id){\n\t\t\t\t\t\t\tscheduler._events[i] = {...tempEvent};\n\t\t\t\t\t\t\tscheduler.callEvent(\"onEventSave\", [scheduler._events[i].id, scheduler._events[i], scheduler._new_event]);\n\t\t\t\t\t\t\tscheduler.callEvent(\"onEventChanged\", [scheduler._events[i].id, scheduler._events[i]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst handleAllEvents = function(occurrence){\n\t\t\tlet initialOccurrence = scheduler._lame_clone(occurrence);\n\t\t\tif(scheduler._isExceptionFirstOccurrence(initialOccurrence)){\n\t\t\t\tdeleteExceptionFromStorage(initialOccurrence);\n\t\t\t}\n\t\t\tif (tempEndDate && tempStartDate) {\n\t\t\t\ttempEvent.start_date.setHours(tempStartDate.getHours());\n\t\t\t\ttempEvent.start_date.setMinutes(tempStartDate.getMinutes());\n\t\t\t\ttempEvent.start_date.setSeconds(tempStartDate.getSeconds());\n\t\t\t\ttempEvent.duration = (+tempEndDate - +tempStartDate) / 1000;\n\t\t\t}\n\t\t\ttempEvent._beforeEventChangedFlag = occurrence._beforeEventChangedFlag;\n\t\t\ttempEvent._thisAndFollowing = null;\n\t\t\t// check collision before create\n\t\t\tif (!scheduler.config.collision_limit || scheduler.checkCollision(tempEvent)) {\n\t\t\t\tfor (const i in scheduler._events) {\n\t\t\t\t\tlet tev = scheduler._events[i];\n\t\t\t\t\tif(tev.id == tempEvent.id){\n\t\t\t\t\t\tscheduler._events[i] = {...tempEvent};\n\t\t\t\t\t\tscheduler.callEvent(\"onEventChanged\", [scheduler._events[i].id, scheduler._events[i]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\tconst btnAll = {value: \"AllEvents\", label: locale.labels.button_edit_series, callback: () => handleAllEvents(occurrence)};\n\t\tconst btnFollowing = {value: \"Following\", label: locale.labels.button_edit_occurrence_and_following, callback: () => handleFollowing(occurrence)};\n\t\tconst btnOccurrence = {value: \"Occurrence\", label: locale.labels.button_edit_occurrence, callback: () => handleOccurrence(occurrence), checked: true};\n\t\tif (type === 'ask') {\n\t\t\tbuttons = [\n\t\t\t\tbtnOccurrence,\n\t\t\t\tbtnFollowing,\n\t\t\t\tbtnAll\n\t\t\t];\n\t\t} else { \n\t\t\tbuttons = [\n\t\t\t\tbtnOccurrence,\n\t\t\t\tbtnFollowing\n\t\t\t];\n\t\t}\n\n\t\tshowModalbox(buttons, (result) => {\n\t\t\tif(result === \"cancel\"){\n\t\t\t\tremoveTempDraggedEvent(); \n\t\t\t}\n\t\t});\n\t};\n\n\tfunction groupExceptions() {\n\t\tconst exceptions = {};\n\t\tfor (const i in scheduler._events) {\n\t\t\tconst ev = scheduler._events[i];\n\t\t\tif (ev.recurring_event_id && ev.original_start) {\n\t\t\t\tif (!exceptions[ev.recurring_event_id]) {\n\t\t\t\t\texceptions[ev.recurring_event_id] = {};\n\t\t\t\t}\n\t\t\t\texceptions[ev.recurring_event_id][ev.original_start.valueOf()] = ev;\n\t\t\t}\n\t\t}\n\t\treturn exceptions;\n\t}\n\tfunction removeDraggedEventFromVisibleEvents(array) {\n\t\tconst result = {};\n\t\tarray.forEach(item => {\n\t\t\tconst existingItem = result[item.id];\n\t\t\t// removing the existed event without `_beforeEventChangedFlag` property\n\t\t\tif (!existingItem || (existingItem._beforeEventChangedFlag || item._beforeEventChangedFlag)) {\n\t\t\t\tresult[item.id] = item;\n\t\t\t}\n\t\t});\n\t\treturn Object.values(result);\n\t}\n\tscheduler.get_visible_events_rec = scheduler.get_visible_events;\n\tscheduler.get_visible_events = function (only_timed) {\n\t\tfor (var i = 0; i < this._rec_temp.length; i++)\n\t\t\tdelete this._events[this._rec_temp[i].id];\n\t\tthis._rec_temp = [];\n\n\t\tconst exceptions = groupExceptions();\n\t\tvar stack = this.get_visible_events_rec(only_timed);\n\t\tvar out = [];\n\t\tfor (var i = 0; i < stack.length; i++) {\n\t\t\tif (stack[i].deleted || stack[i].recurring_event_id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (isSeries(stack[i])) {\n\t\t\t\tthis.repeat_date(stack[i], out, undefined, undefined, undefined, undefined, exceptions);\n\t\t\t} else {\n\t\t\t\tout.push(stack[i]);\n\t\t\t}\n\t\t}\n\t\tlet result = removeDraggedEventFromVisibleEvents(out);\n\t\treturn result;\n\t};\n\n\t(function () {\n\t\tvar old = scheduler.isOneDayEvent;\n\t\tscheduler.isOneDayEvent = function (ev) {\n\t\t\tif (isSeries(ev)) return true;\n\t\t\treturn old.call(this, ev);\n\t\t};\n\t\tvar old_update_event = scheduler.updateEvent;\n\t\tscheduler.updateEvent = function (id) {\n\t\t\tvar ev = scheduler.getEvent(id);\n\n\t\t\tif (ev && isSeries(ev) && !this._is_virtual_event(id)) {\n\t\t\t\tscheduler.update_view();\n\t\t\t} else {\n\t\t\t\told_update_event.call(this, id);\n\t\t\t}\n\t\t};\n\t})();\n\n\tconst toIcalString = scheduler.date.date_to_str(\"%Y%m%dT%H%i%s\");\n\n\tscheduler.repeat_date = function (ev, stack, non_render, from, to, maxCount, exceptions) {\n\t\tif (!ev.rrule) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet seriesExceptions = exceptions ? exceptions[ev.id] : groupExceptions()[ev.id];\n\t\tif (!seriesExceptions) {\n\t\t\tseriesExceptions = {};\n\t\t}\n\n\t\t// GS-2596: from and to should be in UTC,\n\t\t// GS-2698,GS-2710: take into account the event that crosses scheduler._min_date\n\t\tfrom = toUTCDate(from || new Date(scheduler._min_date.valueOf() - 7 * 24 * 60 * 60 * 1000));\n\t\tto = toUTCDate(to ||new Date(scheduler._max_date.valueOf() - 1000));\n\n\t\tconst utcStart = toUTCDate(ev.start_date);\n\t\tlet parsedRRule;\n\t\tif (maxCount){\n\t\t\t// for getRecDates() method\n\t\t\tparsedRRule = rrulestr(`RRULE:${ev.rrule};UNTIL=${toIcalString(ev.end_date)};COUNT=${maxCount}`, { dtstart: utcStart });\n\t\t} else {\n\t\t\tparsedRRule = rrulestr(`RRULE:${ev.rrule};UNTIL=${toIcalString(ev.end_date)}`, { dtstart: utcStart });\n\t\t}\n\n\t\tconst repeatedDates = parsedRRule.between(from, to, true).map(date => {\n\t\t\tconst adjustedDate = setUTCPartsToDate(date);\n\t\t\tadjustedDate.setHours(ev.start_date.getHours());\n\t\t\tadjustedDate.setMinutes(ev.start_date.getMinutes());\n\t\t\tadjustedDate.setSeconds(ev.start_date.getSeconds());\n\t\t\treturn adjustedDate;\n\t\t});\n\t\tlet visibleCount = 0;\n\n\t\tconst eventDuration = ev.duration;\n\n\t\tfor (let i = 0; i < repeatedDates.length; i++) {\n\t\t\tif (maxCount && visibleCount >= maxCount) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst date = repeatedDates[i];\n\n\t\t\tlet exception = seriesExceptions[date.valueOf()];\n\t\t\tif (exception) {\n\t\t\t\t//skip deleted exception and the exception that not crosses scheduler._min_date, connected to GS-2698\n\t\t\t\t// GS-2741: skip exception if it is not in filter\n\t\t\t\tif (exception.deleted || exception.end_date.valueOf() < scheduler._min_date.valueOf() || !scheduler.filter_event(exception.id, exception)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\tvisibleCount++;\n\t\t\t\t\tstack.push(exception);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst copy = scheduler._copy_event(ev);\n\t\t\t\t//copy._timed = ev._timed;\n\t\t\t\tcopy.text = ev.text;\n\t\t\t\tcopy.start_date = date;\n\t\t\t\tcopy.id = ev.id + \"#\" + Math.ceil(date.valueOf());\n\t\t\t\tcopy.end_date = new Date(date.valueOf() + eventDuration * 1000);\n\t\t\t\tif(copy.end_date.valueOf() < scheduler._min_date.valueOf()){\n\t\t\t\t\tcontinue; //skip the event that not crosses scheduler._min_date, connected to GS-2698\n\t\t\t\t}\n\t\t\t\tcopy.end_date = scheduler._fix_daylight_saving_date(copy.start_date, copy.end_date, ev, date, copy.end_date);\n\t\t\t\tcopy._timed = scheduler.isOneDayEvent(copy);\n\n\t\t\t\tif (!copy._timed && !scheduler._table_view && !scheduler.config.multi_day) continue;\n\t\t\t\tstack.push(copy);\n\n\t\t\t\tif (!non_render) {\n\t\t\t\t\tscheduler._events[copy.id] = copy;\n\t\t\t\t\tscheduler._rec_temp.push(copy);\n\t\t\t\t}\n\t\t\t\tvisibleCount++;\n\t\t\t}\n\t\t}\n\t\t//GS-2534: case when exceptions have different dates\n\t\tif (seriesExceptions && repeatedDates.length == 0 ){\n\t\t\tfor (let a in seriesExceptions){\n\t\t\t\tlet exception = seriesExceptions[a];\n\t\t\t\tif (exception) {\n\t\t\t\t\t//skip deleted exception and the exception that not crosses scheduler._min_date, connected to GS-2698\n\t\t\t\t\t// GS-2741: skip exception if it is not in filter\n\t\t\t\t\tif (exception.deleted || exception.end_date.valueOf() < scheduler._min_date.valueOf() || !scheduler.filter_event(exception.id, exception)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else if (from && to && exception.start_date < to && exception.end_date > from) {\n\t\t\t\t\t\tstack.push(exception);\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t};\n\n\tscheduler._fix_daylight_saving_date = function (start_date, end_date, ev, counter, default_date) {\n\t\tvar shift = start_date.getTimezoneOffset() - end_date.getTimezoneOffset();\n\t\tif (shift) {\n\t\t\tif (shift > 0) {\n\t\t\t\t// e.g. 24h -> 23h\n\t\t\t\treturn new Date(counter.valueOf() + ev.duration * 1000 - shift * 60 * 1000);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// e.g. 24h -> 25h\n\t\t\t\treturn new Date(end_date.valueOf() - shift * 60 * 1000);\n\t\t\t}\n\t\t}\n\t\treturn new Date(default_date.valueOf());\n\t};\n\tscheduler.getRecDates = function (id, max) {\n\t\tvar ev = typeof id == \"object\" ? id : scheduler.getEvent(id);\n\t\tvar recurrings = [];\n\t\tmax = max || 100;\n\n\t\tif (!isSeries(ev)) {\n\t\t\treturn [\n\t\t\t\t{ start_date: ev.start_date, end_date: ev.end_date }\n\t\t\t];\n\t\t}\n\t\tif (ev.deleted) {\n\t\t\treturn [];\n\t\t}\n\n\t\tscheduler.repeat_date(ev, recurrings, true, ev.start_date, ev.end_date, max);\n\n\t\tvar result = [];\n\t\tfor (var i = 0; i < recurrings.length; i++) {\n\t\t\tif (!recurrings[i].deleted) {\n\t\t\t\tresult.push({ start_date: recurrings[i].start_date, end_date: recurrings[i].end_date });\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\tscheduler.getEvents = function (from, to) {\n\t\tvar result = [];\n\t\tconst exceptions = groupExceptions();\n\t\tfor (var a in this._events) {\n\t\t\tvar ev = this._events[a];\n\t\t\tif (ev.recurring_event_id) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (from && to && ev.start_date < to && ev.end_date > from) {\n\t\t\t\tif (isSeries(ev)) {\n\t\t\t\t\tvar sev = [];\n\t\t\t\t\tthis.repeat_date(ev, sev, true, from, to, undefined, exceptions);\n\t\t\t\t\tsev.forEach(function(occurrence){\n\t\t\t\t\t\tif (occurrence.start_date < to && occurrence.end_date > from) {\n\t\t\t\t\t\t\tresult.push(occurrence);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t// if it's virtual event we can skip it\n\t\t\t\t} else if (!this._is_virtual_event(ev.id)) {\n\t\t\t\t\tresult.push(ev);\n\t\t\t\t}\n\t\t\t} else if (!from && !to && !this._is_virtual_event(ev.id)) {\n\t\t\t\tresult.push(ev);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\n\t//drop secondary attributes\n\tscheduler._copy_dummy = function (ev) {\n\t\tvar start_date = new Date(this.start_date);\n\t\tvar end_date = new Date(this.end_date);\n\t\tthis.start_date = start_date;\n\t\tthis.end_date = end_date;\n\t\tthis.duration = this.rrule = null;\n\t};\n\n\tscheduler.config.include_end_by = false;\n\tscheduler.config.lightbox_recurring = 'ask'; // cancel, instance, this and following, series\n\tscheduler.config.recurring_workdays = [RRule.MO.weekday,RRule.TU.weekday,RRule.WE.weekday,RRule.TH.weekday,RRule.FR.weekday];\n\tscheduler.config.repeat_date = \"%m.%d.%Y\";\n\tscheduler.config.lightbox.sections = [\n\t\t{ name: \"description\", map_to: \"text\", type: \"textarea\", focus: true },\n\t\t{ name: \"recurring\", type: \"recurring\", map_to: \"rrule\" },\n\t\t{ name: \"time\", height: 72, type: \"time\", map_to: \"auto\" }\n\t];\n\n\tscheduler.attachEvent(\"onClearAll\", function () {\n\t\tscheduler._rec_markers = {}; //clear recurring events data\n\t\tscheduler._rec_markers_pull = {};\n\t\tscheduler._rec_temp = [];\n\t});\n\n\n\tfunction getTopLevelOption(rruleObj, untilDate) {\n\t\tconst options = rruleObj.options;\n\t\tconst until = options.until || untilDate;\n\n\t\tconst hasEndCondition = options.count || (until && until.getFullYear() !== 9999);\n\n\t\tif (hasEndCondition) {\n\t\t\treturn 'CUSTOM';\n\t\t}\n\n\t\tif (options.freq === RRule.DAILY && options.interval === 1 && !options.byweekday) {\n\t\t\treturn 'DAILY';\n\t\t} else if (options.freq === RRule.WEEKLY && options.interval === 1 && !options.byweekday) {\n\t\t\treturn 'WEEKLY';\n\t\t} else if (options.freq === RRule.MONTHLY && options.interval === 1 && !options.bysetpos) {\n\t\t\treturn 'MONTHLY';\n\t\t} else if (options.freq === RRule.YEARLY && options.interval === 1 && !options.bysetpos) {\n\t\t\treturn 'YEARLY';\n\t\t} else if (options.freq === RRule.DAILY && options.byweekday && options.byweekday.length === scheduler.config.recurring_workdays.length &&\n\t\t\toptions.byweekday.includes(RRule.MO) &&\n\t\t\toptions.byweekday.includes(RRule.TU) &&\n\t\t\toptions.byweekday.includes(RRule.WE) &&\n\t\t\toptions.byweekday.includes(RRule.TH) &&\n\t\t\toptions.byweekday.includes(RRule.FR)) {\n\t\t\treturn 'WORKDAYS';\n\t\t} else {\n\t\t\treturn 'CUSTOM';\n\t\t}\n\t}\n\t\n\tfunction getWeekdayOfMonth(date) {\n\t\tconst dayOfWeek = date.getDay();\n\t\tconst dayOfMonth = date.getDate();\n\t\tconst dayNumber = Math.ceil(dayOfMonth / 7);\n\t\treturn { dayOfWeek, dayNumber };\n\t}\n\n\n\tconst jsDaysToRRULEDays = {\n\t\t0: \"SU\",\n\t\t1: \"MO\",\n\t\t2: \"TU\",\n\t\t3: \"WE\",\n\t\t4: \"TH\",\n\t\t5: \"FR\",\n\t\t6: \"SA\"\n\t};\n\tconst RruleDayNumsToJs = {\n\t\t0: 1,\n\t\t1: 2,\n\t\t2: 3,\n\t\t3: 4,\n\t\t4: 5,\n\t\t5: 6,\n\t\t6: 0\n\t};\n\n\tfunction fillIntervalInput(node, rule) {\n\t\tconst intervalInput = node.querySelector(\"[name='repeat_interval_value']\");\n\t\tif (intervalInput) {\n\t\t\tintervalInput.value = (rule ? rule.interval : 1) || 1;\n\t\t}\n\t}\n\n\tfunction fillCustomDaily(node, rule) {\n\t\tfillIntervalInput(node, rule);\n\t}\n\n\tfunction fillCustomWeekly(node, rule, event) {\n\t\tfillIntervalInput(node, rule);\n\n\t\tconst dayCheckboxes = node.querySelectorAll(`.dhx_form_repeat_custom_week input`);\n\t\tdayCheckboxes.forEach((ch) => ch.checked = false);\n\t\tif (rule && rule.byweekday) {\n\t\t\trule.byweekday.forEach((day) => {\n\t\t\t\tconst dayNum = RruleDayNumsToJs[day.weekday];\n\t\t\t\tconst dayLabel = jsDaysToRRULEDays[dayNum];\n\t\t\t\tconst checkbox = node.querySelector(`.dhx_form_repeat_custom_week input[value=\"${dayLabel}\"]`);\n\t\t\t\tif(checkbox) {\n\t\t\t\t\tcheckbox.checked = true;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tconst dayLabel = jsDaysToRRULEDays[event.start_date.getDay()];\n\t\t\tconst checkbox = node.querySelector(`.dhx_form_repeat_custom_week input[value=\"${dayLabel}\"]`);\n\t\t\tif(checkbox) {\n\t\t\t\tcheckbox.checked = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction fillCustomMonthly(node, rule, event) {\n\t\tfillIntervalInput(node, rule);\n\n\t\tconst dateOfMonth = node.querySelector(`.dhx_form_repeat_custom_month [value=\"month_date\"]`);\n\t\tconst nthWeekDayOfMonth = node.querySelector(`.dhx_form_repeat_custom_month [value=\"month_nth_weekday\"]`);\n\t\tif(dateOfMonth && nthWeekDayOfMonth){\n\t\t\tdateOfMonth.innerText = scheduler.templates.repeat_monthly_date(event.start_date, event);\n\t\t\tnthWeekDayOfMonth.innerText = scheduler.templates.repeat_monthly_weekday(event.start_date, event);\n\t\t\t\n\t\t\tconst option = node.querySelector(`[name=\"dhx_custom_month_option\"]`);\n\t\t\tif (option) {\n\t\t\t\toption.value = (rule && rule.bysetpos && !(rule.byweekday && rule.byweekday.length)) ? \"month_date\" : \"month_nth_weekday\";\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction formatDayNumber(date){\n\t\tswitch (date) {\n\t\t\tcase 1:\n\t\t\tcase 31:\n\t\t\t\treturn `${date}st`;\n\t\t\tcase 2:\n\t\t\t\treturn `${date}nd`;\n\t\t\tcase 3:\n\t\t\t\treturn `${date}rd`;\n\t\t\tdefault:\n\t\t\t\treturn `${date}th`;\n\t\t}\n\t}\n\n\tscheduler.templates.repeat_monthly_date = function(startDate, event) {\n\t\tconst date = startDate.getDate();\n\t\treturn `Every ${formatDayNumber(date)}`;\n\t};\n\tscheduler.templates.repeat_monthly_weekday = function(startDate, event) {\n\t\tconst nthDayOfMonth = getWeekdayOfMonth(startDate);\n\t\treturn `Every ${formatDayNumber(nthDayOfMonth.dayNumber)} ${scheduler.locale.date.day_full[nthDayOfMonth.dayOfWeek]}`;\n\t};\n\t\n\tscheduler.templates.repeat_yearly_month_date = function(startDate, event) {\n\t\tconst date = startDate.getDate();\n\t\tconst monthLabel = scheduler.locale.date.month_full[startDate.getMonth()];\n\t\treturn `Every ${formatDayNumber(date)} day of ${monthLabel}`;\n\t};\n\tscheduler.templates.repeat_yearly_month_weekday = function(startDate, event) {\n\t\tconst nthDayOfMonth = getWeekdayOfMonth(startDate);\n\t\tconst monthLabel = scheduler.locale.date.month_full[startDate.getMonth()];\n\t\treturn `Every ${formatDayNumber(nthDayOfMonth.dayNumber)} ${scheduler.locale.date.day_full[nthDayOfMonth.dayOfWeek]} of ${monthLabel}`;\n\t};\n\n\tfunction fillCustomYearly(node, rule, event) {\n\t\tconst dateOfYear = node.querySelector(`.dhx_form_repeat_custom_year [value=\"month_date\"]`);\n\t\tconst nthWeekDayOfYear = node.querySelector(`.dhx_form_repeat_custom_year [value=\"month_nth_weekday\"]`);\n\t\tif(dateOfYear && nthWeekDayOfYear){\n\t\t\tdateOfYear.innerText = scheduler.templates.repeat_yearly_month_date(event.start_date, event);\n\t\t\tnthWeekDayOfYear.innerText = scheduler.templates.repeat_yearly_month_weekday(event.start_date, event);\n\n\t\t\tif (!rule || (rule.bysetpos && !(rule.byweekday && rule.byweekday.length))) {\n\t\t\t\tnode.querySelector(`[name=\"dhx_custom_year_option\"]`).value = \"month_date\";\n\t\t\t} else {\n\t\t\t\tnode.querySelector(`[name=\"dhx_custom_year_option\"]`).value = \"month_nth_weekday\";\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction fillEndRule(node, rule, event) {\n\t\tconst countInput = node.querySelector(`.dhx_form_repeat_ends_extra [name=\"dhx_form_repeat_ends_after\"]`);\n\t\tconst ondateInput = node.querySelector(`.dhx_form_repeat_ends_extra [name=\"dhx_form_repeat_ends_ondate\"]`);\n\t\tconst endOptionSelect = node.querySelector(`[name='dhx_custom_repeat_ends']`);\n\n\t\tif(countInput && ondateInput && endOptionSelect){\n\t\t\tcountInput.value = 1;\n\n\t\t\tlet formatter = scheduler.date.date_to_str(\"%Y-%m-%d\");\n\t\t\tif (!scheduler.config.repeat_date_of_end) {\n\t\t\t\tscheduler.config.repeat_date_of_end = formatter(scheduler.date.add(scheduler._currentDate(), 30, \"day\"));\n\t\t\t}\n\t\t\tondateInput.value = scheduler.config.repeat_date_of_end;\n\n\t\t\tif (rule && rule.count) {\n\t\t\t\tendOptionSelect.value = \"AFTER\";\n\t\t\t\tcountInput.value = rule.count;\n\t\t\t} else if (event._end_date && event._end_date.getFullYear() !== 9999) {\n\t\t\t\tendOptionSelect.value = \"ON\";\n\t\t\t\tondateInput.value = formatter(event._end_date);\n\t\t\t} else {\n\t\t\t\tendOptionSelect.value = \"NEVER\";\n\t\t\t}\n\t\t\tendOptionSelect.dispatchEvent(new Event(\"change\"));\n\t\t}\n\t}\n\n\tconst getRecValue = {\n\t\tMONTHLY: function (dates) {\n\t\t\tconst rrule = {\n\t\t\t\tfreq: RRule.MONTHLY,\n\t\t\t\tinterval: 1,\n\t\t\t\tbymonthday: dates.start.getDate()\n\t\t\t};\n\t\t\tconst until = new Date(9999, 1, 1);\n\t\t\treturn {rrule, until};\n\t\t},\n\t\tWEEKLY: function (dates) {\n\t\t\tlet day = dates.start.getDay() - 1;\n\t\t\tif (day == -1) day = 6;\n\t\t\tconst rrule = {\n\t\t\t\tfreq: RRule.WEEKLY,\n\t\t\t\tinterval: 1,\n\t\t\t\tbyweekday: [day]\n\t\t\t};\n\t\t\tconst until = new Date(9999, 1, 1);\n\t\t\treturn {rrule, until};\n\t\t},\n\t\tDAILY: function (dates) {\n\t\t\tconst rrule = {\n\t\t\t\tfreq: RRule.DAILY,\n\t\t\t\tinterval: 1\n\t\t\t};\n\t\t\tconst until = new Date(9999, 1, 1);\n\t\t\treturn {rrule, until};\n\t\t},\n\t\tYEARLY: function (dates) {\n\t\t\tconst rrule = {\n\t\t\t\tfreq: RRule.YEARLY,\n\t\t\t\tbymonth: dates.start.getMonth() + 1,\n\t\t\t\tinterval: 1,\n\t\t\t\tbymonthday: dates.start.getDate()\n\t\t\t};\n\t\t\tconst until = new Date(9999, 1, 1);\n\t\t\treturn {rrule, until};\n\t\t},\n\t\tWORKDAYS: function (dates) {\n\t\t\tconst rrule = {\n\t\t\t\tfreq: RRule.WEEKLY,\n\t\t\t\tinterval: 1,\n\t\t\t\tbyweekday: scheduler.config.recurring_workdays\n\t\t\t};\n\t\t\tconst until = new Date(9999, 1, 1);\n\t\t\treturn {rrule, until};\n\t\t},\n\t\tCUSTOM: function (dates, node) {\n\t\t\tconst rrule = {};\n\t\t\tconst freq = node.querySelector(`[name=\"repeat_interval_unit\"]`).value;\n\t\t\tconst interval = Math.max(1, node.querySelector(`[name=\"repeat_interval_value\"]`).value);\n\t\t\tconst monthRepeat = node.querySelector(`[name=\"dhx_custom_month_option\"]`) ? node.querySelector(`[name=\"dhx_custom_month_option\"]`).value : null;\n\t\t\tconst yearRepeat = node.querySelector(`[name=\"dhx_custom_year_option\"]`) ? node.querySelector(`[name=\"dhx_custom_year_option\"]`).value : null;\n\t\t\trrule.interval = interval;\n\t\t\tlet days;\n\t\t\tlet day;\n\n\t\t\tswitch (freq) {\n\t\t\t\tcase \"DAILY\":\n\t\t\t\t\trrule.freq = RRule.DAILY;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"WEEKLY\": \n\t\t\t\t\trrule.freq = RRule.WEEKLY;\n\t\t\t\t\tdays = [];\n\t\t\t\t\tnode.querySelectorAll(`.dhx_form_repeat_custom_week [name=\"week_day\"]`).forEach((ch) => {\n\t\t\t\t\t\tif(ch.checked){\n\t\t\t\t\t\t\tdays.push(ch.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\trrule.byweekday = days.map((day) => {\n\t\t\t\t\t\tswitch (day) {\n\t\t\t\t\t\t\tcase \"MO\":\n\t\t\t\t\t\t\t\treturn RRule.MO.weekday;\n\t\t\t\t\t\t\tcase \"TU\":\n\t\t\t\t\t\t\t\treturn RRule.TU.weekday;\n\t\t\t\t\t\t\tcase \"WE\":\n\t\t\t\t\t\t\t\treturn RRule.WE.weekday;\n\t\t\t\t\t\t\tcase \"TH\":\n\t\t\t\t\t\t\t\treturn RRule.TH.weekday;\n\t\t\t\t\t\t\tcase \"FR\":\n\t\t\t\t\t\t\t\treturn RRule.FR.weekday;\n\t\t\t\t\t\t\tcase \"SA\":\n\t\t\t\t\t\t\t\treturn RRule.SA.weekday;\n\t\t\t\t\t\t\tcase \"SU\":\n\t\t\t\t\t\t\t\treturn RRule.SU.weekday;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"MONTHLY\":\n\t\t\t\t\trrule.freq = RRule.MONTHLY;\n\t\t\t\t\t\n\t\t\t\t\tif (monthRepeat === \"month_date\") {\n\t\t\t\t\t\trrule.bymonthday = dates.start.getDate();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tday = dates.start.getDay() - 1;\n\t\t\t\t\t\tif (day == -1) day = 6;\n\t\t\t\t\t\trrule.byweekday = [day];\n\t\t\t\t\t\trrule.bysetpos = getWeekdayOfMonth(dates.start).dayNumber;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YEARLY\":\n\t\t\t\t\trrule.freq = RRule.YEARLY;\n\t\t\t\t\trrule.bymonth = dates.start.getMonth() + 1;\n\t\t\t\t\t\n\t\t\t\t\tif (yearRepeat == \"month_date\") {\n\t\t\t\t\t\trrule.bymonthday = dates.start.getDate();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tday = dates.start.getDay() - 1;\n\t\t\t\t\t\tif (day == -1) day = 6;\n\t\t\t\t\t\trrule.byweekday = [day];\n\t\t\t\t\t\trrule.bysetpos = getWeekdayOfMonth(dates.start).dayNumber;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst formatFunc = scheduler.date.str_to_date(\"%Y-%m-%d\");\n\t\t\tlet until = new Date(9999, 1, 1);\n\t\t\tconst endRule = node.querySelector(`[name=\"dhx_custom_repeat_ends\"]`);\n\t\t\tif(endRule && endRule.value === \"ON\"){\n\t\t\t\tuntil = formatFunc(node.querySelector(`[name=\"dhx_form_repeat_ends_ondate\"]`).value);\n\t\t\t\trrule.until = new Date(until);\n\t\t\t} else if(endRule && endRule.value === \"AFTER\") {\n\t\t\t\trrule.count = Math.max(1, node.querySelector(`[name=\"dhx_form_repeat_ends_after\"]`).value);\n\t\t\t}\n\t\t\t\n\t\t\treturn {rrule, until};\n\t\t},\n\t\tNEVER: function () {\n\t\t}\n\t};\n\n\tfunction fillInDefaults(node, rule, event) {\n\t\tfillCustomDaily(node, rule, event);\n\t\tfillCustomWeekly(node, rule, event);\n\t\tfillCustomMonthly(node, rule, event);\n\t\tfillCustomYearly(node, rule, event);\n\t\tfillEndRule(node, rule, event);\n\t}\n\tscheduler.form_blocks[\"recurring\"] = {\n\t\t_get_node : function(node){\n\t\t\tif (typeof node == \"string\"){\n\t\t\t\tlet element = scheduler._lightbox.querySelector(`#${node}`);\n\t\t\t\tif(!element){\n\t\t\t\t\t// form is detached from lightbox \n\t\t\t\t\t// search globally, won't work in LWC\n\t\t\t\t\telement = document.getElementById(node);\n\t\t\t\t}\n\t\t\t\tnode = element;\n\t\t\t}\n\t\t\tif (node.style.display == 'none')\n\t\t\t\tnode.style.display = \"\";\n\t\t\treturn node;\n\t\t},\n\t\t_outer_html: function(node){\n\t\t\treturn node.outerHTML || getOuterHTML(node);\n\t\n\t\t\t//probably not needed, FF v10- only\n\t\t\tfunction getOuterHTML(n){\n\t\t\t\tvar div = document.createElement('div'), h;\n\t\t\t\tdiv.appendChild( n.cloneNode(true) );\n\t\t\t\th = div.innerHTML;\n\t\t\t\tdiv = null;\n\t\t\t\treturn h;\n\t\t\t}\n\t\t},\n\t\trender: function (sns) {\n\t\t\tif (sns.form) {\n\t\t\t\tlet rec = scheduler.form_blocks[\"recurring\"];\n\t\t\t\tlet form = rec._get_node(sns.form);\n\t\t\t\tlet html = rec._outer_html(form);\n\t\t\t\tform.style.display = 'none';\n\t\t\t\treturn html;\n\t\t\t}\n\t\t\tlet loc = scheduler.locale.labels;\n\n\t\t\treturn `<div class=\"dhx_form_rrule\">\n\t\t<div class=\"dhx_form_repeat_pattern\">\n\t\t\t<select>\n\t\t\t\t<option value=\"NEVER\">${loc.repeat_never}</option>\n\t\t\t\t<option value=\"DAILY\">${loc.repeat_daily}</option>\n\t\t\t\t<option value=\"WEEKLY\">${loc.repeat_weekly}</option>\n\t\t\t\t<option value=\"MONTHLY\">${loc.repeat_monthly}</option>\n\t\t\t\t<option value=\"YEARLY\">${loc.repeat_yearly}</option>\n\t\t\t\t<option value=\"WORKDAYS\">${loc.repeat_workdays}</option>\n\t\t\t\t<option value=\"CUSTOM\">${loc.repeat_custom}</option>\n\t\t\t</select>\n\t\t</div>\n\t\t<div class=\"dhx_form_repeat_custom dhx_hidden\">\n\t\t\t<div class=\"dhx_form_repeat_custom_interval\">\n\t\t\t\t<input name=\"repeat_interval_value\" type=\"number\" min=\"1\">\n\t\t\t\t<select name=\"repeat_interval_unit\">\n\t\t\t\t\t<option value=\"DAILY\">${loc.repeat_freq_day}</option>\n\t\t\t\t\t<option value=\"WEEKLY\">${loc.repeat_freq_week}</option>\n\t\t\t\t\t<option value=\"MONTHLY\">${loc.repeat_freq_month}</option>\n\t\t\t\t\t<option value=\"YEARLY\">${loc.repeat_freq_year}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\n\t\t\t<div class=\"dhx_form_repeat_custom_additional\">\n\t\t\t\t<div class=\"dhx_form_repeat_custom_week dhx_hidden\">\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"MO\" />${loc.day_for_recurring[1]}</label>\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"TU\" />${loc.day_for_recurring[2]}</label>\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"WE\" />${loc.day_for_recurring[3]}</label>\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"TH\" />${loc.day_for_recurring[4]}</label>\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"FR\" />${loc.day_for_recurring[5]}</label>\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"SA\" />${loc.day_for_recurring[6]}</label>\n\t\t\t\t\t<label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"SU\" />${loc.day_for_recurring[0]}</label>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"dhx_form_repeat_custom_month dhx_hidden\">\n\t\t\t\t\t<select name=\"dhx_custom_month_option\">\n\t\t\t\t\t\t<option value=\"month_date\"></option>\n\t\t\t\t\t\t<option value=\"month_nth_weekday\"></option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"dhx_form_repeat_custom_year dhx_hidden\">\n\t\t\t\t\t<select name=\"dhx_custom_year_option\">\n\t\t\t\t\t\t<option value=\"month_date\"></option>\n\t\t\t\t\t\t<option value=\"month_nth_weekday\"></option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"dhx_form_repeat_ends\">\n\t\t\t\t<div>${loc.repeat_ends}</div>\n\t\t\t\t<div class=\"dhx_form_repeat_ends_options\">\n\t\t\t\t\t<select name=\"dhx_custom_repeat_ends\">\n\t\t\t\t\t\t<option value=\"NEVER\">${loc.repeat_never}</option>\n\t\t\t\t\t\t<option value=\"AFTER\">${loc.repeat_radio_end2}</option>\n\t\t\t\t\t\t<option value=\"ON\">${loc.repeat_on_date}</option>\n\t\t\t\t\t</select>\n\t\t\t\t\t<div class=\"dhx_form_repeat_ends_extra\">\n\t\t\t\t\t\t<div class=\"dhx_form_repeat_ends_after dhx_hidden\">\n\t\t\t\t\t\t\t<label><input type=\"number\" min=\"1\" name=\"dhx_form_repeat_ends_after\">${loc.repeat_text_occurrences_count}</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"dhx_form_repeat_ends_on dhx_hidden\">\n\t\t\t\t\t\t\t<input type=\"date\" name=\"dhx_form_repeat_ends_ondate\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\t</div>`;\n\t\t},\n\n\t\n\t\t_init_set_value: function (node, value, event) {\n\t\t\tscheduler.form_blocks[\"recurring\"]._ds = { start: event.start_date, end: event.end_date };\n\t\t\tfunction hide(node) {\n\t\t\t\tif(node) node.classList.add(\"dhx_hidden\");\n\t\t\t}\n\t\t\tfunction show(node) {\n\t\t\t\tif(node) node.classList.remove(\"dhx_hidden\");\n\t\t\t}\n\t\t\tfunction onRepeatOptionChange(value) {\n\t\t\t\tconst repeat = node.querySelector(\".dhx_form_repeat_custom\");\n\t\t\t\tif (value === \"CUSTOM\") {\n\t\t\t\t\tshow(repeat);\n\t\t\t\t} else {\n\t\t\t\t\thide(repeat);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onCustomRepeatIntervalChange(value) {\n\t\t\t\tconst nodes = {\n\t\t\t\t\tweekly: node.querySelector(\".dhx_form_repeat_custom_week\"),\n\t\t\t\t\tmonthly: node.querySelector(\".dhx_form_repeat_custom_month\"),\n\t\t\t\t\tyearly: node.querySelector(\".dhx_form_repeat_custom_year\")\n\t\t\t\t};\n\t\t\t\tswitch (value) {\n\t\t\t\t\tcase \"DAILY\":\n\t\t\t\t\t\thide(nodes.weekly);\n\t\t\t\t\t\thide(nodes.monthly);\n\t\t\t\t\t\thide(nodes.yearly);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"WEEKLY\":\n\t\t\t\t\t\tshow(nodes.weekly);\n\t\t\t\t\t\thide(nodes.monthly);\n\t\t\t\t\t\thide(nodes.yearly);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"MONTHLY\":\n\t\t\t\t\t\thide(nodes.weekly);\n\t\t\t\t\t\tshow(nodes.monthly);\n\t\t\t\t\t\thide(nodes.yearly);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"YEARLY\":\n\t\t\t\t\t\thide(nodes.weekly);\n\t\t\t\t\t\thide(nodes.monthly);\n\t\t\t\t\t\tshow(nodes.yearly);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onCustomRepeatEndRule(value) {\n\t\t\t\tconst nodes = {\n\t\t\t\t\tafter: node.querySelector(\".dhx_form_repeat_ends_extra .dhx_form_repeat_ends_after\"),\n\t\t\t\t\ton: node.querySelector(\".dhx_form_repeat_ends_extra .dhx_form_repeat_ends_on\")\n\t\t\t\t};\n\t\t\t\tswitch (value) {\n\t\t\t\t\tcase \"NEVER\":\n\t\t\t\t\t\thide(nodes.after);\n\t\t\t\t\t\thide(nodes.on);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"AFTER\":\n\t\t\t\t\t\tshow(nodes.after);\n\t\t\t\t\t\thide(nodes.on);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ON\":\n\t\t\t\t\t\thide(nodes.after);\n\t\t\t\t\t\tshow(nodes.on);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// repeat section change\n\t\t\tconst repeatSelect = node.querySelector(\".dhx_form_repeat_pattern select\");\n\t\t\tif(repeatSelect){\n\t\t\t\trepeatSelect.addEventListener(\"change\", function () {\n\t\t\t\t\tonRepeatOptionChange(this.value);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\t\n\t\t\t// custom repeat interval change\n\t\t\tconst customRepeatUnitInput = node.querySelector(\".dhx_form_repeat_custom_interval [name='repeat_interval_unit']\");\n\t\t\tif(customRepeatUnitInput){\n\t\t\t\tcustomRepeatUnitInput.addEventListener(\"change\", function () {\n\t\t\t\t\tonCustomRepeatIntervalChange(this.value);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// custom repeat end rule\n\t\t\tconst customRepeatEndInput = node.querySelector(\".dhx_form_repeat_ends [name='dhx_custom_repeat_ends']\");\n\t\t\tif(customRepeatEndInput){\n\t\t\t\tcustomRepeatEndInput.addEventListener(\"change\", function () {\n\t\t\t\t\tonCustomRepeatEndRule(this.value);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tscheduler._lightbox._rec_init_done = true;\n\t\t},\n\t\tbutton_click: function(){},\n\t\tset_value: function (node, value, ev) {\n\t\t\tlet rf = scheduler.form_blocks[\"recurring\"];\n\t\t\tif (!scheduler._lightbox._rec_init_done)\n\t\t\t\trf._init_set_value(node, value, ev);\n\t\t\tnode.open = !ev.rrule;\n\n\t\t\tnode.blocked = this._is_modified_occurrence(ev);\n\n\t\t\tlet ds = rf._ds;\n\t\t\tds.start = ev.start_date;\n\t\t\tds.end = ev._end_date;\n\n\t\t\tif (ev.rrule) {\n\t\t\t\tconst rruleset = rrulestr(ev.rrule);\n\t\t\t\tfillInDefaults(node, rruleset.origOptions, ev);\n\t\t\t\tconst topOption = getTopLevelOption(rruleset, ev._end_date);\n\t\t\t\tnode.querySelector(\".dhx_form_repeat_pattern select\").value = topOption;\n\t\t\t\tif(topOption === \"CUSTOM\"){\n\t\t\t\t\tlet customFreq;\n\t\t\t\t\tswitch (rruleset.origOptions.freq) {\n\t\t\t\t\t\tcase RRule.DAILY:\n\t\t\t\t\t\t\tcustomFreq = \"DAILY\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase RRule.WEEKLY:\n\t\t\t\t\t\t\tcustomFreq = \"WEEKLY\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase RRule.MONTHLY:\n\t\t\t\t\t\t\tcustomFreq = \"MONTHLY\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase RRule.YEARLY:\n\t\t\t\t\t\t\tcustomFreq = \"YEARLY\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(customFreq){\n\t\t\t\t\t\tnode.querySelector(`[name=\"repeat_interval_unit\"]`).value = customFreq;\n\t\t\t\t\t\tnode.querySelector(`[name=\"repeat_interval_unit\"]`).dispatchEvent(new Event(\"change\"));\n\t\t\t\t\t}\n\t\t\t\t//\trepeat_interval_unit\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else{\n\t\t\t\tfillInDefaults(node, null, ev);\n\t\t\t\tconst repeatSelect = node.querySelector(\".dhx_form_repeat_pattern select\");\n\t\t\t\tif(repeatSelect) {\n\t\t\t\t\trepeatSelect.value = \"NEVER\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst repeatSelect = node.querySelector(\".dhx_form_repeat_pattern select\");\n\t\t\tif(repeatSelect) {\n\t\t\t\trepeatSelect.dispatchEvent(new Event(\"change\"));\n\t\t\t} \n\n\t\t},\n\t\tget_value: function (node, ev) {\n\t\t\tconst repeatSelect = node.querySelector(\".dhx_form_repeat_pattern select\");\n\t\t\tif(!node.blocked && (!repeatSelect || repeatSelect.value !== \"NEVER\") ) {\n\t\t\t\tlet ds = scheduler.form_blocks[\"recurring\"]._ds;\n\t\t\t\tlet actual_dates = {};\n\n\t\t\t\tlet timeControl = getTimeSection();\n\n\t\t\t\ttimeControl.getValue(actual_dates);\n\t\t\t\tds.start = actual_dates.start_date;\n\t\t\t\tconst pattern = repeatSelect ? repeatSelect.value : \"CUSTOM\";\n\t\t\t\tconst recurrence = getRecValue[pattern](ds, node);\n\t\t\t\tev.rrule = new RRule(recurrence.rrule).toString().replace(\"RRULE:\", \"\");\n\t\t\t\tds.end = recurrence.until;\n\n\t\t\t\tev.duration = Math.floor((actual_dates.end_date - actual_dates.start_date) / 1000);\n\n\t\t\t\tif (ds._start) {\n\t\t\t\t\tev.start_date = new Date(ds.start);\n\t\t\t\t\tev._start_date = new Date(ds.start);\n\t\t\t\t\tds._start = false;\n\t\t\t\t} else\n\t\t\t\t\tev._start_date = null;\n\n\t\t\t\tev._end_date = ds.end;\n\t\t\t}else{\n\t\t\t\tev.rrule = ev.rrule = \"\";\n\t\t\t\tev._end_date = ev.end_date;\n\t\t\t}\n\n\t\t\treturn ev.rrule;\n\t\t},\n\n\t\tfocus: function (node) {\n\t\t}\n\t};\n\n\tfunction getTimeSection() {\n\t\tlet timeControl = scheduler.formSection('time');\n\t\tif (!timeControl) {\n\t\t\ttimeControl = getFirstSectionOfType('time');\n\t\t}\n\t\tif (!timeControl) {\n\t\t\ttimeControl = getFirstSectionOfType('calendar_time');\n\t\t}\n\n\n\t\tif (!timeControl) {\n\t\t\tthrow new Error([\"Can't calculate the recurring rule, the Recurring form block can't find the Time control. Make sure you have the time control in 'scheduler.config.lightbox.sections' config.\",\n\t\t\t\t\"You can use either the default time control https://docs.dhtmlx.com/scheduler/time.html, or the datepicker https://docs.dhtmlx.com/scheduler/minicalendar.html, or a custom control. \",\n\t\t\t\t\"In the latter case, make sure the control is named \\\"time\\\":\",\n\t\t\t\t\"\",\n\t\t\t\t\"scheduler.config.lightbox.sections = [\",\n\t\t\t\t\"{name:\\\"time\\\", height:72, type:\\\"YOU CONTROL\\\", map_to:\\\"auto\\\" }];\"]\n\t\t\t\t.join(\"\\n\"));\n\t\t}\n\n\t\treturn timeControl;\n\t}\n\n\tfunction getFirstSectionOfType(type) {\n\t\tfor (let i = 0; i < scheduler.config.lightbox.sections.length; i++) {\n\t\t\tlet section = scheduler.config.lightbox.sections[i];\n\t\t\tif (section.type === type) {\n\t\t\t\treturn scheduler.formSection(section.name);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n}","export default function(scheduler){\n\nscheduler.config.occurrence_timestamp_in_utc = false;\nscheduler.config.recurring_workdays = [1,2,3,4,5];\nscheduler.form_blocks[\"recurring\"] = {\n\t_get_node : function(node){\n\t\tif (typeof node == \"string\"){\n\t\t\tlet element = scheduler._lightbox.querySelector(`#${node}`);\n\t\t\tif(!element){\n\t\t\t\t// form is detached from lightbox \n\t\t\t\t// search globally, won't work in LWC\n\t\t\t\telement = document.getElementById(node);\n\t\t\t}\n\t\t\tnode = element;\n\t\t}\n\t\tif (node.style.display == 'none')\n\t\t\tnode.style.display = \"\";\n\t\treturn node;\n\t},\n\t_outer_html: function(node){\n\t\treturn node.outerHTML || getOuterHTML(node);\n\n\t\t//probably not needed, FF v10- only\n\t\tfunction getOuterHTML(n){\n\t\t\tvar div = document.createElement('div'), h;\n\t\t\tdiv.appendChild( n.cloneNode(true) );\n\t\t\th = div.innerHTML;\n\t\t\tdiv = null;\n\t\t\treturn h;\n\t\t}\n\t},\n\trender:function(sns) {\n\t\tif(sns.form){\n\t\t\tvar rec = scheduler.form_blocks[\"recurring\"];\n\t\t\tvar form = rec._get_node(sns.form);\n\t\t\tvar html = rec._outer_html(form);\n\t\t\tform.style.display = 'none';\n\t\t\treturn html;\n\t\t}\n\t\tvar loc = scheduler.locale.labels;\n\t\treturn '<div class=\"dhx_form_repeat\"> '+\n\t\t\t\t\t'<form> '+\n\t\t\t\t\t\t'<div class=\"dhx_repeat_left\"> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"repeat\" value=\"day\" />'+loc.repeat_radio_day+'</label></div> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"repeat\" value=\"week\"/>'+loc.repeat_radio_week+'</label></div> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"repeat\" value=\"month\" checked />'+loc.repeat_radio_month+'</label></div> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"repeat\" value=\"year\" />'+loc.repeat_radio_year+'</label></div> '+\n\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t'<div class=\"dhx_repeat_divider\">'+\n\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t'<div class=\"dhx_repeat_center\"> '+\n\t\t\t\t\t\t\t'<div style=\"display:none;\" id=\"dhx_repeat_day\"> '+\n\t\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"day_type\" value=\"d\"/>'+loc.repeat_radio_day_type+'</label>'+\n\t\t\t\t\t\t\t\t'<label><input class=\"dhx_repeat_text\" type=\"text\" name=\"day_count\" value=\"1\" />'+loc.repeat_text_day_count+'</label></div> '+\n\t\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"day_type\" checked value=\"w\"/>'+loc.repeat_radio_day_type2+'</label></div> '+\n\t\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t\t'<div style=\"display:none;\" id=\"dhx_repeat_week\">'+\n\t\t\t\t\t\t\t\t'<div><label>'+loc.repeat_week+'<input class=\"dhx_repeat_text\" type=\"text\" name=\"week_count\" value=\"1\" /></label>'+\n\t\t\t\t\t\t\t\t'<span>'+loc.repeat_text_week_count+'</span></div>  '+\n\t\t\t\t\t\t\t\t'<table class=\"dhx_repeat_days\"> '+\n\t\t\t\t\t\t\t\t\t'<tr> '+\n\t\t\t\t\t\t\t\t\t\t'<td><div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"1\" />'+loc.day_for_recurring[1]+'</label></div> '+\n\t\t\t\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"4\" />'+loc.day_for_recurring[4]+'</label></div></td> '+\n\t\t\t\t\t\t\t\t\t\t'<td><div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"2\" />'+loc.day_for_recurring[2]+'</label></div> '+\n\t\t\t\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"5\" />'+loc.day_for_recurring[5]+'</label></div></td> '+\n\t\t\t\t\t\t\t\t\t\t'<td><div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"3\" />'+loc.day_for_recurring[3]+'</label></div> '+\n\t\t\t\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"6\" />'+loc.day_for_recurring[6]+'</label></div></td> '+\n\t\t\t\t\t\t\t\t\t\t'<td><div><label><input class=\"dhx_repeat_checkbox\" type=\"checkbox\" name=\"week_day\" value=\"0\" />'+loc.day_for_recurring[0]+'</label></div> </td> '+\n\t\t\t\t\t\t\t\t\t'</tr> '+\n\t\t\t\t\t\t\t\t'</table> '+\n\t\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t\t'<div id=\"dhx_repeat_month\"> '+\n\t\t\t\t\t\t\t\t'<div><label class = \"dhx_repeat_month_label\"><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"month_type\" value=\"d\"/>'+loc.repeat_radio_month_type+'</label>'+\n\t\t\t\t\t\t\t\t\t'<label><input class=\"dhx_repeat_text\" type=\"text\" name=\"month_day\" value=\"1\" />'+loc.repeat_text_month_day+'</label>'+\n\t\t\t\t\t\t\t\t\t'<label><input class=\"dhx_repeat_text\" type=\"text\" name=\"month_count\" value=\"1\" />'+loc.repeat_text_month_count+'</label></div> '+\n\t\t\t\t\t\t\t\t\t'<div><label class = \"dhx_repeat_month_label\"><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"month_type\" checked value=\"w\"/>'+loc.repeat_radio_month_start+'</label>'+\n\t\t\t\t\t\t\t\t\t'<input class=\"dhx_repeat_text\" type=\"text\" name=\"month_week2\" value=\"1\" />'+\n\t\t\t\t\t\t\t\t\t'<label>'+\n\t\t\t\t\t\t\t\t\t\t'<select name=\"month_day2\">'+\n\t\t\t\t\t\t\t\t\t\t'\t<option value=\"1\" selected >'+scheduler.locale.date.day_full[1]+\n\t\t\t\t\t\t\t\t\t\t\t'<option value=\"2\">'+scheduler.locale.date.day_full[2]+\n\t\t\t\t\t\t\t\t\t\t\t'<option value=\"3\">'+scheduler.locale.date.day_full[3]+\n\t\t\t\t\t\t\t\t\t\t\t'<option value=\"4\">'+scheduler.locale.date.day_full[4]+\n\t\t\t\t\t\t\t\t\t\t\t'<option value=\"5\">'+scheduler.locale.date.day_full[5]+\n\t\t\t\t\t\t\t\t\t\t\t'<option value=\"6\">'+scheduler.locale.date.day_full[6]+\n\t\t\t\t\t\t\t\t\t\t\t'<option value=\"0\">'+scheduler.locale.date.day_full[0]+\n\t\t\t\t\t\t\t\t\t\t'</select>'+\n\t\t\t\t\t\t\t\t\t\tloc.repeat_text_month_count2_before+\n\t\t\t\t\t\t\t\t\t'</label>'+\n\t\t\t\t\t\t\t\t\t'<label><input class=\"dhx_repeat_text\" type=\"text\" name=\"month_count2\" value=\"1\" />'+loc.repeat_text_month_count2_after+'</label></div> '+\n\t\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t\t'<div style=\"display:none;\" id=\"dhx_repeat_year\"> '+\n\t\t\t\t\t\t\t\t'<div><label class = \"dhx_repeat_year_label\"><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"year_type\" value=\"d\"/>'+loc.repeat_radio_day_type+'</label>'+\n\t\t\t\t\t\t\t\t'<label><input class=\"dhx_repeat_text\" type=\"text\" name=\"year_day\" value=\"1\" />'+loc.repeat_text_year_day+'</label>'+\n\t\t\t\t\t\t\t\t'<label>'+\n\t\t\t\t\t\t\t\t\t'<select name=\"year_month\">'+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"0\" selected >'+loc.month_for_recurring[0]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"1\">'+loc.month_for_recurring[1]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"2\">'+loc.month_for_recurring[2]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"3\">'+loc.month_for_recurring[3]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"4\">'+loc.month_for_recurring[4]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"5\">'+loc.month_for_recurring[5]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"6\">'+loc.month_for_recurring[6]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"7\">'+loc.month_for_recurring[7]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"8\">'+loc.month_for_recurring[8]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"9\">'+loc.month_for_recurring[9]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"10\">'+loc.month_for_recurring[10]+\n\t\t\t\t\t\t\t\t\t\t'<option value=\"11\">'+loc.month_for_recurring[11]+\n\t\t\t\t\t\t\t\t\t'</select>'+\n\t\t\t\t\t\t\t\t\tloc.select_year_month+\n\t\t\t\t\t\t\t\t'</label></div> '+\n\t\t\t\t\t\t\t\t'<div><label class = \"dhx_repeat_year_label\"><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"year_type\" checked value=\"w\"/>'+loc.repeat_year_label+'</label>'+\n\t\t\t\t\t\t\t\t'<input class=\"dhx_repeat_text\" type=\"text\" name=\"year_week2\" value=\"1\" />'+\n\t\t\t\t\t\t\t\t'<select name=\"year_day2\">'+\n\t\t\t\t\t\t\t\t\t'<option value=\"1\" selected >'+scheduler.locale.date.day_full[1]+\n\t\t\t\t\t\t\t\t\t'<option value=\"2\">'+scheduler.locale.date.day_full[2]+\n\t\t\t\t\t\t\t\t\t'<option value=\"3\">'+scheduler.locale.date.day_full[3]+\n\t\t\t\t\t\t\t\t\t'<option value=\"4\">'+scheduler.locale.date.day_full[4]+\n\t\t\t\t\t\t\t\t\t'<option value=\"5\">'+scheduler.locale.date.day_full[5]+\n\t\t\t\t\t\t\t\t\t'<option value=\"6\">'+scheduler.locale.date.day_full[6]+\n\t\t\t\t\t\t\t\t\t'<option value=\"7\">'+scheduler.locale.date.day_full[0]+\n\t\t\t\t\t\t\t\t'</select>'+\n\t\t\t\t\t\t\t\tloc.select_year_day2+\n\t\t\t\t\t\t\t\t'<select name=\"year_month2\">'+\n\t\t\t\t\t\t\t\t\t'<option value=\"0\" selected >'+loc.month_for_recurring[0]+\n\t\t\t\t\t\t\t\t\t'<option value=\"1\">'+loc.month_for_recurring[1]+\n\t\t\t\t\t\t\t\t\t'<option value=\"2\">'+loc.month_for_recurring[2]+\n\t\t\t\t\t\t\t\t\t'<option value=\"3\">'+loc.month_for_recurring[3]+\n\t\t\t\t\t\t\t\t\t'<option value=\"4\">'+loc.month_for_recurring[4]+\n\t\t\t\t\t\t\t\t\t'<option value=\"5\">'+loc.month_for_recurring[5]+\n\t\t\t\t\t\t\t\t\t'<option value=\"6\">'+loc.month_for_recurring[6]+\n\t\t\t\t\t\t\t\t\t'<option value=\"7\">'+loc.month_for_recurring[7]+\n\t\t\t\t\t\t\t\t\t'<option value=\"8\">'+loc.month_for_recurring[8]+\n\t\t\t\t\t\t\t\t\t'<option value=\"9\">'+loc.month_for_recurring[9]+\n\t\t\t\t\t\t\t\t\t'<option value=\"10\">'+loc.month_for_recurring[10]+\n\t\t\t\t\t\t\t\t\t'<option value=\"11\">'+loc.month_for_recurring[11]+\n\t\t\t\t\t\t\t\t'</select></div> '+\n\t\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t'<div class=\"dhx_repeat_divider\">'+\n\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t\t'<div class=\"dhx_repeat_right\"> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"end\" checked/>'+loc.repeat_radio_end+'</label></div> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"end\" />'+loc.repeat_radio_end2+'</label>'+\n\t\t\t\t\t\t\t'<input class=\"dhx_repeat_text\" type=\"text\" name=\"occurences_count\" value=\"1\" />'+loc.repeat_text_occurences_count+'</div> '+\n\t\t\t\t\t\t\t'<div><label><input class=\"dhx_repeat_radio\" type=\"radio\" name=\"end\" />'+loc.repeat_radio_end3+'</label>'+\n\t\t\t\t\t\t\t'<input class=\"dhx_repeat_date\" type=\"text\" name=\"date_of_end\" value=\"'+scheduler.config.repeat_date_of_end+'\" /></div> '+\n\t\t\t\t\t\t'</div> '+\n\t\t\t\t\t'</form> '+\n\t\t\t\t'</div> '+\n\t\t\t\t'</div>';\n\t},\n\t_ds: {},\n\t_get_form_node: function(els, name, value){\n\t\tvar col = els[name];\n\t\tif(!col) return null;\n\t\tif(col.nodeName) return col;\n\n\t\tif(col.length){\n\t\t\tfor(var i=0; i < col.length; i++){\n\t\t\t\tif(col[i].value == value)\n\t\t\t\t\treturn col[i];\n\t\t\t}\n\t\t}\n\t},\n\t_get_node_value: function(els, name, multiselect){\n\t\tvar col = els[name];\n\t\tif(!col) return \"\";\n\t\tif(col.length){\n\t\t\tif(multiselect){\n\t\t\t\tvar res = [];\n\t\t\t\tfor (var i = 0; i < col.length; i++)\n\t\t\t\t\tif (col[i].checked) res.push(col[i].value);\n\n\t\t\t\treturn res;\n\t\t\t}else{\n\t\t\t\tfor (var i = 0; i < col.length; i++)\n\t\t\t\t\tif (col[i].checked) return col[i].value;\n\t\t\t}\n\t\t}\n\n\t\tif(col.value)\n\t\t\treturn !multiselect ? col.value : [col.value];\n\t},\n\n\t_get_node_numeric_value: function(els, name){\n\t\tvar value = scheduler.form_blocks[\"recurring\"]._get_node_value(els, name);\n\t\treturn ((value * 1) || 0);\n\t},\n\n\t_set_node_value: function(els, name, value){\n\t\tvar col = els[name];\n\t\tif(!col) return;\n\n\t\tif(col.name == name){\n\t\t\tcol.value = value;\n\t\t}else if(col.length){\n\t\t\tvar hash_value = typeof value == \"object\";\n\t\t\tfor (var i = 0; i < col.length; i++)\n\t\t\t\tif (hash_value || col[i].value == value){\n\t\t\t\t\tcol[i].checked = hash_value ? !!value[col[i].value] : !!value;\n\t\t\t\t}\n\t\t}\n\t},\n\n\t_init_set_value:function(node, value, ev) {\n\t\tvar block = scheduler.form_blocks[\"recurring\"];\n\t\tvar get_value = block._get_node_value;\n\t\tvar set_value = block._set_node_value;\n\t\tscheduler.form_blocks[\"recurring\"]._ds = {start:ev.start_date, end:ev._end_date};\n\n\t\tvar str_date_format = scheduler.date.str_to_date(scheduler.config.repeat_date, false, true);\n\t\tvar str_date = function(str_date) {\n\t\t\tvar date = str_date_format(str_date);\n\t\t\tif (scheduler.config.include_end_by)\n\t\t\t\tdate = scheduler.date.add(date, 1, 'day');\n\t\t\treturn date;\n\t\t};\n\n\t\tvar date_str = scheduler.date.date_to_str(scheduler.config.repeat_date);\n\n\t\tvar top = node.getElementsByTagName(\"FORM\")[0];\n\t\tvar els = {};\n\n\t\tfunction register_els(inps) {\n\t\t\tfor (var i = 0; i < inps.length; i++) {\n\t\t\t\tvar inp = inps[i];\n\n\t\t\t\tif(inp.name){\n\t\t\t\t\tif(!els[inp.name]){\n\t\t\t\t\t\tels[inp.name] = inp;\n\t\t\t\t\t}else if(els[inp.name].nodeType){\n\t\t\t\t\t\tvar node = els[inp.name];\n\t\t\t\t\t\tels[inp.name] = [node, inp];\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tels[inp.name].push(inp);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tregister_els(top.getElementsByTagName(\"INPUT\"));\n\t\tregister_els(top.getElementsByTagName(\"SELECT\"));\n\n\t\tif (!scheduler.config.repeat_date_of_end) {\n\t\t\tvar formatter = scheduler.date.date_to_str(scheduler.config.repeat_date);\n\t\t\tscheduler.config.repeat_date_of_end = formatter(scheduler.date.add(scheduler._currentDate(), 30, \"day\"));\n\t\t}\n\t\tset_value(els, \"date_of_end\", scheduler.config.repeat_date_of_end);\n\n\t\tvar $ = function(a) {\n\t\t\treturn scheduler._lightbox.querySelector(`#${a}`) || { style:{} };//return fake object if node not found\n\t\t};\n\n\t\tfunction change_current_view() {\n\t\t\t$(\"dhx_repeat_day\").style.display = \"none\";\n\t\t\t$(\"dhx_repeat_week\").style.display = \"none\";\n\t\t\t$(\"dhx_repeat_month\").style.display = \"none\";\n\t\t\t$(\"dhx_repeat_year\").style.display = \"none\";\n\t\t\t$(\"dhx_repeat_\" + this.value).style.display = \"\";\n\t\t\tscheduler.setLightboxSize();\n\t\t}\n\n\t\tfunction get_repeat_code(dates) {\n\t\t\tvar code = [get_value(els, \"repeat\")];\n\t\t\tget_rcode[code[0]](code, dates);\n\n\t\t\twhile (code.length < 5) code.push(\"\");\n\t\t\tvar repeat = \"\";\n\n\t\t\tvar end = get_end_rule(els);\n\n\t\t\tif (end == \"no\") {\n\t\t\t\tdates.end = new Date(9999, 1, 1);\n\t\t\t\trepeat = \"no\";\n\t\t\t}\n\t\t\telse if (end == \"date_of_end\") {\n\t\t\t\tdates.end = str_date(get_value(els, \"date_of_end\"));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tscheduler.transpose_type(code.join(\"_\"));\n\t\t\t\trepeat = Math.max(1, get_value(els, \"occurences_count\"));\n\n\t\t\t\tvar transp = 0;\n\n\t\t\t\t//var transp = ((code[0] == \"week\" && code[4] && code[4].toString().indexOf(scheduler.config.start_on_monday ? 1 : 0) == -1) ? 1 : 0);\n\n\t\t\t\t// which is equal to following code, seems to produce extra instance, not clear why needed\n\n\t\t\t\t/*if(code[0] == \"week\"){\n\t\t\t\t\tvar days = code[4] || \"\";\n\t\t\t\t\tif(scheduler.config.start_on_monday){\n\t\t\t\t\t\tif(days.indexOf(1) == -1)\n\t\t\t\t\t\ttransp = 1;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(days.indexOf(0) == -1)\n\t\t\t\t\t\ttransp = 1;\n\t\t\t\t\t}\n\t\t\t\t}*/\n\n\t\t\t//\tdates.end = scheduler.date.add(new Date(dates.start), repeat + transp, code.join(\"_\"));\n\n\t\t\t\tdates.end = scheduler.date[\"add_\" + code.join(\"_\")](new Date(dates.start), repeat + transp, {start_date: dates.start}) || dates.start;\n\t\t\t}\n\n\t\t\treturn code.join(\"_\") + \"#\" + repeat;\n\t\t}\n\t\tfunction get_end_rule(els){\n\t\t\tvar end = els[\"end\"];\n\t\t\tif(end.length){\n\t\t\t\tfor(var i =0; i < end.length; i++){\n\t\t\t\t\tif(end[i].checked){\n\t\t\t\t\t\tif(end[i].value && end[i].value != \"on\"){//seems to be default value:var input = document.createElement(\"input\"); input.type = \"radio\"; input.value\n\t\t\t\t\t\t\treturn end[i].value;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif(!i){\n\t\t\t\t\t\t\t\treturn \"no\";\n\t\t\t\t\t\t\t}else if(i == 2){\n\t\t\t\t\t\t\t\treturn \"date_of_end\";\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\treturn \"occurences_count\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(end.value)\n\t\t\t\t\treturn end.value;\n\t\t\t}\n\t\t\treturn \"no\";\n\t\t}\n\t\tfunction set_end_rule(els, value){\n\t\t\tvar end = els[\"end\"];\n\n\t\t\tif(end.length){\n\t\t\t\tvar has_values = !!end[0].value && end[0].value != \"on\";\n\t\t\t\tif(has_values){\n\t\t\t\t\tfor(var i =0; i < end.length; i++){\n\t\t\t\t\t\tif(end[i].value == value)\n\t\t\t\t\t\t\tend[i].checked = true;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tvar ind = 0;\n\t\t\t\t\tswitch(value){\n\t\t\t\t\t\tcase \"no\":\n\t\t\t\t\t\t\tind = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"date_of_end\":\n\t\t\t\t\t\t\tind = 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tind = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tend[ind].checked = true;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tend.value = value;\n\t\t\t}\n\t\t}\n\n\n\t\tscheduler.form_blocks[\"recurring\"]._get_repeat_code = get_repeat_code;\n\t\tvar get_rcode = {\n\t\t\tmonth:function(code, dates) {\n\t\t\t\tvar get_value = scheduler.form_blocks[\"recurring\"]._get_node_value;\n\t\t\t\tvar get_numeric_value = scheduler.form_blocks[\"recurring\"]._get_node_numeric_value;\n\n\t\t\t\tif (get_value(els, \"month_type\") == \"d\") {\n\t\t\t\t\tcode.push(Math.max(1, get_numeric_value(els, \"month_count\")));\n\t\t\t\t\tdates.start.setDate(get_value(els, \"month_day\"));\n\t\t\t\t} else {\n\t\t\t\t\tcode.push(Math.max(1, get_numeric_value(els, \"month_count2\")));\n\t\t\t\t\tcode.push( get_value(els, \"month_day2\"));\n\t\t\t\t\tcode.push(Math.max(1, get_numeric_value(els, \"month_week2\")));\n\t\t\t\t\tif (!scheduler.config.repeat_precise){\n\t\t\t\t\t\tdates.start.setDate(1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdates._start = true;\n\t\t\t},\n\t\t\tweek:function(code, dates) {\n\t\t\t\tvar get_value = scheduler.form_blocks[\"recurring\"]._get_node_value;\n\t\t\t\tvar get_numeric_value = scheduler.form_blocks[\"recurring\"]._get_node_numeric_value;\n\n\t\t\t\tcode.push(Math.max(1, get_numeric_value(els, \"week_count\")));\n\t\t\t\tcode.push(\"\");\n\t\t\t\tcode.push(\"\");\n\t\t\t\tvar t = [];\n\n\t\t\t\tvar col = get_value(els, \"week_day\", true);\n\t\t\t\t//var col = els[\"week_day\"];\n\t\t\t\tvar day = dates.start.getDay();\n\t\t\t\tvar start_exists = false;\n\n\t\t\t\tfor (var i = 0; i < col.length; i++){\n\t\t\t\t\tt.push(col[i]);\n\t\t\t\t\tstart_exists = start_exists || col[i] == day;\n\t\t\t\t}\n\t\t\t\tif (!t.length){\n\t\t\t\t\tt.push(day);\n\t\t\t\t\tstart_exists = true;\n\t\t\t\t}\n\t\t\t\tt.sort();\n\n\n\t\t\t\tif (!scheduler.config.repeat_precise){\n\t\t\t\t\tdates.start = scheduler.date.week_start(dates.start);\n\t\t\t\t\tdates._start = true;\n\t\t\t\t} else if (!start_exists){\n\t\t\t\t\tscheduler.transpose_day_week(dates.start, t, 1, 7);\n\t\t\t\t\tdates._start = true;\n\t\t\t\t}\n\n\t\t\t\tcode.push(t.join(\",\"));\n\t\t\t},\n\t\t\tday:function(code) {\n\t\t\t\tvar get_value = scheduler.form_blocks[\"recurring\"]._get_node_value;\n\t\t\t\tvar get_numeric_value = scheduler.form_blocks[\"recurring\"]._get_node_numeric_value;\n\n\t\t\t\tif (get_value(els, \"day_type\") == \"d\") {\n\t\t\t\t\tcode.push(Math.max(1, get_numeric_value(els, \"day_count\")));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcode.push(\"week\");\n\t\t\t\t\tcode.push(1);\n\t\t\t\t\tcode.push(\"\");\n\t\t\t\t\tcode.push(\"\");\n\t\t\t\t\tcode.push(scheduler.config.recurring_workdays.join(\",\"));\n\t\t\t\t\tcode.splice(0, 1);\n\t\t\t\t}\n\t\t\t},\n\t\t\tyear:function(code, dates) {\n\t\t\t\tvar get_value = scheduler.form_blocks[\"recurring\"]._get_node_value;\n\n\t\t\t\tif (get_value(els, \"year_type\") == \"d\") {\n\t\t\t\t\tcode.push(\"1\");\n\t\t\t\t\tdates.start.setMonth(0);\n\t\t\t\t\tdates.start.setDate(get_value(els, \"year_day\"));\n\t\t\t\t\tdates.start.setMonth(get_value(els, \"year_month\"));\n\n\t\t\t\t} else {\n\t\t\t\t\tcode.push(\"1\");\n\t\t\t\t\tcode.push(get_value(els, \"year_day2\"));\n\t\t\t\t\tcode.push(get_value(els, \"year_week2\"));\n\t\t\t\t\tdates.start.setDate(1);\n\t\t\t\t\tdates.start.setMonth(get_value(els, \"year_month2\"));\n\t\t\t\t}\n\t\t\t\tdates._start = true;\n\t\t\t}\n\t\t};\n\t\tvar set_rcode = {\n\t\t\tweek:function(code, dates) {\n\t\t\t\tvar set_value = scheduler.form_blocks[\"recurring\"]._set_node_value;\n\t\t\t\tset_value(els, \"week_count\", code[1]);\n\n\t\t\t\tvar t = code[4].split(\",\");\n\t\t\t\tvar d = {};\n\t\t\t\tfor (var i = 0; i < t.length; i++) d[t[i]] = true;\n\n\t\t\t\tset_value(els, \"week_day\", d);\n\n\t\t\t\t//for (var i = 0; i < col.length; i++)\n\t\t\t\t//\tcol[i].checked = (!!d[col[i].value]);\n\t\t\t},\n\t\t\tmonth:function(code, dates) {\n\t\t\t\tvar set_value = scheduler.form_blocks[\"recurring\"]._set_node_value;\n\n\t\t\t\tif (code[2] === \"\") {\n\t\t\t\t\tset_value(els, \"month_type\", \"d\");\n\t\t\t\t\tset_value(els, \"month_count\", code[1]);\n\t\t\t\t\tset_value(els, \"month_day\", dates.start.getDate());\n\t\t\t\t} else {\n\t\t\t\t\tset_value(els, \"month_type\", \"w\");\n\t\t\t\t\tset_value(els, \"month_count2\", code[1]);\n\t\t\t\t\tset_value(els, \"month_week2\",  code[3]);\n\t\t\t\t\tset_value(els, \"month_day2\", code[2]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tday:function(code, dates) {\n\t\t\t\tvar set_value = scheduler.form_blocks[\"recurring\"]._set_node_value;\n\t\t\t\tset_value(els, \"day_type\", \"d\");\n\t\t\t\tset_value(els, \"day_count\", code[1]);\n\t\t\t},\n\t\t\tyear:function(code, dates) {\n\t\t\t\tvar set_value = scheduler.form_blocks[\"recurring\"]._set_node_value;\n\n\t\t\t\tif (code[2] === \"\") {\n\t\t\t\t\tset_value(els, \"year_type\", \"d\");\n\t\t\t\t\tset_value(els, \"year_day\", dates.start.getDate());\n\t\t\t\t\tset_value(els, \"year_month\", dates.start.getMonth());\n\n\t\t\t\t} else {\n\t\t\t\t\tset_value(els, \"year_type\", \"w\");\n\t\t\t\t\tset_value(els, \"year_week2\", code[3]);\n\t\t\t\t\tset_value(els, \"year_day2\", code[2]);\n\t\t\t\t\tset_value(els, \"year_month2\", dates.start.getMonth());\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction set_repeat_code(code, dates) {\n\t\t\tvar set_value = scheduler.form_blocks[\"recurring\"]._set_node_value;\n\t\t\tvar data = code.split(\"#\");\n\t\t\tcode = data[0].split(\"_\");\n\t\t\tset_rcode[code[0]](code, dates);\n\n\t\t\tswitch (data[1]) {\n\t\t\t\tcase \"no\":\n\t\t\t\t\tset_end_rule(els, \"no\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"\":\n\t\t\t\t\tset_end_rule(els, \"date_of_end\");\n\n\t\t\t\t\tvar end_date = dates.end;\n\t\t\t\t\tif (scheduler.config.include_end_by){\n\t\t\t\t\t\tend_date = scheduler.date.add(end_date, -1, 'day');\n\t\t\t\t\t}\n\t\t\t\t\tset_value(els, \"date_of_end\", date_str(end_date));\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tset_end_rule(els, \"occurences_count\");\n\t\t\t\t\tset_value(els, \"occurences_count\", data[1]);\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tset_value(els, \"repeat\", code[0]);\n\t\t\t//e.checked = true;\n\n\t\t\tvar node = scheduler.form_blocks[\"recurring\"]._get_form_node(els, \"repeat\", code[0]);\n\t\t\tif(node.nodeName == \"SELECT\"/* && node.onchange*/){\n\t\t\t//\tnode.onchange();\n\t\t\t\tnode.dispatchEvent(new Event('change'));\n\t\t\t\tnode.dispatchEvent(new MouseEvent('click'));\n\t\t\t}else{\n\t\t\t\tnode.dispatchEvent(new MouseEvent('click'));\n\t\t\t}\n\t\t}\n\n\t\tscheduler.form_blocks[\"recurring\"]._set_repeat_code = set_repeat_code;\n\n\t\tfor (var i = 0; i < top.elements.length; i++) {\n\t\t\tvar el = top.elements[i];\n\t\t\tswitch (el.name) {\n\t\t\t\tcase \"repeat\":\n\t\t\t\t\tif (el.nodeName == \"SELECT\" && !el.$_eventAttached) {\n\t\t\t\t\t\tel.$_eventAttached = true;\n\t\t\t\t\t\tel.addEventListener(\"change\", change_current_view);\n\t\t\t\t\t} else if(!el.$_eventAttached){\n\t\t\t\t\t\tel.$_eventAttached = true;\n\t\t\t\t\t\tel.addEventListener(\"click\", change_current_view);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tscheduler._lightbox._rec_init_done = true;\n\t},\n\tset_value:function(node, value, ev) {\n\t\tvar rf = scheduler.form_blocks[\"recurring\"];\n\t\tif (!scheduler._lightbox._rec_init_done)\n\t\t\trf._init_set_value(node, value, ev);\n\t\tnode.open = !ev.rec_type;\n\n\t\tnode.blocked = this._is_modified_occurence(ev);\n\n\t\tvar ds = rf._ds;\n\t\tds.start = ev.start_date;\n\t\tds.end = ev._end_date;\n\n\t\trf._toggle_block();\n\n\t\tif (value)\n\t\t\trf._set_repeat_code(value, ds);\n\t},\n\tget_value:function(node, ev) {\n\t\tif (node.open) {\n\t\t\tvar ds = scheduler.form_blocks[\"recurring\"]._ds;\n\t\t\tvar actual_dates = {};\n\n\t\t\tvar timeControl = getTimeSection();\n\n\t\t\ttimeControl.getValue(actual_dates);\n\t\t\tds.start = actual_dates.start_date;\n\t\t\tev.rec_type = scheduler.form_blocks[\"recurring\"]._get_repeat_code(ds);\n\t\t\tif (ds._start) {\n\t\t\t\tev.start_date = new Date(ds.start);\n\t\t\t\tev._start_date = new Date(ds.start);\n\t\t\t\tds._start = false;\n\t\t\t} else\n\t\t\t\tev._start_date = null;\n\n\t\t\tev._end_date = ds.end;\n\t\t\tev.rec_pattern = ev.rec_type.split(\"#\")[0];\n\t\t} else {\n\t\t\tev.rec_type = ev.rec_pattern = \"\";\n\t\t\tev._end_date = ev.end_date;\n\t\t}\n\t\treturn ev.rec_type;\n\t},\n\t_get_button: function(){\n\t\tvar node = getRecurringSection().header;\n\t\treturn node.firstChild.firstChild;\n\t},\n\t_get_form: function(){\n\t\treturn getRecurringSection().node;\n\t},\n\topen:function(){\n\t\tvar block = scheduler.form_blocks.recurring;\n\n\t\tvar cont = block._get_form();\n\t\tif(!cont.open)\n\t\t\tblock._toggle_block();\n\t},\n\tclose: function(){\n\t\tvar block = scheduler.form_blocks.recurring;\n\n\t\tvar cont = block._get_form();\n\n\t\tif(cont.open)\n\t\t\tblock._toggle_block();\n\t},\n\t_toggle_block: function(){\n\t\tvar block = scheduler.form_blocks.recurring;\n\n\t\tvar cont = block._get_form(),\n\t\t\tel = block._get_button();\n\t\tif (!cont.open && !cont.blocked) {\n\t\t\tcont.style.height = \"auto\";//reset to default value\n\t\t\tif(el){\n\t\t\t\tel.style.backgroundPosition = \"-5px 0px\";\n\t\t\t\tel.nextSibling.innerHTML = scheduler.locale.labels.button_recurring_open;\n\t\t\t}\n\t\t} else {\n\t\t\tcont.style.height = \"0px\";\n\t\t\tif(el){\n\t\t\t\tel.style.backgroundPosition = \"-5px 20px\";\n\t\t\t\tel.nextSibling.innerHTML = scheduler.locale.labels.button_recurring;\n\t\t\t}\n\t\t}\n\t\tcont.open = !cont.open;\n\n\t\tscheduler.setLightboxSize();\n\t},\n\tfocus:function(node) {\n\t},\n\tbutton_click:function(node, button, event) {\n\t\tvar block = scheduler.form_blocks.recurring;\n\t\tvar cont = block._get_form();\n\t\tif (!cont.blocked)\n\t\t\tscheduler.form_blocks.recurring._toggle_block();\n\t}\n};\n\nfunction getTimeSection(){\n\tvar timeControl = scheduler.formSection('time');\n\tif(!timeControl){\n\t\ttimeControl = getFirstSectionOfType('time');\n\t}\n\tif(!timeControl){\n\t\ttimeControl = getFirstSectionOfType('calendar_time');\n\t}\n\n\t\n\tif (!timeControl) {\n\t\tthrow new Error([\"Can't calculate the recurring rule, the Recurring form block can't find the Time control. Make sure you have the time control in 'scheduler.config.lightbox.sections' config.\",\n\"You can use either the default time control https://docs.dhtmlx.com/scheduler/time.html, or the datepicker https://docs.dhtmlx.com/scheduler/minicalendar.html, or a custom control. \",\n\"In the latter case, make sure the control is named \\\"time\\\":\",\n\"\",\n\"scheduler.config.lightbox.sections = [\",\n\"{name:\\\"time\\\", height:72, type:\\\"YOU CONTROL\\\", map_to:\\\"auto\\\" }];\"]\n.join(\"\\n\"));\n\t}\n\n\treturn timeControl;\n}\n\nfunction getRecurringSection(){\n\tvar recurringSection = scheduler.formSection('recurring');\n\tif(!recurringSection){\n\t\trecurringSection = getFirstSectionOfType('recurring');\n\t}\n\n\tif (!recurringSection) {\n\t\tthrow new Error([\"Can't locate the Recurring form section.\",\n\t\t\"Make sure that you have the recurring control on the lightbox configuration https://docs.dhtmlx.com/scheduler/recurring_events.html#recurringlightbox \",\n\t\t\"and that the recurring control has name \\\"recurring\\\":\",\n\"\",\n\"scheduler.config.lightbox.sections = [\",\n\"\t{name:\\\"recurring\\\", ... }\",\n\"];\"].join(\"\\n\"));\n\n\t}\n\n\treturn recurringSection;\n}\n\nfunction getFirstSectionOfType(type){\n\tfor(var i = 0; i < scheduler.config.lightbox.sections.length; i++){\n\t\tvar section = scheduler.config.lightbox.sections[i];\n\t\tif(section.type === type){\n\t\t\treturn scheduler.formSection(section.name);\n\t\t}\n\t}\n\treturn null;\n}\n\n//problem may occur if we will have two repeating events in the same moment of time\nscheduler._rec_markers = {};\nscheduler._rec_markers_pull = {};\nscheduler._add_rec_marker = function(ev, time) {\n\tev._pid_time = time;\n\tthis._rec_markers[ev.id] = ev;\n\tif (!this._rec_markers_pull[ev.event_pid]) this._rec_markers_pull[ev.event_pid] = {};\n\tthis._rec_markers_pull[ev.event_pid][time] = ev;\n};\nscheduler._get_rec_marker = function(time, id) {\n\tvar ch = this._rec_markers_pull[id];\n\tif (ch) return ch[time];\n\treturn null;\n};\nscheduler._get_rec_markers = function(id) {\n\treturn (this._rec_markers_pull[id] || []);\n};\n\nfunction clearMilliseconds(date){\n//\treturn date;\n\treturn new Date(\n\t\tdate.getFullYear(), \n\t\tdate.getMonth(), \n\t\tdate.getDate(), \n\t\tdate.getHours(), \n\t\tdate.getMinutes(),\n\t\tdate.getSeconds(),\n\t\t0\n\t);\n}\n\nscheduler._rec_temp = [];\n(function() {\n\tvar old_add_event = scheduler.addEvent;\n\tscheduler.addEvent = function(start_date, end_date, text, id, extra_data) {\n\t\tvar ev_id = old_add_event.apply(this, arguments);\n\n\t\tif (ev_id && scheduler.getEvent(ev_id)) {\n\t\t\tvar ev = scheduler.getEvent(ev_id);\n\t\t\t\n\t\t\tif(ev.start_date){\n\t\t\t\tev.start_date = clearMilliseconds(ev.start_date);\n\t\t\t}\n\t\t\tif(ev.end_date){\n\t\t\t\tev.end_date = clearMilliseconds(ev.end_date);\n\t\t\t}\n\t\t\tif (this._is_modified_occurence(ev))\n\t\t\t\tscheduler._add_rec_marker(ev, ev.event_length * 1000);\n\t\t\tif (ev.rec_type)\n\t\t\t\tev.rec_pattern = ev.rec_type.split(\"#\")[0];\n\t\t}\n\t\treturn ev_id;\n\t};\n})();\n\nscheduler.attachEvent(\"onEventIdChange\", function(id, new_id) {\n\tif (this._ignore_call) return;\n\tthis._ignore_call = true;\n\n\tif(scheduler._rec_markers[id]){\n\t\t//important for for correct work of scheduler.getEvents(from, to) and collision detection\n\t\tscheduler._rec_markers[new_id] = scheduler._rec_markers[id];\n\t\tdelete scheduler._rec_markers[id];\n\t}\n\n\tif(scheduler._rec_markers_pull[id]){\n\t\tscheduler._rec_markers_pull[new_id] = scheduler._rec_markers_pull[id];\n\t\tdelete scheduler._rec_markers_pull[id];\n\t}\n\n\tfor (var i = 0; i < this._rec_temp.length; i++) {\n\t\tvar tev = this._rec_temp[i];\n\t\tif (tev.event_pid == id) {\n\t\t\ttev.event_pid = new_id;\n\t\t\tthis.changeEventId(tev.id, new_id + \"#\" + tev.id.split(\"#\")[1]);\n\t\t}\n\t}\n\n\tfor(var i in this._rec_markers){\n\t\tvar tev = this._rec_markers[i];\n\t\tif(tev.event_pid == id){\n\t\t\ttev.event_pid = new_id;\n\t\t\ttev._pid_changed = true;\n\t\t}\n\t}\n\n\tvar el = scheduler._rec_markers[new_id];\n\tif(el && el._pid_changed) {\n\t\tdelete el._pid_changed;\n\t\tsetTimeout(function() {\n\t\t\tif(scheduler.$destroyed){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tscheduler.callEvent(\"onEventChanged\", [new_id, scheduler.getEvent(new_id)]);\n\t\t}, 1);\n\t}\n\n\tdelete this._ignore_call;\n});\nscheduler.attachEvent(\"onConfirmedBeforeEventDelete\", function(id) {\n\tvar ev = this.getEvent(id);\n\tif (this._is_virtual_event(id) || (this._is_modified_occurence(ev) && ev.rec_type && ev.rec_type != 'none')) {\n\t\tid = id.split(\"#\");\n\t\tvar nid = this.uid();\n\t\tvar tid = (id[1]) ? id[1] : Math.round(ev._pid_time / 1000);\n\n\t\tvar nev = this._copy_event(ev);\n\t\tnev.id = nid;\n\t\tnev.event_pid = ev.event_pid || id[0];\n\t\tvar timestamp = tid;\n\t\tnev.event_length = timestamp;\n\t\tnev.rec_type = nev.rec_pattern = \"none\";\n\t\tthis.addEvent(nev);\n\n\t\tthis._add_rec_marker(nev, timestamp * 1000);\n\t} else {\n\t\tif (ev.rec_type && this._lightbox_id)\n\t\t\tthis._roll_back_dates(ev);\n\t\tvar sub = this._get_rec_markers(id);\n\t\tfor (var i in sub) {\n\t\t\tif (sub.hasOwnProperty(i)) {\n\t\t\t\tid = sub[i].id;\n\t\t\t\tif (this.getEvent(id))\n\t\t\t\t\tthis.deleteEvent(id, true);\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n});\nscheduler.attachEvent(\"onEventDeleted\", function(id, ev){\n\tif(!this._is_virtual_event(id) && this._is_modified_occurence(ev)){\n\t\tif(!scheduler._events[id]){\n\t\t\tev.rec_type = ev.rec_pattern = \"none\";\n\t\t\tthis.setEvent(id, ev);\n\t\t}\n\t}\n});\nscheduler.attachEvent(\"onEventChanged\", function(id, event) {\n\tif (this._loading) return true;\n\n\tvar ev = this.getEvent(id);\n\n\tif (this._is_virtual_event(id)) {\n\t\tvar id = id.split(\"#\");\n\t\tvar nid = this.uid();\n\t\tthis._not_render = true;\n\n\t\tvar nev = this._copy_event(event);\n\t\tnev.id = nid;\n\t\tnev.event_pid = id[0];\n\t\tvar timestamp = id[1];\n\t\tnev.event_length = timestamp;\n\t\tnev.rec_type = nev.rec_pattern = \"\";\n\n\t\tthis._add_rec_marker(nev, timestamp * 1000);\n\t\tthis.addEvent(nev);\n\n\t\tthis._not_render = false;\n\n\t} else {\n\t\tif(ev.start_date){\n\t\t\tev.start_date = clearMilliseconds(ev.start_date);\n\t\t}\n\t\tif(ev.end_date){\n\t\t\tev.end_date = clearMilliseconds(ev.end_date);\n\t\t}\n\n\t\tif (ev.rec_type && this._lightbox_id){\n\t\t\tthis._roll_back_dates(ev);\n\t\t}\n\t\tvar sub = this._get_rec_markers(id);\n\t\tfor (var i in sub) {\n\t\t\tif (sub.hasOwnProperty(i)) {\n\t\t\t\tdelete this._rec_markers[sub[i].id];\n\t\t\t\tthis.deleteEvent(sub[i].id, true);\n\t\t\t}\n\t\t}\n\t\tdelete this._rec_markers_pull[id];\n\n\t\t// it's possible that after editing event is no longer exists, in such case we need to remove _select_id flag\n\t\tvar isEventFound = false;\n\t\tfor (var k = 0; k < this._rendered.length; k++) {\n\t\t\tif (this._rendered[k].getAttribute(this.config.event_attribute) == id)\n\t\t\t\tisEventFound = true;\n\t\t}\n\t\tif (!isEventFound)\n\t\t\tthis._select_id = null;\n\t}\n\treturn true;\n});\nscheduler.attachEvent(\"onEventAdded\", function(id) {\n\tif (!this._loading) {\n\t\tvar ev = this.getEvent(id);\n\t\tif (ev.rec_type && !ev.event_length){\n\t\t\tthis._roll_back_dates(ev);\n\t\t}\n\t}\n\treturn true;\n});\nscheduler.attachEvent(\"onEventSave\", function(id, data, is_new_event) {\n\tvar ev = this.getEvent(id);\n\tif (!ev.rec_type && data.rec_type && !this._is_virtual_event(id))\n\t\tthis._select_id = null;\n\treturn true;\n});\nscheduler.attachEvent(\"onEventCreated\", function(id) {\n\tvar ev = this.getEvent(id);\n\tif (!ev.rec_type)\n\t\tev.rec_type = ev.rec_pattern = ev.event_length = ev.event_pid = \"\";\n\treturn true;\n});\nscheduler.attachEvent(\"onEventCancel\", function(id) {\n\tvar ev = this.getEvent(id);\n\tif (ev.rec_type) {\n\t\tthis._roll_back_dates(ev);\n\t\t// a bit expensive, but we need to be sure that event re-rendered, because view can be corrupted by resize , during edit process\n\t\tthis.render_view_data();\n\t}\n});\nscheduler._roll_back_dates = function(ev) {\n\tif(ev.start_date){\n\t\tev.start_date = clearMilliseconds(ev.start_date);\n\t}\n\tif(ev.end_date){\n\t\tev.end_date = clearMilliseconds(ev.end_date);\n\t}\n\tev.event_length = Math.round((ev.end_date.valueOf() - ev.start_date.valueOf()) / 1000);\n\tev.end_date = ev._end_date;\n\tif (ev._start_date) {\n\t\tev.start_date.setMonth(0);\n\t\tev.start_date.setDate(ev._start_date.getDate());\n\t\tev.start_date.setMonth(ev._start_date.getMonth());\n\t\tev.start_date.setFullYear(ev._start_date.getFullYear());\n\n\t}\n};\n\nscheduler._is_virtual_event = function(id){\n\treturn id.toString().indexOf(\"#\") != -1;\n};\nscheduler._is_modified_occurence = function(ev){\n\treturn (ev.event_pid && ev.event_pid != \"0\");\n};\n\nscheduler.showLightbox_rec = scheduler.showLightbox;\nscheduler.showLightbox = function(id) {\n\tvar locale = this.locale;\n\tvar c = scheduler.config.lightbox_recurring;\n\tvar ev = this.getEvent(id);\n\tvar pid = ev.event_pid;\n\tvar isVirtual = this._is_virtual_event(id);\n\tif (isVirtual)\n\t\tpid = id.split(\"#\")[0];\n\n\t// show series\n\tvar showSeries = function(id) {\n\t\tvar event = scheduler.getEvent(id);\n\t\tevent._end_date = event.end_date;\n\t\tevent.end_date = new Date(event.start_date.valueOf() + event.event_length * 1000);\n\t\treturn scheduler.showLightbox_rec(id); // editing series\n\t};\n\n\tif ( (pid || pid*1 === 0) && ev.rec_type) {\n\t\t// direct API call on series id\n\t\treturn showSeries(id);\n\t}\n\tif ( !pid || pid === '0' || ( (!locale.labels.confirm_recurring || c == 'instance') || (c == 'series' && !isVirtual)) ) {\n\t\t// editing instance or non recurring event\n\t\treturn this.showLightbox_rec(id);\n\t}\n\tif (c == 'ask') {\n\t\tvar that = this;\n\t\tscheduler.modalbox({\n\t\t\ttext: locale.labels.confirm_recurring,\n\t\t\ttitle: locale.labels.title_confirm_recurring,\n\t\t\twidth: \"500px\",\n\t\t\tposition: \"middle\",\n\t\t\tbuttons:[locale.labels.button_edit_series, locale.labels.button_edit_occurrence, locale.labels.icon_cancel],\n\t\t\tcallback: function(index) {\n\t\t\t\tswitch(+index) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\treturn showSeries(pid);\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\treturn that.showLightbox_rec(id);\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t} else {\n\t\tshowSeries(pid);\n\t}\n};\n\n\nscheduler.get_visible_events_rec = scheduler.get_visible_events;\nscheduler.get_visible_events = function(only_timed) {\n\tfor (var i = 0; i < this._rec_temp.length; i++)\n\t\tdelete this._events[this._rec_temp[i].id];\n\tthis._rec_temp = [];\n\n\tvar stack = this.get_visible_events_rec(only_timed);\n\tvar out = [];\n\tfor (var i = 0; i < stack.length; i++) {\n\t\tif (stack[i].rec_type) {\n\t\t\t//deleted element of series\n\t\t\tif (stack[i].rec_pattern != \"none\")\n\t\t\t\tthis.repeat_date(stack[i], out);\n\t\t}\n\t\telse out.push(stack[i]);\n\t}\n\treturn out;\n};\n\n\n(function() {\n\tvar old = scheduler.isOneDayEvent;\n\tscheduler.isOneDayEvent = function(ev) {\n\t\tif (ev.rec_type) return true;\n\t\treturn old.call(this, ev);\n\t};\n\tvar old_update_event = scheduler.updateEvent;\n\tscheduler.updateEvent = function(id) {\n\t\tvar ev = scheduler.getEvent(id);\n\t\tif(ev && ev.rec_type){\n\t\t\t//rec_type can be changed without the lightbox,\n\t\t\t// make sure rec_pattern updated as well\n\t\t\tev.rec_pattern = (ev.rec_type || \"\").split(\"#\")[0];\n\t\t}\n\t\tif (ev && ev.rec_type && !this._is_virtual_event(id)) {\n\t\t\tscheduler.update_view();\n\t\t} else {\n\t\t\told_update_event.call(this, id);\n\t\t}\n\t};\n})();\n\nscheduler.transponse_size = {\n\tday:1, week:7, month:1, year:12\n};\nscheduler.date.day_week = function(sd, day, week) {\n\tsd.setDate(1);\n\tvar originalMonth = scheduler.date.month_start(new Date(sd));\n\tweek = (week - 1) * 7;\n\tvar cday = sd.getDay();\n\tvar nday = day * 1 + week - cday + 1;\n\tsd.setDate(nday <= week ? (nday + 7) : nday);\n\tvar newMonth = scheduler.date.month_start(new Date(sd));\n\tif(originalMonth.valueOf() !== newMonth.valueOf()){\n\t\treturn false;\n\t}\n\treturn true;\n};\nscheduler.transpose_day_week = function(sd, list, cor, size, cor2) {\n\tvar cday = (sd.getDay() || (scheduler.config.start_on_monday ? 7 : 0)) - cor;\n\tfor (var i = 0; i < list.length; i++) {\n\t\tif (list[i] > cday)\n\t\t\treturn sd.setDate(sd.getDate() + list[i] * 1 - cday - (size ? cor : cor2));\n\t}\n\tthis.transpose_day_week(sd, list, cor + size, null, cor);\n};\nscheduler.transpose_type = function(type) {\n\tvar transposeRecurring = \"transpose_\" + type;\n\tif (!this.date[transposeRecurring]) {\n\t\tvar recurringParts = type.split(\"_\");\n\t\tvar dayDurationMs = 60 * 60 * 24 * 1000;\n\t\tvar addRecurring = \"add_\" + type;\n\t\tvar recurringStepDays = this.transponse_size[recurringParts[0]] * recurringParts[1];\n\n\t\tif (recurringParts[0] == \"day\" || recurringParts[0] == \"week\") {\n\t\t\tvar weekDays = null;\n\t\t\tif (recurringParts[4]) {\n\t\t\t\tweekDays = recurringParts[4].split(\",\");\n\t\t\t\tif (scheduler.config.start_on_monday) {\n\t\t\t\t\tfor (var i = 0; i < weekDays.length; i++)\n\t\t\t\t\t\tweekDays[i] = (weekDays[i] * 1) || 7;\n\t\t\t\t\tweekDays.sort();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.date[transposeRecurring] = function(nd, td) {\n\t\t\t\tvar delta = Math.floor((td.valueOf() - nd.valueOf()) / (dayDurationMs * recurringStepDays));\n\t\t\t\tif (delta > 0)\n\t\t\t\t\tnd.setDate(nd.getDate() + delta * recurringStepDays);\n\t\t\t\tif (weekDays)\n\t\t\t\t\tscheduler.transpose_day_week(nd, weekDays, 1, recurringStepDays);\n\n\t\t\t\treturn nd;\n\t\t\t};\n\t\t\tthis.date[addRecurring] = function(sd, inc) {\n\t\t\t\tvar nd = new Date(sd.valueOf());\n\t\t\t\tif (weekDays) {\n\t\t\t\t\tfor (var count = 0; count < inc; count++)\n\t\t\t\t\t\tscheduler.transpose_day_week(nd, weekDays, 0, recurringStepDays);\n\t\t\t\t} else\n\t\t\t\t\tnd.setDate(nd.getDate() + inc * recurringStepDays);\n\n\t\t\t\treturn nd;\n\t\t\t};\n\t\t}\n\t\telse if (recurringParts[0] == \"month\" || recurringParts[0] == \"year\") {\n\t\t\tthis.date[transposeRecurring] = function(nd, td, seriesInstance) {\n\t\t\t\tvar delta = Math.ceil(((td.getFullYear() * 12 + td.getMonth() * 1 + 1) - (nd.getFullYear() * 12 + nd.getMonth() * 1 + 1)) / (recurringStepDays) - 1);\n\n\t\t\t\tif (delta >= 0){\n\t\t\t\t\tnd.setDate(1);\n\t\t\t\t\tnd.setMonth(nd.getMonth() + delta * recurringStepDays);\n\t\t\t\t}\n\n\t\t\t\treturn scheduler.date[addRecurring](nd, 0, seriesInstance);\n\t\t\t\t//if (str[3]){\n\t\t\t\t//\tscheduler.date.day_week(nd, str[2], str[3]);\n\t\t\t\t//}\n\t\t\t};\n\t\t\tthis.date[addRecurring] = function(sd, inc, seriesInstance, currentCount) {\n\t\t\t\tif(!currentCount){\n\t\t\t\t\tcurrentCount = 1;\n\t\t\t\t}else{\n\t\t\t\t\tcurrentCount++;\n\t\t\t\t}\n\t\t\t\tvar maxCount = 12;\n\t\t\t\tif(currentCount > maxCount){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar nd = new Date(sd.valueOf());\n\t\t\t\tnd.setDate(1);\n\n\n\t\t\t\tnd.setMonth(nd.getMonth() + inc * recurringStepDays);\n\t\t\t\tvar origMonth = nd.getMonth();\n\t\t\t\tvar origYear = nd.getFullYear();\n\t\t\t\tnd.setDate(seriesInstance.start_date.getDate());\n\t\t\t\tif (recurringParts[3]){\n\t\t\t\t\tscheduler.date.day_week(nd, recurringParts[2], recurringParts[3]);\n\t\t\t\t}\n\n\t\t\t\tvar correctOverflowInstances = scheduler.config.recurring_overflow_instances;\n\t\t\t\tif(nd.getMonth() != origMonth && correctOverflowInstances != \"none\"){\n\t\t\t\t\t// no such day in a month\n\t\t\t\t\tif(correctOverflowInstances === \"lastDay\"){\n\t\t\t\t\t\t// return either last day of the month\n\t\t\t\t\t\tnd = new Date(origYear, origMonth + 1, 0, nd.getHours(), nd.getMinutes(), nd.getSeconds(), nd.getMilliseconds());\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// or go to the next instance\n\t\t\t\t\t\tnd = scheduler.date[addRecurring](new Date(origYear, origMonth + 1, 0), inc||1, seriesInstance, currentCount);\n\t\t\t\t\t\t// if next instance is not possible (e.g. 'repeat on 40th day of the month') null will be returned\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn nd;\n\t\t\t};\n\t\t}\n\t}\n};\nscheduler.repeat_date = function(ev, stack, non_render, from, to, maxCount) {\n\n\tfrom = from || this._min_date;\n\tto = to || this._max_date;\n\tvar max = maxCount || -1;\n\tvar td = new Date(ev.start_date.valueOf());\n\n\tvar startHour = td.getHours();\n\n\tvar visibleCount = 0;\n\n\tif (!ev.rec_pattern && ev.rec_type)\n\t\tev.rec_pattern = ev.rec_type.split(\"#\")[0];\n\n\tthis.transpose_type(ev.rec_pattern);\n\ttd = scheduler.date[\"transpose_\" + ev.rec_pattern](td, from, ev);\n\twhile ( td && (\n\t\ttd < ev.start_date ||\n\t\tscheduler._fix_daylight_saving_date(td,from,ev,td,new Date(td.valueOf() + ev.event_length * 1000)).valueOf() <= from.valueOf() ||\n\t\ttd.valueOf() + ev.event_length * 1000 <= from.valueOf())){\n\t\t\ttd = this.date[\"add_\" + ev.rec_pattern](td, 1, ev);\n\n\t}\n\twhile (td && (td < to && td < ev.end_date && (max < 0 || visibleCount < max))) {\n\t\ttd.setHours(startHour);\n\n\t\tvar timestamp = (scheduler.config.occurrence_timestamp_in_utc) ? Date.UTC(td.getFullYear(), td.getMonth(), td.getDate(), td.getHours(), td.getMinutes(), td.getSeconds()) : td.valueOf();\n\t\tvar ch = this._get_rec_marker(timestamp, ev.id);\n\t\tif (!ch) { // unmodified element of series\n\t\t\tvar ted = new Date(td.valueOf() + ev.event_length * 1000);\n\t\t\tvar copy = this._copy_event(ev);\n\t\t\t//copy._timed = ev._timed;\n\t\t\tcopy.text = ev.text;\n\t\t\tcopy.start_date = td;\n\t\t\tcopy.event_pid = ev.id;\n\t\t\tcopy.id = ev.id + \"#\" + Math.round(timestamp / 1000);\n\t\t\tcopy.end_date = ted;\n\n\t\t\tcopy.end_date = scheduler._fix_daylight_saving_date(copy.start_date, copy.end_date, ev, td, copy.end_date);\n\n\t\t\tcopy._timed = this.isOneDayEvent(copy);\n\n\t\t\tif (!copy._timed && !this._table_view && !this.config.multi_day) return;\n\t\t\tstack.push(copy);\n\n\t\t\tif (!non_render) {\n\t\t\t\tthis._events[copy.id] = copy;\n\t\t\t\tthis._rec_temp.push(copy);\n\t\t\t}\n\n\t\t\tvisibleCount++;\n\n\t\t} else\n\t\tif (non_render){\n\t\t\tif(ch.rec_type != \"none\"){\n\t\t\t\tvisibleCount++;\n\t\t\t}\n\t\t\tstack.push(ch);\n\t\t}\n\n\t\ttd = this.date[\"add_\" + ev.rec_pattern](td, 1, ev);\n\t//\tif(!scheduler.date[\"validate_add_\" + ev.rec_pattern](td, 1, ev.rec_pattern)){\n\t///\t\talert(\"detect add\")\n\t//\t}\n\t}\n};\nscheduler._fix_daylight_saving_date = function(start_date, end_date, ev, counter, default_date) {\n\tvar shift = start_date.getTimezoneOffset() - end_date.getTimezoneOffset();\n\tif (shift) {\n\t\tif (shift > 0) {\n\t\t\t// e.g. 24h -> 23h\n\t\t\treturn new Date(counter.valueOf() + ev.event_length * 1000 - shift * 60 * 1000);\n\t\t}\n\t\telse {\n\t\t\t// e.g. 24h -> 25h\n\t\t\treturn new Date(end_date.valueOf() - shift * 60 * 1000);\n\t\t}\n\t}\n\treturn new Date(default_date.valueOf());\n};\nscheduler.getRecDates = function(id, max) {\n\tvar ev = typeof id == \"object\" ? id : scheduler.getEvent(id);\n\tvar recurrings = [];\n\tmax = max || 100;\n\n\tif (!ev.rec_type) {\n\t\treturn [\n\t\t\t{ start_date: ev.start_date, end_date: ev.end_date }\n\t\t];\n\t}\n\tif (ev.rec_type == \"none\") {\n\t\treturn [];\n\t}\n\n\tscheduler.repeat_date(ev, recurrings, true, ev.start_date, ev.end_date, max);\n\n\tvar result = [];\n\tfor(var i = 0; i < recurrings.length; i++){\n\t\tif(recurrings[i].rec_type != \"none\"){\n\t\t\tresult.push({start_date: recurrings[i].start_date, end_date: recurrings[i].end_date});\n\t\t}\n\t}\n\n\treturn result;\n};\nscheduler.getEvents = function(from, to) {\n\tvar result = [];\n\tfor (var a in this._events) {\n\t\tvar ev = this._events[a];\n\t\tif (ev && ev.start_date < to && ev.end_date > from) {\n\t\t\tif (ev.rec_pattern) {\n\t\t\t\tif (ev.rec_pattern == \"none\") continue;\n\t\t\t\tvar sev = [];\n\t\t\t\tthis.repeat_date(ev, sev, true, from, to);\n\t\t\t\tfor (var i = 0; i < sev.length; i++) {\n\t\t\t\t\t// if event is in rec_markers then it will be checked by himself, here need to skip it\n\t\t\t\t\tif (!sev[i].rec_pattern && sev[i].start_date < to && sev[i].end_date > from && !this._rec_markers[sev[i].id]) {\n\t\t\t\t\t\tresult.push(sev[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (!this._is_virtual_event(ev.id)) { // if it's virtual event we can skip it\n\t\t\t\tresult.push(ev);\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n};\n\nscheduler.config.repeat_date = \"%m.%d.%Y\";\nscheduler.config.lightbox.sections = [\n\t{name:\"description\", map_to:\"text\", type:\"textarea\" , focus:true},\n\t{name:\"recurring\", type:\"recurring\", map_to:\"rec_type\", button:\"recurring\"},\n\t{name:\"time\", height:72, type:\"time\", map_to:\"auto\"}\n];\n\n\n//drop secondary attributes\nscheduler._copy_dummy = function(ev) {\n\tvar start_date = new Date(this.start_date);\n\tvar end_date = new Date(this.end_date);\n\tthis.start_date = start_date;\n\tthis.end_date = end_date;\n\tthis.event_length = this.event_pid = this.rec_pattern = this.rec_type = null;\n};\n\nscheduler.config.include_end_by = false;\nscheduler.config.lightbox_recurring = 'ask'; // series, instance\n\nscheduler.attachEvent(\"onClearAll\", function(){\n\tscheduler._rec_markers = {}; //clear recurring events data\n\tscheduler._rec_markers_pull = {};\n\tscheduler._rec_temp = [];\n});\n\n}","import getSerializator from '../core/common/get_serializable_events';\nexport default function(scheduler){\n\n\t\nconst getSerializableData = getSerializator(scheduler);\n\n//redefine this method, if you want to provide a custom set of attributes for serialization\nscheduler.data_attributes=function(){\n\tvar attrs = [];\n\tvar format = scheduler._helpers.formatDate;\n\tvar all_events = getSerializableData();\n\tfor (var a in all_events){\n\t\tvar ev = all_events[a];\n\t\tfor (var name in ev)\n\t\t\tif (name.substr(0,1) !=\"_\")\n\t\t\t\tattrs.push([name,((name == \"start_date\" || name == \"end_date\")?format:null)]);\n\t\tbreak;\n\t}\n\treturn attrs;\n};\n\nscheduler.toXML = function(header){\n\tvar xml = [];\n\tvar attrs = this.data_attributes();\n\tvar all_events = getSerializableData();\n\tfor (var a in all_events){\n\t\tvar ev = all_events[a];\n\n\t\txml.push(\"<event>\");\n\t\tfor (var i=0; i < attrs.length; i++)\n\t\t\txml.push(\"<\"+attrs[i][0]+\"><![CDATA[\"+(attrs[i][1]?attrs[i][1](ev[attrs[i][0]]):ev[attrs[i][0]])+\"]]></\"+attrs[i][0]+\">\");\n\n\t\txml.push(\"</event>\");\n\t}\n\treturn (header||\"\")+\"<data>\"+xml.join(\"\\n\")+\"</data>\";\n};\n\nscheduler._serialize_json_value = function(value){\n\tif(value === null || typeof value === \"boolean\"){\n\t\tvalue = \"\" + value;\n\t}else{\n\t\tif(!value && value !== 0){\n\t\t\tvalue = \"\";\n\t\t}\n\t\tvalue = '\"' + value.toString().\n\t\t\treplace(/\\n/g,\"\").\n\t\t\treplace(/\\\\/g,\"\\\\\\\\\").\n\t\t\treplace(/\"/g, '\\\\\"') + '\"';\n\t}\n\treturn value;\n};\n\n\n\nscheduler.toJSON = function(){\n\treturn JSON.stringify(this.serialize());\n};\n\n\nscheduler.toICal = function(header){\n\tvar start = \"BEGIN:VCALENDAR\\nVERSION:2.0\\nPRODID:-//dhtmlXScheduler//NONSGML v2.2//EN\\nDESCRIPTION:\";\n\tvar end = \"END:VCALENDAR\";\n\tvar format = scheduler.date.date_to_str(\"%Y%m%dT%H%i%s\");\n\tvar full_day_format = scheduler.date.date_to_str(\"%Y%m%d\");\n\n\tvar ical = [];\n\tvar all_events = getSerializableData();\n\tfor (var a in all_events){\n\t\tvar ev = all_events[a];\n\n\n\t\tical.push(\"BEGIN:VEVENT\");\n\t\tif (!ev._timed || (!ev.start_date.getHours() && !ev.start_date.getMinutes()))\n\t\t\tical.push(\"DTSTART:\"+full_day_format(ev.start_date));\n\t\telse\n\t\t\tical.push(\"DTSTART:\"+format(ev.start_date));\n\t\tif (!ev._timed || (!ev.end_date.getHours() && !ev.end_date.getMinutes()))\n\t\t\tical.push(\"DTEND:\"+full_day_format(ev.end_date));\n\t\telse\n\t\t\tical.push(\"DTEND:\"+format(ev.end_date));\n\t\tical.push(\"SUMMARY:\"+ev.text);\n\t\tical.push(\"END:VEVENT\");\n\t}\n\treturn start+(header||\"\")+\"\\n\"+ical.join(\"\\n\")+\"\\n\"+end;\n};\n\n}","\nimport autoscroll from \"./timeline/autoscroll\";\nimport scrollHelperFactory from \"./timeline/rtl_scroll_helper\";\nimport smartRender from \"./timeline/timeline_smart_render\";\nimport eventable from \"../utils/eventable\";\n\nexport default function(scheduler){\n\n// define scrollbar width once for correct height of label_wrapper\nfunction getScrollbarwidth() {\n\tvar inner = document.createElement('p');\n\tinner.style.width = \"100%\";\n\tinner.style.height = \"200px\";\n\n\tvar outer = document.createElement('div');\n\touter.style.position = \"absolute\";\n\touter.style.top = \"0px\";\n\touter.style.left = \"0px\";\n\touter.style.visibility = \"hidden\";\n\touter.style.width = \"200px\";\n\touter.style.height = \"150px\";\n\touter.style.overflow = \"hidden\";\n\touter.appendChild(inner);\n\n\tdocument.body.appendChild(outer);\n\tvar w1 = inner.offsetWidth;\n\touter.style.overflow = 'scroll';\n\tvar w2 = inner.offsetWidth;\n\n\tif (w1 == w2) {\n\t\tw2 = outer.clientWidth;\n\t}\n\n\tdocument.body.removeChild(outer);\n\n\treturn (w1 - w2);\n}\n\n\nscheduler.ext.timeline = {\n\trenderCells: function(columns, contentTemplate, baseClass){\n\t\tif(!columns || !columns.length){\n\t\t\treturn;\n\t\t}\n\t\tconst html = [];\n\t\tfor(let i = 0; i < columns.length; i++){\n\t\t\tconst column = columns[i];\n\t\t\tlet style = \"\";\n\t\t\tif(column.$width){\n\t\t\t\tstyle = \"width:\" + column.$width + \"px;\";\n\t\t\t}\n\n\t\t\tlet className = baseClass;\n\t\t\tif(column.css){\n\t\t\t\tclassName += \" \" + column.css;\n\t\t\t}\n\n\t\t\tif(i === 0) {\n\t\t\t\tclassName += \" \" + baseClass + \"_first\";\n\t\t\t}\n\t\t\tif (i === columns.length - 1){\n\t\t\t\tclassName += \" \" + baseClass + \"_last\";\n\t\t\t}\n\n\t\t\tconst content = contentTemplate(column) || \"\";\n\n\t\t\thtml.push(`<div class='${className}' style='${style}'><div class='dhx_timeline_label_content_wrapper'>${content}</div></div>`);\n\t\t}\n\t\t\n\t\treturn html.join(\"\");\n\t},\n\trenderHeading: function renderHeading(){\n\t\treturn this.renderCells(\n\t\t\tthis.columns,\n\t\t\tfunction (column) {\n\t\t\t\treturn column.label;\n\t\t\t},\n\t\t\t\"dhx_timeline_label_column dhx_timeline_label_column_header\"\n\t\t);\n\t},\n\trenderColumns: function renderColumns(section){\n\t\treturn this.renderCells(\n\t\t\tthis.columns,\n\t\t\tfunction (column) {\n\t\t\t\tif(column.template){\n\t\t\t\t\treturn column.template.call(self, section) || \"\";\n\t\t\t\t}\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\t\"dhx_timeline_label_column\"\n\t\t);\n\t},\n\n\tscrollTo: function(scrollPosition){\n\t\tif(!scrollPosition){\n\t\t\treturn;\n\t\t}\n\n\t\tvar scrollDate;\n\t\tif(scrollPosition.date){\n\t\t\tscrollDate = scrollPosition.date;\n\t\t}else if(scrollPosition.left){\n\t\t\tscrollDate = scrollPosition.left;\n\t\t}else{\n\t\t\tscrollDate = scrollPosition;\n\t\t}\n\n\t\tvar scrollTop = -1;\n\t\tif(scrollPosition.section){\n\t\t\tscrollTop = this.getSectionTop(scrollPosition.section);\n\t\t}else if(scrollPosition.top){\n\t\t\tscrollTop = scrollPosition.top;\n\t\t}\n\n\t\tvar posLeft;\n\t\tif(typeof scrollDate == \"number\"){\n\t\t\tposLeft = scrollDate;\n\t\t}else{\n\t\t\tposLeft = this.posFromDate(scrollDate);\n\t\t}\n\t\tif (scheduler.config.rtl){\n\t\t\tvar labelWrapperHeight = +scheduler.$container.querySelector(\".dhx_timeline_label_wrapper\").style.height.replace(\"px\", \"\");\n\t\t\tvar scalesHeight = this._section_height[this.y_unit.length] + this._label_rows[this._label_rows.length - 1].top;\n\n\t\t\tif (this.scrollHelper.getMode() == this.scrollHelper.modes.minMax && (scalesHeight > labelWrapperHeight || this.render == \"tree\")) {\n\t\t\t\tposLeft -= getScrollbarwidth();\n\t\t\t}\n\t\t}\n\n\t\tvar dataWrapperDiv = scheduler.$container.querySelector('.dhx_timeline_data_wrapper');\n\t\tif (!this.scrollable){\n\t\t\tdataWrapperDiv = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\t}\n\n\t\tif(this.scrollable){\n\t\t\tthis.scrollHelper.setScrollValue(dataWrapperDiv, posLeft);\n\t\t}\n\n\t\tif(scrollTop >= 0){\n\t\t\tdataWrapperDiv.scrollTop = scrollTop;\n\t\t}\n\t},\n\n\tgetScrollPosition: function () {\n\t\treturn {\n\t\t\tleft: this._x_scroll || 0,\n\t\t\ttop: this._y_scroll || 0\n\t\t};\n\t},\n\n\tposFromDate: function(date){\n\t\treturn scheduler._timeline_getX({start_date: date}, false, this) - 1;//getX adds 1px for event positioning\n\t}, \n\t\n\tdateFromPos: function (x) {\n\t\treturn scheduler._timeline_drag_date(this, x);\n\t},\n\n\tsectionFromPos: function(top) {\n\t\tvar pos = {y: top};\n\t\tscheduler._resolve_timeline_section(this, pos);\n\t\treturn pos.section;\n\t},\n\n\tresolvePosition: function(pos){\n\t\tvar result = {\n\t\t\tdate: null,\n\t\t\tsection: null\n\t\t};\n\t\tif(pos.left) {\n\t\t\tresult.date = this.dateFromPos(pos.left);\n\t\t}\n\t\tif(pos.top) {\n\t\t\tresult.section = this.sectionFromPos(pos.top);\n\t\t}\n\t\treturn result;\n\t},\n\n\tgetSectionHeight: function(sectionId){\n\t\treturn this._section_height[sectionId];\n\t},\n\n\tgetSectionTop: function(sectionId){\n\t\treturn this._rowStats[sectionId].top;\n\t},\n\n\tgetEventTop: function(event){\n\t\tvar eventHeight = this.getEventHeight(event);\n\t\tvar sorder = event._sorder || 0;\n\t\tvar y = 1+sorder*(eventHeight - 3)+(sorder?(sorder*2):0); // original top + number_of_events * event_dy + default event top/bottom borders\n\t\tif (scheduler.config.cascade_event_display) {\n\t\t\ty =1+sorder*scheduler.config.cascade_event_margin+(sorder?(sorder*2):0);\n\t\t}\n\t\treturn y;\n\t},\n\n\tgetEventHeight: function(event){\n\t\tvar timeline = this;\n\t\tvar section = event[timeline.y_property]; // section id\n\t\tvar eventHeight = timeline.event_dy;\n\t\tconst sectionIndex = timeline.order[section];\n\t\tif (timeline.event_dy == \"full\") {\n\t\t\tif (timeline.section_autoheight) {\n\t\t\t\t// GS-1509 need to calculate row stats to get sections height\n\t\t\t\tscheduler._timeline_get_cur_row_stats(this, sectionIndex);\n\t\t\t\teventHeight = timeline.getSectionHeight(section) - 6;\n\t\t\t} else {\n\t\t\t\teventHeight = timeline.dy - 3;\n\t\t\t}\n\t\t}\n\t\n\t\tif (timeline.resize_events) {\n\t\t\teventHeight = Math.max(Math.floor(eventHeight / (event._count||1)), timeline.event_min_dy);\n\t\t}\n\t\treturn eventHeight;\n\t}\n};\n\n\nscheduler._temp_matrix_scope = function(){\n//---#include ext/timeline/rtl_scroll_helper.js\n\nscheduler.matrix = {};\nscheduler._merge=function(a,b){\n\tfor (var c in b)\n\t\tif (typeof a[c] == \"undefined\")\n\t\t\ta[c]=b[c];\n};\nscheduler.createTimelineView=function(obj){\n\t/*scheduler._skin_init();*/\n\tscheduler._merge(obj,{\n\t\t// scrollable: true,\n\t\tscrollHelper: scrollHelperFactory(),\n\t\tcolumn_width: 100,\n\t\tautoscroll: {\n\t\t\trange_x: 200,// px to edge\n\t\t\trange_y: 100,\n\t\t\tspeed_x: 20,// speed\n\t\t\tspeed_y: 10\n\t\t},\n\n\t\t_is_new_view: true,\n\t\t_section_autowidth: true,\n\t\t_x_scroll: 0,\n\t\t_y_scroll: 0,\n\t\t_h_cols: {}, // [cellId: {div: htmlElem, left: number}, ... {}]\n\t\t_label_rows: [], // [{div: 'html', top: number}, {}, ...]\n\n\t\tsection_autoheight: true,\n\t\tlayout: \"timeline\",\n\t\tname:\"matrix\",\n\t\tx:\"time\",\n\t\ty:\"time\",\n\t\tx_step:1,\n\t\tx_unit:\"hour\",\n\t\ty_unit:\"day\",\n\t\ty_step:1,\n\t\tx_start:0,\n\t\tx_size:24,\n\t\ty_start:0,\n\t\ty_size:\t7,\n\t\tx_date: scheduler.config.hour_date,\n\t\trender:\"cell\",\n\t\tdx:200,\n\t\tdy:50,\n\t\tevent_dy: scheduler.xy.bar_height,\n\t\tevent_min_dy: scheduler.xy.bar_height,\n\t\tresize_events: true,\n\t\tfit_events: true,\n\t\tfit_events_offset: 0,\n\t\tshow_unassigned: false,\n\t\tsecond_scale: false,\n\t\tround_position: false,\n\t\t_logic: function(render_name, y_unit, timeline) {\n\t\t\tvar res = {};\n\t\t\tif(scheduler.checkEvent(\"onBeforeSectionRender\")) {\n\t\t\t\tres = scheduler.callEvent(\"onBeforeSectionRender\", [render_name, y_unit, timeline]);\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t});\n\tobj._original_x_start = obj.x_start;\n\n\t//first and last hours are applied only to day based timeline\n\tif (obj.x_unit != \"day\") obj.first_hour = obj.last_hour = 0;\n\t//correction for first and last hour\n\tobj._start_correction = obj.first_hour?obj.first_hour*60*60*1000:0;\n\tobj._end_correction = obj.last_hour?(24-obj.last_hour)*60*60*1000:0;\n\n\tif (scheduler.checkEvent(\"onTimelineCreated\")) {\n\t\tscheduler.callEvent(\"onTimelineCreated\", [obj]);\n\t}\n\n\teventable(obj);\n\tscheduler.attachEvent(\"onDestroy\", function() {\n\t\tobj.detachAllEvents();\n\t});\n\n\tvar old = scheduler.render_data;\n\tscheduler.render_data = function(evs, mode) {\n\t\tif (this._mode == obj.name) {\n\t\t\t//repaint single event, precision is not necessary\n\t\t\tif (mode && (!obj.show_unassigned || scheduler.getState().drag_id) && obj.render != \"cell\") {\n\t\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\t\tthis.clear_event(evs[i]);\n\t\t\t\t\tthis.render_timeline_event.call(this.matrix[this._mode], evs[i], true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tscheduler._renderMatrix.call(obj, true, true);\n\t\t\t}\n\t\t} else\n\t\t\treturn old.apply(this, arguments);\n\t};\n\n\tscheduler.matrix[obj.name]=obj;\n\tscheduler.templates[obj.name+\"_cell_value\"] = function(ar){ return ar?ar.length:\"\"; };\n\tscheduler.templates[obj.name+\"_cell_class\"] = function(arr){ return \"\"; };\n\t//scheduler.templates[obj.name+\"_scalex_class\"] GS-2314: _scalex_class template comes from scheduler.js\n\tscheduler.templates[obj.name+\"_second_scalex_class\"] = function(date){ return \"\"; };\n\tscheduler.templates[obj.name+\"_row_class\"] = function(section, timeline){\n\t\tif(timeline.folder_events_available && section.children){\n\t\t\t// 'folder' class was added to parent nodes of tree timelines in v5.0\n\t\t\t// pre 5.0 timelines didn't use this class if `folder_events_available` was enabled.\n\t\t\t// Move the classname into template in order not to change the behavior again and give the ability to remove this class by redefining the template\n\t\t\treturn \"folder\";\n\t\t}\n\t\treturn \"\";\n\t};\n\n\tscheduler.templates[obj.name+\"_scaley_class\"] = function(section_id, section_label, section_options){ return \"\"; };\n\t//scheduler.templates[obj.name+\"_scale_label\"] = function(section_id, section_label, section_options){ return section_label; };\n\n\tvar defaultColumnWidth = 20;\n\tfunction configureColumns(columns, timeline){\n\t\tvar totalWidth = timeline.dx;\n\n\t\tvar allocatedWidth = 0;\n\t\tvar fixedSizeColumns = [];\n\t\tvar flexibleColumns = [];\n\n\n\t\tcolumns.forEach(function(column){\n\t\t\tif(column.width){\n\t\t\t\tallocatedWidth += column.width;\n\t\t\t\tcolumn.$width = column.width;\n\t\t\t\tfixedSizeColumns.push(column);\n\t\t\t}else{\n\t\t\t\tflexibleColumns.push(column);\n\t\t\t}\n\t\t});\n\n\t\tvar modifyContainerWidth = false;\n\n\t\tvar freeWidth = totalWidth - allocatedWidth;\n\n\t\tif(freeWidth < 0 || flexibleColumns.length === 0){\n\t\t\tmodifyContainerWidth = true;\n\t\t}\n\t\tvar columnsLeft = flexibleColumns.length;\n\t\tflexibleColumns.forEach(function(column){\n\t\t\tcolumn.$width = Math.max(Math.floor(freeWidth / columnsLeft), defaultColumnWidth);\n\t\t\tfreeWidth -= column.$width;\n\t\t\tallocatedWidth += column.$width;\n\t\t\tcolumnsLeft --;\n\t\t});\n\n\t\tif(modifyContainerWidth){\n\t\t\ttimeline.dx = allocatedWidth;\n\t\t}\n\t}\n\n\tobj.attachEvent(\"onBeforeRender\", function(){\n\t\tif(obj.columns && obj.columns.length){\n\t\t\tconfigureColumns(obj.columns, obj);\n\t\t}\n\t\treturn true;\n\t});\n\t\n\n\n\tobj.renderColumns = obj.renderColumns || scheduler.ext.timeline.renderColumns.bind(obj);\n\tobj.renderHeading = obj.renderHeading || scheduler.ext.timeline.renderHeading.bind(obj);\n\tobj.renderCells = obj.renderCells || scheduler.ext.timeline.renderCells.bind(obj);\n\n\tscheduler.templates[obj.name+\"_scale_label\"] = function(section_id, section_label, section_options){ \n\t\tif(obj.columns && obj.columns.length){\n\t\t\treturn obj.renderColumns(section_options);\n\t\t}else{\n\t\t\treturn section_label;\t\n\t\t}\n\t};\n\n\tscheduler.templates[obj.name + \"_scale_header\"] = function(timeline){\n\t\tif(obj.columns){\n\t\t\treturn timeline.renderHeading(timeline);\n\t\t}else{\n\t\t\treturn scheduler.locale.labels[obj.name + \"_scale_header\"] || \"\";\n\t\t}\n\t};\n\n\tscheduler.templates[obj.name+\"_tooltip\"] = function(a,b,e){ return e.text; };\n\tscheduler.templates[obj.name+\"_date\"] = function(datea, dateb){\n\t\tif ( (datea.getDay()==dateb.getDay() && dateb-datea < (24*60*60*1000)) ||\n\t\t\t+datea == +scheduler.date.date_part(new Date(dateb)) ||\n\t\t\t(+scheduler.date.add(datea, 1, \"day\") == +dateb && dateb.getHours() === 0 && dateb.getMinutes() === 0) )\n\t\t\treturn scheduler.templates.day_date(datea);\n\t\tif ( (datea.getDay() != dateb.getDay() && dateb-datea < (24*60*60*1000)) ) {\n\t\t\treturn scheduler.templates.day_date(datea)+\" &ndash; \"+scheduler.templates.day_date(dateb);\n\t\t}\n\t\treturn scheduler.templates.week_date(datea, dateb);\n\t};\n\n\tlet defautDateFormat = obj.x_date || scheduler.config.hour_date;\n\tlet defaultFormatter = null;\n\tscheduler.templates[obj.name + \"_scale_date\"] = function(date) {\n\t\tif (defautDateFormat !== (obj.x_date || scheduler.config.hour_date) || !defaultFormatter) {\n\t\t\tdefautDateFormat = obj.x_date || scheduler.config.hour_date;\n\t\t\tdefaultFormatter = scheduler.date.date_to_str(defautDateFormat );\n\t\t}\n\t\treturn defaultFormatter(date);\n\t};\n\tlet SecondScaleDateFormat = obj.second_scale && obj.second_scale.x_date ? obj.second_scale.x_date : scheduler.config.hour_date;\n\tlet defautSecondScaleFormatter = null;\n\tscheduler.templates[obj.name + \"_second_scale_date\"] = function(date) {\n\t\tif (SecondScaleDateFormat !== (obj.second_scale.x_date || scheduler.config.hour_date) || !defautSecondScaleFormatter) {\n\t\t\tSecondScaleDateFormat = (obj.second_scale && obj.second_scale.x_date)?obj.second_scale.x_date:scheduler.config.hour_date;\n\t\t\tdefautSecondScaleFormatter = scheduler.date.date_to_str(SecondScaleDateFormat );\n\t\t}\n\t\treturn defautSecondScaleFormatter(date);\n\t};\n\n\tscheduler.date[\"add_\" + obj.name + \"_private\"]= function(date, step){\n\t\tvar shift = step;\n\t\tvar unit = obj.x_unit;\n\n\t\tif(obj.x_unit == \"minute\" || obj.x_unit == \"hour\"){\n\n\t\t\tvar scroll_step = shift;\n\t\t\tif(obj.x_unit == \"hour\")\n\t\t\t\tscroll_step *= 60;\n\t\t\t// if scroll days\n\t\t\tif(!(scroll_step % (24 * 60))){\n\t\t\t\t// use timezone-safer day operations instead of hour and minutes which are affected by daylight saving time shifts\n\t\t\t\tshift = scroll_step / (24 * 60);\n\t\t\t\tunit = 'day';\n\t\t\t}\n\t\t}\n\n\t\treturn scheduler.date.add(date, shift, unit);\n\t};\n\n\tscheduler.date[\"add_\" + obj.name] = function(date, step, c) {\n\t\tvar resulting_date = scheduler.date[\"add_\" + obj.name + \"_private\"](date, (obj.x_length || obj.x_size) * obj.x_step * step);\n\n\t\tif (obj.x_unit == \"minute\" || obj.x_unit == \"hour\") {\n\t\t\tvar size = (obj.x_length || obj.x_size);\n\t\t\tvar converted_step = (obj.x_unit == \"hour\") ? obj.x_step*60 : obj.x_step;\n\t\t\tif((converted_step * size) % (24 * 60)){\n\t\t\t\t//if scroll hours within the day\n\t\t\t\tif ( +scheduler.date.date_part(new Date(date)) == +scheduler.date.date_part(new Date(resulting_date )) ) {\n\t\t\t\t\tobj.x_start += step*size;\n\t\t\t\t} else {\n\t\t\t\t\t// total steps starting from 0\n\t\t\t\t\tvar total_steps = ( (24 * 60) / (size * converted_step) ) - 1;\n\t\t\t\t\tvar steps_offset = Math.round(total_steps * size);\n\n\t\t\t\t\tif (step > 0) {\n\t\t\t\t\t\tobj.x_start = obj.x_start - steps_offset;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj.x_start = steps_offset + obj.x_start;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn resulting_date;\n\t};\n\tscheduler.date[obj.name+\"_start\"] = function(date) {\n\t\tvar func = scheduler.date[obj.x_unit+\"_start\"] || scheduler.date.day_start;\n\t\tvar start_date = func.call(scheduler.date, date);\n\t\tvar start_offset = start_date.getTimezoneOffset();\n\t\tstart_date = scheduler.date.add(start_date, obj.x_step*obj.x_start, obj.x_unit);\n\t\tvar new_offset = start_date.getTimezoneOffset();\n\t\tif(start_offset != new_offset) {\n\t\t\tstart_date.setTime(start_date.getTime() + (new_offset - start_offset) * 60000);\n\t\t}\n\n\t\treturn start_date;\n\t};\n\n\tobj._smartRenderingEnabled = function(){\n\t\tvar viewPort = null;\n\t\tif(this.scrollable || this.smart_rendering){\n\t\t\tviewPort = scheduler._timeline_smart_render.getViewPort(this.scrollHelper, this._sch_height);\n\t\t}\n\t\n\t\tvar scrollableDataContainer = !!viewPort;\n\t\n\t\tvar smartRender;\n\t\tif(!this.scrollable){\n\t\t\t// smart rendering is disabled by default in non-scrollable timelines\n\t\t\tsmartRender = !!this.smart_rendering && scrollableDataContainer;\n\t\t}else{\n\t\t\t// and enabled by default in scrollable timelines\n\t\t\tif(this.smart_rendering === false){\n\t\t\t\tsmartRender = false;\n\t\t\t}else{\n\t\t\t\tsmartRender = !!scrollableDataContainer;\n\t\t\t}\n\t\t}\n\n\t\treturn !!smartRender;\n\t};\n\n\tobj.scrollTo = obj.scrollTo || scheduler.ext.timeline.scrollTo.bind(obj);\n\n\tobj.getScrollPosition = obj.getScrollPosition || scheduler.ext.timeline.getScrollPosition.bind(obj);\n\n\tobj.posFromDate = obj.posFromDate || scheduler.ext.timeline.posFromDate.bind(obj);\n\t\n\tobj.dateFromPos = obj.dateFromPos || scheduler.ext.timeline.dateFromPos.bind(obj);\n\n\tobj.sectionFromPos = obj.sectionFromPos || scheduler.ext.timeline.sectionFromPos.bind(obj);\n\n\tobj.resolvePosition = obj.resolvePosition || scheduler.ext.timeline.resolvePosition.bind(obj);\n\n\tobj.getSectionHeight = obj.getSectionHeight || scheduler.ext.timeline.getSectionHeight.bind(obj);\n\n\tobj.getSectionTop = obj.getSectionTop || scheduler.ext.timeline.getSectionTop.bind(obj);\n\n\tobj.getEventTop = obj.getEventTop || scheduler.ext.timeline.getEventTop.bind(obj);\n\n\tobj.getEventHeight = obj.getEventHeight || scheduler.ext.timeline.getEventHeight.bind(obj);\n\n\tobj.selectEvents = scheduler.bind(function (config) {\n\t\tvar sectionId = config.section,\n\t\t\tdate = config.date,\n\t\t\tselectSubsections = config.selectNested;\n\n\t\tif (date) {\n\t\t\treturn selectByDate(sectionId, date, selectSubsections, this);\n\t\t} else if(sectionId) {\n\t\t\treturn selectBySection(sectionId, selectSubsections, this);\n\t\t}\n\t}, obj);\n\n\tfunction selectBySection(sectionId, selectSubsections, timeline) {\n\t\tvar evs = scheduler._timeline_smart_render.getPreparedEvents(timeline);\n\t\tvar sectionIndex = timeline.order[sectionId];\n\t\tvar section = timeline.y_unit[sectionIndex];\n\t\tif (!section) {\n\t\t\treturn [];\n\t\t}\n\t\tvar subsections = [sectionId];\n\n\t\tif (selectSubsections) {\n\t\t\tgetChildrenIds(section, subsections);\n\t\t}\n\n\t\tvar sectionEvents = [];\n\t\tfor (var i = 0; i < subsections.length; i++){\n\t\t\tvar sectionIndex = timeline.order[subsections[i]];\n\t\t\tif (sectionIndex !== undefined && evs[sectionIndex]) {\n\t\t\t\tsectionEvents = sectionEvents.concat(evs[sectionIndex]);\n\t\t\t} else if (evs.undefined) {\n\t\t\t\tfor (var j = 0; j < evs.undefined.length; j++){\n\t\t\t\t\tvar event = evs.undefined[j];\n\t\t\t\t\tif (event[timeline.y_property] == subsections[i]) {\n\t\t\t\t\t\tsectionEvents.push(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\treturn sectionEvents;\n\t}\n\n\tfunction selectByDate(sectionId, date, selectSubsections, timeline) {\n\t\tvar evs = scheduler._timeline_smart_render.getPreparedEvents(timeline);\n\n\t\tvar columnEvents = [];\n\t\tvar nestedEvents = [];\n\n\t\tvar sectionIndex = timeline.order[sectionId];\n\t\tvar section = timeline.y_unit[sectionIndex];\n\t\tif (!section) {\n\t\t\treturn [];\n\t\t}\n\t\tvar cellIndex = scheduler._get_date_index(timeline, date);\n\t\tif(evs.$matrix){\n\t\t\tcolumnEvents = evs.$matrix[sectionIndex][cellIndex]|| [];\n\t\t\tif(selectSubsections && evs.$matrix.$tree && evs.$matrix.$tree[section.key]){\n\t\t\t\tnestedEvents = evs.$matrix.$tree[section.key][cellIndex] || [];\n\t\t\t}\n\t\t\treturn columnEvents.concat(nestedEvents);\n\t\t}else{\n\t\t\treturn evs[sectionIndex] || [];\n\t\t}\n\t}\n\n\n\tfunction calculateUnits(from, to, timeline){\n\t\tvar scaleStartDate = scheduler.date[timeline.name + '_start'](new Date(from));\n\n\t\t// count the required value of timeline.x_size to display the required range.\n\t\tvar units = 0;\n\t\tvar currentDate = scaleStartDate;\n\t\tvar x_step = timeline.x_step;\n\t\tvar x_unit = timeline.x_unit;\n\t\twhile(currentDate < to){\n\t\t\tunits++;\n\t\t\tcurrentDate = scheduler.date.add(currentDate, x_step, x_unit);\n\t\t}\n\t\t// and modify timeline settings  with the calculated number of steps\n\t\treturn units;\n\t}\n\n\tobj.setRange = scheduler.bind(function(from, to){\n\t\t// calculating the start of the timeline - `startDate`, provided with arguments is to be rounded via date start function:\n\t\tvar scaleStartDate = scheduler.date[this.name + '_start'](new Date(from));\n\t\t// count the required value of timeline.x_size to display the required range.\n\t\tvar units = calculateUnits(from, to, this);\n\n\t\t// and modify timeline settings  with the calculated number of steps\n\t\tthis.x_size = units;\n\n\t\t// when settings are updated - tell scheduler to display a requested start date,\n\t\t// the time scale should contain range from startDate to endDate\n\t\tscheduler.setCurrentView(scaleStartDate, this.name);\n\t}, obj);\n\n\tscheduler.callEvent(\"onOptionsLoad\",[obj]);\n\n\t//init custom wrappers\n\tscheduler[obj.name+\"_view\"]=function(enable){\n\t\tif(enable){\n\t\t\tscheduler._set_timeline_dates(obj);\n\t\t\t//_renderMatrix will be called by render_data immediately after\n\t\t}else{\n\t\t\tscheduler._renderMatrix.apply(obj, arguments);\n\t\t}\n\t};\n\n\t//enable drag for non-cell modes\n\t//var temp_date = new Date();\n\t// var step_diff = (scheduler.date.add(temp_date, obj.x_step, obj.x_unit).valueOf() - temp_date.valueOf()); // \"minute\" + step in ms\n\tscheduler[\"mouse_\"+obj.name]=function(pos){ //mouse_coord handler\n\t\t//get event object\n\t\tvar ev = this._drag_event;\n\t\tif (this._drag_id){\n\t\t\tev = this.getEvent(this._drag_id);\n\t\t}\n\t\tif (obj.scrollable  && !pos.converted) {\n\t\t\tpos.converted = 1;\n\t\t\tpos.x += -obj.dx + obj._x_scroll;\n\t\t\tif (scheduler.config.rtl) {\n\t\t\t\tvar labelWrapperHeight = +scheduler.$container.querySelector(\".dhx_timeline_label_wrapper\").style.height.replace(\"px\", \"\");\n\t\t\t\tvar scalesHeight = obj._section_height[obj.y_unit.length] + obj._label_rows[obj._label_rows.length - 1].top;\n\t\t\t\tpos.x += scheduler.xy.scale_width;\n\t\t\t\tif (obj.scrollHelper.getMode() == obj.scrollHelper.modes.minMax && (scalesHeight > labelWrapperHeight || obj.render == \"tree\")) pos.x += getScrollbarwidth();\n\t\t\t}\n\t\t\tpos.y += obj._y_scroll;\n\t\t} else if (!scheduler.config.rtl){\n\t\t\tpos.x -= obj.dx;\n\t\t} else {\n\t\t\tpos.x -= (obj.dx-scheduler.xy.scale_width);\n\t\t}\n\t\tvar end_date = scheduler._timeline_drag_date(obj, pos.x);\n\n\t\tpos.x =  0;\n\t\tpos.force_redraw = true;\n\t\tpos.custom = true;\n\n\t\t// as we can simply be calling _locate_cell_timeline\n\t\tif (this._drag_mode == \"move\" && this._drag_id && this._drag_event) {\n\t\t\tvar ev = this.getEvent(this._drag_id);\n\t\t\tvar drag_event = this._drag_event;\n\n\t\t\tpos._ignores = (this._ignores_detected || obj._start_correction || obj._end_correction);\n\t\t\tif (drag_event._move_delta === undefined) {\n\t\t\t\tdrag_event._move_delta = (ev.start_date-end_date)/60000;\n\t\t\t\tif (this.config.preserve_length && pos._ignores){\n\t\t\t\t\tdrag_event._move_delta = this._get_real_event_length(ev.start_date,end_date, obj);\n\t\t\t\t\tdrag_event._event_length = this._get_real_event_length(ev.start_date,ev.end_date, obj);\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t//preserve visible size of event\n\t\t\tif (this.config.preserve_length && pos._ignores){\n\t\t\t\t//var ev_length = drag_event._event_length;//this._get_real_event_length(ev.start_date, ev.end_date, obj);\n\t\t\t\tvar current_back_shift = this._get_fictional_event_length(end_date, drag_event._move_delta, obj, true);\n\t\t\t\tend_date = new Date(end_date - current_back_shift);\n\t\t\t} else {\n\t\t\t\t// converting basically to start_date\n\t\t\t\tend_date = scheduler.date.add(end_date, drag_event._move_delta, \"minute\");\n\t\t\t}\n\t\t}\n\n\t\tif (this._drag_mode == \"resize\" && ev){\n\t\t\tif(this.config.timeline_swap_resize && this._drag_id){\n\t\t\t\tif(this._drag_from_start && +end_date> +ev.end_date){\n\t\t\t\t\tthis._drag_from_start = false;\n\t\t\t\t}else if(!this._drag_from_start && +end_date < +ev.start_date){\n\t\t\t\t\tthis._drag_from_start = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpos.resize_from_start = this._drag_from_start;\n\t\t\tif(!this.config.timeline_swap_resize && this._drag_id){\n\t\t\t\tif(this._drag_from_start && +end_date >= +scheduler.date.add(ev.end_date, -scheduler.config.time_step, \"minute\")){\n\t\t\t\t\tend_date = scheduler.date.add(ev.end_date, -scheduler.config.time_step, \"minute\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (obj.round_position) {\n\t\t\tswitch(this._drag_mode) {\n\t\t\t\tcase \"move\":\n\t\t\t\t\tif (!this.config.preserve_length){\n\t\t\t\t\t\tend_date = scheduler._timeline_get_rounded_date.call(obj, end_date, false);\n\t\t\t\t\t\t// to preserve original start and end dates\n\t\t\t\t\t\tif(obj.x_unit == \"day\")//only make sense for whole-day cells\n\t\t\t\t\t\t\tpos.custom = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"resize\":\n\t\t\t\t\tif(this._drag_event){\n\t\t\t\t\t\t// will save and use resize position only once\n\t\t\t\t\t\tif (this._drag_event._resize_from_start === null || this._drag_event._resize_from_start === undefined) {\n\t\t\t\t\t\t\tthis._drag_event._resize_from_start = pos.resize_from_start;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpos.resize_from_start = this._drag_event._resize_from_start;\n\t\t\t\t\t\tend_date = scheduler._timeline_get_rounded_date.call(obj, end_date, !this._drag_event._resize_from_start);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis._resolve_timeline_section(obj, pos);\n\t\tif(pos.section){\n\t\t\t// update draggable event with current section\n\t\t\tthis._update_timeline_section({pos:pos, event:this.getEvent(this._drag_id), view:obj});\n\t\t}\n\t\tpos.y = Math.round((this._correct_shift(end_date,1)-this._min_date)/(1000*60*this.config.time_step));\n\t\tpos.shift = this.config.time_step; //step_diff;\n\n\t\tif (obj.round_position && this._drag_mode == \"new-size\") {\n\t\t\tif(end_date <= this._drag_start){\n\t\t\t\tpos.shift = scheduler.date.add(this._drag_start, obj.x_step, obj.x_unit) - this._drag_start;\n\t\t\t}\n\t\t}\n\n\t\tvar pos_changed = this._is_pos_changed(this._drag_pos, pos);\n\t\tif(this._drag_pos && pos_changed){\n\t\t\tthis._drag_event._dhx_changed = true;\n\t\t}\n\t\tif(!pos_changed && !this._drag_pos.has_moved)\n\t\t\tpos.force_redraw = false;\n\n\t\treturn pos;\n\t};\n};\n\nscheduler._prepare_timeline_events = function(timeline){\n\tvar evs = [];\n\tif (timeline.render == \"cell\"){\n\t\tevs = scheduler._timeline_trace_events.call(timeline);\n\t} else {\n\n\t\tvar tevs = scheduler.get_visible_events();\n\t\tvar order = timeline.order;\n\n\t\tfor (var j = 0; j < tevs.length; j++) {\n\t\t\tvar tev = tevs[j];\n\t\t\tvar tev_section = tev[timeline.y_property];\n\t\t\tvar index = timeline.order[ tev_section ];\n\t\t//\tvar sectionObject = timeline.y_unit[index];\n\n\t\t\tif (timeline.show_unassigned && !tev_section) {\n\t\t\t\tfor (var key in order) {\n\t\t\t\t\tif (order.hasOwnProperty(key)) {\n\t\t\t\t\t\tindex = order[key];\n\t\t\t\t\t\tif (!evs[index]) evs[index] = [];\n\t\t\t\t\t\tvar clone = scheduler._lame_copy({}, tev);\n\t\t\t\t\t\tclone[timeline.y_property] = key;\n\t\t\t\t\t\tevs[index].push(clone);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// required as we could have index of not displayed section or \"undefined\"\n\t\t\t\tif (!evs[index]) evs[index] = [];\n\t\t\t\tevs[index].push(tev);\n\t\t\t}\n\t\t}\n\n\t\t//if(timeline.cell_template){\n\t\tevs.$matrix = scheduler._timeline_trace_events.call(timeline);\n\t\t//}\n\n\n\t}\n\treturn evs;\n};\n\nscheduler._populate_timeline_rendered = function(container){\n\tscheduler._rendered = [];\n\tconst dataContainer = container.querySelector(\".dhx_timeline_data_col\");\n\tconst rows = Array.prototype.slice.call(dataContainer.children);\n\n\tif (scheduler._timeline_smart_render && scheduler._timeline_smart_render._rendered_events_cache) {\n\t\tscheduler._timeline_smart_render._rendered_events_cache = [];\n\t}\n\trows.forEach(function(row){\n\t\tconst rowIndex = Number(row.getAttribute(\"data-section-index\"));\n\t\tconst rowChildren = Array.prototype.slice.call(row.children);\n\t\trowChildren.forEach(function(child){\n\t\t\tconst eventId = child.getAttribute(scheduler.config.event_attribute);\n\t\t\tif(eventId){\n\t\t\t\tscheduler._rendered.push(child);\n\t\t\t\tif (scheduler._timeline_smart_render && scheduler._timeline_smart_render._rendered_events_cache) {\n\t\t\t\t\t// save to cache\n\t\t\t\t\tconst smartRenderCache = scheduler._timeline_smart_render._rendered_events_cache;\n\t\t\t\t\tif (!smartRenderCache[rowIndex])\n\t\t\t\t\t\tsmartRenderCache[rowIndex] = [];\n\t\t\t\t\tsmartRenderCache[rowIndex].push(eventId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\treturn;\n};\n\nscheduler.render_timeline_event = function(ev, attach){\n\tvar section = ev[this.y_property]; // section id\n\tif (!section)\n\t\treturn \"\"; // as we may await html\n\n\tvar sorder = ev._sorder;\n\n\tvar x_start = scheduler._timeline_getX(ev, false, this);\n\tvar x_end = scheduler._timeline_getX(ev, true, this);\n\n//\tvar event_height = scheduler._get_timeline_event_height(ev, this);\n\n\tvar event_height = scheduler._get_timeline_event_height ? scheduler._get_timeline_event_height(ev, this) : this.getEventHeight(ev);\n\tvar hb = event_height - 2;// takes into account css sizes (border/padding)\n\tif (!ev._inner && this.event_dy == \"full\") {\n\t\tvar coefficient = ev._count - sorder; //number that shows the difference between the current outer event and the maximum number of events\n\t\tif (coefficient == 0) {\n\t\t\tcoefficient = 1;\n\t\t}\n\t\thb=(hb+1)*(coefficient) - 2; // height for outer full events\n\t}\n\n\t///*hb += 3*/;// correction for border-box sizing\n\n\tvar y = scheduler._get_timeline_event_y ? scheduler._get_timeline_event_y(ev._sorder, event_height) : this.getEventTop(ev);\n\n\tvar section_height = event_height+y+2;\n\tif(!this._events_height[section] || (this._events_height[section] < section_height)){\n\t\tthis._events_height[section] = section_height;\n\t}\n\n\tvar cs = scheduler.templates.event_class(ev.start_date,ev.end_date,ev);\n\tcs = \"dhx_cal_event_line \"+(cs||\"\");\n\n\tif(scheduler.getState().select_id == ev.id){\n\t\tcs += \" dhx_cal_event_selected\";\n\t}\n\n\tif(ev._no_drag_move){\n\t\tcs += \" no_drag_move\";\n\t}\n\n\tvar bg_color = (ev.color?(\"--dhx-scheduler-event-background:\"+ev.color+\";\"):\"\");\n\tvar color = (ev.textColor?(\"--dhx-scheduler-event-color:\"+ev.textColor+\";\"):\"\");\n\tvar text = scheduler.templates.event_bar_text(ev.start_date,ev.end_date,ev);\n\n\tconst width = Math.max(0,x_end-x_start);\n\tif(width < 70) {\n\t\tcs += \" dhx_cal_event--small\";\n\t}\n\tif(width < 40) {\n\t\tcs += \" dhx_cal_event--xsmall\";\n\t}\n\n\tvar html=\"<div \"+scheduler._waiAria.eventBarAttrString(ev)+\" event_id='\"+ev.id+\"' \"+scheduler.config.event_attribute+\"='\"+ev.id+\"' class='\"+cs+\"' style='\"+bg_color+color+\"position:absolute; top:\"+y+\"px; height: \"+hb+\"px; \"+(scheduler.config.rtl ? \"right:\":\"left:\")+x_start+\"px; width:\"+width+\"px;\"+(ev._text_style||\"\")+\"'>\";\n\tif (scheduler.config.drag_resize && !scheduler.config.readonly) {\n\t\tvar dhx_event_resize = 'dhx_event_resize';\n\n\t\tvar hb_local = hb + 1; // corrected hb after changing table to divs, position of resize markers were rendered wrong\n\t\tvar resize_start = \"<div class='\"+dhx_event_resize+\" \"+dhx_event_resize+\"_start' style='height: \"+hb_local+\"px;'></div>\";\n\t\tvar resize_end = \"<div class='\"+dhx_event_resize+\" \"+dhx_event_resize+\"_end' style='height: \"+hb_local+\"px;'></div>\";\n\t\thtml += (!ev._no_resize_start ? resize_start : \"\") + (!ev._no_resize_end ? resize_end : \"\");\n\t}\n\thtml += (text+'</div>');\n\n\tif (!attach)\n\t\treturn html;\n\telse {\n\n\t\tvar d = document.createElement(\"div\");\n\t\td.innerHTML = html;\n\n\t\tvar parentSection = this._scales[section];\n\t\tif (parentSection){\n\t\t\tscheduler._rendered.push(d.firstChild);\n\t\t\tparentSection.appendChild(d.firstChild);\n\t\t}\n\t}\n};\n\nfunction getChildrenIds(root, result){\n\tresult = result || [];\n\tif(root.children){\n\t\tfor(var i = 0; i < root.children.length; i++){\n\t\t\tresult.push(root.children[i].key);\n\t\t\tgetChildrenIds(root.children[i], result);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction getSectionIndex(sectionId, timeline){\n\tvar sectionIndex = timeline.order[sectionId];\n\tif(sectionIndex === undefined){\n\t\t// row inside a collapsed branch\n\t\tsectionIndex = \"$_\" + sectionId;\n\t}\n\treturn sectionIndex;\n}\n\nfunction iterateSectionsTree(root, result){\n\tresult[root.key] = root;\n\tif(root.children){\n\t\tfor(var i = 0; i < root.children.length; i++){\n\t\t\titerateSectionsTree(root.children[i], result);\n\t\t}\n\t}\n}\n\nfunction buildSectionsHash(timeline){\n\tvar result = {};\n\tvar units = timeline.y_unit_original || timeline.y_unit;\n\tfor(var i = 0; i < units.length; i++){\n\t\titerateSectionsTree(units[i], result);\n\n\t}\n\treturn result;\n\n}\n\nfunction prepareCellMatrix(events, timeline){\n\tvar matrix =[];\n\tfor (var i=0; i < timeline.y_unit.length; i++){\n\t\tmatrix[i]=[];\n\t}\n\n\t//next code defines row for undefined key\n\t//most possible it is an artifact of incorrect configuration\n\tvar sectionIndex;\n\tif (!matrix[sectionIndex]){\n\t\tmatrix[sectionIndex]=[];\n\t}\n\n\tvar sectionsSearch = buildSectionsHash(timeline);\n\n\tvar fillFolders = timeline.render == \"tree\";\n\tif(fillFolders){\n\t\tmatrix.$tree = {};\n\t}\n\n\tfunction fillXArray(matrix, sectionIndex, xFrom, xTo){\n\t\tif(!matrix[sectionIndex]){\n\t\t\tmatrix[sectionIndex]=[];\n\t\t}\n\t\tfor(var x = xFrom; x <= xTo; x++){\n\t\t\tif (!matrix[sectionIndex][x]) matrix[sectionIndex][x]=[];\n\t\t\tmatrix[sectionIndex][x].push(event);\n\t\t}\n\t}\n\n\tvar sectionProperty = timeline.y_property;\n\tfor (var i=0; i < events.length; i++) {\n\t\tvar event = events[i];\n\t\tvar sectionKey = event[sectionProperty];\n\t\tsectionIndex = getSectionIndex(sectionKey, timeline);\n\t\tvar scaleIndexStart = scheduler._get_date_index(timeline, event.start_date);\n\t\tvar scaleIndexEnd = scheduler._get_date_index(timeline, event.end_date);\n\t\tif(event.end_date.valueOf() == timeline._trace_x[scaleIndexEnd].valueOf()){\n\t\t\tscaleIndexEnd -= 1;\n\t\t}\n\n\t\tif(!matrix[sectionIndex]){\n\t\t\tmatrix[sectionIndex]=[];\n\t\t}\n\n\t\tfillXArray(matrix, sectionIndex, scaleIndexStart, scaleIndexEnd);\n\n\t\tvar current = sectionsSearch[sectionKey];\n\t\tif(fillFolders && current && current.$parent){\n\t\t\tvar traversed = {};\n\t\t\t\n\t\t\twhile(current.$parent){\n\t\t\t\tif(traversed[current.key]) {\n\t\t\t\t\tthrow new Error(\"Invalid sections tree. Section `{key:'\" + current.key + \"', label:'\"+current.label+\"'}` \" +\n\t\t\t\t\t\"has the same key as one of its parents. Make sure all sections have unique keys\");\n\t\t\t\t}\n\t\t\t\ttraversed[current.key] = true;\n\n\t\t\t\tvar parent = sectionsSearch[current.$parent];\n\t\t\t\tfillXArray(matrix.$tree, parent.key, scaleIndexStart, scaleIndexEnd);\n\t\t\t\tcurrent = parent;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn matrix;\n}\n\nvar escapeForAttribute = function(rawValue){\n\tvar value = String(rawValue);\n\treturn value.replace(/'/g, \"&apos;\").replace(/\"/g, '&quot;');\n};\n\nscheduler._timeline_trace_events = function trace_events(){\n\t//minimize event set\n\tvar evs = scheduler.get_visible_events();\n\tvar matrix = prepareCellMatrix(evs, this);\n\t//if(this.render == \"tree\"){\n\t//\tfillFolderEvents(matrix, this);\n\t//}\n\treturn matrix;\n};\n\n// function used to get X (both start and end) coordinates for timeline bar view\nscheduler._timeline_getX = function _getX(ev, isEndPoint, config) {\n\tvar x = 0;\n\tvar step = config._step;\n\tvar round_position = config.round_position;\n\n\tvar column_offset = 0;\n\tvar date = (isEndPoint) ? ev.end_date : ev.start_date;\n\t//GS-2775: set the step according to the days in month\n\tif(config.x_unit == \"month\"){\n\t\tconst daysInMonth = new Date(new Date(date).getFullYear(), new Date(date).getMonth()+1, 0).getDate();\n\t\tstep = (daysInMonth * 24*60*60*1000)/scheduler._cols[0];\n\t}\n\tif(date.valueOf()>scheduler._max_date.valueOf())\n\t\tdate = scheduler._max_date;\n\tvar delta = date - scheduler._min_date_timeline;\n\n\tif (delta > 0){\n\t\tvar index = scheduler._get_date_index(config, date);\n\t\tif (scheduler._ignores[index])\n\t\t\tround_position=true;\n\n\t\tfor (var i = 0; i < index; i++) {\n\t\t\tx += scheduler._cols[i];\n\t\t}\n\n\t\tvar column_date = scheduler._timeline_get_rounded_date.apply(config, [date, false]);\n\t\t//var column_date = scheduler.date.add(scheduler._min_date_timeline, scheduler.matrix[scheduler._mode].x_step*index, scheduler.matrix[scheduler._mode].x_unit);\n\t\tif (!round_position) {\n\t\t\tdelta = date - column_date;\n\t\t\tif (config.first_hour || config.last_hour){\n\t\t\t\tdelta = delta - config._start_correction;\n\t\t\t\tif (delta < 0) delta = 0;\n\t\t\t\tcolumn_offset = Math.round(delta/step);\n\t\t\t\tif (column_offset > scheduler._cols[index])\n\t\t\t\t\tcolumn_offset = scheduler._cols[index];\n\t\t\t} else {\n\t\t\t\tcolumn_offset = Math.round(delta/step);\n\t\t\t}\n\t\t} else {\n\t\t\tif (+date > +column_date && isEndPoint) {\n\t\t\t\tcolumn_offset = scheduler._cols[index];\n\t\t\t}\n\t\t}\n\t}\n\n\t//var borderBox = scheduler._border_box_events();\n\n\tif (isEndPoint) {\n\t\t// special handling for \"round\" dates which match columns and usual ones\n\t\tif (delta !== 0 && !round_position) {\n\t\t\tx += column_offset;\n\t\t} else {\n\t\t\tx += column_offset - 1;\n\t\t}\n\t} else {\n\t\tx += column_offset;\n\t}\n\treturn x;\n};\n\nscheduler._timeline_get_rounded_date = function get_rounded_date(date, isEndDate) {\n\tvar index = scheduler._get_date_index(this, date);\n\tvar rounded_date = this._trace_x[index];\n\tif (isEndDate && (+date != +this._trace_x[index])) {\n\t\trounded_date = (this._trace_x[index+1]) ? this._trace_x[index+1] : scheduler.date.add(this._trace_x[index], this.x_step, this.x_unit);\n\t}\n\treturn new Date(rounded_date);\n};\n\nscheduler._timeline_skip_ignored = function skip_ignored(evs){\n\n\tif(scheduler._ignores_detected){\n\t\tvar from,\n\t\t\tto,\n\t\t\tvisible,\n\t\t\tev;\n\n\t\tfor(var i = 0; i < evs.length; i++){\n\t\t\tev = evs[i];\n\t\t\tvisible = false;\n\t\t\tfrom = scheduler._get_date_index(this, ev.start_date);\n\t\t\tto = scheduler._get_date_index(this, ev.end_date);\n\n\t\t\twhile(from < to){\n\t\t\t\tif(!scheduler._ignores[from]){\n\t\t\t\t\tvisible = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tfrom++;\n\t\t\t}\n\t\t\tif(!visible && from == to && !scheduler._ignores[to]){\n\t\t\t\tif(+ev.end_date > +this._trace_x[to]){\n\t\t\t\t\tvisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!visible){\n\t\t\t\tevs.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t}\n};\n\n// calculates timeline event sorder and update timeline section heights\nscheduler._timeline_calculate_event_positions = function(evs){\n\tif (evs && this.render != \"cell\"){\n\n\t\tscheduler._timeline_skip_ignored.call(this, evs);\n\n\t\tevs.sort(this.sort || function(a,b){\n\t\t\tif (a.start_date.valueOf() == b.start_date.valueOf())\n\t\t\t\treturn a.end_date.valueOf() > b.end_date.valueOf() ? -1 : 1;\n\t\t\treturn a.start_date > b.start_date ? 1 : -1;\n\t\t});\n\t\tvar stack=[];\n\t\tvar evs_length = evs.length;\n\t\tvar maxOrder = -1, maxOrderEvent = null;\n\n\t\t// prepare events for render\n\t\tfor (var j=0; j<evs_length; j++){\n\t\t\tvar ev = evs[j];\n\t\t\tev._inner = false;\n\n\t\t\tvar ev_start_date = (this.round_position) ? scheduler._timeline_get_rounded_date.apply(this, [ev.start_date, false]) : ev.start_date;\n\t\t//\tvar ev_end_date = (this.round_position) ? scheduler._timeline_get_rounded_date.apply(this, [ev.end_date, true]) : ev.end_date;\n\n\t\t\t// cutting stack from the last -> first event side\n\t\t\twhile (stack.length) {\n\t\t\t\tvar stack_ev = stack[stack.length-1];\n\t\t\t\tif (stack_ev.end_date.valueOf() <= ev_start_date.valueOf()) {\n\t\t\t\t\tstack.splice(stack.length-1,1);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// cutting stack from the first -> last event side\n\t\t\tvar sorderSet = false;\n\t\t\tfor(var p=0; p<stack.length; p++){\n\t\t\t\tvar t_ev = stack[p];\n\t\t\t\tif(t_ev.end_date.valueOf() <= ev_start_date.valueOf()){\n\t\t\t\t\tsorderSet = true;\n\t\t\t\t\tev._sorder=t_ev._sorder;\n\t\t\t\t\tstack.splice(p,1);\n\t\t\t\t\tev._inner=true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (stack.length)\n\t\t\t\tstack[stack.length-1]._inner=true;\n\n\n\t\t\tif (!sorderSet) {\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tif (stack.length <= stack[stack.length - 1]._sorder) {\n\t\t\t\t\t\tif (!stack[stack.length - 1]._sorder)\n\t\t\t\t\t\t\tev._sorder = 0;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tfor (var h = 0; h < stack.length; h++) {\n\t\t\t\t\t\t\t\tvar _is_sorder = false;\n\t\t\t\t\t\t\t\tfor (var t = 0; t < stack.length; t++) {\n\t\t\t\t\t\t\t\t\tif (stack[t]._sorder == h) {\n\t\t\t\t\t\t\t\t\t\t_is_sorder = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!_is_sorder) {\n\t\t\t\t\t\t\t\t\tev._sorder = h;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tev._inner = true;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar _max_sorder = stack[0]._sorder;\n\t\t\t\t\t\tfor (var w = 1; w < stack.length; w++)\n\t\t\t\t\t\t\tif (stack[w]._sorder > _max_sorder)\n\t\t\t\t\t\t\t\t_max_sorder = stack[w]._sorder;\n\t\t\t\t\t\tev._sorder = _max_sorder + 1;\n\t\t\t\t\t\tif(maxOrder < ev._sorder){\n\t\t\t\t\t\t\tmaxOrder = ev._sorder;\n\t\t\t\t\t\t\tmaxOrderEvent = ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tev._inner = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tev._sorder = 0;\n\t\t\t}\n\n\t\t\tstack.push(ev);\n\n\t\t\tif (stack.length>(stack.max_count||0)) {\n\t\t\t\tstack.max_count=stack.length;\n\t\t\t\tev._count=stack.length;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tev._count=(ev._count)?ev._count:1;\n\t\t\t}\n\t\t}\n\t\t// fix _count for every event\n\t\tfor (var m=0; m < evs.length; m++) {\n\t\t\tevs[m]._count = stack.max_count;\n\t\t\t// if multisection events are enabled - store a copy to be rendered in order to have access to dynamic _count/_index properties\n\t\t\tif(scheduler._register_copy){\n\t\t\t\tscheduler._register_copy(evs[m]);\n\t\t\t}\n\t\t}\n\n\t\tif(maxOrderEvent || evs[0]){\n\t\t\tscheduler.render_timeline_event.call(this, maxOrderEvent || evs[0], false);\n\t\t}\n\t}\n};\n\nscheduler._timeline_get_events_html = function get_events_html(evs) {\n\tvar html = \"\";\n\tif (evs && this.render != \"cell\"){\n\t\t// render events\n\t\tfor (var v=0; v<evs.length; v++) {\n\t\t\thtml+=scheduler.render_timeline_event.call(this, evs[v], false);\n\t\t}\n\t}\n\treturn html;\n};\n\nscheduler._timeline_update_events_html = function get_events_html(evs) {\n\tvar html = \"\";\n\tif (evs && this.render != \"cell\"){\n\n\t\tvar view = scheduler.getView();\n\t\t// cleanup previously rendered events\n\t\tvar ids = {};\n\t\tvar getEventKey = function(eventId, sectionProperty){\n\t\t\treturn eventId + '_' + sectionProperty;\n\t\t};\n\t\tevs.forEach(function(event){\n\t\t\tids[getEventKey(event.id, event[view.y_property])] = true;\n\t\t});\n\t\t/*scheduler._rendered.forEach(function(element){\n\t\t\tif(element.parentNode){\n\t\t\t\tvar sectionId = element.parentNode.getAttribute(\"data-section-id\");\n\t\t\t\tif(ids[getEventKey(element.getAttribute(scheduler.config.event_attribute), sectionId)]){\n\t\t\t\t\telement.parentNode.removeChild(element);\n\t\t\t\t}\n\t\t\t}\n\t\t});*/\n\n\t\t// render events\n\t\tfor (var v=0; v<evs.length; v++) {\n\t\t\thtml+=scheduler.render_timeline_event.call(this, evs[v], false);\n\t\t}\n\t}\n\treturn html;\n};\n\n\n// calculate general stats for main blocks (divs)\nscheduler._timeline_get_block_stats = function (d, view) {\n\tvar stats = {};\n\n\tview._sch_height = d.offsetHeight;\n\n\t// define height of dhx_timeline_data_wrapper and dhx_timeline_label_wrapper\n\tstats.style_data_wrapper = (scheduler.config.rtl ? \"padding-right:\": \"padding-left:\") + view.dx + \"px;\";\n\tstats.style_label_wrapper = \"width: \" + view.dx + \"px;\";\n\tif (view.scrollable) {\n\n\t\tstats.style_data_wrapper += \"height:\" + (view._sch_height - 1) + \"px;\";\n\t\tif (view.html_scroll_width === undefined) // define once for correct height of label_wrapper\n\t\t\tview.html_scroll_width = getScrollbarwidth();\n\t\tif(view._section_autowidth){\n\t\t\tview.custom_scroll_width = 0;\n\t\t}else{\n\t\t\tview.custom_scroll_width = view.html_scroll_width;\n\t\t}\n\n\t\tstats.style_label_wrapper  += \"height:\" + (view._sch_height - 1 - view.custom_scroll_width) + \"px;\";\n\t}else{\n\t\tstats.style_data_wrapper += \"height:\" + (view._sch_height - 1) + \"px;\";\n\t\tstats.style_label_wrapper  += \"height:\" + (view._sch_height - 1) + \"px;overflow:visible;\";\n\t}\n\treturn stats;\n};\n\nfunction sectionHasCustomHeight(section){\n\treturn (section.height && !isNaN(Number(section.height)));\n}\n\nfunction getRowsBaseHeight(view, defaultHeight){\n\tvar totalHeight = 0;\n\tvar rowsWithDefaultHeight = view.y_unit.length;\n\tvar totalCustomHeight = 0;\n\tview.y_unit.forEach(function(section){\n\t\tif(sectionHasCustomHeight(section)){\n\t\t\ttotalHeight += Number(section.height);\n\t\t\ttotalCustomHeight += Number(section.height);\n\t\t\trowsWithDefaultHeight --;\n\t\t}\n\t});\n\ttotalHeight += rowsWithDefaultHeight * defaultHeight;\n\treturn { totalHeight, rowsWithDefaultHeight, totalCustomHeight };\n}\n\n// calculate stats for current row\nscheduler._timeline_get_cur_row_stats = function(view, i) {\n\tvar section = view.y_unit[i];\n\tvar stats = view._logic(view.render, section, view); // obj with custom style\n\n\tscheduler._merge(stats, {\n\t\theight: view.dy\n\t});\n\n\t// autosize height, if we have a free space and the height of this section is not specified explicitly\n\tif (view.section_autoheight && !sectionHasCustomHeight(section)) {\n\t\tvar rowBaseSizes = getRowsBaseHeight(view, stats.height);\n\n\t\tvar heightWithoutScroll = view.scrollable ? view._sch_height - scheduler.xy.scroll_width : view._sch_height;\n\t\tif (rowBaseSizes.totalHeight < heightWithoutScroll && rowBaseSizes.rowsWithDefaultHeight > 0) {\n\t\t\tstats.height = Math.max(stats.height, Math.floor((heightWithoutScroll - 1 - rowBaseSizes.totalCustomHeight) / rowBaseSizes.rowsWithDefaultHeight));\n\t\t}\n\t}\n\n\tif(sectionHasCustomHeight(section)){\n\t\tstats.height = Number(section.height);\n\t}\n\n\tview._section_height[section.key] = stats.height;\n\n\tif(!stats.td_className){\n\t\tstats.td_className = \"dhx_matrix_scell\";\n\t\t\n\t\tvar cssTemplate = scheduler.templates[view.name+\"_scaley_class\"](view.y_unit[i].key, view.y_unit[i].label, view.y_unit[i]);\n\t\tif(cssTemplate){\n\t\t\tstats.td_className += \" \" + cssTemplate;\n\t\t}\n\t\t\n\t\tif(view.columns){\n\t\t\tstats.td_className += \" dhx_matrix_scell_columns\";\n\t\t}\n\t}\n\tif(!stats.td_content){\n\t\tstats.td_content = scheduler.templates[view.name+'_scale_label'](view.y_unit[i].key, view.y_unit[i].label, view.y_unit[i]);\n\t}\n\tscheduler._merge(stats, {\n\t\t//section 1\n\t\ttr_className: \"\",\n\t\tstyle_height: \"height:\"+stats.height+\"px;\",\n\t\tstyle_width: \"width:\"+(view.dx)+\"px;\",\n\t\t//section 2\n\t\tsumm_width: \"width:\"+view._summ+\"px;\",\n\t\t//section 3\n\t\ttable_className: ''\n\t});\n\n\treturn stats;\n};\n\nfunction getRowSizes(timeline, eventsBySections){\n\tvar rowStats = [];\n\tvar rowStatsByKey = {};\n\tvar totalRowsHeight = 0;\n\tfor (var rowIndex=0; rowIndex<timeline.y_unit.length; rowIndex++){\n\t\tscheduler._timeline_calculate_event_positions.call(timeline, eventsBySections[rowIndex]);\n\t\tvar stats = scheduler._timeline_get_cur_row_stats(timeline, rowIndex);\n\n\t\tstats = scheduler._timeline_get_fit_events_stats(timeline, rowIndex, stats);\n\t\tstats.top = totalRowsHeight;\n\t\trowStats.push(stats);\n\t\trowStatsByKey[timeline.y_unit[rowIndex].key] = stats;\n\n\t\ttotalRowsHeight += stats.height;\n\n\t}\n\n\treturn {\n\t\ttotalHeight: totalRowsHeight,\n\t\trowStats,\n\t\trowStatsByKey\n\t};\n}\n\n// calculate stats for fit_events\nscheduler._timeline_get_fit_events_stats = function(view, i, stats) {\n\tif(view.fit_events){\n\t\tvar rendered_height = view._events_height[view.y_unit[i].key]||0;\n\t\tif(view.fit_events_offset){\n\t\t\trendered_height += view.fit_events_offset;\n\t\t}\n\t\tstats.height = (rendered_height>stats.height)?rendered_height:stats.height;\n\t\tstats.style_height = \"height:\"+stats.height+\"px;\";\n\t\tstats.style_line_height = \"line-height:\" + (stats.height - 1) + \"px;\";\n\t\tview._section_height[view.y_unit[i].key] = stats.height;\n\t}\n\tstats.style_height = \"height:\"+stats.height+\"px;\";\n\tstats.style_line_height = \"line-height:\" + (stats.height - 1) + \"px;\";\n\tview._section_height[view.y_unit[i].key] = stats.height;\n\n\treturn stats;\n};\n\n/* scroll */\n// set scroll positions that were saved previously\nscheduler._timeline_set_scroll_pos = function(d, view) {\n\tvar dataWrapperDiv = d.querySelector('.dhx_timeline_data_wrapper');\n\tdataWrapperDiv.scrollTop = view._y_scroll || 0;\n\tview.scrollHelper.setScrollValue(dataWrapperDiv, view._x_scroll || 0);\n\tif (view.scrollHelper.getMode() != view.scrollHelper.modes.maxMin && dataWrapperDiv.scrollLeft == view._summ - dataWrapperDiv.offsetWidth + view.dx) dataWrapperDiv.scrollLeft += getScrollbarwidth();\n};\n\n// save current scroll positions\nscheduler._timeline_save_scroll_pos = function(view, scrollTop, scrollLeft, scrollWidth) {\n\tview._y_scroll = scrollTop || 0;\n\tview._x_scroll = scrollLeft || 0;\n};\n/* scroll end */\n\n/* get html section */\n// cell mode\n\nscheduler._timeline_get_html_for_cell_data_row = function(i, stats, top_pos, rowId, templateParams) {\n\tvar css = \"\";\n\tif(templateParams.template){\n\t\tcss += \" \" + (templateParams.template(templateParams.section, templateParams.view)||\"\");\n\t}\n\n\treturn \"<div class='dhx_timeline_data_row\"+css+\"' data-section-id='\"+escapeForAttribute(rowId)+\"' data-section-index='\" + i + \"' style='\" +\n\t\tstats.summ_width + stats.style_height + \" position:absolute; top:\" + (top_pos) + \"px;'>\";\n};\n\nscheduler._timeline_get_html_for_cell_ignores = function(stats) {\n\treturn '<div class=\"dhx_matrix_cell dhx_timeline_data_cell\" style=\"' + stats.style_height + stats.style_line_height + ';display:none\"></div>';\n};\n\nscheduler._timeline_get_html_for_cell = function(x_ind, y_ind, view, ev, stats, cellLeftPos) {\n\tvar cellDate = view._trace_x[x_ind];\n\tvar cellSection = view.y_unit[y_ind];\n\tvar cellWidth = scheduler._cols[x_ind];\n\n\tvar cellDateString = timelineCellDateAttribute(cellDate);\n\n\tvar content = scheduler.templates[view.name + \"_cell_value\"](ev, cellDate, cellSection);\n\treturn \"<div data-col-id='\"+x_ind+\"' data-col-date='\"+cellDateString+\"' class='dhx_matrix_cell dhx_timeline_data_cell \" +\n\t\tscheduler.templates[view.name + \"_cell_class\"](ev, cellDate, cellSection) +\n\t\t\"' style='width:\" + (cellWidth) + \"px;\" + (stats.style_height) + stats.style_line_height + (scheduler.config.rtl ? \" right:\" : \"  left:\") + (cellLeftPos) + \"px;'>\" +\n\t\t\"<div style='width:auto'>\" + content + \"</div></div>\";\n};\n\n// bar mode\nscheduler._timeline_get_html_for_bar_matrix_line = function(i, stats, top_pos, rowId) {\n\treturn \"<div style='\" + stats.summ_width + \" \" + stats.style_height + \" position:absolute; top:\"+top_pos+\"px;' data-section-id='\"+escapeForAttribute(rowId)+\"' data-section-index='\"+i+\"' class='dhx_matrix_line'>\";\n};\n\nscheduler._timeline_get_html_for_bar_data_row = function(stats, templateParams) {\n\tvar css = stats.table_className;\n\tif(templateParams.template){\n\t\tcss += \" \" + (templateParams.template(templateParams.section, templateParams.view)||\"\");\n\t}\n\treturn \"<div class='dhx_timeline_data_row \" + css + \"' style='\" + stats.summ_width + \" \" + stats.style_height + \"' >\";\n};\n\nscheduler._timeline_get_html_for_bar_ignores = function() {\n\treturn \"\";// \"<div></div>\";\n};\n\nfunction timelineCellDateAttribute (cellDate){\n\treturn scheduler._helpers.formatDate(cellDate);\n}\n\nscheduler._timeline_get_html_for_bar = function(x_ind, y_ind, view, ev, cellLeftPos, nestedEvents) {\n\n\tvar cellDate = timelineCellDateAttribute(view._trace_x[x_ind]);\n\tvar cellSection = view.y_unit[y_ind];\n\n\tvar content = \"\";\n\tif(view.cell_template){\n\t\tcontent = scheduler.templates[view.name + \"_cell_value\"](ev, view._trace_x[x_ind], cellSection, nestedEvents);\n\t}\n\n\tvar lineHeight = \"line-height:\" + view._section_height[cellSection.key] + \"px;\";\n\n\tlet cellInner = \"\";\n\tif(content){\n\t\tcellInner = \"<div style='width:auto; height:100%;position:relative;\"+lineHeight+\"'>\" + content + \"</div>\";\n\t}\n\n\treturn \"<div class='dhx_matrix_cell dhx_timeline_data_cell \" +\n\t\tscheduler.templates[view.name + \"_cell_class\"](ev, view._trace_x[x_ind], cellSection, nestedEvents) +\n\t\t\"' style='width:\" + (scheduler._cols[x_ind]) + \"px; \" + (scheduler.config.rtl ? \"right:\" : \"left:\") + (cellLeftPos) + \"px;'  data-col-id='\"+ x_ind +\"' data-col-date='\"+cellDate+\"' >\"+\n\t\tcellInner + \"</div>\";\n};\n/* get html section end */\n\n\n\nscheduler._timeline_render_scale_header = function(view, show){\n\tvar element = scheduler.$container.querySelector(\".dhx_timeline_scale_header\");\n\tif(element){\n\t\telement.remove();\n\t}\n\tif(!show){\n\t\treturn;\n\t}\n\n\telement = document.createElement(\"div\");\n\tvar headerAreaClass = \"dhx_timeline_scale_header\";\n\tif(view.second_scale){\n\t\theaderAreaClass += \" dhx_timeline_second_scale\";\n\t}\n\n\tvar headerHeight = scheduler.xy.scale_height;\n\telement.className = headerAreaClass;\n\telement.style.cssText = [\n\t\t\"width:\"  + (view.dx) + \"px\",\n\t\t\"height:\" + (headerHeight) + \"px\",\n\t\t\"line-height:\" + (headerHeight) + \"px\",\n\t\t\"top:\"    +  \"0px\",\n\t\t(scheduler.config.rtl ? \"right:0px\" : \"left:0px\")\n\t].join(\";\");\n\t//element.innerHTML = scheduler.locale.labels[view.name+\"_scale_header\"] || '';\n\telement.innerHTML = scheduler.templates[view.name + \"_scale_header\"](view);\n\n\tconst header = scheduler.$container.querySelector(\".dhx_cal_header\");\n\telement.style.top = `${header.offsetTop}px`;\n\telement.style.height = `${header.offsetHeight}px`;\n\tscheduler.$container.appendChild(element);\n\t// scheduler.$container.querySelector(\".dhx_cal_header\").appendChild(element);\n};\n\nfunction getScrollableContainer(root, view){\n\tvar dataWrapperDiv = root.querySelector('.dhx_timeline_data_wrapper');\n\tif (!view.scrollable){\n\t\tdataWrapperDiv = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t}\n\treturn dataWrapperDiv;\n}\n\nfunction getLabelContainer(root){\n\treturn root.querySelector('.dhx_timeline_label_wrapper');\n}\n\nfunction getColumnLabelContainer(){\n\treturn scheduler.$container.querySelector(\".dhx_cal_data .dhx_timeline_label_col\");\n}\n\n// define timeline scroll behavior and attach onscroll event\n// define timeline scroll behavior and attach onscroll event\nfunction initScroll(d, view, heights) {\n\n\tscheduler.attachEvent(\"onOptionsLoad\", function(){\n\t\tif(scheduler.getState().mode === view.name){\n\t\t\theights = scheduler._colsS.heights;\n\t\t}\n\t});\n\tscheduler.attachEvent(\"onViewChange\", function(){\n\t\tif(scheduler.getState().mode === view.name){\n\t\t\theights = scheduler._colsS.heights;\n\t\t}\n\t});\n\t\n\tview._is_ev_creating = false;\n\n\tvar dataWrapperDiv = getScrollableContainer(d, view);\n\t// attach scroll events for dhx_cal_header - horizontal\n\t// and dhx_timeline_label_col div - vertical\n\tvar header = scheduler._els[\"dhx_cal_header\"][0];\n\n\t// add ability to scroll over timeline_label_wrapper\n\tvar labelWrapperDiv = getLabelContainer(d);\n\tif(labelWrapperDiv){ // only for vertical scrolling\n\n\t\tif (!labelWrapperDiv.$eventsAttached) {\n\t\t\tlabelWrapperDiv.$eventsAttached = true;\n\t\t\tvar prevLabelAction = { pageX: 0, pageY: 0 };\n\t\t\tscheduler.event(labelWrapperDiv, \"touchstart\", function (e) {\n\t\t\t\tvar touch = e;\n\t\t\t\tif (e.touches) {\n\t\t\t\t\ttouch = e.touches[0];\n\t\t\t\t}\n\t\t\t\tprevLabelAction = { pageX: touch.pageX, pageY: touch.pageY };\n\t\t\t}, {passive: false});\n\t\t\tscheduler.event(labelWrapperDiv, \"touchmove\", function (e) {\n\t\t\t\tvar touch = e;\n\t\t\t\tif (e.touches) {\n\t\t\t\t\ttouch = e.touches[0];\n\t\t\t\t}\n\t\t\t\tvar dy = prevLabelAction.pageY - touch.pageY;\n\t\t\t\tprevLabelAction = { pageX: touch.pageX, pageY: touch.pageY };\n\t\t\t\tif (dy) {\n\t\t\t\t\tdataWrapperDiv.scrollTop += dy;\n\t\t\t\t}\n\t\t\t\tif (e && e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t}, {passive: false});\n\t\t}\n\t}\n\n\t// rerender view\n\tvar frameRequest;\n\t// GS-2681 non-scrollable timelines use .dhx_cal_data element as scrollable container\n\t// ensure events are not attached multiple times, but are attached for each view that needs it\n\tif (!dataWrapperDiv.$eventsAttached || !dataWrapperDiv.$eventsAttached[view.name]) {\n\t\tdataWrapperDiv.$eventsAttached = dataWrapperDiv.$eventsAttached || {};\n\t\tdataWrapperDiv.$eventsAttached[view.name] = true;\n\t\t//dataWrapperDiv.$eventsAttached = true;\n\n\t\tlet prevScrollLeft;\n\t\tlet prevScrollTop;\n\n\t\t//eslint-disable-next-line no-inner-declarations\n\t\tfunction onMouseWheel(e) {\n\t\t\tlet scrollPositionChanged = true;\n\t\t\tvar ff = scheduler.env.isFF;\n\t\t\tvar deltaX = ff ? (e.deltaX) : e.wheelDeltaX;\n\t\t\tvar deltaY = ff ? (e.deltaY) : e.wheelDelta;\n\t\n\t\t\tvar multiplier = -20;\n\t\t\tif (ff) {\n\t\t\t\tif (e.deltaMode !== 0) {\n\t\t\t\t\tmultiplier = -40;\n\t\t\t\t} else {\n\t\t\t\t\tmultiplier = -10;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar wheelSpeed = {x: 1, y: 1};\n\t\t\tvar wx = ff ? (deltaX * multiplier * wheelSpeed.x) : deltaX * 2 * wheelSpeed.x;\n\t\t\tvar wy = ff ? (deltaY * multiplier * wheelSpeed.y) : deltaY * wheelSpeed.y;\n\n\t\t\tif (wx && Math.abs(wx) > Math.abs(wy)){\n\t\t\t\t\n\t\t\t\tvar dir  = wx/-40;\n\t\t\t\tdataWrapperDiv.scrollLeft += dir*30;\n\t\t\t\tif(dataWrapperDiv.scrollLeft === prevScrollLeft){\n\t\t\t\t\tscrollPositionChanged = false;\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tvar dir  = wy/-40;\n\t\t\t\tif (typeof wy == \"undefined\")\n\t\t\t\t\tdir = e.detail;\n\t\n\t\t\t\tdataWrapperDiv.scrollTop += dir*30;\n\t\t\t\tif(dataWrapperDiv.scrollTop === prevScrollTop){\n\t\t\t\t\tscrollPositionChanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif(scrollPositionChanged){\n\t\t\t\te.preventDefault();\n\t\t\t\te.cancelBubble=true;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t}\n\n\t\tscheduler.event(dataWrapperDiv, \"mousewheel\", onMouseWheel, {passive: false});\n\t\tscheduler.event(labelWrapperDiv, \"mousewheel\", onMouseWheel, {passive: false});\n\n\n\t\tconst dataWrapperDivOnScroll = function (e) {\n\t\t\tif(scheduler.getState().mode !== view.name){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\theights = scheduler._colsS.heights;\n\t\t\tvar element = getScrollableContainer(d, view);\n\t\t\te.preventDefault();\n\t\t\tvar scrollTop = element.scrollTop;\n\t\t\tvar scrollLeft = view.scrollHelper.getScrollValue(element);\n\t\t\tprevScrollLeft = scrollLeft;\n\t\t\tprevScrollTop = scrollTop;\n\t\t\tvar scrollWidth = view._summ - scheduler.$container.querySelector('.dhx_cal_data').offsetWidth + view.dx + view.custom_scroll_width;\n\t\t\tvar viewPort = scheduler._timeline_smart_render.getViewPort(view.scrollHelper, 0, scrollLeft, scrollTop);\n\t\t\tvar colLabelDiv = getColumnLabelContainer();\n\t\t\tif(view.scrollable){\n\t\t\t\tcolLabelDiv.style.top = (-scrollTop) + 'px';\n\n\n\t\t\t\tif (scheduler.config.rtl){\n\t\t\t\t\tvar labelWrapperHeight = +scheduler.$container.querySelector(\".dhx_timeline_label_wrapper\").style.height.replace(\"px\", \"\");\n\t\t\t\t\tvar scalesHeight = view._section_height[view.y_unit.length] + view._label_rows[view._label_rows.length - 1].top;\n\n\t\t\t\t\tif (view.scrollHelper.getMode() == view.scrollHelper.modes.minMax && (scalesHeight > labelWrapperHeight || view.render == \"tree\")) {\n\t\t\t\t\t\theader.style.right   = (-1 - scrollLeft - getScrollbarwidth()) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\telse header.style.right   = (-1 - scrollLeft) + 'px';\n\n\t\t\t\t\theader.style.left   = 'unset';\n\t\t\t\t} else {\n\t\t\t\t\theader.style.left   = (-1 - scrollLeft) + 'px';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(view._smartRenderingEnabled()){\n\t\t\t\tif (scrollLeft !== view._x_scroll || view._is_ev_creating) {\n\t\t\t\t\tif (view.second_scale)\n\t\t\t\t\t\tscheduler._timeline_smart_render.updateHeader(view, viewPort, header.children[1]);\n\t\t\t\t\telse\n\t\t\t\t\t\tscheduler._timeline_smart_render.updateHeader(view, viewPort, header.children[0]);\n\t\t\t\t}\n\t\t\t\t//GS-2654: don't return if smart_rendering disabled\n\t\t\t\tif (view._options_changed || scrollTop !== view._y_scroll  || view._is_ev_creating) {\n\t\t\t\t\tscheduler._timeline_smart_render.updateLabels(view, viewPort, colLabelDiv);\n\t\t\t\t}\n\n\t\t\t\tview._is_ev_creating = false;\n\n\t\t\t\tscheduler._timeline_smart_render.updateGridCols(view, viewPort);\n\t\t\t\tscheduler._timeline_smart_render.updateGridRows(view, viewPort);\n\n\n\t\t\t\tvar asyncScroll = false;\n\t\t\t\tif (view.render != 'cell') {\n\t\t\t\t\t//asyncScroll = true;\n\t\t\t\t\t////if (frameRequest) {\n\t\t\t\t\t\tcancelAnimationFrame(frameRequest);\n\t\t\t\t\t//}\n\n\t\t\t\t\t//frameRequest = requestAnimationFrame(function () {\n\t\t\t\t\t\tif(view.name !== scheduler.getState().mode){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscheduler._timeline_smart_render.updateEvents(view, viewPort);\n\t\t\t\t\t//\tframeRequest = 0;\n\t\t\t\t\t//\tview.callEvent(\"onScroll\", [view.scrollHelper.getScrollValue(dataWrapperDiv), dataWrapperDiv.scrollTop]);\n\t\t\t\t\t//});\n\t\t\t\t}\n\n\t\t\t\tvar dataColHeight = 0;\n\t\t\t\tview._scales = {};\n\t\t\t\tvar rows;\n\n\t\t\t\tif (view.render === 'cell')\n\t\t\t\t\trows = element.querySelectorAll('.dhx_timeline_data_col .dhx_timeline_data_row');\n\t\t\t\telse\n\t\t\t\t\trows = element.querySelectorAll('.dhx_timeline_data_col .dhx_matrix_line');\n\n\t\t\t\tvar render_stats = view._render_stats;\n\t\t\t\tfor (var i= 0, len = rows.length; i < len; i++) {\n\t\t\t\t\tvar unit_key = rows[i].getAttribute(\"data-section-id\");\n\t\t\t\t\tvar rowIndex = view.order[unit_key];\n\n\t\t\t\t\theights[rowIndex] = render_stats[rowIndex].height;\n\t\t\t\t\tview._scales[unit_key] = rows[i];\n\t\t\t\t}\n\n\t\t\t\tfor (var i= 0, len = heights.length; i < len; i++) {\n\t\t\t\t\tdataColHeight+= heights[i];\n\t\t\t\t}\n\n\t\t\t\tvar scrDiv = scheduler.$container.querySelector('.dhx_timeline_data_col');\n\t\t\t\tscrDiv.style.height = dataColHeight + \"px\";\n\t\t\t}\n\n\t\t//\tvar newTop = element.scrollTop;\n\t\t//\tvar newLeft = view.scrollHelper.getScrollValue(element);\n\n\t\t\tvar newTop = scrollTop;\n\t\t\tvar newLeft = scrollLeft;\n\n\t\t\t//var scrollWidth = view._summ - scheduler.$container.querySelector('.dhx_cal_data').offsetWidth + view.dx + view.custom_scroll_width;\n\t\t\tscheduler._timeline_save_scroll_pos(view, newTop, newLeft, scrollWidth);\n\t\t\tif (!asyncScroll) {\n\t\t\t\tview.callEvent(\"onScroll\", [newLeft, newTop]);\n\t\t\t}\n\t\t\t//scheduler._timeline_smart_render.updateEvents(view, viewPort);\n\t\t\t//\tframeRequest = 0;\n\t\t\t//view.callEvent(\"onScroll\", [view.scrollHelper.getScrollValue(dataWrapperDiv), dataWrapperDiv.scrollTop]);\n\n\t\t\tview._is_new_view = false;\n\t\t};\n\n\t\tscheduler.event(dataWrapperDiv, \"scroll\", dataWrapperDivOnScroll, {passive: false});\n\n\t\tvar prevAction = { pageX: 0, pageY: 0 };\n\t\tscheduler.event(dataWrapperDiv, \"touchstart\", function (e) {\n\t\t\tvar touch = e;\n\t\t\tif (e.touches) {\n\t\t\t\ttouch = e.touches[0];\n\t\t\t}\n\t\t\tprevAction = { pageX: touch.pageX, pageY: touch.pageY };\n\t\t}, {passive: false});\n\t\tscheduler.event(dataWrapperDiv, \"touchmove\", function (e) {\n\t\t\tvar touch = e;\n\t\t\tif (e.touches) {\n\t\t\t\ttouch = e.touches[0];\n\t\t\t}\n\t\t\tvar colLabelDiv = getColumnLabelContainer();\n\t\t\tvar dx = prevAction.pageX - touch.pageX;\n\t\t\tvar dy = prevAction.pageY - touch.pageY;\n\t\t\tprevAction = { pageX: touch.pageX, pageY: touch.pageY };\n\n\t\t\tif ((dx || dy) && !scheduler.getState().drag_id) {\n\t\t\t\t// add a threshold for secondary axis movement\n\t\t\t\tvar absoluteDx = Math.abs(dx);\n\t\t\t\tvar absoluteDy = Math.abs(dy);\n\t\t\t\tvar totalDistance = Math.sqrt(dx*dx + dy*dy);\n\t\t\t\tvar horizontalComponent = absoluteDx / totalDistance;//sin\n\t\t\t\tvar verticalComponent = absoluteDy / totalDistance;//cos\n\t\t\t\tif (horizontalComponent < 0.42) {// < 25 degree angle\n\t\t\t\t\tdx = 0;\n\t\t\t\t} else if (verticalComponent < 0.42) {// < 65 degree angle\n\t\t\t\t\tdy = 0;\n\t\t\t\t}\n\t\t\t\t// GS-2457: due to opposite direction in timeline with rtl mode, \n\t\t\t\t// need to change the direction of scrolling when rtl is enabled\n\t\t\t\tif (scheduler.config.rtl){\n\t\t\t\t\tdx = -dx;\n\t\t\t\t} \n\n\t\t\t\tview.scrollHelper.setScrollValue( dataWrapperDiv, view.scrollHelper.getScrollValue(dataWrapperDiv) + dx);\n\n\t\t\t\tdataWrapperDiv.scrollTop += dy;\n\n\t\t\t\tif (view.scrollable && dy) {\n\t\t\t\t\tcolLabelDiv.style.top = (-dataWrapperDiv.scrollTop) + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (e && e.preventDefault)\n\t\t\t\te.preventDefault();\n\t\t\treturn false;\n\t\t}, {passive: false});\n\t}\n\n\tif (view.scroll_position && view._is_new_view) {\n\t\t// set scroll position once on scheduler init and save it to timeline obj\n\t\tview.scrollTo(view.scroll_position);\n\t} else {\n\t\tscheduler._timeline_set_scroll_pos(d, view);\n\t}\n\n\tview._is_ev_creating = true;\n}\n\n\n\nscheduler._timeline_y_scale = function y_scale(d) {\n\t// main code for _timeline_y_scale starts here\n\tvar block_stats = scheduler._timeline_get_block_stats(d, this);\n\n\t// _section_autowidth works for scrollable=true and defines is scroll or autosize (width) needed\n\tvar scrollableData = !this.scrollable ? '' : ' dhx_timeline_scrollable_data';\n\n\tvar html = \"<div class='dhx_timeline_table_wrapper'>\" ;\n\tvar labelWrapper  = \"<div class='dhx_timeline_label_wrapper' style='\"+block_stats.style_label_wrapper+\"'>\" +\n\t\t\"<div class='dhx_timeline_label_col'>\";\n\tvar dataWrapper = \"<div class='dhx_timeline_data_wrapper\" + scrollableData + \"' style='\"+block_stats.style_data_wrapper+\"'>\" +\n\t\t\"<div class='dhx_timeline_data_col'>\";\n\n\tif(scheduler._load_mode)\n\t\tscheduler._load();\n\n\tscheduler._timeline_smart_render.clearPreparedEventsCache(evs);\n\tvar evs = scheduler._timeline_smart_render.getPreparedEvents(this);\n\tscheduler._timeline_smart_render.cachePreparedEvents(evs);\n\n\tvar summ = 0;\n\tfor (var i=0; i < scheduler._cols.length; i++)\n\t\tsumm+=scheduler._cols[i];\n\n\tvar step = new Date();\n\tvar realcount = scheduler._cols.length-scheduler._ignores_detected;\n\tstep = ((scheduler.date.add(step, this.x_step*realcount, this.x_unit)-step)-(this._start_correction + this._end_correction)*realcount)/summ;\n\tthis._step = step;\n\tthis._summ = summ;\n\n\tvar heights = scheduler._colsS.heights=[];\n\tvar render_stats = [];\n\n\tthis._render_stats = render_stats;\n\tthis._events_height = {};\n\tthis._section_height = {};\n\tthis._label_rows = [];\n\n\tvar skipRenderCells = false;\n\t//var cellTopPos = 0;\n\tvar viewPort = null;\n\tif(this._smartRenderingEnabled()){\n\t\tviewPort = scheduler._timeline_smart_render.getViewPort(this.scrollHelper, this._sch_height);\n\t}\n\n\tscheduler._timeline_smart_render._rendered_labels_cache = [];\n\tscheduler._timeline_smart_render._rendered_events_cache = [];\n\n\tvar scrollableDataContainer = !!viewPort;\n\n\tvar smartRender = this._smartRenderingEnabled();\n\n\tvar sectionsInfo = getRowSizes(this, evs);\n\n\t// if sections were changed viewport should be shifted upwards\n\tif(viewPort && sectionsInfo.totalHeight < viewPort.scrollTop){\n\t\tviewPort.scrollTop = Math.max(0, sectionsInfo.totalHeight - viewPort.height);\n\t}\n\n\tthis._rowStats = sectionsInfo.rowStatsByKey;\n\n\tfor (var rowIndex=0; rowIndex<this.y_unit.length; rowIndex++){\n\t\tvar stats = sectionsInfo.rowStats[rowIndex];\n\t\tvar row = this.y_unit[rowIndex];\n\t\tvar cellTopPos = stats.top;\n\n\t\t// calculate height of all events but will render below only events in viewport\n\n\t\t// now section 1 = labelWrapper, section 2 = dataWrapper\n\t\tvar labelRow = \"<div class='dhx_timeline_label_row \"+stats.tr_className+\"' style='top:\"+cellTopPos+\"px;\"+stats.style_height + stats.style_line_height+\"'\"+\"data-row-index='\"+rowIndex+\"'\" +\n\t\t\t\" data-row-id='\"+escapeForAttribute(row.key)+\"'>\" +\n\t\t\t\"<div class='\"+stats.td_className+\"' style='\"+stats.style_width+\" height:\"+stats.height+\"px;' \"+scheduler._waiAria.label(stats.td_content)+\">\"+stats.td_content+\"</div></div>\";\n\n\t\tif (smartRender)\n\t\t\tthis._label_rows.push({div: labelRow, top: cellTopPos, section: row});\n\n\t\t// check vertical direction\n\t\tif (smartRender){\n\t\t\tif (!scheduler._timeline_smart_render.isInYViewPort({top: cellTopPos, bottom: cellTopPos + stats.height}, viewPort)) {\n\t\t\t\tskipRenderCells = true;\n\t\t\t}\n\t\t}\n\t//\tcellTopPos += stats.height;\n\n\t\tif (skipRenderCells) {\n\t\t\tskipRenderCells = false;\n\t\t} else {\n\t\t\t// add label row if wasn't skipped render cells\n\t\t\tlabelWrapper += labelRow;\n\n\t\t\t// save label to cache on first time render\n\t\t\tif (smartRender){\n\t\t\t\tscheduler._timeline_smart_render._rendered_labels_cache.push(rowIndex);\n\t\t\t}\n\n\t\t\tvar template = scheduler.templates[this.name + \"_row_class\"];\n\t\t\tvar templateParams = { view: this, section: row, template: template};\n\n\t\t\t// check horizontal direction\n\t\t\tvar cellLeftPos = 0;\n\t\t\tif (this.render == \"cell\") {\n\t\t\t\tdataWrapper +=scheduler._timeline_get_html_for_cell_data_row(rowIndex, stats, stats.top, row.key, templateParams);\n\t\t\t\tfor (var colIndex = 0; colIndex < scheduler._cols.length; colIndex++) {\n\t\t\t\t\tif (scheduler._ignores[colIndex] && !smartRender)\n\t\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell_ignores(stats);\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (smartRender && scrollableDataContainer) {\n\t\t\t\t\t\t\tif (scheduler._timeline_smart_render.isInXViewPort({left: cellLeftPos, right: cellLeftPos + scheduler._cols[colIndex]}, viewPort)) {\n\t\t\t\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell(colIndex, rowIndex, this, evs[rowIndex][colIndex], stats, cellLeftPos);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell(colIndex, rowIndex, this, evs[rowIndex][colIndex], stats, cellLeftPos);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tcellLeftPos += scheduler._cols[colIndex];\n\n\t\t\t\t}\n\t\t\t\tdataWrapper += '</div>';\n\t\t\t} else {\n\t\t\t\t//section 2\n\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar_matrix_line(rowIndex, stats, stats.top, row.key);\n\n\t\t\t\tvar printableEvents = evs[rowIndex];\n\t\t\t\t// get events only in viewport\n\t\t\t\tif (smartRender && scrollableDataContainer) {\n\t\t\t\t\tprintableEvents = scheduler._timeline_smart_render.getVisibleEventsForRow(this, viewPort, evs, rowIndex);\n\n\t\t\t\t}\n\t\t\t\tvar events_html = scheduler._timeline_get_events_html.call(this, printableEvents);\n\n\n\t\t\t\t// adding events\n\t\t\t\tdataWrapper += events_html;\n\n\t\t\t\t// section 3\n\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar_data_row(stats, templateParams);\n\n\t\t\t\tfor (var colIndex = 0; colIndex < scheduler._cols.length; colIndex++) {\n\t\t\t\t\tif (scheduler._ignores[colIndex])\n\t\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar_ignores();\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (smartRender && scrollableDataContainer) {\n\t\t\t\t\t\t\tif (scheduler._timeline_smart_render.isInXViewPort({left: cellLeftPos, right: cellLeftPos + scheduler._cols[colIndex]}, viewPort)) {\n\t\t\t\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar(colIndex, rowIndex, this, evs[rowIndex], cellLeftPos);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar(colIndex, rowIndex, this, evs[rowIndex], cellLeftPos);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcellLeftPos += scheduler._cols[colIndex];\n\t\t\t\t}\n\t\t\t\tdataWrapper += \"</div></div>\";\n\t\t\t}\n\t\t}\n\t\tstats.sectionKey = row.key;\n\t\trender_stats.push(stats);\n\t}\n\n\thtml += labelWrapper  + \"</div></div>\";\n\thtml += dataWrapper + \"</div></div>\";\n\thtml += \"</div>\";\n\n\tthis._matrix = evs;\n\n\t//d.scrollTop = 0; //fix flickering in FF;  disabled as it was impossible to create dnd event if scroll was used (window jumped to the top)\n\td.innerHTML = html;\n\tif (smartRender) {\n\t\tif (scheduler._timeline_smart_render) {\n\t\t\tscheduler._timeline_smart_render._rendered_events_cache = [];\n\t\t}\n\t}\n\tscheduler._populate_timeline_rendered(d);\n\t// set height for absolute positioned scrollable div\n\n\tconst sectionRows = d.querySelectorAll(\"[data-section-id]\");\n\tconst divBySectionId = {};\n\tsectionRows.forEach(function(row){\n\t\tdivBySectionId[row.getAttribute(\"data-section-id\")] = row;\n\t});\n\tthis._divBySectionId = divBySectionId;\n\tif (smartRender) {\n\t\tvar scrDiv = scheduler.$container.querySelector('.dhx_timeline_data_col');\n\t\tscrDiv.style.height = sectionsInfo.totalHeight + \"px\";\n\t}\n\n\tthis._scales = {};\n\n\tfor (var i= 0, len = render_stats.length; i < len; i++) {\n\t\theights.push(render_stats[i].height);\n\n\t\tvar unit_key = render_stats[i].sectionKey;\n\t\tscheduler._timeline_finalize_section_add(this, unit_key, this._divBySectionId[unit_key]);\n\t}\n\n\n\tif (smartRender || this.scrollable){\n\t\tinitScroll(d, this, heights);\n\t}\n};\n\nscheduler._timeline_finalize_section_add = function(timeline, sectionKey, sectionDiv){\n\tif(sectionDiv){\n\t\ttimeline._scales[sectionKey] = sectionDiv;\n\t\tscheduler.callEvent(\"onScaleAdd\", [sectionDiv, sectionKey]);\n\t}\n};\n\nscheduler.attachEvent(\"onBeforeViewChange\", function (old_mode,old_date,mode,date) {\n\t// set scroll position for previous when dates are switched (not modes)\n\tif (scheduler.matrix[mode]) {\n\t\tvar view = scheduler.matrix[mode];\n\n\t\tif (view.scrollable || view.smart_rendering) {\n\t\t\tif (view.render == \"tree\") {\n\t\t\t\tif (old_mode === mode && old_date === date) {\n\t\t\t\t\t// do not set scroll pos to 0 if it is click on folder\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(( old_mode !== mode || +old_date !== +date) && scheduler.$container.querySelector('.dhx_timeline_scrollable_data')){\n\t\t\t\tview._x_scroll = view._y_scroll = 0;\n\n\t\t\t\tif (scheduler.$container.querySelector('.dhx_timeline_scrollable_data')) {\n\t\t\t\t\tscheduler._timeline_set_scroll_pos(scheduler._els[\"dhx_cal_data\"][0], view);\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t}\n\t}\n\n\treturn true;\n});\n\nscheduler._timeline_x_dates = function x_dates(preserve){\n\tvar start = scheduler._min_date;\n\tvar end = scheduler._max_date;\n\n\tscheduler._process_ignores(start, this.x_size, this.x_unit, this.x_step, preserve);\n\t// var size = this.x_size + (preserve ? scheduler._ignores_detected : 0);\n\n\tif(scheduler.date[this.x_unit + \"_start\"]){\n\t\tstart = scheduler.date[this.x_unit + \"_start\"](start);\n\t}\n\tvar display_count = 0,\n\t\ttotal_count = 0;\n\twhile(+start < +end){\n\t\t// dates calculation\n\t\t\n\t\tthis._trace_x[total_count]=new Date(start);\n\t\tif(this.x_unit == \"month\" && scheduler.date[this.x_unit + \"_start\"]){\n\t\t\tstart = scheduler.date[this.x_unit + \"_start\"](new Date(start));\n\t\t}\n\t\tstart = scheduler.date.add(start, this.x_step, this.x_unit);\n\t\tif(scheduler.date[this.x_unit + \"_start\"]){\n\t\t\tstart = scheduler.date[this.x_unit + \"_start\"](start);\n\t\t}\n\n\t\tif(!scheduler._ignores[total_count])\n\t\t\tdisplay_count++;\n\t\ttotal_count++;\n\n\t\tif(preserve){\n\t\t\tif(display_count <  this.x_size && !(+start < +end)){\n\t\t\t\tend = scheduler.date[\"add_\" + this.name + \"_private\"](end, (this.x_length || this.x_size)*this.x_step);\n\t\t\t}else if(display_count >=  this.x_size){\n\t\t\t\tscheduler._max_date = start;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn {total: total_count, displayed: display_count};\n};\n\nscheduler._timeline_x_scale = function x_scale(h){\n\tvar timelineContainerWidth = scheduler._x - this.dx - scheduler.xy.scroll_width; //border delta, whole width\n\tvar start = scheduler._min_date;\n\t//var end = scheduler._max_date;\n\t\t\n\tvar current_sh = scheduler.xy.scale_height;\n\tvar original_sh = this._header_resized||scheduler.xy.scale_height;\n\tscheduler._cols=[];\t//store for data section, each column width // scale.width\n\tscheduler._colsS={height:0}; // heights of the y sections\n\tthis._trace_x =[]; // list of dates per cells  // scale.trace_x\n\n\n\tvar preserve = scheduler.config.preserve_scale_length;\n\tvar dates = scheduler._timeline_x_dates.call(this, preserve);\n\n\n\t// calculate width for scrollable, define is autowidth needed or not\n\tif (this.scrollable && this.column_width > 0) {\n\n\t\tvar summ_fixed = this.column_width * dates.displayed;\n\n\t\tif (summ_fixed > timelineContainerWidth) {\n\t\t\ttimelineContainerWidth = summ_fixed;\n\t\t\tthis._section_autowidth = false; // default === true\n\t\t}\n\t}\n\n\tvar left = [this.dx]; // left margins, initial left margin\n\tvar header = scheduler._els['dhx_cal_header'][0];\n\theader.style.width = (left[0]+timelineContainerWidth + 1)+'px';\n\n\tvar start = scheduler._min_date_timeline = scheduler._min_date;\n\n\n\tvar realcount = dates.displayed;\n\tvar size = dates.total;\n\n\t// position calculation\n\n\tfor (var k=0; k<size; k++){\n\n\t\tif (scheduler._ignores[k]){\n\t\t\tscheduler._cols[k]=0;\n\t\t\trealcount++;\n\t\t} else {\n\t\t\tscheduler._cols[k]=Math.floor(timelineContainerWidth/(realcount-k));\n\t\t}\n\n\t\ttimelineContainerWidth -= scheduler._cols[k];\n\t\tleft[k+1] = left[k] + scheduler._cols[k];\n\t}\n\th.innerHTML = \"<div></div>\";\n\n\tif(this.second_scale){\n\t\t// additional calculations\n\t\tvar mode = this.second_scale.x_unit;\n\t\tvar control_dates = [this._trace_x[0]]; // first control date\n\t\tvar second_cols = []; // each column width of the secondary row\n\t\tvar second_left = [this.dx, this.dx]; // left margins of the secondary row\n\t\tvar t_index = 0; // temp index\n\t\tfor (var l = 0; l < this._trace_x.length; l++) {\n\t\t\tvar date = this._trace_x[l];\n\t\t\tvar res = scheduler._timeline_is_new_interval(mode, date, control_dates[t_index]);\n\n\t\t\tif(res) { // new interval\n\t\t\t\t++t_index; // starting new interval\n\t\t\t\tcontrol_dates[t_index] = date; // updating control date as we moved to the new interval\n\t\t\t\tsecond_left[t_index+1] = second_left[t_index];\n\t\t\t}\n\t\t\tvar t = t_index+1;\n\t\t\tsecond_cols[t_index] = scheduler._cols[l] + (second_cols[t_index]||0);\n\t\t\tsecond_left[t] += scheduler._cols[l];\n\t\t}\n\n\t\th.innerHTML = \"<div></div><div></div>\";\n\t\tvar top = h.firstChild;\n\t\ttop.style.height = (original_sh)+'px'; // actually bottom header takes 21px\n\t\tvar bottom = h.lastChild;\n\t\tbottom.style.position = \"relative\";\n\t\tbottom.className = \"dhx_bottom_scale_container\";\n\t\tfor (var m = 0; m < control_dates.length; m++) {\n\t\t\tvar tdate = control_dates[m];\n\t\t\tvar scs = scheduler.templates[this.name+\"_second_scalex_class\"](tdate);\n\t\t\tvar head = document.createElement(\"div\"); \n\t\t\thead.className=\"dhx_scale_bar dhx_second_scale_bar\"+((scs)?(\" \"+scs):\"\");\n\t\t\tscheduler.set_xy(head, second_cols[m], original_sh, second_left[m], 0);\n\t\t\thead.innerHTML = scheduler.templates[this.name+\"_second_scale_date\"](tdate);\n\t\t\ttop.appendChild(head);\n\t\t}\n\t}\n\n\tscheduler.xy.scale_height = original_sh; // fix for _render_x_header which uses current scale_height value\n\th = h.lastChild; // h - original scale\n\n\tthis._h_cols = {};\n\n\tfor (var i=0; i<this._trace_x.length; i++){\n\t\tif (scheduler._ignores[i])\n\t\t\tcontinue;\n\n\t\tstart = this._trace_x[i];\n\t\tscheduler._render_x_header(i, left[i], start, h);\n\n\t\th.lastChild.setAttribute('data-col-id', i);\n\t\th.lastChild.setAttribute('data-col-date', timelineCellDateAttribute(start));\n\n\t\t// need to copy lastChild for IE11\n\t\tvar clnLastChild = h.lastChild.cloneNode(true);\n\n\t\t// get cache of header all elements\n\t\tthis._h_cols[i] = {div: clnLastChild, left: left[i]};\n\t}\n\n\tscheduler.xy.scale_height = current_sh; // restoring current value\n\n\tvar trace = this._trace_x;\n\tif(h.$_clickEventsAttached){\n\t\treturn;\n\t}\n\t\n\th.$_clickEventsAttached = true;\n\tscheduler.event(h, \"click\", function(e){\n\t\tvar pos = scheduler._timeline_locate_hcell(e);\n\t\tif (pos)\n\t\t\tscheduler.callEvent(\"onXScaleClick\",[pos.x, trace[pos.x], e]);\n\t});\n\tscheduler.event(h, \"dblclick\", function(e){\n\t\tvar pos = scheduler._timeline_locate_hcell(e);\n\t\tif (pos)\n\t\t\tscheduler.callEvent(\"onXScaleDblClick\",[pos.x, trace[pos.x], e]);\n\t});\n};\n\nscheduler._timeline_is_new_interval = function is_new_interval(mode, date, control_date){ // mode, date to check, control_date for which period should be checked\n\tswitch(mode) {\n\t\tcase \"hour\":\n\t\t\treturn ((date.getHours() != control_date.getHours()) || scheduler._timeline_is_new_interval(\"day\", date, control_date));\n\t\tcase \"day\":\n\t\t\treturn !(date.getDate() == control_date.getDate() && date.getMonth() == control_date.getMonth() && date.getFullYear() == control_date.getFullYear());\n\t\tcase \"week\":\n\t\t\treturn !(scheduler.date.week_start(new Date(date)).valueOf() == scheduler.date.week_start(new Date(control_date)).valueOf());\n\t\t\t//return !(scheduler.date.getISOWeek(date) == scheduler.date.getISOWeek(control_date) && date.getFullYear() == control_date.getFullYear());\n\t\tcase \"month\":\n\t\t\treturn !(date.getMonth() == control_date.getMonth() && date.getFullYear() == control_date.getFullYear());\n\t\tcase \"year\":\n\t\t\treturn !(date.getFullYear() == control_date.getFullYear());\n\t\tdefault:\n\t\t\treturn false; // same interval\n\t}\n};\n\nscheduler._timeline_reset_scale_height = function reset_scale_height(mode){\n\tif (this._header_resized && (!mode || this.second_scale)) {\n\t\tscheduler.xy.scale_height /= 2;\n\t\tthis._header_resized = false;\n\t\tvar header = scheduler._els['dhx_cal_header'][0];\n\t\theader.className = header.className.replace(/ dhx_second_cal_header/gi,\"\");\n\t}\n};\n\nscheduler._timeline_set_full_view = function set_full_view(mode){\n\tscheduler._timeline_reset_scale_height.call(this, mode);\n\n\tif (mode){\n\t\tif (this.second_scale && !this._header_resized) {\n\t\t\tthis._header_resized = scheduler.xy.scale_height;\n\t\t\tscheduler.xy.scale_height *= 2;\n\t\t\tscheduler._els['dhx_cal_header'][0].className += \" dhx_second_cal_header\";\n\t\t}\n\n\t\tscheduler.set_sizes();\n\t\tscheduler._init_matrix_tooltip();\n\n\t\t//we need to have day-rounded scales for navigation\n\t\t//in same time, during rendering scales may be shifted\n\t\tvar temp = scheduler._min_date;\n\t\tscheduler._timeline_x_scale.call(this,scheduler._els[\"dhx_cal_header\"][0]);\n\n\t\t// get header cells that are only in viewport\n\t\tif (scheduler.$container.querySelector('.dhx_timeline_scrollable_data') && this._smartRenderingEnabled()) {\n\t\t\tvar viewPort  = scheduler._timeline_smart_render.getViewPort(this.scrollHelper);\n\t\t\tvar curHeader = scheduler._timeline_smart_render.getVisibleHeader(this, viewPort);\n\t\t\tif (curHeader) {\n\t\t\t\tif (this.second_scale)\n\t\t\t\t\tscheduler._els.dhx_cal_header[0].children[1].innerHTML = curHeader;\n\t\t\t\telse\n\t\t\t\t\tscheduler._els.dhx_cal_header[0].children[0].innerHTML = curHeader;\n\t\t\t}\n\t\t}\n\n\t\tscheduler._timeline_y_scale.call(this,scheduler._els[\"dhx_cal_data\"][0]);\n\n\t\tscheduler._min_date = temp;\n\n\t\tvar dateElement = scheduler._getNavDateElement();\n\t\tif(dateElement){\n\t\t\tdateElement.innerHTML=scheduler.templates[this.name+\"_date\"](scheduler._min_date, scheduler._max_date);\n\t\t}\n\n\t\tif (scheduler._mark_now) {\n\t\t\tscheduler._mark_now();\n\t\t}\n\t\tscheduler._timeline_reset_scale_height.call(this, mode);\n\n\t}\n\tscheduler._timeline_render_scale_header(this, mode);\n\t// hide tooltip if it is displayed\n\tscheduler._timeline_hideToolTip();\n};\n\n\nscheduler._timeline_hideToolTip = function hideToolTip(){\n\tif (scheduler._tooltip){\n\t\tscheduler._tooltip.style.display = \"none\";\n\t\tscheduler._tooltip.date = \"\";\n\t}\n};\n\nscheduler._timeline_showToolTip = function showToolTip(obj,pos,offset){\n\tif (obj.render != \"cell\") return;\n\tvar mark = pos.x+\"_\"+pos.y;\n\tvar evs = obj._matrix[pos.y][pos.x];\n\n\tif (!evs) return scheduler._timeline_hideToolTip();\n\n\tevs.sort(function(a,b){ return a.start_date>b.start_date?1:-1; });\n\n\tif (scheduler._tooltip){\n\t\tif (scheduler._tooltip.date == mark) return;\n\t\tscheduler._tooltip.innerHTML=\"\";\n\t} else {\n\t\tvar t = scheduler._tooltip = document.createElement(\"div\");\n\t\tt.className = \"dhx_year_tooltip\";\n\t\tif (scheduler.config.rtl) t.className += \" dhx_tooltip_rtl\";\n\t\tdocument.body.appendChild(t);\n\t\tscheduler.event(t, \"click\", scheduler._click.dhx_cal_data);\n\t}\n\n\tvar html = \"\";\n\n\tfor (var i=0; i<evs.length; i++){\n\t\tvar bg_color = (evs[i].color?(\"--dhx-scheduler-event-color:\"+evs[i].color+\";\"):\"\");\n\t\tvar color = (evs[i].textColor?(\"--dhx-scheduler-event-background:\"+evs[i].textColor+\";\"):\"\");\n\t\thtml+=\"<div class='dhx_tooltip_line' event_id='\"+evs[i].id+\"' \"+scheduler.config.event_attribute+\"='\"+evs[i].id+\"' style='\"+bg_color+\"\"+color+\"'>\";\n\t\thtml+=\"<div class='dhx_tooltip_date'>\"+(evs[i]._timed?scheduler.templates.event_date(evs[i].start_date):\"\")+\"</div>\";\n\t\thtml+=\"<div class='dhx_event_icon icon_details'>&nbsp;</div>\";\n\t\thtml+=scheduler.templates[obj.name+\"_tooltip\"](evs[i].start_date, evs[i].end_date,evs[i])+\"</div>\";\n\t}\n\n\tscheduler._tooltip.style.display=\"\";\n\tscheduler._tooltip.style.top = \"0px\";\n\n\tif ((scheduler.config.rtl && offset.left-scheduler._tooltip.offsetWidth >= 0) || document.body.offsetWidth-pos.src.offsetWidth-offset.left-scheduler._tooltip.offsetWidth < 0) {\n\t\tscheduler._tooltip.style.left = offset.left-scheduler._tooltip.offsetWidth+\"px\";\n\t}\n\telse {\n\t\tscheduler._tooltip.style.left = offset.left+pos.src.offsetWidth+\"px\";\n\t}\n\n\tscheduler._tooltip.date = mark;\n\tscheduler._tooltip.innerHTML = html;\n\n\tif (document.body.offsetHeight-offset.top-scheduler._tooltip.offsetHeight < 0)\n\t\tscheduler._tooltip.style.top= offset.top-scheduler._tooltip.offsetHeight+pos.src.offsetHeight+\"px\";\n\telse\n\t\tscheduler._tooltip.style.top= offset.top+\"px\";\n};\n\nscheduler._matrix_tooltip_handler = function(e){\n\tvar obj = scheduler.matrix[scheduler._mode];\n\tif (!obj || obj.render != \"cell\")\n\t\treturn;\n\tif (obj){\n\t\tvar pos = scheduler._locate_cell_timeline(e);\n\t\tif (pos)\n\t\t\treturn scheduler._timeline_showToolTip(obj,pos,scheduler.$domHelpers.getOffset(pos.src));\n\t}\n\tscheduler._timeline_hideToolTip();\n};\nscheduler._init_matrix_tooltip = function() {\n\tscheduler._detachDomEvent(scheduler._els[\"dhx_cal_data\"][0], \"mouseover\", scheduler._matrix_tooltip_handler);\n\tscheduler.event(scheduler._els[\"dhx_cal_data\"][0], \"mouseover\", scheduler._matrix_tooltip_handler);\n};\n\nscheduler._set_timeline_dates = function(view){\n\tscheduler._min_date = scheduler.date[view.name+\"_start\"](new Date(scheduler._date));\n\tscheduler._max_date = scheduler.date[\"add_\" + view.name + \"_private\"](scheduler._min_date, view.x_size*view.x_step);\n\n\tif(scheduler.date[view.x_unit+\"_start\"]){\n\t\tscheduler._max_date = scheduler.date[view.x_unit+\"_start\"](scheduler._max_date);\n\t}\n\tscheduler._table_view = true;\n};\n\n\nscheduler._renderMatrix = function(mode, refresh) {\n\tthis.callEvent(\"onBeforeRender\", []);\n\t\n\tif (!refresh)\n\t\tscheduler._els['dhx_cal_data'][0].scrollTop=0;\n\n\n\n\tscheduler._set_timeline_dates(this);\n\n\tscheduler._timeline_set_full_view.call(this,mode);\n};\n\nscheduler._timeline_html_index = function html_index(el) {\n\tvar p = el.parentNode.childNodes;\n\n\tvar nodeIndex = -1;\n\tfor (var i=0; i < p.length; i++) {\n\t\tif (p[i] == el){\n\t\t\tnodeIndex = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tvar resIndex = nodeIndex;\n\tif(scheduler._ignores_detected){\n\t\tfor(var colIndex in scheduler._ignores){\n\t\t\tif(scheduler._ignores[colIndex] && colIndex*1 <= resIndex)\n\t\t\t\tresIndex++;\n\t\t}\n\t}\n\n\treturn resIndex;\n};\n\nscheduler._timeline_locate_hcell = function locate_hcell(e){\n\tvar trg = e.target?e.target:e.srcElement;\n\twhile (trg && trg.tagName != \"DIV\")\n\t\ttrg=trg.parentNode;\n\tif (trg && trg.tagName == \"DIV\"){\n\t\tvar cs = scheduler._getClassName(trg).split(\" \")[0];\n\t\tif (cs == \"dhx_scale_bar\")\n\t\t\treturn { x:scheduler._timeline_html_index(trg), y:-1, src:trg, scale:true };\n\t}\n};\n\nfunction closest(element, selector){\n\treturn scheduler.$domHelpers.closest(element, selector);\n}\n\n\nscheduler._locate_cell_timeline = function(e){\n\tvar trg = e.target?e.target:e.srcElement;\n\n\tvar res = {};\n\tvar view = scheduler.matrix[scheduler._mode];\n\tvar pos = scheduler.getActionData(e);\n\tvar ign = scheduler._ignores;\n\n\tvar xNonIgnoredInd = 0;\n\tfor (var xind = 0; xind < view._trace_x.length-1; xind++) {\n\t\t// | 8:00, 8:30 | 8:15 should be checked against 8:30\n\t\t// clicking at the most left part of the cell, say 8:30 should create event in that cell, not previous one\n\t\tif (+pos.date < view._trace_x[xind+1])\n\t\t\tbreak;\n\n\t\tif(!ign[xind]) {\n\t\t\txNonIgnoredInd++;\n\t\t}\n\t}\n\n\tres.x = xNonIgnoredInd === 0 ? 0 : xind;\n\tres.y = view.order[pos.section];\n\t// var diff = scheduler._isRender('cell') ? 1 : 0;\n\n\t// firstCellXind is needed for cell mode when part of cols is rendered only\n\t// and defines correct shift for tooltip xind = xind - firstCellXind\n\t// where xind = current index, firstCellXind = first visible cell index\n\tvar firstCellXind = 0;\n\tif (view.scrollable && view.render === 'cell') {\n\t\t// define xind of first visible cell\n\t\tif (!view._scales[pos.section] || !view._scales[pos.section].querySelector('.dhx_matrix_cell')) return;\n\t\tvar firstCell = view._scales[pos.section].querySelector('.dhx_matrix_cell');\n\t\t\tif (!firstCell) return;\n\t\tvar fc_pos_x = firstCell.offsetLeft;\n\t\tif (fc_pos_x > 0) {\n\t\t\tvar end_date = scheduler._timeline_drag_date(view, fc_pos_x);\n\n\t\t\tfor (var i = 0; i < view._trace_x.length-1; i++) {\n\t\t\t\tif (+end_date < view._trace_x[i+1])\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfirstCellXind = i;\n\t\t}\n\t}\n\tres.src = view._scales[pos.section] ? view._scales[pos.section].querySelectorAll('.dhx_matrix_cell')[xind - firstCellXind] : null;\n\n\tvar isScale = false;\n\n\tvar scaleTarget = closest(trg, \".dhx_matrix_scell\");\n\tif(scaleTarget){\n\t\ttrg = scaleTarget;\n\t\tisScale = true;\n\t}\n\n\tif (isScale) { // Y scale\n\t\tres.x = -1;\n\t\tres.src = trg;\n\t\tres.scale = true;\n\t}\n\telse{\n\t\tres.x = xind;\n\t}\n\n\treturn res;\n};\n\nvar old_click = scheduler._click.dhx_cal_data;\nscheduler._click.dhx_marked_timespan = scheduler._click.dhx_cal_data = function(e){\n\tvar ret = old_click.apply(this,arguments);\n\tvar obj = scheduler.matrix[scheduler._mode];\n\tif (obj){\n\t\tvar pos = scheduler._locate_cell_timeline(e);\n\t\tif (pos){\n\t\t\tif (pos.scale)\n\t\t\t\tscheduler.callEvent(\"onYScaleClick\",[pos.y, obj.y_unit[pos.y], e]);\n\t\t\telse {\n\t\t\t\tscheduler.callEvent(\"onCellClick\", [pos.x, pos.y, obj._trace_x[pos.x], (((obj._matrix[pos.y] || {})[pos.x]) || []), e]);\n\t\t\t\tscheduler._timeline_set_scroll_pos(scheduler._els[\"dhx_cal_data\"][0], obj);\n\t\t\t}\n\t\t}\n\t}\n\treturn ret;\n};\n\nscheduler.dblclick_dhx_matrix_cell = function(e){\n\tvar obj = scheduler.matrix[scheduler._mode];\n\tif (obj){\n\t\tvar pos = scheduler._locate_cell_timeline(e);\n\t\tif (pos){\n\t\t\tif (pos.scale)\n\t\t\t\tscheduler.callEvent(\"onYScaleDblClick\",[pos.y, obj.y_unit[pos.y], e]);\n\t\t\telse\n\t\t\t\tscheduler.callEvent(\"onCellDblClick\",[pos.x, pos.y, obj._trace_x[pos.x], (((obj._matrix[pos.y]||{})[pos.x])||[]), e]);\n\t\t}\n\t}\n};\n\nvar old_dblclick_marked_timespan = scheduler.dblclick_dhx_marked_timespan || function(){};\nscheduler.dblclick_dhx_marked_timespan = function(e){\n\tvar obj = scheduler.matrix[scheduler._mode];\n\tif (obj)\n\t\treturn scheduler.dblclick_dhx_matrix_cell(e);\n\telse\n\t\treturn old_dblclick_marked_timespan.apply(this,arguments);\n};\n\nscheduler.dblclick_dhx_matrix_scell = function(e){\n\treturn scheduler.dblclick_dhx_matrix_cell(e);\n};\n\nscheduler._isRender = function(mode){\n\treturn (scheduler.matrix[scheduler._mode] && scheduler.matrix[scheduler._mode].render == mode);\n};\n\nscheduler.attachEvent(\"onCellDblClick\", function (x, y, a, b, event){\n\tif (this.config.readonly|| (event.type == \"dblclick\" && !this.config.dblclick_create)) return;\n\n\tvar obj = scheduler.matrix[scheduler._mode];\n\tvar event_options = {};\n\tevent_options.start_date = obj._trace_x[x];\n\tevent_options.end_date = (obj._trace_x[x+1]) ? obj._trace_x[x+1] : scheduler.date.add(obj._trace_x[x], obj.x_step, obj.x_unit);\n\n\tif (obj._start_correction)\n\t\tevent_options.start_date = new Date(event_options.start_date*1 + obj._start_correction);\n\tif (obj._end_correction)\n\t\tevent_options.end_date = new Date(event_options.end_date - obj._end_correction);\n\n\tevent_options[obj.y_property] = obj.y_unit[y].key;\n\tscheduler.addEventNow(event_options, null, event);\n});\n\nscheduler.attachEvent(\"onBeforeDrag\", function (event_id, mode, native_event_object){\n\treturn !scheduler._isRender(\"cell\");\n});\nscheduler.attachEvent(\"onEventChanged\", function(id, ev) {\n\tev._timed = this.isOneDayEvent(ev);\n});\nscheduler.attachEvent(\"onBeforeEventChanged\", function (ev, e, flag, ev_old) {\n\tif(ev){\n\t\tev._move_delta = undefined;\n\t}\n\tif(ev_old){\n\t\tev_old._move_delta = undefined;\n\t}\n\treturn true;\n});\n\nscheduler._is_column_visible = function(date){\n\tvar mode = scheduler.matrix[scheduler._mode];\n\tvar start_ind = scheduler._get_date_index(mode, date);\n\treturn !scheduler._ignores[start_ind];\n};\nvar old_render_marked_timespan = scheduler._render_marked_timespan;\nscheduler._render_marked_timespan = function(options, area, unit_id, min_date, max_date) {\n\tif (!scheduler.config.display_marked_timespans)\n\t\treturn [];\n\n\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\tif (scheduler._isRender('cell'))\n\t\t\treturn;\n\n\t\tvar view_opts = scheduler._lame_copy({}, scheduler.matrix[scheduler._mode]);\n\t\t//timespans must always use actual position, not rounded\n\t\tview_opts.round_position = false;\n\t\tvar blocks = [];\n\n\t\tvar units = [];\n\t\tvar areas = [];\n\t\tvar section = options.sections ? (options.sections.units || options.sections.timeline) : null;\n\t\tif (!unit_id) {  // should draw for every unit...\n\t\t\tvar order = view_opts.order;\n\t\t\tif (section) { // ...or for only section if mentioned in configuration of timespan\n\t\t\t\tif (order.hasOwnProperty(section)) {\n\t\t\t\t\tunits.push(section);\n\t\t\t\t\tareas.push(view_opts._scales[section]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(view_opts._scales) {\n\t\t\t\t\tfor (var key in order) {\n\t\t\t\t\t\tif (order.hasOwnProperty(key) && view_opts._scales[key]) {\n\t\t\t\t\t\t\tunits.push(key);\n\t\t\t\t\t\t\tareas.push(view_opts._scales[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tareas = [area];\n\t\t\tunits = [unit_id];\n\t\t}\n\n\t\tvar min_date = min_date ? new Date(min_date) : scheduler._min_date;\n\t\tvar max_date = max_date ? new Date(max_date) : scheduler._max_date;\n\n\t\tif(min_date.valueOf() < scheduler._min_date.valueOf())\n\t\t\tmin_date = new Date(scheduler._min_date);\n\t\tif(max_date.valueOf() > scheduler._max_date.valueOf())\n\t\t\tmax_date = new Date(scheduler._max_date);\n\n\t\tif(!view_opts._trace_x) return;\n\n\t\tfor(var i = 0; i < view_opts._trace_x.length; i++){\n\t\t\tif(scheduler._is_column_visible(view_opts._trace_x[i]))\n\t\t\t\tbreak;\n\t\t}\n\t\tif(i == view_opts._trace_x.length)\n\t\t\treturn;\n\n\t\tvar dates = [];\n\n\t\tif (options.days > 6) {\n\t\t\tvar specific_date = new Date(options.days);\n\t\t\tif (scheduler.date.date_part(new Date(min_date)) <= +specific_date && +max_date >= +specific_date)\n\t\t\t\tdates.push(specific_date);\n\t\t} else {\n\t\t\tdates.push.apply(dates, scheduler._get_dates_by_index(options.days));\n\t\t}\n\n\t\tvar zones = options.zones;\n\t\tvar css_classes = scheduler._get_css_classes_by_config(options);\n\n\t\tfor (var j=0; j<units.length; j++) {\n\t\t\tarea = areas[j];\n\t\t\tunit_id = units[j];\n\n\t\t\tfor (var i=0; i<dates.length; i++) {\n\t\t\t\tvar date = dates[i];\n\t\t\t\tfor (var k=0; k<zones.length; k += 2) {\n\t\t\t\t\tvar zone_start = zones[k];\n\t\t\t\t\tvar zone_end = zones[k+1];\n\t\t\t\t\tvar start_date = new Date(+date + zone_start*60*1000);\n\t\t\t\t\tvar end_date = new Date(+date + zone_end*60*1000);\n\n\t\t\t\t\tstart_date = new Date(start_date.valueOf() + (start_date.getTimezoneOffset() - date.getTimezoneOffset())*1000*60);\n\n\t\t\t\t\tend_date = new Date(end_date.valueOf() + (end_date.getTimezoneOffset() - date.getTimezoneOffset())*1000*60);\n\n\t\t\t\t\tif (!(min_date < end_date && max_date > start_date))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvar block = scheduler._get_block_by_config(options);\n\t\t\t\t\tblock.className = css_classes;\n\n\t\t\t\t\tvar start_pos = scheduler._timeline_getX({start_date: start_date}, false, view_opts)-1;\n\t\t\t\t\tvar end_pos = scheduler._timeline_getX({start_date: end_date}, false, view_opts)-1;\n\t\t\t\t\tvar width = Math.max(1, end_pos - start_pos - 1);\n\t\t\t\t\tvar height = ((view_opts._section_height[unit_id]-1) || (view_opts.dy - 1));\n\n\t\t\t\t\tblock.style.cssText = \"height: \"+height+\"px; \" + (scheduler.config.rtl ? \"right: \" :\"left: \")+start_pos+\"px; width: \"+width+\"px; top: 0;\";\n\n\t\t\t\t\tarea.insertBefore(block, area.firstChild);\n\t\t\t\t\tblocks.push(block);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn blocks;\n\n\t} else {\n\t\t\treturn old_render_marked_timespan.apply(scheduler, [options, area, unit_id]);\n\t}\n};\n\nvar old_append_mark_now = scheduler._append_mark_now;\nscheduler._append_mark_now = function(day_index, now) {\n\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\tvar n_date = scheduler._currentDate();\n\t\tvar zone_start = scheduler._get_zone_minutes(n_date);\n\t\tvar options = {\n\t\t\tdays: +scheduler.date.date_part(n_date),\n\t\t\tzones: [zone_start, zone_start+1],\n\t\t\tcss: \"dhx_matrix_now_time\",\n\t\t\ttype: \"dhx_now_time\"\n\t\t};\n\t\treturn scheduler._render_marked_timespan(options);\n\t} else {\n\t\treturn old_append_mark_now.apply(scheduler, [day_index, now]);\n\t}\n};\n\nvar oldTimespans = scheduler._mark_timespans;\nscheduler._mark_timespans = function(){\n\tif(scheduler.matrix && scheduler.matrix[scheduler.getState().mode]){\n\t\tvar divs = [];\n\n\t\tvar view = scheduler.matrix[scheduler.getState().mode];\n\t\tvar options = view.y_unit;\n\t\tfor(var i = 0; i < options.length; i++){\n\t\t\tvar unit_key = options[i].key;\n\t\t\tvar scale = view._scales[unit_key];\n\n\t\t\tvar r = scheduler._on_scale_add_marker(scale, unit_key);\n\t\t\tdivs.push.apply(divs, r);\n\t\t}\n\n\t\treturn divs;\n\t}else{\n\t\treturn oldTimespans.apply(this, arguments);\n\t}\n};\n\nvar on_scale_marker_add = scheduler._on_scale_add_marker;\nscheduler._on_scale_add_marker = function(scale, unit_key){\n\n\tif (scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\tvar divs = [];\n\t\tvar timespans = scheduler._marked_timespans;\n\n\t\tif (timespans && scheduler.matrix && scheduler.matrix[scheduler._mode]) {\n\t\t\tvar mode = scheduler._mode;\n\n\t\t\tvar min_date = scheduler._min_date;\n\t\t\tvar max_date = scheduler._max_date;\n\t\t\tvar global_data = timespans[\"global\"];\n\n\t\t\tfor (var t_date = scheduler.date.date_part(new Date(min_date)); t_date < max_date; t_date = scheduler.date.add(t_date, 1, \"day\")) {\n\t\t\t\tvar day_value = +t_date;\n\t\t\t\tvar day_index = t_date.getDay();\n\t\t\t\tvar r_configs = [];\n\n\t\t\t\tif(scheduler.config.overwrite_marked_timespans){\n\t\t\t\t\tvar day_types = global_data[day_value]||global_data[day_index];\n\t\t\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(day_types));\n\t\t\t\t} else {\n\t\t\t\t\tif(global_data[day_value]){\n\t\t\t\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(global_data[day_value]));\n\t\t\t\t\t}\n\t\t\t\t\tif(global_data[day_index]){\n\t\t\t\t\t\tr_configs.push.apply(r_configs, scheduler._get_configs_to_render(global_data[day_index]));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (timespans[mode] && timespans[mode][unit_key]) {\n\t\t\t\t\tvar z_config = [];\n\t\t\t\t\tvar unit_types = scheduler._get_types_to_render(timespans[mode][unit_key][day_index], timespans[mode][unit_key][day_value]);\n\t\t\t\t\tz_config.push.apply(z_config, scheduler._get_configs_to_render(unit_types));\n\t\t\t\t\tif(scheduler.config.overwrite_marked_timespans){\n\t\t\t\t\t\tif(z_config.length){\n\t\t\t\t\t\t\tr_configs = z_config;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tr_configs = r_configs.concat(z_config);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (var i=0; i<r_configs.length; i++) {\n\t\t\t\t\tvar config = r_configs[i];\n\t\t\t\t\tvar day = config.days;\n\t\t\t\t\tif (day < 7) {\n\t\t\t\t\t\tday = day_value;\n\t\t\t\t\t\t//specify min/max timespan dates, otherwise it can be rendered multiple times in some configurations\n\t\t\t\t\t\tdivs.push.apply(divs, scheduler._render_marked_timespan(config, scale, unit_key, t_date, scheduler.date.add(t_date, 1, \"day\")));\n\t\t\t\t\t\tday = day_index;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdivs.push.apply(divs, scheduler._render_marked_timespan(config, scale, unit_key, t_date, scheduler.date.add(t_date, 1, \"day\")));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn divs;\n\t}else{\n\t\treturn on_scale_marker_add.apply(this, arguments);\n\t}\n};\n\nscheduler._resolve_timeline_section = function(view, pos){\n\tvar yind = 0;\n\tvar summ = 0;\n\tfor (yind; yind < this._colsS.heights.length; yind++) {\n\t\tsumm += this._colsS.heights[yind];\n\t\tif (summ > pos.y)\n\t\t\tbreak;\n\t}\n\n\tif(!view.y_unit[yind]) {\n\t\tyind=view.y_unit.length-1;\n\t}\n\tif(this._drag_event && !this._drag_event._orig_section){\n\t\tthis._drag_event._orig_section = view.y_unit[yind].key;\n\t}\n\n\tpos.fields = {};\n\tif (yind >= 0 && view.y_unit[yind]) {\n\t\tpos.section = pos.fields[view.y_property] = view.y_unit[yind].key;\n\t}\n};\nscheduler._update_timeline_section = function(action){\n\tvar view = action.view,\n\t\tevent = action.event,\n\t\tpos = action.pos;\n\n\tif (event) {\n\t\tif(event[view.y_property] != pos.section){\n\t\t\tvar line_height = this._get_timeline_event_height ? this._get_timeline_event_height(event, view) : view.getEventHeight(event);\n\t\t\tevent._sorder = this._get_dnd_order(event._sorder, line_height, view.getSectionHeight(pos.section));\n\t\t}\n\t\tevent[view.y_property] = pos.section;\n\t}\n};\nscheduler._get_date_index=function(config, date) {\n\tvar trace_x = config._trace_x;\n\n\tvar searchFrom = 0,\n\t\tsearchTo = trace_x.length - 1;\n\n\t// reduce search range with binary search\n\tvar dateValue = date.valueOf();\n\twhile(searchTo - searchFrom > 3){\n\t\tvar middle = searchFrom + Math.floor((searchTo - searchFrom)/2);\n\t\tif(trace_x[middle].valueOf() > dateValue){\n\t\t\tsearchTo = middle;\n\t\t}else{\n\t\t\tsearchFrom = middle;\n\t\t}\n\t}\n\n\tvar index = searchFrom;\n\twhile (index <= searchTo && +date >= +trace_x[index+1]) {\n\t\tindex++;\n\t}\n\treturn index;\n};\n\nscheduler._timeline_drag_date = function(timeline, pos_x){\n\tvar obj = timeline,\n\t\tpos = {x: pos_x};\n\n\tif(!obj._trace_x.length){\n\t\treturn new Date(scheduler.getState().date);\n\t}\n\n\tvar summ = 0, xind = 0;\n\tvar ratio,\n\t\tcolumn_width;\n\tfor (xind; xind <= this._cols.length-1; xind++) {\n\n\t\tcolumn_width = this._cols[xind];\n\t\tsumm += column_width;\n\t\tif (summ>pos.x){ //index of section\n\t\t\tratio = (pos.x-(summ-column_width))/column_width;\n\t\t\tratio = (ratio < 0) ? 0 : ratio;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(obj.round_position){\n\t\t// in case of click, or creating new event, mouse position will be always rounded to start date of the cell\n\t\t// when dragging - position can be rounded to the start date of the next column, in order to improve the usability\n\t\t// edge = 1 - always return start date of current cell\n\t\t// 0.5 - round to next cell if mouse in the right half of cell\n\t\tvar edge = 1;\n\t\tvar mode = scheduler.getState().drag_mode;\n\t\tif(mode && mode != \"move\" && mode != \"create\"){\n\t\t\tedge = 0.5;//rounding for resize\n\t\t}\n\t\tif(ratio >= edge){\n\t\t\txind++;\n\t\t}\n\t\tratio = 0;\n\t}\n\n\t//border cases\n\tif (xind === 0 && this._ignores[0]) {\n\t\txind = 1; ratio = 0;\n\t\twhile (this._ignores[xind]) xind++;\n\t} else if ( xind == this._cols.length && this._ignores[xind-1]) {\n\t\txind = this._cols.length-1; ratio = 0;\n\t\twhile (this._ignores[xind]) xind--;\n\t\txind++;\n\t}\n\n\tvar end_date;\n\t// if our event is at the end of the view\n\tif(xind >= obj._trace_x.length) {\n\t\tend_date = scheduler.date.add(obj._trace_x[obj._trace_x.length-1], obj.x_step, obj.x_unit);\n\t\tif (obj._end_correction)\n\t\t\tend_date = new Date(end_date-obj._end_correction);\n\t} else {\n\t\tlet timestamp_diff;\n\t\t//GS-2775: set the step according to the days in month\n\t\tif(obj.x_unit == \"month\"){\n\t\t\tconst daysInMonth = new Date(new Date(+obj._trace_x[xind]).getFullYear(), new Date(+obj._trace_x[xind]).getMonth()+1, 0).getDate();\n\t\t\tconst monthStep = (daysInMonth * 24*60*60*1000)/scheduler._cols[0];\n\t\t\ttimestamp_diff = ratio * column_width * monthStep + obj._start_correction;\n\t\t} else {\n\t\t\ttimestamp_diff = ratio * column_width * obj._step + obj._start_correction;\n\t\t}\n\t\tend_date = new Date(+obj._trace_x[xind]+timestamp_diff);\n\t}\n\treturn end_date;\n};\n\nscheduler.attachEvent(\"onBeforeTodayDisplayed\", function() {\n\tfor(var i in scheduler.matrix){\n\t\tvar obj = scheduler.matrix[i];\n\t\tobj.x_start = obj._original_x_start;\n\t}\n\treturn true;\n});\n\nscheduler.attachEvent(\"onOptionsLoad\",function(){\n\tfor(var i in scheduler.matrix){\n\t\tvar obj = scheduler.matrix[i];\n\n\t\tobj.order = {};\n\t\tscheduler.callEvent('onOptionsLoadStart', []);\n\t\tfor(var i=0; i<obj.y_unit.length;i++)\n\t\t\tobj.order[obj.y_unit[i].key]=i;\n\t\tscheduler.callEvent('onOptionsLoadFinal', []);\n\t\tif (scheduler._date && obj.name == scheduler._mode) {\n\t\t\tobj._options_changed = true;\n\t\t\tscheduler.setCurrentView(scheduler._date, scheduler._mode);\n\t\t\tsetTimeout(function () {\n\t\t\t\tobj._options_changed = false;\n\t\t\t});\n\t\t}\n\t}\n});\n\nscheduler.attachEvent(\"onEventIdChange\", function(){\n\tvar view = scheduler.getView();\n\tif(view && scheduler.matrix[view.name]){\n\t\tif(scheduler._timeline_smart_render){\n\n\t\t\tscheduler._timeline_smart_render.clearPreparedEventsCache();\n\t\t\tscheduler._timeline_smart_render.getPreparedEvents(view);\n\t\t}\n\t}\n\n});\n\nscheduler.attachEvent(\"onBeforeDrag\",function(id, drag_mode, e){\n\tif(drag_mode == 'resize'){\n\t\tvar trg = e.target || e.srcElement;\n\t\tvar className = scheduler._getClassName(trg);\n\t\tif(className.indexOf(\"dhx_event_resize_end\") < 0){\n\t\t\tscheduler._drag_from_start = true;\n\t\t}else{\n\t\t\tscheduler._drag_from_start = false;\n\t\t}\n\t}\n\n\treturn true;\n});\n\nautoscroll(scheduler);\nsmartRender(scheduler);\n\n//-#include ext/timeline/autoscroll.js\n//-#include ext/timeline/timeline_smart_render.js\n\n};\nscheduler._temp_matrix_scope();\n\n\n}","/* timeline smart render */\n\n// scrollable should be = true\n// horizontal and vertical scroll -> dhx_timeline_scrollable_data\n\nexport default function(scheduler){\n\nfunction contains(section, eventId){\n\tfor(let i = 0; i < section.length; i++){\n\t\tif(section[i].id == eventId){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nscheduler._timeline_smart_render = {\n\t_prepared_events_cache: null,\n\t_rendered_events_cache: [],\n\t_rendered_header_cache: [],\n\t_rendered_labels_cache: [],\n\t_rows_to_delete: [],\n\t_rows_to_add: [],\n\t_cols_to_delete: [],\n\t_cols_to_add: [],\n\n\tgetViewPort: function(scrollHelper, resizeHeight, scrollLeft, scrollTop){\n\t\t// top/left/height/width of viewport with scroll pos\n\t\tvar scrollBlock = scheduler.$container.querySelector(\".dhx_cal_data\");\n\t\tvar coords = scrollBlock.getBoundingClientRect();\n\n\t\tvar scrollableContainer = scheduler.$container.querySelector(\".dhx_timeline_scrollable_data\");\n\t\tif(scrollableContainer && scrollLeft === undefined){\n\t\t\tscrollLeft = scrollHelper.getScrollValue(scrollableContainer);\n\t\t}\n\t\tif(scrollTop === undefined){\n\t\t\tif(scrollableContainer){\n\t\t\t\tscrollTop = scrollableContainer.scrollTop;\n\t\t\t}else{\n\t\t\t\tscrollTop = scrollBlock.scrollTop;\n\t\t\t}\n\t\t}\n\n\t\tvar copy = {};\n\t\tfor(var i in coords){\n\t\t\tcopy[i] = coords[i];\n\t\t}\n\n\t\tcopy.scrollLeft = scrollLeft || 0;\n\t\tcopy.scrollTop = scrollTop || 0;\n\t\tif (resizeHeight)\n\t\t\tcoords.height = resizeHeight;\n\n\t\treturn copy;\n\t},\n\tisInXViewPort: function (item, viewPort) {\n\t\tvar viewPortLeft =  viewPort.scrollLeft;\n\t\tvar viewPortRight = viewPort.width + viewPort.scrollLeft;\n\n\t\t// return true/false for item in/not in viewport on X axis\n\t\treturn (item.left < viewPortRight + 100 && item.right > viewPortLeft - 100); // +100 and -100 spreads viewport width\n\t},\n\tisInYViewPort: function (item, viewPort) {\n\t\tvar viewPortTop =  viewPort.scrollTop;\n\t\tvar viewPortBottom = viewPort.height + viewPort.scrollTop;\n\n\t\t// return true/false for item in/not in viewport on Y axis\n\t\treturn (item.top < (viewPortBottom + 80) && item.bottom > viewPortTop - 80); // +30 and -30 spreads viewport height\n\t},\n\n\tgetVisibleHeader: function(view, viewPort) {\n\t\tvar curHeader = '';\n\t\tthis._rendered_header_cache = [];\n\n\t\tfor (var i in view._h_cols) {\n\t\t\tvar col = view._h_cols[i];\n\t\t\tif (this.isInXViewPort({left: col.left, right: col.left + scheduler._cols[i]}, viewPort)) {\n\t\t\t\tvar html = col.div.outerHTML;\n\t\t\t\tcurHeader += html;\n\n\t\t\t\tthis._rendered_header_cache.push(col.div.getAttribute(\"data-col-id\"));\n\t\t\t}\n\t\t}\n\n\t\treturn curHeader;\n\t},\n\n\tupdateHeader: function(view, viewPort, parent) {\n\t\tthis._cols_to_delete = [];\n\t\tthis._cols_to_add = [];\n\n\t\tvar headers = scheduler.$container.querySelectorAll(\".dhx_cal_header > div\");\n\t\tvar cells = headers[headers.length - 1].querySelectorAll(\".dhx_scale_bar\");// take cells of bottom scale\n\n\t\tvar visibleItems = [];\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tvisibleItems.push(cells[i].getAttribute(\"data-col-id\"));\n\t\t}\n\n\t\t// find new elements\n\t\tvar res = this.getVisibleHeader(view, viewPort);\n\t\tif (!res)\n\t\t\treturn;\n\n\t\tvar renderers = this._rendered_header_cache.slice();\n\t\tvar itemsToDel = [];\n\n\t\tfor (var i = 0, len = visibleItems.length; i < len; i++) {\n\t\t\tvar pos = renderers.indexOf(visibleItems[i]);\n\t\t\tif ( pos > -1) {\n\t\t\t\trenderers.splice(pos, 1);\n\t\t\t} else {\n\t\t\t\titemsToDel.push(visibleItems[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (itemsToDel.length) {\n\t\t\tthis._cols_to_delete = itemsToDel.slice();\n\t\t\tthis._deleteHeaderCells(itemsToDel, view, parent);\n\t\t}\n\t\tif (renderers.length)  {\n\t\t\tthis._cols_to_add = renderers.slice();\n\t\t\tthis._addHeaderCells(renderers, view, parent);\n\t\t}\n\t},\n\n\t_deleteHeaderCells: function(items, view, parent) {\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tvar item = parent.querySelector('[data-col-id=\"'+items[i]+'\"]');\n\t\t\tif(item){\n\t\t\t\tparent.removeChild(item);\n\t\t\t}\n\t\t}\n\t},\n\n\t_addHeaderCells: function(items, view, parent) {\n\t\tvar html = '';\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\thtml += view._h_cols[items[i]].div.outerHTML;\n\t\t}\n\n\t\tconst buffer = document.createElement('template');\n\t\tbuffer.innerHTML = html;\n\t\tparent.appendChild(buffer.content);\n\n\t},\n\n\tgetVisibleLabels: function(view, viewPort) {\n\t\tif (!view._label_rows.length) return;\n\n\t\tvar curLabelCol = '';\n\n\t\tthis._rendered_labels_cache = [];\n\t\tfor (var i = 0; i < view._label_rows.length; i++) {\n\t\t\tif (this.isInYViewPort({top: view._label_rows[i].top, bottom: view._label_rows[i].top + view._section_height[view.y_unit[i].key]}, viewPort)) {\n\t\t\t\tvar html = view._label_rows[i].div;\n\t\t\t\tcurLabelCol += html;\n\n\t\t\t\tthis._rendered_labels_cache.push(i);\n\t\t\t}\n\t\t}\n\n\t\treturn curLabelCol;\n\t},\n\n\tupdateLabels: function(view, viewPort, parent) {\n\t\tthis._rows_to_delete = [];\n\t\tthis._rows_to_add = [];\n\n\t\tlet visibleItems = [];\n\t\tconst gridRows = scheduler.$container.querySelectorAll(\".dhx_timeline_label_row\");\n\t\tgridRows.forEach((row) => {\n\t\t\tvisibleItems.push(Number(row.getAttribute(\"data-row-index\")));\n\t\t});\n\n\t\t// is it realy no visible items? check it again\n\t\tif (!visibleItems.length) {\n\t\t\tthis.getVisibleLabels(view, viewPort);\n\t\t\tvisibleItems = this._rendered_labels_cache.slice();\n\t\t}\n\n\t\t// find new elements\n\t\tvar res = this.getVisibleLabels(view, viewPort);\n\t\tif (!res)\n\t\t\treturn;\n\n\t\tvar renderers = this._rendered_labels_cache.slice();\n\n\t\tvar itemsToDel = [];\n\n\t\tfor (var i = 0, len = visibleItems.length; i < len; i++) {\n\t\t\tvar pos = renderers.indexOf(visibleItems[i]);\n\t\t\tif ( pos > -1) {\n\t\t\t\trenderers.splice(pos, 1);\n\t\t\t} else {\n\t\t\t\titemsToDel.push(visibleItems[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (itemsToDel.length) {\n\t\t\tthis._rows_to_delete = itemsToDel.slice();\n\t\t\tthis._deleteLabelCells(itemsToDel, view, parent);\n\t\t}\n\t\tif (renderers.length) {\n\t\t\tthis._rows_to_add = renderers.slice();\n\t\t\tthis._addLabelCells(renderers, view, parent);\n\t\t}\n\t},\n\n\t_deleteLabelCells: function(items, view, parent) {\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tvar item = parent.querySelector('[data-row-index=\"'+items[i]+'\"]');\n\t\t\tif(item){\n\t\t\t\tparent.removeChild(item);\n\t\t\t}\n\t\t}\n\t},\n\n\t_addLabelCells: function(items, view, parent) {\n\t\tvar html = '';\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\thtml += view._label_rows[items[i]].div;\n\t\t}\n\t\tconst buffer = document.createElement('template');\n\t\tbuffer.innerHTML = html;\n\t\tparent.appendChild(buffer.content);\n\t},\n\n\tclearPreparedEventsCache: function () {\n\t\tthis.cachePreparedEvents(null);\n\t},\n\tcachePreparedEvents: function(events){\n\t\tthis._prepared_events_cache = events;\n\t\tthis._prepared_events_coordinate_cache = events;\n\n\t},\n\n\tgetPreparedEvents: function(view){\n\t\tvar evs;\n\t\tif(this._prepared_events_cache){\n\t\t\tevs = this._prepared_events_cache;\n\n\t\t\tif(scheduler.getState().drag_id){\n\t\t\t\t// events grouped by sections\n\t\t\t\t// the whole structure is not updated during drag and drop\n\t\t\t\t// smart render needs moved event to be under right section here\n\t\t\t\t// manually place event under right section\n\t\t\t\tconst dragId = scheduler.getState().drag_id;\n\t\t\t\tlet stop = false;\n\t\t\t\t\n\n\t\t\t\tlet found = false;\n\n\t\t\t\tevs.forEach((section, index) => {\n\t\t\t\t\tif(stop){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentSectionId = view.y_unit[index];\n\t\t\t\t\tfor(let eventIndex = 0; eventIndex < section.length; eventIndex++){\n\t\t\t\t\t\tconst ev = section[eventIndex];\n\n\t\t\t\t\t\tif(ev.id == dragId){\n\n\t\t\t\t\t\t\tif(ev[view.y_property] !== currentSectionId){\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tsection.splice(eventIndex, 1);\n\t\t\t\t\t\t\t\teventIndex--;\n\n\t\t\t\t\t\t\t\tconst actualEventSectionIndex = view.order[ev[view.y_property]];\n\t\t\t\t\t\t\t\tif(evs[actualEventSectionIndex] != section && evs[actualEventSectionIndex] && !contains(evs[actualEventSectionIndex], ev.id)){\n\t\t\t\t\t\t\t\t\tevs[actualEventSectionIndex].push(ev);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\tif(found){\n\t\t\t\t\t\tstop = true;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t}\n\t\t}else{\n\t\t\tevs = scheduler._prepare_timeline_events(view);\n\t\t\tevs.$coordinates = {};\n\t\t\tthis.cachePreparedEvents(evs);\n\n\n\n\n\t\t\t//var x_start = scheduler._timeline_getX(evs[i][m], false, view);\n\t\t\t//\t\tvar x_end = scheduler._timeline_getX(evs[i][m], true, view);\n\t\t}\n\t\treturn evs;\n\t},\n\n\tupdateEvents: function(view, viewPort) {\n\t\tvar eventsBySections = this.getPreparedEvents(view);\n\n\t\tvar renderedEvents = this._rendered_events_cache.slice();\n\t\tthis._rendered_events_cache = [];\n\n\t\tvar grid = scheduler.$container.querySelector('.dhx_cal_data .dhx_timeline_data_col');\n\t\tif (!grid) return;\n\n\t\tconst willAdd = [];\n\t\tfor (var i = 0; i < this._rendered_labels_cache.length; i++) {\n\t\t\tvar row = this._rendered_labels_cache[i];\n\t\t\tvar eventsToAdd = [];\n\n\t\t\tconst sectionId = view.y_unit[row].key;\n\t\t\tvar visibleRowEvents = renderedEvents[row] ? renderedEvents[row].slice() : [];\n\t\t\tscheduler._timeline_calculate_event_positions.call(view, eventsBySections[row]);\n\t\t\tvar renderers = scheduler._timeline_smart_render.getVisibleEventsForRow(view, viewPort, eventsBySections, row);\n\n\t\t\tfor (var item = 0, lenRend = renderers.length; item < lenRend; item++) {\n\t\t\t\tvar pos = visibleRowEvents.indexOf(String(renderers[item].id));\n\t\t\t\tif ( pos > -1) {\n\n\t\t\t\t\tif(scheduler.getState().drag_id == renderers[item].id){\n\t\t\t\t\t\tfor(let r = 0; r < visibleRowEvents.length; r++){\n\t\t\t\t\t\t\tif(visibleRowEvents[r] == renderers[item].id && renderers[item][view.y_property] != sectionId){\n\t\t\t\t\t\t\t\tvisibleRowEvents.splice(r, 1);\n\t\t\t\t\t\t\t\tr--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvisibleRowEvents.splice(pos, 1);\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\teventsToAdd.push(renderers[item]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(scheduler.getState().drag_id ) {\n\t\t\t\tconst evId = scheduler.getState().drag_id;\n\t\t\t\tconst draggableEvent = scheduler.getEvent(evId);\n\t\t\t\tif(scheduler._split_one_event && draggableEvent){\n\t\t\t\t\tconst multievs = [];\n\t\t\t\t\tif(draggableEvent[view.y_property] == sectionId){\n\t\t\t\t\t\teventsToAdd.push(draggableEvent);\n\t\t\t\t\t}\n\t\t\t\t\tscheduler._split_one_event(draggableEvent, view, multievs);\n\t\t\t\t\tmultievs.forEach(e => {\n\t\t\t\t\t\tif(e[view.y_property] == sectionId){\n\t\t\t\t\t\t\teventsToAdd.push(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if(draggableEvent && draggableEvent[view.y_property] == sectionId){\n\t\t\t\t\teventsToAdd.push(draggableEvent);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar line = view._divBySectionId[sectionId];// grid.querySelector('[data-section-index=\"'+ row +'\"]');\n\t\t\tif(!line){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (visibleRowEvents.length) {\n\t\t\t\tthis._deleteEvents(visibleRowEvents, view, line);\n\t\t\t}\n\t\t\t\n\t\t\tconst addEntry = {\n\t\t\t\tDOMParent: line,\n\t\t\t\tbuffer: document.createElement('template')\n\t\t\t};\n\t\t\twillAdd.push(addEntry);\n\t\t\tif (eventsToAdd.length) {\n\t\t\t\tthis._addEvents(eventsToAdd, view, addEntry.buffer, row);\n\t\t\t}\n\t\t}\n\n\t\twillAdd.forEach(function(rowEvents){\n\t\t\trowEvents.DOMParent.appendChild(rowEvents.buffer.content);\n\t\t});\n\t\tscheduler._populate_timeline_rendered(scheduler.$container);\n\t\tview._matrix = eventsBySections;\n\t},\n\n\t_deleteEvents: function(events, view, parent) {\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tconst selector = '['+scheduler.config.event_attribute+'=\"'+ events[i] +'\"]';\n\t\t\tvar event = parent.querySelector(selector);\n\t\t\tif (event) {\n\t\t\t\tif (!event.classList.contains('dhx_in_move')){\n\t\t\t\t\tevent.remove();\n\t\t\t\t} else {\n\t\t\t\t\tconst parts = parent.querySelectorAll(selector);\n\n\t\t\t\t\tfor(let i = 0; i < parts.length;i++){\n\t\t\t\t\t\tif (!parts[i].classList.contains('dhx_in_move')){\n\t\t\t\t\t\t\tparts[i].remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_addEvents: function(events, view, parent, i) {\n\t\t// calculate height of all events but will render below only events in viewport\n\t\tvar events_html = scheduler._timeline_update_events_html.call(view, events);\n\t\tparent.innerHTML = events_html;\n\t},\n\n\tgetVisibleEventsForRow: function(view, viewPort, evs, rowIndex) {\n\t\t// get events only for viewport\n\t\tvar evsInViewport = [];\n\t\tif (view.render == \"cell\") {\n\t\t\tevsInViewport = evs;\n\t\t} else {\n\t\t\tvar rowEvents = evs[rowIndex];\n\t\t\tif (rowEvents) {\n\t\t\t\tfor (var m = 0, evLen = rowEvents.length; m < evLen; m++) {\n\t\t\t\t\tvar event = rowEvents[m];\n\t\t\t\t\tvar coordinateCacheKey = rowIndex + '_' + event.id;\n\t\t\t\t\tvar xStart, xEnd;\n\t\t\t\t\tif (evs.$coordinates && evs.$coordinates[coordinateCacheKey]) {\n\t\t\t\t\t\txStart = evs.$coordinates[coordinateCacheKey].xStart;\n\t\t\t\t\t\txEnd = evs.$coordinates[coordinateCacheKey].xEnd;\n\t\t\t\t\t} else {\n\t\t\t\t\t\txStart = scheduler._timeline_getX(event, false, view);\n\t\t\t\t\t\txEnd = scheduler._timeline_getX(event, true, view);\n\n\t\t\t\t\t\tif (evs.$coordinates) {\n\t\t\t\t\t\t\tevs.$coordinates[coordinateCacheKey] = {\n\t\t\t\t\t\t\t\txStart: xStart,\n\t\t\t\t\t\t\t\txEnd: xEnd\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (scheduler._timeline_smart_render.isInXViewPort({left: xStart, right: xEnd}, viewPort)) {\n\t\t\t\t\t\tevsInViewport.push(event);\n\n\t\t\t\t\t\t// save to cache\n\t\t\t\t\t\tif (!this._rendered_events_cache[rowIndex])\n\t\t\t\t\t\t\tthis._rendered_events_cache[rowIndex] = [];\n\t\t\t\t\t\tthis._rendered_events_cache[rowIndex].push(String(event.id));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn evsInViewport;\n\t},\n\n\tgetVisibleRowCellsHTML: function(view, viewPort, stats, evs, i) {\n\t\t// full render for new row uses _rendered_header_cache\n\t\t// that contains currently visible cols\n\t\tvar dataWrapper = '';\n\t\tvar cellLeftPos;\n\n\t\tvar visibleColumns = this._rendered_header_cache;\n\n\t\tfor (var ind = 0; ind < visibleColumns.length; ind++) {\n\t\t\tvar j = visibleColumns[ind];\n\n\t\t\tcellLeftPos = view._h_cols[j].left - view.dx;\n\n\t\t\tif (scheduler._ignores[j]){\n\n\t\t\t\tif (view.render == \"cell\"){\n\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell_ignores(stats);\n\t\t\t\t}else{\n\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar_ignores();\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif (view.render == \"cell\"){\n\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell(j, i, view, evs[i][j], stats, cellLeftPos);\n\t\t\t\t}else{\n\t\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar(j, i, view, evs[i], cellLeftPos);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dataWrapper;\n\t},\n\n\tgetVisibleTimelineRowsHTML: function(view, viewPort, evs, rowIndex) {\n\t\tvar dataWrapper = '';\n\t\tvar stats = scheduler._timeline_get_cur_row_stats(view, rowIndex);\n\t\tstats = scheduler._timeline_get_fit_events_stats(view, rowIndex, stats);\n\n\t\tvar cachedRow = view._label_rows[rowIndex];\n\n\t\tvar template = scheduler.templates[view.name + \"_row_class\"];\n\t\tvar templateParams = { view: view, section: cachedRow.section, template: template};\n\t\t// check vertical direction\n\t\tif (view.render == \"cell\") {\n\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell_data_row(rowIndex, stats, cachedRow.top, cachedRow.section.key, templateParams);\n\t\t\tdataWrapper += this.getVisibleRowCellsHTML(view, viewPort, stats, evs, rowIndex);\n\t\t\tdataWrapper += '</div>';\n\t\t} else {\n\t\t\t//section 2\n\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar_matrix_line(rowIndex, stats, cachedRow.top, cachedRow.section.key, templateParams);\n\n\t\t\t// section 3\n\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar_data_row(stats, templateParams);\n\t\t\tdataWrapper += this.getVisibleRowCellsHTML(view, viewPort, stats, evs, rowIndex);\n\t\t\tdataWrapper += \"</div></div>\";\n\t\t}\n\n\t\treturn dataWrapper;\n\t},\n\n\tupdateGridRows: function(view, viewPort) {\n\t\tif (this._rows_to_delete.length) {\n\t\t\tthis._deleteGridRows(this._rows_to_delete, view);\n\t\t}\n\t\tif (this._rows_to_add.length) {\n\t\t\tthis._addGridRows(this._rows_to_add, view, viewPort);\n\t\t}\n\n\n\t},\n\n\t_deleteGridRows: function(items, view) {\n\t\tvar parent = scheduler.$container.querySelector('.dhx_cal_data .dhx_timeline_data_col');\n\t\tif (!parent) return;\n\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tconst sectionId = view.y_unit[items[i]] ? view.y_unit[items[i]].key : null;\n\t\t\tif(view._divBySectionId[sectionId]){\n\t\t\t\tview._divBySectionId[sectionId].remove();\n\t\t\t\tdelete view._divBySectionId[sectionId];\n\t\t\t}\n\t\t\t//var item = parent.querySelector('[data-section-index=\"'+(items[i])+'\"]');\n\t\t\t//parent.removeChild(item);\n\t\t}\n\n\t\tthis._rows_to_delete = [];\n\t},\n\n\t_addGridRows: function(items, view, viewPort) {\n\t\tvar parent = scheduler.$container.querySelector('.dhx_cal_data .dhx_timeline_data_col');\n\t\tif (!parent) return;\n\n\t\tvar evs = this.getPreparedEvents(view);\n\n\t\tvar html = '';\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\thtml += this.getVisibleTimelineRowsHTML(view, viewPort, evs, items[i]);\n\n\t\t}\n\t\tconst buffer = document.createElement('template');\n\t\tbuffer.innerHTML = html;\n\t\tparent.appendChild(buffer.content);\n\n\t\t//view._divBySectionId[items[i]].remove();\n\t\t//delete view._divBySectionId[items[i]];\n\t\tvar parent = scheduler.$container.querySelector('.dhx_cal_data .dhx_timeline_data_col');\n\t\tview._divBySectionId = {};\n\t\tfor(let i = 0, len = parent.children.length; i < len; i++){\n\t\t\tvar child = parent.children[i];\n\t\t\tif(child.hasAttribute(\"data-section-id\")){\n\t\t\t\tview._divBySectionId[child.getAttribute(\"data-section-id\")] = child;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\tconst sectionId = view.y_unit[items[i]] ? view.y_unit[items[i]].key : null;\n\t\t\tscheduler._timeline_finalize_section_add(view, view.y_unit[items[i]].key, view._divBySectionId[sectionId]);\n\t\t}\n\t\tif (scheduler._mark_now) {\n\t\t\tscheduler._mark_now();\n\t\t}\n\t\tthis._rows_to_add = [];\n\t},\n\n\tupdateGridCols: function(view, viewPort) {\n\t\tvar visibleHeaderColumns = this._rendered_header_cache;\n\n\t\tvar visibleHeaderColumnsHash = {};\n\t\tfor(var i = 0; i < visibleHeaderColumns.length; i++){\n\t\t\tvisibleHeaderColumnsHash[visibleHeaderColumns[i]] = true;\n\t\t}\n\n\t\tconst allRows = scheduler.$container.querySelectorAll(\".dhx_timeline_data_row\");\n\t\tallRows.forEach((function(row){\n\t\t\tconst allCells = row.querySelectorAll(\"[data-col-id]\");\n\n\t\t\tconst renderedCells = Array.prototype.reduce.call(allCells, function(hash, cell){\n\t\t\t\thash[cell.dataset.colId] = cell;\n\t\t\t\treturn hash;\n\t\t\t}, {});\n\n\t\t\tvar shouldDelete = [],\n\t\t\tshouldRender = [];\n\t\t\tfor(var i in renderedCells){\n\t\t\t\tif(!visibleHeaderColumnsHash[i]){\n\t\t\t\t\tshouldDelete.push(renderedCells[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(var i in visibleHeaderColumnsHash){\n\t\t\t\tif(!renderedCells[i]){\n\t\t\t\t\tshouldRender.push(i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tshouldDelete.forEach(function(cell){\n\t\t\t\tcell.remove();\n\t\t\t});\n\t\t\tif(shouldRender.length){\n\t\t\t\tthis._addGridCols(row, shouldRender, view, viewPort);\n\t\t\t}\n\t\t\t\t\n\t\t\t\n\t\t}).bind(this));\n\t},\n\n\t_addGridCols: function(row, items, view, viewPort) {\n\t\tvar grid = scheduler.$container.querySelector('.dhx_cal_data .dhx_timeline_data_col');\n\t\tif (!grid) return;\n\n\t\tvar evs = this.getPreparedEvents(view);\n\n\t\tconst sectionId = row.closest(\"[data-section-id]\").getAttribute(\"data-section-id\");\n\t\tconst sectionIndex = view.order[sectionId];\n\t\tvar html = '';\n\t\tvar stats = scheduler._timeline_get_cur_row_stats(view, sectionIndex);\n\t\tstats = scheduler._timeline_get_fit_events_stats(view, sectionIndex, stats);\n\n\t\tvar parent = row;\n\n\n\t\tif (parent) {\n\t\t\tfor (var j = 0; j < items.length; j++) {\n\t\t\t\tvar item = parent.querySelector('[data-col-id=\"'+items[j]+'\"]');\n\n\t\t\t\tif (!item) {\n\t\t\t\t\tvar cell = this.getVisibleGridCell(view, viewPort, stats, evs, sectionIndex, items[j]);\n\t\t\t\t\tif (cell)\n\t\t\t\t\t\thtml += cell;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst buffer = document.createElement('template');\n\t\t\tbuffer.innerHTML = html;\n\t\t\tparent.appendChild(buffer.content);\n\t\t}\n\n\t\t//this._cols_to_add = [];\n\t},\n\n\tgetVisibleGridCell: function(view, viewPort, stats, evs, rowIndex, cellIndex) {\n\t\tif (!view._h_cols[cellIndex]) return;\n\t\tvar dataWrapper = '';\n\t\tvar cellLeftPos = view._h_cols[cellIndex].left-view.dx;\n\n\t\tif (view.render == \"cell\") {\n\t\t\tif (scheduler._ignores[cellIndex]){\n\t\t\t\t//dataWrapper += scheduler._timeline_get_html_for_cell_ignores(stats);\n\t\t\t}else {\n\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_cell(cellIndex, rowIndex, view, evs[rowIndex][cellIndex], stats, cellLeftPos);\n\t\t\t}\n\t\t} else {\n\t\t\tif (scheduler._ignores[cellIndex]){\n\t\t\t\t//dataWrapper += scheduler._timeline_get_html_for_bar_ignores();\n\t\t\t}else {\n\t\t\t\tdataWrapper += scheduler._timeline_get_html_for_bar(cellIndex, rowIndex, view, evs[rowIndex], cellLeftPos);\n\t\t\t}\n\t\t}\n\n\t\treturn dataWrapper;\n\t}\n};\n\nscheduler.attachEvent(\"onClearAll\", function(){\n\tscheduler._timeline_smart_render._prepared_events_cache = null;\n\tscheduler._timeline_smart_render._rendered_events_cache = [];\n});\nscheduler.attachEvent(\"onBeforeLightbox\", function(){\n\tscheduler._timeline_smart_render.clearPreparedEventsCache();\n\treturn true;\n});\n\n/* timeline smart render end */\n\n}","import { TooltipManager } from \"./tooltipManager\";\n\nexport default function (scheduler: any) {\n\n\tscheduler.config.tooltip_timeout = 30;\n\tscheduler.config.tooltip_offset_y = 20;\n\tscheduler.config.tooltip_offset_x = 10;\n\tscheduler.config.tooltip_hide_timeout = 30;\n\n\tconst tooltipManager = new TooltipManager(scheduler);\n\n\tscheduler.ext.tooltips = tooltipManager;\n\n\tscheduler.attachEvent(\"onSchedulerReady\", function () {\n\n\t\ttooltipManager.tooltipFor({\n\t\t\tselector: \"[\" + scheduler.config.event_attribute + \"]\",\n\t\t\thtml: (event: MouseEvent) => {\n\t\t\t\tif (scheduler._mobile && !scheduler.config.touch_tooltip) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst targetEventId = scheduler._locate_event(event.target);\n\t\t\t\tif (scheduler.getEvent(targetEventId)) {\n\t\t\t\t\tconst event = scheduler.getEvent(targetEventId);\n\t\t\t\t\treturn scheduler.templates.tooltip_text(event.start_date, event.end_date, event);\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tglobal: false\n\t\t});\n\t});\n\n\tscheduler.attachEvent(\"onDestroy\", function () {\n\t\ttooltipManager.destructor();\n\t});\n\n\tscheduler.attachEvent(\"onLightbox\", function () {\n\t\ttooltipManager.hideTooltip();\n\t});\n\n\tscheduler.attachEvent(\"onBeforeDrag\", function() {\n\t\t// GS-2377: don't hide tooltip on mobile device when ontouchstart event occurs\n\t\tif (scheduler._mobile && scheduler.config.touch_tooltip) {\n\t\t\treturn true;\n\t\t}\n\t\ttooltipManager.hideTooltip();\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventDeleted\", function() {\n\t\ttooltipManager.hideTooltip();\n\t\treturn true;\n\t});\n\n}","export default function(scheduler){\n\nscheduler.attachEvent(\"onTimelineCreated\", function (obj){\n\n\tif(obj.render == \"tree\") {\n\t\tobj.y_unit_original = obj.y_unit;\n\t\tobj.y_unit = scheduler._getArrayToDisplay(obj.y_unit_original);\n\n        scheduler.attachEvent('onOptionsLoadStart', function(){\n            obj.y_unit = scheduler._getArrayToDisplay(obj.y_unit_original);\n        });\n\n\t\tscheduler.form_blocks[obj.name]={\n\t\t\trender:function(sns) {\n\t\t\t\tvar _result = \"<div class='dhx_section_timeline' style='overflow: hidden;'></div>\";\n\t\t\t\treturn _result;\n\t\t\t},\n\t\t\tset_value:function(node,value,ev,config){\n\t\t\t\tvar options = scheduler._getArrayForSelect(scheduler.matrix[config.type].y_unit_original, config.type);\n\t\t\t\tnode.innerHTML = '';\n\t\t\t\tvar temp_select = document.createElement('select');\n\t\t\t\tnode.appendChild(temp_select);\n\n\t\t\t\tvar select = node.getElementsByTagName('select')[0];\n\n\t\t\t\tif (!select._dhx_onchange && config.onchange) {\n\t\t\t\t\tselect.addEventListener('change', config.onchange);\n\t\t\t\t\tselect._dhx_onchange = true;\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\t\t\tvar temp_option = document.createElement('option');\n\t\t\t\t\ttemp_option.value = options[i].key;\n\t\t\t\t\tif(temp_option.value == ev[scheduler.matrix[config.type].y_property])\n\t\t\t\t\t\ttemp_option.selected = true;\n\t\t\t\t\ttemp_option.innerHTML = options[i].label;\n\t\t\t\t\tselect.appendChild(temp_option);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_value:function(node,ev,config){\n\t\t\t\treturn node.firstChild.value;\n\t\t\t},\n\t\t\tfocus:function(node){\n\t\t\t}\n\t\t};\n\n\n\t}\n});\n\nscheduler.attachEvent(\"onBeforeSectionRender\", function (render_name, y_unit, timeline){\n\tlet res = {};\n\tif(render_name == \"tree\"){\n\t\tlet height;\n\t\t// section 1\n\t\tlet tr_className, style_height, td_className;\n\t\tlet div_expand;\n\t\t// section 3\n\t\tlet table_className;\n\n\t\ttd_className = \"dhx_matrix_scell dhx_treetimeline\";\n\t\tif(y_unit.children) {\n\t\t\theight = timeline.folder_dy||timeline.dy;\n\t\t\tif(timeline.folder_dy && !timeline.section_autoheight) {\n\t\t\t\tstyle_height = \"height:\"+timeline.folder_dy+\"px;\";\n\t\t\t}\n\t\t\ttr_className = \"dhx_row_folder\";\n\t\t\ttd_className += \" folder\";\n\t\t\tif(y_unit.open){\n\t\t\t\ttd_className += \" opened\";\n\t\t\t}else{\n\t\t\t\ttd_className += \" closed\";\n\t\t\t}\n\t\t\tdiv_expand = \"<div class='dhx_scell_expand'></div>\";\n\t\t\ttable_className = (timeline.folder_events_available)?\"dhx_data_table folder_events\":\"dhx_data_table folder\";\n\t\t} else {\n\t\t\theight = timeline.dy;\n\t\t\ttr_className = \"dhx_row_item\";\n\t\t\ttd_className += \" item\";\n\t\t\tdiv_expand = '';\n\t\t\ttable_className = \"dhx_data_table\";\n\t\t}\n\t\t\n\t\tif(timeline.columns){\n\t\t\ttd_className += \" dhx_matrix_scell_columns\";\n\t\t}\n\n\t\ttd_className += (scheduler.templates[timeline.name+\"_scaley_class\"](y_unit.key, y_unit.label, y_unit) ?\n\t\t\t\" \"+scheduler.templates[timeline.name+\"_scaley_class\"](y_unit.key, y_unit.label, y_unit) : '');\n\n\t\tlet td_content;\n\t\tlet paddingValue;\n\t\tconst levelPadding = `var(--dhx-scheduler-treetimeline-level-padding) * ${y_unit.level}`;\n\n\t\tif(y_unit.level < 2){\n\t\t\tpaddingValue = `calc(${levelPadding} + 4px)`;\n\t\t} else {\n\t\t\tpaddingValue = `calc(${levelPadding})`;\n\t\t}\n\t\tconst padding = `style='--dhx-scheduler-treetimeline-level-padding-value: ${paddingValue}'`;\n\n\t\tif(timeline.columns && timeline.columns.length){\n\t\t\ttd_content  = `<div class='dhx_scell_name'><div class='dhx_scell_level' ${padding}>${div_expand}</div>${(scheduler.templates[timeline.name+'_scale_label'](y_unit.key, y_unit.label, y_unit)||y_unit.label)}</div>`;\n\t\t}else{\n\t\t\ttd_content = `<div class='dhx_scell_level' ${padding}>${div_expand}<div class='dhx_scell_name'>${(scheduler.templates[timeline.name+'_scale_label'](y_unit.key, y_unit.label, y_unit)||y_unit.label)}</div></div>`;\n\t\t}\n\t\n\t\tres = {\n\t\t\theight: height,\n\t\t\tstyle_height: style_height,\n\t\t\t//section 1\n\t\t\ttr_className: tr_className,\n\t\t\ttd_className: td_className,\n\t\t\ttd_content: td_content,\n\t\t\t//section 3\n\t\t\ttable_className: table_className\n\t\t};\n\t}\n\treturn res;\n});\n\nvar section_id_before; // section id of the event before dragging (to bring it back if user drop's event on folder without folder_events_available)\n\nscheduler.attachEvent(\"onBeforeEventChanged\", function(event_object, native_event, is_new) {\n\tif (scheduler._isRender(\"tree\")) { // if mode's render == tree\n\n\t\tvar ev_sections = scheduler._get_event_sections ? scheduler._get_event_sections(event_object) : [event_object[scheduler.matrix[scheduler._mode].y_property]];\n\t\tfor(var i = 0; i < ev_sections.length; i++){\n\t\t\tvar section = scheduler.getSection(ev_sections[i]);\n\t\t\tif (section && !!section.children && !scheduler.matrix[scheduler._mode].folder_events_available) { // section itself could be not defined in case of new event (addEventNow)\n\t\t\t\tif (!is_new) { //if old - move back\n\t\t\t\t\tevent_object[scheduler.matrix[scheduler._mode].y_property] = section_id_before;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n});\n\nscheduler.attachEvent(\"onBeforeDrag\", function (event_id, mode, native_event_object){\n\tif(scheduler._isRender(\"tree\")) {\n\t\tvar cell = scheduler._locate_cell_timeline(native_event_object);\n\t\tvar section_id;\n\t\tif(cell) {\n\t\t\tsection_id = scheduler.matrix[scheduler._mode].y_unit[cell.y].key;\n\t\t\tif(!!scheduler.matrix[scheduler._mode].y_unit[cell.y].children && !scheduler.matrix[scheduler._mode].folder_events_available) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tvar ev = scheduler.getEvent(event_id);\n\t\tvar property = scheduler.matrix[scheduler._mode].y_property;\n\n\t\tsection_id_before = (ev && ev[property]) ? ev[property] : section_id; // either event id or section_id will be available\n\t}\n\treturn true;\n});\n\nscheduler._getArrayToDisplay = function(array){ // function to flatten out hierarhical array, used for tree view\n\tvar result = [];\n\tvar fillResultArray = function(array, lvl, parent, skip){\n\t\tvar level = lvl||0;\n\t\tfor (var i = 0; i < array.length; i++) {\n\t\t\tvar node = array[i];\n\t\t\tnode.level = level;\n\t\t\tnode.$parent = parent || null;\n\t\t\tif (!!node.children && typeof node.key == \"undefined\") {\n\t\t\t\tnode.key = scheduler.uid();\n\t\t\t}\n\n\t\t\tif (!skip) {\n\t\t\t\tresult.push(node);\n\t\t\t}\n\n\t\t\tif(node.children) {\n\t\t\t\tfillResultArray(node.children, level+1, node.key, skip || !node.open);\n\t\t\t}\n\t\t}\n\t};\n\tfillResultArray(array);\n\treturn result;\n};\n\n\nscheduler._getArrayForSelect = function(array, mode){ // function to flatten out hierarhical array, used for tree view\n\tvar result = [];\n\tvar fillResultArray = function(array){\n\t\tfor(var i=0; i<array.length; i++) {\n\t\t\tif(scheduler.matrix[mode].folder_events_available) {\n\t\t\t\tresult.push(array[i]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(!array[i].children) {\n\t\t\t\t\tresult.push(array[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(array[i].children)\n\t\t\t\tfillResultArray(array[i].children, mode);\n\t\t}\n\t};\n\tfillResultArray(array);\n\treturn result;\n};\n\n\n/*\n scheduler._toggleFolderDisplay(4) -- toggle display of the section with key 4 (closed -> open)\n scheduler._toggleFolderDisplay(4, true) -- open section with the key 4 (doesn't matter what status was before). False - close.\n scheduler._toggleFolderDisplay(4, false, true) -- close ALL sections. Key is not used in such condition.\n */\nscheduler._toggleFolderDisplay = function(key, status, all_sections){ // used for tree view\n\tvar marked;\n\tvar toggleElement = function(key, array, status, all_sections) {\n\t\tfor (var i=0; i<array.length; i++) {\n\t\t\tif((array[i].key == key || all_sections) && array[i].children) {\n\t\t\t\tarray[i].open = (typeof status != \"undefined\") ? status : !array[i].open;\n\t\t\t\tmarked = true;\n\t\t\t\tif(!all_sections && marked)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(array[i].children) {\n\t\t\t\ttoggleElement(key,array[i].children, status, all_sections);\n\t\t\t}\n\t\t}\n\t};\n\tvar section = scheduler.getSection(key);\n\n\tif((typeof status == \"undefined\") && !all_sections){\n\t\t//toggle\n\t\tstatus = !section.open;\n\t}\n\tif (scheduler.callEvent(\"onBeforeFolderToggle\", [section, status, all_sections])) {\n\t\ttoggleElement(key,scheduler.matrix[scheduler._mode].y_unit_original, status, all_sections);\n\t\tscheduler.matrix[scheduler._mode].y_unit = scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original);\n\t\tscheduler.callEvent(\"onOptionsLoad\",[]);\n\t\tscheduler.callEvent(\"onAfterFolderToggle\", [section, status, all_sections]);\n\t}\n};\n\nscheduler.attachEvent(\"onCellClick\", function (x, y, a, b, event){\n\tif(scheduler._isRender(\"tree\")) {\n\t\tif(!scheduler.matrix[scheduler._mode].folder_events_available) {\n\t\t\tif(typeof scheduler.matrix[scheduler._mode].y_unit[y] != \"undefined\" &&\n\t\t\t\t!!scheduler.matrix[scheduler._mode].y_unit[y].children) {\n\t\t\t\tscheduler._toggleFolderDisplay(scheduler.matrix[scheduler._mode].y_unit[y].key);\n\t\t\t}\n\t\t}\n\t}\n});\n\nscheduler.attachEvent(\"onYScaleClick\", function (index, value, event){\n\tif(scheduler._isRender(\"tree\")) {\n\t\tif(!!value.children) {\n\t\t\tscheduler._toggleFolderDisplay(value.key);\n\t\t}\n\t}\n});\n\nscheduler.getSection = function(id){\n\tif(scheduler._isRender(\"tree\")) {\n\t\tvar obj;\n\t\tvar findElement = function(key, array) {\n\t\t\tfor (var i=0; i<array.length; i++) {\n\t\t\t\tif(array[i].key == key)\n\t\t\t\t\tobj = array[i];\n\t\t\t\tif(array[i].children)\n\t\t\t\t\tfindElement(key,array[i].children);\n\t\t\t}\n\t\t};\n\t\tfindElement(id, scheduler.matrix[scheduler._mode].y_unit_original);\n\t\treturn obj||null;\n\t}\n};\n\nscheduler.deleteSection = function(id){\n\tif(scheduler._isRender(\"tree\")) {\n\t\tvar result = false;\n\t\tvar deleteElement = function(key, array) {\n\t\t\tfor (var i=0; i<array.length; i++) {\n\t\t\t\tif(array[i].key == key) {\n\t\t\t\t\tarray.splice(i,1);\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t\tif(result)\n\t\t\t\t\tbreak;\n\t\t\t\tif(array[i].children)\n\t\t\t\t\tdeleteElement(key,array[i].children);\n\t\t\t}\n\t\t};\n\t\tdeleteElement(id, scheduler.matrix[scheduler._mode].y_unit_original);\n\t\tscheduler.matrix[scheduler._mode].y_unit = scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original);\n\t\tscheduler.callEvent(\"onOptionsLoad\",[]);\n\t\treturn result;\n\t}\n};\n\nscheduler.deleteAllSections = function(){\n    if(scheduler._isRender(\"tree\")) {\n        scheduler.matrix[scheduler._mode].y_unit_original = [];\n        scheduler.matrix[scheduler._mode].y_unit = scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original);\n        scheduler.callEvent(\"onOptionsLoad\",[]);\n    }\n};\n\nscheduler.addSection = function(obj, parent_id){\n\tif(scheduler._isRender(\"tree\")) {\n\t\tvar result = false;\n\t\tvar addElement = function(obj, parent_key, array) {\n\t\t\tif(!parent_id) {\n\t\t\t\tarray.push(obj);\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (var i=0; i<array.length; i++) {\n\t\t\t\t\tif(array[i].key == parent_key && !!array[i].children) {\n\t\t\t\t\t\tarray[i].children.push(obj);\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(result)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tif(array[i].children)\n\t\t\t\t\t\taddElement(obj,parent_key,array[i].children);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\taddElement(obj, parent_id, scheduler.matrix[scheduler._mode].y_unit_original);\n\t\tscheduler.matrix[scheduler._mode].y_unit = scheduler._getArrayToDisplay(scheduler.matrix[scheduler._mode].y_unit_original);\n\t\tscheduler.callEvent(\"onOptionsLoad\",[]);\n\t\treturn result;\n\t}\n};\n\n\nscheduler.openAllSections = function() {\n\tif(scheduler._isRender(\"tree\"))\n\t\tscheduler._toggleFolderDisplay(1, true, true);\n};\nscheduler.closeAllSections = function() {\n\tif(scheduler._isRender(\"tree\"))\n\t\tscheduler._toggleFolderDisplay(1, false, true);\n};\nscheduler.openSection = function(section_id){\n\tif(scheduler._isRender(\"tree\"))\n\t\tscheduler._toggleFolderDisplay(section_id, true);\n};\nscheduler.closeSection = function(section_id){\n\tif(scheduler._isRender(\"tree\"))\n\t\tscheduler._toggleFolderDisplay(section_id, false);\n};\n\n}","export default function(scheduler){\n\nscheduler._props = {};\nscheduler.createUnitsView=function(name,property,list,size,step,skip_incorrect, days){\n\tif (typeof name == \"object\"){\n\t\tlist = name.list;\n\t\tproperty = name.property;\n\t\tsize = name.size||0;\n\t\tstep = name.step||1;\n\t\tskip_incorrect = name.skip_incorrect;\n\t\tdays = name.days || 1;\n\t\tname = name.name;\n\t}\n\n\tscheduler._props[name]={map_to:property, options:list, step:step, position:0, days: days, layout:\"units\"};\n    if(size>scheduler._props[name].options.length){\n        scheduler._props[name]._original_size = size;\n        size = 0;\n    }\n    scheduler._props[name].size = size;\n\tscheduler._props[name].skip_incorrect = skip_incorrect||false;\n\n\tscheduler.date[name+\"_start\"]= scheduler.date.day_start;\n\tscheduler.templates[name+\"_date\"] = function(date, end_date){\n\t\tvar pr = scheduler._props[name];\n\t\tif(!(pr.days > 1)){\n\t\t\treturn scheduler.templates.day_date(date);\n\t\t}else{\n\t\t\treturn scheduler.templates.week_date(date, end_date);\n\t\t}\n\t};\n\n\tfunction getDateIndex(date) {\n\t\treturn Math.round((scheduler._correct_shift(+date, 1) - +scheduler._min_date) / (60 * 60 * 24 * 1000));\n\t}\n\n\tscheduler._get_unit_index = function(unit_view, date) {\n\t\tvar original_position = unit_view.position || 0;\n\t\tvar date_position = getDateIndex(date);\n\n\t\tvar l = unit_view.size || unit_view.options.length;\n\t\tif(date_position >= l) {\n\t\t\tdate_position = date_position % l;\n\t\t}\n\n\t\treturn original_position + date_position;\n\t};\n\tscheduler.templates[name + \"_scale_text\"] = function(id, label, option) {\n\t\tif (option.css) {\n\t\t\treturn \"<span class='\" + option.css + \"'>\" + label + \"</span>\";\n\t\t} else {\n\t\t\treturn label;\n\t\t}\n\t};\n\tscheduler.templates[name+\"_scale_date\"] = function(date) {\n\t\tvar unit_view = scheduler._props[name];\n\t\tvar list = unit_view.options;\n\t\tif (!list.length) return \"\";\n\t\tvar index = scheduler._get_unit_index(unit_view, date);\n\t\tvar option = list[index];\n\n\t\tvar dateIndex = getDateIndex(date);\n\t\tvar length = unit_view.size || unit_view.options.length;\n\t\tvar realDate = scheduler.date.add(scheduler.getState().min_date, Math.floor(dateIndex / length), \"day\");\n\n\t\treturn scheduler.templates[name + \"_scale_text\"](option.key, option.label, option, realDate);\n\t};\n\tscheduler.templates[name+\"_second_scale_date\"] = function(date) {\n\t\treturn scheduler.templates.week_scale_date(date);\n\t};\n\n\tscheduler.date[\"add_\"+name]=function(date,inc){\n\t\treturn scheduler.date.add(date,inc * scheduler._props[name].days,\"day\");\n\t};\n\tscheduler.date[\"get_\"+name+\"_end\"]=function(date){\n\t\tconst unit_view = scheduler._props[name];\n\t\tconst availSize = unit_view.size || unit_view.options.length;\n\t\tconst length = Math.min(availSize, unit_view.options.length);\n\t\treturn scheduler.date.add(date, length * scheduler._props[name].days, \"day\");\n\t};\n\n\tscheduler.attachEvent(\"onOptionsLoad\",function(){\n        var pr = scheduler._props[name];\n\t\tvar order = pr.order = {};\n\t\tvar list = pr.options;\n\t\tfor(var i=0; i<list.length;i++)\n\t\t\torder[list[i].key]=i;\n        if(pr._original_size && pr.size===0){\n            pr.size = pr._original_size;\n            delete pr._original_size;\n        }\n\t\tif(pr.size > list.length) {\n            pr._original_size = pr.size;\n            pr.position = 0;\n            pr.size = 0;\n        }\n        else\n            pr.size = pr._original_size||pr.size;\n\t\tif (scheduler._date && scheduler._mode == name)\n\t\t\tscheduler.setCurrentView(scheduler._date, scheduler._mode);\n\t});\n\n\tscheduler[\"mouse_\"+ name] = function(pos){ //mouse_coord handler\n\t\tvar pr = scheduler._props[this._mode];\n\n\t\tif (pr){\n\t\t\tpos = this._week_indexes_from_pos(pos);\n\t\t\tif(!this._drag_event) this._drag_event = {};\n\n\t\t\tif (this._drag_id && this._drag_mode){\n\t\t\t\tthis._drag_event._dhx_changed = true;\n\t\t\t}\n\n\n\t\t\tif(this._drag_mode && this._drag_mode == \"new-size\"){\n\t\t\t\tvar sday = scheduler._get_event_sday(scheduler._events[scheduler._drag_id]);\n\t\t\t\tif(Math.floor(pos.x / pr.options.length) != Math.floor(sday / pr.options.length))\n\t\t\t\t\tpos.x = sday;\n\t\t\t}\n\n\t\t\tvar size = (pr.size || pr.options.length);\n\t\t\tvar section_ind = pos.x % size;\n\t\t\tvar unit_ind = Math.min(section_ind+pr.position,pr.options.length-1);\n\n\t\t\tpos.section = (pr.options[unit_ind]||{}).key;\n\t\t\tpos.x = Math.floor(pos.x / size);\n\n\t\t\tvar ev = this.getEvent(this._drag_id);\n\t\t\tthis._update_unit_section({view:pr, event:ev, pos:pos});\n\t\t}\n\t\tpos.force_redraw = true;\n\n\t\treturn pos;\n\t};\n\n\tvar headerResized = false;\n\n\tfunction setHeaderSize(){\n\t\tif(!headerResized){\n\t\t\theaderResized = scheduler.xy.scale_height;\n\t\t\tscheduler.xy.scale_height = scheduler.xy.scale_height * 2;\n\t\t}\n\t}\n\tfunction revertHeaderSize(){\n\t\tif(headerResized){\n\t\t\tscheduler.xy.scale_height /= 2;\n\t\t\theaderResized = false;\n\t\t}\n\t}\n\n\tscheduler[name + \"_view\"] = function(enable){\n\t\tvar pr = scheduler._props[scheduler._mode];\n\t\tif(enable){\n\t\t\tif (pr && pr.days > 1){\n\t\t\t\tsetHeaderSize();\n\t\t\t}else{\n\t\t\t\trevertHeaderSize();\n\t\t\t}\n\t\t\tscheduler._reset_scale();\n\t\t}else{\n\t\t\trevertHeaderSize();\n\t\t}\n\t};\n\n\tscheduler.callEvent(\"onOptionsLoad\",[]);\n};\n\nscheduler._update_unit_section = function(action){\n\tvar view = action.view,\n\t\tevent = action.event,\n\t\tpos = action.pos;\n\tif(event) {\n\t\tevent[view.map_to] = pos.section;\n\t}\n};\n\nscheduler.scrollUnit=function(step){\n\tvar pr = scheduler._props[this._mode];\n\tif (pr){\n\t\tpr.position=Math.min(Math.max(0,pr.position+step),pr.options.length-pr.size);\n\t\tthis.setCurrentView();\n\t}\n};\n(function(){\n\tvar _removeIncorrectEvents = function(evs) {\n\t\tvar pr = scheduler._props[scheduler._mode];\n\t\tif(pr && pr.order && pr.skip_incorrect) {\n            var correct_events = [];\n\t\t\tfor(var i=0; i<evs.length; i++) {\n\t\t\t\tif(typeof pr.order[evs[i][pr.map_to]] != \"undefined\") {\n                    correct_events.push(evs[i]);\n\t\t\t\t}\n\t\t\t}\n            evs.splice(0,evs.length);\n\t\t\tevs.push.apply(evs,correct_events);\n\t\t}\n\t\treturn evs;\n\t};\n\tvar old_pre_render_events_table = scheduler._pre_render_events_table;\n\tscheduler._pre_render_events_table=function(evs,hold) {\n\t\tevs = _removeIncorrectEvents(evs);\n\t\treturn old_pre_render_events_table.apply(this, [evs, hold]);\n\t};\n\tvar old_pre_render_events_line = scheduler._pre_render_events_line;\n\tscheduler._pre_render_events_line = function(evs,hold){\n\t\tevs = _removeIncorrectEvents(evs);\n\t\treturn old_pre_render_events_line.apply(this, [evs, hold]);\n\t};\n\tvar fix_und=function(pr,ev){\n\t\tif (pr && typeof pr.order[ev[pr.map_to]] == \"undefined\"){\n\t\t\tif(pr.options.length)\n\t\t\t\tev[pr.map_to] = pr.options[0].key;\n\t\t\treturn true;\n\t\t}\n\t};\n\n\n\tvar oldive = scheduler.is_visible_events;\n\tscheduler.is_visible_events = function(e){\n\t\tvar res = oldive.apply(this,arguments);\n\t\tif (res){\n\t\t\tvar pr = scheduler._props[this._mode];\n\t\t\tif (pr && pr.size){\n\t\t\t\tvar val = pr.order[e[pr.map_to]];\n\t\t\t\tif (val < pr.position || val >= pr.size+pr.position )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\tvar old_process_ignores = scheduler._process_ignores;\n\n\tscheduler._process_ignores = function(sd, n, mode, step, preserve){\n\t\tif(!scheduler._props[this._mode]){\n\t\t\told_process_ignores.call(this, sd, n, mode, step, preserve);\n\t\t\treturn;\n\t\t}\n\t\tthis._ignores={};\n\t\tthis._ignores_detected = 0;\n\t\tvar ignore = scheduler[\"ignore_\"+this._mode];\n\n\t\tif (ignore){\n\t\t\tvar sectionsCount = (scheduler._props && scheduler._props[this._mode] ?\n\t\t\t\t(scheduler._props[this._mode].size||scheduler._props[this._mode].options.length) : 1);\n\t\t\tn /= sectionsCount;\n\n\t\t\tvar ign_date = new Date(sd);\n\t\t\tfor (var i=0; i<n; i++){\n\t\t\t\tif (ignore(ign_date)){\n\t\t\t\t\tvar sectionStart = i * sectionsCount,\n\t\t\t\t\t\tsectionEnd = (i + 1) * sectionsCount;\n\n\t\t\t\t\tfor(var j = sectionStart; j < sectionEnd; j++) {\n\t\t\t\t\t\tthis._ignores_detected += 1;\n\t\t\t\t\t\tthis._ignores[j] = true;\n\t\t\t\t\t\tif (preserve)\n\t\t\t\t\t\t\tn++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tign_date = scheduler.date.add(ign_date, step, mode);\n\t\t\t\tif(scheduler.date[mode + '_start'])\n\t\t\t\t\tign_date = scheduler.date[mode + '_start'](ign_date);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tvar t = scheduler._reset_scale;\n\tscheduler._reset_scale = function(){\n\t\tvar pr = scheduler._props[this._mode];\n\n\t\tif(pr){\n\t\t\t// section scroll in units view, check scroll boundaries\n\t\t\tif(pr.size && pr.position && pr.size + pr.position > pr.options.length){\n\t\t\t\tpr.position = Math.max(0, pr.options.length - pr.size);\n\t\t\t}else if(!pr.size){\n\t\t\t\tpr.position = 0;\n\t\t\t}\n\t\t\t//GS-2795: size can't be more than options length\n\t\t\tif(pr.size && pr.size > pr.options.length){\n\t\t\t\tpr.size = pr.options.length;\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar ret = t.apply(this,arguments);\n\t\tif (pr){\n\n\t\t\tthis._max_date = this.date.add(this._min_date,pr.days,\"day\");\n\n\t\t\tvar d = this._els[\"dhx_cal_data\"][0].childNodes;\n\t\t\tfor (var i=0; i < d.length; i++)\n\t\t\t\td[i].classList.remove(\"dhx_scale_holder_now\"); \n\n\t\t\t// set background for current date\n\t\t\tvar today = this._currentDate();\n\t\t\tif(today.valueOf() >= this._min_date && today.valueOf() < this._max_date) {\n\t\t\t\tvar dx = 24*60*60*1000;\n\t\t\t\tvar ind = Math.floor((today - scheduler._min_date)/dx);\n\t\t\t\tvar units_l = pr.size || pr.options.length;\n\t\t\t\tvar today_start = ind*units_l;\n\t\t\t\tvar today_end = today_start + units_l;\n\t\t\t\tfor (i=today_start; i<today_end; i++){\n\t\t\t\t\tif(d[i])\n\t\t\t\t\t\td[i].classList.add(\"dhx_scale_holder_now\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (pr.size && pr.size < pr.options.length){\n\n\t\t\t\tvar h = this._els[\"dhx_cal_header\"][0];\n\t\t\t\tvar arrow = document.createElement(\"div\");\n\t\t\t\tif (pr.position){\n\n\t\t\t\t\tthis._waiAria.headerButtonsAttributes(arrow, \"\");\n\n\t\t\t\t\tif (scheduler.config.rtl) {\n\t\t\t\t\t\tarrow.className = \"dhx_cal_next_button\";\n\t\t\t\t\t\tarrow.style.cssText = \"left:auto;margin-top:-8px;right:0px;position:absolute;\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarrow.className = \"dhx_cal_prev_button\";\n\t\t\t\t\t\tarrow.style.cssText = \"left:1px;margin-top:-8px;position:absolute;\";\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\th.firstChild.appendChild(arrow);\n\t\t\t\t\tarrow.addEventListener(\"click\", function(e) {\n\t\t\t\t\t\tscheduler.scrollUnit(pr.step*-1);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (pr.position+pr.size<pr.options.length){\n\t\t\t\t\tthis._waiAria.headerButtonsAttributes(arrow, \"\");\n\n\t\t\t\t\tarrow = document.createElement(\"div\");\n\t\t\t\t\tif (scheduler.config.rtl) {\n\t\t\t\t\t\tarrow.className = \"dhx_cal_prev_button\";\n\t\t\t\t\t\tarrow.style.cssText = \"left:1px;margin-top:-8px;position:absolute;\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarrow.className = \"dhx_cal_next_button\";\n\t\t\t\t\t\tarrow.style.cssText = \"left:auto;margin-top:-8px;right:0px;position:absolute;\";\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\th.lastChild.appendChild(arrow);\n\t\t\t\t\tarrow.addEventListener(\"click\", function () {\n\t\t\t\t\t\tscheduler.scrollUnit(pr.step);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\n\t};\n\n\tvar _get_view_end = scheduler._get_view_end;\n\tscheduler._get_view_end = function(){\n\t\tvar pr = scheduler._props[this._mode];\n\t\tif(pr && pr.days > 1) {\n\t\t\tvar dd = this._get_timeunit_start();\n\t\t\treturn scheduler.date.add(dd, pr.days, \"day\");\n\t\t}else{\n\t\t\treturn _get_view_end.apply(this, arguments);\n\t\t}\n\t};\n\n\tvar xh = scheduler._render_x_header;\n\tscheduler._render_x_header = function(i, left, d, h) {\n\n\t\tvar pr = scheduler._props[this._mode];\n\t\tif(!pr || pr.days <= 1) {\n\t\t\treturn xh.apply(this, arguments);\n\t\t}else if(pr.days > 1){\n\n\t\t\tvar headerWrapper = h.querySelector(\".dhx_second_cal_header\");\n\t\t\tif(!headerWrapper){\n\t\t\t\theaderWrapper = document.createElement(\"div\");\n\t\t\t\theaderWrapper.className = \"dhx_second_cal_header\";\n\t\t\t\th.appendChild(headerWrapper);\n\t\t\t}\n\n\t\t\tvar scale_height = scheduler.xy.scale_height;\n\t\t\tscheduler.xy.scale_height = Math.ceil(scale_height / 2);\n\t\t\txh.call(this, i, left, d, headerWrapper, Math.ceil(scheduler.xy.scale_height));\n\n\t\t\tvar units_l = pr.size || pr.options.length;\n\t\t\t// second scale\n\t\t\tif( (i+1)%units_l === 0 ) {\n\t\t\t\tvar head = document.createElement(\"div\");\n\t\t\t\thead.className = \"dhx_scale_bar dhx_second_scale_bar\";\n\t\t\t\tvar date = this.date.add(this._min_date, Math.floor(i/units_l), \"day\");\n\t\t\t\tif (this.templates[this._mode + \"_second_scalex_class\"]) {\n\t\t\t\t\thead.className += ' ' + this.templates[this._mode + \"_second_scalex_class\"](new Date(date));\n\t\t\t\t}\n\t\t\t\tvar s_left,\n\t\t\t\t\ts_width = this._cols[i]*units_l;\n\t\t\t\tif(units_l > 1 && this.config.rtl) {\n\t\t\t\t\ts_left = this._colsS[i-(units_l-1)] - this.xy.scroll_width; \n\t\t\t\t} else if (units_l > 1) {\n\t\t\t\t\ts_left = this._colsS[i-(units_l-1)] - this.xy.scale_width;\n\t\t\t\t} else {\n\t\t\t\t\ts_left = left;\n\t\t\t\t}\n\n\n\t\t\t\tthis.set_xy(head, s_width, this.xy.scale_height, s_left, 0); \n\t\t\t\thead.innerHTML = this.templates[this._mode + \"_second_scale_date\"](new Date(date), this._mode); //TODO - move in separate method\n\t\t\t\theaderWrapper.appendChild(head);\n\t\t\t}\n\t\t\tscheduler.xy.scale_height = scale_height;\n\t\t}\n\t};\n\n\tvar r = scheduler._get_event_sday;\n\tscheduler._get_event_sday=function(ev){\n\t\tvar pr = scheduler._props[this._mode];\n\t\tif (pr){\n\t\t\tif(pr.days <= 1){\n\t\t\t\tfix_und(pr,ev);\n\t\t\t\treturn this._get_section_sday(ev[pr.map_to]);\n\t\t\t}else{\n\t\t\t\tvar dx = 24*60*60*1000;\n\t\t\t\tvar ind = Math.floor(((ev.end_date.valueOf()-1 - ev.end_date.getTimezoneOffset() * 60 * 1000) -// -1 for events with 00:00 end time\n\t\t\t\t\t(scheduler._min_date.valueOf() - scheduler._min_date.getTimezoneOffset() * 60 * 1000))/dx);\n\n\t\t\t\tvar units_l = pr.size || pr.options.length;\n\t\t\t\tvar section_index = pr.order[ev[pr.map_to]];\n\t\t\t\treturn ( ind * units_l + section_index ) - pr.position;\n\t\t\t}\n\n\t\t}\n\t\treturn r.call(this,ev);\n\t};\n\tscheduler._get_section_sday = function(section){\n\t\tvar pr = scheduler._props[this._mode];\n\t\treturn pr.order[section]-pr.position;\n\t};\n\n\tvar l = scheduler.locate_holder_day;\n\tscheduler.locate_holder_day=function(a,b,ev) {\n\t\tvar pr = scheduler._props[this._mode];\n\t\tif (!pr) {\n\t\t\treturn l.apply(this, arguments);\n\t\t}\n\t\tvar section;\n\t\tif (!ev) {\n\t\t\tev = {\n\t\t\t\tstart_date: a,\n\t\t\t\tend_date: a\n\t\t\t};\n\t\t\tsection = 0;\n\t\t}\n\t\telse {\n\t\t\tfix_und(pr, ev);\n\t\t}\n\t\tif (pr.days <= 1) {\n\t\t\treturn (section === undefined ? pr.order[ev[pr.map_to]] : section) * 1 + (b ? 1 : 0) - pr.position;\n\t\t} else {\n\t\t\tvar dx = 24 * 60 * 60 * 1000;\n\t\t\tvar ind = Math.floor((ev.start_date.valueOf() - scheduler._min_date.valueOf()) / dx); // -1 for events with 00:00 end time\n\t\t\tvar units_l = pr.size || pr.options.length;\n\t\t\tvar section_index = section === undefined ? pr.order[ev[pr.map_to]] : section;\n\t\t\treturn (ind * units_l + section_index * 1) + (b ? 1 : 0) - pr.position;\n\t\t}\n\t};\n\n\tvar o = scheduler._time_order;\n\tscheduler._time_order = function(evs){\n\t\tvar pr = scheduler._props[this._mode];\n\t\tif (pr){\n\t\t\tevs.sort(function(a,b){\n\t\t\t\treturn pr.order[a[pr.map_to]]>pr.order[b[pr.map_to]]?1:-1;\n\t\t\t});\n\t\t} else\n\t\t\to.apply(this,arguments);\n\t};\n\n\n\tvar prerender = scheduler._pre_render_events_table;\n\tscheduler._pre_render_events_table = function(evs, hold){\n\t\tvar pr = scheduler._props[this._mode];\n\n\t\t// split multiday event into several one-day parts\n\t\tif(pr && pr.days > 1){\n\t\t\tvar days = {};\n\t\t\tfor(var i = 0; i < evs.length; i++){\n\t\t\t\tvar ev = evs[i];\n\t\t\t\tif(!scheduler.isOneDayEvent(evs[i])){\n\n\t\t\t\t\tvar to = new Date(Math.min(+ev.end_date, +this._max_date)),\n\t\t\t\t\t\tfrom = new Date(Math.max(+ev.start_date, +this._min_date));\n\t\t\t\t\tfrom = scheduler.date.day_start(from);\n\t\t\t\t\tevs.splice(i, 1);\n\t\t\t\t\ti--;\n\n\t\t\t\t\twhile(+from < +to){\n\t\t\t\t\t\tvar chunk = this._copy_event(ev);\n\t\t\t\t\t\tchunk.start_date = from;\n\t\t\t\t\t\tchunk.end_date = getNextDay(chunk.start_date);\n\t\t\t\t\t\tfrom = scheduler.date.add(from, 1, 'day');\n\n\t\t\t\t\t\tvar date = +scheduler.date.date_part(new Date(from));\n\t\t\t\t\t\tif(!days[date])\n\t\t\t\t\t\t\tdays[date] = [];\n\t\t\t\t\t\tdays[date].push(chunk);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tvar date = +scheduler.date.date_part(new Date(ev.start_date));\n\t\t\t\t\tif(!days[date])\n\t\t\t\t\t\tdays[date] = [];\n\t\t\t\t\tdays[date].push(ev);\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tvar heights;\n\t\t\tvar evs = [];\n\t\t\tfor(var i in days){\n\t\t\t\tvar columnEvents = prerender.apply(this, [days[i], hold]);\n\t\t\t\tvar currentHeights = this._colsS.heights;\n\t\t\t\t// prerender table updates _colsS.heights array\n\t\t\t\t// which is used to define the height of multiday section\n\t\t\t\t// since columns are calculated separetely here - take maximum height value\n\t\t\t\tif(!heights || currentHeights[0] > heights[0]){\n\t\t\t\t\theights = currentHeights.slice();\n\t\t\t\t}\n\t\t\t\tevs.push.apply(evs, columnEvents);\n\t\t\t}\n\t\t\tvar schedulerHeights = this._colsS.heights;\n\t\t\tschedulerHeights.splice(0, schedulerHeights.length);\n\t\t\tschedulerHeights.push.apply(schedulerHeights, heights);\n\n\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tif (this._ignores[evs[i]._sday]) {\n\t\t\t\t\tevs.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar current = evs[i];\n\t\t\t\t\tcurrent._first_chunk = current._last_chunk = false;\n\t\t\t\t\t// _sorder can calculated for event copies, update the originals\n\t\t\t\t\tvar originalEvent = this.getEvent(current.id);\n\t\t\t\t\toriginalEvent._sorder = current._sorder;\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tevs.sort(function(a, b) {\n\t\t\t\tif (a.start_date.valueOf() == b.start_date.valueOf())\n\t\t\t\t\treturn a.id > b.id ? 1 : -1;\n\t\t\t\treturn a.start_date > b.start_date ? 1 : -1;\n\t\t\t});\n\n\t\t}else{\n\t\t\tevs = prerender.apply(this, [evs, hold]);\n\t\t}\n\n\t\tfunction getNextDay(date){\n\t\t\tvar next_day = scheduler.date.add(date, 1, \"day\");\n\t\t\tnext_day = scheduler.date.date_part(next_day);\n\t\t\treturn next_day;\n\t\t}\n\t\treturn evs;\n\t};\n\n\tscheduler.attachEvent(\"onEventAdded\",function(id,ev){\n\t\tif (this._loading) return true;\n\t\tfor (var a in scheduler._props){\n\t\t\tvar pr = scheduler._props[a];\n\t\t\tif (typeof ev[pr.map_to] == \"undefined\" && pr.options[0]) {\n\t\t\t\tev[pr.map_to] = pr.options[0].key;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\tscheduler.attachEvent(\"onEventCreated\",function(id,n_ev){\n\t\tvar pr = scheduler._props[this._mode];\n\t\tif (pr && n_ev){\n\t\t\tvar ev = this.getEvent(id);\n\t\t\tfix_und(pr,ev);\n\t\t\tvar pos = this._mouse_coords(n_ev);\n\t\t\tthis._update_unit_section({view:pr, event:ev, pos:pos});\n\n\t\t\tthis.event_updated(ev);\n\t\t}\n\t\treturn true;\n\t});\n})();\n\n\n}","export default function(scheduler){\n\nscheduler._get_url_nav = function(){\n\tvar p = {};\n\tvar data = (document.location.hash || \"\").replace(\"#\", \"\").split(\",\");\n\tfor (var i = 0; i < data.length; i++) {\n\t\tvar s = data[i].split(\"=\");\n\t\tif (s.length == 2)\n\t\t\tp[s[0]] = s[1];\n\t}\n\treturn p;\n};\n\nscheduler.attachEvent(\"onTemplatesReady\", function () {\n\tvar first = true;\n\tvar s2d = scheduler.date.str_to_date(\"%Y-%m-%d\");\n\tvar d2s = scheduler.date.date_to_str(\"%Y-%m-%d\");\n\tvar select_event =  scheduler._get_url_nav().event || null;\n\n\tscheduler.attachEvent(\"onAfterEventDisplay\", function(ev){\n\t\tselect_event = null;\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onBeforeViewChange\", function (om, od, m, d) {\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t\tvar p = scheduler._get_url_nav();\n\n\t\t\tif (p.event){\n\t\t\t\ttry{\n\t\t\t\t\tif(scheduler.getEvent(p.event)){\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tshowEvent(p.event);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar handler = scheduler.attachEvent(\"onXLE\", function(){\n\t\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\t\tshowEvent(p.event);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tscheduler.detachEvent(handler);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e){}\n\t\t\t}\n\n\t\t\tif (p.date || p.mode) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.setCurrentView((p.date ? s2d(p.date) : null), (p.mode || null));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t//assuming that mode is not available anymore\n\t\t\t\t\tthis.setCurrentView((p.date ? s2d(p.date) : null), m);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tvar values = [\n\t\t\t\"date=\" + d2s(d || od),\n\t\t\t\"mode=\" + (m || om)\n\t\t];\n\n\t\tif(select_event){\n\t\t\tvalues.push(\"event=\" + select_event);\n\t\t}\n\n\t\tvar text = \"#\" + values.join(\",\");\n\t\tdocument.location.hash = text;\n\t\treturn true;\n\t});\n\n\tfunction showEvent(e){\n\t\tif(scheduler.$destroyed){\n\t\t\treturn true;\n\t\t}\n\t\tselect_event = e;\n\t\tif(scheduler.getEvent(e)){\n\t\t\tscheduler.showEvent(e);\n\t\t}\n\t}\n});\n}","export default function(scheduler){\n\nscheduler._wa = {};\nscheduler.xy.week_agenda_scale_height = 20;\nscheduler.templates.week_agenda_event_text = function(start_date, end_date, event, date) {\n\treturn scheduler.templates.event_date(start_date) + \" \" + event.text;\n};\nscheduler.date.week_agenda_start = scheduler.date.week_start;\nscheduler.date.week_agenda_end = function(date) {\n\treturn scheduler.date.add(date, 7, \"day\");\n};\nscheduler.date.add_week_agenda = function(date, inc) {\n\treturn scheduler.date.add(date, inc * 7, \"day\");\n};\n\nscheduler.attachEvent(\"onSchedulerReady\", function() {\n\tvar t = scheduler.templates;\n\tif (!t.week_agenda_date)\n\t\tt.week_agenda_date = t.week_date;\n});\n\n(function() {\n\tvar scale_date_format = scheduler.date.date_to_str(\"%l, %F %d\");\n\tscheduler.templates.week_agenda_scale_date = function(date) {\n\t\treturn scale_date_format(date);\n\t};\n})();\n\nscheduler.attachEvent(\"onTemplatesReady\", function() {\n\n\tvar old = scheduler.render_data;\n\tscheduler.render_data = function(evs) {\n\t\tif (this._mode == \"week_agenda\") {\n\t\t\tscheduler.week_agenda_view(true);\n\t\t} else\n\t\t\treturn old.apply(this, arguments);\n\t};\n\n\tfunction renderDay(index){\n\t\treturn `<div class='dhx_wa_day_cont'>\n\t<div class='dhx_wa_scale_bar'></div>\n\t<div class='dhx_wa_day_data' data-day='${index}'></div>\n</div>`;\n\t}\n\n\tvar fillWeekAgendaTab = function() {\n\t//\tgetColumnSizes();\n\t\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = '';\n\t\tscheduler._rendered = [];\n\t\t\n\t\tvar html = `<div class=\"dhx_week_agenda_wrapper\">\n<div class='dhx_wa_column'>\n\t${renderDay(0)}\n\t${renderDay(1)}\n\t${renderDay(2)}\n</div>\n<div class='dhx_wa_column'>\n\t${renderDay(3)}\n\t${renderDay(4)}\n\t${renderDay(5)}\n\t${renderDay(6)}\n</div>\n</div>`;\n\n\t\tvar dateElement = scheduler._getNavDateElement();\n\t\tif(dateElement){\n\t\t\tdateElement.innerHTML = scheduler.templates[scheduler._mode + \"_date\"](scheduler._min_date, scheduler._max_date, scheduler._mode);\n\t\t}\n\t\t\n\t\tscheduler._els[\"dhx_cal_data\"][0].innerHTML = html;\n\n\t\tconst dayDivs = scheduler.$container.querySelectorAll(\".dhx_wa_day_cont\");\n\n\t\tscheduler._wa._selected_divs = [];\n\t\tvar events = scheduler.get_visible_events(); // list of events to be displayed in current week\n\t\tvar tstart = scheduler.date.week_start(scheduler._date);\n\t\tvar tend = scheduler.date.add(tstart, 1, \"day\");\n\t\tfor (var i = 0; i < 7; i++) {\n\t\t\tdayDivs[i]._date = tstart;\n\t\t\tdayDivs[i].setAttribute(\"data-date\", scheduler.templates.format_date(tstart));\n\n\t\t\tscheduler._waiAria.weekAgendaDayCell(dayDivs[i], tstart);\n\n\t\t\tvar scale_bar = dayDivs[i].querySelector(\".dhx_wa_scale_bar\");\n\t\t\tvar events_div = dayDivs[i].querySelector(\".dhx_wa_day_data\");\n\t\t\tscale_bar.innerHTML = scheduler.templates.week_agenda_scale_date(tstart);\n\t\t\tvar evs = []; // events which will be displayed in the current day\n\t\t\tfor (var j = 0; j < events.length; j++) {\n\t\t\t\tvar tev = events[j];\n\t\t\t\tif (tev.start_date < tend && tev.end_date > tstart)\n\t\t\t\t\tevs.push(tev);\n\t\t\t}\n\t\t\tevs.sort(function(a, b) {\n\t\t\t\tif (a.start_date.valueOf() == b.start_date.valueOf())\n\t\t\t\t\treturn a.id > b.id ? 1 : -1;\n\t\t\t\treturn a.start_date > b.start_date ? 1 : -1;\n\t\t\t});\n\t\t\tfor (var k = 0; k < evs.length; k++) {\n\t\t\t\tvar ev = evs[k];\n\t\t\t\tvar ev_div = document.createElement('div');\n\t\t\t\tscheduler._rendered.push(ev_div);\n\t\t\t\tvar ev_class = scheduler.templates.event_class(ev.start_date, ev.end_date, ev);\n\t\t\t\tev_div.classList.add('dhx_wa_ev_body');\n\t\t\t\tif(ev_class){\n\t\t\t\t\tev_div.classList.add(ev_class);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (scheduler.config.rtl){\n\t\t\t\t\tev_div.classList.add(\"dhx_wa_ev_body_rtl\");\n\t\t\t\t}\n\t\t\t\tif (ev._text_style)\n\t\t\t\t\tev_div.style.cssText = ev._text_style;\n\t\t\t\tif (ev.color)\n\t\t\t\t\tev_div.style.setProperty(\"--dhx-scheduler-event-background\", ev.color);\n\t\t\t\tif (ev.textColor)\n\t\t\t\t\tev_div.style.setProperty(\"--dhx-scheduler-event-color\", ev.textColor);\n\t\t\t\tif (scheduler._select_id && ev.id == scheduler._select_id && !(!scheduler.config.week_agenda_select && scheduler.config.week_agenda_select !== undefined)) {\n\t\t\t\t\tev_div.classList.add(\"dhx_cal_event_selected\");\n\t\t\t\t\tscheduler._wa._selected_divs.push(ev_div);\n\t\t\t\t}\n\t\t\t\tvar position = \"\";\n\t\t\t\tif (!ev._timed) {\n\t\t\t\t\tposition = \"middle\";\n\t\t\t\t\tif (ev.start_date.valueOf() >= tstart.valueOf() && ev.start_date.valueOf() <= tend.valueOf())\n\t\t\t\t\t\tposition = \"start\";\n\t\t\t\t\tif (ev.end_date.valueOf() >= tstart.valueOf() && ev.end_date.valueOf() <= tend.valueOf())\n\t\t\t\t\t\tposition = \"end\";\n\t\t\t\t}\n\t\t\t\tev_div.innerHTML = scheduler.templates.week_agenda_event_text(ev.start_date, ev.end_date, ev, tstart, position);\n\t\t\t\tev_div.setAttribute('event_id', ev.id); // for backward compatibility\n\t\t\t\tev_div.setAttribute(scheduler.config.event_attribute, ev.id);\n\n\t\t\t\tscheduler._waiAria.weekAgendaEvent(ev_div, ev);\n\n\t\t\t\tevents_div.appendChild(ev_div);\n\t\t\t}\n\t\t\ttstart = scheduler.date.add(tstart, 1, \"day\");\n\t\t\ttend = scheduler.date.add(tend, 1, \"day\");\n\t\t}\n\t};\n\tscheduler.week_agenda_view = function(mode) {\n\t\tscheduler._min_date = scheduler.date.week_start(scheduler._date);\n\t\tscheduler._max_date = scheduler.date.add(scheduler._min_date, 1, \"week\");\n\t\tscheduler.set_sizes();\n\t\tif (mode) { // mode enabled\n\t\t\tscheduler._table_view = scheduler._allow_dnd = true;\n\t\t\tscheduler.$container.querySelector(\".dhx_cal_header\").style.display = 'none';\n\n\t\t\t// cleaning dhx_cal_date from the previous date\n\t\t\tscheduler._els['dhx_cal_date'][0].innerHTML = \"\";\n\t\t\tfillWeekAgendaTab();\n\t\t} else { // leaving week_agenda mode\n\t\t\tscheduler._table_view = scheduler._allow_dnd = false;\n\t\t\tscheduler.$container.querySelector(\".dhx_cal_header\").style.display = '';\n\t\t}\n\t};\n\tscheduler.mouse_week_agenda = function(pos) {\n\t\tvar native_event = pos.ev;\n\n\t\tconst dayCont = pos.ev.target.closest(\".dhx_wa_day_cont\");\n\t\tlet date;\n\t\tif(dayCont){\n\t\t\tdate = dayCont._date;\n\t\t}\n\n\t\tif (!date)\n\t\t\treturn pos;\n\t\tpos.x = 0;\n\t\tvar diff = date.valueOf() - scheduler._min_date.valueOf();\n\t\tpos.y = Math.ceil(( diff / (1000 * 60) ) / this.config.time_step);\n\t\tif (this._drag_mode == 'move' && this._drag_pos && this._is_pos_changed(this._drag_pos, pos)) {\n\t\t\tvar event_div;\n\t\t\tthis._drag_event._dhx_changed = true;\n\t\t\tthis._select_id = this._drag_id;\n\t\t\tfor (var i = 0; i < scheduler._rendered.length; i++) {\n\t\t\t\tif (scheduler._drag_id == this._rendered[i].getAttribute(this.config.event_attribute))\n\t\t\t\t\tevent_div = this._rendered[i];\n\t\t\t}\n\t\t\tif (!scheduler._wa._dnd) {\n\t\t\t\tvar div = event_div.cloneNode(true);\n\t\t\t\tthis._wa._dnd = div;\n\t\t\t\tdiv.className = event_div.className;\n\t\t\t\tdiv.id = 'dhx_wa_dnd';\n\t\t\t\tdiv.className += ' dhx_wa_dnd';\n\t\t\t\tdocument.body.appendChild(div);\n\t\t\t}\n\t\t\tvar dnd_div = document.getElementById('dhx_wa_dnd');\n\t\t\tdnd_div.style.top = ((native_event.pageY || native_event.clientY) + 20) + \"px\";\n\t\t\tdnd_div.style.left = ((native_event.pageX || native_event.clientX) + 20) + \"px\";\n\t\t}\n\t\treturn pos;\n\t};\n\tscheduler.attachEvent('onBeforeEventChanged', function(event_object, native_event, is_new) {\n\t\tif (this._mode == 'week_agenda') {\n\t\t\tif (this._drag_mode == 'move') {\n\t\t\t\tvar dnd = document.getElementById('dhx_wa_dnd');\n\t\t\t\tdnd.parentNode.removeChild(dnd);\n\t\t\t\tscheduler._wa._dnd = false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n\tscheduler.attachEvent(\"onEventSave\", function(id, data, is_new_event) {\n\t\tif (is_new_event && this._mode == 'week_agenda')\n\t\t\tthis._select_id = id;\n\t\treturn true;\n\t});\n\n\tscheduler._wa._selected_divs = [];\n\n\tscheduler.attachEvent(\"onClick\", function(event_id, native_event_object) {\n\t\tif (this._mode == 'week_agenda' && !(!scheduler.config.week_agenda_select && scheduler.config.week_agenda_select !== undefined)) {\n\t\t\tif (scheduler._wa._selected_divs) {\n\t\t\t\tfor (var i = 0; i < this._wa._selected_divs.length; i++) {\n\t\t\t\t\tvar div = this._wa._selected_divs[i];\n\t\t\t\t\tdiv.className = div.className.replace(/ dhx_cal_event_selected/, '');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.for_rendered(event_id, function(event_div) {\n\t\t\t\tevent_div.className += \" dhx_cal_event_selected\";\n\t\t\t\tscheduler._wa._selected_divs.push(event_div);\n\t\t\t});\n\t\t\t// scheduler.select(event_id);\n\t\t\t// not using .select(), as it triggers redraw of the view and resets the state of possible scrolls in day cells\n\t\t\tscheduler._select_id = event_id;\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n});\n\n\n}","export default function(scheduler){\nscheduler.attachEvent(\"onLightBox\",function(){\n\tif (this._cover){\n\t\ttry{\n\t\t\tthis._cover.style.height = this.expanded ? \"100%\" : ((document.body.parentNode||document.body).scrollHeight+\"px\");\n\t\t} catch(e) {\n\n\t\t}\n\t}\n});\n\nscheduler.form_blocks.select.set_value=function(node,value,ev){\n\tif (typeof value == \"undefined\" || value === \"\")\n\t\tvalue = (node.firstChild.options[0]||{}).value;\n\tnode.firstChild.value=value||\"\";\n};\n\n}","export default function(scheduler){\n\n\t// scheduler.config.year_x = 4;\n\t// scheduler.config.year_y = 3;\n\t// scheduler.xy.year_top = 0;\n\n\tscheduler.templates.year_date = function(date) {\n\t\treturn scheduler.date.date_to_str(scheduler.locale.labels.year_tab + \" %Y\")(date);\n\t};\n\tscheduler.templates.year_month = scheduler.date.date_to_str(\"%F\");\n\tscheduler.templates.year_scale_date = scheduler.date.date_to_str(\"%D\");\n\tscheduler.templates.year_tooltip = function(s, e, ev) {\n\t\treturn ev.text;\n\t};\n\n\tconst isYearMode = function() {\n\t\treturn scheduler._mode == \"year\";\n\t};\n\t\n\tconst getCellDate = function(node){\n\t\tvar day = scheduler.$domHelpers.closest(node, \"[data-cell-date]\");\n\t\tif(!day || !day.hasAttribute(\"data-cell-date\")) return null;\n\t\treturn scheduler.templates.parse_date(day.getAttribute(\"data-cell-date\"));\n\t};\n\n\t// dbl click hook for scheduler._on_dbl_click\n\tscheduler.dblclick_dhx_year_grid= function(e) {\n\t\tif (isYearMode()) {\n\t\t\tconst target = e.target;\n\t\t\tif(scheduler.$domHelpers.closest(target, \".dhx_before\") || scheduler.$domHelpers.closest(target, \".dhx_after\")){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tconst date = getCellDate(target);\n\t\t\t\n\t\t\tif(date){\n\t\t\t\tconst start = date;\n\t\t\t\tconst end = this.date.add(start, 1, \"day\");\n\t\t\t\tif (!this.config.readonly && this.config.dblclick_create){\n\t\t\t\t\tthis.addEventNow(start.valueOf(), end.valueOf(), e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t\n\tscheduler.attachEvent(\"onEventIdChange\", function(){\n\t\tif (isYearMode())\n\t\t\tthis.year_view(true);\n\t});\n\n\n\tvar old = scheduler.render_data;\n\tscheduler.render_data = function(evs) {\n\t\tif (!isYearMode()) return old.apply(this, arguments);\n\t\tfor (var i = 0; i < evs.length; i++)\n\t\t\tthis._year_render_event(evs[i]);\n\t};\n\n\tvar clear = scheduler.clear_view;\n\tscheduler.clear_view = function() {\n\t\tif (!isYearMode()) return clear.apply(this, arguments);\n\t\tvar dates = scheduler._year_marked_cells,\n\t\t\tdiv = null;\n\t\tfor (var date in dates) {\n\t\t\tif (dates.hasOwnProperty(date)) {\n\t\t\t\tdiv = dates[date];\n\t\t\t\tdiv.classList.remove(\"dhx_year_event\", \"dhx_cal_datepicker_event\");\n\t\t\t\t// div.className = \"dhx_month_head\";\n\t\t\t\t// div.removeAttribute(\"date\");\n\t\t\t\t// div.removeAttribute(\"data-year-date\");\n\t\t\t}\n\t\t}\n\t\tscheduler._year_marked_cells = {};\n\t};\n\n\tscheduler._hideToolTip = function() {\n\t\tif (this._tooltip) {\n\t\t\tthis._tooltip.style.display = \"none\";\n\t\t\tthis._tooltip.date = new Date(9999, 1, 1);\n\t\t}\n\t};\n\n\tscheduler._showToolTip = function(date, pos, e, src) {\n\t\tif (this._tooltip) {\n\t\t\tif (this._tooltip.date.valueOf() == date.valueOf()) return;\n\t\t\tthis._tooltip.innerHTML = \"\";\n\t\t} else {\n\t\t\tvar t = this._tooltip = document.createElement(\"div\");\n\t\t\tt.className = \"dhx_year_tooltip\";\n\t\t\tif (this.config.rtl) t.className += \" dhx_tooltip_rtl\";\n\t\t\tdocument.body.appendChild(t);\n\t\t\tt.addEventListener(\"click\", scheduler._click.dhx_cal_data);\n\t\t\tt.addEventListener(\"click\", function(e){\n\t\t\t\tif(e.target.closest(`[${scheduler.config.event_attribute}]`)){\n\t\t\t\t\tconst id = e.target.closest(`[${scheduler.config.event_attribute}]`).getAttribute(scheduler.config.event_attribute);\n\t\t\t\t\tscheduler.showLightbox(id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tvar evs = this.getEvents(date, this.date.add(date, 1, \"day\"));\n\t\tvar html = \"\";\n\n\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\tvar ev = evs[i];\n\t\t\tif(!this.filter_event(ev.id, ev))\n\t\t\t\tcontinue;\n\n\t\t\tvar bg_color = (ev.color ? (\"--dhx-scheduler-event-background:\" + ev.color + \";\") : \"\");\n\t\t\tvar color = (ev.textColor ? (\"--dhx-scheduler-event-color:\" + ev.textColor + \";\") : \"\");\n\n\t\t\thtml += \"<div class='dhx_tooltip_line' style='\" + bg_color + \"\" + color + \"' event_id='\" + evs[i].id + \"' \"+this.config.event_attribute+\"='\"+evs[i].id+\"'>\";\n\t\t\thtml += \"<div class='dhx_tooltip_date' style='\" + bg_color + \"\" + color + \"'>\" + (evs[i]._timed ? this.templates.event_date(evs[i].start_date) : \"\") + \"</div>\";\n\t\t\thtml += \"<div class='dhx_event_icon icon_details'>&nbsp;</div>\";\n\t\t\thtml += this.templates.year_tooltip(evs[i].start_date, evs[i].end_date, evs[i]) + \"</div>\";\n\t\t}\n\n\t\tthis._tooltip.style.display = \"\";\n\t\tthis._tooltip.style.top = \"0px\";\n\n\n\t\tif (document.body.offsetWidth - pos.left - this._tooltip.offsetWidth < 0)\n\t\t\tthis._tooltip.style.left = pos.left - this._tooltip.offsetWidth + \"px\";\n\t\telse\n\t\t\tthis._tooltip.style.left = pos.left + src.offsetWidth + \"px\";\n\n\t\tthis._tooltip.date = date;\n\t\tthis._tooltip.innerHTML = html;\n\n\t\tif (document.body.offsetHeight - pos.top - this._tooltip.offsetHeight < 0)\n\t\t\tthis._tooltip.style.top = pos.top - this._tooltip.offsetHeight + src.offsetHeight + \"px\";\n\t\telse\n\t\t\tthis._tooltip.style.top = pos.top + \"px\";\n\t};\n\n\tscheduler._year_view_tooltip_handler = function(e){\n\t\tif (!isYearMode()) return;\n\n\t\tvar src = e.target || e.srcElement;\n\t\tif (src.tagName.toLowerCase() == 'a') // fix for active links extension (it adds links to the date in the cell)\n\t\t\tsrc = src.parentNode;\n\t\tif (scheduler._getClassName(src).indexOf(\"dhx_year_event\") != -1)\n\t\t\tscheduler._showToolTip(scheduler.templates.parse_date(src.getAttribute(\"data-year-date\")), scheduler.$domHelpers.getOffset(src), e, src);\n\t\telse\n\t\t\tscheduler._hideToolTip();\n\t};\n\tscheduler._init_year_tooltip = function() {\n\t\tscheduler._detachDomEvent(scheduler._els[\"dhx_cal_data\"][0], \"mouseover\", scheduler._year_view_tooltip_handler);\n\t\tscheduler.event(scheduler._els[\"dhx_cal_data\"][0], \"mouseover\", scheduler._year_view_tooltip_handler);\n\t};\n\n\tscheduler._get_year_cell = function(d) {\n\t\tvar dateString = scheduler.templates.format_date(d);\n\t\tvar cells = this.$root.querySelectorAll(`.dhx_cal_data .dhx_cal_datepicker_date[data-cell-date=\"${dateString}\"]`);\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tif(!scheduler.$domHelpers.closest(cells[i], \".dhx_after, .dhx_before\")){\n\t\t\t\treturn cells[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tscheduler._year_marked_cells = {};\n\tscheduler._mark_year_date = function(date, event) {\n\t\tvar dateString = scheduler.templates.format_date(date);\n\t\tvar cell = this._get_year_cell(date);\n\t\tif (!cell) {\n\t\t\treturn;\n\t\t}\n\t\tvar ev_class = this.templates.event_class(event.start_date, event.end_date, event);\n\t\tif (!scheduler._year_marked_cells[dateString]) {\n\t\t\tcell.classList.add(\"dhx_year_event\", \"dhx_cal_datepicker_event\");// = \"dhx_month_head dhx_year_event\";\n\t\t\tcell.setAttribute(\"data-year-date\", dateString);\n\t\t\tcell.setAttribute(\"date\", dateString);\n\t\t\tscheduler._year_marked_cells[dateString] = cell;\n\t\t}\n\t\tif(ev_class){\n\t\t\tcell.classList.add(ev_class);\n\t\t}\n\t};\n\tscheduler._unmark_year_date = function(date) {\n\t\tvar cell = this._get_year_cell(date);\n\t\tif (!cell) {\n\t\t\treturn;\n\t\t}\n\t\tcell.classList.remove(\"dhx_year_event\", \"dhx_cal_datepicker_event\");\n//\t\tcell.className = \"dhx_month_head\";\n\t};\n\tscheduler._year_render_event = function(event) {\n\t\tvar date = event.start_date;\n\t\tif (date.valueOf() < this._min_date.valueOf()){\n\t\t\tdate = this._min_date;\n\t\t} else {\n\t\t\tdate = this.date.date_part(new Date(date));\n\t\t}\n\n\t\twhile (date < event.end_date) {\n\t\t\tthis._mark_year_date(date, event);\n\t\t\tdate = this.date.add(date, 1, \"day\");\n\t\t\tif (date.valueOf() >= this._max_date.valueOf())\n\t\t\t\treturn;\n\t\t}\n\t};\n\n\tscheduler.year_view = function(mode) {\n\n\t\tscheduler.set_sizes();\n\n\t\tscheduler._table_view = mode;\n\n\t\tif (this._load_mode && this._load()) return;\n\n\t\tif (mode) {\n\t\t\tscheduler._init_year_tooltip();\n\t\t\tscheduler._reset_year_scale();\n\t\t\tif (scheduler._load_mode && scheduler._load()){\n\t\t\t\tscheduler._render_wait = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tscheduler.render_view_data();\n\t\t} else {\n\t\t\tscheduler._hideToolTip();\n\t\t}\n\t};\n\n\tscheduler._reset_year_scale = function(){\n\n\t\tvar dataArea = this._els[\"dhx_cal_data\"][0];\n\n\t\tdataArea.scrollTop = 0; //fix flickering in FF\n\t\tdataArea.innerHTML = \"\";\n\n\t\tlet yearStart = this.date.year_start(new Date(this._date));\n\t\t\n\t\tthis._min_date = this.date.week_start(new Date(yearStart));\n\n\t\tconst wrapper = document.createElement(\"div\");\n\t\twrapper.classList.add(\"dhx_year_wrapper\");\n\n\t\tlet currentDate = yearStart;\n\t\tfor(let i = 0; i < 12; i++){\n\t\t\tlet yearBox = document.createElement(\"div\");\n\t\t\tyearBox.className = \"dhx_year_box\";\n\n\t\t\tyearBox.setAttribute(\"date\", this._helpers.formatDate(currentDate));\n\t\t\tyearBox.setAttribute(\"data-month-date\", this._helpers.formatDate(currentDate));\n\t\t\tyearBox.innerHTML = `<div class='dhx_year_month'>${this.templates.year_month(currentDate)}</div>\n\t\t\t<div class='dhx_year_grid'></div>`;\n\n\t\t\tconst yearGrid = yearBox.querySelector(\".dhx_year_grid\");\n\t\t\tconst datepicker = scheduler._createDatePicker(null, {\n\t\t\t\tdate: currentDate,\n\t\t\t\tfilterDays: scheduler.ignore_year,\n\t\t\t\tminWeeks: 6\n\t\t\t});\n\t\t\tdatepicker._renderDayGrid(yearGrid);\n\t\t\tdatepicker.destructor();\n\n\t\t\twrapper.appendChild(yearBox);\n\n\t\t\tcurrentDate = this.date.add(currentDate, 1, \"month\");\n\n\t\t}\n\t\tdataArea.appendChild(wrapper);\n\n\t\tlet lastDate = this.date.add(yearStart, 1, \"year\");\n\t\tif(lastDate.valueOf() != this.date.week_start(new Date(lastDate)).valueOf()){\n\t\t\tlastDate = this.date.week_start(new Date(lastDate));\n\t\t\tlastDate = this.date.add(lastDate, 1, \"week\");\n\t\t}\n\t\tthis._max_date = lastDate;\n\t\tvar dateElement = this._getNavDateElement();\n\t\tif(dateElement){\n\t\t\tdateElement.innerHTML = this.templates[this._mode + \"_date\"](yearStart, lastDate, this._mode);\n\t\t}\n\t};\n\n\tvar getActionData = scheduler.getActionData;\n\tscheduler.getActionData = function(n_ev) {\n\t\tif(!isYearMode()){\n\t\t\treturn getActionData.apply(scheduler, arguments);\n\t\t}\n\t\t\n\t\tvar date = getCellDate(n_ev.target);\n\t\treturn {\n\t\t\tdate:date,\n\t\t\tsection:null\n\t\t};\n\t};\n\n\tvar locateEvent = scheduler._locate_event;\n\tscheduler._locate_event = function(node) {\n\t\tvar id = locateEvent.apply(scheduler, arguments);\n\t\tif(!id){\n\t\t\t\n\t\t\tvar date = getCellDate(node);\n\t\t\tif(!date) return null;\n\t\t\tvar evs = scheduler.getEvents(date, scheduler.date.add(date, 1, \"day\"));\n\t\t\tif(!evs.length) return null;\n\n\t\t\t//can be multiple events in the cell, return any single one\n\t\t\tid = evs[0].id;\n\t\t}\n\t\treturn id;\n\t};\n\n\tscheduler.attachEvent(\"onDestroy\", function(){\n\t\tscheduler._hideToolTip();\n\t});\n}","import SchedulerFactory from \"./scheduler_factory\";\nimport allExtensions from \"./ext/extensions_all\";\n\nconst factory = new SchedulerFactory(allExtensions);\n\nconst scheduler = factory.getSchedulerInstance();\nconst Scheduler = {\n\tplugin: scheduler.bind(factory.plugin, factory)\n};\n\nwindow.scheduler = scheduler;\nwindow.Scheduler = Scheduler;\n\nif(!window.$dhx) {\n\twindow.$dhx = {};\n}\n\nwindow.$dhx.scheduler = scheduler;\nwindow.$dhx.Scheduler = Scheduler;\n\nexport { scheduler, Scheduler };","\n\nimport dhtmlxHook from \"./dhtmlx_hook\";\nimport \"./css/theme.less\";\ndhtmlxHook();\n\nimport global from \"./global\";\n\nimport factoryMethod from \"./scheduler_factory_method\";\nimport ExtensionsManager from \"./ext/extension_manager\";\n\nclass SchedulerFactory {\n\n\tconstructor (extensions) {\n\t\tthis._seed = 0;\n\t\tthis._schedulerPlugins = [];\n\t\tthis._bundledExtensions = extensions;\n\t\tthis._extensionsManager = new ExtensionsManager(extensions);\n\t}\n\n\tplugin(code) {\n\t\tthis._schedulerPlugins.push(code);\n\n\t\tif(global.scheduler){\n\t\t\tcode(global.scheduler);\n\t\t}\n\t}\n\t\n\tgetSchedulerInstance(initConfig) {\n\t\tvar scheduler = factoryMethod(this._extensionsManager);\n\n\t\tfor (var i = 0; i < this._schedulerPlugins.length; i++) {\n\t\t\tthis._schedulerPlugins[i](scheduler);\n\t\t}\n\t\tscheduler._internal_id = this._seed++;\n\t\n\t\tif (this.$syncFactory){\n\t\t\tthis.$syncFactory(scheduler);\n\t\t}\n\n\t\tif(initConfig){\n\t\t\tthis._initFromConfig(scheduler, initConfig);\n\t\t}\n\n\t\treturn scheduler;\n\t}\n\n\t_initFromConfig(scheduler, initConfig){\n\t\tif(initConfig.plugins){\n\t\t\tscheduler.plugins(initConfig.plugins);\n\t\t}\n\t\n\t\tif(initConfig.config){\n\t\t\tscheduler.mixin(scheduler.config, initConfig.config, true);\n\t\t}\n\t\n\t\tif(initConfig.templates){\n\t\t\tscheduler.attachEvent(\"onTemplatesReady\", function(){\n\t\t\t\tscheduler.mixin(scheduler.templates, initConfig.templates, true);\n\t\t\t}, {once: true});\n\t\t}\n\t\n\t\tif(initConfig.events){\n\t\t\tfor(const event in initConfig.events){\n\t\t\t\tscheduler.attachEvent(event, initConfig.events[event]);\n\t\t\t}\n\t\t}\n\t\n\t\tif(initConfig.locale){\n\t\t\tscheduler.i18n.setLocale(initConfig.locale);\n\t\t}\n\t\n\t\tif(Array.isArray(initConfig.calendars)){\n\t\t\tinitConfig.calendars.forEach(function(calendar){\n\t\t\t\tscheduler.addCalendar(calendar);\n\t\t\t});\n\t\t}\n\t\n\t\tif(initConfig.container){\n\t\t\tscheduler.init(initConfig.container);\n\t\t} else {\n\t\t\tscheduler.init();\n\t\t}\n\t\n\t\tif(initConfig.data){\n\t\t\tif(typeof initConfig.data === \"string\"){\n\t\t\t\tscheduler.load(initConfig.data);\n\t\t\t}else{\n\t\t\t\tscheduler.parse(initConfig.data);\n\t\t\t}\n\t\t}\n\t}\n\t\n\n}\n\nexport default SchedulerFactory;"],"names":["global$1","window","global","dragHighlightPos","scheduler","dndMarkers","dragStarted","eventNode","event","isEnabled","config","drag_highlight","markTimespan","checkViewName","viewName","viewObj","getView","layout","createMarkerConfig","configSettings","sectionId","style","top","left","marginLeft","sections","markerObject","start_date","end_date","css","html","round_position","index","_get_date_index","rounded_date","_trace_x","date","add","createViewMarker","settings","markerConfigs","monthViewMarkersArray","weekDates","currDate","Date","valueOf","obj","push","week_start","cells","$container","querySelectorAll","event_attribute","id","i","length","cloneNode","unitMarkersArray","sectionPropertyName","y_property","map_to","formatedSections","String","split","section_delimiter","map","element","elems","columnViewMarkersArray","eventNodes","eventNodeClone","getAttribute","forEach","cfg","attachEvent","mode","e","getEvent","target","closest","getState","cascade_event_display","unselect","getActionData","section","n","unmarkTimespan","limitPlugin","mark_now","display_marked_timespans","overwrite_marked_timespans","dhx_time_block","default_timespan_type","get_resulting_options","days","zones","options","type","getZones","ev","timespans","day_index","day_value","timespan_type","s","containers","_props","matrix","container","property","view","linker","_add_timespan_zones","_get_blocked_zones","blockTime","addMarkedTimespan","unblockTime","deleteMarkedTimespan","checkInMarkedTimespan","on_overlap","res","temp_start_date","temp_end_date","_marked_timespans","date_part","getDay","eventStart","_get_zone_minutes","eventEnd","getDate","markerStart","markerEnd","checkLimitViolation","check_limits","c","evs","rec_type","_end_date","seriesEnd","limit_start","limit_end","complete_res","p","_timed","isOneDayEvent","allow","_drag_id","_drag_mode","setHours","setMinutes","checkEvent","callEvent","timeline_zones","blocked_timeline_zones","this","_get_relevant_blocked_zones","resultZones","concat","_mark_now","hide","dhx_now_time","_els","now","_currentDate","_remove_mark_now","_max_date","_min_date","getHours","first_hour","last_hour","locate_holder_day","_append_mark_now","zone_start","_table_view","_mode","start_index","end_index","units_l","size","position","r_divs","t_day","t_div","_render_marked_timespan","els","div","parent","parentNode","removeChild","getMinutes","_prepare_timespan_options","r_configs","temp_configs","Array","t_days","slice","cloned_config","_lame_clone","apply","invert_zones","invertZones","uid","view_key","hasOwnProperty","ids","t_config","_lame_copy","k","c_config","t_sd","t_ed","zone_end","_get_dates_by_index","start","end","dates","start_day","delta","t_date","_get_css_classes_by_config","css_classes","join","_get_block_by_config","block","document","createElement","innerHTML","appendChild","area","day","blocks","min_date","max_date","date_to_display","min_day","areas","_","_scales","sday","_cols","_ignores","block_proto","className","height","width","order","inner_index","locate_holder","Math","max","min","all_hours_height","hour_size_px","hour_ms","round","_mark_timespans","data","divs","_on_scale_add_marker","len","childNodes","firstChild","_getClassName","indexOf","configuration","Error","rebuild_els","get_elements","timespans_ids","_marked_timespans_ids","timespan_types","_marked_timespans_types","_addMarkerTimespanConfig","unit_id","timespans_view","day_configs","_array","configs","current_zones","resulting_zones","c_zone_start","c_zone_end","isLast","offset","splice","_subtract_timespan_zones","is_modified","d","_delete_marked_timespan_by_id","parent_array","_delete_marked_timespan_by_config","viewspans","_delete_marked_timespans_list","dayConfig","day_timespans","d_t","related_zones","arguments","types","t","typedConfig","_get_types_to_render","common","specific","types_to_render","_get_configs_to_render","units","unit","_get_unit_index","day_ind","unitsPerDay","floor","_date","key","unit_zones","unit_types","global_data","day_types","dblclick_dhx_marked_timespan","src","dblclick_create","addEventNow","createMethod","methods","isActive","disableMethod","methodName","dummyMethod","restoreMethod","disableMethods","methodsHash","call","restoreMethods","batchUpdatePayload","callback","console","error","$stateProvider","registerProvider","batch_update","noRedraw","dp_mode","call_dp","_dp","updateMode","setUpdateMode","calls","setModeDate","needRender","needUpdateView","repaintEvents","rememberModeDate","render","setCurrentView","updateView","render_data","render_view_data","updateEvent","sendData","url","token","_url","_token","_seed","_queue","api","_events","Accept","credentials","headers","method","body","fetch","then","json","parse","websocket","_wrapper","connect","_socket","onclose","close","location","protocol","host","replace","o","r","WebSocket","setTimeout","onmessage","JSON","action","result","fire","name","value","onError","_send","_resubscribe","Promise","_uid","args","status","resolve","reject","onCall","bind","toString","filter","stringify","catch","send","onResponse","handler","RemoteEvents","remote","Client","req","_ready","load","back","_remote","ready","on","createHandlers","processUpdate","eventData","warn","templates","parse_date","original_start","ignore","addEvent","sid","existingEvent","changeEventId","event_pid","rrule","_roll_back_dates","markers","_get_rec_markers","markerId","deleteEvent","lightbox_id","_new_event","_lightbox_id","endLightbox","_lightbox","code","events","message","_in_progress","once","initPlugins","undoableDeletes","deletedEvent","copy","undo_deleted","new_event","text","expire","duration","limit","batchUpdate","ext","liveUpdates","remoteUpdates","uidSeed","isDate","getFullYear","getMonth","utils","mixin","source","force","f","object","isArray","pop","Function","prototype","constructor","Number","Boolean","varType","Object","defined","delay","timeout","timer","$cancelTimeout","$pending","clearTimeout","$execute","extend","cssClass","classList","itemTypes","setAttribute","fix_tab_position","$firstTab","$lastTab","$segmentedTab","minicalendarDiv","click","$_eventAttached","isCalendarVisible","destroyCalendar","renderCalendar","navigation","calendar","renderElement","renderer","rows","cols","align","justifyContent","prepareConfig","renderLayout","items","fragment","createDocumentFragment","next","_init_nav_bar","navBar","querySelector","_update_nav_bar","previousHeight","heightChanged","newHeight","xy","nav_height","unset_actions","set_actions","display","isAttachedNode","isConnected","contains","getWindowSize","w","innerWidth","documentElement","clientWidth","h","innerHeight","clientHeight","listenWindowResize","resizeDelay","oldSize","$destroyed","a","b","newSize","triggerSchedulerResize","$initialized","$root","root","getComputedStyle","getPropertyValue","ResizeObserver","skipFirst","resizeObserver","entries","observe","unobserve","resizeWatcher","tabIndex","wai_aria_attributes","offsetHeight","previousWidth","offsetWidth","lowlevelResizeWatcher","contentWindow","EventHost","_silent_mode","listeners","makeEventable","eventHost","eventName","toLowerCase","handlers","eventStorage","combinedResult","handlerResult","handlerId","originalHandler","removeEvent","clear","thisObject","attachAll","eventArguments","handlerName","detachEvent","list","eventId","detachAllEvents","defaultDomEvents","el","addEventListener","eventRemove","removeEventListener","domEvents","eventScope","attach","capture","detach","detachAll","staticArray","createEventScope","_eventRemoveAll","_createDomEventScope","_trim","str","trim","_isDate","_isObject","getClassName","node","baseVal","locateCss","classname","strict","trg","srcElement","ind","charAt","right","isVisible","visibility","currentStyle","hiddenSection","recurringSection","hasNonNegativeTabIndex","isNaN","hasHref","nodeName","loLowerCase","input","select","textarea","button","hasAttribute","isShadowDomSupported","head","createShadowRoot","attachShadow","getRootNode","ShadowRoot","dom_helpers","getAbsoluteLeft","htmlObject","getOffset","getAbsoluteTop","getOffsetSum","elem","parseInt","offsetTop","offsetLeft","offsetParent","getOffsetRect","box","getBoundingClientRect","test","navigator","userAgent","dummy","dummyBox","docElem","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","selector","insertAfter","newNode","referenceNode","nextSibling","insertBefore","remove","isChildOf","child","getFocusableNodes","nodes","nodesArray","$position","sort","hasShadowParent","getActiveElement","activeElement","shadowRoot","getSelection","focusNode","getRelativeEventPosition","bottom","y","x","clientX","clientY","getTargetNode","tagName","composedPath","getNodePosition","Element","matches","msMatchesSelector","webkitMatchesSelector","parentElement","nodeType","isWindowAwailable","env","isIE","isOpera","isChrome","isKHTML","isFF","isIPad","search","isEdge","isNode","serialize$1","serialized","encodeURIComponent","generateStringToDate","format","utc","splt","mask","match","csp_str_to_date","set","temp","locale","month_short_hash","month_full_hash","UTC","cspEnabled","useCsp","csp","init","month_short","month_full","old","setSeconds","setMilliseconds","setTime","getTime","time_part","getTimezoneOffset","shift","start_on_monday","month_start","setDate","year_start","setMonth","day_start","_add_days","inc","ndate","rest","hours","setYear","to_fixed","num","date_to_str","getUTCDate","getUTCMonth","getUTCFullYear","day_short","getUTCDay","day_full","getUTCHours","getUTCMinutes","getUTCSeconds","getSeconds","getUTCISOWeek","getISOWeek","str_to_date","exactFormat","stringToDateMethod","parseExactFormat","yyyyMMddhhIIss","MMddyyyyhhIIss","ddMMyyyyhhIIss","ISO8601","parseYMD","parseMDY","parseDMY","dateString","parse_exact_format","datestr","nday","first_thursday","year_number","ordinal_date","convert_to_utc","getSerializator","_loaded","_load","from","_load_url","to","prevent_cache","_load_mode","lf","load_format","cache_line","temp_to","ajax","get","ajaxCallback","response","on_load","_parsers","xml","canParse","xhr","responseXML","xmlDoc","responseText","topElement","xmltop","loader","csrfToken","dhtmlx","security_key","opts","xpath","arr","serverList","itms","j","attrs","attributes","label","attr","nodeValue","ud","udx","_xmlNodeToJSON","_userdata","_init_event","dhx_security","collections","collections_loaded","collection","option","option_key","ical","RegExp","c_start","c_end","incoming","event_r","e_start","e_end","exec","param","param_r","parse_param","substr","dh","dm","utcMark","dy","dn","dd","server_utc","foundParser","parser","_process","_process_loading","_loading","_not_render","_render_wait","_after_call","_tagvalue","_init_date","_helpers","parseDate","getSerializableData","createSerializator","serialize","dataset","allEvents","exportedEvent","exportValue","rawValue","xml_format","format_date","setLoadMode","array","show_loading","_x","_y","_obj","getLightboxRoot","cspEnvironment","salesforceEnvironment","_lightbox_controls","formSection","lightbox","getLightbox","header","getValue","form_blocks","get_value","setValue","set_value","get_template_control","control","get_select_control","getElementsByTagName","get_textarea_control","get_time_control","defaults","template","time","sns","focus","placeholder","_get_input","_focus","_dhx_onchange","onchange","time_format","_time_format_order","dt","last","first","limit_time_select","time_option","selectBoxClass","range","start_year","end_year","year_range","v","tdate","_time_values","time_picker","time_step","ariaAttrs","_waiAria","lightboxSelectAttrString","readonly","full_day","_full_day","labels","wide_form","previousSibling","checked","disabled","_fill_lightbox_select","auto_end_date","event_duration","_update_lightbox_select","time_values","direct_value","fixed_value","value_found","t_v","selectedIndex","original","_setLbPosition","showCover","responsive_lightbox","show_cover","_cover","showLightbox","_fill_lightbox","lightboxVisibleAttr","lightboxHeader","lightbox_header","headerContent","headerDate","event_header","headerTitle","event_bar_text","current_sns","_get_lightbox_section_node","default_value","_lightbox_out","_empty_lightbox","setEvent","_edit_stop_event","hide_lightbox","hideCover","hide_cover","_move_while_dnd","_finish_dnd","save_lightbox","startLightbox","_custom_lightbox","_temp_lightbox","lightboxHiddenAttr","resetLightbox","cancel_lightbox","hideLightbox","_init_lightbox_events","buttonTarget","$domHelpers","sectionButton","button_click","readonly_active","confirm_deleting","_dhtmlx_confirm","title","title_confirm_deleting","_thisAndFollowing","_removeFollowing","ok","icon_delete","keyCode","shiftKey","keys","edit_save","edit_cancel","monthSelectNodes","daySelectNodes","yearSelectNodes","daySelect","month","year","daysInMonth","maxDays","curDayValue","textContent","setLightboxSize","_init_dnd_events","_dnd_start_lb","dhx_unselectable","lb","pageX","pageY","_lb_start","_ready_to_dnd","recurring","rtl","_lightbox_template","buttons","buttons_right","lightboxButtonAttrString","buttons_left","drag_lightbox","preventDefault","cursor","lightboxAttr","lightboxSectionButtonAttrString","label_name","ds","t_ds","_bindLightboxLabels","inputBlock","fallback","inputId","old_id","new_id","_init_touch_events","touch","MSStream","platform","maxTouchPoints","scroll_width","_mobile","touchEventsSupported","createEvent","_touch_events","touches","PointerEvent","pointerEnabled","pointerType","msPointerEnabled","MSPOINTER_TYPE_MOUSE","names","accessor","tracker","drag_mode","scroll_mode","action_mode","dblclicktime","attachTouchEvent","_is_lightbox_open","passive","drag_cancel","_hide_global_tip","_on_mouse_up","_temp_touch_block","_drag_pos","_pointerDragId","acc","dnd","timeline","original_render","drag_id","getEvents","_sorder","_count","_on_mouse_move","cancelBubble","_update_global_tip","abs","fake_event","pointerId","_click","dhx_cal_data","_on_dbl_click","_block_next_stop","touch_drag","actTask","_locate_event","fakeTask","sourceTask","_ignore_next_click","_on_mouse_down","for_rendered","_rendered","touch_tip","_show_global_tip","touch_swipe_dates","s_ev","e_ev","step","max_dy","scrollable","dx","dhx_cal_next_button","dhx_cal_prev_button","toptip","_global_tip","day_date","drag_to_create","drag_to_move","calculatedMaterial","cachedBorderBoxValue","checkIfBorderBoxStyling","_is_material_skin","probe","boxSizing","refreshAfterLoad","_border_box_events","oldStyling","undefined","flatSkinHourScale","_addThemeClass","skin","_skin_settings","use_select_menu_space","displayed_event_color","displayed_event_text_color","_skin_xy","lightbox_additional_height","bar_height","_build_skin_info","clearInterval","monitorIntervalId","setInterval","csstheme","setSkin","styles","themeVar","themeName","isCssVarTheme","cssValues","oldMaterialTheme","links","href","_theme_info","theme","cssVarTheme","values","themeVariables","_configure","col","_skin_init","hour_scale","hour_date","_old_month_day","month_day","old_month_day","dhx_cal_today_button","tab","tabs","specialTabs","tabName","find","firstTab","reverse","DataProcessorEvents","dp","$scheduler","$dp","_dataProcessorHandlers","_validId","setUpdated","z","_invalid","updatedRows","_waitMode","_update_callback","upd","setUserData","action_param","_add_rec_marker","DataProcessor","serverProcessorURL","serverProcessor","autoUpdate","_tMode","_headers","_payload","post_delim","messages","updated","inserted","deleted","invalid","invalid_cell","enableUTFencoding","eventable","boxAttribute","_dhx_msg_cfg","usercall","modalBox","modal_key","which","messageBox","keyboard","domHelpers","modality","cover","classValue","buttonAriaAttrs","messageButtonAttrString","getFirstDefined","_createBox","cancel","contentId","messageModalAttr","inner","content","message_ok","message_cancel","btn","getElementById","hidden","alertPopup","confirmPopup","boxPopup","box_params","params","focusable","messageInfoAttr","timers","pull","seed","hideAll","popups","alert","confirm","modalbox","setTransactionMode","total","payload","_tSend","_endnm","_serializeAsJson","_router","router","escape","_utf","setDataColumns","val","_columns","getSyncState","enableDataNames","enablePartialDataSend","_changed","master","rowId","state","findRow","existing","getUserData","set_invalid","is_invalid","markRow","_methods","details","getActionByState","checkBeforeUpdate","editStop","sendAllData","_beforeSendData","_getRowData","_sendData","_serializeAsJSON","serialize_one","stack","pref","_applyPayload","urlSeparator","dataToSend","self","queryParams","afterUpdate","urlParams","_user","_cleanupArgumentsBeforeSend","preprocessedData","_cleanupItemBeforeSend","query","_onResolvedCreateUpdate","tag","resultState","setRequestHeader","tid","afterUpdateCallback","routerMode","actionPromise","create","delete","update","valid","_forEachUpdatedRow","_getAllData","out","has_one","row","pattern","defineAction","_uActions","btag","marker","correct","originalSid","_errorResponse","cleanUpdate","_setDefaultTransactionMode","_serverProcessor","that","finalizeUpdate","atag","_initialized","_dp_init","_is_virtual_event","_set_event_text_style","cssText","event_updated","rec_pattern","_dp_change_event_id","_dp_hook_delete","setDp","dataProcessorEvents","_dataprocessor","setOnAfterUpdate","setOnBeforeUpdateHandler","func","setAutoUpdate","interval","user","_need_update","_update_busy","xml_node","afterAutoUpdate","fullSync","intervalId","loadUpdate","getUpdates","_getXmlNodeValue","version","vers","updates","destructor","processedData","updatedItem","output","item","processedItem","prop","formatDate","_prepareItemForJson","_prepareItemForForm","_prepareDataItem","dataItem","ar","day_tab","week_tab","month_tab","icon_save","icon_cancel","icon_details","icon_edit","confirm_closing","section_description","section_time","confirm_recurring","section_recurring","button_recurring","button_recurring_open","button_edit_series","button_edit_occurrence","button_edit_occurrence_and_following","grid_tab","prev","hour","minute","repeat_radio_day","repeat_radio_week","repeat_radio_month","repeat_radio_year","repeat_radio_day_type","repeat_text_day_count","repeat_radio_day_type2","repeat_week","repeat_text_week_count","repeat_radio_month_type","repeat_radio_month_start","repeat_text_month_day","repeat_text_month_count","repeat_text_month_count2_before","repeat_text_month_count2_after","repeat_year_label","select_year_day2","repeat_text_year_day","select_year_month","repeat_radio_end","repeat_text_occurrences_count","repeat_radio_end2","repeat_radio_end3","repeat_never","repeat_daily","repeat_workdays","repeat_weekly","repeat_monthly","repeat_yearly","repeat_custom","repeat_freq_day","repeat_freq_week","repeat_freq_month","repeat_freq_year","repeat_on_date","repeat_ends","month_for_recurring","day_for_recurring","be","agenda_tab","description","year_tab","week_agenda_tab","ca","cn","cs","da","de","en","es","fi","fr","he","hu","it","jp","LocaleManager","_locales","nb","nl","no","pl","pt","ro","ru","si","sk","sv","tr","ua","DatePicker","modes","currentRange","eventDates","filterDays","currentModeIndex","onStateChangeHandlers","_domEvents","onStateChange","oldState","newState","_notifyStateChange","direction","newDate","setFullYear","setState","_toggleMode","newIndex","backwardArrow","monthLabel","innerText","toLocaleString","startYear","forwardArrow","_adjustDate","_renderCalendarHeader","dataContainer","_renderDayGrid","_renderMonthGrid","_renderYearGrid","daysOfWeekContainer","currentDate","maxDate","labelFormat","dayElement","weeks","currWeek","minWeeks","minSchedulerDate","maxSchedulerDate","eventDaysTable","reduce","_renderDayGridHeader","weekLength","children","setProperty","firstDate","monthStart","monthEnd","lastDate","currentCalDate","_weeksBetween","dayGridContainer","dateCell","wrapper","months","formatLabel","monthElement","doneArea","doneBtn","yearElement","factoryMethod","extensionManager","stateProviders","internal","provider","unregisterProvider","stateProvider","commonViews","agenda","grid","week_agenda","anythingElse","requiredExtensions","_commonErrorMessages","unknownView","relatedExtension","collapsedContainer","createTimelineView","createUnitsView","createGridView","exportToPNG","exportToPDF","nav_bar","_detachDomEvent","_init_once","scheduler_resize_listener","hasSchedulerMarkup","wai_aria_application_role","views","_grid","log","_scroll","init_templates","set_sizes","min_event_height","scale_width","scale_height","month_scale_height","menu_width","margin_top","margin_left","editor_width","month_head_height","event_header_height","functor","scale_x","materialScalePlaceholder","set_xy","_data_width","prepareValue","prepared","class_name","attr_value","labelAttr","domEventsScope","getDaysDifference","startDate","endDate","differenceInDays","_select_id","_close_not_saved","previousSelection","editor_id","_edit_id","select_id","expanded","icon","def_step","dhx_cal_tab","deprecated_name","substring","edit","save","form","base","start_hour","_drag_event","details_on_dblclick","viewHandler","_get_column_index","x_pos","column","_week_indexes_from_pos","pos","ceil","_mouse_coords","$env","_colsS","dataArea","heights","_ignores_detected","preserve_length","_event_length","_get_real_event_length","x_step","x_unit","timestamp","confirmationText","title_confirm_closing","positive_closing","_correct_shift","_is_pos_changed","old_pos","new_pos","diff","old_val","new_val","has_moved","_correct_drag_start_date","_start_correction","_end_correction","_get_fictional_event_length","_correct_drag_end_date","mousedownPos","_get_date_from_pos","_drag_start","fields","timeStep","custom","_dragEventBody","_move_event_shift","resize_date","_drag_from_start","resize_from_start","tempEnd","end_day_start","end_day_date","firstHour","maxY","precisePos","minDate","preciseDate","new_end","new_start","limit_drag_out","all_timed","_get_section_view","_get_event_sday","tempBorderBottomDate","_allow_dnd","update_render","sx","update_view","drag_event_body","_get_private_properties","_clear_temporary_properties","clean","flagged_event","initial","current_state","moved","_dhx_changed","is_new","edit_on_create","details_on_create","_trigger_dyn_loading","_reset_ignores","_reset_scale","isViewExists","_set_aria_buttons_attrs","buttonGroups","group","headerButtonsAttributes","icon_form","oldClass","newClass","multidayScroll","dhx_multi_day","prev_scroll","preserve_scroll","_dy_shift","headerToggleState","_render_x_header","offset_top","left_border","columnHeaderText","dayHeaderAttr","_get_columns_num","count","count_n","_get_timeunit_start","_get_view_end","ed","_calc_scale_sizes","summ","_process_ignores","realcount","_set_scale_col_size","_render_scales","data_area","sd","today","scales","cls","firstHalf","slotDate","htmlContent","time_slot_text","time_slot_class","secondHalf","week_date_class","dayColumnAttr","_getNavDateElement","drag_resize","drag_move","navBarDateStr","scaleElement","navBarDateAttr","_reset_month_scale","_reset_hours_scale","multi_day","c1","totalWidth","col_length","hiddenWidth","c2","cc","hourScaleAttr","scroll_hour","now_date","preserve","ign_date","_render_month_scale","view_start","cd","tdwidths","cell_width","getCellHeight","cellheight","table","cell","month_date_class","body_class","head_class","monthCellAttr","cellHead","cellBody","bf1","getLabel","updateCollection","list_name","cache","n_ev","endColumnIndex","eventLength","startColumnIndex","last_column","check","excludedDuration","intervalStart","intervalEnd","leftCellCutOffStart","leftCellCutOffEnd","rightCellCutOffStart","rightCellCutOffEnd","ev_length","dir","per_day","end_slot","fd","start_slot","_get_section_property","_is_initialized","htmlTags","extraSpaces","stripHTMLLite","htmlText","singleQuotes","escapeQuotes","getAttributeString","setAttributes","role","getHeaderCellAttr","eventAttr","_eventCommonAttr","event_text","$dataprocessor_class","setEventBarAttr","_getAttributes","attributeSetter","arg","eventBarAttrString","agendaHeadAttrString","agendaHeadDateString","agendaHeadDescriptionString","agendaDataAttrString","agendaEventAttrString","agendaDetailsBtnString","gridAttrString","gridRowAttrString","gridCellAttrString","mapAttrString","mapRowAttrString","mapDetailsBtnString","minicalHeader","headerId","minicalGrid","minicalRow","minicalDayCell","selected","minicalHeadCell","weekAgendaDayCell","weekAgendaEvent","tabindex","yearHeader","yearGrid","yearHeadCell","yearRow","yearDayCell","buttonName","eventMenuAttrString","iconName","headerText","buttonLabel","quickInfoAttr","quickInfoHeaderAttrString","quickInfoHeader","quickInfoButtonAttrString","tooltipAttr","tooltipVisibleAttr","tooltipHiddenAttr","dom","assert","show_errors","_createDatePicker","_getFocusableNodes","_locate_css","messageApi","$","counter","clearAll","createConfig","async","serializeRequestParams","DOMParser","ActiveXObject","loadXML","parseFromString","tagname","xpathExp","docObj","selectNodes","ownerDocument","evaluate","XPathResult","ANY_TYPE","iterateNext","_call","onLoad","getSync","put","postData","del","post","postSync","XMLHttpRequest","isQt","readyState","filePath","open","toUpperCase","$ajax","default_date","month_date","load_date","week_date","date_format","api_date","day_column_padding","drag_create","resize_month_events","resize_month_timed","separate_short_events","cascade_event_count","cascade_event_margin","multi_day_height_limit","quick_info_detached","icons_edit","icons_select","highlight_displayed_event","ajax_error","delay_render","timeline_swap_resize","$initial","xml_date","d1","d2","day_scale_date","month_scale_date","week_scale_date","event_date","event_class","event_bar_date","month_events_link","drag_marker_class","drag_marker_content","tooltip_date_format","tooltip_text","calendar_month","calendar_scale_date","calendar_date","calendar_time","clear_view","extra_data","silent","hash","create_getter","create_setter","is_visible_events","clear_event","evFirstHour","evLastHour","lastHour","checkEndDate","get_visible_events","only_timed","filter_event","_is_main_area_event","hold","full","_recalculate_timed","tvs","tvd","_rendered_location","buffer","renderedLocation","_view_month_day","_render_month_link","toRender","_sday","_eday","curr","_sweek","_get_event_bar_pos","widt","x2","_pre_render_events","render_event_bar","max_evs","max_month_events","real","render_event","_get_first_visible_cell","hb","h_old","_pre_render_events_table","_pre_render_events_line","monthRows","cellHeight","cHeight","unshift","scrollHeight","scroll_fix","scale_settings","sum_width","row_heights","full_multi_day_height","used_multi_day_height","used_multi_day_height_css","multi_day_section","multi_day_icon","overflowY","datePart","_get_event_mapped_end_date","ev_duration","_min_mapped_duration","evs_originals","sh","eh","_inner","t_ev","slot_index","sorderSet","_is_sorder","_max_sorder","max_count","_copy_event","_time_order","_is_any_multiday_cell_visible","isAnyCellVisible","checkDate","noCells","lastDayEnd","weekCellIndex","chunks_info","first_chunk","last_chunk","chunk_info","locate_s","locate_e","_length","stack_line","_first_chunk","_last_chunk","_copy_dummy","_y_from_date","sm","_calc_event_y","min_height","em","parentWidth","menu","menu_offset","pos_y","ev_count","ev_sorder","margin","marginRight","_render_v_bar","_text_style","zIndex","color","tplClass","_editor","ariaAttr","icons","icons_str","currentIcon","textColor","highlightEventPosition","contentA","contentB","cse","boxWidth","renderEvent","inner_html","footer_class","_drag_resize","past","_get_dnd_order","ev_height","max_height","_orig_sorder","evTop","columns","y_event_offset","resize_handle","resizable","left_chunk","right_chunk","resize_left","resize_right","timed","bg_color","style_text","_beforeEventChangedFlag","getRenderedEvent","rendered_events","rendered_event","showEvent","original_color","original_text_color","getSectionTop","posFromDate","_smartRenderingEnabled","restoreOriginalColors","scrollTo","_append_drag_marker","m","scale","lastChild","_update_marker_position","getRootView","hooks","didInsert","cmp","skins","jQuery","fn","dhx_scheduler","each","Scheduler","getSchedulerInstance","comp","update_view_timer","curr_view_timer","lazy_setCurrentView","oldDate","oldMode","updateFlags","lazy_updateView","ars","createDataProcessor","tMode","dhtmlxError","catchError","i18n","addLocale","setLocale","localeObject","getLocale","dhx_save_btn","dhx_cancel_btn","dhx_delete_btn","addPlugins","activePlugins","plugins","extensionList","dependencies","priorities","extension","dep","dependencyName","orderA","orderB","treetimeline","daytimeline","outerdrag","legacy","plugin","getExtension","ExtensionsManager","_extensions","attaches","attachScheduler","_genStr","attachObject","vs","av","sched","schedId","setSizes","_viewRestore","_inited_multisection_copies","copies","_multisection_copies","eventCopies","_register_copies_array","_register_copy","_get_copied_event","event_id","parts","_orig_section","min_sorder","Infinity","_clear_copied_events","_restore_render_flags","section_evs","prev_state","externalDrag","from_scheduler","to_scheduler","drag_data","drag_placeholder","delete_dnd_holder","copy_event_node","clone","create_dnd_holder","holder","event_outside","move_dnd_holder","clear_scheduler_dnd","stop_drag","inject_into_scheduler","dom_event","event_length","start_dnd","drag_out","drag","orig_id","land_into_scheduler","drag_in","target_id","drag_from_scheduler","reset_event","move_permanently","original_event","moved_event","outerDragHandlerAttached","connectedSchedulers","processScheduler","target_scheduler","current_scheduler","nextScheduler","modals","modalsStack","isModal","afterPopup","trapFocus","currentTarget","$keyboardNavigation","_keyNavMessagePopup","focusElement","backupFocus","key_nav_legacy","_temp_key_scope","key_nav","_pasteDate","_pasteSection","isCopy","trackMousePosition","mousePointer","keyNavPointer","elementFromPoint","dispatcher","copyEvent","_make_pasted_event","multisection","isMultisectionEvent","_do_paste","is_copy","modified_ev","original_ev","_is_key_nav_active","ctrlKey","metaKey","_buffer_event","_key_nav_copy_paste","getActiveNode","new_ev","scheduler_handlers","attachSchedulerHandlers","waitCall","keyDownHandler","focusHandler","keepScrollPosition","focusGlobalNode","enable","reFocusActiveNode","activeNode","isValid","MinicalButton","MinicalCell","mousedownHandler","dataAreaClick","listOfScales","some","Event","TimeSlot","nextSlot","setActiveNode","removeAttribute","evNode","prevState","lastStart","lastEnd","lastSection","getNode","catches","func_name","throwError","GoogleMapAdapter","_markers","zoom","zoom_after_resolve","initial_zoom","lat","lng","setCenter","setZoom","error_position","google","maps","trigger","mapOptions","center","initial_position","mapId","scrollwheel","mapTypeId","Map","__gm","messageOverlay","outerContainer","setOptions","addListener","geocoder","Geocoder","point","latLng","geocode","results","GeocoderStatus","OK","geometry","event_location","formatted_address","clearInstanceListeners","addEventMarker","AdvancedMarkerElement","importLibrary","mapView","createMarker","setMap","infoWindow","InfoWindow","maxWidth","info_window_max_width","setContent","map_info_content","anchor","markerInfo","setVisible","setPosition","latlng","LatLng","latitude","longitude","resolveAddress","string","address","OpenStreetMapAdapter","openPopup","closeTooltip","setView","mapWrapper","L","tileLayer","addTo","country","myIcon","iconUrl","iconSize","shadowSize","iconAnchor","shadowAnchor","popupConfig","minWidth","markerPopup","popup","tooltip","markerConfig","bindPopup","bindTooltip","removeLayer","setLatLng","lon","MapboxAdapter","getPopup","isOpen","togglePopup","mapboxgl","accessToken","lngLat","features","place_name","Popup","focusAfterOpen","setMaxWidth","setHTML","Marker","setLngLat","setPopup","ALL_WEEKDAYS","Weekday","weekday","fromStr","nth","equals","other","getJsWeekday","isPresent","isNumber","isWeekdayStr","includes","rang","repeat","times","padStart","targetLength","padString","pymod","divmod","mod","empty","notEmpty","datetime","MONTH_DAYS","ONE_DAY","ORDINAL_BASE","PY_WEEKDAYS","isLeapYear","isValidDate","toOrdinal","date2","differencems","fromOrdinal","ordinal","getMonthDays","getWeekday","monthRange","combine","getMilliseconds","cloneDates","clones","timeToUntilString","untilStringToDate","until","bits","dateTZtoISO8601","timeZone","IterResult","_result","before","after","accept","tooEarly","tooLate","extendStatics","setPrototypeOf","__proto__","__extends","TypeError","__","__assign","assign","__spreadArray","pack","l","Frequency","CallbackIterResult","_super","iterator","_this","ENGLISH","dayNames","monthNames","tokens","SKIP","number","numberAsText","every","at","the","second","third","for","monday","tuesday","wednesday","thursday","friday","saturday","sunday","january","february","march","april","may","june","july","august","september","october","november","december","comma","defaultGetText","defaultDateFormatter","ToText","gettext","language","dateFormatter","origOptions","bymonthday","bynmonthday","byweekday","allWeeks","someWeeks","isWeekdays","isEveryDay","sortWeekDays","isFullyConvertible","freq","IMPLEMENTED","RRule","FREQUENCIES","plural","HOURLY","MINUTELY","DAILY","bymonth","_bymonth","_bymonthday","_byweekday","byhour","_byhour","WEEKLY","MONTHLY","YEARLY","byyearday","byweekno","weekdaytext","monthtext","npos","wday","finalDelim","delim","realCallback","delimiter","finalDelimiter","Parser","rules","done","nextSymbol","isDone","symbol","best","bestSymbol","name_1","acceptNumber","expect","parseText","ttr","AT","F","MO","TU","WE","TH","FR","ON","wkd","decodeWKD","decodeNTH","decodeM","S","freqIsDailyOrGreater","fromText","Time","millisecond","DateTime","fromDate","getYear","addYears","years","addMonths","yearDiv","monthMod","addWeekly","wkst","fixDay","addDaily","addHours","filtered","_a","dayDiv","hourMod","addMinutes","minutes","byminute","hourDiv","minuteMod","addSeconds","seconds","bysecond","minuteDiv","secondMod","daysinmonth","SECONDLY","initializeOptions","_i","keys_1","defaultKeys","parseOptions","DEFAULT_OPTIONS","byeaster","dtstart","bysetpos","bynweekday","parsedOptions","parseString","rfcString","parseLine","parseDtstart","line","dtstartWithZone","tzid","parseRrule","Days","parseIndividualNumber","optionKey","SyntaxError","wdaypart","DateWithZone","RangeError","defineProperty","enumerable","configurable","isUTC","rezonedDate","localTimeZone","Intl","DateTimeFormat","resolvedOptions","dateInLocalTZ","tzOffset","optionsToString","outValue","buildDtstart","strValues","ruleString","argsMatch","Cache","all","between","_cacheAdd","what","_value","_cacheGet","cached","argsKeys","findCacheDiff","cachedObject","iterResult","M365MASK","M366MASK","M28","M29","M30","M31","MDAY366MASK","MDAY365MASK","NM28","NM29","NM30","NM31","NMDAY366MASK","NMDAY365MASK","M366RANGE","M365RANGE","WDAYMASK","wdaymask","rebuildYear","firstwkst","wyearlen","firstyday","yearlen","nextyearlen","yearordinal","yearweekday","mmask","mdaymask","nmdaymask","mrange","wnomask","no1wkst","numweeks","lnumweeks","lyearweekday","lno1wkst","lyearlen","weekst","Iterinfo","rebuild","lastyear","yearinfo","lastmonth","monthinfo","nwdaymask","ranges","eastermask","g","yearStart","ydayset","mdayset","wdayset","ddayset","htimeset","mtimeset","stimeset","getdayset","gettimeset","buildPoslist","timeset","ii","dayset","poslist","daypos","timepos","tmp","iter","emitResult","counterDate","millisecondModulo","removeFilteredDays","rezoneIfNeeded","currentDay","isFiltered","dayCounter","SA","SU","noCache","_cache","fromString","_iter","toText","isFullyConvertibleToText","unfold","forceset","compatible","parseInput","rrulevals","rdatevals","exrulevals","exdatevals","parsedDtstart","lines","_b","sep","splits","parms","rdateTzid","parseRDate","rrulestr","rset_1","RRuleSet","groomRruleOptions","rdate","exrule","exdate","rdateval","parm","createGetterSetter","fieldName","field","_rrule","field_1","_rdate","_exrule","_exdate","_exdateHash","_accept","evalExdate","zonedDate","_addRule","_addDate","rrules","exrules","rdates","exdates","_dtstart","rdatesToString","rrs","rule","autoscroll","startPos","autoscrollInterval","_schedulerOuter","eventPos","viewport","availWidth","availHeight","posX","posY","_merge","range_x","range_y","speed_x","speed_y","need_scroll","started","boxSize","startCoord","scrollRange","evId","scrollHelperFactory","currentMode","minMax","maxMin","nMaxMin","detectScrollMode","demoElement","normalizeValue","scrollWidth","getMode","getScrollValue","maxScroll","setScrollValue","normalized","Tooltip","_scheduler","_tooltipNode","_root","_isLikeMouseEvent","_calculateTooltipPosition","_getViewPort","_getViewPortSize","tooltipNode","offsetX","tooltip_offset_x","offsetY","tooltip_offset_y","mouse","containerPos","scrollY","scrollX","$event_data","$event","TooltipManager","_listeners","_initDelayedFunctions","delayHide","watchableTarget","eventTarget","targetNode","doOnMouseEnter","onmouseenter","touch_tooltip","onmouseleave","onmousemove","listener","cloneDomEvent","delayShow","utils.default","show","tooltip_timeout","tooltip_hide_timeout","allExtensions","active_links","active_link_view","_active_link_click","s_d","do_wrapper","fullname","week_x","d_s","agenda_legacy","add_agenda_legacy","agenda_legacy_time","agenda_legacy_text","agenda_legacy_date","agenda_legacy_start","old_dblclick_dhx_cal_data","dblclick_dhx_cal_data","fill_agenda_tab","old_render_view_data","ev_class","agendaDetailsButtonAttr","agenda_time","agenda_text","_agendaScrollTop","agenda_area","dateElement","agenda_date","agenda_legacy_view","agenda_start","agenda_end","rowAttr","dateHeader","descriptionHeader","agenda_view","add_agenda","dayDateToStr","dayDowToStr","agenda_day","eventsInDays","anyEvents","ignore_agenda","renderDay","calendarEvent","selectedId","all_timed_month","allTimed","isMainAreaEvent","is_event_short","_safe_copy","proto","isPrototypeOf","old_prerender_events_line","old_prerender_events_table","prerender_events","ce","_virtual","isOvernightEvent","getNextDay","setDateTime","event_changed","re","redraw","next_day","old_get_visible_events","old_mode","old_date","oldUpdate","fullRedrawNeeded","collision","temp_section","_setTempSection","collision_limit","checkCollision","edited_ev","recurring_event_id","_check_sections_collision","evs_dates","getRecDates","tevs","concurrent","_pid_time","checked_mode","single","container_autoresize","month_day_min_height","min_grid_size","min_map_size","old_pre_render_event","active","total_height","multiday_height","evl","_h_fix","navHeight","headerHeight","checked_divs","updateContainterHeight","is_repaint","checked_div","maxHeight","year_y","cur_height","week_agenda_scale_height","eventsContainer","_gridView","y_unit","getSectionHeight","getScrollSize","callUpdate","conditionalUpdateContainerHeight","asyncRepaint","requestAnimationFrame","autosizeEnabled","$original_scroll_width","$original_section_autoheight","section_autoheight","cookie","getCookieName","_get_url_nav","urlNavigationPlugin","schedulerCookie","unescape","newMode","cookie_param","old_load","virtual_events_helpers","old_timeline","section_id","section_label","section_options","x_start","renderMatrix","_renderMatrix","refresh","oldCollision","_w_line_drag_from_start","old_mouse","move_delta","_move_delta","converted","_x_scroll","_y_scroll","pos_copy","_resolve_timeline_section","set_time_part","_timeline_drag_date","drag_event","dat","days_y","st_date","flag","ev_old","oldUpdateTimelineSection","_update_timeline_section","storedEv","oldRender","week_line_dates","old_get_evs","old_add_event_now","set_date_part","old_render_marked_timespan","copy_timeline_event","week_line_ev_date","multiday_chunks","chunk","get_next_day","set_resize_options","chunks","_w_start_date","_w_end_date","_no_resize_start","_no_resize_end","par","drag_between","_outer_drag","editors","cached_options","sectionHeight","resetCombo","_combo","DOMParent","combo","unload","DOMelem","dhx_globalImgPath","image_path","dhtmlXCombo","options_height","setOptionHeight","enableFilteringMode","filtering","script_path","selected_id","addOption","disable","selectOption","setComboValue","all_options","single_option","getIndexByValue","getSelectedValue","getSelectedText","vertical","radiobuttons","checked_value","isChecked","check_html","label_html","checkbox","unchecked_value","expand","fullscreen","toggleIcon","_position","_width","_height","_overflow","overflow","_maximize","collapse","directions","prev_margin","export_api","std","getElementSizes","sizes","dhtmlxAjax","dhx4","getTimeline","orientation","dpi","_export_html","_send_to_export","exportToICal","_serialize_plain","exportToExcel","_serialize_columns","_ajax_to_export","server","info","_plain_export_copy","$text","_create_hidden_form","submit","_hidden_export_form","_get_export_size","footer","A5","A4","A3","A2","A1","A0","dataX","cSize","parseFloat","initialSizes","smartRendering","smart_rendering","style_width","style_height","timeline_scrollable","timeline_smart_rendering","grid_view","sort_rules","int","getVal","_getObjName","_getViewName","objName","isValidSize","defPadding","initialWidth","paddingLeft","paddingRight","_selected_divs","field_name","selectEvent","unselectEvent","_fill_grid_tab","data_container","_gridScrollTop","_sort_marker","paging","set_full_view","dblclick_dhx_grid_area","dhx_cal_header","_old_header_click","_get_target_column","_toggle_sort_state","view_name","event_div","_unselectDiv","targ","originalTarget","_get_sort_state","_get_sort_value_for_column","draw_sort_marker","_get_column_node","sort_grid","_print_grid_header","_calcPadding","_getStyles","cell_style","valign","_get_sort_rule","sortRule","_print_event_row","_getCellContent","availStyles","ariaCellAttribute","widths","unsized_columns","avail_width","unsized_width","column_width","html_templates","getScope","scopes","minicalButton","minicalDate","SchedulerNode","DataArea","timeSlot","searchMap","key_nav_step","addShortcut","shortcut","scope","scopeObject","getShortcutHandler","commands","shortcuts","findHandler","removeShortcut","unbind","disp","setDefaultNode","_compose","createCommand","modifiers","alt","ctrl","meta","expr","getExpressions","words","getWords","command","commandKeys","specialKeys","charCodeAt","getCommandFromEvent","domEvent","altKey","printableKey","fromCharCode","getHashFromEvent","getHash","junctionChar","term","combinationChar","backspace","enter","esc","space","up","down","home","pageup","pagedown","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","EventHandler","_handlers","doAction","returnValue","bindAll","initKeys","nextItem","currentFocus","currentIndex","renderMultiple","currentStart","currentEnd","_modes","_getMode","renderVerticalMarker","renderTimelineMarker","renderYearMarker","renderMonthMarker","weekAgenda","renderWeekAgendaMarker","renderAgendaMarker","dayColumns","addWaiAriaLabel","addDataAttributes","dateToStr","dateTimeLabel","sectionObject","markerDate","_wrapDiv","_get_year_cell","opacity","view_opts","_is_column_visible","start_pos","end_pos","tempStart","_timeline_getX","_section_height","_isRender","renderMonthCell","weekNumber","dayIndex","datatable","lineHeight","getDefaultNode","blur","_compareEvents","_pickEvent","startId","nextEventHandler","nextEvent","currEvent","visibleDates","nextEv","prevEventHandler","HeaderCell","getNodes","KeyNavNode","moveTo","compareTo","canStringifyThis","canStringifyThat","defaultCell","_getSection","_getNodes","defaultElement","isScrolledIntoView","eventBox","viewPort","idSelector","inlineEditor","getInlineEditor","_moveToSlot","slot","movingDate","getDefaultDate","_getDefaultSection","visibleTime","nowTime","showNowTime","findVisibleColumn","timeslot","_getMultisectionView","_getNextSection","nextIndex","defaultSlot","addMonthDate","nextMonthSlot","_alignTimeSlot","nextTimelineSlot","newPos","nextUnitsSlot","optionsCount","nextDaySlot","_moveDate","isBeforeLastHour","isStartDate","isAfterFirstHour","isInVisibleDayTime","oldStart","toNextDay","testEnd","nextWeekAgendaSlot","nextAgendaSlot","isDateVisible","nextDateColumn","current","tempSlot","extendSlot","extendUnitsSlot","extendTimelineSlot","extendMonthSlot","extendDaySlot","extendWeekAgendaSlot","extendGenericSlot","allowedDirections","moveDate","newDates","extendSlotDates","oldSlot","newSlot","dateDirection","scrollSlot","globalNode","_getGrid","_getNode","enabled","newRow","newCol","blurNode","editor","defaultPrevented","schedulerNode","_timeout","_minicalendars","isMinical","minicalendars","patchMinicalendar","focusMinical","minicalClick","rowIndex","cellIndex","td","renderMinical","cal","added","destroyMinical","_def_count","attachOnce","isSchedulerSelected","changeState","layer","layers","validId","_clearUpdateFlag","_cloneObj","_dataprocessors","_layers_zindex","initial_layer_zindex","isDefault","defaultLayer","showLayer","tlayer","toggleLayer","hideLayer","visible","getLayer","layer_name","native_event_object","noMenu","_evs_layer","_t_render_view_data","evs_layer","borderBox","borderBoxWidth","headerWidth","bodyWidth","footerWidth","bodyHeight","new_zIndex","filter_agenda","dtmlXMLLoaderObject","funcObject","dhtmlObject","rSeed","onloadAction","mainObject","dhtmlDragAndDropObject","dhtmlDragAndDrop","lastLanding","dragNode","dragStartNode","dragStartObject","tempDOMU","tempDOMM","waitDrag","extend_api","_init","_patch","waitLoadFunction","getXMLTopNode","oldObj","_retry","_isIE","loadXMLString","xmlString","onreadystatechange","postMode","postVars","rpc","_filterXPath","_getAllNamedChilds","doXPath","doXPathOpera","doXSLTransToObject","doXSLTransToString","doSerialization","xmlNodeToJSON","setXSLParamValue","removeDraggableItem","htmlNode","onmousedown","dragStarter","dragLanding","addDraggableItem","preCreateDragCopy","addDragLanding","onmouseup","stopDrag","callDrag","downtime","dragger","_createDragNode","onselectstart","gldragNode","pWindow","initFrameRoute","grd","oldBody","_dragOut","outerHTML","fx","fy","checkLanding","calculateFramePosition","frames","frameElement","ls","_dragIn","lastLanding_scr","_onNotFound","stopFrameRoute","_drag","win","_isFF","_FFrv","_isKHTML","appName","appVersion","compatMode","namespace","result_type","selectSingleNode","nodeObj","retType","FIRST_ORDERED_NODE_TYPE","rowsCol","singleNodeValue","thisColMemb","dhtmlxErrorConstructor","dhtmlxEvent","xslDoc","paramName","paramValue","transformNodeToObject","transformNode","XSLProcessor","XSLTProcessor","importStylesheet","transformToDocument","XMLSerializer","serializeToString","dhtmlxEventable","catcher","callObj","eventCatcher","arg0","dhx_catch","zr","limit_view","_temp_limit_scope","om","od","nm","nd","isBlocked","date_end","resetDate","is_new_event","data_copy","native_object","_mark_now_timer","map_view","mapAdapter","eventHandlerIds","adapters","googleMap","openStreetMaps","mapbox","setupMapView","createAdapter","unmodifiedEvent","_eventLocationChanged","map_settings","resolve_event_location","_latLngUpdate","addEventWithLocation","updateEventMarker","newIdEvent","removeEventMarker","onEventClick","coordinates","map_view_provider","currentAdapter","resolve_user_location","view_provider","map_initial_position","map_error_position","map_date_width","map_icon_width","map_description_width","add_map","map_date","map_time","map_text","map_start","dblclick_dhx_map_area","map_initial_zoom","map_zoom_after_resolve","map_infowindow_max_width","map_resolve_user_location","map_type","map_resolve_event_location","fill_map_tab","_selected_event_id","ariaButtonAttr","clearEventMarkers","map_end","mapContainer","adapter","elem_id","marginTop","destroy","initialize","geolocation","getCurrentPosition","coords","_updateEventLocation","_event_resolve_delay","ret","minical","minicalDomEvents","minicalendar","mark_events","_synced_minicalendars","_prev","is_refresh","_render_calendar","unmarkCalendar","cont","tpos","_get_def_cont","$dom","dateAttribute","markCalendar","_last_date","conf","onDateClick","onDateMouseOver","markedDates","_markCalendarCurrentDate","sync","_on_xle_handler","updateCalendar","_created","_locateCalendar","weekNum","dayCell","_week_template","week_template","dummy_date","onBeforeMonthChange","onMonthChange","_mini_cal_arrows","previous","ts","temp2","temp3","temp4","temp5","temp6","temp7","temp8","padding","weekHeader","move_minicalendar_date","css_classnames","css_texts","diffs","calendars","arrow","dayHeaders","dayCells","inputs","selects","inp","new_date","_update_minical_select","isFulldayEvent","_attach_action","_round_minutes","linkCalendar","datediff","dateNew","month_end","monthheight","old_s","multisection_shift_all","old_unit","_update_unit_section","_update_sections","_get_multisection_view","_get_event_sections","_parse_event_sections","_split_events","pr","_split_one_event","mapping","vis_evs","_rendered_events","old_view_data","def_handler","new_sections","shifted","new_section","_shift_sections","orig_section","orig_order","new_unit","old_get_blocked_zones","old_check_secions_collision","a_ind","a_len","b_ind","b_len","multiselect","_children","_mark_inputs","_ids","script_url","divLoading","multisource","mvc","update_timer","use_id","sanitize","_finish_ext_load","_get_id","model","cid","backbone","toJSON","changes","queue","add_from_queue","Backbone","Collection","last_event","on_drop","sourceHtmlObject","targetHtmlObject","targetHtml","action_data","event_data","view_options","_locate_cell_timeline","shtmlObject","DragControl","addDrop","onDrop","sourceDhtmlx","getMaster","onDragIn","pdf","html_regexp","newline_regexp","clean_html","x_norm","colsWidth","x_norm_event","is_left","y_norm","get_style","de_day","de_week","xml_end","xml_top","profile","xml_body_header","dhx_cal_date","xh","xml_month_scale","xml_month","yh","xhs","second_scale","top_width","top_col","xml_body","colors","week_starts","_month","text_color","zx","zdx","left_norm","zy","zdy","e_type","dets","week","dy_copy","toXML","original_date","original_mode","temp_date","to_pdf","objects","getPDFData","toPDF","toPDFRange","quick_info","show_quick_info","clickedElementPosition","fitQIInsideWindow","quickInfoPopup","popupRect","offsetBottom","getPositionInsideScheduler","_$quickInfoHandler","eventElement","showQuickInfo","hiding_function","hideQuickInfo","quick_info_title","quick_info_content","quick_info_date","_quick_info_box_id","_get_event_counter_part","_quick_info_box","_init_quick_info","_fill_quick_data","_show_quick_info","cssTimeToMs","milliseconds","forced","qi","dataPos","ontransitionend","_quick_info_onscroll_handler","$testmode","_qi_button_click","main","mainContent","originalRecurringSetValue","original_left_buttons","original_right_buttons","txt_replace","txts","txtt","readonly_form","forbidden_buttons","button_arrays","forbidden_button","button_array","originalForm","readonlyForm","_lightbox_r","clearMilliseconds","isSeries","toUTCDate","updateFollowingEventsRRULE","parsedRRule","toIcalString","newRRULE","updateFollowingWithWEEKLY","rruleStringparts","updatedRRULE","splited","old_add_event","setPropsForFirstOccurrence","occurrence","_isExceptionFirstOccurrence","_start_date","_modified","_firstOccurrence","setPropsForStorageEvent","tempEvent","targetIndex","deleteExceptionFromStorage","exception","updateTextEvents","tev","deleteEventFromSeries","idTimestamp","originalStartTimestamp","nid","nev","removeTempDraggedEvent","showModalbox","callbacks","selectedOption","groupExceptions","exceptions","_isFollowing","_isFirstOccurrence","pid","_is_modified_occurrence","recEvent","_rec_temp","_rec_markers_pull","_rec_markers","_get_rec_marker","ch","ev_id","_ignore_call","_pid_changed","sub","_showRequiredModalBox","isEventFound","tempDataRRULE","_shorten_end_date","_shorten","followingEv","_ocr","showLightbox_rec","formSetting","lightbox_recurring","isVirtual","showRequiredLightbox","originalStart","tempStartDate","tempEndDate","btnAll","initialOccurrence","btnFollowing","btnOccurrence","get_visible_events_rec","repeat_date","existingItem","old_update_event","getWeekdayOfMonth","dayOfWeek","dayOfMonth","dayNumber","non_render","maxCount","seriesExceptions","utcStart","repeatedDates","adjustedDate","visibleCount","eventDuration","_fix_daylight_saving_date","recurrings","sev","include_end_by","recurring_workdays","jsDaysToRRULEDays","RruleDayNumsToJs","fillIntervalInput","intervalInput","formatDayNumber","repeat_monthly_date","repeat_monthly_weekday","nthDayOfMonth","repeat_yearly_month_date","repeat_yearly_month_weekday","getRecValue","WORKDAYS","CUSTOM","monthRepeat","yearRepeat","formatFunc","endRule","NEVER","fillInDefaults","dayNum","dayLabel","dateOfMonth","nthWeekDayOfMonth","dateOfYear","nthWeekDayOfYear","countInput","ondateInput","endOptionSelect","formatter","repeat_date_of_end","dispatchEvent","getFirstSectionOfType","_get_node","_outer_html","rec","loc","_init_set_value","_ds","repeatSelect","customRepeatUnitInput","weekly","monthly","yearly","customRepeatEndInput","_rec_init_done","rf","blocked","rruleset","topOption","rruleObj","untilDate","customFreq","actual_dates","timeControl","recurrence","_start","recurring_legacy","getRecurringSection","occurrence_timestamp_in_utc","repeat_text_occurences_count","_get_form_node","_get_node_value","_get_node_numeric_value","_set_node_value","hash_value","str_date_format","date_str","register_els","inps","change_current_view","set_end_rule","_get_repeat_code","get_rcode","str_date","transpose_type","get_numeric_value","repeat_precise","start_exists","transpose_day_week","set_rcode","_set_repeat_code","MouseEvent","elements","_is_modified_occurence","_toggle_block","getTimeSection","_get_button","_get_form","backgroundPosition","showSeries","title_confirm_recurring","transponse_size","day_week","originalMonth","newMonth","cor","cor2","cday","transposeRecurring","recurringParts","addRecurring","recurringStepDays","weekDays","seriesInstance","currentCount","origMonth","origYear","correctOverflowInstances","recurring_overflow_instances","startHour","ted","data_attributes","all_events","_serialize_json_value","toICal","full_day_format","getScrollbarwidth","outer","w1","w2","renderCells","contentTemplate","baseClass","$width","renderHeading","renderColumns","scrollPosition","scrollDate","posLeft","labelWrapperHeight","scalesHeight","_label_rows","scrollHelper","dataWrapperDiv","getScrollPosition","dateFromPos","sectionFromPos","resolvePosition","_rowStats","getEventTop","eventHeight","getEventHeight","sorder","event_dy","sectionIndex","_timeline_get_cur_row_stats","resize_events","event_min_dy","_temp_matrix_scope","getChildrenIds","getSectionIndex","iterateSectionsTree","prepareCellMatrix","sectionsSearch","y_unit_original","fillFolders","fillXArray","xFrom","xTo","$tree","sectionProperty","sectionKey","scaleIndexStart","scaleIndexEnd","$parent","traversed","_is_new_view","_section_autowidth","_h_cols","y_step","x_size","y_start","y_size","x_date","fit_events","fit_events_offset","show_unassigned","_logic","render_name","_original_x_start","render_timeline_event","folder_events_available","allocatedWidth","flexibleColumns","modifyContainerWidth","freeWidth","columnsLeft","datea","dateb","defautDateFormat","defaultFormatter","SecondScaleDateFormat","defautSecondScaleFormatter","scroll_step","resulting_date","x_length","converted_step","total_steps","steps_offset","start_offset","new_offset","_timeline_smart_render","getViewPort","_sch_height","scrollableDataContainer","selectEvents","selectSubsections","selectNested","getPreparedEvents","columnEvents","nestedEvents","$matrix","subsections","sectionEvents","setRange","scaleStartDate","_set_timeline_dates","force_redraw","current_back_shift","_timeline_get_rounded_date","_resize_from_start","pos_changed","_prepare_timeline_events","_timeline_trace_events","tev_section","_populate_timeline_rendered","_rendered_events_cache","smartRenderCache","x_end","event_height","_get_timeline_event_height","coefficient","_get_timeline_event_y","section_height","_events_height","_no_drag_move","dhx_event_resize","hb_local","resize_start","resize_end","parentSection","escapeForAttribute","sectionHasCustomHeight","timelineCellDateAttribute","cellDate","getScrollableContainer","getColumnLabelContainer","isEndPoint","_step","column_offset","_min_date_timeline","column_date","isEndDate","_timeline_skip_ignored","_timeline_calculate_event_positions","evs_length","maxOrder","maxOrderEvent","ev_start_date","_timeline_get_events_html","_timeline_update_events_html","_timeline_get_block_stats","stats","style_data_wrapper","style_label_wrapper","html_scroll_width","custom_scroll_width","rowBaseSizes","defaultHeight","totalHeight","rowsWithDefaultHeight","totalCustomHeight","heightWithoutScroll","td_className","cssTemplate","td_content","tr_className","summ_width","_summ","table_className","_timeline_get_fit_events_stats","rendered_height","style_line_height","_timeline_set_scroll_pos","_timeline_save_scroll_pos","_timeline_get_html_for_cell_data_row","top_pos","templateParams","_timeline_get_html_for_cell_ignores","_timeline_get_html_for_cell","x_ind","y_ind","cellLeftPos","cellSection","cellWidth","cellDateString","_timeline_get_html_for_bar_matrix_line","_timeline_get_html_for_bar_data_row","_timeline_get_html_for_bar_ignores","_timeline_get_html_for_bar","cell_template","cellInner","_timeline_render_scale_header","headerAreaClass","_timeline_y_scale","block_stats","scrollableData","labelWrapper","dataWrapper","clearPreparedEventsCache","cachePreparedEvents","render_stats","_render_stats","skipRenderCells","_rendered_labels_cache","smartRender","sectionsInfo","eventsBySections","rowStats","rowStatsByKey","totalRowsHeight","cellTopPos","labelRow","isInYViewPort","colIndex","isInXViewPort","printableEvents","getVisibleEventsForRow","_matrix","sectionRows","divBySectionId","_divBySectionId","unit_key","_timeline_finalize_section_add","_is_ev_creating","labelWrapperDiv","$eventsAttached","prevLabelAction","onMouseWheel","scrollPositionChanged","ff","deltaX","wheelDeltaX","deltaY","wheelDelta","multiplier","deltaMode","wheelSpeed","wx","wy","prevScrollLeft","detail","prevScrollTop","dataWrapperDivOnScroll","colLabelDiv","updateHeader","_options_changed","updateLabels","updateGridCols","updateGridRows","asyncScroll","cancelAnimationFrame","updateEvents","dataColHeight","newTop","newLeft","prevAction","absoluteDx","absoluteDy","totalDistance","sqrt","scroll_position","sectionDiv","_timeline_x_dates","display_count","total_count","displayed","_timeline_x_scale","timelineContainerWidth","current_sh","original_sh","_header_resized","preserve_scale_length","summ_fixed","control_dates","second_cols","second_left","t_index","_timeline_is_new_interval","scs","clnLastChild","trace","$_clickEventsAttached","_timeline_locate_hcell","control_date","_timeline_reset_scale_height","_timeline_set_full_view","_init_matrix_tooltip","curHeader","getVisibleHeader","_timeline_hideToolTip","_tooltip","_timeline_showToolTip","mark","_matrix_tooltip_handler","_timeline_html_index","nodeIndex","resIndex","ign","xNonIgnoredInd","xind","firstCellXind","firstCell","fc_pos_x","isScale","scaleTarget","old_click","dhx_marked_timespan","dblclick_dhx_matrix_cell","old_dblclick_marked_timespan","dblclick_dhx_matrix_scell","event_options","start_ind","specific_date","old_append_mark_now","n_date","oldTimespans","on_scale_marker_add","z_config","yind","line_height","trace_x","searchFrom","searchTo","dateValue","middle","pos_x","ratio","edge","timestamp_diff","_prepared_events_cache","_rendered_header_cache","_rows_to_delete","_rows_to_add","_cols_to_delete","_cols_to_add","resizeHeight","scrollBlock","scrollableContainer","viewPortLeft","viewPortRight","viewPortTop","viewPortBottom","visibleItems","renderers","itemsToDel","_deleteHeaderCells","_addHeaderCells","getVisibleLabels","curLabelCol","_deleteLabelCells","_addLabelCells","_prepared_events_coordinate_cache","dragId","stop","found","currentSectionId","eventIndex","actualEventSectionIndex","$coordinates","renderedEvents","willAdd","eventsToAdd","visibleRowEvents","lenRend","draggableEvent","multievs","_deleteEvents","addEntry","_addEvents","rowEvents","events_html","evsInViewport","evLen","xStart","xEnd","coordinateCacheKey","getVisibleRowCellsHTML","visibleColumns","getVisibleTimelineRowsHTML","cachedRow","_deleteGridRows","_addGridRows","visibleHeaderColumns","visibleHeaderColumnsHash","allCells","renderedCells","colId","shouldDelete","shouldRender","_addGridCols","getVisibleGridCell","tooltipManager","tooltips","tooltipFor","targetEventId","hideTooltip","section_id_before","_getArrayToDisplay","_getArrayForSelect","temp_select","temp_option","div_expand","paddingValue","folder_dy","levelPadding","level","event_object","native_event","ev_sections","getSection","fillResultArray","lvl","skip","_toggleFolderDisplay","all_sections","toggleElement","findElement","deleteSection","deleteElement","deleteAllSections","addSection","parent_id","addElement","parent_key","openAllSections","closeAllSections","openSection","closeSection","skip_incorrect","getDateIndex","_original_size","unit_view","original_position","date_position","dateIndex","realDate","availSize","section_ind","unit_ind","headerResized","revertHeaderSize","scrollUnit","_removeIncorrectEvents","correct_events","old_pre_render_events_table","old_pre_render_events_line","fix_und","oldive","old_process_ignores","sectionsCount","sectionEnd","today_start","today_end","headerWrapper","s_left","s_width","_get_section_sday","prerender","currentHeights","schedulerHeights","s2d","d2s","select_event","scale_date_format","_wa","week_agenda_event_text","week_agenda_start","week_agenda_end","add_week_agenda","week_agenda_date","week_agenda_scale_date","week_agenda_view","dayDivs","tstart","tend","scale_bar","events_div","ev_div","week_agenda_select","mouse_week_agenda","dayCont","_dnd","dnd_div","wp","year_view","year_date","year_month","year_scale_date","year_tooltip","isYearMode","getCellDate","dblclick_dhx_year_grid","_year_render_event","_year_marked_cells","_hideToolTip","_showToolTip","_year_view_tooltip_handler","_init_year_tooltip","_mark_year_date","_unmark_year_date","_reset_year_scale","yearBox","datepicker","ignore_year","locateEvent","factory","extensions","_schedulerPlugins","_bundledExtensions","_extensionsManager","initConfig","_internal_id","$syncFactory","_initFromConfig","addCalendar","$dhx"],"mappings":";;;;;;;;;AAUA,MAAAA,WAPUC,SAAW,MACNA,SAEAC;ACNA,SAASC,GAAiBC;AACrC,MAAIC,IAAa,IACbC,IAAc,IACdC,IAAY,MACZC,IAAQ;AAEZ,WAASC,IAAAA;AACL,WAAOL,EAAUM,OAAOC,kBAAkBP,EAAUQ;AAAAA,EACvD;AAED,WAASC,EAAcC,GAAAA;AACnB,UAAMC,IAAUX,EAAUY,QAAQF,CAAAA;AAClC,WAAGC,IACQA,EAAQE,SAEZH;AAAAA,EACV;AA4BD,WAASI,EAAmBC;AACxB,UAAMX,EAAAA,OAAEA,GAAKS,QAAEA,GAAMH,UAAEA,GAAQM,WAAEA,GAASb,WAAEA,EAAcY,IAAAA;AAAAA,KAjB9D,SAAmCZ,GAAWU,GAAAA;AAC1C,cAAQA,GAAAA;AAAAA,QACJ,KAAK;AACDV,UAAAA,EAAUc,MAAMC,MAAM,IACtBf,EAAUc,MAAME,OAAO;AACvB;AAAA,QACJ,KAAK;AACDhB,UAAAA,EAAUc,MAAME,OAAO,IACvBhB,EAAUc,MAAMG,aAAa;AAC7B;AAAA,QACJ;AACIjB,UAAAA,EAAUc,MAAMC,MAAM;AAAA,MAGjC;AAAA,IAAA,GAI6Bf,GAAWU,CAAAA;AACrC,UAAMQ,IAAW,CAAA;AACjB,QAAIC,IAAe,EACfC,YAAYnB,EAAMmB,YAClBC,UAAUpB,EAAMoB,UAChBC,KAAK,4BACLC,MAAMvB;AAGV,QAAIU,KAAU,YAAY;AACtB,YAAMF,IAAUX,EAAUY,QAAQF;AAClC,UAAIC,EAAQgB,gBAAgB;AACxB,cAAMC,IAAQ5B,EAAU6B,gBAAgBlB,GAAQP,EAAMmB,UAChDO,GAAAA,IAAenB,EAAQoB,SAASH,CAAAA;AACtCN,QAAAA,EAAaC,aAAaO;AAAAA,MAC7B;AAAA,IACJ;AASD,WARIjB,KAAU,cAAcA,KAAU,YAElCS,IAAe,EAAIA,GAAAA,GAAcE,UAAUxB,EAAUgC,KAAKC,IAAI7B,EAAMmB,YAAY,GAAG,cAEnFP,MACAK,EAASX,KAAYM,GACrBM,EAAaD,WAAWA,IAErBC;AAAAA,EACV;AAED,WAASY,EAAiBC,GAAAA;AACtB,YAAMtB,QAAEA,EAAAA,IAAWsB;AACnB,QAAIC;AACJ,YAAQvB,GACJ;AAAA,MAAA,KAAK;AACDuB,QAAAA,IAsCZ,SAA6BD,GAAAA;AACzB,cAAIE,IAAwB,CAAA;AAC5B,kBAAMjC,OAACA,GAAKS,QAAEA,GAAMH,UAAEA,GAAQM,WAAEA,EAAamB,IAAAA,GACvCG,IAAY,CAClB;AAAA,cAAIC,IAAW,IAAIC,KAAKpC,EAAMmB,UAC9B;AAAA,iBAAMgB,EAASE,QAAAA,IAAYrC,EAAMoB,SAASiB,aAAU;AAChD,gBAAIC,IAAM,EAACnB,YAAYgB;AACvBD,YAAAA,EAAUK,KAAKD,IACfH,IAAWvC,EAAUgC,KAAKY,WAAW5C,EAAUgC,KAAKC,IAAIM,GAAU,GAAG,MACxE,CAAA;AAAA,UAAA;AACD,cAAIM,IAAQ7C,EAAU8C,WAAWC,iBAAiB,IAAI/C,EAAUM,OAAO0C,eAAoB5C,KAAAA,EAAM6C;AACjG,mBAASC,IAAI,GAAGA,IAAIL,EAAMM,QAAQD,KAAK;AACnC,kBAAMnC,IAAiB,EACnBX,OAAOkC,EAAUY,CAAAA,GACjBrC,QACAH,GAAAA,UAAAA,GACAM,WACAb,GAAAA,WAAW0C,EAAMK,CAAGE,EAAAA,UAAAA;AAExBf,YAAAA,EAAsBM,KAAK7B,EAAmBC,CACjD,CAAA;AAAA,UAAA;AACD,iBAAOsB;AAAAA,QACV,EA5D+CF;AACpC;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AACDC,QAAAA,IA0DZ,SAAwCD,GAAAA;AACpC,cAAIkB,IAAmB,CACvB;AAAA,gBAAA,EAAMjD,OAACA,GAAKS,QAAEA,GAAMH,UAAEA,GAAQP,WAAEA,EAAagC,IAAAA;AAC7C,cAAImB,IA9HR,SAAkC5C,GAAAA;AAC9B,kBAAMC,IAAUX,EAAUY,QAAQF,CAClC;AAAA,mBAAGC,EAAQ4C,aACA5C,EAAQ4C,aAEhB5C,EAAQ6C,SACA7C,EAAQ6C;UAEtB,EAsHsD9C,CACnD;AAAA,cAAI4C,GAAoB;AACpB,kBACMG,IADWC,OAAOtD,EAAMkD,CAAAA,CAAAA,EAAsBK,MAAM3D,EAAUM,OAAOsD,mBACzCC,IAAIC,CAAAA,MAAWJ,OAAOI,CAClDC,CAAAA,GAAAA,IAAQ,CACd;AAAA,qBAASb,IAAI,GAAGA,IAAIO,EAAiBN,QAAQD,KAAK;AAC9Ca,cAAAA,EAAMb,CAAK/C,IAAAA,EAAUiD,UAAU,EAAA;AAC/B,oBAAMrC,IAAiB,EACnBX,OACAS,GAAAA,QAAAA,GACAH,aACAM,WAAWyC,EAAiBP,IAC5B/C,WAAW4D,EAAMb,CAErBG,EAAAA;AAAAA,cAAAA,EAAiBV,KAAK7B,EAAmBC;YAC5C;AAAA,UACJ;AACD,iBAAOsC;AAAAA,QACV,EA/E0DlB,CAC/C;AAAA;AAAA,MACJ;AACIC,QAAAA,IAQZ,SAA8BD,GAAAA;AAC1B,kBAAM/B,OAACA,GAAKS,QAAEA,GAAMH,UAAEA,GAAQM,WAAEA,EAAAA,IAAamB;AAC7C,cAAI6B,IAAyB,CAAA,GACrBC,IAAajE,EAAU8C,WAAWC,iBAAiB,IAAI/C,EAAUM,OAAO0C,eAAoB5C,KAAAA,EAAM6C,EACtG,oDAAA;AAAA,cAAGgB;AACC,qBAASf,IAAI,GAAGA,IAAIe,EAAWd,QAAQD,KAAK;AACxC,kBAAIgB,IAAiBD,EAAWf,CAAGE,EAAAA,UAAAA;AAInC,oBAAMrC,IAAiB,EACnBX,OAFQ,EAACmB,YAFG,oBAAIiB,KAAAA,CAAM0B,EAAeC,aAAa,gBAAA,CAAA,GAElB3C,UADtB,oBAAIgB,KAAAA,CAAM0B,EAAeC,aAAa,cAAA,CAAA,EAAA,GAIhDtD,WACAH,UACAM,GAAAA,WAAAA,GACAb,WAAU+D,EAAAA;AAEdF,cAAAA,EAAuBrB,KAAK7B,EAAmBC,CAClD,CAAA;AAAA,YAAA;AAET,iBAAOiD;AAAAA,QACV,EA7BgD7B,CAG7CC;AAAAA,IAAAA;AAAAA,IAAAA,EAAcgC,QAASC,CAAAA,MAAAA;AACnBpE,MAAAA,EAAW0C,KAAK3C,EAAUQ,aAAa6D,CAAAA,CAAAA;AAAAA,IAAK;EAEnD;AAwEDrE,IAAUsE,YAAY,gBAAgB,SAAUrB,GAAIsB,GAAMC,GACtD;AAAA,WAAInE,QACAH,IAAAA,IACAE,IAAQJ,EAAUyE,SAASxB,CAC3B9C,GAAAA,IAAYqE,EAAEE,OAAOC,QAAQ,IAAI3E,EAAUM,OAAO0C,eAAAA,GAAAA,GAEnCvC,EADET,EAAU4E,WAAWL,IAGbvE,KAAX,WAAWA,EAAUM,OAAOuE,0BACtC7E,EAAU8E,SAAS7B,IACnB9C,IAAYqE,EAAEE,OAAOC,QAAQ,IAAI3E,EAAUM,OAAO0C,eAAAA,GAAAA,KAG1D;AAAA,EACR,CAAA,GAEIhD,EAAUsE,YAAY,eAAe,SAAUrB,GAAIsB,GAAMC;AACrD,QAAGtE,KAAeG,EAAY,GAAA;AAC1BH,MAAAA,IAAc;AACd,YAAMQ,IAAWV,EAAU4E,WAAWL,MAChC1D,IAASJ,EAAcC,CACvBM,GAAAA,IAAYhB,EAAU+E,cAAcP,CAAGQ,EAAAA;AAC7C,MAAI5E,KAQA8B,EAPiB,EACb9B,OAAAA,GACAS,WACAH,UACAM,GAAAA,WAAAA,GACAb,WAGP8E,EAAA,CAAA;AAAA,IACJ;AAAA,EACT,CAAA,GAEIjF,EAAUsE,YAAY,aAAa,SAASrB,GAAIsB,GAAMC;AAClD,aAAStB,IAAI,GAAGA,IAAIjD,EAAWkD,QAAQD;AACnClD,QAAUkF,eAAejF,EAAWiD,CAAAA,CAAAA;AAExCjD,IAAAA,IAAa,CACbE,GAAAA,IAAY,MACZC,IAAQ;AAAA,EAChB,CAAA;AACA;AC/Me,SAAS+E,GAAYnF;AAGnCA,IAAUM,OAAO8E,eACjBpF,EAAUM,OAAO+E,2BAAAA,IACjBrF,EAAUM,OAAOgF,6BAA6B;AAG9C,MAAIC,IAAiB,kBACjBC,IAAwB,WAWxBC,IAAwB,SAASC,GAAMC,GAAOtE,GAAAA;AACjD,QAAIuE,IAA0B,OAARF,KAAQ,WAAYA,IAAO,EAAEA,MAAMA,EAQzD;AAAA,WAPAE,EAAQC,OAAON,GACfK,EAAQnE,MAAM,IACVkE,MACCtE,MACHuE,EAAQvE,WAAWA,IACpBuE,IAjBgB,SAASA,GAASF,GAAMC,GAQzC;AAAA,aAPID,aAAgBlD,QAAQmD,aAAiBnD,QAC5CoD,EAAQrE,aAAamE,GACrBE,EAAQpE,WAAWmE,MAEnBC,EAAQF,OAAOA,GACfE,EAAQD,QAAQA,IAEVC;AAAAA,IACT,EAQyBA,GAASF,GAAMC,CAE/BC,IAAAA;AAAAA,EACT;AAgJC,WAASE,EAASC,GAAIC,GAAWC,GAAWC,GAAWC,GAAAA;AACtD,QAAIC,IAAIpG,GAEJ2F,IAAQ,CAAA,GACRU,IAAa,EAChBC,QAAS,UACTC,QAAS;AAEV,aAAQC,KAAaH,GAAW;AAC/B,UAAII,IAAWJ,EAAWG,CAAAA;AAC1B,UAAGJ,EAAEI,CAAAA;AACJ,iBAAQE,KAAQN,EAAEI,CAAW,GAAA;AAC5B,cACIG,IADcP,EAAEI,CAAAA,EAAWE,GACND,CACrBV;AAAAA,UAAAA,EAAGY,OACPhB,IAASS,EAAEQ,oBAAoBjB,GAC9B3F,EAAU6G,mBAAmBb,EAAUU,CAAOX,GAAAA,EAAGY,IAASV,GAAWC,GAAWC;QACjF;AAAA,IAEF;AAGD,WADAR,IAAQS,EAAEQ,oBAAoBjB,GAAO3F,EAAU6G,mBAAmBb,GAAW,UAAUC,GAAWC,GAAWC,CAE7G,CAAA;AAAA,EAAA;AAtKDnG,IAAU8G,YAAY,SAASpB,GAAMC,GAAOtE,GAC3C;AAAA,QAAIuE,IAAUH,EAAsBC,GAAMC,GAAOtE,CACjD;AAAA,WAAOrB,EAAU+G,kBAAkBnB,CAAAA;AAAAA,EACrC,GACC5F,EAAUgH,cAAc,SAAStB,GAAMC,GAAOtE,GAAAA;AAE7C,QAAIuE,IAAUH,EAAsBC,GADpCC,IAAQA,KAAS,WACgCtE,CAAAA;AACjD,WAAOrB,EAAUiH,qBAAqBrB,CACxC;AAAA,EAAA,GAEC5F,EAAUkH,wBAAwB,SAASnB,GAAII,GAAegB,GAAAA;AAC7DhB,IAAAA,IAAgBA,KAAiBX;AAMjC,aAJI4B,IAAM,IACNC,IAAkB,IAAI7E,KAAKuD,EAAGxE,WAAWkB,QAAAA,CAAAA,GACzC6E,IAAgBtH,EAAUgC,KAAKC,IAAIoF,GAAiB,GAAG,KAAA,GACvDrB,IAAYhG,EAAUuH,mBACnBF,IAAkBtB,EAAGvE,UAAU6F,IAAkBrH,EAAUgC,KAAKwF,UAAUF,IAAgBA,IAAgBtH,EAAUgC,KAAKC,IAAIoF,GAAiB,GAAG,KAAS,GAAA;AAChK,UAAInB,IAAAA,CAAalG,EAAUgC,KAAKwF,UAAW,IAAIhF,KAAK6E,KAGhD1B,IAAQG,EAASC,GAAIC,GAFTqB,EAAgBI,OAEevB,GAAAA,GAAWC,CAC1D;AAAA,UAAIR;AACH,iBAASzC,IAAI,GAAGA,IAAIyC,EAAMxC,QAAQD,KAAG,GAAG;AAGvC,cAAIwE,IAAa1H,EAAU2H,kBAAkBN,CAAAA,GACzCO,IAAa7B,EAAGvE,WAAS8F,KAAiBvB,EAAGvE,SAASqG,aAAaR,EAAgBQ,QAAAA,IAAc,OAAO7H,EAAU2H,kBAAkB5B,EAAGvE,QAEvIsG,GAAAA,IAAcnC,EAAMzC,CACpB6E,GAAAA,IAAYpC,EAAMzC,IAAE,CACxB;AAAA,cAAI4E,IAAYF,KAAYG,IAAUL,OAIpCN,IAHuB,OAAdD,KAAc,cAGjBA,EAAWpB,GAAI2B,GAAYE,GAAUE,GAAaC,CAAAA;AAKxD;AAAA,QAEF;AAAA,IAEF;AACD,YAAQX;AAAAA,EACV,GACCpH,EAAUgI,sBAAsB,SAAS5H,GACxC;AAEA,QAFA,CAAIA,KAECJ,CAAAA,EAAUM,OAAO2H;AACrB,aAAA;AACD,QAAI7B,IAAIpG,GACJkI,IAAI9B,EAAE9F,QACN6H,IAAM,CACV;AAAA,QAAK/H,EAAMgI,YAAYhI,EAAMiI,aAAejI,EAAW,OAAG;AACzD,YAAMkI,IAAYlI,EAAMiI,aAAajI,EAAMoB;AAE3C,cAAK0G,EAAEK,eAAAA,CAAeL,EAAEM,aACAF,EAAU7F,QAAayF,KAAAA,EAAEK,YAAY9F,QAAAA,KAAarC,EAAMmB,WAAWkB,QAAAA,KAAayF,EAAEM,UAAU/F,QAAAA;AAAAA,IAGvH;AACG0F,IAAAA,IAAM,CAAC/H,CAIR;AAAA,aADIqI,IAAAA,IACKC,IAAE,GAAGA,IAAEP,EAAIhF,QAAQuF,KAAK;AAChC,UAAItB,QACArB,IAAKoC,EAAIO,CAEb3C;AAAAA,MAAAA,EAAG4C,SAAS3I,EAAU4I,cAAc7C,KAEpCqB,IAAOc,CAAAA,EAAEK,eAAeL,CAAAA,EAAEM,aAAczC,EAAGxE,WAAWkB,QAAayF,KAAAA,EAAEK,YAAY9F,QAAasD,KAAAA,EAAGvE,SAASiB,QAAayF,KAAAA,EAAEM,UAAU/F,QAAAA,OAElI2E,IAAOpH,CAAAA,EAAUkH,sBAAsBnB,GAAIR,GAAgB,SAASnF,GAAOsH,GAAYE,GAAUE,GAAaC,GAAAA;AAE7G,YAAIc,IAAAA;AAqBJ,eApBInB,KAAYK,KAAaL,KAAcI,OACtCC,KAAa,QAASH,KAAYG,OACrCc,IAAAA,KAGEzI,EAAMuI,UAAUvC,EAAE0C,YAAY1C,EAAE2C,cAAc,cAChD3I,EAAMmB,WAAWyH,SAAS,CAC1B5I,GAAAA,EAAMmB,WAAW0H,WAAWlB,CAE5Bc,KAAAA,IAAAA,MAGGjB,KAAYE,KAAeF,KAAYG,KAAeL,IAAaI,KAAeF,IAAWG,OAC9F3H,EAAMuI,UAAUvC,EAAE0C,YAAY1C,EAAE2C,cAAc,cAChD3I,EAAMoB,SAASwH,SAAS,IACxB5I,EAAMoB,SAASyH,WAAWnB,CAAAA,KAE1Be,IAAQ,KAGHA;AAAAA,MACZ,CAEQzB,IAAAA,MACJA,IAAOhB,EAAE8C,WAAW,sBAAuB9C,EAAE+C,UAAU,oBAAmB,CAACpD,EAAG9C,IAAI8C,CAAOqB,CAAAA,IAAAA,IAE1FqB,IAAeA,KAAgBrB;AAAAA,IAC/B;AAKD,WAJIqB,MACHrC,EAAE0C,WAAW,MACb1C,EAAE2C,aAAa,OAETN;AAAAA,EAGT,GACCzI,EAAU6G,qBAAqB,SAASb,GAAWS,GAAUR,GAAWC,GAAWC,GAClF;AAAA,QAAIR,IAAO,CACX;AAAA,QAAIK,KAAaA,EAAUS,CAAAA;AAG1B,eAFI2C,IAAiBpD,EAAUS,CAAAA,GAC3B4C,IAAyBC,KAAKC,4BAA4BtD,GAAWC,GAAWkD,GAAgBjD,CAC3FjD,GAAAA,IAAE,GAAGA,IAAEmG,EAAuBlG,QAAQD;AAC9CyC,QAAAA,IAAQ2D,KAAK1C,oBAAoBjB,GAAO0D,EAAuBnG,GAAGyC,KAGpE;AAAA,WAAOA;AAAAA,EACT,GACC3F,EAAUuJ,8BAA8B,SAAStD,GAAWC,GAAWP,GAAOQ,GAC7E;AAAA,QAAIqD;AAeJ,WAdGxJ,EAAUM,OAAOgF,6BACnBkE,IAAe7D,EAAMO,CAAAA,KAAcP,EAAMO,CAAAA,EAAWC,KAAkBR,EAAMO,CAAAA,EAAWC,KACtFR,EAAMM,CAAAA,KAAcN,EAAMM,CAAWE,EAAAA,CAAAA,IAAkBR,EAAMM,CAAAA,EAAWE,CAAiB,IAAA,CAAA,KAE1FqD,IAAc,CACX7D,GAAAA,EAAMO,MAAcP,EAAMO,CAAAA,EAAWC,OACvCqD,IAAcA,EAAYC,OAAO9D,EAAMO,CAAWC,EAAAA,CAAAA,CAAAA,IAG/CR,EAAMM,CAAcN,KAAAA,EAAMM,GAAWE,CACxCqD,MAAAA,IAAcA,EAAYC,OAAO9D,EAAMM,CAAWE,EAAAA,CAAAA,CAAAA,KAI7CqD;AAAAA,EACT,GA0BCxJ,EAAU0J,YAAY,SAASC;AAE9B,QAAIC,IAAe;AACdN,SAAKO,KAAKD,CACdN,MAAAA,KAAKO,KAAKD,CAAAA,IAAgB;AAE3B,QAAIE,IAAM9J,EAAU+J,aAChB1F,GAAAA,IAAMiF,KAAKhJ;AAEf,QADAN,EAAUgK,iBAAAA,GAAAA,CACLL,KAAQtF,EAAIe,YAAY0E,IAAMR,KAAKW,aAAaH,IAAMR,KAAKY,aAAaJ,EAAIK,SAAAA,KAAc9F,EAAI+F,cAAcN,EAAIK,SAAAA,IAAW9F,EAAIgG,WAAW;AAC9I,UAAIpE,IAAYqD,KAAKgB,kBAAkBR,CACvCR;AAAAA,WAAKO,KAAKD,CAAAA,IAAgB5J,EAAUuK,iBAAiBtE,GAAW6D,CAChE;AAAA,IAAA;AAAA,EACH,GACC9J,EAAUuK,mBAAmB,SAAStE,GAAW6D,GAAAA;AAChD,QAAIF,IAAe,gBACfY,IAAYxK,EAAU2H,kBAAkBmC,CAAAA,GACxClE,IAAU,EACbD,OAAO,CAAC6E,GAAYA,IAAW,CAC/B/I,GAAAA,KAAKmI,GACL/D,MAAM+D;AAEP,QAAKN,CAAAA,KAAKmB,aAAa;AACtB,UAAInB,KAAKhD,UAAUgD,KAAKhD,OAAOgD,KAAKoB,KAAAA,GAAQ;AAC3C,YAAIC,GACHC,GAEGlE,IAAO4C,KAAKhD,OAAOgD,KAAKoB,KAAAA,GACxBG,IAAUnE,EAAKoE,QAAQpE,EAAKd,QAAQzC;AACpCuD,QAAAA,EAAKhB,OAAO,KACZgB,EAAKoE,QAAQpE,EAAKd,QAAQzC,WAC5B8C,KAAcS,EAAKqE,WAAU9E,KAAaS,EAAKd,QAAQzC,SAAUuD,EAAKoE,OAEvEH,IAAc1E,GACd2E,IAAY3E,IAAY4E,KAIxBD,KADAD,IAAc,KACYE;AAK3B,iBAFIG,IAAS,CAAA,GAEJ9H,IAAIyH,GAAazH,IAAI0H,GAAW1H,KAAK;AAC7C,cAAI+H,IAAQ/H;AACZ0C,UAAAA,EAAQF,OAAOuF;AACf,cAAIC,IAAQlL,EAAUmL,wBAAwBvF,GAAS,MAAMqF,CAAO,EAAA,CAAA;AACpED,UAAAA,EAAOrI,KAAKuI,CAAAA;AAAAA,QACZ;AACD,eAAOF;AAAAA,MACX;AAEI,aADApF,EAAQF,OAAOO,GACRjG,EAAUmL,wBAAwBvF,GAAS,MAAMK,CAAAA;AAAAA,IAE5D;AACG,QAAIqD,KAAKoB,SAAS;AAEjB,aADA9E,EAAQF,OAAAA,CAAQ1F,EAAUgC,KAAKwF,UAAUsC,CAClC9J,GAAAA,EAAUmL,wBAAwBvF,GAAS,MAAM;EAG5D,GACC5F,EAAUgK,mBAAmB,WAAA;AAG5B,aAFIJ,IAAe,gBACfwB,IAAM9B,KAAKO,KAAKD,CAAAA,GACX1G,IAAE,GAAGA,IAAEkI,EAAIjI,QAAQD,KAAK;AAChC,UAAImI,IAAMD,EAAIlI,IACVoI,IAASD,EAAIE;AACbD,MAAAA,KACHA,EAAOE,YAAYH,CAAAA;AAAAA,IAEpB;AACD/B,SAAKO,KAAKD,CAAgB,IAAA,CAAA;AAAA,EAC5B,GA4CC5J,EAAUuH,oBAAoB,EAAEzH,QAAQ,CAAE,EAE1CE,GAAAA,EAAU2H,oBAAoB,SAAS3F;AACtC,WAAuB,KAAhBA,EAAKmI,SAAgBnI,IAAAA,EAAKyJ;EACnC,GACCzL,EAAU0L,4BAA4B,SAASpL,GAC9C;AAAA,QAAIqL,IAAY,CACZC,GAAAA,IAAe;AAKnB,QAHItL,EAAOoF,QAAQ,eAClBpF,EAAOoF,OAAO,CAAC,GAAE,GAAE,GAAE,GAAE,GAAE,GAAE,CAExBpF,IAAAA,EAAOoF,gBAAgBmG,OAAO;AAEjC,eADIC,IAASxL,EAAOoF,KAAKqG,MAChB7I,GAAAA,IAAE,GAAGA,IAAE4I,EAAO3I,QAAQD,KAAK;AACnC,YAAI8I,IAAgBhM,EAAUiM,YAAY3L;AAC1C0L,QAAAA,EAActG,OAAOoG,EAAO5I,CAC5ByI,GAAAA,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU0L,0BAA0BM,CAAAA,CAAAA;AAAAA,MACpE;AACD,aAAOL;AAAAA,IACP;AAED,QAAMrL,CAAAA,KAAAA,EACFA,EAAOiB,cAAcjB,EAAOkB,YAAYlB,EAAOkB,WAAWlB,EAAOiB,cAAgBjB,EAAOoF,mBAAsBpF,EAAOqF,UAAAA,CAAYrF,EAAOuF;AAC3I,aAAO8F;AAIY,IAAhBrL,EAAOqF,SAAS,cACnBrF,EAAOqF,QAAQ,CAHN,GACA,IAGNrF,IAAAA,EAAOqF,SAASrF,EAAO6L,iBAC1B7L,EAAOqF,QAAQ3F,EAAUoM,YAAY9L,EAAOqF,KAG7CrF,IAAAA,EAAO2C,KAAKjD,EAAUqM,IAAAA,GACtB/L,EAAOmB,MAAMnB,EAAOmB,OAAK,IACzBnB,EAAOuF,OAAOvF,EAAOuF,QAAML;AAE3B,QAAInE,IAAWf,EAAOe;AACtB,QAAIA;AACH,eAASiL,KAAYjL;AACpB,YAAIA,EAASkL,eAAeD,IAAW;AACtC,cAAIE,IAAMnL,EAASiL,CAAAA;AAGnB,eAFME,aAAeX,UACpBW,IAAM,CAACA,KACCtJ,IAAE,GAAGA,IAAEsJ,EAAIrJ,QAAQD;AAAK,aAC5BuJ,IAAWzM,EAAU0M,WAAW,CAAE,GAAEpM,CAC/Be,GAAAA,WAAW,IACpBoL,EAASpL,SAASiL,CAAYE,IAAAA,EAAItJ,CAClC0I,GAAAA,EAAajJ,KAAK8J,CAAAA;AAAAA,QAEnB;AAAA;AAGFb,MAAAA,EAAajJ,KAAKrC,CAGnB;AAAA,aAASqM,IAAE,GAAGA,IAAEf,EAAazI,QAAQwJ,KAAK;AACzC,UAAIC,IAAWhB,EAAae,CAExBpL,GAAAA,IAAaqL,EAASrL,YACtBC,IAAWoL,EAASpL;AAExB,UAAID,KAAcC;AAIjB,iBAHIqL,IAAO7M,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKjB,CACzCuL,CAAAA,GAAAA,IAAM9M,EAAUgC,KAAKC,IAAI4K,GAAM,GAAG,QAE/BA,IAAOrL,KAAU;AACvB,cAAIiL;AAAAA,kBAAAA,IAAWzM,EAAU0M,WAAW,CAAE,GAAEE,IACxBrL,YACTkL,OAAAA,EAASjL,UAChBiL,EAAS/G,OAAOmH,EAAKpK,QACrB;AAAA,cAAI+H,IAAcjJ,IAAasL,IAAQ7M,EAAU2H,kBAAkBpG,CA9C5D,IAAA,GA+CHwL,IAAavL,IAAWsL,KAAQtL,EAASqG,QAAagF,KAAAA,EAAKhF,QA9CxD,IAAA,OA8C4E7H,EAAU2H,kBAAkBnG;AAC/GiL,UAAAA,EAAS9G,QAAQ,CAAC6E,GAAYuC,CAAAA,GAC9BpB,EAAUhJ,KAAK8J,CAAAA,GAEfI,IAAOC,GACPA,IAAO9M,EAAUgC,KAAKC,IAAI6K,GAAM,GAAG,KACnC;AAAA,QAAA;AAAA;AAEGF,QAAAA,EAASlH,gBAAgBlD,SAC5BoK,EAASlH,OAAQ1F,EAAUgC,KAAKwF,UAAUoF,EAASlH,MAAOjD,QAC3DmK,IAAAA,EAASjH,QAAQrF,EAAOqF,MAAMoG,MAC9BJ,GAAAA,EAAUhJ,KAAKiK,CAAAA;AAAAA,IAEhB;AACD,WAAOjB;AAAAA,EACT,GACC3L,EAAUgN,sBAAsB,SAASpL,GAAOqL,GAAOC,GACtD;AAAA,QAAIC,IAAQ,CAAA;AACZF,IAAAA,IAAQjN,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKyK,KAAOjN,EAAUkK,SAAAA,CAAAA,GAC3DgD,IAAM,IAAI1K,KAAK0K,KAAKlN,EAAUiK,SAI9B;AAAA,aAHImD,IAAYH,EAAMxF,UAClB4F,IAASzL,IAAMwL,KAAa,IAAMxL,IAAMwL,IAAc,IAAEH,EAAMxF,OAAAA,IAAS7F,GACvE0L,IAAStN,EAAUgC,KAAKC,IAAIgL,GAAOI,GAAO,KAAA,GACvCC,IAASJ,GAAKI,IAAStN,EAAUgC,KAAKC,IAAIqL,GAAQ,GAAG;AAC3DH,QAAMxK,KAAK2K,CAEZ;AAAA,WAAOH;AAAAA,EACT,GACCnN,EAAUuN,6BAA6B,SAASjN;AAC/C,QAAIkN,IAAc;AAOlB,WANIlN,EAAOuF,QAAQN,MAClBiI,EAAY7K,KAAK4C,IACbjF,EAAOmB,OACV+L,EAAY7K,KAAK4C,IAAe,YAElCiI,EAAY7K,KAAK,uBAAuBrC,EAAOmB,GAAAA,GACxC+L,EAAYC,KAAK,GAAA;AAAA,EAC1B,GACCzN,EAAU0N,uBAAuB,SAASpN,GACzC;AAAA,QAAIqN,IAASC,SAASC,cAAc,KAAA;AAOpC,WANIvN,EAAOoB,gBACCpB,EAAOoB,QAAQ,WACzBiM,EAAMG,YAAYxN,EAAOoB,OAEzBiM,EAAMI,YAAYzN,EAAOoB,QAEpBiM;AAAAA,EACT,GACC3N,EAAUmL,0BAA0B,SAASvF,GAASoI,GAAMC,GAAAA;AAC3D,QAAIC,IAAS,CACThG,GAAAA,IAAIlI,EAAUM,QACd6N,IAAW7E,KAAKY,WAChBkE,IAAW9E,KAAKW,WAChB/D,IAAAA;AAEJ,QAAA,CAAKgC,EAAE7C;AACN,aAAO6I;AAGR,QAAA,CAAKD,KAAOA,MAAQ,GAAG;AACtB,UAAIrI,EAAQF,OAAO;AAClBuI,QAAAA,IAAMrI,EAAQF;AAAAA,WACV;AACJ,YAAI2I,IAAkB,IAAI7L,KAAKoD,EAAQF,IAIvC;AAAA,YAHAQ,IAAamI,CAAAA,GAAAA,EAAAA,CAGLD,IAAYC,CAAAA,KAAAA,CAAoBF,MAAaE;AACpD,iBAAOH;AAERD,QAAAA,IAAMI,EAAgB5G;MACtB;AAGD,UAAI6G,IAAUH,EAAS1G,OACnB6G;AAAAA,MAAAA,IAAUL,IACbA,IAAM,KAAKK,IAAQL,KAEnBA,KAAYK;AAAAA,IAEb;AACD,QAAI3I,IAAQC,EAAQD,OAChB6H,IAAcxN,EAAUuN,2BAA2B3H;AAEvD,QAAI5F,EAAUyK,eAAezK,EAAU0K,SAAS,SAAS;AACxD,UAAI6D,IAAQ,IACR7I,IAAO,CAAA;AAGX,UAAKsI;AAMJO,QAAAA,EAAM5L,KAAKqL,CACXtI,GAAAA,EAAK/C,KAAKsL,CAAAA;AAAAA,WAPA;AACVvI,YAAO8I,IAAc,CAACtI,CAAAA,IAAalG,EAAUgN,oBAAoBiB,CAAAA;AACjE,iBAAS/K,IAAE,GAAGA,IAAIwC,EAAKvC,QAAQD;AAC9BqL,UAAAA,EAAM5L,KAAM2G,KAAKmF,QAAQ/I,EAAKxC;MAEnC;AAKG,WAASA,IAAE,GAAGA,IAAIqL,EAAMpL,QAAQD,KAAK;AACpC8K,QAAAA,IAAOO,EAAMrL,CAAAA,GACb+K,IAAMvI,EAAKxC,CAAAA;AAEX,YAAIwL,IAAOpF,KAAKgB,kBAAkB2D,KAAc3E,IAAAA,KAAKqF,MAAMxL;AAE3D,YAAA,CAAGmG,KAAKsF,SAASF,CAAAA,GAAjB;AAEA,cAAIG,IAAc7O,EAAU0N,qBAAqB9H,CACjDiJ;AAAAA,UAAAA,EAAYC,YAAYtB,GACxBqB,EAAY5N,MAAMC,MAAM,OACxB2N,EAAY5N,MAAM8N,SAAS;AAE3B,mBAASpC,IAAE,GAAGA,IAAIhH,EAAMxC,QAAQwJ,KAAG,GAAG;AACrC,gBAAIM,IAAQtH,EAAMzC;AAElB,iBADIgK,IAAMvH,EAAMzC,IAAE,CAAA,MACP+J;AACV,qBAAO,CAAA;AAAA,aAEJU,IAAQkB,EAAYzL,UAAU,EAAA,GAE5BnC,MAAME,OAAO,OACnBwM,EAAM1M,MAAM+N,QAAQ,QAEpBhB,EAAKD,YAAYJ,CACjBO,GAAAA,EAAOvL,KAAKgL,CAAAA;AAAAA,UACZ;AAAA,QApBgC;AAAA,MAqBjC;AAAA,IACJ,OAAS;AACN,UAAI/L,IAAQqM;AAEZ,UAAG3E,KAAKsF,SAAStF,KAAKgB,kBAAkB2D,KAAc,CAAA;AAAA,eAAOC;AAE7D,UAAI5E,KAAKhD,UAAUgD,KAAKhD,OAAOgD,KAAKoB,KAAAA,KAAU9E,EAAQvE,YAAYuE,EAAQvE,SAASiI,KAAKoB,QAAQ;AAC/F,YAAIhE,IAAO4C,KAAKhD,OAAOgD,KAAKoB,KAAAA;AAC5B9I,QAAAA,IAAQ8E,EAAKuI,MAAMrJ,EAAQvE,SAASiI,KAAKoB,KAEzC,CAAA;AAAA,YAAIwE,IAAcxI,EAAKuI,MAAMrJ,EAAQvE,SAASiI,KAAKoB,KAAAA,CAAAA;AACnD,QAAKhE,EAAKhB,OAAO,IAOhB9D,IAAQA,KADM8E,EAAKoE,QAAQpE,EAAKd,QAAQzC,UAChB+L,KANxBtN,IAAQsN,GACJxI,EAAKoE,QAASlJ,IAAQ8E,EAAKqE,WAASrE,EAAKoE,SAC5ClJ,IAAQ;AAAA,MAMV;AAGD,WAFAoM,IAAOA,KAAchO,EAAUmP,cAAcvN,IAEpCsB,IAAI,GAAGA,IAAIyC,EAAMxC,QAAQD,KAAG,GAAE;AACtC,YACIgK,GAQAS;AAPJ,YAFIV,IAAQmC,KAAKC,IAAI1J,EAAMzC,CAAiB,GAAA,KAAbgF,EAAEkC,UAAAA,IAC7B8C,IAAMkC,KAAKE,IAAI3J,EAAMzC,IAAE,CAAgB,GAAA,KAAZgF,EAAEmC,SACtB4C,MAAAA,GAAO;AACjB,cAAI/J,IAAE,IAAIyC,EAAMxC;AACf;AAEA,iBAAO,CACR;AAAA,QAAA;AAAA,SAEGwK,IAAQ3N,EAAU0N,qBAAqB9H,CACrCkJ,GAAAA,YAAYtB;AAGlB,YAAI+B,IAA4C,KAAzBjG,KAAKhJ,OAAOkP,eAAkB,GACjDC,IAAU;AACd9B,QAAAA,EAAM1M,MAAMC,MAAOkO,KAAKM,OAAa,KAANzC,IAAS,MAAK3D,KAAKhJ,OAAO8J,aAAWqF,KAASnG,KAAKhJ,OAAOkP,eAAaC,CAAAA,IAAWF,IAAoB,MACrI5B,EAAM1M,MAAM8N,SAASK,KAAKC,IAAKD,KAAKM,MAAmB,MAAXxC,IAAID,KAAU,MAAM3D,KAAKhJ,OAAOkP,eAAaC,CAAYF,IAAAA,GAAkB,KAAG,MAE1HvB,EAAKD,YAAYJ,CACjBO,GAAAA,EAAOvL,KAAKgL,CAAAA;AAAAA,MACZ;AAAA,IACD;AACD,WAAOO;AAAAA,EACT,GAEClO,EAAU2P,kBAAkB,WAAA;AAC3B,QAAIC,IAAOtG,KAAKO,KAAmB,aAAE,CACjCgG,GAAAA,IAAO;AACX,QAAI7P,EAAUyK,eAAezK,EAAU0K,SAAS;AAC/C,eAASuD,KAAO3E,KAAKmF,SAAS;AAC7B,YAAIzM,IAAO,oBAAIQ,MAAMyL,CACrB4B;AAAAA,QAAAA,EAAKlN,KAAKuJ,MAAM2D,GAAM7P,EAAU8P,qBAAqBxG,KAAKmF,QAAQR,IAAKjM,CACvE,CAAA;AAAA,MAAA;AAAA,SAGD;AAAIA,UAAO,IAAIQ,KAAKxC,EAAUkK,SAAAA;AAC9B,eAAShH,IAAI,GAAG6M,IAAMH,EAAKI,WAAW7M,QAAQD,IAAI6M,GAAK7M,KAAK;AAC3D,YAAI8K,IAAO4B,EAAKI,WAAW9M,CAAAA;AACvB8K,QAAAA,EAAKiC,cAAcjQ,EAAUkQ,cAAclC,EAAKiC,UAAAA,EAAYE,QAAQ,gBAAqB,IAAA,OAI7FN,EAAKlN,KAAKuJ,MAAM2D,GAAM7P,EAAU8P,qBAAqB9B,GAAMhM,KAC3DA,IAAOhC,EAAUgC,KAAKC,IAAID,GAAM,GAAG,KAAA;AAAA,MACnC;AAAA,IATuC;AAWzC,WAAO6N;AAAAA,EACT,GAGC7P,EAAUQ,eAAe,SAAS4P;AACjC,QAAI9G,CAAAA,KAAKO;AACR,YAAM,IAAIwG,MAAM,qIAIjB;AAAA,QAAIC;AACAhH,SAAKO,KAAmB,iBAC3B7J,EAAUuQ,aACVD,GAAAA,IAAAA;AAKD,QAAIE,IAAgBxQ,EAAUyQ,uBAC7BC,IAAiB1Q,EAAU2Q,yBAC3B3K,IAAYhG,EAAUuH;AAEvBvH,MAAUiH,qBAAAA,GAGVjH,EAAU+G,kBAAkBqJ;AAE5B,QAAIP,IAAO7P,EAAU2P,gBAUrB;AAAA,WARGW,MACFtQ,EAAU6J,OAAO,CAGlB7J,IAAAA,EAAUyQ,wBAAwBD,GAClCxQ,EAAU2Q,0BAA0BD,GACpC1Q,EAAUuH,oBAAoBvB,GAEvB6J;AAAAA,EACT,GACC7P,EAAUkF,iBAAiB,SAAS2K,GACnC;AAAA,QAAKA;AAEL,eAAS3M,IAAE,GAAGA,IAAE2M,EAAK1M,QAAQD,KAAK;AACjC,YAAImI,IAAMwE,EAAK3M;AAEXmI,QAAAA,EAAIE,cACPF,EAAIE,WAAWC,YAAYH;MAE5B;AAAA,EACH,GAGCrL,EAAU4Q,2BAA2B,SAAStQ,GAAAA;AAC7C,QAAIR,IAAS,UACTkG,IAAYhG,EAAUuH,mBACtBtE,IAAK3C,EAAO2C,IAEZuJ,IAAMxM,EAAUyQ;AACfjE,IAAAA,EAAIvJ,OACRuJ,EAAIvJ,CAAAA,IAAM;AAGX,QAAIgL,IAAM3N,EAAOoF,MAEbrE,IAAWf,EAAOe,UAClBwE,IAAOvF,EAAOuF;AAGlB,QAFAvF,EAAO2C,KAAKA,GAER5B;AACH,eAASiL,KAAYjL;AACpB,YAAIA,EAASkL,eAAeD,IAAW;AACjCtG,UAAAA,EAAUsG,OACdtG,EAAUsG,CAAAA,IAAY;AACvB,cAAIuE,IAAUxP,EAASiL,CACnBwE,GAAAA,IAAiB9K,EAAUsG,CAC1BwE;AAAAA,UAAAA,EAAeD,OACnBC,EAAeD,CAAAA,IAAW,KACtBC,EAAeD,CAAS5C,EAAAA,CAAAA,MAC5B6C,EAAeD,CAAAA,EAAS5C,KAAO,CAAA,IAC3B6C,EAAeD,CAAS5C,EAAAA,CAAAA,EAAKpI,OACjCiL,EAAeD,CAAAA,EAAS5C,CAAKpI,EAAAA,CAAAA,IAAQ,CACjC7F,GAAAA,EAAU2Q,4BACb3Q,EAAU2Q,0BAA0B,KACjC3Q,EAAU2Q,wBAAwB9K,CACrC7F,MAAAA,EAAU2Q,wBAAwB9K,CAAAA,IAAAA;AAEpC,cAAIkL,IAAcD,EAAeD,CAAAA,EAAS5C,GAAKpI,CAC/CvF;AAAAA,UAAAA,EAAO0Q,SAASD,GAChBA,EAAYpO,KAAKrC,CAAAA,GACjBkM,EAAIvJ,CAAAA,EAAIN,KAAKrC,CACb;AAAA,QAAA;AAAA;AAGG0F,MAAAA,EAAUlG,CAAAA,EAAQmO,OACtBjI,EAAUlG,CAAAA,EAAQmO,CAAO,IAAA,CAAA,IACrBjI,EAAUlG,GAAQmO,CAAKpI,EAAAA,CAAAA,MAC3BG,EAAUlG,CAAQmO,EAAAA,CAAAA,EAAKpI,KAAQ,CAE5B7F,IAAAA,EAAU2Q,4BACb3Q,EAAU2Q,0BAA0B,KACjC3Q,EAAU2Q,wBAAwB9K,CACrC7F,MAAAA,EAAU2Q,wBAAwB9K,CAAQ,IAAA,KAEvCkL,IAAc/K,EAAUlG,CAAQmO,EAAAA,CAAAA,EAAKpI,IACzCvF,EAAO0Q,SAASD,GAChBA,EAAYpO,KAAKrC,IACjBkM,EAAIvJ,CAAAA,EAAIN,KAAKrC,CAAAA;AAAAA,EAGhB,GAECN,EAAUyQ,wBAAwB,IAElCzQ,EAAU+G,oBAAoB,SAASqJ,GACtC;AAAA,QAAIa,IAAUjR,EAAU0L,0BAA0B0E,CAAAA;AAClD,QAAKa,EAAQ9N,QAAb;AAIA,eADIF,IAAKgO,EAAQ,CAAA,EAAGhO,IACXC,IAAE,GAAGA,IAAE+N,EAAQ9N,QAAQD;AAC/BlD,UAAU4Q,yBAAyBK,EAAQ/N;AAE5C,aAAOD;AAAAA,IANC;AAAA,EAOV,GAECjD,EAAU4G,sBAAsB,SAASsK,GAAevL,GAAAA;AACvD,QAAIwL,IAAkBD,EAAcnF;AAGpC,QAFApG,IAAQA,EAAMoG,MAAAA,GAAAA,CAEToF,EAAgBhO;AACpB,aAAOwC;AAER,aAASzC,IAAE,GAAGA,IAAEiO,EAAgBhO,QAAQD,KAAG;AAK1C,eAJIkO,IAAeD,EAAgBjO,CAAAA,GAC/BmO,IAAaF,EAAgBjO,IAAE,IAC/BoO,IAAUpO,IAAE,KAAKiO,EAAgBhO,QAE5BwJ,IAAE,GAAGA,IAAEhH,EAAMxC,QAAQwJ,KAAG,GAAG;AACnC,YAAInC,IAAa7E,EAAMgH,CACnBI,GAAAA,IAAWpH,EAAMgH,IAAE,CAAA;AACvB,YAAKI,IAAWsE,KAAc7G,KAAc6G,KAAgB7G,IAAa4G,KAAgBrE,KAAYqE;AACpGD,UAAAA,EAAgBjO,KAAKkM,KAAKE,IAAI8B,GAAc5G,CAC5C2G,GAAAA,EAAgBjO,IAAE,CAAKkM,IAAAA,KAAKC,IAAIgC,GAAYtE,CAC5C7J,GAAAA,KAAK;AAAA,aACC;AACN,cAAA,CAAKoO;AACJ;AAED,cAAIC,IAAUH,IAAe5G,IAAY,IAAE;AAC3C2G,UAAAA,EAAgBK,OAAOtO,IAAEqO,GAAQ,GAAG/G,GAAYuC,CAChD;AAAA,QAAA;AACDpH,QAAAA,EAAM6L,OAAO7E,KAAI,CACjB;AAAA;AAAA,MACA;AAEF,WAAOwE;AAAAA,EACT,GACCnR,EAAUyR,2BAA2B,SAASP,GAAevL;AAE5D,aADIwL,IAAkBD,EAAcnF,MAC3B7I,GAAAA,IAAE,GAAGA,IAAEiO,EAAgBhO,QAAQD,KAAG;AAG1C,eAFIkO,IAAeD,EAAgBjO,CAAAA,GAC/BmO,IAAaF,EAAgBjO,IAAE,CAC1ByJ,GAAAA,IAAE,GAAGA,IAAEhH,EAAMxC,QAAQwJ,KAAG,GAAG;AACnC,YAAInC,IAAa7E,EAAMgH,CACnBI,GAAAA,IAAWpH,EAAMgH,IAAE,CAAA;AACvB,YAAII,IAAWqE,KAAgB5G,IAAa6G,GAAY;AACvD,cAAIK;AACAN,UAAAA,KAAgB5G,KAAc6G,KAActE,KAC/CoE,EAAgBK,OAAOtO,GAAG,CAEvBkO,GAAAA,IAAe5G,MAClB2G,EAAgBK,OAAOtO,GAAG,GAAGkO,GAAc5G,CAC3CkH,GAAAA,IAAAA,KAEGL,IAAatE,KAChBoE,EAAgBK,OAAQG,IAAezO,IAAE,IAAGA,GAAGyO,IAAc,IAAE,GAAG5E,GAAUsE,IAE7EnO,KAAK;AACL;AAAA,QACL;AAAA,MAGI;AAEF,WAAOiO;AAAAA,EACT,GACCnR,EAAUoM,cAAc,SAASzG,GAAAA;AAChC,WAAO3F,EAAUyR,yBAAyB,CAAC,GAAG,IAAO9L,GAAAA,EAAMoG;EAC7D,GACC/L,EAAU4R,gCAAgC,SAAS3O,GAAAA;AAClD,QAAIgO,IAAUjR,EAAUyQ,sBAAsBxN,CAAAA;AAC9C,QAAIgO;AACH,eAAS/N,IAAE,GAAGA,IAAE+N,EAAQ9N,QAAQD;AAG/B,iBAFI5C,IAAS2Q,EAAQ/N,CAAAA,GACjB2O,IAAevR,EAAO0Q,QACjBrE,IAAE,GAAGA,IAAEkF,EAAa1O,QAAQwJ;AACpC,cAAIkF,EAAalF,CAAMrM,KAAAA,GAAQ;AAC9BuR,YAAAA,EAAaL,OAAO7E,GAAG,CACvB;AAAA;AAAA,UACA;AAAA;AAAA,EAIN,GACC3M,EAAU8R,oCAAoC,SAASxR,GACtD;AAAA,QAIIyR,GAJA/L,IAAYhG,EAAUuH,mBACtBlG,IAAWf,EAAOe,UAClB4M,IAAM3N,EAAOoF,MACbG,IAAOvF,EAAOuF,QAAML;AAExB,QAAInE;AACH,eAASiL,KAAYjL;AACpB,YAAIA,EAASkL,eAAeD,CAAAA,KAAatG,EAAUsG,CAAAA,GAAW;AAC7D,cAAIuE,IAAUxP,EAASiL,CACnBtG;AAAAA,UAAAA,EAAUsG,GAAUuE,CACvBkB,MAAAA,IAAY/L,EAAUsG,CAAAA,EAAUuE,CAEjC;AAAA,QAAA;AAAA;AAGFkB,MAAAA,IAAY/L,EAAUlG;AAGvB,QAAGiS;AACF,UAAI9D,MAAJ;AACK8D,QAAAA,EAAU9D,CAAQ8D,KAAAA,EAAU9D,CAAKpI,EAAAA,CAAAA,MACpC7F,EAAU4Q,yBAAyBtQ,CAAAA,GACnCN,EAAUgS,8BAA8BD,EAAU9D,GAAKpI,CAAOvF,GAAAA,CAAAA;AAAAA;AAI/D,iBAASqR,KAAKI;AACb,cAAIA,EAAUJ,CAAAA,EAAG9L,IAAO;AACvB,gBAAIoM,IAAYjS,EAAUiM,YAAY3L,CACtCA;AAAAA,YAAAA,EAAOoF,OAAOiM,GACd3R,EAAU4Q,yBAAyBqB,CAAAA,GACnCjS,EAAUgS,8BAA8BD,EAAUJ,GAAG9L,CAAOvF,GAAAA,CAAAA;AAAAA,UAC5D;AAAA;AAAA,EAIN,GACCN,EAAUgS,gCAAgC,SAASE,GAAe5R;AACjE,aAAS4C,IAAE,GAAGA,IAAEgP,EAAc/O,QAAQD,KAAK;AAC1C,UAAIiP,IAAMD,EAAchP,IACpByC,IAAQ3F,EAAUyR,yBAAyBU,EAAIxM,OAAOrF,EAAOqF,KAAAA;AACjE,UAAIA,EAAMxC;AACTgP,UAAIxM,QAAQA;AAAAA,WACR;AACJuM,QAAAA,EAAcV,OAAOtO,GAAE,CAAA,GACvBA;AAGA,iBADIkP,IAAgBpS,EAAUyQ,sBAAsB0B,EAAIlP,KAC/C0J,IAAE,GAAGA,IAAEyF,EAAcjP,QAAQwJ;AACrC,cAAIyF,EAAczF,CAAAA,KAAMwF,GAAK;AAC5BC,YAAAA,EAAcZ,OAAO7E,GAAG,CAAA;AACxB;AAAA,UACA;AAAA,MAEF;AAAA,IACD;AAAA,EACH,GACC3M,EAAUiH,uBAAuB,SAASmJ,GAQzC;AAAA,QANKiC,UAAUlP,WACdnD,EAAUuH,oBAAoB,EAAEzH,QAAQ,CAAE,EAAA,GAC1CE,EAAUyQ,wBAAwB,IAClCzQ,EAAU2Q,0BAA0B,YAG1BP,KAAiB;AAC3BpQ,QAAU4R,8BAA8BxB,CAAAA;AAAAA,SAClC;AAEDA,MAAAA,EAAc7O,cAAc6O,EAAc5O,aAC3C4O,EAAc1K,SAD6BlE,UACN4O,EAAcvK,SACrDuK,EAAc1K,OAAO,aAClB0K,EAAczK,UACjByK,EAAczK,QAAQ;AAGxB,UAAI2M,IAAQ,CAAA;AACZ,UAAIlC,EAAcvK;AAMjByM,QAAAA,EAAM3P,KAAKyN,EAAcvK,IAAAA;AAAAA;AAJzB,iBAAQA,KAAQ7F,EAAU2Q;AACzB2B,UAAAA,EAAM3P,KAAKkD,CASb;AAAA,eAFIoL,IAAUjR,EAAU0L,0BAA0B0E,IAEzClN,IAAE,GAAGA,IAAE+N,EAAQ9N,QAAQD;AAG/B,iBADI5C,IAAS2Q,EAAQ/N,CACZqP,GAAAA,IAAE,GAAGA,IAAID,EAAMnP,QAAQoP,KAAI;AACnC,cAAIC,IAAcxS,EAAUiM,YAAY3L,CAAAA;AACxCkS,UAAAA,EAAY3M,OAAOyM,EAAMC,CACzBvS,GAAAA,EAAU8R,kCAAkCU,CAC5C;AAAA,QAAA;AAAA,IAGF;AAAA,EACH,GACCxS,EAAUyS,uBAAuB,SAASC,GAAQC,GAAAA;AACjD,QAAIC,IAAkBL,IAAWvS,EAAU0M,WAAW,IAAGgG,CAAU,IAAA;AACnE,aAAS7M,KAAQ8M,KAAU;AACtBA,MAAAA,EAASpG,eAAe1G,CAAAA,MAC3B+M,EAAgB/M,CAAQ8M,IAAAA,EAAS9M,CAGnC;AAAA,WAAO+M;AAAAA,EACT,GACC5S,EAAU6S,yBAAyB,SAASP;AAC3C,QAAIrB,IAAU;AACd,aAASpL,KAAQyM;AACZA,MAAAA,EAAM/F,eAAe1G,CACxBoL,KAAAA,EAAQtO,KAAKuJ,MAAM+E,GAASqB,EAAMzM,CAGpC,CAAA;AAAA,WAAOoL;AAAAA,EACT,GAECjR,EAAU8P,uBAAuB,SAAS9B,GAAMC,GAAAA;AAC/C,SAAIjO,EAAUyK,eAAezK,EAAU0K,SAAS,SAAhD;AAGA,UAAIzE,IAAYgI,EAAIxG,UAChBvB,IAAY+H,EAAIxL,WAChB8B,IAAO+E,KAAKoB,OACZ1E,IAAYhG,EAAUuH,mBACtBoE,IAAY,CACZkE,GAAAA,IAAO;AACX,UAAIvG,KAAKhD,UAAUgD,KAAKhD,OAAO/B,IAAO;AACrC,YAAImC,IAAO4C,KAAKhD,OAAO/B,CAAAA,GACnBuO,IAAQpM,EAAKd,SAEbmN,IAAOD,EADC9S,EAAUgT,gBAAgBtM,GAAMuH,CAAAA,CAAAA;AAG5C,YAAKvH,EAAKhB,OAAO,GAEZ;AACJ,cACIuN,IAAU7D,KAAKM,OAAOzB,IAAMjO,EAAUkK,aADjC,KAAA,GAELgJ,IAAcxM,EAAKoE,QAAQgI,EAAM3P;AACrC8K,UAAAA,IAAMjO,EAAUgC,KAAKC,IAAIjC,EAAUkK,WAAWkF,KAAK+D,MAAMF,IAAQC,CAAAA,GAAc,KAC/EjF,GAAAA,IAAMjO,EAAUgC,KAAKwF,UAAUyG;QAC/B;AAPAA,UAAAA,IAAMjO,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAK8G,KAAK8J,KAAAA,CAAAA;AAW9C,YAHAnN,IAAYgI,EAAIxG,UAChBvB,IAAY+H,EAAIxL,WAEZuD,EAAUzB,CAAAA,KAASyB,EAAUzB,CAAAA,EAAMwO,EAAKM,GAAAA,GAAM;AACjD,cAAIC,IAAatN,EAAUzB,CAAMwO,EAAAA,EAAKM,MAClCE,IAAavT,EAAUyS,qBAAqBa,EAAWrN,CAAYqN,GAAAA,EAAWpN;AAClFyF,UAAAA,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBU,CACjE,CAAA;AAAA,QAAA;AAAA,MACD;AAED,UAAIC,IAAcxN,EAAkB;AAEpC,UAAGhG,EAAUM,OAAOgF,4BAA2B;AAC9C,YAAImO,IAAYD,EAAYtN,CAAYsN,KAAAA,EAAYvN,CACpD0F;AAAAA,QAAAA,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBY,CAAAA,CAAAA;AAAAA,MACpE;AACMD,QAAAA,EAAYtN,CAAAA,KACdyF,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBW,EAAYtN,MAE3EsN,EAAYvN,CAAAA,KACd0F,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBW,EAAYvN;AAI/E,eAAS/C,IAAE,GAAGA,IAAEyI,EAAUxI,QAAQD;AACjC2M,QAAAA,EAAKlN,KAAKuJ,MAAM2D,GAAO7P,EAAUmL,wBAAwBQ,EAAUzI,IAAI8K,GAAMC,CAAAA,CAAAA;AAE9E,aAAO4B;AAAAA,IAlDC;AAAA,EAmDV,GACC7P,EAAUsE,YAAY,cAAc,WACnCtE;AAAAA,MAAU8P,qBAAqB5D,MAAMlM,GAAWqS;EAClD,CAECrS,GAAAA,EAAU0T,+BAA+B,SAASlP,GAAEmP,GAAAA;AACnD3T,MAAUmJ,UAAU,mBAAkB,CAACnJ,EAAU+E,cAAcP,GAAGxC,MAAK2R,GAAInP,CAEvExE,CAAAA,GAAAA,EAAUM,OAAOsT,mBACpB5T,EAAU6T,YAAY7T,EAAU+E,cAAcP,CAAGxC,EAAAA,MAAK,MAAKwC,CAE9D;AAAA,EAAA;AAEA;AC/8BA,SAASsP,GAAa9T,GAAAA;AACrB,MAAI+T,IAAU,CAAA,GACVC,IAAW;AACf,WAASC,EAAcC,GAAYC,GAClCA;AAAAA,IAAAA,IAAqBA,OAAAA,KAAe,aAAaA,IAAc,WAAU;AAAA,IAAA,GAErEJ,EAAQG,CACXH,MAAAA,EAAQG,KAAc5K,KAAK4K,CAAAA,GAC3B5K,KAAK4K,CAAAA,IAAcC;AAAAA,EAEpB;AACD,WAASC,EAAcF,GAAAA;AACnBH,IAAAA,EAAQG,CACV5K,MAAAA,KAAK4K,KAAcH,EAAQG,CAAAA,GAC3BH,EAAQG,CAAAA,IAAc;AAAA,EAEvB;AACD,WAASG,EAAeC,GAAAA;AACvB,aAAQpR,KAAKoR;AACZL,MAAAA,EAAcM,KAAKjL,MAAMpG,GAAGoR,EAAYpR,CAAAA,CAAAA;AAAAA,EAEzC;AACD,WAASsR,IAAAA;AACR,aAAQtR,KAAK6Q;AACZK,MAAAA,EAAcG,KAAKjL,MAAMpG,CAE1B;AAAA,EAAA;AAED,WAASuR,EAAmBC,GAAAA;AAC3B;AACCA,MAAAA,EACA;AAAA,IAAA,SAAMlQ,GACN3E;AAAAA,aAAO8U,QAAQC,MAAMpQ,CACrB;AAAA,IAAA;AAAA,EACD;AAQD,SANAxE,EAAU6U,eAAeC,iBAAiB,eAAe;AACxD,WAAO,EACNC,cAAcf,EAAAA;AAAAA,EAEf,GAAE,EAAA,GAEI,SAAqBU,GAAUM,GAAAA;AACrC,QAAGhB;AAGF,aAAA,KADAS,EAAmBC,CAIpB;AAAA,QACIO,GADAC,IAAW5L,KAAK6L,OAAO7L,KAAK6L,IAAIC,cAAc;AAE9CF,IAAAA,MACHD,IAAU3L,KAAK6L,IAAIC,YACnB9L,KAAK6L,IAAIE,cAAc,KAAA;AAKxB,UAAMC,IAAQ,EACbC,aAAa,EAACvT,MAAM,MAAMuC,MAAM,KAAA,GAChCiR,YAAY,IACZC,gBAAgB,IAChBC,eAAe,CAAE,EAAA,GAIZC,IAAmB,CAAC3T,GAAMuC;AAC5BvC,MAAAA,MACFsT,EAAMC,YAAYvT,OAAOA,IAEvBuC,MACF+Q,EAAMC,YAAYhR,OAAOA;AAAAA,IACzB;AAGF,QAAIwP,IAAU,EACb6B,QAAO,CAAC5T,GAAMuC,MAAU+Q;AAAAA,MAAAA,EAAME,iBAAmBG,EAAiB3T,GAAMuC,CAAK;AAAA,IAAA,GAC7EsR,gBAAe,CAAC7T,GAAMuC;AAAU+Q,MAAAA,EAAME,aAAAA,IAAmBG,EAAiB3T,GAAMuC;IAAK,GACrFuR,YAAW,CAAC9T,GAAMuC,MAAAA;AAAU+Q,MAAAA,EAAMG,iBAAAA,IAAuBE,EAAiB3T,GAAMuC,CAAK;AAAA,IAAA,GACrFwR,aAAY,MAAMT,EAAME,iBACxBQ,kBAAkB7N,CAAAA,MACdA;AAAAA,MAAAA,KAAOA,EAAIhF,SACbgF,EAAI/D,QAASI,CAAAA,MAAM8Q,EAAMI,cAAclR,EAAEvB,QAEzCqS,IAAAA,EAAME,aAAa;AAAA,IACnB,EAgBH;AAAA,QAZAnB,EAAeE,KAAKjL,MAAMyK,IAE1BC,IAAW,IACX1K,KAAKH,UAAU,uBAAuB,CAEtCsL,CAAAA,GAAAA,EAAmBC,CAEnBpL,GAAAA,KAAKH,UAAU,sBAAsB,CAAA,CAAA,GAErCqL,EAAeD,KAAKjL,IAAAA,GAEpB0K,QACIgB,CAAAA;AACH,UAAGM,EAAME;AACRxV,UAAU4V,OAAON,EAAMC,YAAYvT,MAAMsT,EAAMC,YAAYhR;eACnD+Q,EAAMG;AACdzV,UAAU8V,WAAWR,EAAMC,YAAYvT,MAAMsT,EAAMC,YAAYhR,IAE/D;AAAA;AAAA,mBAAUrB,KAAKoS,EAAMI;AACpB1V,YAAUiW,YAAY/S,CAAAA;AAKrBgS,IAAAA,MACH5L,KAAK6L,IAAIE,cAAcJ,CACvB3L,GAAAA,KAAK6L,IAAIe,SAEZ;AAAA,EAAA;AACA;ACtHA,MAAM3D,GAAE;AAAA,EAAA,YAAYA,GAAG;AAAA,UAAA,EAAM4D,KAAI3R,GAAE4R,OAAMhQ,MAAGmM;AAAEjJ,SAAK+M,OAAK7R,GAAE8E,KAAKgN,SAAOlQ,GAAEkD,KAAKoB,QAAM,GAAEpB,KAAKiN,QAAM,GAAEjN,KAAKkN,SAAO,CAAGlN,GAAAA,KAAKsG,OAAK,CAAE,GAACtG,KAAKmN,MAAI,CAAE,GAACnN,KAAKoN,UAAQ,CAAA;AAAA,EAAE;AAAA,EAAC,UAAU;AAAA,WAAM,EAACC,QAAO,oBAAmB,gBAAe,oBAAmB,gBAAerN,KAAKgN,OAAO;AAAA,EAAA;AAAA,EAAC,MAAM/D,GAAE/N,GAAAA;AAAG,UAAM4B,IAAE,EAACwQ,aAAY,WAAUC,SAAQvN,KAAKuN,QAAW,EAAA;AAAA,WAAOrS,MAAI4B,EAAE0Q,SAAO,QAAO1Q,EAAE2Q,OAAKvS,IAAGwS,MAAMzE,GAAEnM,CAAAA,EAAG6Q,KAAK1E,CAAAA,MAAGA,EAAE2E,KAAO,CAAA;AAAA,EAAA;AAAA,EAAC,KAAK3E;AAAG,WAAOA,MAAIjJ,KAAK+M,OAAK9D,IAAGjJ,KAAK0N,MAAM1N,KAAK+M,IAAMY,EAAAA,KAAK1E,CAAAA,MAAGjJ,KAAK6N,MAAM5E,CAAG,CAAA;AAAA,EAAA;AAAA,EAAC,MAAMA,GAAAA;AAAG,YAAMc,KAAI7O,GAAE4S,WAAUhR,EAAGmM,IAAAA;AAAE/N,UAAI8E,KAAKgN,SAAO/D,EAAEc;AAAK,eAAU7O,KAAK+N,EAAE3C;AAAKtG,WAAKsG,KAAKpL,CAAAA,IAAG+N,EAAE3C,KAAKpL,CAAAA;AAAG,eAAUA,KAAK+N,EAAEkE,KAAI;AAAC,YAAMrQ,IAAEkD,KAAKmN,IAAIjS,KAAG,IAAGtB,IAAEqP,EAAEkE,IAAIjS;AAAG,iBAAU+N,KAAKrP;AAAEkD,QAAAA,EAAEmM,CAAAA,IAAGjJ,KAAK+N,SAAS7S,IAAE,MAAI+N,CAAE;AAAA,IAAA;AAAC,WAAOnM,KAAGkD,KAAKgO,QAAUhO,GAAAA;AAAAA,EAAI;AAAA,EAAC;AAAU,UAAMiJ,IAAEjJ,KAAKiO;AAAQhF,IAAAA,MAAIjJ,KAAKiO,UAAQ,MAAKhF,EAAEiF,UAAQ,WAAY;AAAA,IAAA,GAACjF,EAAEkF,MAASnO,IAAAA,KAAKoB,QAAM,GAAEpB,KAAKiO,UAAQ,SAAShF,GAAE/N,GAAE4B,GAAElD,GAAG;AAAA,UAAI+B,IAAET;AAAE,MAAMS,EAAE,CAAKA,MAAb,QAAaA,IAAE2I,SAAS8J,SAASC,WAAS,OAAK/J,SAAS8J,SAASE,OAAKpT,IAAGS,IAAEA,EAAE4S,QAAQ,cAAa,OAAA;AAAS,YAAMC,IAAM7S,EAAEkL,QAAQ,GAAK,KAAlB,KAAkB,MAAI;AAAIlL,MAAAA,IAAE,GAAGA,IAAI6S,CAAU1R,SAAAA,CAAAA;AAAS,YAAM2R,IAAE,IAAIC,UAAU/S,CAAAA;AAAG,aAAO8S,EAAEP,UAAQ,MAAIS,WAAW,MAAI1F,EAAE+E,QAAAA,GAAU,MAAKS,EAAEG,YAAU1T,CAAAA,MAAI;AAAA,cAAM4B,IAAE+R,KAAKhB,MAAM3S,EAAEoL,IAAAA;AAAM,gBAAOxJ,EAAEgS,QAAAA;AAAAA,UAAQ,KAAI;AAAS7F,YAAAA,EAAE8F,OAAOjS,EAAE2Q,MAAK,CAAA,CAAA;AAAI;AAAA,UAAM,KAAI;AAAQxE,YAAAA,EAAE+F,KAAKlS,EAAE2Q,KAAKwB,MAAKnS,EAAE2Q,KAAKyB,KAAAA;AAAO;AAAA,UAAM,KAAI;AAAQtV,cAAI;AAAA;AAAA,UAAM;AAAQqP,YAAAA,EAAEkG,QAAQrS,EAAEwJ,IAAK;AAAA,QAAA;AAAA,MAAA,GAAGmI;AAAAA,IAAC,EAAEzO,MAAKA,KAAK+M,MAAK/M,KAAKgN,QAAO,OAAKhN,KAAKoB,QAAM,GAAEpB,KAAKoP,MAAQpP,GAAAA,KAAKqP,aAAerP,GAAAA,KAAAA;AAAAA,EAAM;AAAA,EAAC,SAASiJ;AAAG,YAAO,WAAA;AAAW,YAAM/N,IAAE,CAAA,EAAGuH,MAAMwI,KAAKlC,SAAW;AAAA,UAAIjM,IAAE;AAAK,YAAMlD,IAAE,IAAI0V,QAAQ,CAAC1V,GAAE+B,MAAAA;AAAKmB,YAAE,EAACwJ,MAAK,EAAC3M,IAAGqG,KAAKuP,QAAON,MAAKhG,GAAEuG,MAAKtU,EAAGuU,GAAAA,QAAO,GAAEC,SAAQ9V,GAAE+V,QAAOhU,KAAGqE,KAAKkN,OAAO7T,KAAKyD,CAAC;AAAA,MAAA,CAAA;AAAI,aAAOkD,KAAK4P,OAAO9S,GAAElD,CAAAA,GAAOoG,KAAKoB,UAAT,IAAepB,KAAKoP,MAAMtS,KAAG6R,WAAW,MAAI3O,KAAKoP,MAAQ,GAAA,CAAA,GAAGxV;AAAAA,IAAC,GAAEiW,KAAK7P,IAAAA;AAAAA,EAAK;AAAA,EAAC,OAAAuP;AAAO,YAAOvP,KAAKiN,SAAS6C;EAAU;AAAA,EAAC,MAAM7G,GAAAA;AAAG,QAAMjJ,KAAKoB,SAAR;AAAc,aAAA,KAAYuN,WAAW,MAAI3O,KAAKoP,SAAQ,GAAK;AAAA,UAAMlU,IAAE+N,IAAE,CAACA,CAAAA,IAAGjJ,KAAKkN,OAAO6C,OAAO9G,CAAAA,MAAOA,EAAEwG,WAAN;AAAc,QAAIvU,CAAAA,EAAErB;AAAO;AAAO,UAAMiD,IAAE5B,EAAEX,IAAI0O,CAAAA,OAAIA,EAAEwG,SAAO,GAAExG,EAAE3C,KAAO;AAAA,IAAItG,KAAKoB,UAAT,IAAepB,KAAK0N,MAAM1N,KAAK+M,MAAK8B,KAAKmB,UAAUlT,CAAImT,CAAAA,EAAAA,MAAMhH,CAAAA,MAAGjJ,KAAKmP,QAAQlG,CAAI0E,CAAAA,EAAAA,KAAK1E,CAAAA,MAAGjJ,KAAK+O,OAAO9F,GAAEnM,CAAAA,CAAAA,IAAIkD,KAAKiO,QAAQiC,KAAKrB,KAAKmB,UAAU,EAAClB,QAAO,QAAOrB,MAAK3Q,EAAAA,CAAAA,CAAAA;AAAAA,EAAI;AAAA,EAAC,OAAOmM,GAAE/N,GAAG;AAAA,UAAM4B,IAAE,CAAA;AAAG,QAAGmM;AAAE,eAAQ/N,IAAE,GAAEA,IAAE+N,EAAEpP,QAAOqB;AAAI4B,UAAEmM,EAAE/N,CAAAA,EAAGvB,EAAIsP,IAAAA,EAAE/N,CAAQ;AAAA;AAAA,eAAQ+N,IAAE,GAAEA,IAAE/N,EAAErB,QAAOoP;AAAInM,UAAE5B,EAAE+N,CAAGtP,EAAAA,EAAAA,IAAI,EAACA,IAAGuB,EAAE+N,CAAGtP,EAAAA,IAAG2R,OAAM,iBAAgBhF,MAAK;AAAM,aAAQ2C,IAAEjJ,KAAKkN,OAAOrT,SAAO,GAAEoP,KAAG,GAAEA,KAAI;AAAC,YAAM/N,IAAE8E,KAAKkN,OAAOjE,CAAGrP,GAAAA,IAAEkD,EAAE5B,EAAEoL,KAAK3M,EAAIC;AAAAA,MAAAA,MAAIoG,KAAKmQ,WAAWjV,GAAEtB,IAAGA,EAAE0R,QAAMpQ,EAAEyU,OAAO/V,EAAE0R,KAAAA,IAAOpQ,EAAEwU,QAAQ9V,EAAE0M,OAAMtG,KAAKkN,OAAOhF,OAAOe,GAAE,CAAA;AAAA,IAAG;AAAA,EAAC;AAAA,EAAC,GAAGA,GAAE/N,GAAAA;AAAG,UAAM4B,IAAEkD,KAAKuP;AAAO,QAAI3V,IAAEoG,KAAKoN,QAAQnE,CAAG;AAAA,UAAMtN,MAAI/B;AAAE,WAAO+B,MAAI/B,IAAEoG,KAAKoN,QAAQnE,CAAG,IAAA,CAAA,IAAIrP,EAAEP,KAAK,EAACM,IAAGmD,GAAEsT,SAAQlV,EAAAA,CAAAA,GAAIS,KAAMqE,KAAKoB,SAAR,KAAepB,KAAKiO,QAAQiC,KAAKrB,KAAKmB,UAAU,EAAClB,QAAO,aAAYG,MAAKhG,OAAK,EAACgG,MAAKhG,GAAEtP,IAAGmD,EAAAA;AAAAA,EAAE;AAAA,EAAC,eAAe;AAAA,QAAMkD,KAAKoB,SAAR;AAAc,iBAAU6H,KAAKjJ,KAAKoN;AAAQpN,aAAKiO,QAAQiC,KAAKrB,KAAKmB,UAAU,EAAClB,QAAO,aAAYG,MAAKhG,EAAI,CAAA,CAAA;AAAA,EAAA;AAAA,EAAC,OAAOA,GAAAA;AAAG,QAAIA,CAAAA,GAAE;AAAC,UAAMjJ,KAAKoB,SAAR;AAAc,mBAAU6H,KAAKjJ,KAAKoN;AAAQpN,eAAKiO,QAAQiC,KAAKrB,KAAKmB,UAAU,EAAClB,QAAO,eAAc/E,KAAId,EAAK,CAAA,CAAA;AAAA,aAAA,MAAYjJ,KAAKoN,UAAQ,CAAA;AAAA,IAAG;AAAC,UAAA,EAAMzT,IAAGuB,GAAE+T,MAAKnS,MAAGmM,GAAErP,IAAEoG,KAAKoN,QAAQtQ,CAAAA;AAAG,QAAGlD,GAAE;AAAC,YAAMqP,IAAErP,EAAEmW,OAAO9G,CAAAA,MAAGA,EAAEtP,MAAIuB;AAAG+N,MAAAA,EAAEpP,SAAOmG,KAAKoN,QAAQtQ,CAAGmM,IAAAA,KAAAA,OAAUjJ,KAAKoN,QAAQtQ,CAAAA,GAAMkD,KAAKoB,SAAR,KAAepB,KAAKiO,QAAQiC,KAAKrB,KAAKmB,UAAU,EAAClB,QAAO,eAAcG,MAAKnS,EAAAA,CAAAA,CAAAA;AAAAA,IAAK;AAAA,EAAC;AAAA,EAAC,KAAKmM,GAAE/N,GAAAA;AAAG,UAAM4B,IAAEkD,KAAKoN,QAAQnE;AAAG,QAAGnM;AAAE,eAAQmM,IAAE,GAAEA,IAAEnM,EAAEjD,QAAOoP;AAAInM,UAAEmM,CAAAA,EAAGmH,QAAQlV,CAAE;AAAA,EAAA;AAAA,EAAC,QAAQ+N,GAAAA;AAAG,WAAO;AAAA,EAAI;AAAA,EAAC,OAAOA,GAAE/N,GAAAA;AAAAA;EAAI,WAAW+N,GAAE/N,GAAI;AAAA,EAAA;AAAA;ACEnpG,MAAqBmV,GAIpB;AAAA,EAAA,YAAYxD,GAAaC,GAClB;AAAA,UAAAwD,IAAS,IAAIC,GAAO,EACzB1D,KACAC,GAAAA,OAAAA,EAAAA,CAAAA;AAIMwD,MAAA5C,QAAQ,SAAUb,GAAaY,GACrC;AAAA,YAAM+C,IAAmB,EACxBjD,SAASvN,KAAKuN,QAOR,EAAA;AAAA,aALHE,MACH+C,EAAIhD,SAAS,QACbgD,EAAI/C,OAAOA,IAGLC,MAAMb,GAAK2D,CAAAA,EAAK7C,KAAY7P,CAAAA,MAAAA,EAAI8P;IAAM,GAGzC5N,KAAAyQ,SAASH,EAAOI,KAAO/C,EAAAA,KAAcgD,CAAAA,MAAA3Q,KAAK4Q,UAAUD;EAC1D;AAAA,EAEU;AACT,WAAO3Q,KAAKyQ;AAAAA,EACb;AAAA,EAEU,GAAGxB,GAAoBmB,GAC3BpQ;AAAAA,SAAA6Q,QAAQlD,KAAagD,OAAAA;AACzB,UAAW1B,OAAAA,KAAS;AAAe0B,UAAAG,GAAG7B,GAAMmB,CAAAA;AAAAA;AAE3C,mBAAWrG,KAAOkF;AACjB0B,YAAKG,GAAG/G,GAAKkF,EAAKlF,CAAAA,CAAAA;AAAAA,IAEpB,CAEF;AAAA,EAAA;AAAA;ACzCD,SAASgH,GAAera;AAgCvB,WAASsa,EAAczU,GAAMzF,GAC5B;AAAA,YAAQyF;MACP,KAAK;AAAA,SAuBP,SAAwB0U,GAAAA;AACvB,cAAIva,EAAUyE,SAAS8V,EAAUtX,EAAAA;AAGhC,wBADA0R,QAAQ6F,KAAK,iBAAiBD,EAAUtX,EAAAA,gCAAAA;AAIzCsX,UAAAA,EAAUhZ,aAAavB,EAAUya,UAAUC,WAAWH,EAAUhZ,UAAAA,GAChEgZ,EAAU/Y,WAAWxB,EAAUya,UAAUC,WAAWH,EAAU/Y,QAC1D+Y,GAAAA,EAAUI,mBACbJ,EAAUI,iBAAiB3a,EAAUya,UAAUC,WAAWH,EAAUI,cAAAA,IAGrEC,EAAO,MACN5a;AAAAA,cAAU6a,SAASN,CAAAA;AAAAA,UAAU,CAG9B;AAAA,QAAA,GAvCiBna,CACf;AAAA;AAAA,MACD,KAAK;AAuCP,SAAA,SAA2Bma;AAC1B,gBAAMO,IAAMP,EAAUtX;AAEtB,cAAKjD,CAAAA,EAAUyE,SAASqW,CAGvB;AAAA,mBAAA,KADAnG,QAAQ6F,KAAK,iBAAiBM;AAI/B,gBAAMC,IAAgB/a,EAAUyE,SAASqW,CAEzCF;AAAAA,UAAAA,EAAO;AACN,qBAASvH,KAAOkH;AACH,cAARlH,MAAQ,gBAAgBA,MAAQ,eACnC0H,EAAc1H,CAAAA,IAAOkH,EAAUlH,CAAAA;AAGjC0H,YAAAA,EAAcxZ,aAAavB,EAAUya,UAAUC,WAAWH,EAAUhZ,aACpEwZ,EAAcvZ,WAAWxB,EAAUya,UAAUC,WAAWH,EAAU/Y,WAC9D+Y,EAAUI,mBACbJ,EAAUI,iBAAiB3a,EAAUya,UAAUC,WAAWH,EAAUI,cAErE3a,IAAAA,EAAUmJ,UAAU,kBAAkB,CAAC2R,GAAKC,CAAAA,CAAAA,GAC5C/a,EAAUiW,YAAY6E,CAAAA,GAElBA,MAAQP,EAAUtX,MACrBjD,EAAUgb,cAAcF,GAAKP,EAAUtX;UACvC,CAGF;AAAA,QAAA,GApEoB7C,CAClB;AAAA;AAAA,MACD,KAAK;AAoEP,SAAA,SAA2Bma;AAC1B,gBAAMO,IAAMP,EAAUtX;AAEtB,cAAA,CAAKjD,EAAUyE,SAASqW,CAAAA;AAOvB,yBALIP,EAAUU,aACbL,EAAO,MAAA;AACN5a,gBAAU6a,SAASN;YAAU,CAMhCK;AAAAA,UAAAA,EAAO;AACN,kBAAMxa,IAAQJ,EAAUyE,SAASqW,CAAAA;AAEjC,gBAAI1a,GAAO;AAEV,kBAAIA,EAAMgI,YAAYhI,EAAM8a,OAAO;AAClClb,kBAAUmb,iBAAiB/a,CAE3B;AAAA,sBAAMgb,IAAUpb,EAAUqb,iBAAiBP,CAAAA;AAC3C,2BAAWQ,KAAYF;AAClBpb,oBAAUyE,SAAS6W,MACtBtb,EAAUub,YAAYD,GAAU,EAAA;AAAA,cAGlC;AAGD,kBAAItb,EAAU4E,SAAW4W,EAAAA,eAAeV,MACvCxR,KAAKmS,aAAanS,KAAKoS,cACvBnB,EAAUtX,KAAKqG,KAAKoS,cACpBpS,KAAKoN,QAAQpN,KAAKoS,YAAAA,IAAgBnB,GAC9Bva,EAAUmJ,UAAU,yBAAyB,CAAC2R,GAAK,MAAM,UAAUP,CAAAA,CAAAA;AAGtE,4BADAva,EAAU2b,YAAAA,IAAmB3b,EAAU4b,SAAAA;AAMzC5b,gBAAUub,YAAYT,GAAAA,EACtB;AAAA,YAAA;AAAA,UAAA,CAAA;AAAA,QAIF,GAlHoB1a;;EAKpB;AAED,WAASwa,EAAOiB,GACZ7b;AAAAA,MAAUmV,MACZnV,EAAUmV,IAAIyF,OAAOiB,CAAAA,IAGrBA,EAED;AAAA,EAAA;AAsGD,SAAO,EACNC,QA5JD,SAAuBC,GACtB;AAAA,QAAA,CAAKA,MAAYA,EAAQ3b,SAAAA,CAAU2b,EAAQ3b,MAAM6C;AAGhD,aAAA,KADA0R,QAAQC,MAAM,2BAA2BmH;AAI1C,UAAMlW,EAAAA,MAAEA,GAAIzF,OAAEA,EAAAA,IAAU2b;AAExB,QAAA,CAAI/b,EAAUmV,IAAI6G,aAAa5b,EAAM6C,EAAAA,GAArC;AAIA,UAAI4C,MAAS;AACZ,mBAAW5C,KAAMjD,EAAUmV,IAAI6G;AAC9B,cAAIhc,EAAUmV,IAAIvQ,SAAS3B,CAAAA,MAAQ;AAMlC,wBALAjD,EAAUmV,IAAI7Q,YAAY,cAAc,WAClCtE;AAAAA,gBAAUyE,SAASrE,EAAM6C,EAAAA,KAC7BqX,EAAczU,GAAMzF,CAAAA;AAAAA,YAE3B,GAAQ,EAAE6b,MAAAA,GAMR3B,CAAAA;AAAAA;AAAAA,MAAAA,EAAczU,GAAMzF,CAAAA;AAAAA,IAfnB;AAAA,EAiBD,EAkIF;AAAA;AC1Je,SAAS8b,GAAYlc,GAAAA;AAAAA,GCNrB,SAAoBA,GAClC;AAAA,UAAMmc,IAAkB,CAAA;AACxBnc,IAAAA,EAAUsE,YAAY,gCAAgC,SAAUrB;AAE/D,aADAkZ,EAAgBlZ,SACT;AAAA,IACT,CACCjD,GAAAA,EAAUsE,YAAY,kBAAkB,SAAUrB,GAAI8C,GAAAA;AACrD,WAAIoW,EAAgBlZ,CAAAA;AAInB;aAHOkZ,EAAgBlZ,CAAAA;AAKxB,UAAImZ,IAAepc,EAAUqc,KAAKtW,CAC9B/F;AAAAA,MAAAA,EAAUM,OAAOgc,gBAAiBtc,CAAAA,EAAU4E,WAAW2X,aAC1Dvc,EAAU+b,QAAQ,EACjBS,MAAM;AAAA;AAAA,iFAEuEzW,EAAG9C,EAEhFwZ;AAAAA,iCAAAA,QAAQ,KACR5W,MAAM,sBACN6O,UAAU,SAAUlQ,GAAAA;AACLA,QAAAA,EAAEE,OAAOC,QACtB,2BAA2BoB,EAAG9C,EAI1BmZ,IAAAA,MAAAA,EAAalB,SAASkB,EAAaM,aACtCN,EAAa5a,WAAW,IAAIgB,KAAK4Z,EAAa7a,WAAWkB,QAAAA,IAAoC,MAAxB2Z,EAAaM,QAAAA,GAClF1c,EAAU6a,SAASuB,CAAAA,IAEpBpc,EAAU6a,SAASuB,CAAAA,GACnBpc,EAAU4V,OAAAA;AAAAA,MAEX,EAGL,CAAA;AAAA,IAAA,CAAA;AAAA,EACA,GDhCe5V,CAAAA,GACXD,GAAiBC,CACjB2c,GAAAA,GAAM3c,IJ+GK,SAASA,GAAAA;AACvBA,IAAAA,EAAU4c,cAAc9I,GAAa9T,CAAAA;AAAAA,EACtC,EIhHgBA,CAAAA,GEPD,SAAsBA,GAC/BA;AAAAA,IAAAA,EAAU6c,QACd7c,EAAU6c,MAAM,KAGjB7c,EAAU6c,IAAIC,cAAc,EAC3BnD,cAAAA,IACAoD,eAAe1C,GAAera,CAAAA,EAAAA;AAAAA,EAEhC,EFDiBA,CAAAA;AACjB;AGZA,IAAIgd,KAAUxa,KAAKsH;AAiCnB,SAASmT,GAAOva;AACf,SAAIA,EAAAA,CAAAA,YAAcA,KAAQ,aACfA,CAAAA,EAAAA,EAAIwa,eAAexa,EAAIya,YAAYza,EAAImF;AAInD;AAiCA,MAAeuV,KAAA,EACd/Q,KAxED;AACC,SAAO2Q;AACR,GAuECK,OAAO,SAAgB3Y,GAAQ4Y,GAAQC,GACtC;AAAA,WAASC,KAAKF;AAAAA,KACP5Y,EAAO8Y,CAAAA,MADAF,UACqBC,OAAQ7Y,EAAO8Y,CAAGF,IAAAA,EAAOE;AAC5D,SAAO9Y;AACP,GACD2X,MAAM,SAASA,EAAKoB,GACnB;AAAA,MAAIva,GAAGmV,GA1EQ3V;AA4Ef,MAAI+a,KAAiBA,OAAAA,KAAU;AAE9B,gBACC;AAAA,MAAA,KAAMR,GAAOQ,CACZpF;AAAAA,QAAAA,IAAS,IAAI7V,KAAKib,CAClB;AAAA;AAAA,MACD,MAlFa/a,IAkFC+a,GAjFd5R,MAAM6R,UACD7R,MAAM6R,QAAQhb,CAGbA,IAAAA,KAAOA,EAAIS,WAAXT,UAAmCA,EAAIib,OAAOjb,EAAIC;AA+EvD,aADA0V,IAAS,IAAIxM,MAAM4R,EAAOta,MAAAA,GACtBD,IAAI,GAAGA,IAAIua,EAAOta,QAAQD;AAC7BmV,UAAAA,EAAOnV,KAAKmZ,EAAKoB,EAAOva;AAEzB;AAAA,MACD,KA9EJ,SAAwBR,GAAAA;AACvB,eAAOA,YAAcA,KAAQ,YAC5Bkb,SAASC,UAAUzE,SAAS7E,KAAK7R,EAAIob,WAAAA,MAAiB;AAAA,MACxD,EA2EyBL,CAAAA;AACpBpF,QAAAA,IAAS,IAAI3U,OAAO+Z;AACpB;AAAA,MACD,KA3EJ,SAAwB/a,GACvB;AAAA,eAAOA,KAAsB,OAARA,KAAQ,YAC5Bkb,SAASC,UAAUzE,SAAS7E,KAAK7R,EAAIob,WAAAA,MAAiB;AAAA,MACxD,EAwEyBL,CAAAA;AACpBpF,QAAAA,IAAS,IAAI0F,OAAON,CAAAA;AACpB;AAAA,MACD,KAxEJ,SAAyB/a;AACxB,eAAOA,YAAcA,KAAQ,YAC5Bkb,SAASC,UAAUzE,SAAS7E,KAAK7R,EAAIob,WACvC,MADwD;AAAA,MACxD,EAqE0BL,CACrBpF;AAAAA,QAAAA,IAAS,IAAI2F,QAAQP,CAAAA;AACrB;AAAA,MACD;AAEC,aAAKva,KADLmV,IAAS,CAAA,GACCoF,GAAQ;AACjB,gBAAMQ,WAAiBR,EAAOva,CAAAA;AAEd,UAAZ+a,MAAY,YAAYA,MAAY,YAAYA,MAAY,YAC/D5F,EAAOnV,KAAKua,EAAOva,CAAAA,IACV+Z,GAAOQ,EAAOva,CAAAA,CAAAA,IACvBmV,EAAOnV,CAAAA,IAAK,IAAIV,KAAKib,EAAOva,CACnBgb,CAAAA,IAAAA,OAAOL,UAAUtR,eAAeL,MAAMuR,GAAQ,CAACva,CAAAA,CAAAA,MACxDmV,EAAOnV,CAAAA,IAAKmZ,EAAKoB,EAAOva;QACzB;AAAA,IAIJ;AAAA,SAAOmV,KAAUoF;AACjB,GACDU,SA/ED,SAAiBzb,GAAAA;AAChB,SAAc;AACf,GA8EAua,QAACA,IACAmB,OA7ED,SAAgB1J,GAAU2J;AACzB,MAAIC,GAEAjG,IAAS,WAAA;AACZA,IAAAA,EAAOkG,eAAAA,GACPlG,EAAOmG,WAAW;AAClB,QAAI1F,IAAOjN,MAAMgS,UAAU9R,MAAMwI,KAAKlC,SACtCiM;AAAAA,IAAAA,IAAQrG,WAAW,WAAA;AAClBvD,QAASxI,MAAM5C,MAAMwP,IACrBT,EAAOmG,WAAAA;AAAAA,IACP,GAAEH,CAAAA;AAAAA,EACL;AAaC,SAXAhG,EAAOmG,WAAAA,IACPnG,EAAOkG,iBAAiB;AACvBE,iBAAaH,CAAAA,GACbjG,EAAOmG,WAAW;AAAA,EACpB,GACCnG,EAAOqG,WAAW,WAAA;AACjB,QAAI5F,IAAOjN,MAAMgS,UAAU9R,MAAMwI,KAAKlC;AACtCqC,MAASxI,MAAM5C,MAAMwP,CAAAA,GACrBT,EAAOkG,eAAAA;AAAAA,EACT,GAEQlG;AACR,EAAA;ACtEe,SAASsG,GAAO3e,GAAAA;AAE/B,WAASqL,EAAIyD,GAAAA;AACZ,QAAIhL,IAAU8J,SAASC,cAAc;AAKrC,YAJeiB,KAAa,IAAInL,MAAM,GAAA,EAC9BS,QAAQ,SAASwa,GAAAA;AACxB9a,MAAAA,EAAQ+a,UAAU5c,IAAI2c,CAAAA;AAAAA,IACxB,IACQ9a;AAAAA,EACR;AACA,MAAIgb,IACa,WAAA;AACf,WAAOzT,EAAI,+BAAA;AAAA,EACX,GAHEyT,IAIE,WAAA;AACJ,WAAOzT,EAAI,oBAAA;AAAA,EACX,GANEyT,IAOG,SAAUxe;AACf,QAAIwD,IAAUuH,EAAI,aAAA;AAiBlB,WAhBAvH,EAAQib,aAAa,QAAQze,EAAOoG,OAAO,MAC3C5C,GAAAA,EAAQib,aAAa,YAAYze,EAAOoG,IAErC1G,GAAAA,EAAUM,OAAO0e,qBAChB1e,EAAO2e,YACTnb,EAAQ+a,UAAU5c,IAAI,mBAAA,IACd3B,EAAO4e,WACfpb,EAAQ+a,UAAU5c,IAAI,kBACG,IAAhB3B,EAAOoG,SAAS,UACzB5C,EAAQ+a,UAAU5c,IAAI,wBAAA,GAGpB3B,EAAO6e,iBACTrb,EAAQ+a,UAAU5c,IAAI,uBAGjB6B,IAAAA;AAAAA,EACP,GA1BEgb,IA2BG,WAAA;AACL,WAAOzT,EAAI,cAAA;AAAA,EACX,GA7BEyT,IA8BK,SAAUxe,GACjB;AAAA,WAAO+K,EAAI,0DAAA;AAAA,EACX,GAhCEyT,IAiCY,SAAUxe;AACxB,WAAO+K,EAAI,aAAa/K,EAAOoG,OAAO,4BACtC;AAAA,EAAA,GAnCEoY,IAoCK,WAAA;AACP,WAAOzT,EAAI,qBAAA;AAAA,EACX,GAtCEyT,IAuCiB,SAASxe;AAC5B,QAAI8e,IAAkB/T,EAAI,kBAAA;AAmB1B,WAlBI/K,EAAO+e,SAAUD,EAAgBE,mBAEpCtf,EAAUI,MAAMgf,GAAiB,SAAS,WACrCpf;AAAAA,QAAUuf,kBACbvf,IAAAA,EAAUwf,gBAEVxf,IAAAA,EAAUyf,eAAe,EACxB1U,UAAUzB,MACVtH,MAAMhC,EAAU4E,WAAW5C,MAC3B0d,YAAAA,IACAhG,SAAS,SAAU1X,GAAM2d;AACxB3f,UAAU6V,eAAe7T,IACzBhC,EAAUwf,gBAAAA;AAAAA,MACV;IAGP,CAESJ,GAAAA;AAAAA,EACP;AAuCF,WAASQ,EAActf,GAAAA;AACtB,QAAIuf,IAlCL,SAAsBvf;AACrB,UAAIuf;AACJ,UAAIvf,EAAOoG;AACV,gBAAQpG,EAAOoG,MACd;AAAA,UAAA,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AACJmZ,YAAAA,IAAWf;AACX;AAAA,UACD,KAAK;AACJe,YAAAA,IAAWf;AACX;AAAA,UACD,KAAK;AACJe,YAAAA,IAAWf;AACX;AAAA,UACD,KAAK;AACJe,YAAAA,IAAWf;AACX;AAAA,UACD,KAAK;AACJe,YAAAA,IAAWf;AACX;AAAA,UACD;AACCe,YAAAA,IAAWf;AAAAA,QAGJxe;AAAAA;AAAAA,QAAAA,EAAOwf,OAChBD,IAAWf,IACFxe,EAAOyf,SAChBF,IAAWf;AAEZ,aAAOe;AAAAA,IACR,EAG6Bvf,CAC5B;AAAA,QAAIuf,GAAJ;AAGA,UAAI/b,IAAU+b,EAASvf,CAIvB;AAqBA,UAxBGA,EAAOmB,OACTqC,EAAQ+a,UAAU5c,IAAI3B,EAAOmB,MAE3BnB,EAAO0O,WACLwJ,IAAQlY,EAAO0O,WACE,IAARwJ,MACZA,KAAS,OAEV1U,EAAQ7C,MAAM+N,QAAQwJ,IAEpBlY,EAAOyO,YACLyJ,IAAQlY,EAAOyO,YACE,IAARyJ,MACZA,KAAS,OAEV1U,EAAQ7C,MAAM8N,SAASyJ,IAEpBlY,EAAO+e,SACVrf,EAAUI,MAAM0D,GAAS,SAASxD,EAAO+e,KAEtC/e,GAAAA,EAAOoB,SACVoC,EAAQgK,YAAYxN,EAAOoB,OAGxBpB,EAAO0f,OAAO;AACjB,YAAIxH,IAAQ;AACQ,QAAhBlY,EAAO0f,SAAS,UACnBxH,IAAQ,aACClY,EAAO0f,SAAS,WACzBxH,IAAQ,eAET1U,EAAQ7C,MAAMgf,iBAAiBzH;AAAAA,MAC/B;AACD,aAAO1U;AAAAA,IAnCN;AAAA,EAoCF;AAEA,WAASoc,EAAc5f,GAAAA;AAStB,WARWA,OAAAA,KAAW,aACrBA,IAAS,EACRoG,MAAMpG,MAGHA,EAAOoG,QAASpG,EAAOwf,QAASxf,EAAOyf,SAC3Czf,EAAOoG,OAAO,WAERpG;AAAAA,EACR;AAEA,WAAS6f,EAAa7f,GACrB;AAAA,QACI8f,GADAC,IAAWzS,SAAS0S,uBAAAA;AAGvBF,IAAAA,IADEvU,MAAM6R,QAAQpd,KACRA,IAEA,CAACA;AAGV,aAAS4C,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD,KAAK;AACtC,UAkBKqd,GAlBD7Z,IAAOwZ,EAAcE,EAAMld,CAAAA,CAAAA;AAE/B,MAAGwD,EAAKA,SAAS,SAAS0Z,EAAMld,IAAI,CAAA,OAC/Bqd,IAAOL,EAAcE,EAAMld,IAAI,CAAA,CAAA,GAC3BwD,SAAS,UAAU6Z,EAAK7Z,SAAS,YACxCA,EAAKuY,YAAY,IACjBvY,EAAKyY,gBAAgB,MAIpBzY,EAAKA,SAAS,UAAU0Z,EAAMld,IAAI,CAAA,OAChCqd,IAAOL,EAAcE,EAAMld,IAAI,CAAA,CAAA,GAC3BwD,SAAS,UAAU6Z,EAAK7Z,SAAS,YACxCA,EAAKyY,gBAAgB,MAIpBzY,EAAKA,SAAS,WAAW0Z,EAAMld,IAAI,QACjCqd,IAAOL,EAAcE,EAAMld,IAAI,CAAA,CAAA,GAC3BwD,SAAS,UAAU6Z,EAAK7Z,SAAS,UACxCA,EAAKwY,WAAAA,IACLxY,EAAKyY,gBAAAA;AAIP,UAAIrb,IAAU8b,EAAclZ;AAE5B2Z,MAAAA,EAAStS,YAAYjK,KAClB4C,EAAKqZ,QAAQrZ,EAAKoZ,SACpBhc,EAAQiK,YAAYoS,EAAazZ,EAAKqZ,QAAQrZ,EAAKoZ,IAEpD,CAAA;AAAA,IAAA;AACD,WAAOO;AAAAA,EACR;AAEArgB,IAAUwgB,gBAAgB,SAAUJ;AACnC,QAAIK,IAASnX,KAAKxG,WAAW4d,cAAc;AAC3C,WAAKD,OACJA,IAAS7S,SAASC,cAAc,KACzBiB,GAAAA,YAAY,wCACnB9O,EAAU2gB,gBAAgBP,GAAOK,CAAAA,GAC1BA;AAAAA,EAGT;AAGA,MAAIG,IAAiB;AACrB5gB,IAAU2gB,kBAAkB,SAAUrgB,GAAQkG,GAAAA;AAE7C,QAAIlG,GAAJ;AAGA,UAAIugB,IAAgB,IAGhBC,IAAYxgB,EAAOyO,UAAU/O,EAAU+gB,GAAGC;AAExB,MAAnBJ,MAAmB,QACnBA,MAAmBE,MACrBD,SAMEA,MACF7gB,EAAU+gB,GAAGC,aAAaF,IAG1Bta,EAAUsH,YAAY,IACtBtH,EAAUuH,YAAYoS,EAAa7f,KAInCN,EAAUihB,cAAAA,GACVjhB,EAAU6J,OAAO,CAAA,GACjB7J,EAAUuQ,aAAAA,GACVvQ,EAAUkhB,YAAAA,GAIV1a,EAAUvF,MAAMkgB,UADdL,MAAc,IACU,SAEA,IAG3BF,IAAiBE;AAAAA,IAnChB;AAAA,EAoCF;AAEA;ACvQe,SAASnC,GAAO3e,GAE9B;AAAA,WAASohB,EAAe5a,GACvB;AAAA,WAAGA,EAAU6a,gBAAb,SACQ7a,EAAU6a,cAEXzT,SAASmJ,KAAKuK,SAAS9a,CAC9B;AAAA,EAAA;AAED,WAAS+a,EAAc1hB,GAAAA;AACtB,WAAO,EACN2hB,GAAI3hB,EAAO4hB,cAAc7T,SAAS8T,gBAAgBC,aAClDC,GAAI/hB,EAAOgiB,eAAejU,SAAS8T,gBAAgBI;EAEpD;AAKD,WAASC,EAAmB/hB,GAAWH,GACtC;AAAA,QACImiB,GADAC,IAAUV,EAAc1hB;AAE5BG,IAAAA,EAAUI,MAAMP,GAAQ,UAAU,WAAA;AACjC4e,mBAAauD,CAAAA,GACbA,IAAc/J,WAAW;AAExB,YAAKmJ,EAAephB,EAAU8C,UAAe9C,KAAAA,CAAAA,EAAUkiB,YAAvD;AAGA,cAdaC,GAAEC,GAcXC,IAAUd,EAAc1hB;AAdbuiB,UAAAA,IAiBMC,KAjBRF,IAiBDF,GAhBLT,KAAKY,EAAEZ,KAAKW,EAAEP,KAAKQ,EAAER,OAiB3BK,IAAUI,GACVC,EAAuBtiB,CAAAA;AAAAA,QANvB;AAAA,MAQD,GAAE,GAAA;AAAA,IACN;EACE;AAED,WAASsiB,EAAuBtiB,GAAAA;AAC3BA,IAAAA,EAAUuiB,gBAAAA,CAAgBviB,EAAUkiB,cAAeliB,EAAUwiB,SAAUpB,EAAephB,EAAUwiB,UAGhGxiB,EAAUmJ,UAAU,qBAAqB,CAAA,CAAA,MAC5CnJ,EAAU8V,WAAAA,GACV9V,EAAUmJ,UAAU,0BAA0B;EAE/C;AA2BD,GAAA,SAA2BnJ;AAC1B,QAAIyiB,IAAOziB,EAAU8C;AAMrB,QALsBjD,OAAO6iB,iBAAiBD,CAAAA,EAC3BE,iBAAiB,UACnCF,KADkD,aAClDA,EAAKxhB,MAAM8J,WAAW,aAGpBlL,OAAO+iB,gBAAe;AACxB,UAAIC,IAAY;AAChB,YAAMC,IAAiB,IAAIF,eAAe,SAASG,GAAAA;AAC/CF,QAAAA,IACFA,IAAAA,KAGDP,EAAuBtiB;MAC3B,CACG8iB;AAAAA,MAAAA,EAAeE,QAAQP,CACvBziB,GAAAA,EAAUsE,YAAY,aAAa,WAAA;AAClCwe,QAAAA,EAAeG,UAAUR,CAC7B;AAAA,MAAA,CAAA;AAAA,IACA,OAAQ;AACL,UAAIS,IAAgBtV,SAASC,cAAc;AAC3CqV,MAAAA,EAAcpU,YAAY,sCAC1BoU,EAAcC,WAAY,IACvBnjB,EAAUM,OAAO8iB,wBACnBF,EAAcnE,aAAa,QAAQ,SACnCmE,EAAcnE,aAAa,eAAe,EAAA,IAIZlf,OAAa,QAAOA,OAAW,MAAKA,OAAa,OAvDlF,SAAyBG,GAAAA;AACxB,YAAI4gB,IAAiB5gB,EAAUwiB,MAAMa,cACjCC,IAAgBtjB,EAAUwiB,MAAMe;AAEpC,SAAA,SAASC;AACLxjB,UAAAA,EAAUkiB,eAIVliB,EAAUwiB,UACRxiB,EAAUwiB,MAAMa,gBAAgBzC,KACnC5gB,EAAUwiB,MAAMe,eAAeD,KAC/BhB,EAAuBtiB,CAGxB4gB,GAAAA,IAAiB5gB,EAAUwiB,MAAMa,cACjCC,IAAgBtjB,EAAUwiB,MAAMe,cAGjCtL,WAAWuL,GAAuB,GAAA;AAAA,QAClC,GAGD;AAAA,MAAA,EAkCkBxjB,CAEhByiB,KAAAA,EAAK1U,YAAYmV,CACbA,GAAAA,EAAcO,gBACjB1B,EAAmB/hB,GAAWkjB,EAAcO,aAG5ChB,KAAAA,EAAKjX,YAAY0X,CACjBnB,GAAAA,EAAmB/hB,GAAWH,MAAAA;AAAAA,IAGhC;AAAA,EAGD,GAEiBG,CAEnB;AAAA;AC7HA,MAAM0jB,GACL;AAAA,EAAA;AACCpa,SAAKqa,eAAAA,IACLra,KAAKsa,YAAY;EACjB;AAAA,EACD;AACCta,SAAKqa,eAAAA;AAAAA,EACL;AAAA,EACD,aACCra;AAAAA,SAAKqa,eAAe;AAAA,EACpB;;AAgDF,SAASE,GAAcnhB;AAEtB,QAAMohB,IAAY,IAAIJ;AACtBhhB,IAAI4B,cAAY,SAASyf,GAAWrK,GAASvX;AAC5C4hB,IAAAA,IAAY,QAAMA,EAAUC,YACvBF,GAAAA,EAAUF,UAAUG,CACxBD,MAAAA,EAAUF,UAAUG,CAAAA,IAnDI,SAASrhB,GAAAA;AACnC,UAAIuhB,IAAW,CAAA,GACXriB,IAAQ;AACZ,YAAMsiB,IAAe,WAAA;AACpB,YAAIC,IAAAA;AACJ,mBAAUjhB,KAAK+gB,GAAS;AACvB,gBAAMG,IAAgBH,EAAS/gB,CAAGgJ,EAAAA,MAAMxJ,GAAK2P,SAAAA;AAC7C8R,UAAAA,IAAeA,KAAkBC;AAAAA,QACjC;AACD,eAAOD;AAAAA,MACT;AAgCC,aA/BAD,EAAarJ,WAAS,SAASnB,GAASvX,GACvC;AAAA,mBAAYqC,KAAY,YAAW;AAClC,cAAI6f;AAQJ,cAPGliB,KAAYA,EAASc,KACvBohB,IAAYliB,EAASc,MAErBohB,IAAYziB,GACZA,MAGEO,KAAYA,EAAS8Z,MAAK;AAC5B,kBAAMqI,IAAkB5K;AACxBA,YAAAA,IAAU,WAAA;AACT4K,cAAAA,EACAJ,GAAAA,EAAaK,YAAYF,CAC9B;AAAA,YAAA;AAAA,UACI;AAGD,iBADAJ,EAASI,KAAa3K,GACf2K;AAAAA,QACP;AACD,eAAA;AAAA,MACF,GACCH,EAAaK,cAAY,SAASthB;eAC1BghB,EAAShhB,CAAAA;AAAAA,MAClB,GAECihB,EAAaM,QAAQ,WACpBP;AAAAA,QAAAA,IAAW,CAAA;AAAA,MACb,GAEQC;AAAAA,IACR,EAQuD5a,IAGlDnH,IAAAA,KAAYA,EAASsiB,eACvB/K,IAAUA,EAAQP,KAAKhX,EAASsiB,UAAAA;AAKjC,QAAIJ,IAAaN,IAAU,MAFXD,EAAUF,UAAUG,GAAWlJ,SAASnB,GAASvX,CAMjE;AAAA,WAHGA,KAAYA,EAASc,OACvBohB,IAAYliB,EAASc,KAEfohB;AAAAA,EACT,GAEC3hB,EAAIgiB,YAAY,SAAShQ,GACxBpL;AAAAA,SAAKhF,YAAY,cAAcoQ;EACjC,GAEChS,EAAIyG,YAAU,SAASoP,GAAMoM;AAC5B,QAAIb,EAAUH;AAAc,aAAA;AAE5B,UAAMiB,IAAc,QAAMrM,EAAKyL,eAEzBJ,IAAYE,EAAUF;AAK5B,WAJIA,EAAyB,iBAC5BA,EAAyB,cAAE1X,MAAM5C,MAAM,CAACiP,CAAAA,EAAM9O,OAAOkb,CAGlDf,CAAAA,GAAAA,CAAAA,EAAUgB,MACNhB,EAAUgB,CAAAA,EAAa1Y,MAAM5C,MAAMqb,CAE7C;AAAA,EAAA,GAECjiB,EAAIwG,aAAW,SAASqP;AAEvB,WADkBuL,CAAAA,CAAAA,EAAUF,UACR,QAAMrL,EAAKyL,YACjC,CAAA;AAAA,EAAA,GAECthB,EAAImiB,cAAY,SAAS5hB,GACxB;AAAA,QAAIA,GAAG;AACN,UAAI2gB,IAAYE,EAAUF;AAC1B,iBAAU1gB,KAAK0gB;AACdA,UAAU1gB,CAAGqhB,EAAAA,YAAYthB;AAG1B,YAAM6hB,IAAO7hB,EAAGU,MAAM,GAAA;AAEtB,UADAigB,IAAYE,EAAUF,WACnBkB,EAAK3hB,WAAW,GAAE;AACpB,cAAM4gB,IAAYe,EAAK,CACjBC,GAAAA,IAAUD,EAAK,CAAA;AAClBlB,UAAUG,CAAAA,KACZH,EAAUG,CAAWQ,EAAAA,YAAYQ;MAElC;AAAA,IACD;AAAA,EACH,GACCriB,EAAIsiB,kBAAkB,WACrB;AAAA,eAAWzM,KAAQuL,EAAUF;AAC5BE,MAAAA,EAAUF,UAAUrL,CAAMiM,EAAAA,MAAAA;AAAAA,EAE7B;AAEA;AChIA,MAAeS,KAAA,EACd7kB,OAAO,SAAU8kB,GAAI9kB,GAAOsZ;AACvBwL,IAAGC,mBACND,EAAGC,iBAAiB/kB,GAAOsZ,GAAS,EAAA,IAE5BwL,EAAG5gB,eACX4gB,EAAG5gB,YAAY,OAAKlE,GAAOsZ,CAC5B;AAAA,GACD0L,aAAa,SAAUF,GAAI9kB,GAAOsZ,GAAAA;AAC7BwL,IAAGG,sBACNH,EAAGG,oBAAoBjlB,GAAOsZ,KAEtBwL,IAAAA,EAAGL,eACXK,EAAGL,YAAY,OAAKzkB,GAAOsZ,CAC5B;AAAA,EAAA;ACZa,SAASiF,GAAO3e,GAAAA;AAG/B,MAAIslB,ICHW,WAAA;AAEd,QAAIA,IAAY,SAAUzK,GAAU0J,GAAAA;AACnC1J,MAAAA,IAAWA,KAAYoK,GAAiB7kB,OACxCmkB,IAAcA,KAAeU,GAAiBG;AAC9C,UAAInB,IAAW,CAAA,GACXsB,IAAa,EAChBC,QAAQ,SAASN,GAAI9kB,GAAOsU,GAAU+Q;AACrCxB,UAASthB,KAAK,EAACmB,SAASohB,GAAI9kB,OAAMA,GAAOsU,UAAUA,GAAU+Q,SAASA,EACtE5K,CAAAA,GAAAA,EAASqK,GAAI9kB,GAAOsU,GAAU+Q;MAC9B,GACDC,QAAQ,SAASR,GAAI9kB,GAAOsU,GAAU+Q;AACrClB,QAAAA,EAAYW,GAAI9kB,GAAOsU,GAAU+Q,CAAAA;AACjC,iBAAQviB,IAAI,GAAGA,IAAI+gB,EAAS9gB,QAAQD,KAAI;AACvC,cAAIwW,IAAUuK,EAAS/gB,CAAAA;AACnBwW,UAAAA,EAAQ5V,YAAYohB,KAAMxL,EAAQtZ,UAAUA,KAASsZ,EAAQhF,aAAaA,KAAYgF,EAAQ+L,YAAYA,MAC7GxB,EAASzS,OAAOtO,GAAG,CAAA,GACnBA;AAAAA,QAED;AAAA,MACD,GACDyiB,WAAW;AAGV,iBAFIC,IAAc3B,EAASlY,MAAAA,GAElB7I,IAAI,GAAGA,IAAI0iB,EAAYziB,QAAQD,KAAI;AAC3C,cAAIwW,IAAUkM,EAAY1iB;AAC1BqiB,UAAAA,EAAWG,OAAOhM,EAAQ5V,SAAS4V,EAAQtZ,OAAOsZ,EAAQhF,UAAUgF,EAAQ+L,UAC5EF,EAAWG,OAAOhM,EAAQ5V,SAAS4V,EAAQtZ,OAAOsZ,EAAQhF,UAAAA,MAC1D6Q,GAAAA,EAAWG,OAAOhM,EAAQ5V,SAAS4V,EAAQtZ,OAAOsZ,EAAQhF,UAAU,EAAA,GACpE6Q,EAAWG,OAAOhM,EAAQ5V,SAAS4V,EAAQtZ,OAAOsZ,EAAQhF,YAC1D;AAAA,QAAA;AACDuP,UAASzS,OAAO,GAAGyS,EAAS9gB,MAC5B;AAAA,MAAA,GACDwb,QAAQ,WAAA;AACP,eAAO2G,EAAUhc,KAAKlJ,OAAOkJ,KAAK8b;MAClC,EAEF;AAAA,aAAOG;AAAAA,IACT;AAEC,WAAOD;EACR,EDtCgBO;AAEhB7lB,IAAUI,QAAQklB,EAAUE,QAC5BxlB,EAAUolB,cAAcE,EAAUI,QAClC1lB,EAAU8lB,kBAAkBR,EAAUK,WACtC3lB,EAAU+lB,uBAAuBT,EAAU3G,QAG3C3e,EAAUgmB,QAAQ,SAASC;AAE1B,YADWviB,OAAOma,UAAUqI,QAAQ,WAAY;AAAA,aAAO5c,KAAKuO,QAAQ,cAAc;IAAI,GAC1E3L,MAAM+Z;EACnB,GAEAjmB,EAAUmmB,UAAU,SAASzjB,GAC5B;AAAA,WAAA,EAAA,CAAIA,KAAcA,OAAAA,KAAO,aAAPA,CAAAA,EACPA,EAAIwa,eAAexa,EAAIya,YAAYza,EAAImF;AAAAA,EAInD,GAEA7H,EAAUomB,YAAY,SAAS1jB;AAC9B,WAAQA,YAAcA,KAAO;AAAA,EAC9B;AAEA;AE8CA,SAAS2jB,GAAaC,GACrB;AAAA,MAAA,CAAIA;AAAM,WAAO;AAEjB,MAAIxX,IAAYwX,EAAKxX,aAAa;AAOlC,SANGA,EAAUyX,YACZzX,IAAYA,EAAUyX,UAEnBzX,EAAUqB,YACbrB,IAAY,KAENA,KAAa;AACrB;AAgBA,SAAS0X,GAAUhiB,GAAGiiB,GAAWC,GAAAA;AAAAA,EAC7BA,MAD6BA,WAE/BA;AAKD,WAHIC,IAAMniB,EAAEE,UAAUF,EAAEoiB,YACpBnlB,IAAM,IAEHklB,KAAI;AAGV,QAFAllB,IAAM4kB,GAAaM,IAEZ;AACN,UAAIE,IAAMplB,EAAI0O,QAAQsW,CACtB;AAAA,UAAII,KAAO,GAAE;AACZ,YAAKH,CAAAA;AACJ,iBAAOC;AAGR,YAAIxlB,IAAQ0lB,MAAQ,KAARA,EAAkBplB,EAAIqlB,OAAOD,IAAM,CAAA,KAAI,IAAIX,KACnDa,GAAAA,IAAUF,IAAMJ,EAAUtjB,UAAU1B,EAAI0B,UAAgB1B,CAAAA,EAAIqlB,OAAOD,IAAMJ,EAAUtjB,MAAAA,EAAS+iB;AAEhG,YAAI/kB,KAAQ4lB;AACX,iBAAOJ;AAAAA,MACR;AAAA,IACD;AAEDA,IAAAA,IAAIA,EAAIpb;AAAAA,EACR;AACD,SAAO;AACR;AAIA,SAASyb,GAAUV,GAClB;AAAA,MAAInF,QACH8F,IAAAA;AACD,MAAGpnB,OAAO6iB,kBAAiB;AAC1B,QAAIzhB,IAAQpB,OAAO6iB,iBAAiB4D,GAAM;AAC1CnF,IAAAA,IAAUlgB,EAAe,SACzBgmB,IAAahmB,EAAkB;AAAA,EACjC;AAAUqlB,MAAKY,iBACb/F,IAAUmF,EAAKY,aAAsB,SACrCD,IAAaX,EAAKY,aAAyB;AAG5C,MAAIC,IAAAA,IACAC,IAAmBZ,GAAU,EAAC9hB,QAAO4hB,EAAAA,GAAO,qBAMhD;AAAA,SALGc,MACFD,IAAmBC,EAAiBnmB,MAAM8N,UAAU,QAErDoY,IAAgBA,KAAmBb,CAAAA,EAAiB,cAE5CnF,KAAW,UAAU8F,KAAc,YAAdA,CAA2BE;AACzD;AAEA,SAASE,GAAuBf,GAAAA;AAC/B,UAAQgB,MAAMhB,EAAKniB,aAAa,UAA+C,CAAA,KAAA,IAA9BmiB,EAAKniB,aAAa,UAAiB,KAAA;AACrF;AAEA,SAASojB,GAAQjB;AAEhB,SADkB,CAAA,EAACnE,OAAWnU,MAAAA,GACfsY,EAAAA,EAAKkB,SAASC,YAAAA,CAAAA,KAAAA,CAAAA,CACnBnB,EAAKniB,aAAa,MAAA;AAG7B;AAEA,SAAS9D,GAAUimB;AAElB,SADiB,CAAA,EAACoB,OAAQ,IAAMC,QAAS,IAAMC,cAAiBC,QAAAA,IAAepK,QAAS,GAAA,EAC1E6I,EAAKkB,SAASxD,YAAAA,CAAAA,KAAAA,CACnBsC,EAAKwB,aAAa,UAI5B;AAAA;AAyDA,SAASC,KACR;AAAA,SAAOna,SAASoa,KAAKC,oBAAoBra,SAASoa,KAAKE;AACxD;AAwBA,SAASC,GAAYrkB,GAAAA;AAIpB,OAHKA,KAGL,CAAKikB;AACJ,WAAOna,SAASmJ;AAEjB,SAAOjT,EAAQyH,eAAezH,IAAUA,EAAQyH;AAC/C,QAAIzH,aAAmBskB;AACtB,aAAOtkB,EAAQ8T;AAGjB,SAAOhK,SAASmJ;AACjB;AAMA,MAAesR,KAAA,EAOdC,iBAAiB,SAAyBC;AACzC,SAAOjf,KAAKkf,UAAUD,CAAAA,EAAYpnB;AAClC,GAODsnB,gBAAgB,SAAwBF,GAAAA;AACvC,SAAOjf,KAAKkf,UAAUD,GAAYrnB;AAClC,GAEDwnB,cAAc,SAAsBC,GAEnC;AAAA,WADIznB,IAAI,GAAGC,IAAK,GACVwnB;AACLznB,IAAAA,KAAY0nB,SAASD,EAAKE,SAC1B1nB,GAAAA,KAAcynB,SAASD,EAAKG,aAC5BH,IAAOA,EAAKI;AAEb,SAAO,EAAC7nB,KAAKA,GAAKC,MAAMA,EACxB;AAAA,GAED6nB,eAAe,SAAuBL;AACrC,MAAIM,IAAMN,EAAKO,sBAEXhoB,GAAAA,IAAM,GACTC,IAAO;AAGR,MAAK,OAAOgoB,KAAKC,UAAUC,YAUrB;AAIL,QAAIC,IAAQ1b,SAASC,cAAc;AACnCyb,IAAAA,EAAMroB,MAAM8J,WAAS,YACrBue,EAAMroB,MAAME,OAAK,OACjBmoB,EAAMroB,MAAMC,MAAI,OAChBooB,EAAMroB,MAAM+N,QAAM,OAClBsa,EAAMroB,MAAM8N,SAAS,OAErBnB,SAASmJ,KAAKhJ,YAAYub,CAC1B;AAAA,QAAIC,IAAWD,EAAMJ,sBAAAA;AACrBhoB,IAAAA,IAAO+nB,EAAI/nB,MAAMqoB,EAASroB,KAC1BC,IAAO8nB,EAAI9nB,OAAOooB,EAASpoB,MAE3BmoB,EAAM/d,WAAWC,YAAY8d,CAAAA;AAAAA,EAC7B,OA3BsC;AACtC,QAAIvS,IAAOnJ,SAASmJ,MAChByS,IAAU5b,SAAS8T,iBACnB+H,IAAY5pB,OAAO6pB,eAAeF,EAAQC,aAAa1S,EAAK0S,WAC5DE,IAAa9pB,OAAO+pB,eAAeJ,EAAQG,cAAc5S,EAAK4S,YAC9DE,IAAYL,EAAQK,aAAa9S,EAAK8S,aAAa,GACnDC,IAAaN,EAAQM,cAAc/S,EAAK+S,cAAc;AAE1D5oB,IAAAA,IAAO+nB,EAAI/nB,MAAOuoB,IAAYI,GAC9B1oB,IAAO8nB,EAAI9nB,OAAOwoB,IAAaG;AAAAA,EAClC;AAmBE,SAAO,EAAE5oB,KAAKkO,KAAKM,MAAMxO,CAAAA,GAAMC,MAAMiO,KAAKM,MAAMvO,CAChD,EAAA;AAAA,GAEDqnB,WAAW,SAAmBG,GAAAA;AAC7B,SAAIA,EAAKO,wBACD5f,KAAK0f,cAAcL,CAEnBrf,IAAAA,KAAKof,aAAaC,CAE1B;AAAA,GAEDhkB,SAAS,SAASb,GAASimB;AAC1B,SAAIjmB,KAAYimB,IAGTplB,GAAQb,GAASimB,CAAAA,IAFhB;AAGR,GACDC,aAAa,SAASC,GAASC,GAAAA;AAC3BA,EAAAA,EAAcC,cAChBD,EAAc3e,WAAW6e,aAAaH,GAASC,EAAcC,eAE7DD,EAAc3e,WAAWwC,YAAYkc,CAEtC;AAAA,GACDI,QAAQ,SAAS/D,GAAAA;AACZA,OAAQA,EAAK/a,cAChB+a,EAAK/a,WAAWC,YAAY8a,CAAAA;AAE7B,GACDgE,WAAW,SAASC,GAAOjf,GAC1B;AAAA,SAAOA,EAAOgW,SAASiJ,CACvB;AAAA,GACDC,mBArMD,SAA2B/H,GAAAA;AAiB1B,WAhBIgI,IAAQhI,EAAK1f,iBAAiB,CACjC,WACA,cACA,SACA,UACA,YACA,UACA,UACA,UACA,SACA,cACA,qBACC0K,KAAK,IAAA,CAAA,GAEHid,IAAa7e,MAAMgS,UAAU9R,MAAMwI,KAAKkW,GAAO,CAAA,GAE3CvnB,IAAI,GAAGA,IAAIwnB,EAAWvnB,QAAQD;AACrCwnB,IAAAA,EAAWxnB,CAAAA,EAAGynB,YAAYznB;AAwB3B,OAlBAwnB,EAAWE,KAAK,SAASzI,GAAGC,GAAAA;AAC3B,WAAGD,EAAEgB,aAAa,KAAKf,EAAEe,aAAa,IAC9B,IAELhB,EAAEgB,aAAa,KAAKf,EAAEe,aAAa,SAIlChB,EAAEgB,aAAaf,EAAEe,WAEbhB,EAAEwI,YAAYvI,EAAEuI,YAEpBxI,EAAEgB,WAAWf,EAAEe,gBAGZ;AAAA,EACT,IAESjgB,IAAI,GAAGA,IAAIwnB,EAAWvnB,QAAQD,KAAI;AACzC,QAAIojB,IAAOoE,EAAWxnB,CAAAA;AAAAA,KACPmkB,GAAuBf,CAAAA,KAAUjmB,GAAUimB,CAAAA,KAASiB,GAAQjB,CAAUU,MAAAA,GAAUV,OAE9FoE,EAAWlZ,OAAOtO,GAAG,CACrBA,GAAAA;AAAAA,EAED;AACD,SAAOwnB;AACR,GAmJCrE,kBACAG,WACA2B,IAAAA,aAAAA,IACA0C,iBA1GD,SAAyB/mB,GAAAA;AACxB,WAASqkB,GAAYrkB,CAAAA;AACtB,GAyGCikB,sBAAAA,IACA+C,kBA5ID,WAAA;AACC,MAAIC,IAAgBnd,SAASmd;AAQ7B,SAPIA,EAAcC,eACjBD,IAAgBA,EAAcC,WAAWD,gBAEtCA,MAAkBnd,SAASmJ,QAAQnJ,SAASqd,iBAC/CF,IAAgBnd,SAASqd,aAAAA,EAAeC,aAAatd,SAASmJ,OAGxDgU;AACR,GAmICI,0BA5VD,SAAkCplB,GAAIugB,GACrC;AAAA,MAAI3U,IAAI/D,SAAS8T,iBACbuH,IApCL,SAAyBN,GAAAA;AACxB,QAAIznB,IAAI,GAAGC,IAAK,GAAG4lB,IAAM,GAAGqE,IAAO;AACnC,QAAIzC,EAAKO,uBAAuB;AAC/B,UAAID,IAAMN,EAAKO,sBAAAA,GACXnS,IAAOnJ,SAASmJ,MAChByS,IAAW5b,SAAS8T,mBACvB9T,SAASmJ,KAAKxL,cACdqC,SAASmJ,MAEN0S,IAAY5pB,OAAO6pB,eAAeF,EAAQC,aAAa1S,EAAK0S,WAC5DE,IAAa9pB,OAAO+pB,eAAeJ,EAAQG,cAAc5S,EAAK4S,YAC9DE,IAAYL,EAAQK,aAAa9S,EAAK8S,aAAa,GACnDC,IAAaN,EAAQM,cAAc/S,EAAK+S,cAAc;AAC1D5oB,MAAAA,IAAO+nB,EAAI/nB,MAAOuoB,IAAYI,GAC9B1oB,IAAO8nB,EAAI9nB,OAAOwoB,IAAaG,GAE/B/C,IAAQnZ,SAASmJ,KAAKwM,cAAc0F,EAAIlC,OACxCqE,IAASxd,SAASmJ,KAAKsM,eAAe4F,EAAImC;AAAAA,IAC5C,OAAQ;AACN,aAAMzC;AACLznB,QAAAA,KAAY0nB,SAASD,EAAKE,WAAU,EAAA,GACpC1nB,KAAcynB,SAASD,EAAKG,YAAW,EACvCH,GAAAA,IAAOA,EAAKI;AAGbhC,MAAAA,IAAQnZ,SAASmJ,KAAKwM,cAAcoF,EAAKpF,cAAcpiB,GACvDiqB,IAASxd,SAASmJ,KAAKsM,eAAesF,EAAKtF,eAAeniB;AAAAA,IAC1D;AACD,WAAO,EAAEmqB,GAAGjc,KAAKM,MAAMxO,CAAAA,GAAMoqB,GAAGlc,KAAKM,MAAMvO,CAAO6N,GAAAA,OAAM2Z,EAAKpF,aAAaxU,QAAO4Z,EAAKtF,cAAc0D,OAAO3X,KAAKM,MAAMqX,IAAQqE,QAAQhc,KAAKM,MAAM0b,CAClJ,EAAA;AAAA,EAAA,EAO2B9E,CAE1B;AAAA,SAAO,EACNgF,GAAGvlB,EAAGwlB,UAAU5Z,EAAEmY,aAAab,EAAIqC,IAAIhF,EAAKqD,YAC5C0B,GAAGtlB,EAAGylB,UAAU7Z,EAAEkY,YAAYZ,EAAIoC,IAAI/E,EAAKmD,UAAAA;AAE7C,GAqVCgC,eAvSD,SAAuBjnB,GAAAA;AACtB,MAAImiB;AAUJ,SATIniB,EAAEknB,UACL/E,IAAMniB,KAGNmiB,KADAniB,IAAIA,KAAK3E,OAAOO,OACRsE,UAAUF,EAAEoiB,YACZoE,cAAcxmB,EAAEmnB,iBACvBhF,IAAMniB,EAAEmnB,aAAe,EAAA,CAAA,IAGlBhF;AACR,GA4RCiF,iBApVD,SAAyBjD;AACxB,MAAIznB,IAAI,GAAGC,IAAK,GAAG4lB,IAAM,GAAGqE,IAAO;AACnC,MAAIzC,EAAKO,uBAAuB;AAC/B,QAAID,IAAMN,EAAKO,sBACXnS,GAAAA,IAAOnJ,SAASmJ,MAChByS,IAAW5b,SAAS8T,mBACvB9T,SAASmJ,KAAKxL,cACdqC,SAASmJ,MAEN0S,IAAY5pB,OAAO6pB,eAAeF,EAAQC,aAAa1S,EAAK0S,WAC5DE,IAAa9pB,OAAO+pB,eAAeJ,EAAQG,cAAc5S,EAAK4S,YAC9DE,IAAYL,EAAQK,aAAa9S,EAAK8S,aAAa,GACnDC,IAAaN,EAAQM,cAAc/S,EAAK+S,cAAc;AAC1D5oB,IAAAA,IAAO+nB,EAAI/nB,MAAOuoB,IAAYI,GAC9B1oB,IAAO8nB,EAAI9nB,OAAOwoB,IAAaG,GAE/B/C,IAAQnZ,SAASmJ,KAAKwM,cAAc0F,EAAIlC,OACxCqE,IAASxd,SAASmJ,KAAKsM,eAAe4F,EAAImC;AAAAA,EAC5C,OAAQ;AACN,WAAMzC;AACLznB,MAAAA,KAAY0nB,SAASD,EAAKE,WAAU,EACpC1nB,GAAAA,KAAcynB,SAASD,EAAKG,YAAW,EAAA,GACvCH,IAAOA,EAAKI;AAGbhC,IAAAA,IAAQnZ,SAASmJ,KAAKwM,cAAcoF,EAAKpF,cAAcpiB,GACvDiqB,IAASxd,SAASmJ,KAAKsM,eAAesF,EAAKtF,eAAeniB;AAAAA,EAC1D;AACD,SAAO,EAAEmqB,GAAGjc,KAAKM,MAAMxO,CAAAA,GAAMoqB,GAAGlc,KAAKM,MAAMvO,CAAO6N,GAAAA,OAAM2Z,EAAKpF,aAAaxU,QAAO4Z,EAAKtF,cAAc0D,OAAO3X,KAAKM,MAAMqX,CAAQqE,GAAAA,QAAQhc,KAAKM,MAAM0b,CAAAA,EAAAA;AAClJ;AA0TA,IAAIzmB;AACJ,IAAGknB,QAAQhO,UAAUlZ;AACpBA,EAAAA,KAAU,SAASb,GAASimB;AAC3B,WAAOjmB,EAAQa,QAAQolB,CACzB;AAAA,EAAA;AAAA,KACK;AACJ,MAAI+B,KAAUD,QAAQhO,UAAUiO,WAAWD,QAAQhO,UAAUkO,qBAAqBF,QAAQhO,UAAUmO;AACpGrnB,EAAAA,KAAU,SAASb,GAASimB,GAC3B;AAAA,QAAI7E,IAAKphB;AACT,OAAG;AACF,UAAIgoB,GAAQvX,KAAK2Q,GAAI6E;AACpB,eAAO7E;AAERA,MAAAA,IAAKA,EAAG+G,iBAAiB/G,EAAG3Z;AAAAA,IAC5B,SAAQ2Z,MAAO,QAAQA,EAAGgH,aAAa;AACxC,WAAO;AAAA,EACT;AACA;ACpZA,IAAIC,YAA2BtsB,SAAW;AAI1C,MAAeusB,KAAA,EACdC,MAAMF,OAAsB/C,UAAUC,UAAUlZ,QAAQ,MAAA,KAAW,KAAKiZ,UAAUC,UAAUlZ,QAAQ,SAAA,KAAc,IAClHmc,SAASH,MAAsB/C,UAAUC,UAAUlZ,QAAQ,OAAY,KAAA,GACvEoc,UAAUJ,MAAsB/C,UAAUC,UAAUlZ,QAAQ,aAAa,GACzEqc,SAASL,OAAsB/C,UAAUC,UAAUlZ,QAAQ,QAAA,KAAa,KAAKiZ,UAAUC,UAAUlZ,QAAQ,WAAA,KAAgB,IACzHsc,MAAMN,MAAsB/C,UAAUC,UAAUlZ,QAAQ,SAAc,KAAA,GACtEuc,QAAQP,MAAsB/C,UAAUC,UAAUsD,OAAO,aAAa,GACtEC,QAAQT,MAAsB/C,UAAUC,UAAUlZ,QAAQ,MAAA,SAC1D0c,SAAUV,MAAyC,OAAb/C,YAAa;ACbrC,SAAQ0D,GAACld;AACvB,MAAoB,OAATA,KAAS,YAA4B,OAATA,KAAS;AAC/C,WAAOA;AAER,MAAIyI,IAAS;AACb,WAAShF,KAAOzD,GAAM;AACrB,QAAImd,IAAa;AACbnd,MAAKrD,eAAe8G,CAQvB0Z,MAAAA,IAAa1Z,IAAM,OANlB0Z,WADUnd,EAAKyD,CAAAA,KAAS,WACX2Z,mBAAmBpd,EAAKyD,CACN,CAAA,IAAA,OAAdzD,EAAKyD,CACTzD,KADkB,WAClBA,EAAKyD,KAEL2Z,mBAAmB7U,KAAKmB,UAAU1J,EAAKyD,CAAAA,CAAAA,CAAAA,IAIjDgF,EAAOlV,WACV4pB,IAAa,MAAMA,IAEpB1U,KAAU0U;AAAAA,EAEX;AACD,SAAO1U;AACR;ACxBe,SAASsG,GAAO3e,GAE/B;AAAA,MAAIitB,IAAuB,SAAUC,GAAQC,GAG5C;AAAA,aAFIC,IAAO,6CACPC,IAAOH,EAAOI,MAAM,YACfpqB,GAAAA,IAAI,GAAGA,IAAImqB,EAAKlqB,QAAQD;AAChC,cAAQmqB,EAAKnqB,CAAAA,GAAAA;AAAAA,QACZ,KAAK;AAAA,QACL,KAAK;AAAMkqB,UAAAA,KAAQ,iBAAiBlqB,IAAI;AACvC;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AAAMkqB,UAAAA,KAAQ,kBAAkBlqB,IAAI;AACxC;AAAA,QACD,KAAK;AAAMkqB,UAAAA,KAAQ,iBAAiBlqB,IAAI,eAAeA,IAAI;AAC1D;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AACJkqB,UAAAA,KAAQ,iBAAiBlqB,IAAI;AAC7B;AAAA,QACD,KAAK;AACJkqB,UAAAA,KAAQ,iBAAiBlqB,IAAI;AAC7B;AAAA,QACD,KAAK;AAAMkqB,UAAAA,KAAQ,iBAAiBlqB,IAAI;AACvC;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AAAMkqB,UAAAA,KAAQ,6BAA6BlqB,IAAI;AACnD;AAAA,QACD,KAAK;AAAMkqB,UAAAA,KAAQ,iBAAiBlqB,IAAI;AACvC;AAAA,QACD,KAAK;AAAMkqB,UAAAA,KAAQ,mDAAmDlqB,IAAI;AACzE;AAAA,QACD,KAAK;AAAMkqB,UAAAA,KAAQ,kDAAkDlqB,IAAI;AAAA,MAM3E;AAAA,QAAI2Y,IAAO;AAEX,WADIsR,MAAKtR,IAAO,eAAeA,IAAO,MAC/B,IAAI+B,SAAS,QAAQ,4BAA4BwP,IAAO,sBAAsBvR,IAAO,IAAA;AAAA,EAC7F,GA6BI0R,IAAkB,SAAUL,GAAQC,GACvC;AAAA,UAAME,IAAOH,EAAOI,MAAM,YAAA;AAC1B,WAAO,SAAUtrB,GAAAA;AAIhB,eAHIwrB,IAAM,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAA,GACtBC,IAAOzrB,EAAKsrB,MAAM,sBAEbpqB,IAAI,GAAGA,IAAImqB,EAAKlqB,QAAQD;AAChC,gBAAQmqB,EAAKnqB,CAAAA,GAAAA;AAAAA,UACZ,KAAK;AAAA,UACL,KAAK;AACJsqB,YAAAA,EAAI,CAAA,IAAKC,EAAKvqB,CAAM,KAAA;AACpB;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AACJsqB,YAAAA,EAAI,CAAA,KAAMC,EAAKvqB,CAAM,KAAA,KAAK;AAC1B;AAAA,UACD,KAAK;AACJsqB,YAAAA,EAAI,CAAe,IAAA,IAAVC,EAAKvqB,CAAUuqB,KAAAA,EAAKvqB,KAAK,KAAK,OAAO;AAC9C;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AACJsqB,YAAAA,EAAI,CAAKC,IAAAA,EAAKvqB,MAAM;AACpB;AAAA,UACD,KAAK;AACJsqB,YAAAA,EAAI,CAAA,IAAKC,EAAKvqB,CAAM,KAAA;AACpB;AAAA,UACD,KAAK;AACJsqB,YAAAA,EAAI,CAAKC,IAAAA,EAAKvqB,CAAM,KAAA;AACpB;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AACJsqB,YAAAA,EAAI,CAAKA,IAAAA,EAAI,KAAK,OAAOC,EAAKvqB,CAAAA,KAAM,IAAI8gB,YAAAA,KAAiB,OAAO,IAAI;AACpE;AAAA,UACD,KAAK;AACJwJ,YAAAA,EAAI,KAAKC,EAAKvqB,CAAAA,KAAM;AACpB;AAAA,UACD,KAAK;AACJsqB,YAAAA,EAAI,CAAA,IAAKxtB,EAAU0tB,OAAO1rB,KAAK2rB,iBAAiBF,EAAKvqB,CAAAA,CAAAA,KAAO;AAC5D;AAAA,UACD,KAAK;AACJsqB,YAAAA,EAAI,CAAKxtB,IAAAA,EAAU0tB,OAAO1rB,KAAK4rB,gBAAgBH,EAAKvqB,CAAO,CAAA,KAAA;AAAA,QAAA;AAO9D,aAAIiqB,IACI,IAAI3qB,KAAKA,KAAKqrB,IAAIL,EAAI,IAAIA,EAAI,CAAA,GAAIA,EAAI,CAAIA,GAAAA,EAAI,CAAIA,GAAAA,EAAI,CAAIA,GAAAA,EAAI,OAG/D,IAAIhrB,KAAKgrB,EAAI,CAAIA,GAAAA,EAAI,IAAIA,EAAI,CAAA,GAAIA,EAAI,CAAA,GAAIA,EAAI,CAAA,GAAIA,EAAI,CAC9D,CAAA;AAAA,IAAA;AAAA,EACA;AAEA,MAAIM;AAWJ,WAASC,IACR;AAAA,QAAI1V,IAAS;AASb,WARIrY,EAAUM,OAAO0tB,QAAQ,UACzBF,MADiBE,WAEnBF,IAdH;AACC,UACC;AAAA,YAAIlQ,SAAS,qBAAA,GACbkQ,IAAa;AAAA,MACb,QAAOtpB;AACPspB,QAAAA;MACA;AACD,aAAOA;AAAAA,IACR,EAQEzV,IAAAA,IAASyV,KAETzV,IAASrY,EAAUM,OAAO0tB,KAEpB3V;AAAAA,EACR;AACArY,IAAUgC,OAAO,EAChBisB,MAAK,WAGJ;AAAA,aAFI7nB,IAAIpG,EAAU0tB,OAAO1rB,KAAKksB,aAC1B3b,IAAIvS,EAAU0tB,OAAO1rB,KAAK2rB,mBAAmB,CAAA,GACxCzqB,IAAI,GAAGA,IAAIkD,EAAEjD,QAAQD;AAC7BqP,MAAAA,EAAEnM,EAAElD,MAAIA;AAIT,SAFIkD,IAAIpG,EAAU0tB,OAAO1rB,KAAKmsB,YAC1B5b,IAAIvS,EAAU0tB,OAAO1rB,KAAK4rB,kBAAkB,CAAA,GACvC1qB,IAAI,GAAGA,IAAIkD,EAAEjD,QAAQD;AAC7BqP,MAAAA,EAAEnM,EAAElD,MAAIA;AAAAA,EACT,GACDsE,WAAU,SAASgR,GAAAA;AAClB,UAAMxW,IAAO,IAAIQ,KAAKgW;AACtB,QAAI4V,IAAM,IAAI5rB,KAAKR,CAAAA;AAQnB,WAPAA,EAAKgH,SAAS,CACdhH,GAAAA,EAAKiH,WAAW,CAAA,GAChBjH,EAAKqsB,WAAW,CAAA,GAChBrsB,EAAKssB,gBAAgB,CAAA,GACjBtsB,EAAKmI,SACPnI,MAAAA,EAAK6F,QAAYumB,IAAAA,EAAIvmB,QAAa7F,KAAAA,EAAKmb,aAAaiR,EAAIjR,SAAAA,KAAcnb,EAAKkb,YAAgBkR,IAAAA,EAAIlR,kBAChGlb,EAAKusB,QAAQvsB,EAAKwsB,QAAAA,IAAY,QAAkB,KAAKxsB,EAAKmI,SACpDnI,EAAAA,GAAAA;AAAAA,EACP,GACDysB,WAAU,SAASzsB;AAClB,YAAQA,EAAKS,YAAU,MAAgC,KAAzBT,EAAK0sB,kBAAwB,KAAA;AAAA,EAC3D,GACD9rB,YAAW,SAASZ;AACnB,QAAI2sB,IAAM3sB,EAAKyF,OAAAA;AAKf,WAJIzH,EAAUM,OAAOsuB,oBAChBD,MAAQ,IAAGA,IAAM,IAChBA,MAECrlB,KAAK9B,UAAU8B,KAAKrH,IAAID,GAAM,KAAE2sB,GAAM,KAC7C,CAAA;AAAA,EAAA,GACDE,aAAY,SAASrW,GAAAA;AACpB,UAAMxW,IAAO,IAAIQ,KAAKgW,CAAAA;AAEtB,WADAxW,EAAK8sB,QAAQ,CACNxlB,GAAAA,KAAK9B,UAAUxF,CACtB;AAAA,EAAA,GACD+sB,YAAW,SAASvW,GAAAA;AACnB,UAAMxW,IAAO,IAAIQ,KAAKgW;AAEtB,WADAxW,EAAKgtB,SAAS,CACP1lB,GAAAA,KAAKulB,YAAY7sB,CACxB;AAAA,EAAA,GACDitB,WAAU,SAASzW,GAClB;AAAA,UAAMxW,IAAO,IAAIQ,KAAKgW;AACtB,WAAOlP,KAAK9B,UAAUxF,CACtB;AAAA,EAAA,GACDktB,WAAU,SAASltB,GAAMmtB,GAAAA;AACxB,QAAIC,IAAQ,IAAI5sB,KAAKR,EAAKS,QAAAA,CAAAA;AAK1B,QAHA2sB,EAAMN,QAAQM,EAAMvnB,QAAAA,IAAYsnB,CAG7BA,GAAAA,KAAO/f,KAAKM,MAAMyf,CAAAA,KAAQA,IAAM,GAAE;AACpC,UACCE,KADgBD,CAAAA,IAAAA,CAASptB,KACT;AACjB,UAAGqtB,KAAQrtB,EAAK0sB,kBAAuBU,KAAAA,EAAMV,qBAAoB;AAChE,YAAIY,IAAQD,IAAI;AAChBD,QAAAA,EAAMb,QAAQa,EAAMZ,QAAAA,IAA2B,MAAd,KAAKc,KAAc,KAAK,GACzD;AAAA,MAAA;AAAA,IACD;AAKD,WAHIH,KAAO,KAAOntB,CAAAA,EAAKmI,SAAcilB,KAAAA,EAAMjlB,eACzCilB,EAAMvnB,QAAAA,IAAY7F,EAAK6F,QAAaunB,KAAAA,EAAMjS,aAAanb,EAAKmb,SAAAA,KAAciS,EAAMlS,YAAAA,IAAgBlb,EAAKkb,YAAAA,MACtGkS,EAAMb,QAAQa,EAAMZ,YAAY,QAAkB,KAAKY,EAAMjlB,SACvDilB,EAAAA,GAAAA;AAAAA,EACP,GACDntB,KAAI,SAASD,GAAKmtB,GAAI5qB,GACrB;AAAA,QAAI6qB,IAAM,IAAI5sB,KAAKR,EAAKS,QACxB,CAAA;AAAA,YAAO8B,GACN;AAAA,MAAA,KAAK;AACJ6qB,YAAQpvB,EAAUgC,KAAKktB,UAAUE,GAAOD,CACxC;AAAA;AAAA,MACD,KAAK;AACJC,YAAQpvB,EAAUgC,KAAKktB,UAAUE,GAAa,IAAND,CACxC;AAAA;AAAA,MACD,KAAK;AAASC,UAAMJ,SAASI,EAAMjS,SAAAA,IAAWgS,CAAM;AAAA;AAAA,MACpD,KAAK;AAAQC,UAAMG,QAAQH,EAAMlS,gBAAciS,CAAM;AAAA;AAAA,MACrD,KAAK;AAKJC,UAAMb,QAAQa,EAAMZ,QAAAA,IAAkB,KAANW,IAAW,KAAK;AAChD;AAAA,MACD,KAAK;AACJC,UAAMb,QAAQa,EAAMZ,QAAAA,IAAkB,KAANW,IAAW;AAC3C;AAAA,MACD;AACC,eAAOnvB,EAAUgC,KAAK,SAAOuC,CAAMvC,EAAAA,GAAKmtB,GAAI5qB,CAAAA;AAAAA,IAAAA;AAE9C,WAAO6qB;AAAAA,EACP,GACDI,UAAS,SAASC;AACjB,WAAIA,IAAI,KAAW,MAAIA,IAChBA;AAAAA,EACP,GACDpT,MAAK,SAASra;AACb,WAAO,IAAIQ,KAAKR,EAAKS,QAAAA,CAAAA;AAAAA,EACrB,GACDitB,aAAY,SAASxC,GAAOC,GAAAA;AAC3B,WAAIY,EAAAA,IAnNgB,SAAUb,GAAQC,GAAAA;AACvC,aAAO,SAASnrB,GAAAA;AACf,eAAOkrB,EAAOrV,QAAQ,cAAc,SAAUsK,GAC7C;AAAA,kBAAQA;YACP,KAAK;AAAM,qBAAOgL,IAAMntB,EAAUgC,KAAKwtB,SAASxtB,EAAK2tB,WAAgB3vB,CAAAA,IAAAA,EAAUgC,KAAKwtB,SAASxtB,EAAK6F,QAClG,CAAA;AAAA,YAAA,KAAK;AAAM,qBAAOslB,IAAMntB,EAAUgC,KAAKwtB,SAAUxtB,EAAK4tB,YAAAA,IAAgB,CAAM5vB,IAAAA,EAAUgC,KAAKwtB,SAAUxtB,EAAKmb,aAAa,CACvH;AAAA,YAAA,KAAK;AAAM,qBAAOgQ,IAAMnrB,EAAK2tB,WAAe3tB,IAAAA,EAAK6F;YACjD,KAAK;AAAM,qBAAOslB,IAAOnrB,EAAK4tB,gBAAgB,IAAM5tB,EAAKmb,SAAa,IAAA;AAAA,YACtE,KAAK;AAAM,qBAAOgQ,IAAMntB,EAAUgC,KAAKwtB,SAASxtB,EAAK6tB,mBAAmB,GAAO7vB,IAAAA,EAAUgC,KAAKwtB,SAASxtB,EAAKkb,YAAAA,IAAgB;YAC5H,KAAK;AAAM,qBAAOiQ,IAAMnrB,EAAK6tB,mBAAmB7tB,EAAKkb,YAAAA;AAAAA,YACrD,KAAK;AAAM,qBAAOiQ,IAAMntB,EAAU0tB,OAAO1rB,KAAK8tB,UAAU9tB,EAAK+tB,UAAAA,CAAAA,IAAe/vB,EAAU0tB,OAAO1rB,KAAK8tB,UAAU9tB,EAAKyF,OACjH,CAAA;AAAA,YAAA,KAAK;AAAM,qBAAO0lB,IAAMntB,EAAU0tB,OAAO1rB,KAAKguB,SAAShuB,EAAK+tB,UAAAA,CAAAA,IAAe/vB,EAAU0tB,OAAO1rB,KAAKguB,SAAShuB,EAAKyF,OAC/G,CAAA;AAAA,YAAA,KAAK;AAAM,qBAAO0lB,IAAMntB,EAAU0tB,OAAO1rB,KAAKksB,YAAYlsB,EAAK4tB,YAAiB5vB,CAAAA,IAAAA,EAAU0tB,OAAO1rB,KAAKksB,YAAYlsB,EAAKmb,SACvH,CAAA;AAAA,YAAA,KAAK;AAAM,qBAAOgQ,IAAMntB,EAAU0tB,OAAO1rB,KAAKmsB,WAAWnsB,EAAK4tB,YAAiB5vB,CAAAA,IAAAA,EAAU0tB,OAAO1rB,KAAKmsB,WAAWnsB,EAAKmb,SACrH,CAAA;AAAA,YAAA,KAAK;AAAM,qBAAOgQ,IAAMntB,EAAUgC,KAAKwtB,UAAUxtB,EAAKiuB,YAAgB,IAAA,MAAM,KAAK,CAAKjwB,IAAAA,EAAUgC,KAAKwtB,UAAUxtB,EAAKmI,SAAAA,IAAa,MAAM,KAAK,CAAA;AAAA,YAC5I,KAAK;AAAM,qBAAOgjB,KAAQnrB,EAAKiuB,YAAAA,IAAgB,MAAM,KAAK,KAAOjuB,EAAKmI,aAAa,MAAM,KAAK;AAAA,YAC9F,KAAK;AAAM,qBAAOgjB,IAAMnrB,EAAKiuB,YAAgBjuB,IAAAA,EAAKmI,SAClD;AAAA,YAAA,KAAK;AAAM,qBAAOgjB,IAAMntB,EAAUgC,KAAKwtB,SAASxtB,EAAKiuB,YAAiBjwB,CAAAA,IAAAA,EAAUgC,KAAKwtB,SAASxtB,EAAKmI,SAAAA,CAAAA;AAAAA,YACnG,KAAK;AAAM,qBAAOgjB,IAAMntB,EAAUgC,KAAKwtB,SAASxtB,EAAKkuB,cAAAA,CAAAA,IAAmBlwB,EAAUgC,KAAKwtB,SAASxtB,EAAKyJ;YACrG,KAAK;AAAM,qBAAO0hB,IAAOnrB,EAAKiuB,gBAAgB,KAAK,OAAO,OAASjuB,EAAKmI,SAAa,IAAA,KAAK,OAAO;AAAA,YACjG,KAAK;AAAM,qBAAOgjB,IAAOnrB,EAAKiuB,YAAgB,IAAA,KAAK,OAAO,OAASjuB,EAAKmI,SAAAA,IAAa,KAAK,OAAO;AAAA,YACjG,KAAK;AAAM,qBAAOgjB,IAAMntB,EAAUgC,KAAKwtB,SAASxtB,EAAKmuB,cAAmBnwB,CAAAA,IAAAA,EAAUgC,KAAKwtB,SAASxtB,EAAKouB;YACrG,KAAK;AAAM,qBAAOjD,IAAMntB,EAAUgC,KAAKwtB,SAASxvB,EAAUgC,KAAKquB,cAAcruB,CAAShC,CAAAA,IAAAA,EAAUgC,KAAKwtB,SAASxvB,EAAUgC,KAAKsuB,WAAWtuB,CAAAA,CAAAA;AAAAA,YACxI;AAAS,qBAAOmgB;AAAAA,UAEpB;AAAA,QAAA,CAAA;AAAA,MACA;AAAA,IACA,EAyL0B+K,GAAOC,CAG/BD,KAAAA,IAAOA,EAAOrV,QAAQ,cAAa,SAASsK,GAAAA;AAC3C,cAAOA,GAAAA;AAAAA,QACN,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB,KAAK;AAAM,iBAAO;AAAA,QAClB;AAAS,iBAAOA;AAAAA,MAEpB;AAAA,IAAA,CAAA,GACMgL,MAAKD,IAAOA,EAAOrV,QAAQ,cAAa,aAAA,IACjC,IAAI+F,SAAS,QAAO,aAAYsP,IAAO,IAEtC/T,EAAAA,KAAKnZ;EACjB,GACDuwB,aAAY,SAASrD,GAAQC,GAAKqD,GACjC;AAAA,QAAIC,IAAqB1C,EAAAA,IAAWR,IAAkBN,GAClDyD,IAAmBD,EAAmBvD,GAAQC,CAAAA,GAE9CwD,IAAiB,sFAIjBC,IAAiB,0EAGjBC,IAAiB,4EAEjBC,IAAU,+RAgBVC,IAAWN,EAAmB,qBAAqBtD,CACnD6D,GAAAA,IAAWP,EAAmB,qBAAqBtD,CAAAA,GACnD8D,IAAWR,EAAmB,qBAAqBtD,CAAAA;AAEvD,WAAO,SAAU+D,GAAAA;AAEhB,WAAKV,KAAgBxwB,CAAAA,EAAUM,OAAO6wB,oBAAoB;AACzD,YAAID,KAAcA,EAAWZ;AAC5B,iBAAO,IAAI9tB,KAAK0uB;AACV,YAA0B,OAAfA,KAAe;AAChC,iBAAO,IAAI1uB,KAAK0uB,CAAAA;AACV,YAzBiBE,IAyBHF,GAxBfP,EAAexH,KAAKzlB,OAAO0tB,CAyBhC,CAAA;AAAA,iBAAOL,EAASG,CACV;AAAA,YAvBO,SAAUE,GAAAA;AACzB,iBAAOR,EAAezH,KAAKzlB,OAAO0tB,CAAAA,CAAAA;AAAAA,QACrC,EAqByBF,CAAAA;AACpB,iBAAOF,EAASE,CAAAA;AACV,YAtBO,SAAUE,GACzB;AAAA,iBAAOP,EAAe1H,KAAKzlB,OAAO0tB;QACrC,EAoByBF;AACpB,iBAAOD,EAASC,CACV;AAAA,YArBO,SAAUE,GAAAA;AACzB,iBAAON,EAAQ3H,KAAKiI;QACvB,EAmByBF;AACpB,iBAAO,IAAI1uB,KAAK0uB,CAAAA;AAAAA,MAEjB;AAlCc,UAAUE;AAoCzB,aAAOV,EAAiBnc,KAAKvU,GAAWkxB,CAAAA;AAAAA,IAC3C;AAAA,EACE,GACDZ,YAAY,SAASlB,GAAAA;AACpB,QAAIA,CAAAA;AAAO;AAEX,QAAIiC,KADJjC,IAAQ9lB,KAAK9B,UAAU,IAAIhF,KAAK4sB,CACf3nB,CAAAA,GAAAA,OAAAA;AACJ,IAAT4pB,MAAS,MACZA,IAAO;AAER,QAAIC,IAAiB,IAAI9uB,KAAK4sB,EAAM3sB,QACpC6uB,CAAAA;AAAAA,IAAAA,EAAexC,QAAQM,EAAMvnB,QAAa,KAAA,IAAIwpB;AAC9C,QAAIE,IAAcD,EAAepU,YAC7BsU,GAAAA,IAAepiB,KAAKM,OAAQ4hB,EAAe9C,QAAY,IAAA,IAAIhsB,KAAK+uB,GAAa,GAAG,CAAG/C,EAAAA,QAAAA,KAAa;AAEpG,WADkB,IAAIpf,KAAK+D,MAAOqe,IAAe;EAEjD,GACDnB,eAAe,SAASjB,GACvB;AAAA,WAAO9lB,KAAKgnB,WAAWhnB,KAAKmoB,eAAerC,CAC3C,CAAA;AAAA,EAAA,GACDqC,gBAAgB,SAASzvB,GACxB;AAAA,WAAO,IAAIQ,KAAKR,EAAK6tB,kBAAkB7tB,EAAK4tB,YAAAA,GAAe5tB,EAAK2tB,WAAc3tB,GAAAA,EAAKiuB,YAAejuB,GAAAA,EAAKkuB,cAAiBluB,GAAAA,EAAKmuB;EAC7H,EAGF;AAAA;AC3We,SAAQuB,GAAC1xB,GAAAA;AACvB,UAAO,WACN;AAAA,QAAIoH,IAAM,CAAA;AACV,aAAS+a,KAAK7Y,KAAKoN,SAAQ;AAC1B,UAAI3Q,IAAKuD,KAAKoN,QAAQyL,CACgB;AAAA,MAAlCpc,EAAG9C,GAAGmW,WAAWjJ,QAAQ,GAAA,KAAS,OACrC/I,EAAIrB,EAAG9C,EAAAA,IAAM8C;AAAAA,IAEd;AACD,WAAOqB;AAAAA,EACP,GAAE+R,KAAKnZ,CAAAA;AACT;ACNe,SAAS2e,GAAO3e;AAE/BA,IAAU2xB,UAAU,CAAA,GACpB3xB,EAAU4xB,QAAQ,SAASzb,GAAK0b,GAAAA;AAG/B,QAFA1b,IAAMA,KAAO7M,KAAKwoB,WAElB;AAOA,UAAIC;AAMJ,UARA5b,MAAQA,EAAIhG,QAAQ,QAAS,KAAI,MAAM,OAAO,gBAAe,oBAAK3N,QAAQksB,qBACtEplB,KAAKhJ,OAAO0xB,kBAAkB7b,KAAO,UAAU7M,KAAK+C,QAExDwlB,IAAOA,KAAQvoB,KAAK8J,OAKhB9J,KAAK2oB,YAAY;AACpB,YAAIC,IAAK5oB,KAAKmR,UAAU0X;AAGxB,aADAN,IAAOvoB,KAAKtH,KAAKsH,KAAK2oB,aAAa,UAAU,IAAIzvB,KAAKqvB,EAAKpvB,QAAAA,CAAAA,CAAAA,GACpDovB,IAAOvoB,KAAKY;AAAW2nB,cAAOvoB,KAAKtH,KAAKC,IAAI4vB,GAAAA,IAAUvoB,KAAK2oB,UAAAA;AAClEF,QAAAA,IAAKF;AAGL,iBADIO,QACGL,IAAKzoB,KAAKW;AAChB8nB,UAAAA,IAAKzoB,KAAKtH,KAAKC,IAAI8vB,GAAI,GAAGzoB,KAAK2oB,UAAAA,GAC3B3oB,KAAKqoB,QAAQO,EAAGL,OAAUO,IAC7BP,IAAOvoB,KAAKtH,KAAKC,IAAI4vB,GAAM,GAAGvoB,KAAK2oB,UAAAA,IAAkBG;AAGvD,YAAIC,IAAUN;AACd;AACCA,UAAAA,IAAKM,GACLA,IAAU/oB,KAAKtH,KAAKC,IAAI8vB,GAAAA,IAAQzoB,KAAK2oB,UAAAA;AAAAA,eAC7BI,IAAUR,KAAQvoB,KAAKqoB,QAAQO,EAAGG,CAAAA,CAAAA;AAE3C,YAAIN,KAAMF;AACT,iBAAA;AAID,aAFA7xB,EAAUsyB,KAAKC,IAAIpc,IAAM,WAAW+b,EAAGL,CAAAA,IAAQ,SAASK,EAAGH,CAAAA,GAAKS,IAEzDX,IAAOE;AACbzoB,eAAKqoB,QAAQO,EAAGL,UAChBA,IAAOvoB,KAAKtH,KAAKC,IAAI4vB,GAAM,GAAGvoB,KAAK2oB,UAAAA;AAAAA,MAEtC;AACEjyB,UAAUsyB,KAAKC,IAAIpc,GAAKqc,CAAAA;AAMzB,aAFAlpB,KAAKH,UAAU,SAAS,KACxBG,KAAKH,UAAU,eAAe,CACvB,CAAA,GAAA;AAAA,IA9CN;AAMD,aAASqpB,EAAaC,GACrBzyB;AAAAA,QAAU0yB,QAAQD,CAAAA,GAClBzyB,EAAUmJ,UAAU,aAAa;IACjC;AAAA,EAsCF,GAEAnJ,EAAU2yB,WAAW,CAAA,GC/DN,SAAgB3yB,GAG/BA;AAAAA,IAAAA,EAAU2yB,SAASC,MAAM,EACxBC,UAAU,SAASjjB,GAAMkjB;AAExB,UAAGA,EAAIC,eAAeD,EAAIC,YAAY9iB;AACrC;AAGD,UAAA;AACC,YAAI+iB,IAAShzB,EAAUsyB,KAAKnb,MAAM2b,EAAIG,YAClCC,GAAAA,IAAalzB,EAAUsyB,KAAKa,OAAO,QAAQH,CAAAA;AAC/C,YAAGE,KAAcA,EAAWxH,YAAY;AACvC,iBAAA;AAAA,MAED,QAAOlnB;AAAAA,MACP;AACD,aAAO;AAAA,IACP,GACD2S,OAAO,SAASic;AACf,UAAIR;AAOJ,UALKQ,EAAOJ,OAAOD,gBAClBK,EAAOJ,OAAOD,cAAc/yB,EAAUsyB,KAAKnb,MAAMic,EAAOJ,OAAOC,YAI7C,KADnBL,IAAM5yB,EAAUsyB,KAAKa,OAAO,QAAQC,EAAOJ,MACnCtH,GAAAA,WAAW;AAAQ,eAAO;AAClC,UAAI2H,IAAYT,EAAIzuB,aAAa,cAAA;AAC7BkvB,YACCxzB,OAAOyzB,WACVzzB,OAAOyzB,OAAOC,eAAeF,IAE9BrzB,EAAUuzB,eAAeF;AAI1B,eADIG,IAAOxzB,EAAUsyB,KAAKmB,MAAM,kBAAkBL,EAAOJ,MAAAA,GAChD9vB,IAAI,GAAGA,IAAIswB,EAAKrwB,QAAQD,KAAK;AACrC,YAAIiW,IAAOqa,EAAKtwB,GAAGiB,aAAa,KAAA,GAC5BuvB,IAAM1zB,EAAU2zB,WAAWxa,CAC1Bua;AAAAA,QAAAA,MACJ1zB,EAAU2zB,WAAWxa,KAAQua,IAAM,CAAA,IAEpCA,EAAIliB,OAAO,GAAGkiB,EAAIvwB,MAElB;AAAA,iBADIywB,IAAO5zB,EAAUsyB,KAAKmB,MAAM,WAAWD,EAAKtwB,KACvC2wB,IAAI,GAAGA,IAAID,EAAKzwB,QAAQ0wB,KAAK;AAIrC,mBAFIC,IADMF,EAAKC,CAAAA,EACCE,YACZrxB,IAAM,EAAE2Q,KAAKugB,EAAKC,CAAAA,EAAG1vB,aAAa,OAAU6vB,GAAAA,OAAOJ,EAAKC,CAAG1vB,EAAAA,aAAa,YACnEwI,IAAI,GAAGA,IAAImnB,EAAM3wB,QAAQwJ,KAAK;AACtC,gBAAIsnB,IAAOH,EAAMnnB,CACI;AAAA,YAAjBsnB,EAAKzM,YAAY,WAAWyM,EAAKzM,YAAY,YAEjD9kB,EAAIuxB,EAAKzM,QAAAA,IAAYyM,EAAKC;AAAAA,UAC1B;AACDR,UAAAA,EAAI/wB,KAAKD;QACT;AAAA,MACD;AACG8wB,MAAAA,EAAKrwB,UACRnD,EAAUmJ,UAAU,iBAAiB,CAEtC,CAAA;AAAA,UAAIgrB,IAAKn0B,EAAUsyB,KAAKmB,MAAM,cAAcL,EAAOJ;AACnD,WAAS9vB,IAAI,GAAGA,IAAIixB,EAAGhxB,QAAQD,KAAK;AACnC,YAAIkxB,IAAMp0B,EAAUq0B,eAAeF,EAAGjxB,CACtClD,CAAAA;AAAAA,QAAAA,EAAUs0B,UAAUF,EAAI7b,IAAQ6b,IAAAA,EAAI5X;AAAAA,MACpC;AAED,UAAIrU,IAAM,CAGV;AAAA,WAFAyqB,IAAM5yB,EAAUsyB,KAAKmB,MAAM,WAAWL,EAAOJ,MAAAA,GAEpC9vB,IAAI,GAAGA,IAAI0vB,EAAIzvB,QAAQD,KAAK;AACpC,YAAI6C,IAAKoC,EAAIjF,CAAAA,IAAKlD,EAAUq0B,eAAezB,EAAI1vB,CAC/ClD,CAAAA;AAAAA,QAAAA,EAAUu0B,YAAYxuB,CACtB;AAAA,MAAA;AACD,aAAOoC;AAAAA,IACP,EAAA;AAAA,EAGF,EDbUnI,CElEK,GAAA,SAAgBA;AAG/BA,IAAAA,EAAUkX,OAAOlX,EAAU2yB,SAASzb,OAAO,EAC1C2b,UAAU,SAASjjB,GAClB;AAAA,UAAGA,KAAwB,OAATA,KAAS;AAC1B,eAAO;AACD,UAAUA,OAAAA,KAAS;AACzB;AACC,cAAIyI,IAASF,KAAKhB,MAAMvH,CACxB;AAAA,iBAAOsO,OAAOL,UAAUzE,SAAS7E,KAAK8D,CAAAA,MAAY,qBAChD6F,OAAOL,UAAUzE,SAAS7E,KAAK8D,CACjC,MAD6C;AAAA,QAC7C,QACA;AAAA,iBAAA;AAAA,QACA;AAEF,aAAA;AAAA,IACA,GACDlB,OAAO,SAASvH,GAAAA;AACf,UAAIkM,IAAS;AAEM,MAARlM,OAAAA,KAAQ,aAClBA,IAAOuI,KAAKhB,MAAMvH,KAEfsO,OAAOL,UAAUzE,SAAS7E,KAAK3E,CAAAA,MAAU,mBAC5CkM,IAASlM,IAENA,MACCA,EAAKkM,SACPA,IAASlM,EAAKkM,SACNlM,EAAKA,SACbkM,IAASlM,EAAKA,QAIjBkM,IAASA,KAAU,CAAA,GAEflM,EAAK4kB,iBACJ30B,OAAOyzB,WACVzzB,OAAOyzB,OAAOC,eAAe3jB,EAAK4kB,eAEnCx0B,EAAUuzB,eAAe3jB,EAAK4kB;AAG/B,UAAIC,IAAe7kB,KAAQA,EAAK6kB,cAAe7kB,EAAK6kB,cAAc,IAC9DC;AACJ,eAASrhB,KAAOohB;AACf,YAAIA,EAAYloB,eAAe8G,CAAM,GAAA;AACpCqhB,UAAAA,IAAqB;AACrB,cAAIC,IAAaF,EAAYphB,IACzBqgB,IAAM1zB,EAAU2zB,WAAWtgB,CAC1BqgB;AAAAA,UAAAA,MACJ1zB,EAAU2zB,WAAWtgB,CAAOqgB,IAAAA,IAAM,KAEnCA,EAAIliB,OAAO,GAAGkiB,EAAIvwB,MAAAA;AAClB,mBAAS0wB,IAAI,GAAGA,IAAIc,EAAWxxB,QAAQ0wB,KAAK;AAC3C,gBAAIe,IAASD,EAAWd,CAAAA,GACpBnxB,IAAM,EAAE2Q,KAAKuhB,EAAOpc,OAAOwb,OAAOY,EAAOZ;AAC7C,qBAASa,KAAcD;AACtB,kBAAIA,EAAOroB,eAAesoB,CAAAA,GAAa;AACtC,oBAAIA,KAAc,WAAWA,KAAc;AAC1C;AACDnyB,gBAAAA,EAAImyB,CAAcD,IAAAA,EAAOC;cACzB;AAEFnB,YAAAA,EAAI/wB,KAAKD,CAAAA;AAAAA,UACT;AAAA,QACD;AAEEgyB,MAAAA,KACH10B,EAAUmJ,UAAU,iBAAiB,CAGtC,CAAA;AAAA,eADIhB,IAAM,CAAA,GACDjF,IAAI,GAAGA,IAAI4Y,EAAO3Y,QAAQD,KAAK;AACvC,YAAI9C,IAAQ0b,EAAO5Y;AACnBlD,QAAAA,EAAUu0B,YAAYn0B,CACtB+H,GAAAA,EAAIxF,KAAKvC,CAAAA;AAAAA,MACT;AACD,aAAO+H;AAAAA,IACP;EAGF,EFfWnI,IGnEI,SAAgBA,GAAAA;AAG/BA,IAAAA,EAAU80B,OAAO90B,EAAU2yB,SAASmC,OAAO,EAC1CjC,UAAU,SAASjjB,GAClB;AAAA,oBAAUA,KAAS,YACX,IAAImlB,OAAO,kBAAA,EAAoB5L,KAAKvZ,CAAAA;AAAAA,IAI5C,GACDuH,OAAM,SAAS8O;AACd,UAAIrW,IAAOqW,EAAIqH,MAAMyH,OAAOzrB,KAAK0rB,UAAQ,WAAS1rB,KAAK2rB,OAAM,EAC7D,CAAA;AAAA,UAAKrlB,EAAKzM,QAAV;AAGAyM,QAAAA,EAAK,CAAGA,IAAAA,EAAK,CAAGiI,EAAAA,QAAQ,aAAY,EAAA,GAGpCjI,EAAK,CAAGA,IAAAA,EAAK,GAAGiI,QAAQ,wBAAuB,MAE/CjI,EAAK,CAAA,IAAGA,EAAK,CAAA,EAAGiI,QAAQ,gBAAe;AAMvC,iBAFIyV,GADA4H,IAAS,CAAA,GAETC,IAAUJ,OAAO,QAAMzrB,KAAK8rB,UAAQ,kBAAgB9rB,KAAK+rB,QAAM,KAAI,GAAA,IAC/D/H,IAAM6H,EAAQG,KAAK1lB,CAAgB,OAAL,QAAK;AAI1C,mBAFI2lB,GADA/wB,IAAE,CAAA,GAEFgxB,IAAU,qBACND,IAAMC,EAAQF,KAAKhI,EAAM,SAAS;AACzChkB,iBAAKmsB,YAAYF,EAAMnc,SAAW5U,GAAAA,CAAAA;AAC/BA,YAAE6H,OAAQ7H,CAAAA,EAAEvB,OAAIuB,EAAEvB,KAAKuB,EAAE6H,MAC7B6oB,EAASvyB,KAAK6B;QACd;AACD,eAAO0wB;AAAAA,MAvBkB;AAAA,IAwBzB,GACDO,aAAY,SAASxP,GAAIvjB,GACxB;AAAA,UAAIiP,IAAIsU,EAAI9V,QAAQ,GACnB;AAAA,UAAIwB,KAAJ,IAAA;AAED,YAAI4G,IAAO0N,EAAIyP,OAAO,GAAE/jB,CAAGqS,EAAAA,YAAAA,GACvBxL,IAAQyN,EAAIyP,OAAO/jB,IAAE,CAAGkG,EAAAA,QAAQ,QAAO,GAAKA,EAAAA,QAAQ,YAAW,EAAA;AACzD,QAANU,KAAM,YACTA,IAAK,SACGA,KAAM,aACdA,IAAO,cACPC,IAAQlP,KAAKoR,WAAWlC,GAAM,GAAE,CAElB,KAAND,KAAM,YACdA,IAAO,YACPC,IAAQlP,KAAKoR,WAAWlC,GAAM,GAAE,CAAA,IAEjC9V,EAAI6V,CAAAA,IAAMC;AAAAA,MAdS;AAAA,IAenB,GACDkC,YAAW,SAASlC,GAAMmd,GAAGC,GAAAA;AAC5B,UAAIrjB,IAAIiG,EAAM7U,MAAM,GAAA,GAEhBkyB,IAAU;AACVtjB,MAAAA,EAAE,CACLojB,MAAAA,IAAGpjB,EAAE,CAAGmjB,EAAAA,OAAO,GAAE,CACjBE,GAAAA,IAAGrjB,EAAE,CAAA,EAAGmjB,OAAO,GAAE,IACjBG,IAAatjB,EAAE,CAAG,EAAA,CAAA,KAAM;AAEzB,UAAIujB,IAAKvjB,EAAE,CAAGmjB,EAAAA,OAAO,GAAE,CAAA,GACnBK,IAAKnN,SAASrW,EAAE,GAAGmjB,OAAO,GAAE,IAAG,EAAI,IAAA,GACnCM,IAAKzjB,EAAE,CAAGmjB,EAAAA,OAAO,GAAE,CAEvB;AAAA,aAAG11B,EAAUM,OAAO21B,cAAcJ,IAC1B,IAAIrzB,KAAKA,KAAKqrB,IAAIiI,GAAGC,GAAGC,GAAGL,GAAGC,CAAAA,CAAAA,IAE9B,IAAIpzB,KAAKszB,GAAGC,GAAGC,GAAGL,GAAGC,CAE7B;AAAA,IAAA,GACDZ,SAAQ,mBACRI,SAAQ,gBACRC,OAAM,cACNJ,OAAM,gBAAA;AAAA,EAGP,EHbWj1B,CAAAA,GAEXA,EAAU0yB,UAAU,SAAUU,GAAAA;AAG7B,QAAIjrB;AAFJmB,SAAKH,UAAU,iBAAiB,CAAA,CAAA;AAGhC,QAAIyL,IAAQ,IAERshB,IAAc;AAClB,aAAQhzB,KAAKoG,KAAKqpB,UAAS;AAC1B,UAAIwD,IAAS7sB,KAAKqpB,SAASzvB,CAAAA;AAC3B,UAAGizB,EAAOtD,SAASO,EAAOJ,OAAOC,cAAcG,EAAOJ,SAAQ;AAC7D,YAAA;AACC,cAAIuC,IAAQnC,EAAOJ,OAAOC;AACjB,UAAN/vB,MAAM,UACRqyB,IAAQnC,KAETjrB,IAAMguB,EAAOhf,MAAMoe,QAElB3gB,IAAQ;AAAA,QAET,QACAA;AAAAA,UAAAA,IAAAA;AAAAA,QACA;AACDshB,YAAAA;AACA;AAAA,MACA;AAAA,IACD;AAED,QAAIA,CAAAA;AACH,UAAG5sB,KAAK8sB,YAAY9sB,KAAKA,KAAK8sB,QAC7B;AAAA,YAAA;AACCjuB,UAAAA,IAAMmB,KAAKA,KAAK8sB,UAAUjf,MAAMic,EAAOJ,OAAOC,YAAAA;AAAAA,QAC9C;AACAre,UAAAA,IAAQ;AAAA,QACR;AAAA;AAEDA,QAAAA,IAAQ;AAAA,KAIPA,KAAUwe,EAAOJ,OAAOja,UAAUqa,EAAOJ,OAAOja,UAAU,SAC5DzP,KAAKH,UAAU,eAAe,CAACiqB,EAAOJ,UACtC7qB,IAAM,CAAA,IAGPmB,KAAK+sB,iBAAiBluB,CAGtBmB,GAAAA,KAAKH,UAAU,SAAS,CAAA,CAAA,GACxBG,KAAKH,UAAU,WAAW;EAC3B,GACAnJ,EAAUq2B,mBAAmB,SAASluB,GACrCmB;AAAAA,SAAKgtB,eACLhtB,KAAKitB;AACL,aAASrzB,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC1BoG,WAAKH,UAAU,kBAAkB,CAAChB,EAAIjF,CAAAA,CAAAA,CAAAA,KAC3CoG,KAAKuR,SAAS1S,EAAIjF;AAEnBoG,SAAKitB,cAAAA,IACDjtB,KAAKktB,gBAAcltB,KAAK0M,iBAE5B1M,GAAAA,KAAKgtB,eACDhtB,KAAKmtB,eAAantB,KAAKmtB,YAC3BntB,GAAAA,KAAKmtB,cAAc;AAAA,EACpB,GACAz2B,EAAUu0B,cAAc,SAASn0B;AAChCA,MAAMoc,OAAQpc,EAAMoc,QAAQpc,EAAMs2B,aAAc,IAChDt2B,EAAMmB,aAAavB,EAAU22B,WAAWv2B,EAAMmB,aAC9CnB,EAAMoB,WAAWxB,EAAU22B,WAAWv2B,EAAMoB,QAAAA;AAAAA,EAC7C,GAEAxB,EAAU22B,aAAa,SAAS30B,GAC/B;AAAA,WAAIA,IAEOA,OAAAA,KAAQ,WACXhC,EAAU42B,SAASC,UAAU70B,CAAAA,IAEzB,IAAIQ,KAAKR,CAAAA,IAJb;AAAA,EAKT;AAEA,QAAM80B,IAAsBC,GAAmB/2B,CAAAA;AAC/CA,IAAUg3B,YAAY,WACrB;AAAA,UAAMC,IAAU,CACVC,GAAAA,IAAYJ;AAClB,aAAS3U,KAAK+U,GAAU;AAEvB,YAAMC,IAAgB,CAAA;AACtB,UAAIpxB,IAAKmxB,EAAU/U;AAEnB,eAAQ9O,KAAOtN,GAAG;AACjB,YAAIsN,EAAIyT,OAAO,MAAM,OAAOzT,EAAIyT,OAAO,CACtC,KAD4C;AAC5C;AAGD,YAAIsQ;AACJ,cAAMC,IAAWtxB,EAAGsN,CAAAA;AAEnB+jB,QAAAA,IADEp3B,EAAUod,MAAMH,OAAOoa,CACXr3B,IAAAA,EAAUme,QAAQne,EAAUya,UAAU6c,UAAct3B,IAAAA,EAAUya,UAAU6c,WAAWD,KAAYr3B,EAAUya,UAAU8c,YAAYF,CAE/HA,IAAAA,GAGfF,EAAc9jB,CAAO+jB,IAAAA;AAAAA,MACrB;AAEDH,MAAAA,EAAQt0B,KAAKw0B,CAAAA;AAAAA,IACb;AACD,WAAOF;AAAAA,EACR,GAmEAj3B,EAAUmX,QAAQ,SAASvH,GAAM/J,GAAAA;AAChCyD,SAAK8sB,WAAWvwB,GAChByD,KAAKopB,QAAQ,EAACM,QAAQ,EAACC,cAAcrjB,EAAAA,EAAAA,CAAAA;AAAAA,EACtC,GACA5P,EAAUga,OAAO,SAAS7D,GAAK5B,GACX;AAAA,IAAA,OAARA,KAAQ,aAClBjL,KAAK8sB,WAAW7hB,GAChBA,IAAOlC,UAAU,KAGlB/I,KAAKwoB,YAAY3b,GACjB7M,KAAKmtB,cAAcliB,GACnBjL,KAAKsoB,MAAMzb,GAAK7M,KAAK8J,KACtB;AAAA,EAAA,GAEApT,EAAUw3B,cAAc,SAASjzB,GACpB;AAAA,IAARA,KAAQ,UAAOA,IAAO,KAC1B+E,KAAK2oB,aAAa1tB;AAAAA,EACnB,GAEAvE,EAAU2zB,aAAa,SAASpb,GAAMkf,GACrC;AAAA,WAAIA,KACHnuB,KAAKqqB,WAAWpb,CAAQkf,IAAAA,EAAM1rB,MAAM,CAC7BzC,GAAAA,KAAKqqB,WAAWpb,CAExBjP,MAAAA,KAAKqqB,WAAWpb,CAAAA,IAASjP,KAAKqqB,WAAWpb,MAAS,CAC3CjP,GAAAA,KAAKqqB,WAAWpb,CACxB;AAAA,EAAA,GACAvY,EAAUs0B,YAAY,CAAA,GAEtBt0B,EAAUq0B,iBAAiB,SAAS/N;AAEnC,aADI/T,IAAI,CAAA,GACCrP,IAAI,GAAGA,IAAIojB,EAAKyN,WAAW5wB,QAAQD;AAC3CqP,MAAAA,EAAE+T,EAAKyN,WAAW7wB,GAAGqV,IAAQ+N,IAAAA,EAAKyN,WAAW7wB,CAAGsV,EAAAA;AAEjD,SAAStV,IAAI,GAAGA,IAAIojB,EAAKtW,WAAW7M,QAAQD,KAAK;AAChD,UAAIqnB,IAAQjE,EAAKtW,WAAW9M,CACN;AAAA,MAAlBqnB,EAAM2B,YAAY,MACrB3Z,EAAEgY,EAAMmB,OAAAA,IAAWnB,EAAMta,aAAasa,EAAMta,WAAWikB,YAAY;AAAA,IACpE;AAID,WAFK3hB,EAAEiK,SAAMjK,EAAEiK,OAAO8J,EAAKrW,aAAaqW,EAAKrW,WAAWikB,YAAY,KAE7D3hB;AAAAA,EACR,GACAvS,EAAUsE,YAAY,SAAS;AAE7B,QAAIiO;AAAAA,IADDjJ,KAAKhJ,OAAOo3B,iBACXnlB,QACJA,IAAIjJ,KAAKhJ,OAAOo3B,eAAe9pB,SAASC,cAAc,QACpDiB,YAAY,eACdyD,EAAEtR,MAAME,OAAOiO,KAAKM,OAAOpG,KAAKquB,KAAK,OAAO,CAAA,IAAK,MACjDplB,EAAEtR,MAAMC,MAAMkO,KAAKM,OAAOpG,KAAKsuB,KAAK,MAAM,CAAK,IAAA,MAC/CtuB,KAAKuuB,KAAK9pB,YAAYwE,CAExB;AAAA,EAAA,CAAA,GACAvS,EAAUsE,YAAY,SAAS;AAC9B,QAAIiO,IAAIjJ,KAAKhJ,OAAOo3B;AAChBnlB,IAAAA,YAAYA,KAAK,aACjBA,EAAEhH,cACJgH,EAAEhH,WAAWC,YAAY+G,CAE1BjJ,GAAAA,KAAKhJ,OAAOo3B,eAAAA;AAAAA,EAEd,CAAA;AAGA;AItTe,SAAS/Y,GAAO3e;AAsW9B,WAAS83B,IAAAA;AACR,UAAMC,IAAiB/3B,EAAUM,OAAO0tB,QAAQ,IAC1CgK,IAAAA,CAAAA,CAA0Bn4B,OAAa,QAAOA,CAAAA,CAAAA,OAAW,MAAKA,OAAa,QAAM,sBAAsB+N,SAASmJ;AACtH,WAAIghB,KAAkBC,IACdh4B,EAAUwiB,QAEV5U,SAASmJ;AAAAA,EAEjB;AA5WF/W,IAAUi4B,qBAAqB,CAAA,GAC/Bj4B,EAAUk4B,cAAc,SAAS3f,GAGhC;AAAA,aAFIjY,IAASgJ,KAAKhJ,OAAO63B,SAAS92B,UAC9B6B,IAAI,GACAA,IAAI5C,EAAO6C,UACd7C,EAAO4C,CAAAA,EAAGqV,QAAQA,GADIrV;AAAAA;AAM3B,QAAIA,MAAM5C,EAAO6C;AAEhB,aAAO;AAGR,QAAI6B,IAAU1E,EAAO4C,CAAAA;AAChBlD,MAAU4b,aACd5b,EAAUo4B;AAEX,QAAIC,IAASr4B,EAAU4b,UAAU8E,cAAc,IAAI1b,EAAQ/B,EACvDqjB,EAAAA,GAAAA,IAAO+R,EAAOlO,aAEd9R,IAAS,EACZrT,SAASA,GACTqzB,QAAQA,GACR/R,MAAMA,GACNgS,UAAS,SAASvyB,GAAAA;AACjB,aAAO/F,EAAUu4B,YAAYvzB,EAAQa,IAAM2yB,EAAAA,UAAUlS,GAAOvgB,KAAI,IAAKf,CAAAA;AAAAA,IACrE,GACDyzB,UAAS,SAASjgB,GAAOzS,GAAAA;AACxB,aAAO/F,EAAUu4B,YAAYvzB,EAAQa,IAAM6yB,EAAAA,UAAUpS,GAAM9N,GAAQzS,KAAI,CAAE,GAAGf,CAC5E;AAAA,IAAA,EAAA,GAGE0U,IAAU1Z,EAAUi4B,mBAAmB,SAAOjzB,EAAQa,OAAK,UAC/D;AAAA,WAAO6T,IAAQA,EAAQrB,KAAQA;AAAAA,EAChC,GACArY,EAAUi4B,mBAAmBU,uBAAuB,SAAStgB,GAE5D;AAAA,WADAA,EAAOugB,UAAUvgB,EAAOiO,MACjBjO;AAAAA,EACR,GACArY,EAAUi4B,mBAAmBY,qBAAqB,SAASxgB;AAE1D,WADAA,EAAOugB,UAAUvgB,EAAOiO,KAAKwS,qBAAqB,UAAU,CACrDzgB,GAAAA;AAAAA,EACR,GACArY,EAAUi4B,mBAAmBc,uBAAuB,SAAS1gB,GAAAA;AAE5D,WADAA,EAAOugB,UAAUvgB,EAAOiO,KAAKwS,qBAAqB,YAAY,CACvDzgB,GAAAA;AAAAA,EACR,GACArY,EAAUi4B,mBAAmBe,mBAAmB,SAAS3gB,GAExD;AAAA,WADAA,EAAOugB,UAAUvgB,EAAOiO,KAAKwS,qBAAqB,QAAA,GAC3CzgB;AAAAA,EACR,GAEArY,EAAUi4B,mBAAmBgB,WAAW,EACvCC,UAAU,EACTnqB,QAAO,GAAA,GAER6Y,UAAU,EACT7Y,QAAQ,OAET4Y,QAAQ,EACP5Y,QAAQ,GAAA,GAEToqB,MAAM,EACLpqB,QAAQ,GAKV/O,EAAAA,GAAAA,EAAUu4B,cAAY,EACrBW,UAAS,EACRtjB,QAAQ,SAASwjB,GAEhB;AAAA,WAAO,+CADeA,EAAIrqB,SAAS,iBAAiBqqB,EAAIrqB,eAAe,EAEvE;AAAA,EAAA,GACD2pB,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAChCgmB;AAAAA,IAAAA,EAAKxY,YAAY0K,KAAO;AAAA,EACxB,GACDggB,WAAU,SAASlS,GAAKvgB,GAAGzF,GAAAA;AAC1B,WAAOgmB,EAAKxY,aAAW;AAAA,EACvB,GACDurB,OAAO,SAAS/S;EACf,EAEFsB,GAAAA,UAAS,EACRhS,QAAO,SAASwjB,GAGf;AAAA,WAAO,8BAFeA,EAAIrqB,SAAS,iBAAiBqqB,EAAIrqB,eAAe,EACnDqqB,cAAAA,EAAIE,cAAc,gBAAgBF,EAAIE,WAAiB,MAAA,EAAA;AAAA,EAE3E,GACDZ,WAAU,SAASpS,GAAK9N,GAAMzS;AAC7B/F,MAAUu4B,YAAY3Q,SAAS2R,WAAWjT,CAAAA,EAAM9N,QAAMA,KAAO;AAAA,EAC7D,GACDggB,WAAU,SAASlS,GAAKvgB;AACvB,WAAO/F,EAAUu4B,YAAY3Q,SAAS2R,WAAWjT,CAAM9N,EAAAA;AAAAA,EACvD,GACD6gB,OAAM,SAAS/S,GACd;AAAA,QAAInE,IAAIniB,EAAUu4B,YAAY3Q,SAAS2R,WAAWjT,CAAAA;AAClDtmB,MAAUw5B,OAAOrX,GAAG,EAAA;AAAA,EACpB,GACDoX,YAAY,SAASjT;AACpB,WAAOA,EAAKwS,qBAAqB,UAAY,EAAA,CAAA;AAAA,EAC7C,EAEFnR,GAAAA,QAAO,EACN/R,QAAO,SAASwjB,GAIf;AAAA,aADI13B,IAAK,6CADa03B,EAAIrqB,SAAS,iBAAiBqqB,EAAIrqB,MAAAA,SAAe,EAE9D7L,iCAAAA,IAAE,GAAGA,IAAIk2B,EAAIxzB,QAAQzC,QAAQD;AACrCxB,MAAAA,KAAM,oBAAkB03B,EAAIxzB,QAAQ1C,CAAAA,EAAGmQ,MAAI,OAAK+lB,EAAIxzB,QAAQ1C,CAAAA,EAAG8wB,QAAM;AAEtE,WADAtyB,KAAM;AAAA,EAEN,GACDg3B,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGqzB,GAChC;AAAA,QAAIzR,IAASrB,EAAKrW;AAAAA,KACb0X,EAAO8R,iBAAiBL,EAAIM,aAChC15B,EAAUI,MAAMunB,GAAQ,UAAUyR,EAAIM,WACtC/R,EAAO8R,gBAAAA,KAEGjhB,iBACVA,KAASmP,EAAO/hB,QAAQ,CAAA,KAAI,CAAE,GAAE4S,QACjCmP,EAAOnP,QAAMA,KAAO;AAAA,EACpB,GACDggB,WAAU,SAASlS,GAAKvgB,GACvB;AAAA,WAAOugB,EAAKrW,WAAWuI;AAAAA,EACvB,GACD6gB,OAAM,SAAS/S;AACd,QAAInE,IAAEmE,EAAKrW;AAAYjQ,MAAUw5B,OAAOrX,KACxC;AAAA,EAAA,EAAA,GAEFgX,MAAK,EACJvjB,QAAO,SAASwjB,GACVA;AAAAA,MAAIO,gBAERP,EAAIO,cAAc,CAAC,SAAS,MAAM,MAAM,QAGzCP,EAAIQ,qBAAqB;AACzB,QAAID,IAAcP,EAAIO,aAElBt1B,IAAMrE,EAAUM,QAChBu5B,IAAK75B,EAAUgC,KAAKwF,UAAUxH,EAAU+J,aACxC+vB,CAAAA,GAAAA,IAAO,MAAOC,IAAQ;AACvB/5B,MAAUM,OAAO05B,sBACnBF,IAAO,KAAGz1B,EAAIgG,YAAU,GACxB0vB,IAAQ,KAAG11B,EAAI+F,YACfyvB,EAAG7wB,SAAS3E,EAAI+F,UAIjB;AAAA,aAFI1I,IAAO,IAEFgH,IAAI,GAAGA,IAAIixB,EAAYx2B,QAAQuF,KAAK;AAC5C,UAAIuxB,IAAcN,EAAYjxB,CAG1BA;AAAAA,MAAAA,IAAI,MACPhH,KAAQ;AAET,UAAIw4B,IAAiB,IACjBt0B,IAAU;AACd,cAAQq0B,GAAAA;AAAAA,QACP,KAAK;AAIJ,cAAIE,GACAC,GACAC;AALJH,UAAAA,IAAiB,4BACjBd,EAAIQ,mBAAmB,KAAKlxB,GAKzB0wB,EAAIkB,eACDhT,MAAM8R,EAAIkB,cAEJlB,EAAIkB,WAAW33B,SAEzBy3B,IAAahB,EAAIkB,WAAW,IAC5BD,IAAWjB,EAAIkB,WAAW,CAJ1BH,KAAAA,IAAQf,EAAIkB,aAQdH,IAAQA,KAAS;AACjB,cAAI5oB,IAASA,KAAUnC,KAAK+D,MAAMgnB,IAAQ,CAC1CC;AAAAA,UAAAA,IAAaA,KAAcP,EAAG3c,YAAAA,IAAgB3L,GAC9C8oB,IAAWA,KAAYD,IAAaD;AAEpC,mBAASj3B,IAAIk3B,GAAYl3B,IAAIm3B,GAAUn3B;AACtC0C,YAAAA,KAAW,oBAAiB20B,IAAS,OAAQA,IAAK;AACnD;AAAA,QACD,KAAK;AAIJ,eAHAL,IAAiB,6BACjBd,EAAIQ,mBAAmB,CAAA,IAAKlxB,GAEnBxF,IAAE,GAAGA,IAAI,IAAIA;AACrB0C,YAAAA,KAAS,oBAAkB1C,IAAE,OAAKoG,KAAKokB,OAAO1rB,KAAKmsB,WAAWjrB,CAAAA,IAAG;AAClE;AAAA,QACD,KAAK;AAIJ,eAHAg3B,IAAiB,2BACjBd,EAAIQ,mBAAmB,CAAA,IAAKlxB,GAEnBxF,IAAE,GAAGA,IAAI,IAAIA;AACrB0C,YAAAA,KAAS,oBAAkB1C,IAAE,OAAKA,IAAE;AACrC;AAAA,QACD,KAAK;AACJg3B,UAAAA,IAAiB,4BACjBd,EAAIQ,mBAAmB,KAAKlxB,GAExBxF,IAAI62B;AAAR,cACIS,IAAQX,EAAGhyB,QAAAA;AAGf,eAFAuxB,EAAIqB,eAAe,CAEbv3B,GAAAA,IAAE42B;AAEPl0B,YAAAA,KAAS,oBAAkB1C,IAAE,OADpBoG,KAAKmR,UAAUigB,YAAYb,CAAAA,IACG,aACvCT,EAAIqB,aAAa93B,KAAKO,CACtB22B,GAAAA,EAAGtL,QAAQsL,EAAGp3B,QAAAA,IAAgC,KAAtB6G,KAAKhJ,OAAOq6B,YAAa,MAEjDz3B,IAAO,MADK22B,EAAGhyB,QAAW2yB,KAAAA,IAAO,IAAE,KACzB,KAAiB,KAAdX,EAAG1vB,SAAc0vB,IAAAA,EAAGpuB;MAKpC;AAAA,UAAG7F,GAAQ;AAEV,YAAIg1B,IAAY56B,EAAU66B,SAASC,yBAAyBb,CAAAA;AAE5Dv4B,QAAAA,KAAQ,oBAAkBw4B,IAAe,QAD1Bd,EAAI2B,WAAW,wBAAwB,MACGH,IAAU,MAAIh1B,IAAQ;AAAA,MAC/E;AAAA,IACD;AAGD,WAAO,iCADewzB,EAAIrqB,SAAS,iBAAiBqqB,EAAIrqB,MAAAA,SAAe,MACdrN,CAAqHA,iHAAAA,CAAAA;AAAAA,EAC9K,GACDg3B,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAAAA;AAChC,QAGIiB,GAAYC,GAHZ6C,IAAMrE,EAAUM,QAChB8F,IAAEkgB,EAAKwS,qBAAqB,QAAA,GAC5Bj1B,IAAMvD,EAAOs5B;AAGjB,QAAGv1B,EAAI22B,UAAU;AAChB,UAAK1U,CAAAA,EAAK2U,WAAU;AACnB,YAAIv5B,IAAO,qFAAmF1B,EAAU0tB,OAAOwN,OAAOF,WAAS;AAC1Hh7B,UAAUM,OAAO66B,cACrBz5B,IAAO4kB,EAAK8U,gBAAgBttB,YAAUpM,IACvC4kB,EAAK8U,gBAAgBttB,YAAUpM,GAC/B4kB,EAAK2U;MACL;AACD,UAAIvT,IAAMpB,EAAK8U,gBAAgBtC,qBAAqB,OAAS,EAAA,CAAA;AAC7DpR,MAAAA,EAAM2T,UAAWr7B,EAAUgC,KAAKysB,UAAU1oB,EAAGxE,UAAAA,MAAc,KAAKvB,EAAUgC,KAAKysB,UAAU1oB,EAAGvE,cAAY,GAExG4E,EAAEvC,EAAI,IAAIy3B,WAAS5T,EAAM2T,SACzBj1B,EAAGvC,EAAI,CAAA,IAAKuC,EAAEjD,SAAO,CAAA,EAAIm4B,WAAS5T,EAAM2T,SAEpC3T,EAAMpI,oBACToI,EAAMpI,sBAELtf,EAAUI,MAAMsnB,GAAO,SAAS;AAChC,YAAGA,EAAM2T,SAAS;AACjB,cAAI34B,IAAM,CAAA;AACV1C,YAAUu4B,YAAYY,KAAKX,UAAUlS,GAAK5jB,GAAIpC,CAAAA,GAE9CiB,IAAavB,EAAUgC,KAAKwF,UAAU9E,EAAInB,UAC1CC,IAAAA,EAAAA,IAAWxB,EAAUgC,KAAKwF,UAAU9E,EAAIlB,QAEtBD,MAAAA,CAAAA,KAAAA,CAAgBC,MAAaD,MAAewE,EAAGvE,SAAS2I,SAAiD,MAAlC,KAAKpE,EAAGvE,SAASiK,WAAAA,MAAiB,QAC1HjK,IAAWxB,EAAUgC,KAAKC,IAAIT,GAAU,GAAG,KACnD;AAAA,QAAA;AACOD,UAAAA,IAAa,MACbC,IAAW;AAGZ4E,QAAAA,EAAEvC,EAAI,CAAIy3B,CAAAA,EAAAA,WAAS5T,EAAM2T,SACzBj1B,EAAGvC,EAAI,CAAA,IAAKuC,EAAEjD,SAAO,GAAIm4B,WAAS5T,EAAM2T,SAExCE,EAAsBn1B,GAAE,GAAE7E,KAAYwE,EAAGxE,UACzCg6B,GAAAA,EAAsBn1B,GAAE,GAAE5E,KAAUuE,EAAGvE,QAAAA;AAAAA,MAC7C;IAEI;AAED,QAAG6C,EAAIm3B,iBAAiBn3B,EAAIo3B;AAW3B,eAVIC,IAA0B;AAEvBr3B,QAAAA,EAAIm3B,iBAAiBn3B,EAAIo3B,mBAI/Bl6B,IAAa,IAAIiB,KAAK4D,EAAEvC,EAAI,CAAA,CAAA,EAAI2U,OAAMpS,EAAEvC,EAAI,CAAI2U,CAAAA,EAAAA,OAAMpS,EAAEvC,EAAI,CAAA,CAAA,EAAI2U,OAAM,GAAEpS,EAAEvC,EAAI,CAAA,CAAA,EAAI2U,KAClFhX,GAAAA,IAAW,IAAIgB,KAAKjB,EAAWitB,YAA+C,KAAlCxuB,EAAUM,OAAOm7B,iBAAsB,GAAA,GACnFF,EAAsBn1B,GAAG,GAAG5E,CAAAA;AAAAA,MACjC,GACY0B,IAAE,GAAGA,IAAE,GAAGA;AACbkD,QAAAA,EAAElD,CAAGoc,EAAAA,oBACRlZ,EAAElD,CAAAA,EAAGoc,kBAAkB,IACvBtf,EAAUI,MAAMgG,EAAElD,IAAI,UAAUw4B,CAAAA;AAKnC,aAASH,EAAsBn1B,GAAElD,GAAEyO,GAAAA;AAKlC,eAJIgqB,IAAcr7B,EAAOm6B,cACrBmB,IAA4B,KAAbjqB,EAAExH,aAAcwH,EAAElG,WAAAA,GACjCowB,IAAcD,GACdE,IAAc,IACTnvB,IAAE,GAAGA,IAAEgvB,EAAYx4B,QAAQwJ,KAAK;AACxC,YAAIovB,IAAMJ,EAAYhvB,CAAAA;AACtB,YAAIovB,MAAQH,GAAc;AACzBE,UAAAA,IAAAA;AACA;AAAA,QACA;AACGC,QAAAA,IAAMH,MACTC,IAAcE;AAAAA,MACf;AAED31B,MAAAA,EAAElD,IAAEW,EAAI,CAAI2U,CAAAA,EAAAA,QAAMpS,IAAcw1B,IAAaC,GACxCC,KAAeD,MACnBz1B,EAAElD,IAAEW,EAAI,CAAA,CAAA,EAAIm4B,qBAEb51B,EAAElD,IAAEW,EAAI,CAAA,CAAA,EAAI2U,QAAM7G,EAAE9J,QAAAA,GACpBzB,EAAElD,IAAEW,EAAI,CAAA,CAAA,EAAI2U,QAAM7G,EAAEwL,SAAAA,GACpB/W,EAAElD,IAAEW,EAAI,IAAI2U,QAAM7G,EAAEuL,YACpB;AAAA,IAAA;AAEDqe,IAAAA,EAAsBn1B,GAAE,GAAEL,EAAGxE,UAAAA,GAC7Bg6B,EAAsBn1B,GAAE,GAAEL,EAAGvE,QAC7B;AAAA,EAAA,GACDg3B,WAAU,SAASlS,GAAMvgB,GAAIzF;AAC5B,QAAI8F,IAAIkgB,EAAKwS,qBAAqB,QAAA,GAC9Bj1B,IAAMvD,EAAOs5B;AAKjB,QAHA7zB,EAAGxE,aAAW,IAAIiB,KAAK4D,EAAEvC,EAAI,IAAI2U,OAAMpS,EAAEvC,EAAI,CAAI2U,CAAAA,EAAAA,OAAMpS,EAAEvC,EAAI,CAAI2U,CAAAA,EAAAA,OAAM,GAAEpS,EAAEvC,EAAI,IAAI2U,KACnFzS,GAAAA,EAAGvE,WAAS,IAAIgB,KAAK4D,EAAEvC,EAAI,CAAG,IAAA,CAAA,EAAG2U,OAAMpS,EAAEvC,EAAI,KAAG,CAAG2U,EAAAA,OAAMpS,EAAEvC,EAAI,CAAA,IAAG,CAAG2U,EAAAA,OAAM,GAAEpS,EAAEvC,EAAI,CAAG,IAAA,CAAA,EAAG2U,SAEpFpS,EAAEvC,EAAI,IAAI2U,SAASpS,CAAAA,EAAEvC,EAAI,CAAA,IAAG,CAAG2U,EAAAA,OAAO;AAE1C,UAAIyjB,IAAWj8B,EAAUyE,SAASzE,EAAU0b;AACzCugB,MAAAA,MACFl2B,EAAGxE,aAAa06B,EAAS16B,YACzBwE,EAAGvE,WAAWy6B,EAASz6B;AAAAA,IAExB;AAID,WAFIuE,EAAGvE,YAAUuE,EAAGxE,eACnBwE,EAAGvE,WAASxB,EAAUgC,KAAKC,IAAI8D,EAAGxE,YAAWvB,EAAUM,OAAOq6B,WAAU,YAClE,EACNp5B,YAAY,IAAIiB,KAAKuD,EAAGxE,UAAAA,GACxBC,UAAU,IAAIgB,KAAKuD,EAAGvE,QAEvB,EAAA;AAAA,EAAA,GACD63B,OAAM,SAAS/S,GAAAA;AACdtmB,MAAUw5B,OAAOlT,EAAKwS,qBAAqB,UAAU,CACrD,CAAA;AAAA,EAAA,EAAA,EAAA,GAiBH94B,EAAUk8B,iBAAiB,SAASjT;AAC/BA,IAAAA,MAIJA,EAAIhoB,MAAMC,MAAMkO,KAAKC,IAAIyoB,IAAkBzU,eAAe,IAAI4F,EAAI5F,eAAa,GAAG,KAAK,MACvF4F,EAAIhoB,MAAME,OAAOiO,KAAKC,IAAIyoB,IAAkBvU,cAAc,IAAI0F,EAAI1F,cAAY,GAAG,KAAK;AAAA,EAEvF,GAEAvjB,EAAUm8B,YAAU,SAASlT,GAAAA;AACxBA,IAAAA,MACHA,EAAIhoB,MAAMkgB,UAAQ,SAElB7X,KAAK4yB,eAAejT,CAElBjpB,IAAAA,EAAUM,OAAO87B,wBACnBxuB,SAAS8T,gBAAgB7C,UAAU5c,IAAI,+BACvC61B,EAAkBjZ,EAAAA,UAAU5c,IAAI,4BAEjCqH,IAAAA,KAAK+yB,WACL/yB,GAAAA,KAAKgzB,OAAOr7B,MAAMkgB,UAAU;AAAA,EAC7B,GACAnhB,EAAUu8B,eAAa,SAASt5B;AAC/B,QAAKA;AACL,UAAKqG,KAAKH,UAAU,oBAAmB,CAAClG,CAAxC,CAAA,GAAA;AAKAqG,aAAK6yB,UAAUlT,CAAAA;AACf,YAAIA,IAAM3f,KAAK8uB,YACf9uB;AAAAA,aAAK4yB,eAAejT,CAAAA,GACpB3f,KAAKkzB,eAAev5B,GAAGgmB,IACvB3f,KAAKuxB,SAAS4B,oBAAoBxT,CAElC3f,GAAAA,KAAKH,UAAU,cAAa,CAAClG,CAAAA,CAAAA;AAAAA,MAP5B;AAHIqG,aAAKmS,eACRnS,KAAKmS,aAAa;AAAA,EAUrB,GACAzb,EAAUw8B,iBAAiB,SAASv5B,GAAIgmB,GACvC;AAAA,QAAIljB,IAAKuD,KAAK7E,SAASxB,IACnBmD,IAAI6iB,EAAI6P,qBAAqB,MAC7B4D,GAAAA,IAAiB,CAErB;AAAA,QAAI18B,EAAUya,UAAUkiB,iBAAiB;AACxCD,MAAAA,EAAe/5B,KAAK,EACpB;AAAA,UAAIi6B,IAAgB58B,EAAUya,UAAUkiB,gBAAgB52B,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CACpF22B;AAAAA,MAAAA,EAAe/5B,KAAKi6B,CACpBx2B,GAAAA,EAAE,GAAG0H,YAAY,IACjB1H,EAAE,CAAG0H,EAAAA,YAAY8uB;AAAAA,IACnB,OAAQ;AACN,UAAIC,IAAavzB,KAAKmR,UAAUqiB,aAAa/2B,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAAA,GACrEg3B,KAAezzB,KAAKmR,UAAUuiB,eAAej3B,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAAA,KAAO,IAAI2vB,OAAO,GAAG,EAAA;AAElGgH,MAAAA,EAAe/5B,KAAKk6B,CAAAA,GACpBH,EAAe/5B,KAAKo6B,CAAAA,GACpB32B,EAAE,CAAG0H,EAAAA,YAAY+uB,GACjBz2B,EAAE,CAAG0H,EAAAA,YAAYivB;AAAAA,IACjB;AAEDzzB,SAAKuxB,SAAS6B,eAAezT,GAAMyT,EAAejvB,KAAK,GAAA,CAAA;AAGvD,aADI2rB,IAAM9vB,KAAKhJ,OAAO63B,SAAS92B,UACtB6B,IAAI,GAAGA,IAAIk2B,EAAIj2B,QAAQD,KAAK;AACpC,UAAI+5B,IAAc7D,EAAIl2B,IAClBojB,IAAOtmB,EAAUk9B,2BAA2BD,CAC5CtvB,GAAAA,IAAQrE,KAAKivB,YAAY0E,EAAYp3B,IACrC2S,GAAAA,IAASzS,EAAGk3B,EAAYz5B,MAAyBuC,MAAjDyS,SAAiDzS,EAAGk3B,EAAYz5B,MAAUy5B,IAAAA,EAAYE;AAC1FxvB,MAAAA,EAAM+qB,UAAUnkB,KAAKjL,MAAMgd,GAAM9N,GAAOzS,GAAIk3B,CACxC7D,GAAAA,EAAIl2B,GAAGm2B,SACV1rB,EAAM0rB,MAAM9kB,KAAKjL,MAAMgd;IACxB;AAEDtmB,MAAU0b,eAAezY;AAAAA,EAC1B,GAEAjD,EAAUk9B,6BAA6B,SAASl4B;AAC/C,WAAOhF,EAAU4b,UAAU8E,cAAc,IAAI1b,EAAQ/B,MAAMknB;AAAAA,EAC5D,GAEAnqB,EAAUo9B,gBAAc,SAASr3B;AAEhC,aADIqzB,IAAM9vB,KAAKhJ,OAAO63B,SAAS92B,UACtB6B,IAAE,GAAGA,IAAIk2B,EAAIj2B,QAAQD,KAAK;AAClC,UAAIojB,IAAOtmB,EAAU4b,UAAU8E,cAAc,IAAI0Y,EAAIl2B,CAAAA,EAAGD;AACxDqjB,MAAAA,IAAMA,KAAKA,EAAK6D;AAChB,UACI/iB,IADMkC,KAAKivB,YAAYa,EAAIl2B,CAAG2C,EAAAA,IAAAA,EACpB2yB,UAAUjkB,KAAKjL,MAAKgd,GAAKvgB,GAAIqzB,EAAIl2B,CAC5B,CAAA;AAAA,MAAfk2B,EAAIl2B,CAAAA,EAAGM,UAAQ,WAClBuC,EAAGqzB,EAAIl2B,GAAGM,MAAQ4D,IAAAA;AAAAA,IACnB;AACD,WAAOrB;AAAAA,EACR,GACA/F,EAAUq9B,kBAAgB,SAASztB;AAClC,QAAI3M,IAAGjD,EAAU0b,cACb3V,IAAGuD,KAAK7E,SAASxB,CAAAA;AAGrBqG,SAAKoD,WAAW3G,GAAI6J,CAAAA,GAEpBtG,KAAKg0B,SAASv3B,EAAG9C,IAAG8C,CACpBuD,GAAAA,KAAKi0B,iBAAiBx3B,GAAG,EAAA,GACzBuD,KAAK0M,iBAAAA;AAAAA,EACN,GACAhW,EAAUw9B,gBAAc,SAASv6B,GAAAA;AAChCjD,MAAU2b,YAAY,IAAOrS,KAAK8uB,YACnC,CAAA;AAAA,EAAA,GAEAp4B,EAAUy9B,YAAU,SAASxU,GAAAA;AACxBA,IAAAA,MAAKA,EAAIhoB,MAAMkgB,UAAQ,SAC3B7X,KAAKo0B,cACF19B,EAAUM,OAAO87B,wBACnBxuB,SAAS8T,gBAAgB7C,UAAUwL,OAAO,4BAC1CyN,GAAAA,EAAAA,EAAkBjZ,UAAUwL,OAAO,4BAAA;AAAA,EAErC,GACArqB,EAAU09B,aAAW,WAChBp0B;AAAAA,SAAKgzB,UACRhzB,KAAKgzB,OAAO/wB,WAAWC,YAAYlC,KAAKgzB,MACzChzB,GAAAA,KAAKgzB,SAAO;AAAA,EACb,GAEAt8B,EAAUq8B,aAAW,WACjB/yB;AAAAA,SAAKgzB,WAIRhzB,KAAKgzB,SAAO1uB,SAASC,cAAc,KAAA,GACnCvE,KAAKgzB,OAAOxtB,YAAU,iBACtBxF,KAAKgzB,OAAOr7B,MAAMkgB,UAAU,QAE5BnhB,EAAUI,MAAMkJ,KAAKgzB,QAAQ,aAAat8B,EAAU29B,eAAAA,GACpD39B,EAAUI,MAAMkJ,KAAKgzB,QAAQ,WAAWt8B,EAAU49B,WAAAA,GAElD9F,IAAkB/pB,YAAYzE,KAAKgzB;EACpC,GACAt8B,EAAU69B,gBAAc,WAAA;AACvB,QAAIjuB,IAAOtG,KAAK8zB,cAAc,CAAE,GAAE9zB,KAAKoD,WAAWpD,KAAK7E,SAAS6E,KAAKoS;AACjEpS,SAAKJ,WAAW,mBAAmBI,KAAKH,UAAU,eAAc,CAACG,KAAKoS,cAAc9L,GAAMtG,KAAKmS,UAEnGnS,CAAAA,MAAAA,KAAK+zB,gBAAgBztB,CAAAA,GACrBtG,KAAKk0B,cACN;AAAA,EAAA,GACAx9B,EAAU89B,gBAAgB,SAAS76B,GAAIgmB,GACtC3f;AAAAA,SAAKoS,eAAezY,GACpBqG,KAAKy0B,mBAAAA,IAELz0B,KAAK00B,iBAAiB10B,KAAKsS,WAC3BtS,KAAKsS,YAAYqN,GACjB3f,KAAK6yB,UAAUlT,CAAAA;AAAAA,EAChB,GACAjpB,EAAU2b,cAAc,SAASpX,GAAM0kB;AAClCA,QAAMA,KAAOjpB,EAAUo4B,YAA3B;AAAA,QAEIh4B,IAAQJ,EAAUyE,SAAS6E,KAAKoS;AACjCtb,IAAAA,KACFkJ,KAAKi0B,iBAAiBn9B,GAAOmE,CAAAA,GAC1BA,KACHvE,EAAUgW,iBAAAA,GACX1M,KAAKm0B,UAAUxU,CAEX3f,GAAAA,KAAKy0B,qBACRz0B,KAAKsS,YAAYtS,KAAK00B,gBACtB10B,KAAKy0B,wBAENz0B,KAAK00B,iBAAiB10B,KAAKoS,eAAe,MAC1CpS,KAAKuxB,SAASoD,mBAAmBhV,IACjC3f,KAAK40B,cAAAA,GACL50B,KAAKH,UAAU,mBAAkB,CAClC,CAAA;AAAA,EAAA,GACAnJ,EAAUk+B,gBAAgB;AACrBl+B,MAAU4b,aAAAA,CAAc5b,EAAU+9B,oBACrC/9B,EAAU4b,UAAUrQ,WAAWC,YAAYxL,EAAU4b,SAAAA,GACtD5b,EAAU4b,YAAY;AAAA,EACvB,GACA5b,EAAUm+B,kBAAgB,WACtB70B;AAAAA,SAAKoS,gBACPpS,KAAKH,UAAU,iBAAgB,CAACG,KAAKoS,cAAAA,CAAAA,CAAgBpS,KAAKmS,UAG3DnS,CAAAA,GAAAA,KAAKk0B;EACN,GACAx9B,EAAUo+B,eAAep+B,EAAUm+B,iBAEnCn+B,EAAUq+B,wBAAsB,WAC/B;AAAA,QAAG/0B,KAAK8uB,YAAc9Y,EAAAA;AACrB;AAED,UAAM6Y,IAAW7uB,KAAK8uB,YACtBD;AAAAA,MAAS7Y,kBAAkB,IAE3Btf,EAAUI,MAAM+3B,GAAU,SAAS,SAAS3zB;AAExCA,MAAAA,EAAEE,OAAOC,QAAQ,2BACnB3E,KAAAA,EAAUm+B,gBAGX;AAAA,YAAMG,IAAet+B,EAAUu+B,YAAY55B,QAAQH,EAAEE,QAAQ,cAC7D;AAAA,UAAA,CAAI45B,GAAc;AACjB,cAAME,IAAgBx+B,EAAUu+B,YAAY55B,QAAQH,EAAEE,QAAQ,wCAAA;AAC9D,YAAG85B,GAAc;AAChB,gBAAM58B,IAAQmc,OAAOygB,EAAcr6B,aAAa,oBAClCnE,CAAAA;AAAAA,YAAUu4B,YAAYv4B,EAAUM,OAAO63B,SAAS92B,SAASO,CAAAA,EAAOiE,MACxE44B,aAAaz+B,EAAUu+B,YAAY55B,QAAQ65B,GAAe,mBAAA,GAAsBA,GAAeh6B,CACrG;AAAA,QAAA;AACD;AAAA,MACA;AAED,YAAM4T,IAASkmB,IAAeA,EAAan6B,aAAa,aAAiB,IAAA;AAEzE,cAAOiU,GACN;AAAA,QAAA,KAAK;AAAA,QACL,KAAK;AACJ,cAAGpY,EAAUM,OAAOo+B;AACnB;AAED1+B,YAAU69B,cAAAA;AACV;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AACJ,cAAG79B,EAAUM,OAAOo+B;AACnB;AAED,cAAIx2B,IAAElI,EAAU0tB,OAAOwN,OAAOyD;AAE9B3+B,YAAU4+B,gBAAgB,EAAC7iB,SAAS7T,GAAG22B,OAAO7+B,EAAU0tB,OAAOwN,OAAO4D,wBAAwBpqB,UAAU,WACvG;AAAA,gBAAI3O,IAAK/F,EAAUyE,SAASzE,EAAU0b,YAElC3V;AAAAA,YAAAA,EAAGg5B,qBACNh5B,EAAGi5B,mBAAmB,IACtBh/B,EAAUmJ,UAAU,eAAe,CAACpD,EAAG9C,IAAI8C,GAAG/F,EAAUyb,UAAAA,CAAAA,KAExDzb,EAAUub,YAAYvb,EAAU0b,YAAAA,GAEjC1b,EAAUyb,aAAa,MACvBzb,EAAUw9B,cACV;AAAA,UAAA,GACDl9B,QAAQ,EAAC2+B,IAAIj/B,EAAU0tB,OAAOwN,OAAOgE,YAAAA,EAAAA,CAAAA;AAErC;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AACJl/B,YAAUm+B;AACV;AAAA,QAED;AACCn+B,YAAUmJ,UAAU,oBAAoB,CAACiP,GAAQkmB,GAAc95B,CAAAA,CAAAA;AAAAA,MAAAA;AAAAA,IAEnE,IACCxE,EAAUI,MAAM+3B,GAAU,WAAW,SAAS3zB,GAC7C;AAAA,UAAIpE,IAAQoE,KAAK3E,OAAOO,OACpBsE,IAASF,EAAEE,UAAUF,EAAEoiB,YACvB0X,IAAe55B,EAAOgc,cAAc,cAAA;AAMxC,cAJI4d,MACHA,IAAe55B,EAAO6G,WAAWmV,cAAc,mCAGxClc,KAAAA,KAAGpE,GAAO++B,SACjB;AAAA,QAAA,KAAK;AACJ,eAAK36B,KAAGpE,GAAOg/B;AAAU;AACtBd,UAAAA,KAAgBA,EAAajf,SAC/Bif,EAAajf;AAEd;AAAA,QAED,KAAKrf,EAAUq/B,KAAKC;AACnB,eAAK96B,KAAGpE,GAAOg/B;AAAU;AACzB,cAAGd,KAAgBA,EAAajf;AAC/Bif,YAAAA,EAAajf,MACT;AAAA,eAAA;AACJ,gBAAGrf,EAAUM,OAAOo+B;AACnB;AAED1+B,cAAU69B,cACV;AAAA,UAAA;AACD;AAAA,QACD,KAAK79B,EAAUq/B,KAAKE;AACnBv/B,YAAUm+B,gBAAAA;AAAAA,MAAAA;AAAAA,IAMd,IAKCn+B,EAAUI,MAAM+3B,GAAU,SAAS,SAAS3zB;AAC3C,UAAIA,EAAEE,OAAOC,QAAQ,0BAA+BH,KAAAA,EAAEE,OAAOC,QAAQ,4BAAA,GAA+B;AACnG,cAAM66B,IAAmBrH,EAASp1B,iBAAiB,4BAAA,GAC7C08B,IAAiBtH,EAASp1B,iBAAiB,0BAAA,GAC3C28B,IAAkBvH,EAASp1B,iBAAiB;AAE9Cy8B,QAAAA,EAAiBr8B,UAAUs8B,EAAet8B,UAAUu8B,KACvDF,EAAiBp7B,QAAQ,CAACujB,GAAQzkB,MACjC;AAAA,gBAAMy8B,IAAYF,EAAev8B,CAAAA,GAC3B08B,IAAQhX,SAASjB,EAAOnP,OAAO,EAAA;AACrC,cAAIqnB,IAAOjX,SAAS8W,EAAgBx8B,CAAAA,EAAGsV,OAAO,EAC1CqnB;AAAAA,UAAAA,MACHA,IAAO,IAAIr9B,KAAKxC,EAAU4E,SAAAA,EAAW5C,IAAMkb,EAAAA,YAAAA;AAE5C,gBAAM4iB,IAlBV,SAAwBD,GAAMD,GAC7B;AAAA,mBAAO,IAAIp9B,KAAKq9B,GAAMD,IAAQ,GAAG,CAAG/3B,EAAAA,QAAAA;AAAAA,UACpC,EAgBsCg4B,GAAMD,IACnCG,IAAUD,KAAe;AAC/B,cAAIE,IAAcL,EAAUnnB;AAE5BmnB,UAAAA,EAAU7xB,YAAY;AACtB,mBAASG,IAAM,GAAGA,KAAO8xB,GAAS9xB,KAAO;AACxC,kBAAM2mB,IAAShnB,SAASC,cAAc;AACtC+mB,YAAAA,EAAOpc,QAAQvK,GACf2mB,EAAOqL,cAAchyB,GACrB0xB,EAAU5xB,YAAY6mB,CACtB;AAAA,UAAA;AACD+K,UAAAA,EAAUnnB,QAAQpJ,KAAKE,IAAI0wB,GAAaD;QAAQ,CAGlD;AAAA,MAAA;AAAA,IACH;EACA,GACA//B,EAAUkgC,kBAAgB,WAAA;AAAA,EAW1B,GAEAlgC,EAAUmgC,mBAAmB,WAC5BngC;AAAAA,MAAUI,MAAM03B,EAAmB,GAAA,aAAa93B,EAAU29B,eAC1D39B,GAAAA,EAAUI,MAAM03B,EAAAA,GAAmB,WAAW93B,EAAU49B,cACxD59B,EAAUmgC,mBAAmB;;EAC9B,GACAngC,EAAU29B,kBAAkB,SAASn5B,GACpC;AAAA,QAAIxE,EAAUogC,eAAc;AACtBxyB,eAASyyB,qBACbvI,IAAkBjZ,UAAU5c,IAAI,qBAChC2L,SAASyyB,mBAAAA;AAEV,UAAIC,IAAKtgC,EAAUo4B,eACftuB,IAAM,CAACtF,EAAE+7B,OAAO/7B,EAAEg8B;AACtBF,MAAAA,EAAGr/B,MAAMC,MAAMlB,EAAUygC,UAAU,CAAA,IAAG32B,EAAI,CAAG9J,IAAAA,EAAUogC,cAAc,CAAG,IAAA,MACxEE,EAAGr/B,MAAME,OAAOnB,EAAUygC,UAAU,CAAG32B,IAAAA,EAAI,KAAG9J,EAAUogC,cAAc,KAAG;AAAA,IACzE;AAAA,EACF,GACApgC,EAAU0gC,gBAAgB,SAASl8B,GAAAA;AAClC,QAAI87B,IAAKtgC,EAAUo4B,YACnBp4B;AAAAA,MAAUygC,YAAY,CAACH,EAAGxX,YAAYwX,EAAGzX,SAAAA,GACzC7oB,EAAUogC,gBAAgB,CAAC57B,EAAE+7B,OAAO/7B,EAAEg8B,KAAAA;AAAAA,EACvC,GACAxgC,EAAU49B,cAAc;AACnB59B,MAAUygC,cACbzgC,EAAUygC,YAAYzgC,EAAUogC,gBAAAA,IAChCtI,EAAkBjZ,EAAAA,UAAUwL,OAAO,kBACnCzc,GAAAA,SAASyyB;EAEX,GACArgC,EAAUo4B,cAAY,WAAA;AACrB,SAAK9uB,KAAKsS,WAAU;AACnB,UAAIjK,IAAE/D,SAASC,cAAc,KAAA;AAC7B8D,QAAE7C,YAAU,iBACR9O,EAAUM,OAAO66B,cACpBxpB,EAAE7C,aAAW,wBACV9O,EAAUu4B,YAAYoI,cACzBhvB,EAAE7C,aAAW,uBACV9O,EAAUM,OAAOsgC,QACpBjvB,EAAE7C,aAAW,uBACV9O,EAAUM,OAAO87B,wBACpBzqB,EAAE7C,aAAa,8BAEhB6C,EAAE1Q,MAAMgmB,aAAW;AACnB,UAAIvlB,IAAO4H,KAAKu3B,oBAEZC,IAAUx3B,KAAKhJ,OAAOygC;AAG1Br/B,WAAQ;AAER,eAASwB,IAAI,GAAGA,IAAI49B,EAAQ39B,QAAQD;AAEnCxB,aAAQ,UADG4H,KAAKuxB,SAASmG,yBAAyBF,EAAQ59B,CAAAA,CAAAA,IACjC,mBAAkB49B,EAAQ59B,CAAAA,IAAG,+BAA6BlD,EAAUM,OAAOsgC,MAAI,UAAQ,UAAQ,cAAcE,EAAQ59B,CAAK,IAAA,qCAAqC49B,EAAQ59B,CAAK,IAAA,kBAAkBlD,EAAU0tB,OAAOwN,OAAO4F,EAAQ59B,CAAM,CAAA,IAAA;AAG9P49B,MAAAA,IAAUx3B,KAAKhJ,OAAO2gC;AACtB,UAAIL,IAAM5gC,EAAUM,OAAOsgC;AAC3B,WAAS19B,IAAI,GAAGA,IAAI49B,EAAQ39B,QAAQD;AAGnCxB,aAAQ,oDAERA,KAAQ,UAJG4H,KAAKuxB,SAASmG,yBAAyBF,EAAQ59B,CAIjC,CAAA,IAAA,mBAAkB49B,EAAQ59B,CAAAA,IAAG,+BAA6B09B,IAAI,SAAO,WAAS,cACpGE,EAAQ59B,CAAK,IAAA,qCACb49B,EAAQ59B,CAAK,IAAA,kBAAkBlD,EAAU0tB,OAAOwN,OAAO4F,EAAQ59B,MAAM;AAEzExB,WAAQ,UACRA,KAAM,UACNiQ,EAAE7D,YAAUpM,GACR1B,EAAUM,OAAO4gC,kBACpBlhC,EAAUI,MAAMuR,EAAE1B,YAAY,aAAajQ,EAAU0gC,aAAAA,GACrD1gC,EAAUI,MAAMuR,EAAE1B,YAAY,eAAe,SAASzL,GAAAA;AAErD,eADAA,EAAE28B,eAAAA,GAAAA;AAAAA,MAEN,CACGxvB,GAAAA,EAAE1B,WAAWhP,MAAMmgC,SAAS,QAC5BphC,EAAUmgC,iBAIX72B,IAAAA,KAAKuxB,SAASwG,aAAa1vB,CAAAA,GAE3BrI,KAAK+yB,WACL/yB,GAAAA,KAAKgzB,OAAOlS,aAAazY,GAAErI,KAAKgzB,OAAOrsB,UAEvC3G,GAAAA,KAAKsS,YAAUjK;AAEf,UAAIynB,IAAI9vB,KAAKhJ,OAAO63B,SAAS92B;AAE7B,WADAK,IAAK,IACIwB,IAAE,GAAGA,IAAIk2B,EAAIj2B,QAAQD,KAAK;AAClC,YAAIyK,IAAMrE,KAAKivB,YAAYa,EAAIl2B,CAAG2C,EAAAA,IAAAA;AAClC,YAAK8H,GAAL;AACAyrB,UAAAA,EAAIl2B,CAAGD,EAAAA,KAAG,UAAQqG,KAAK+C,IAAAA;AACvB,cAAIwb,IAAS;AACb,UAAIuR,EAAIl2B,CAAG2kB,EAAAA,WAEVA,IAAS,UADM7nB,EAAU66B,SAASyG,gCAAgCh4B,KAAKokB,OAAOwN,OAAO,YAAU9B,EAAIl2B,GAAG2kB,MAC5E,CAAA,IAAA,oDAAkD3kB,IAAE,cAAYA,IAAE,qCAAmCk2B,EAAIl2B,CAAAA,EAAG2kB,SAAO,kBAAgBve,KAAKokB,OAAOwN,OAAO,YAAU9B,EAAIl2B,GAAG2kB,MAAQ,IAAA,iBAGtMve,KAAKhJ,OAAO66B,cACfz5B,KAAM;AAGP,cAAI6/B,IAAaj4B,KAAKokB,OAAOwN,OAAO,aAAW9B,EAAIl2B,CAAAA,EAAGqV;AAC7B,UAAfgpB,OAAAA,KAAe,aACxBA,IAAanI,EAAIl2B,CAAGqV,EAAAA,OAErB7W,KAAM,cAAY03B,EAAIl2B,GAAGD,KAAG,gDAA8Cm2B,EAAIl2B,CAAGqV,EAAAA,OAAK,OAAKsP,IAAQ,YAAU0Z,IAAW,mBAAiB5zB,EAAMiI,OAAOrB,KAAKjL,MAAK8vB,EAAIl2B,KACpKxB,KAAM;AAAA,QAjBe;AAAA,MAkBrB;AAED,UAAI8/B,IAAG7vB,EAAEmnB,qBAAqB,KAAA;AAC9B,WAAS51B,IAAE,GAAGA,IAAEs+B,EAAGr+B,QAAQD,KAAK;AAC/B,YAAIu+B,IAAOD,EAAGt+B,CAEd;AAAA,YADgBlD,EAAUkQ,cAAcuxB,MACvB,iBAAiB;AACjCA,UAAAA,EAAK3zB,YAAYpM;AACjB;AAAA,QACA;AAAA,MACD;AAGD1B,QAAU0hC,oBAAoBtI,IAG9B9vB,KAAK42B,gBAAAA,GAEL52B,KAAK+0B,sBAAsB/0B,IAAAA,GAE3BqI,EAAE1Q,MAAMgmB,aAAW;AAAA,IACnB;AAGD,WAAO3d,KAAKsS;AAAAA,EACb,GAEA5b,EAAU0hC,sBAAsB,SAASrgC,GAAAA;AAIxC,aAAQ6B,IAAI,GAAGA,IAAI7B,EAAS8B,QAAQD,KAAI;AACvC,UAAI8B,IAAU3D,EAAS6B,CAAAA;AACvB,UAAI8B,EAAQ/B,MAAOjD,EAAU4b,UAAU8E,cAAc,IAAI1b,EAAQ/B,EAAjE,EAAA,GAAA;AAOA,iBAHI+wB,IADah0B,EAAU4b,UAAU8E,cAAc,IAAI1b,EAAQ/B,EACxCyd,EAAAA,EAAAA,cAAc,UAEjCihB,IAAa3hC,EAAUk9B,2BAA2Bl4B,CAChD28B,GAAAA,KAAAA,CAAeA,EAAWjhB;AAC/BihB,UAAAA,IAAaA,EAAWxX;AAGzB,YAAIyX,IAAAA;AAEJ,YAAGD,GAAY;AACd,cAAIja,IAAQia,EAAWjhB,cAAc,yBAClCgH;AAAAA,UAAAA,MACF1iB,EAAQ68B,UAAUna,EAAMzkB,MAAM,WAAWjD,EAAUqM,OAC/Cqb,EAAMzkB,OACTykB,EAAMzkB,KAAK+B,EAAQ68B,UACpB7N,EAAMjV,aAAa,OAAO/Z,EAAQ68B,OAAAA,GAClCD;QAED;AAGD,QAAGA,KACY5hC,EAAUu4B,YAAYvzB,EAAQa,IACjCwzB,EAAAA,SACVr5B,EAAUI,MAAM4zB,GAAO,SAAS,SAAUhvB,GAAAA;AACzC,iBAAO,WAAA;AAEN,gBAAI2I,IAAQ3N,EAAUu4B,YAAYvzB,EAAQa,OACtCygB,IAAOtmB,EAAUk9B,2BAA2Bl4B,CAE7C2I;AAAAA,YAAAA,KAASA,EAAM0rB,SACjB1rB,EAAM0rB,MAAM9kB,KAAKvU,GAAWsmB,CAAAA;AAAAA,UACnC;AAAA,QACK,EAAEthB;MApCK;AAAA,IAuCV;AAAA,EACF,GAEAhF,EAAUsE,YAAY,mBAAmB,SAASw9B,GAAQC,GAAAA;AACtDz4B,SAAKoS,gBAAgBomB,MACvBx4B,KAAKoS,eAAeqmB;AAAAA,EACtB,CAEA/hC,GAAAA,EAAU6gC,qBAAoB;AAAA;AAAA;AAAA;AAAA;AAO9B;ACh4Be,SAASliB,GAAO3e;AAG/BA,IAAUgiC,qBAAqB;AAa9B,SAZa14B,KAAKhJ,OAAO2hC,UACpB7Y,UAAUC,UAAUlZ,QAAQ,QAAA,KADR8xB,MAEtB7Y,UAAUC,UAAUlZ,QAAQ,MACa,KAFX,MAE9BiZ,UAAUC,UAAUlZ,QAAQ,SAAA,KAAa,MACzCiZ,UAAUC,UAAUlZ,QAAQ,OAAmBtQ,KADnB,OACmBA,CAAAA,OAAOqiC,YACrD9Y,UAAU+Y,aAAa,cAAc/Y,UAAUgZ,iBAAiB,OAGnE94B,KAAKyX,GAAGshB,eAAe,GACvB/4B,KAAKg5B,UAAAA,KAGHh5B,KAAKhJ,OAAO2hC,OAAM;AAEpB,UAAIM,IAAAA;AACJ,UACC30B;AAAAA,iBAAS40B,YAAY,YACrB;AAAA,MAAA,QACAD;AAAAA,QAAAA,IAAAA;AAAAA,MACA;AAEGA,MAAAA,IACHj5B,KAAKm5B,cAAc,CAAC,aAAa,cAAc,UAAa,GAAA,SAAU18B;AACrE,eAAIA,EAAG28B,WAAW38B,EAAG28B,QAAQv/B,SAAS,IAAU,OAC5C4C,EAAG28B,QAAQ,CACP,IAAA,EACNh+B,QAAQqB,EAAGrB,QACX67B,OAAOx6B,EAAG28B,QAAQ,CAAA,EAAGnC,OACrBC,OAAOz6B,EAAG28B,QAAQ,CAAGlC,EAAAA,OACrBjV,SAASxlB,EAAG28B,QAAQ,CAAGnX,EAAAA,SACvBC,SAASzlB,EAAG28B,QAAQ,CAAGlX,EAAAA,QAAAA,IAGjBzlB;AAAAA,MACZ,GAAM,WAAA;AACF;MACJ,CAAA,IACalG,OAAO8iC,gBAAgB9iC,OAAOupB,UAAUwZ,iBAClDt5B,KAAKm5B,cAAc,CAAC,eAAe,eAAe,cAAc,SAAU18B,GAAAA;AACzE,eAAIA,EAAG88B,eAAe,UAAgB,OAC/B98B;AAAAA,MACP,GAAE,SAAUA,GACZ;AAAA,eAAA,CAASA,KAAOA,EAAG88B,eAAe;AAAA,MACtC,CACahjC,IAAAA,OAAOupB,UAAU0Z,oBAC3Bx5B,KAAKm5B,cAAc,CAAC,iBAAiB,iBAAiB,aAAgB,GAAA,SAAU18B,GAC/E;AAAA,eAAIA,EAAG88B,eAAe98B,EAAGg9B,uBAA6B,OAC/Ch9B;AAAAA,MACP,GAAE,SAAUA;AACZ,eAASA,CAAAA,KAAMA,EAAG88B,eAAe98B,EAAGg9B;AAAAA,MACxC;IAEE;AAAA,EACF,GAEA/iC,EAAUyiC,gBAAgB,SAASO,GAAOC,GAAUroB,GAAAA;AAGnD,QAAI0C,GAAQ4lB,GAAS5kB,GAAO6kB,GAAWC,GAAaC,GAChDC,IAAe;AAEnB,aAASC,EAAiBz/B,GAASyU,GAAM7D,GAExC1U;AAAAA,QAAUI,MAAM0D,GAASyU,GAAM,SAAS/T,GAAAA;AACvC,iBAAGxE,EAAUwjC,kBAAAA,MAGR5oB,EAAOpW,CAAX,IAAA,SACOkQ,EAASlQ,CAAAA;AAAAA,MAEpB,GAAK,EAAEi/B,YACL,CAAA;AAAA,IAAA;AAqND,aAASC,EAAYl/B,GAAAA;AAChBoW,MAAAA,EAAOpW,CACXxE,MAAAA,EAAU2jC,iBACNR,GAAAA,MACHnjC,EAAU4jC,aAAcX,EAASz+B,CACjCxE,CAAAA,GAAAA,EAAU6jC,yBAEX7jC,EAAU8I,WAAW,MACrB9I,EAAU+I,aAAW,MACrB/I,EAAU8jC,YAAU,MACpB9jC,EAAU+jC,iBAAiB,MAC3BtlB,aAAaH,CAAAA,GACb6kB,IAAYE,IAAc,IAC1BD;IACA;AAvJDG,IAAAA,EAAiB31B,SAASmJ,MAAMisB,EAAM,CAAI,GAAA,SAASx+B;AAClD,UAAIoW,CAAAA,EAAOpW,CAAX,GAAA;AAEA,YAAIw/B,IAAMf,EAASz+B,CACnB;AAAA,YAAIw/B,GAAJ;AACA,cAAIb;AAOH,mBArDF,SAAqB3+B,GACpB;AAAA,kBAAA,CAAIoW,EAAOpW,CAAAA,GAAX;AACA,oBAAIy/B,IAAMjkC,EAAU4E,SAAWu+B,EAAAA,WAC9Be,MAAWlkC,EAAUuG,UAASvG,EAAUuG,OAAOvG,EAAU0K,KAAAA,GAEtDy5B,IAAkBnkC,EAAUgW;AACtB,gBAAPiuB,KAAO,YAAYC,MAErBlkC,EAAUgW,mBAAmB,WAAA;AAM5B,2BALI/S,IAAKjD,EAAU4E,WAAWw/B,SAC1Br+B,IAAK/F,EAAUyE,SAASxB,CAAAA,GACxBwD,IAAWy9B,EAAS3gC,YAEpB4E,IAAMnI,EAAUqkC,UAAUt+B,EAAGxE,YAAYwE,EAAGvE,QAAAA,GACxC0B,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC3BiF,oBAAAA,EAAIjF,CAAAA,EAAGuD,CAAaV,KAAAA,EAAGU,OACzB0B,EAAIqJ,OAAOtO,GAAG,CACdA,GAAAA;AAGF6C,kBAAAA,EAAGu+B,UAAUn8B,EAAIhF,SAAS,GAC1B4C,EAAGw+B,SAASp8B,EAAIhF,QAEhBmG,KAAKyM,YAAY,CAAChQ,CAAAA,GAAK/F,EAAU4E,SAAWL,EAAAA,IAAAA;AAAAA,gBAEhD,IAGEvE,EAAUwkC,eAAehgC,IAEtBy/B,KAAO,YAAYC,MACrBlkC,EAAUgW,mBAAmBmuB,IAG1B3/B,EAAE28B,kBACL38B,EAAE28B,eAAAA,GACH38B,EAAEigC,eAAAA;AAAAA,cAnCoB;AAAA,YAqCtB,EASaT,CAERx/B,GAAAA,EAAE28B,kBACL38B,EAAE28B,eAAAA,GACH38B,EAAEigC,eAAAA,IACFzkC,EAAU0kC;AAOXxB,UAAAA,IAAUD,EAASz+B,CAEd6+B,GAAAA,MAGAH,KAOD5lB,EAAO5Y,UAAUw+B,EAAQx+B,UAAW0K,KAAKu1B,IAAIrnB,EAAOijB,QAAQ2C,EAAQ3C,SAAS,KAAOnxB,KAAKu1B,IAAIrnB,EAAOkjB,QAAQ0C,EAAQ1C,KAAAA,IAAS,OAChI4C,IAAAA,IACA3kB,aAAaH,CAAAA,KARb8kB;QApBe;AAAA,MAHM;AAAA,IAkCxB,CAGCG,GAAAA,EAAiBj6B,KAAKO,KAAmB,aAAE,CAAA,GAAI,eAAe65B,CAC9DH,GAAAA,EAAiBj6B,KAAKO,KAAmB,aAAE,IAAI,eAAe,SAASrF,GACtE;AAAA,UAAA,CAAIoW,EAAOpW,CAAAA;AACX,eAAI6+B,KACC7+B,KAAKA,EAAE28B,kBACV38B,EAAE28B,kBACH38B,EAAEigC,eAAAA,IACK,MAAA;AAAA,IAEV,CAAA,GAGClB,EAAiBj6B,KAAKuuB,MAAMmL,EAAM,CAAI,GAAA,SAASx+B;AAS9C,UAAIogC;AAHJ,UAJGh3B,YAAYA,SAASmJ,QACvBnJ,SAASmJ,KAAK8H,UAAU5c,IAAI,sBAGzB2Y,GAAAA,CAAAA,EAAOpW;AAQX,YAPAxE,EAAU+jC,iBAAiBv/B,EAAEqgC,WAG7B1B,IAAYC,QACZC,IAAAA,IACAuB,IAAa1B,IAAUD,EAASz+B,CAEhC,GAAA;AAMA,cAAIsF,IAAM,oBAAItH;AAEd,eAAK4gC,KAAgBD,CAAAA,KAAar5B,IAAMw5B,IAAe;AActD,mBAbAtjC,EAAU8kC,OAAOC,aAAaH,CAAAA,GAC9B/kC,OAAOoY,WAAW;AACdjY,gBAAUkiB,cAIbliB,EAAUglC,cAAcJ,CAAAA;AAAAA,YACxB,GAAE,EAECpgC,GAAAA,EAAE28B,kBACL38B,EAAE28B,eACH38B,GAAAA,EAAEigC,mBACFzkC,EAAUilC,uBACH;AAMR,cAJA3B,IAAex5B,GAAAA,CAIXs5B,KAAeD,CAAAA,KAAcnjC,EAAUM,OAAO4kC,YAAlD;AAGA,gBAAIC,IAAUnlC,EAAUolC,cAAcx3B,SAASmd,aAC3Csa,GAAAA,IAAWrlC,EAAUolC,cAAcR,EAAWlgC,MAAAA,GAC9C4gC,IAAahoB,IAAQtd,EAAUolC,cAAc9nB,EAAO5Y,MAAAA,IAAU;AAElE,gBAAGygC,KAAWE,KAAYF,KAAWE,KAAYF,KAAWG;AAS3D,qBAPG9gC,EAAE28B,kBACJ38B,EAAE28B,eAAAA,GAEH38B,EAAEigC,eAAe,IACjBzkC,EAAUulC,qBAAqB,IAC/BvlC,EAAU8kC,OAAOC,aAAaH,IAC9BtnB,IAASsnB,GAAAA;AAIVtmB,YAAAA,IAAQrG,WAAW,WAClB;AAAA,kBAAA,CAAGjY,EAAUkiB,YAAb;AAGAihB,gBAAAA,IAAY;AACZ,oBAAIz+B,IAAS4Y,EAAO5Y,QAChBoK,IAAY9O,EAAUkQ,cAAcxL,CAAAA;AACpCA,gBAAAA,KAAUoK,EAAUqB,QAAQ,UAAA,KAAgB,OAC/CzL,IAASA,EAAO02B,kBAEjBp7B,EAAUwlC,eAAeloB,GAAQ5Y,CAC7B1E,GAAAA,EAAU+I,cAAc/I,EAAU+I,cAAc,YACnD/I,EAAUylC,aAAazlC,EAAU8I,UAAU,SAASwd,GAAMpjB,GAAAA;AACzDojB,kBAAAA,EAAKrlB,MAAMkgB,UAAQ,QACnBnhB,EAAU0lC,UAAUl0B,OAAOtO,GAAG,CACnC;AAAA,gBAAA,CAAA,GAGOlD,EAAUM,OAAOqlC,aACpB3lC,EAAU4lC,iBAAAA,GAEX5lC,EAAUiW,YAAYjW,EAAU8I,QAlB/B;AAAA,cAAA;AAAA,YAmBJ,GAAI9I,EAAUM,OAAO4kC,aAEnB5nB,IAASsnB;AAAAA,UA1CD;AAAA,QA1BP;AAFAxB,UAAAA,IAAc;AAAA,IAuEjB,IAkBCG,EAAiBj6B,KAAKO,KAAmB,aAAE,CAAA,GAAIm5B,EAAM,CAAI,GAAA,SAASx+B,GAKjE;AAAA,UAJGoJ,YAAYA,SAASmJ,QACvBnJ,SAASmJ,KAAK8H,UAAUwL,OAAO,sBAAA,GAAA,CAG5BzP,EAAOpW,CAgBX;AAAA,eAdGxE,EAAUM,OAAOulC,qBACd1C,CAAAA,KA5OP,SAA+B2C,GAAMC,GAAMC,GAAMC,GAChD;AAAA,cAAA,CAAKH,MAASC;AAAM,mBAAA;AAGpB,mBADIxzB,IAAIuzB,EAAKphC,QACP6N,KAAKA,KAAKvS,EAAU63B;AACzBtlB,YAAAA,IAAIA,EAAEhH;AAQP,cANGgH,KAAKvS,EAAU63B,QAMf73B,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU4E,SAAAA,EAAWL,IAC7CvE,KAAAA,EAAUuG,OAAOvG,EAAU4E,WAAWL,IACzC2hC,EAAAA;AACX;AAIF,cAAIpQ,IAAK1mB,KAAKu1B,IAAImB,EAAKtF,QAAQuF,EAAKvF,KAAAA,GAChC2F,IAAK/2B,KAAKu1B,IAAImB,EAAKvF,QAAQwF,EAAKxF;AACpC,iBAAIzK,IAAKmQ,KAAUE,IAAGH,MAAUlQ,CAAAA,KAAOqQ,IAAGrQ,IAAK,OAC1CgQ,EAAKvF,QAAQwF,EAAKxF,QACrBvgC,EAAU8kC,OAAOsB,oBAEjBpmC,IAAAA,EAAU8kC,OAAOuB,oBAAAA,GAAAA;AAAAA,QAKnB,EA6MyC/oB,GAAQ4lB,GAAS,KAAK,SAC7DljC,EAAUilC,mBAAAA,KAIR9B,MACHnjC,EAAUulC,qBAAAA,IACVttB,WAAW,WAAA;AACVjY,YAAUulC,qBAAqB;AAAA,QAC/B,GAAE,GAGJ7B,IAAAA,EAAYl/B,IACRxE,EAAUilC,oBACbjlC,EAAUilC,mBAAmB,IACzBzgC,EAAE28B,kBACL38B,EAAE28B,kBACH38B,EAAEigC,eAAAA,IACK,MAAA;AAAA,IAEV,CAAA,GAECzkC,EAAUI,MAAMwN,SAASmJ,MAAMisB,EAAM,CAAA,GAAIU;EAC1C,GAEA1jC,EAAU4lC,mBAAmB,WAAA;AAC5B5lC,MAAU2jC,iBAAAA;AAEV,QAAI2C,IAAStmC,EAAUumC,cAAc34B,SAASC,cAAc;AAC5Dy4B,IAAAA,EAAOx3B,YAAU,kBAEjB9O,EAAU0kC,mBAAmB,CAAA,GAE7B92B,SAASmJ,KAAKhJ,YAAYu4B;EAC3B,GACAtmC,EAAU0kC,qBAAqB,SAASzW,GAAAA;AACvC,QAAIqY,IAAStmC,EAAUumC;AACvB,QAAID,GAAO;AACV,UAAInN,IAAO;AACX,UAAIn5B,EAAU8I,YAAAA,CAAamlB,GAAK;AAC/B,YAAIloB,IAAK/F,EAAUyE,SAASzE,EAAU8I;AAClC/C,QAAAA,MACHozB,IAAO,WAAWpzB,EAAG4C,SAAS3I,EAAUya,UAAUqiB,aAAa/2B,EAAGxE,YAAYwE,EAAGvE,UAAUuE,KAAI/F,EAAUya,UAAU+rB,SAASzgC,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAO,KAAA;AAAA,MAChK;AAE2B,MAAxB/F,EAAU+I,cAAc,YAAY/I,EAAU+I,cAAc,aAC/Du9B,EAAOx4B,aAAa9N,EAAU0tB,OAAOwN,OAAOuL,kBAAkB,oBAAkBtN,IAEhFmN,EAAOx4B,aAAa9N,EAAU0tB,OAAOwN,OAAOwL,gBAAgB,kBAAgBvN;AAAAA,IAC7E;AAAA,EACF,GACAn5B,EAAU2jC,mBAAmB,WAC5B;AAAA,QAAI2C,IAAStmC,EAAUumC;AACnBD,IAAAA,KAAUA,EAAO/6B,eACpB+6B,EAAO/6B,WAAWC,YAAY86B,CAAAA,GAC9BtmC,EAAUumC,cAAc;AAAA,EAE1B;AAGA;ACrXe,SAAS5nB,GAAO3e,GAuF/B;AAAA,MAAI2mC,GA+BAC;AACJ,WAASC,IAAAA;AACR,QAAG7mC,EAAU8mC,kBAAAA;AACZ;AAEA,QAAGF,MAAH;AAuBC,aAAOA;AAtBP,QAAIG,IAAQn5B,SAASC,cAAc,KACnCk5B;AAAAA,IAAAA,EAAM9lC,MAAM8J,WAAW,YACvBg8B,EAAM9lC,MAAME,OAAO,WACnB4lC,EAAM9lC,MAAMC,MAAM,WAClB6lC,EAAMj5B,YAAY,+HAMlBF,SAASmJ,KAAKhJ,YAAYg5B,CAC1B;AAAA,QACIC,IADSnnC,OAAO6iB,iBAAiBqkB,EAAMrmB,cAAc,WAClCiC,CAAAA,EAAAA,iBAAiB;AACxC/U,aAASmJ,KAAKvL,YAAYu7B,CAC1BH,IAAAA,IAA0BI,MAAc,iBAGvC/uB,WAAW,WAAA;AACV2uB,MAAAA;IACA,GAAE;EAMP;AAEA,WAASK;AACR,QAAGjnC,CAAAA,EAAU8mC,wBAAuB9mC,EAAUknC,mBAAAA,GAA9C;AAIA,UAAIC,IAAaP;AACjBA,MAAAA,IAAuBQ,QACvBT,YAKGQ,MAJcN,EAIe7mC,KAAAA,EAAU8C,cAAc9C,EAAU4E,WAAWL,QAC5EvE,EAAU6V;IAVV;AAAA,EAYF;AAyBA,WAASwxB,EAAkBrlC,GAAAA;AAC1B,QAAIsN,IAAMtN,EAAKyJ,WAAAA;AAIf,WAHA6D,IAAMA,IAAM,KAAK,MAAIA,IAAMA,GAChB,+BAA8BtN,EAAKmI,SAAnC,IAAA,4CAC0BmF,IAAK;AAAA,EAE3C;AAlMAtP,IAAUsnC,iBAAiB;AAC1B15B,aAAS8T,gBAAgB3C,aAAa,wBAAwB/e,EAAUunC,IACzE;AAAA,EAAA,GAEAvnC,EAAUwnC,iBAAiB,EAC1BxoB,kBAAkB,CAAC,GAAE,CACrByoB,GAAAA,uBAAuB,CAAC,GAAE,CAAA,GAC1BtM,WAAW,CAAC,GAAE,CAAA,GAEd3rB,cAAc,CAAC,IAAG,KAClBk4B,uBAAuB,CAAC,WAAW,QACnCC,GAAAA,4BAA4B,CAAC,WAAW,QAGzC3nC,EAAAA,GAAAA,EAAU4nC,WAAW,EACpBC,4BAA4B,CAAC,IAAG,EAAA,GAChC7mB,YAAY,CAAC,IAAG,EAChB8mB,GAAAA,YAAY,CAAC,IAAG,OAOjB9nC,EAAU8mC,oBAAoB;AAC7B,WAAI9mC,EAAUunC,QAGJvnC,EAAUunC,OAAO,IAAIp3B,QAAQ,UAAA,IAAA,KAyDxC,WACC;AAAA,UAAGw2B,MAAH,QAAoC;AACnC,YAAII,IAAQn5B,SAASC,cAAc,KAAA;AACnCk5B,QAAAA,EAAM9lC,MAAM8J,WAAW,YACvBg8B,EAAM9lC,MAAME,OAAO,WACnB4lC,EAAM9lC,MAAMC,MAAM,WAClB6lC,EAAMj5B,YAAY,qFAIlBF,SAASmJ,KAAKhJ,YAAYg5B;AAC1B,YACIh8B,IADSlL,OAAO6iB,iBAAiBqkB,EAAMrmB,cAAc,4BAAA,CAAA,EACnCiC,iBAAiB,UAAA;AAGtCgkB,QAAAA,IAFE57B,MAAa,YAOhBkN,WAAW,WACV0uB;AAAAA,UAAAA,IAAqB,MAClBI,KAASA,EAAMx7B,cACjBw7B,EAAMx7B,WAAWC,YAAYu7B;QAE9B,GAAE,GAAA;AAAA,MACH;AACD,aAAOJ;AAAAA,IACR,EAnFA;AAAA,EAAA,GAYA3mC,EAAU+nC,mBAAmB,WA2J7B;AAAA,KAAA,WAAA;AACC,YAAMvhC,IAAYxG,EAAU8C;AAE5BklC,oBAAcC,CAAAA,GACXzhC,MACFyhC,IAAoBC,YAAY,MAC/B;AAAA,cAAMC,IAAWzlB,iBAAiBlc,GAAWmc,iBAAiB,uBAAA;AAC3DwlB,QAAAA,KAAYA,MAAanoC,EAAUunC,QACrCvnC,EAAUooC,QAAQD,CAClB;AAAA,MAAA,GAEC,GAEL;AAAA,IAAA;AAtKC,UAAME,IAAS3lB,iBAAiBpZ,KAAKxG,UAAAA,GAC/BwlC,IAAWD,EAAO1lB,iBAAiB;AAEzC,QACI4lB,GADAC,MAAkBF,GAElBG,IAAY,CAAA,GACZC,IAAAA;AAEJ,QAAGF,GAAc;AAChBD,MAAAA,IAAYD;AACZ,eAAQplC,KAAKlD,EAAU+gB;AACtB0nB,QAAAA,EAAUvlC,CAAAA,IAAKmlC,EAAO1lB,iBAAiB,sBAAsBzf,CAG9DulC,EAAAA;AAAAA,MAAAA,EAAUj5B,eAAe64B,EAAO1lB,iBAAiB,qCACjD8lB,GAAAA,EAAUtN,YAAYkN,EAAO1lB,iBAAiB;IAEhD;AACE4lB,MAAAA,IA9BF,WAEC;AAAA,iBADII,IAAQ/6B,SAASkrB,qBAAqB,MAAA,GACjC51B,IAAI,GAAGA,IAAIylC,EAAMxlC,QAAQD,KAAK;AACtC,cAAIkE,IAAMuhC,EAAMzlC,GAAG0lC,KAAKtb,MAAM;AAC9B,cAAIlmB;AACH,mBAAOA,EAAI,CAAA;AAAA,QAEZ;AAAA,MACF,EAuBEshC,GAAAA,IAAmB1oC,EAAU8mC,kBAW9B;AAAA,QAPA9mC,EAAU6oC,cAAc,EACvBC,OAAOP,GACPQ,aAAaP,GACbE,kBAAkBA,GAClBM,QAAQP,KAGNzoC,EAAU6oC,YAAYE,aAAY;AACpC,YAAME,IAAiB3/B,KAAKu/B,YAAYG;AACxC,eAAQ9lC,KAAKlD,EAAU+gB;AAClBuG,cAAMsB,SAASqgB,EAAe/lC,CAAAA,CAAAA,CAAAA,MACjClD,EAAU+gB,GAAG7d,CAAAA,IAAK0lB,SAASqgB,EAAe/lC,CAG5C,CAAA;AAAA,IAAA;AAAA,EACF,GAkFAlD,EAAUI,MAAMP,QAAQ,oBAAoBonC,CAAAA,GAC5CjnC,EAAUI,MAAMP,QAAQ,QAAQonC,CAAAA,GAEhCjnC,EAAUknC,qBAAqB;AAC9B,WAAOL,EAAAA;AAAAA,EACR,GAEA7mC,EAAUkpC,aAAa,SAASC,GAAKv5B,GAAM23B,GAC1C;AAAA,aAASl0B,KAAOzD;MACJu5B,EAAI91B,kBACd81B,EAAI91B,CAAAA,IAAOzD,EAAKyD,CAAKk0B,EAAAA,CAAAA;AAAAA,EACxB,GAEAvnC,EAAUooC,UAAU,SAAS5vB;AAC5BlP,SAAKi+B,OAAO/uB,GACZxY,EAAUsnC,eAAAA,GACPtnC,EAAU8C,eACZwG,KAAK8/B,WACL9/B,GAAAA,KAAKsM,OAIP;AAAA,EAAA;AAUA,MAAIqyB,IAAoB;AAexBjoC,IAAUsE,YAAY,aAAa;AAClC0jC,kBAAcC,CAAAA;AAAAA,EACf,CAEAjoC,GAAAA,EAAUopC,aAAa,WAAA;AACtB9/B,SAAKy+B,iBAEAz+B,GAAAA,KAAKi+B,SACTj+B,KAAKi+B,OAAOj+B,KAAKu/B,YAAYC,QAE9B9oC,EAAUsnC,eAAAA,GACNtnC,EAAUunC,SAAS,SAEtBvnC,EAAUya,UAAU4uB,aAAahC,IACxBrnC,EAAUya,UAAU4uB,eAAehC,MAC5CrnC,EAAUya,UAAU4uB,aAAarpC,EAAUgC,KAAK0tB,YAAY1vB,EAAUM,OAAOgpC,SAM9EtpC,IAAAA,EAAUsE,YAAY,oBAAoB,WAAA;AAEzC,UAAIorB,IAAc1vB,EAAUgC,KAAK0tB,YAAY,IAAA;AACzC1vB,QAAUya,UAAU8uB,mBACvBvpC,EAAUya,UAAU8uB,iBAAiBvpC,EAAUya,UAAU+uB;AAE1D,UAAIC,IAAgBzpC,EAAUya,UAAU8uB;AAiBxC,MAhBAvpC,EAAUya,UAAU+uB,YAAY,SAASxnC,GACxC;AAAA,YAAIsH,KAAKoB,SAAS,SAAS;AAC1B,cAAIspB,IAAQtE,EAAY1tB,CAAAA;AAOxB,iBANIA,EAAK6F,QACRmsB,KADqB,MACrBA,IAAQh0B,EAAU0tB,OAAO1rB,KAAKmsB,WAAWnsB,EAAKmb,cAAc,MAAM6W,IAAAA,CAE9DhyB,MAAShC,EAAUgC,KAAKwF,UAAU8B,KAAKS,aAC3CiqB,CAAAA,MAAAA,IAAQh0B,EAAU0tB,OAAOwN,OAAOwO,uBAAuB,MAAM1V,IAEvDA;AAAAA,QACX;AACI,eAAOyV,EAAcl1B,KAAKjL,MAAMtH,CAAAA;AAAAA,MAEpC,GAGKhC,EAAUM,OAAO0e,qBACNhf,EAAU6J,KAAsB,gBAAE,CAAA,EAAG9G,iBAAiB,YAAA,EAC9DqB,QAASulC,CAAAA,MAAAA;AAGb,gBAFaA,EAAIxlC,aAAa,eAAewlC,EAAIxlC,aAAa;UAG7D,KAAK;AAAA,UACL,KAAK;AACJwlC,YAAAA,EAAI9qB,UAAU5c,IAAI,mBAClB0nC,GAAAA,EAAI9qB,UAAU5c,IAAI,uBAAA;AAClB;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AACJ0nC,YAAAA,EAAI9qB,UAAU5c,IAAI,uBAClB;AAAA;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AACJ0nC,YAAAA,EAAI9qB,UAAU5c,IAAI,kBAAA,GAClB0nC,EAAI9qB,UAAU5c,IAAI,uBAClB;AAAA;AAAA,UACD;AACC0nC,YAAAA,EAAI9qB,UAAU5c,IAAI,wBAEnB;AAAA,QAAA;AAAA,MAAA,CAAA,GAQJ,SAAqBuE,GAAAA;AAGpB,YAAGxG,EAAUM,OAAO+3B;AACnB;AAGD,cAAMuR,IAAO/9B,MAAMgmB,KAAKrrB,EAAUzD,iBAAiB,cAK7C8mC,CAAAA,GAAAA,IAFQ,CAAC,OAAO,QAAQ,OAEJhmC,EAAAA,IAAIimC,CAAAA,MAC7BF,EAAKG,KAAKJ,CAAAA,MAAOA,EAAIxlC,aAAa,UAAgB2lC,MAAAA,CAAAA,CAAAA,EACjDzwB,OAAOswB,CAAAA,MAAOA,MAAPA,MAET;AAAA,YAAIK,IAAWJ,EAAKzmC,SAAS,IAAIymC,EAAK,CAAA,IAAK;AAE3CC,QAAAA,EAAYI,QAAU7lC,EAAAA,QAAQulC,CAAAA;AAC7BnjC,UAAAA,EAAU4jB,aAAauf,GAAKK,CAC5BA,GAAAA,IAAWL;AAAAA,QAAG,CAEf;AAAA,MAAA,EA3Ba3pC,EAAU6J,KAAsB,gBAAE;IAGjD,GAAI,EAACoS,MAAM,GAAA,CAAA;AAAA,EA8BX;AAIA;ACjUe,SAASiuB,GAAoBlqC,GAAWmqC,GACtD7gC;AAAAA,OAAK8gC,aAAapqC,GAClBsJ,KAAK+gC,MAAMF,GACX7gC,KAAKghC,yBAAyB,CAE9BhhC,GAAAA,KAAKkc,SAAS,WACb;AAAA,QAAI2kB,IAAK7gC,KAAK+gC,KACVrqC,IAAYsJ,KAAK8gC;AAErB9gC,SAAKghC,uBAAuB3nC,KAAK3C,EAAUsE,YAAY,gBAAgB,SAASrB;OAC1EqG,KAAKgtB,YAAYhtB,KAAKihC,SAAStnC,CAAAA,KACpCknC,EAAGK,WAAWvnC,GAAAA,IAAQ,UAAA;AAAA,IACtB,CAEDqG,CAAAA,GAAAA,KAAKghC,uBAAuB3nC,KAAK3C,EAAUsE,YAAY,gCAAgC,SAASrB;AAC/F,UAAKqG,KAAKihC,SAAStnC,CAAAA,GAAnB;AACA,YAAIwnC,IAAEN,EAAGvlC,SAAS3B;AAElB,eAAIwnC,KAAG,cAAcnhC,KAAKmS,cAAc0uB,EAAGK,WAAWvnC,GAAG,EAAA,GAAA,MACrDwnC,KAAG,cACHA,KAAG,mBAEPN,EAAGK,WAAWvnC,GAAG,IAAK,SACf,GAAA;AAAA,MARwB;AAAA,IAS/B,CAAA,CAAA,GAEDqG,KAAKghC,uBAAuB3nC,KAAK3C,EAAUsE,YAAY,kBAAkB,SAASrB,GAC5EqG;AAAAA,OAAAA,KAAKgtB,YAAYhtB,KAAKihC,SAAStnC,CAAAA,KACpCknC,EAAGK,WAAWvnC,GAAAA,IAAQ,SACtB;AAAA,IAAA,CAAA,CAAA,GAEDqG,KAAKghC,uBAAuB3nC,KAAK3C,EAAUsE,YAAY,cAAc,WAAA;AAEpE6lC,MAAAA,EAAGnuB,eAAa,IAChBmuB,EAAGO,WAAS,IACZP,EAAGQ,cAAc,CAAA,GACjBR,EAAGS,YAAY;AAAA,IACf,CAEDT,CAAAA,GAAAA,EAAG7lC,YAAY,kBAAkBtE,EAAU6qC,mBAC3CV,EAAG7lC,YAAY,kBAAkBtE,EAAU6qC,gBAC3CV,GAAAA,EAAG7lC,YAAY,kBAAkB,SAASwmC,GAAK7nC,GAC1CjD;AAAAA,MAAAA,EAAUyE,SAASxB,CACtBjD,KAAAA,EAAU+qC,YAAY9nC,GAAIqG,KAAK0hC,cAAc,iBAC7ChrC,EAAUub,YAAYtY,MACZjD,EAAUirC,mBACpBjrC,EAAU6qC,iBAAiBC,GAAK7nC,CACpC;AAAA,IAAA,CAAA;AAAA,EACA,GAECqG,KAAKoc,SAAS,WACb;AAAA,aAASrS,KAAO/J,KAAKghC,wBAAwB;AAC5C,UAAI5wB,IAAUpQ,KAAKghC,uBAAuBj3B,CAAAA;AAC1C/J,WAAK8gC,WAAWvlB,YAAYnL;IAC5B;AACDpQ,SAAKghC,yBAAyB,CAChC;AAAA,EAAA;AACA;AC/CO,SAASY,GAAcC,GAAAA;AA+B7B,SA9BA7hC,KAAK8hC,kBAAkBD,GACvB7hC,KAAK0hC,eAAe,wBAEpB1hC,KAAKmU,SAAS,MACdnU,KAAKqhC,cAAc,CAAA,GAEnBrhC,KAAK+hC,aAAa,IAClB/hC,KAAK8L,aAAa,QAClB9L,KAAKgiC,SAAS,OACdhiC,KAAKiiC,WAAW,MAChBjiC,KAAKkiC,WAAW,MAChBliC,KAAKmiC,aAAa,KAElBniC,KAAKshC,YAAY,GACjBthC,KAAK0S,eAAe,IACpB1S,KAAKohC,WAAW,IAChBphC,KAAKoiC,WAAW,IAEhBpiC,KAAK++B,SAAS,EACbsD,SAAS,qBACTC,UAAU,qBACVC,SAAS,mCACTC,SAAS,4BACTC,cAAc,gCACdn3B,OAAO,cACP4P,OAAO,2CAAA,GAERlb,KAAK0iC,kBAAAA,KACLC,GAAU3iC,IAAAA,GAEHA;AACR;ACtCe,SAAQyS,GAAC/b,GAEvB;AAAA,MAAIksC,IAAe,eAEfC,IAAe;AAEnB,WAASz3B,EAASpU,GAAQ+X,GAAQjY,GACjC;AAAA,QAAIgsC,IAAW9rC,EAAOoU;AAClB03B,IAAAA,KACHA,EAAS/zB,GAAQjY,CAAAA,GAElBisC,EAAS1iC,KAAKrJ,EAAO2oB,MACrBkjB,IAAe7rC,EAAO2oB,MAAM;AAAA,EAC5B;AAED,WAASqjB,EAAUlsC,GAClB;AAAA,QAAI+rC,GAAc;AAEjB,UAAItwB,IAAOzb,EAAMmsC,SAASnsC,EAAM++B,SAC5BgC,IAAAA;AAEJ,UAAIqL,EAAWC,UAAU;AACxB,YAAI5wB,KAAQ,MAAMA,KAAQ,IAAI;AAG7B,cAAInX,IAAStE,EAAMsE,UAAUtE,EAAMwmB;AAC/B8lB,UAAAA,GAAWrmB,aAAa3hB,CAAAA,EAAQyL,QAAQ,wBAA6B,IAAA,MAAKzL,EAAO2a,QACpF3a,EAAO2a,WAEP3K,EAASy3B,GAAAA,KACThL,IAAiB;AAAA,QAElB;AAEW,QAARtlB,KAAQ,OACXnH,EAASy3B,GAAc,EAAA,GACvBhL,IAAiB;AAAA,MAElB;AAED,aAAIA,KACC/gC,EAAM+gC,kBACT/gC,EAAM+gC,eAEE/gC,GAAAA,EAAAA,EAAMqkC,sBAEhB;AAAA,IACA;AAAA,EACD;AAID,WAASkI,EAASpoC;AACZooC,IAAAA,EAASC,UACbD,EAASC,QAAQh/B,SAASC,cAAc,KAExC7N,GAAAA,EAAUI,MAAMusC,EAASC,OAAO,WAAWN,IAC3CK,EAASC,MAAM99B,YAAY,mBAC3BlB,SAASmJ,KAAKhJ,YAAY4+B,EAASC,KAGpCD,IAAAA,EAASC,MAAM3rC,MAAMkgB,UAAU5c,IAAO,iBAAiB;AAAA,EACvD;AAED,WAASsjB,EAAOrL,GAAMqwB,GAAYx0B,GACjC;AAAA,QAAIy0B,IAAkB9sC,EAAU66B,SAASkS,wBAAwBvwB,CAAAA,GAC7DjE,KAAQs0B,KAAc,IAAI7oB,cAAcnM,QAAQ,MAAM,GAE1D;AAAA,WAAO,QAAQi1B,CAAAA,sDADC,aAAav0B,CAAsBA,kBAAAA,CAAAA,SAAAA,kBAC4DF,cAAmBA,CAAiBmE,WAAAA,CAAAA;AAAAA,EACnJ;AAyCD,WAASwwB,IAAAA;AAGR,aAFIhE,IAAS,CAAA,EAAGj9B,MAAMG,MAAMmG,WAAW,CAAC,CAE/BnP,CAAAA,GAAAA,IAAI,GAAGA,IAAI8lC,EAAO7lC,QAAQD;AAClC,UAAI8lC,EAAO9lC,CACV;AAAA,eAAO8lC,EAAO9lC,CAIhB;AAAA,EAAA;AAqED,WAAS+pC,EAAW3sC,GAAQ2+B,GAAIiO,GAAAA;AAC/B,QAAIjkB,IAAM3oB,EAAOorB,UAAUprB,IApE5B,SAAuBA,GAAQ2+B,GAAIiO;AAClC,UAAIjkB,IAAMrb,SAASC,cAAc,KAE7Bs/B,GAAAA,IAAY/vB,GAAM/Q,IACtBrM;AAAAA,QAAU66B,SAASuS,iBAAiBnkB,GAAKkkB,IAGzClkB,EAAIna,YAAY,qDAAqDxO,EAAOuF,OAAO,aAAavF,EAAOuF,MACvGojB,EAAIlK,aAAamtB,GAAc,CAAA;AAE/B,UAAImB,IAAQ;AAcZ,UAZI/sC,EAAO0O,UACVia,EAAIhoB,MAAM+N,QAAQ1O,EAAO0O,QACtB1O,EAAOyO,WACVka,EAAIhoB,MAAM8N,SAASzO,EAAOyO,SACvBzO,EAAOu+B,UACVwO,KAAS,2DAA2D/sC,EAAOu+B,QAAQ,WACpFwO,KAAS,6DAA6DF,IAAY,cAAc7sC,EAAOgtC,UAAU,KAAKhtC,EAAOkc,QAAQ,8EACjIyiB,MACHoO,KAASxlB,EAAOmlB,EAAgB1sC,EAAO2+B,IAAIj/B,EAAU0tB,OAAOwN,OAAOqS,YAAY,IAAA,GAAO,QACnFL,IAAAA,MACHG,KAASxlB,EAAOmlB,EAAgB1sC,EAAO4sC,QAAQltC,EAAU0tB,OAAOwN,OAAOsS,gBAAgB,QAAA,GAAW,YAE/FltC,IAAAA,EAAOwgC;AACV,iBAAS59B,IAAI,GAAGA,IAAI5C,EAAOwgC,QAAQ39B,QAAQD,KAAK;AAC/C,cAAIuqC,IAAMntC,EAAOwgC,QAAQ59B,CAAAA;AAMxBmqC,UAAAA,KALUI,OAAAA,KAAO,WAKR5lB,EAHG4lB,EAAIzZ,OACNyZ,EAAIhsC,OAAQ,eAAegsC,EAAIzZ,MAAMhQ,YAAgB,IAAA,oBAAoBypB,EAAIzZ,MAAMhQ,YAAAA,IAAgB,WACjGypB,EAAIj1B,SAAStV,CAAAA,IAGhB2kB,EAAO4lB,GAAKA,GAAKvqC;QAE3B;AAMF,UAHAmqC,KAAS,UACTpkB,EAAInb,YAAYu/B,GAEZ/sC,EAAOgtC,SAAS;AACnB,YAAIhnB,IAAOhmB,EAAOgtC;AACC,QAAA,OAARhnB,KAAQ,aAClBA,IAAO1Y,SAAS8/B,eAAepnB,CAAAA,IAC5BA,EAAKrlB,MAAMkgB,WAAW,WACzBmF,EAAKrlB,MAAMkgB,UAAU,KACtB8H,EAAIjZ,WAAW1P,EAAOu+B,QAAQ,IAAI,CAAG9wB,EAAAA,YAAYuY;MACjD;AAeD,aAbAtmB,EAAUI,MAAM6oB,GAAK,SAAS,SAAU7oB,GAAAA;AACvC,YAAIkd,IAASld,EAAMsE,UAAUtE,EAAMwmB;AAEnC,YADKtJ,EAAOxO,cAAWwO,IAASA,EAAO/R,aACnCmhC,GAAW/nC,QAAQ2Y,GAAQ,yBAAA,GAA4B;AAC1D,cAAIjF,IAASiF,EAAOnZ,aAAa,aAAA;AAEjCuQ,UAAAA,EAASpU,GADT+X,IAAUA,KAAU,UAAYA,KAAU,WAAkBA,GACnCjY,CACzB;AAAA,QAAA;AAAA,MACJ,IACEE,EAAO2oB,MAAMA,IACTgW,KAAMiO,OACTf,IAAe7rC,IAET2oB;AAAAA,IACP,EAGkD3oB,GAAQ2+B,GAAIiO;AAEzD5sC,IAAAA,EAAOqtC,UACXhB,IACD/+B,GAAAA,SAASmJ,KAAKhJ,YAAYkb,CAC1B;AAAA,QAAIqC,IAAIlc,KAAKu1B,IAAIv1B,KAAK+D,QAAQtT,OAAO4hB,cAAc7T,SAAS8T,gBAAgB6B,eAAe0F,EAAI1F,eAAe,CAAA,CAAA,GAC1G8H,IAAIjc,KAAKu1B,IAAIv1B,KAAK+D,QAAQtT,OAAOgiB,eAAejU,SAAS8T,gBAAgB2B,gBAAgB4F,EAAI5F,gBAAgB,CAAA,CAAA;AAejH,WAdI/iB,EAAOyK,YAAY,QACtBke,EAAIhoB,MAAMC,MAAM,SAEhB+nB,EAAIhoB,MAAMC,MAAMmqB,IAAI,MACrBpC,EAAIhoB,MAAME,OAAOmqB,IAAI,MAErBtrB,EAAUI,MAAM6oB,GAAK,WAAWqjB,CAEhCD,GAAAA,EAAShT,MAAMpQ,CAAAA,GAEX3oB,EAAOqtC,UACVtB,EAAS1iC,KAAKsf,CAEfjpB,GAAAA,EAAUmJ,UAAU,kBAAkB,CAAC8f,CAChCA,CAAAA,GAAAA;AAAAA,EACP;AAED,WAAS2kB,EAAWttC,GACnB;AAAA,WAAO2sC,EAAW3sC,GAAQ,IAAA;EAC1B;AAED,WAASutC,EAAavtC,GAAAA;AACrB,WAAO2sC,EAAW3sC,OAAc,EAAA;AAAA,EAChC;AAED,WAASwtC,EAASxtC;AACjB,WAAO2sC,EAAW3sC,CAClB;AAAA,EAAA;AAED,WAASytC,EAAWvxB,GAAM3W,GAAM6O,GAAAA;AAQ/B,WAPW8H,OAAAA,KAAQ,oBACP3W,KAAQ,eAClB6O,IAAW7O,GACXA,IAAO,KAER2W,IAAO,EAACA,MAAMA,GAAM3W,MAAMA,GAAM6O,UAAUA,MAEpC8H;AAAAA,EACP;AAED,WAASwxB,EAAOxxB,GAAM3W,GAAM4W,GAAQxZ,GAAIyR,GAAAA;AAKvC,WAJW8H,OAAAA,KAAQ,aAClBA,IAAO,EAACA,MAAMA,GAAM3W,MAAMA,GAAM4W,QAAQA,GAAQxZ,IAAIA,GAAIyR,UAAUA,EACnE8H,IAAAA,EAAKvZ,KAAKuZ,EAAKvZ,MAAMma,GAAM/Q,IAAAA,GAC3BmQ,EAAKC,SAASD,EAAKC,UAAU+vB,EAAW/vB,QACjCD;AAAAA,EACP;AAhMDxc,IAAUI,MAAMwN,UAAU,WAAW0+B,GAAAA,EAkMrC;AAAA,MAUID,IAAW,WACd;AAAA,QAAI7vB,IAAOuxB,EAAW7hC,MAAM5C,MAAM+I,SAElC;AAAA,WADAmK,EAAK3W,OAAO2W,EAAK3W,QAAQ,SAClBioC,EAAStxB;EAClB;AACC6vB,IAAS1iC,OAAO,SAAU2c,GAAAA;AACzB,WAAOA,KAAQA,EAAKniB,gBAAAA,CAAiBmiB,EAAKniB,aAAa+nC,CAAAA;AACtD5lB,MAAAA,IAAOA,EAAK/a;AACT+a,IAAAA,MACHA,EAAK/a,WAAWC,YAAY8a,CAAAA,GAC5BqmB,EAAS,EAAA,GAET3sC,EAAUmJ,UAAU,uBAAuB,CAACmd,CAE/C,CAAA;AAAA,EAAA,GAEC+lB,EAAShT,QAAQ,SAAU/S,GAC1BrO;AAAAA,eAAW,WACV;AAAA,UAAIg2B,IAAYvB,GAAWliB,kBAAkBlE;AACzC2nB,MAAAA,EAAU9qC,UACT8qC,EAAU,CAAG5U,EAAAA,SAAO4U,EAAU,CAAA,EAAG5U,MAEtC;AAAA,IAAA,GAAE;EACL;AAEC,MAAImT,IAAa,SAAUhwB,GAAM3W,GAAM4W,GAAQxZ,GAAAA;AAK9C,aAJAuZ,IAAOwxB,EAAO9hC,MAAM5C,MAAM+I,SACrBxM,GAAAA,OAAO2W,EAAK3W,QAAQ,QAEX2W,EAAK3W,KAAKlC,MAAM,GAAK,EAAA,CAAA,GAAA;AAAA,MAElC,KAAK;AACJ,eAAOiqC,EAAWpxB,CAAAA;AAAAA,MACnB,KAAK;AACJ,eAAOqxB,EAAarxB,CACrB;AAAA,MAAA,KAAK;AACJ,eAAOsxB,EAAStxB,CAAAA;AAAAA,MACjB;AACC,eA7NH,SAAcA;AACRgwB,UAAAA,EAAWx+B,SACfw+B,EAAWx+B,OAAOJ,SAASC,cAAc,KAAA,GACzC2+B,EAAWx+B,KAAKc,YAAY,8CAC5B09B,EAAWx+B,KAAK/M,MAAMurC,EAAWzhC,YAAY,OAC7C6C,SAASmJ,KAAKhJ,YAAYy+B,EAAWx+B,IAAAA,IAGtCw+B,EAAW7iC,KAAK6S,EAAKvZ;AACrB,cAAI8Y,IAAUnO,SAASC,cAAc,KAAA;AA2BrC,iBA1BAkO,EAAQjO,YAAY,UAAU0O,EAAKA,OAAO,UAC1CT,EAAQjN,YAAY,0CAA0C0N,EAAK3W,OAAO,aAAa2W,EAAK3W,MAC5F7F,EAAUI,MAAM2b,GAAS,SAAQ,SAAUvX;AAC9BgY,YAAAA,EAAK9H,YACJ8H,EAAK9H,SAASH,KAAKjL,MAAM9E,CAAAA,GAEtCgoC,EAAW7iC,KAAK6S,EAAKvZ,EACrBuZ,GAAAA,IAAO;AAAA,UACV,CAEExc,GAAAA,EAAU66B,SAASqT,gBAAgBnyB,CAAAA,GAE/BywB,EAAWzhC,YAAY,YAAYyhC,EAAWx+B,KAAKiC,aACtDu8B,EAAWx+B,KAAKoc,aAAarO,GAASywB,EAAWx+B,KAAKiC,UAAAA,IAEtDu8B,EAAWx+B,KAAKD,YAAYgO,CAAAA,GAEzBS,EAAKC,SAAS,MACjB+vB,EAAW2B,OAAO3xB,EAAKvZ,MAAMpD,OAAOoY,WAAW,WAE1Cu0B;AAAAA,YAAAA,KAAYA,EAAW7iC,KAAK6S,EAAKvZ,EACzC;AAAA,UAAA,GAAMuZ,EAAKC,MAET+vB,IAAAA,EAAW4B,KAAK5xB,EAAKvZ,EAAAA,IAAM8Y,GAC3BA,IAAU,MAEHS,EAAKvZ;AAAAA,QACZ,EAwLcuZ,CAEhB;AAAA,IAAA;AAAA,EAAA;AAECgwB,EAAAA,EAAW6B,QAAO,oBAAK7rC,QAAQC,QAAAA,GAC/B+pC,EAAWngC,MAAM+Q,GAAM/Q,KACvBmgC,EAAW/vB,SAAS,KACpB+vB,EAAWC,eACXD,EAAWzhC,WAAW,OACtByhC,EAAW4B,OAAO,IAClB5B,EAAW2B,SAAS,IAEpB3B,EAAW8B,UAAU,WAAA;AACpB,aAASj7B,KAAOm5B,EAAW4B;AAC1B5B,MAAAA,EAAW7iC,KAAK0J;EACnB,GACCm5B,EAAW7iC,OAAO,SAAU1G,GAAAA;AAC3B,QAAIP,IAAM8pC,EAAW4B,KAAKnrC;AACtBP,IAAAA,KAAOA,EAAI6I,eACd1L,OAAOoY,WAAW;AACjBvV,MAAAA,EAAI6I,WAAWC,YAAY9I,CAAAA,GAC3BA,IAAM;AAAA,IACN,GAAE,GACHA,GAAAA,EAAIoM,aAAa,WAEb09B,EAAW2B,OAAOlrC,CACrBpD,KAAAA,OAAO4e,aAAa+tB,EAAW2B,OAAOlrC,CAAAA,CAAAA,GAAAA,OAChCupC,EAAW4B,KAAKnrC,CAAAA;AAAAA,EAE1B;AAEC,MAAIsrC,IAAS;AA+Bb,SA9BAvuC,EAAUsE,YAAY,kBAAkB,SAAS2kB,GAAAA;AAChDslB,IAAAA,EAAO5rC,KAAKsmB,CAAAA;AAAAA,EACd,IACCjpB,EAAUsE,YAAY,uBAAuB,SAAS2kB,GAAAA;AACrD,aAAQ/lB,IAAI,GAAGA,IAAIqrC,EAAOprC,QAAQD;AAC9BqrC,MAAAA,EAAOrrC,OAAO+lB,MAChBslB,EAAO/8B,OAAOtO,GAAG,CACjBA,GAAAA;AAAAA,EAGJ,IAEClD,EAAUsE,YAAY,aAAa,WAC/BqoC;AAAAA,IAAAA,EAASC,SAASD,EAASC,MAAMrhC,cACnCohC,EAASC,MAAMrhC,WAAWC,YAAYmhC,EAASC,KAAAA;AAGhD,aAAQ1pC,IAAI,GAAGA,IAAIqrC,EAAOprC,QAAQD;AAC9BqrC,MAAAA,EAAOrrC,CAAAA,EAAGqI,cACZgjC,EAAOrrC,CAAAA,EAAGqI,WAAWC,YAAY+iC,EAAOrrC;AAG1CqrC,IAAAA,IAAS,MAEN/B,EAAWx+B,QAAQw+B,EAAWx+B,KAAKzC,cACrCihC,EAAWx+B,KAAKzC,WAAWC,YAAYghC,EAAWx+B,OAEnDw+B,IAAa;AAAA,EACf,CAEQ,GAAA,EACNgC,OA/Gc,WAAA;AACd,QAAIhyB,IAAOuxB,EAAW7hC,MAAM5C,MAAM+I,SAAAA;AAElC,WADAmK,EAAK3W,OAAO2W,EAAK3W,QAAQ,WAClB+nC,EAAWpxB;EACpB,GA4GEiyB,SA3GgB;AAChB,QAAIjyB,IAAOuxB,EAAW7hC,MAAM5C,MAAM+I,SAElC;AAAA,WADAmK,EAAK3W,OAAO2W,EAAK3W,QAAQ,SAClBgoC,EAAarxB,CACtB;AAAA,EAAA,GAwGET,SAASywB,GACTkC,UAAUrC;AAEZ;ADjUAnB,GAAcrtB,YAAY,EACzB8wB,oBAAoB,SAAUpqC,GAAMqqC,GAAAA;AAChB,SAARrqC,KAAQ,YAClB+E,KAAKgiC,SAAS/mC,EAAKA,QAAQ+E,KAAKgiC,QAE5B/mC,EAAKsS,uBACRvN,KAAKiiC,WAAWhnC,EAAKsS,UAGlBtS,EAAKsqC,YAAYzH,WACpB99B,KAAKkiC,WAAWjnC,EAAKsqC,UAEtBvlC,KAAKwlC,WAAWF,MAEhBtlC,KAAKgiC,SAAS/mC,GACd+E,KAAKwlC,SAASF,IAGXtlC,KAAKgiC,UAAU,WAClBhiC,KAAKwlC,SAAAA,IACLxlC,KAAKylC,SAAAA,KAGFzlC,KAAKgiC,WAAW,UAAUhiC,KAAKgiC,WAAW,eAC7ChiC,KAAKwlC,SAAS,IACdxlC,KAAKylC,SAAS,IACdzlC,KAAK0lC,mBAAmB,IACxB1lC,KAAKiiC,WAAWjiC,KAAKiiC,YAAY,CAAA,GACjCjiC,KAAKiiC,SAAS,cAAkB,IAAA,sBAE7BjiC,KAAKiiC,YAAajiC,CAAAA,KAAKiiC,SAAS,cAAA,MAClCjiC,KAAKiiC,SAAS,kBAAkB,sCAI9BjiC,KAAKgiC,WAAW,aACnBhiC,KAAKwlC,aACLxlC,KAAKylC,SAAS,IACdzlC,KAAK2lC,UAAU1qC,EAAK2qC;AAErB,GACDC,QAAQ,SAAUv/B,GAAAA;AACjB,SAAItG,KAAK8lC,OACDpiB,mBAAmBpd,CAAAA,IAEnBu/B,OAAOv/B,CAAAA;AACf,GAMDo8B,mBAAmB,SAAUznC;AAC5B+E,OAAK8lC,OAAAA,CAAAA,CAAS7qC;AACd,GAMD8qC,gBAAgB,SAAUC,GAAAA;AACzBhmC,OAAKimC,kBAAmBD,KAAO,WAAYA,EAAI3rC,MAAM,GAAO2rC,IAAAA;AAC5D,GAMDE,cAAc,WAAA;AACb,SAAQlmC,CAAAA,KAAKqhC,YAAYxnC;AACzB,GAMDssC,iBAAiB,SAAUlrC;AAC1B+E,OAAKylC,SAAAA,CAAAA,CAAWxqC;AAChB,GAMDmrC,uBAAuB,SAAUnrC,GAAAA;AAChC+E,OAAKqmC,WAAAA,CAAAA,CAAaprC;AAClB,GAMD8Q,eAAe,SAAU9Q,GAAM0/B,GAAAA;AAC9B36B,OAAK+hC,aAAc9mC,KAAQ,QAC3B+E,KAAK8L,aAAa7Q,GAClB+E,KAAK26B,MAAMA;AACX,GACDrpB,QAAQ,SAAUiB,GAAM+zB,GACvBtmC;AAAAA,OAAKqa,eAAe,IACpB9H,EAAKtH,KAAKq7B,KAAU/vC,MACpByJ,GAAAA,KAAKqa;AACL,GAQD6mB,YAAY,SAAUqF,GAAOC,GAAOvrC,GAAAA;AACnC,MAAI+E,CAAAA,KAAKqa,cAAT;AACA,QAAIkD,IAAMvd,KAAKymC,QAAQF;AAEvBtrC,IAAAA,IAAOA,KAAQ;AACf,QAAIyrC,IAAW1mC,KAAK8gC,WAAW6F,YAAYJ,GAAOvmC,KAAK0hC,YACnDgF;AAAAA,IAAAA,KAAYzrC,KAAQ,cAAWA,IAAOyrC,IACtCF,KACHxmC,KAAK4mC,YAAYL,GAAO,EAAA,GACxBvmC,KAAKqhC,YAAY9jB,CAAAA,IAAOgpB,GACxBvmC,KAAK8gC,WAAWW,YAAY8E,GAAOvmC,KAAK0hC,cAAczmC,IAClD+E,KAAK0S,aAAa6zB,OACrBvmC,KAAK0S,aAAa6zB,KAAS,WAEvBvmC,KAAK6mC,WAAWN,CAAAA,MACpBvmC,KAAKqhC,YAAYn5B,OAAOqV,GAAK,CAAA,GAC7Bvd,KAAK8gC,WAAWW,YAAY8E,GAAOvmC,KAAK0hC,cAAc,EAIxD1hC,IAAAA,KAAK8mC,QAAQP,GAAOC,GAAOvrC,CACvBurC,GAAAA,KAASxmC,KAAK+hC,cAAY/hC,KAAK4M,SAAS25B,CApBd;AAAA,EAAA;AAqB9B,GAEDO,SAAS,SAAUntC,GAAI6sC,GAAOvrC,GAC7B;AAAA,MAAI0hB,IAAM,IACN6lB,IAAUxiC,KAAK6mC,WAAWltC,CAAAA;AAK9B,MAJI6oC,MACH7lB,IAAM3c,KAAK++B,OAAOyD,CAClBgE,GAAAA,IAAAA,KAEGxmC,KAAKH,UAAU,aAAa,CAAClG,GAAI6sC,GAAOvrC,GAAMunC,CAEjD7lB,CAAAA,MAAAA,IAAM3c,KAAK++B,OAAOyH,IAAQvrC,IAAO,OAAW0hB,IAAAA,GAE5C3c,KAAK8gC,WAAW9gC,KAAK+mC,SAAS,CAAA,CAAA,EAAIptC,GAAIgjB,CAAAA,GAElC6lB,KAAWA,EAAQwE,UAAS;AAC/BrqB,IAAAA,KAAO3c,KAAK++B,OAAOyD,IAAU,OAAA;AAC7B,aAAS5oC,IAAI,GAAGA,IAAI4oC,EAAQwE,QAAQntC,QAAQD;AACvC4oC,MAAAA,EAAQwE,QAAQptC,CACnBoG,KAAAA,KAAK8gC,WAAW9gC,KAAK+mC,SAAS,CAAA,CAAA,EAAIptC,GAAIC,GAAG+iB,CAAAA;AAAAA,EAC3C;AAEF,GACDsqB,kBAAkB,SAAST,GAC1B;AAAA,SAAIA,MAAU,aACN,WAEJA,MAAU,YACN,WAEJA,MAAU,YACN,WAED;AACP,GAEDlrC,UAAU,SAAU3B,GACnB;AAAA,SAAOqG,KAAK8gC,WAAW6F,YAAYhtC,GAAIqG,KAAK0hC;AAC5C,GACDmF,YAAY,SAAUltC,GACrB;AAAA,SAAOqG,KAAKohC,SAASznC,CACrB;AAAA,GACDitC,aAAa,SAAUjtC,GAAIsB,GAAM+rC,GAC5BA;AAAAA,EAAAA,MAAS/rC,IAAO,EACnBiU,OAAOjU,GAAM+rC,SAASA,GAASl3B,UAAU;AACxC,WAAO9P,KAAKkP,MAAMY,SAClB;AAAA,EAAA,EAAA,IAEF9P,KAAKohC,SAASznC,CAAAA,IAAMsB;AACpB,GAMDisC,mBAAmB,SAAUX;AAC5B,SAAO;AACP,GAMD35B,UAAU,SAAU25B;AAGnB,SAFIvmC,KAAK8gC,WAAWqG,YAAUnnC,KAAK8gC,WAAWqG,YAEnCZ,gBAAwBvmC,KAAKwlC,SAAexlC,KAAKonC,iBACxDpnC,KAAK0S,aAAa6zB,OAEtBvmC,KAAKoiC,WAAW,OACXpiC,KAAKknC,kBAAkBX,MAAUvmC,KAAKH,UAAU,qBAAqB,CAAC0mC,GAAOvmC,KAAKoiC,QAAAA,CAAAA,MAAAA,KACvFpiC,KAAKqnC,gBAAgBrnC,KAAKsnC,YAAYf,CAAAA,GAAQA;AAC9C,GACDc,iBAAiB,SAAU/gC,GAAMigC,GAAAA;AAChC,MAAKvmC,CAAAA,KAAKH,UAAU,kBAAkB,CAAC0mC,GAAOvmC,KAAK1E,SAASirC,CAAQjgC,GAAAA,CAAAA,CAAAA;AAAQ;AAC5EtG,OAAKunC,UAAUjhC,GAAMigC,CACrB;AAAA,GACD7Y,WAAW,SAAUpnB,GAAM3M;AAC1B,MAAIqG,KAAK0lC;AACR,WAAQ1lC,KAAKwnC,iBAAiBlhC,CAAAA;AAG/B,MAAmB,OAARA,KAAQ;AAClB,WAAOA;AACR,MAAW3M;AACV,WAAOqG,KAAKynC,cAAcnhC,GAAM,EAAA;AAEhC,MAAIohC,IAAQ,IACR3R,IAAO,CAAA;AACX,WAAShsB,KAAOzD;AACXA,MAAKrD,eAAe8G,CACvB29B,MAAAA,EAAMruC,KAAK2G,KAAKynC,cAAcnhC,EAAKyD,CAAAA,GAAMA,IAAM/J,KAAKmiC,UAAAA,CAAAA,GACpDpM,EAAK18B,KAAK0Q,CAAAA;AAKZ,SAHA29B,EAAMruC,KAAK,SAAS2G,KAAK6lC,OAAO9P,EAAK5xB,KAAK,GACtCnE,CAAAA,CAAAA,GAAAA,KAAK8gC,WAAW7W,gBACnByd,EAAMruC,KAAK,kBAAmB2G,KAAK8gC,WAAuB,eACpD4G,EAAMvjC,KAAK;AAEnB,GACDsjC,eAAe,SAAUnhC,GAAMqhC,GAAAA;AAC9B,MAAmB,OAARrhC,KAAQ;AAClB,WAAOA;AACR,MAAIohC,IAAQ,IACRjkB,IAAa;AACjB,WAAS1Z,KAAOzD;AACf,QAAIA,EAAKrD,eAAe8G,IAAM;AAC7B,WAAKA,KAAO,QAAQA,KAAO/J,KAAK0hC,iBAAiB1hC,KAAKgiC,UAAU;AAAQ;AAEvEve,MAAAA,WADUnd,EAAKyD,CAAAA,KAAS,mBAAmBzD,EAAKyD,CAAAA,KAAS,WAC5CzD,EAAKyD,CAEL8E,IAAAA,KAAKmB,UAAU1J,EAAKyD,CAElC29B,CAAAA,GAAAA,EAAMruC,KAAK2G,KAAK6lC,QAAQ8B,KAAQ,MAAM59B,CAAAA,IAAO,MAAM/J,KAAK6lC,OAAOpiB,CAC/D,CAAA;AAAA,IAAA;AACF,SAAOikB,EAAMvjC,KAAK,GAClB;AAAA,GACDyjC,eAAe,SAAU/6B,GAAAA;AACxB,MAAImc,IAAOhpB,KAAK8gC,WAAW9X;AAC3B,MAAIhpB,KAAKkiC;AACR,aAASn4B,KAAO/J,KAAKkiC;AACpBr1B,UAAMA,IAAMmc,EAAK6e,aAAah7B,CAAAA,IAAO7M,KAAK6lC,OAAO97B,KAAO,MAAM/J,KAAK6lC,OAAO7lC,KAAKkiC,SAASn4B;AAC1F,SAAO8C;AACP,GACD06B,WAAW,SAAUO,GAAYvB,GAChC;AAAA,MAAKuB,GAAL;AAGA,QAAA,CAAK9nC,KAAKH,UAAU,uBAAuB0mC,IAAQ,CAACA,GAAOvmC,KAAK1E,SAASirC,CAAQuB,GAAAA,CAAAA,IAAc,CAAC,MAAM,MAAMA;AAC3G,aAAO;AAGJvB,IAAAA,MACHvmC,KAAK0S,aAAa6zB,CAAAA,KAAS,oBAAKrtC,QAAQC,QAAAA;AAGzC,QAAI4uC,IAAO/nC,MACPgpB,IAAOhpB,KAAK8gC,WAAW9X;AAE3B,QAAIhpB,KAAKgiC,WAAW,UAApB;AAsEA,UAmBI17B,GAnBA0hC,IAAc,EACjB58B,UAAU,SAASke,GAAAA;AAClB,YAAIpmB,IAAM,CAEV;AAAA,YAAIqjC;AACHrjC,UAAAA,EAAI7J,KAAKktC;iBACCuB;AACV,mBAAS/9B,KAAO+9B;AACf5kC,YAAAA,EAAI7J,KAAK0Q,CAAAA;AAIX,eAAOg+B,EAAKE,YAAYF,GAAMze,GAAKpmB,CAAAA;AAAAA,MACnC,GACDqK,SAASw6B,EAAK9F,SAGXiG,GAAAA,IAAYloC,KAAK8hC,mBAAmB9hC,KAAKmoC,QAASnf,EAAK6e,aAAa7nC,KAAK8hC,eAAAA,IAAmB,CAAC,cAAc9hC,KAAKmoC,OAAO,iBAAiBnoC,KAAK8gC,WAAW6F,YAAY,GAAG,SAAA,CAAA,EAAYxiC,KAAK,GAAQ,IAAA,KAChM0I,IAAM7M,KAAK4nC,cAAcM;AAG7B,cAAQloC,KAAKgiC;QACZ,KAAK;AACJ17B,UAAAA,IAAOtG,KAAKooC,4BAA4BN,IACxCE,EAAYn7B,MAAMA,IAAMmc,EAAK6e,aAAah7B,CAAAA,IAAO7M,KAAK0tB,UAAUpnB,GAAMigC,IACtEyB,EAAYx6B,SAAS;AACrB;AAAA,QACD,KAAK;AACJlH,UAAAA,IAAOtG,KAAKooC,4BAA4BN,IACxCE,EAAYn7B,MAAMA,GAClBm7B,EAAYx6B,SAAS,QACrBw6B,EAAY1hC,OAAOtG,KAAK0tB,UAAUpnB,GAAMigC,CAAAA;AACxC;AAAA,QACD,KAAK;AACJjgC,UAAAA,IAAO,CAAA;AACP,cAAI+hC,IAAmBroC,KAAKsoC,uBAAuBR,CAAAA;AACnD,mBAAS/9B,KAAOs+B;AACXt+B,YAAAA,MAAQ/J,KAAK0hC,gBAAgB33B,MAAQ,QAAQA,MAAQ,YAGzDzD,EAAKyD,CAAAA,IAAOs+B,EAAiBt+B,CAAAA;AAG9Bi+B,UAAAA,EAAYn7B,MAAMA,GAClBm7B,EAAYx6B,SAAS,QACrBw6B,EAAY1hC,OAAOuI,KAAKmB,UAAU,EACjCrW,IAAI4sC,GACJz3B,QAAQg5B,EAAW9nC,KAAK0hC,eACxBp7B,MAAMA,EAAAA,CAAAA;AAEP;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AAIJ,kBAHAuG,IAAMq7B,EAAU35B,QAAQ,sBAAsB,KAC9CjI,IAAO,IAECtG,KAAK1E,SAASirC,CAAAA,GAAAA;AAAAA,YACrB,KAAK;AACJyB,cAAAA,EAAYx6B,SAAS,QACrBw6B,EAAY1hC,OAAOtG,KAAK0tB,UAAUoa,GAAYvB,CAC9C;AAAA;AAAA,YACD,KAAK;AACJyB,cAAAA,EAAYx6B,SAAS,UACrBX,IAAMA,KAAOA,EAAIpK,MAAAA,QAAc,MAAM,KAAK,OAAO8jC;AACjD;AAAA,YACD;AACCyB,cAAAA,EAAYx6B,SAAS,OACrBw6B,EAAY1hC,OAAOtG,KAAK0tB,UAAUoa,GAAYvB,CAC9C15B,GAAAA,IAAMA,KAAOA,EAAIpK,MAAAA,QAAc,MAAM,KAAK,OAAO8jC;AAAAA;AAGnDyB,UAAAA,EAAYn7B,MAAM7M,KAAK4nC,cAAc/6B,CAAAA;AAAAA,MAAAA;AAKvC,aADA7M,KAAKshC,aACEtY,EAAKuf,MAAMP,CA9EjB;AAAA,IAAA;AApED;AACC,UAAIxB,IAAQxmC,KAAK1E,SAASirC,CAAAA,GACtBz3B,IAAS9O,KAAKinC,iBAAiBT,CAAAA;AAAAA,aAC5BsB,EAAW9nC,KAAK0hC,YAAAA;AACvB,UAAI8G,IAA0B,SAAUC;AACvC,YAAIC,IAAclC;AAClB,YAAGiC,KAAOA,EAAI9e,gBAAgB8e,EAAIE,kBAAiB;AAChC,UAAfF,EAAIh5B,WAAW,QACjBi5B,IAAc;AAEf,cACCD;AAAAA,YAAAA,IAAM55B,KAAKhB,MAAM46B,EAAI9e,YAC3B;AAAA,UAAA,QAAkB;AAAA,UAAA;AAAA,QACb;AAED+e,QAAAA,IAAcA,KAAe;AAC7B,YAAIl3B,IAAM+0B,GACNqC,IAAMrC;AAENkC,QAAAA,MACHC,IAAcD,EAAI35B,UAAU45B,GAC5Bl3B,IAAMi3B,EAAIj3B,OAAOA,GACjBo3B,IAAMH,EAAI9uC,MAAM8uC,EAAIG,OAAOA,IAE5Bb,EAAKc,oBAAoBr3B,GAAKo3B,GAAKF,GAAaD,CACpD;AAAA,MAAA;AAEG,YAAMK,IAAa;AACnB,UAAIC;AACJ,UAAI/oC,KAAK2lC,mBAAmBrxB;AAC3By0B,QAAAA,IAAgB/oC,KAAK2lC,QAAQmD,GAAYh6B,GAAQg5B,GAAYvB;;AAE7D,gBAAQC,GAAAA;AAAAA,UACP,KAAK;AACJuC,YAAAA,IAAgB/oC,KAAK2lC,QAAQmD,CAAAA,EAAYE,OAAOlB,CAAAA;AAChD;AAAA,UACD,KAAK;AACJiB,YAAAA,IAAgB/oC,KAAK2lC,QAAQmD,CAAYG,EAAAA,OAAO1C;AAChD;AAAA,UACD;AACCwC,YAAAA,IAAgB/oC,KAAK2lC,QAAQmD,CAAAA,EAAYI,OAAOpB,GAAYvB,CAAAA;AAAAA,QAAAA;AAK/D,UAAGwC,GAAc;AAEhB,aAAIA,EAAcp7B,QAChBo7B,EAAcpvC,OADEgU,UACkBo7B,EAAcH,QAAQ9K,UAAaiL,EAAcj6B,WAAWgvB;AAC/F,gBAAM,IAAI/2B,MAAM,2EAAA;AAGdgiC,QAAAA,EAAcp7B,OAChBo7B,EAAcp7B,KAAK66B,GAAyBv4B,MAAM,SAAS3E;AACvDA,UAAAA,KAASA,EAAMwD,SACjB05B,EAAwBl9B,CAAAA,IAExBk9B,EAAwB,EAAE15B,QAAQ,SAASI,OAAO5D,EAAAA,CAAAA;AAAAA,QAEzD,KAGKk9B,EAAwBO,CAAAA;AAAAA,MAE7B;AACIP,QAAAA,EAAwB,IAAA;AAAA,IAGzB;AAAA,EAhFA;AA+JD,GACDpB,aAAa;AACZ,MAAKpnC,KAAKqhC,YAAYxnC,UAAUmG,KAAK8L,eAAe,OAApD;AAIA9L,SAAKoiC,WAAW,CAChB;AAAA,QAAI+G;AAMJ,QAJAnpC,KAAKopC,mBAAmB,SAAS7C;AAChC4C,UAAQA,KAASnpC,KAAKknC,kBAAkBX,CAC3C;AAAA,IAAA,CAAA,GAAA,CAEO4C,MAAUnpC,KAAKH,UAAU,qBAAqB,CAAC,IAAIG,KAAKoiC,QAC5D,CAAA;AAAA,aAAA;AAGGpiC,SAAKwlC,SACRxlC,KAAKunC,UAAUvnC,KAAKqpC,YAAAA,CAAAA,IAEpBrpC,KAAKopC,mBAAmB,SAAS7C;AAChC,UAAKvmC,CAAAA,KAAK0S,aAAa6zB,CAAAA,GAAQ;AAC9B,YAAIvmC,KAAK6mC,WAAWN,CAAAA;AACnB;AAEDvmC,aAAKqnC,gBAAgBrnC,KAAKsnC,YAAYf,CAAAA,GAAQA,CAC9C;AAAA,MAAA;AAAA,IACL,CAvBG;AAAA,EAAA;AAyBD,GAED8C,aAAa,SAAU9C;AACtB,MAAI+C,IAAM,CAAA,GACNC,IAAAA;AAaJ,SAZAvpC,KAAKopC,mBAAmB,SAASzvC,GAChC;AAAA,QAAA,CAAIqG,KAAK0S,aAAa/Y,CAAAA,KAAAA,CAAOqG,KAAK6mC,WAAWltC,CAAAA,GAA7C;AAGA,UAAI6vC,IAAMxpC,KAAKsnC,YAAY3tC,CACtBqG;AAAAA,WAAKH,UAAU,kBAAkB,CAAClG,GAAIqG,KAAK1E,SAAS3B,CAAK6vC,GAAAA,CAAAA,CAAAA,MAG9DF,EAAI3vC,CAAAA,IAAM6vC,GACVD,IAAU,IACVvpC,KAAK0S,aAAa/Y,CAAAA,KAAM,oBAAKT,QAAQC,QAAAA;AAAAA,IAPpC;AAAA,EAQJ,CAAA,GACSowC,IAAUD,IAAM;AACvB,GAED7C,SAAS,SAAUgD,GAClB;AAAA,MAAI7vC,IAAI;AACR,OAAKA,IAAI,GAAGA,IAAIoG,KAAKqhC,YAAYxnC,UAC5B4vC,KAAWzpC,KAAKqhC,YAAYznC,CAAAA,GADQA;;AAEzC,SAAOA;AACP,GAQD8vC,cAAc,SAAUz6B,GAAMmB;AACxBpQ,OAAK2pC,cAAW3pC,KAAK2pC,YAAY,CAAA,IACtC3pC,KAAK2pC,UAAU16B,CAAQmB,IAAAA;AACvB,GAUDy4B,qBAAqB,SAAUr3B,GAAKo3B,GAAK95B,GAAQ86B,GAChD;AAAA,MAAI5pC,KAAK8gC,YAAT;AAKA,QAAI+I,IAASr4B,GACTs4B,IAAWh7B,MAAW,WAAWA,MAAW;AAIhD,QAHKg7B,KACJ9pC,KAAK4mC,YAAYp1B,GAAK1C,CAElB9O,GAAAA,KAAc,aAAMA,KAAK2pC,UAAU76B,CAAc9O,KAAAA,CAAAA,KAAK2pC,UAAU76B,CAAQ86B,EAAAA,CAAAA;AAC5E,oBAAe5pC,KAAK0S,aAAam3B;AAGA,IAA9B7pC,KAAK0S,aAAam3B,CACrB7pC,MADiC,UACjCA,KAAKkhC,WAAW1vB,GAAK,EAAA;AAGtB,QAAIu4B,IAAcv4B;AAElB,YAAQ1C,GAAAA;AAAAA,MACP,KAAK;AAAA,MACL,KAAK;AACA85B,QAAAA,KAAOp3B,MACVxR,KAAKkhC,WAAW1vB,KAChBxR,GAAAA,KAAK8gC,WAAW9gC,KAAK+mC,SAAS,CAAA,CAAA,EAAIv1B,GAAKo3B,CACvCp3B,GAAAA,IAAMo3B;AAEP;AAAA,MACD,KAAK;AAAA,MACL,KAAK;AAIJ,eAHA5oC,KAAK8gC,WAAWW,YAAYjwB,GAAKxR,KAAK0hC,cAAc,iBACpD1hC,KAAK8gC,WAAW9gC,KAAK+mC,SAAS,CAAA,CAAA,EAAIv1B,GAAKo3B,CAAAA,GAAAA,OAChC5oC,KAAK0S,aAAam3B,IAClB7pC,KAAKH,UAAU,iBAAiB,CAAC2R,GAAK1C,GAAQ85B,GAAKgB,CAAAA,CAAAA;AAAAA,IAAAA;AAG1B,IAA9B5pC,KAAK0S,aAAam3B,CAAAA,MAAY,UAC7BC,KACH9pC,KAAK8gC,WAAWW,YAAYjwB,GAAKxR,KAAK0hC,cAAc,EAE9C1hC,GAAAA,OAAAA,KAAK0S,aAAam3B,CAAAA,MAAAA,OAElB7pC,KAAK0S,aAAam3B,IACzB7pC,KAAKkhC,WAAW0H,OAAW5oC,KAAK8gC,WAAW6F,YAAYn1B,GAAKxR,KAAK0hC,YAAAA,CAAAA,IAGlE1hC,KAAKH,UAAU,iBAAiB,CAACkqC,GAAaj7B,GAAQ85B,GAAKgB,CAAAA,CAAAA;AAAAA,EA5C1D;AA6CD,GAEDI,gBAAgB,SAAU1gB,GAAK3vB,GAI9B;AAAA,SAHGqG,KAAK8gC,cAAc9gC,KAAK8gC,WAAWjhC,aACrCG,KAAK8gC,WAAWjhC,UAAU,eAAe,CAAClG,GAAI2vB,EAAII,MAAAA,CAAAA,GAE5C1pB,KAAKiqC,YAAYtwC,CAAAA;AACxB,GAEDuwC,4BAA4B,WAAA;AACvBlqC,OAAK8hC,oBACR9hC,KAAKqlC,mBAAmB,QAAA,EACxBrlC,GAAAA,KAAK8hC,oBAAoB9hC,KAAK8hC,gBAAgBj7B,QAAQ,GAAA,WAAc,MAAM,OAAO,gBACjF7G,KAAKmqC,mBAAmBnqC,KAAK8hC;AAE9B,GAODmG,aAAa,SAAUmC,GAAM9gB,GAAK3vB,GAAAA;AACjC,MAAIqvB,IAAOhpB,KAAK8gC,WAAW9X;AAE3B,MAAIM,EAAII,OAAOja,WAAW,KAA1B;AAMA,QAAIg5B;AACJ;AACCA,MAAAA,IAAM55B,KAAKhB,MAAMyb,EAAII,OAAOC,YAAAA;AAAAA,IAC5B,QAAQzuB;AAEHouB,MAAAA,EAAII,OAAOC,aAAa9vB,WAC5B4uC,IAAM,CAAA;AAAA,IAEP;AAED,QAAIA,GAAK;AACR,UAAI35B,IAAS25B,EAAI35B,UAAU9O,KAAK1E,SAAS3B,CAAO,KAAA,WAC5C6X,IAAMi3B,EAAIj3B,OAAO7X,EAAG,IACpBivC,IAAMH,EAAIG,OAAOjvC,EAAG,CAAA;AAGxB,aAFAywC,EAAKvB,oBAAoBr3B,GAAKo3B,GAAK95B,GAAQ25B,SAC3C2B,EAAKC,eAAAA;AAAAA,IAEL;AAGD,QAAIzyC,IAAMoxB,EAAKa,OAAO,QAAQP,EAAII,MAAAA;AAClC,QAAK9xB,CAAAA;AACJ,aAAOoI,KAAKgqC,eAAe1gB,GAAK3vB,CAEjC;AAAA,QAAI2wC,IAAOthB,EAAKmB,MAAM,iBAAiBvyB,CAAAA;AACvC,QAAK0yC,CAAAA,EAAKzwC;AACT,aAAOmG,KAAKgqC,eAAe1gB,GAAK3vB,CAAAA;AAGjC,aAASC,IAAI,GAAGA,IAAI0wC,EAAKzwC,QAAQD,KAAK;AACrC,UAAIgwC,IAAOU,EAAK1wC,CAAAA;AACZkV,MAAAA,IAAS86B,EAAK/uC,aAAa,MAC3B2W,GAAAA,IAAMo4B,EAAK/uC,aAAa,QACxB+tC,IAAMgB,EAAK/uC,aAAa,KAE5BuvC,GAAAA,EAAKvB,oBAAoBr3B,GAAKo3B,GAAK95B,GAAQ86B,CAAAA;AAAAA,IAC3C;AACDQ,MAAKC;EAxCJ;AAFArqC,SAAKgqC,eAAe1gB,GAAK3vB,CAAAA;AA2C1B,GACDswC,aAAa,SAAUtwC,GACtB;AAAA,MAAIA;AACH,aAASC,IAAI,GAAGA,IAAID,EAAGE,QAAQD;aACvBoG,KAAK0S,aAAa/Y,EAAGC,CAAAA,CAAAA;AAC9B,GACDywC,gBAAgB;AACXrqC,OAAKshC,aAAWthC,KAAKshC,aAEzBthC,KAAKH,UAAU,uBAAuB,CAAA,CAAA,GACjCG,KAAKqhC,YAAYxnC,UACrBmG,KAAKH,UAAU,cAAc;AAC9B,GAOD8kB,MAAM,SAAUjuB,GACf;AAAA,MAAA,CAAIsJ,KAAKuqC,cAAT;AAGAvqC,SAAK8gC,aAAapqC,GACdsJ,KAAK8gC,WAAW0J,YACnBxqC,KAAK8gC,WAAW0J,SAASxqC,IAAAA,GAG1BA,KAAKkqC,2BAAAA,GAELlqC,KAAK+mC,WAAS/mC,KAAK+mC,YAAU,CAAC,yBAAwB,IAAG,uBAAsB,oBDhnB1E,SAAyBrwC,GAAWmqC,GAC1CnqC;AAAAA,MAAAA,EAAUuqC,WAAS,SAAStnC;AAC3B,eAAGqG,CAAAA,KAAKyqC,sBACCzqC,KAAKyqC,kBAAkB9wC;MAGlC,GACCjD,EAAU+qC,cAAY,SAAS9nC,GAAGsV,GAAKC;AACtC,YAAIvV,GAAG;AACN,cAAI8C,IAAKuD,KAAK7E,SAASxB,CAAAA;AACpB8C,UAAAA,MAAIA,EAAGwS,CAAMC,IAAAA;AAAAA,QACnB;AACGlP,eAAKgrB,UAAU/b,KAAMC;AAAAA,MAExB,GACCxY,EAAUiwC,cAAY,SAAShtC,GAAGsV,GAAAA;AACjC,YAAItV,GAAG;AACN,cAAI8C,IAAKuD,KAAK7E,SAASxB,CAAAA;AACvB,iBAAG8C,IACKA,EAAGwS,CAEH,IAAA;AAAA,QACX;AACG,eAAOjP,KAAKgrB,UAAU/b,CAAAA;AAAAA,MAEzB,GACCvY,EAAUg0C,wBAAsB,SAAS/wC,GAAGhC,GAAAA;AAC3C,YAAIjB,EAAUyE,SAASxB,IAAvB;AAEAqG,eAAKm8B,aAAaxiC,GAAG,SAAS8U;AAC7BA,YAAAA,EAAE9W,MAAMgzC,WAAS,MAAIhzC;AAAAA,UACxB,CAAA;AACE,cAAI8E,IAAKuD,KAAK7E,SAASxB,CACvB8C;AAAAA,UAAAA,EAAgB,cAAE9E,GAClBqI,KAAK4qC,cAAcnuC,CAAAA;AAAAA,QANX;AAAA,MAOV,GACC/F,EAAU6qC,mBAAmB,SAASC,GAAI7nC,GACzC;AAAA,YAAI2M,IAAO5P,EAAUq0B,eAAeyW,EAAI76B,UAAAA;AAEnB,QAAjBL,EAAKxH,YAAY,WAAQwH,EAAKukC,cAAc,SAChDvkC,EAAK4M,OAAO5M,EAAK4M,QAAM5M,EAAK8mB,WAC5B9mB,EAAKrO,aAAavB,EAAU42B,SAASC,UAAUjnB,EAAKrO,aACpDqO,EAAKpO,WAAWxB,EAAU42B,SAASC,UAAUjnB,EAAKpO,QAAAA,GAClDxB,EAAU6a,SAASjL,IACf5P,EAAUirC,mBACbjrC,EAAU6V,eACb;AAAA,MAAA,GACC7V,EAAUo0C,sBAAsB,SAASnxC,GAAI8+B,GAAAA;AACxC/hC,QAAAA,EAAUyE,SAASxB,MAEvBjD,EAAUgb,cAAc/X,GAAI8+B,CAC9B;AAAA,MAAA,GACC/hC,EAAUq0C,kBAAkB,SAASpxC,GAAI8+B,GAAAA;AACxC,YAAI/hC,EAAUyE,SAASxB,CASvB;AAAA,iBANG8+B,KAAU9+B,KAAM8+B,MACfz4B,KAAK2mC,YAAYhtC,GAAIknC,EAAGa,YAC1B1hC,KAD2C,kBAC3CA,KAAKyhC,YAAY9nC,GAAIknC,EAAGa,cAAc,SAEvC1hC,GAAAA,KAAK0R,cAAc/X,GAAI8+B,CAAAA,IAEjBz4B,KAAKiS,YAAYwmB,GAAQ,EAAA;AAAA,MAClC,GAEC/hC,EAAUs0C,QAAQ;AACjBhrC,aAAK6L,MAAMg1B;AAAAA,MACb,GACCnqC,EAAUs0C,MACX;AAAA,IAAA,EC4iBkBhrC,KAAK8gC,YAAY9gC,IACjC;AAAA,QAAIirC,IAAsB,IAAIrK,GAAoB5gC,KAAK8gC,YAAY9gC,IAAAA;AACnEirC,IAAAA,EAAoB/uB,OAAAA,GACpBlc,KAAKhF,YAAY,aAAa,WACtBgF;AAAAA,aAAAA,KAAKsnC,oBAELtnC,KAAK8gC,WAAWj1B,YAChB7L,KAAK8gC,WAAWoK,gBAChBlrC,OAAAA,KAAK8gC,WAAW4J,uBAAAA,OAChB1qC,KAAK8gC,WAAWgK,qBAAAA,OAChB9qC,KAAK8gC,WAAWiK,iBAAAA,OAChB/qC,KAAK8gC,YACZmK,EAAoB7uB,OACvB;AAAA,IAAA,CAAA,GACEpc,KAAK8gC,WAAWjhC,UAAU,wBAAwB,CAACG,QACnDA,KAAKuqC,eAAAA,IAEL7zC,EAAUw0C,iBAAelrC;AAAAA,EA1BxB;AA2BD,GAEDmrC,kBAAkB,SAAU1uC,GAC3BuD;AAAAA,OAAKhF,YAAY,iBAAiByB,CAAAA;AAClC,GACD2uC,0BAA0B,SAAUC,GACnCrrC;AAAAA,OAAKhF,YAAY,uBAAuBqwC;AACxC,GAKDC,eAAe,SAAUC,GAAUC,GAAAA;AAClCD,EAAAA,IAAWA,KAAY,KAEvBvrC,KAAKmoC,QAAQqD,MAAQ,oBAAKtyC,QAAQC,QAAAA,GAClC6G,KAAKyrC,eAAe,IAEpBzrC,KAAK0rC,eAAe,IAEpB1rC,KAAKhF,YAAY,iBAAiB,SAAUwW,GAAK1C,GAAQ85B,GAAK+C;AAC7D3rC,SAAK4rC,gBAAgBp6B,GAAK1C,GAAQ85B,GAAK+C,CAC1C;AAAA,EAAA,CAAA,GACE3rC,KAAKhF,YAAY,cAAc,WAC9BgF;AAAAA,SAAK6rC;EACR,CAEE;AAAA,MAAI9D,IAAO/nC;AACX,MAAI8rC,IAAat1C,EAAOooC,YAAY,WAAA;AACnCmJ,IAAAA,EAAKgE,WACL;AAAA,EAAA,GAAER;AACHvrC,OAAKhF,YAAY,aAAa,WAC7B0jC;AAAAA,kBAAcoN,CACjB;AAAA,EAAA,CAAA;AACE,GAMDF,iBAAiB,SAAUp6B,GAAK1C,GAAQ85B,GAAK+C,GAC5C;AAAA,SAAI78B,KAAU,gBACb9O,KAAKyrC,eAAe,IAAA;AAKrB,GAKDI,UAAU,WAKT;AAAA,SAJI7rC,KAAKyrC,iBACRzrC,KAAKyrC,mBACLzrC,KAAK+rC,WAEC,IAAA;AACP,GAIDC,YAAY,SAAUn/B,GAAKzB,GAAAA;AAC1B,MAAI4d,IAAOhpB,KAAK8gC,WAAW9X;AAC3B,MAAIhpB,KAAK0rC;AACR,WAAO;AAEP1rC,OAAK0rC,eAAe,IAErB1iB,EAAKC,IAAIpc,GAAKzB;AACd,GAMD6gC,kBAAkB,SAASjvB,GAAAA;AAC1B,SAAIA,EAAKrW,aACDqW,EAAKrW,WAAWikB,YAEjB;AACP,GAIDmhB,YAAY,WACX;AAAA,MAAIhE,IAAO/nC,MACPgpB,IAAOhpB,KAAK8gC,WAAW9X,MACvBkjB,IAAUlsC,KAAK8gC,WAAW6F,YAAY,GAAG,SACzC95B,GAAAA,IAAM7M,KAAK8hC,kBAAkB9Y,EAAK6e,aAAa7nC,KAAK8hC,eAAmB,IAAA,CAAC,cAAc9hC,KAAKmoC,OAAO,iBAAiB+D,CAAS/nC,EAAAA,KAAK,GACrI0I;AAAAA,EAAAA,IAAMA,EAAI0B,QAAQ,iBAAiB,EACnCvO,GAAAA,KAAKgsC,WAAWn/B,GAAK,SAAUyc;AAC9B,QAAI6iB,IAAOnjB,EAAKmB,MAAM,cAAcb,CAAAA;AACpCye,MAAKjH,WAAWW,YAAY,GAAG,WAAWsG,EAAKkE,iBAAiBE,EAAK,CAAA,CAAA,CAAA;AAErE,QAAIC,IAAUpjB,EAAKmB,MAAM,YAAYb,CACrC;AAAA,QAAI8iB,EAAQvyC,QAAQ;AACnBkuC,QAAK1tB,eAAe;AAEpB,eAASzgB,IAAI,GAAGA,IAAIwyC,EAAQvyC,QAAQD,KAAK;AACxC,YAAI6V,IAAS28B,EAAQxyC,CAAAA,EAAGiB,aAAa,QAAA,GACjClB,IAAKyyC,EAAQxyC,GAAGiB,aAAa,IAAA,GAC7BmH,IAASoqC,EAAQxyC,CAAAA,EAAGiB,aAAa,QACrC;AAAA,gBAAQ4U;UACP,KAAK;AACJzP,iBAAKH,UAAU,kBAAkB,CAACusC,EAAQxyC,CAAAA,GAAID,GAAIqI,CAClD,CAAA;AAAA;AAAA,UACD,KAAK;AACJhC,iBAAKH,UAAU,kBAAkB,CAACusC,EAAQxyC,IAAID,GAAIqI,CAAAA,CAAAA;AAClD;AAAA,UACD,KAAK;AACJhC,iBAAKH,UAAU,kBAAkB,CAACusC,EAAQxyC,CAAID,GAAAA,GAAIqI;;MAGpD;AACD+lC,QAAK1tB;IACL;AACD0tB,MAAK2D,eAAAA,IACL3D,IAAO;AAAA,EACV,CACE;AAAA,GAEDsE,YAAY,WACXrsC;AAAAA,OAAKH,UAAU,aAAa,CAAA,CAAA,GAC5BG,KAAK0b,gBAAAA,GAEL1b,KAAKqhC,cAAc,IACnBrhC,KAAK0S,eAAe,IACpB1S,KAAKohC,WAAW,IAChBphC,KAAKiiC,WAAW,MAChBjiC,KAAKkiC,WAAW,MACTliC,OAAAA,KAAKuqC;AACZ,GAED19B,KAAK,SAASA,GACb7M;AAAAA,OAAK8hC,kBAAkB9hC,KAAKmqC,mBAAmBt9B;AAC/C,GAED26B,kBAAkB,SAASlhC;AAC1B,MAAoB,OAATA,KAAS;AACnB,WAAOA;AAGR,MAAIyM,IAAO/S,KAAK8gC,WAAWhtB,MAAMf,KAAKzM,CAAAA;AAMtC,SALItG,KAAKgiC,WAAW,uBACZjvB,EAAKpZ,IAAAA,OACLoZ,EAAK/S,KAAK0hC,YAGX7yB,IAAAA,KAAKmB,UAAU+C,CACtB;AAAA,GAIDq1B,6BAA6B,SAASN,GAAAA;AACrC,MAAIwE;AACJ,MAAGxE,EAAW9nC,KAAK0hC,YAAAA,MAAnB;AAEC,aAAQ9nC,KADR0yC,IAAgB,CAAA,GACHxE;AACZwE,MAAAA,EAAc1yC,CAAAA,IAAKoG,KAAKooC,4BAA4BN,EAAWluC,CAAAA,CAAAA;AAAAA;AAGhE0yC,IAAAA,IAAgBtsC,KAAKsoC,uBAAuBR;AAE7C,SAAOwE;AACP,GACDhE,wBAAwB,SAASiE,GAChC;AAAA,MAAIC,IAAS;AAUb,SATGD,MACCA,EAAYvsC,KAAK0hC,YAAAA,MAAkB,cACrC8K,IAAS,CAAA,GACF7yC,KAAK4yC,EAAY5yC,IACxB6yC,EAAOxsC,KAAK0hC,YAAgB6K,IAAAA,EAAYvsC,KAAK0hC,YAE7C8K,KAAAA,IAASD,IAGJC;AACP,GAEDpD,oBAAoB,SAAS72B,GAE5B;AAAA,WADI8uB,IAAcrhC,KAAKqhC,YAAY5+B,MAC1B7I,GAAAA,IAAI,GAAGA,IAAIynC,EAAYxnC,QAAQD,KAAK;AAC5C,QAAI2sC,IAAQlF,EAAYznC,CAAAA;AACpBoG,SAAK8gC,WAAW6F,YAAYJ,GAAOvmC,KAAK0hC,YAAAA,KAC3CnvB,EAAKtH,KAAKjL,MAAMumC,CAAAA;AAAAA,EAEjB;AACD,GACD,oBAAoBkG,GACnB;AAAA,QAAMC,IAAgB,CAAA,GAChBh2C,IAAYsJ,KAAK8gC,YACjB/tB,IAAOrc,EAAUod,MAAMf,KAAK05B,CAClC;AAAA,WAAS7yC,KAAKmZ,GAAM;AACnB,QAAI45B,IAAO55B,EAAKnZ;AACO,IAAnBA,EAAEiN,QAAQ,GAEH8lC,MAFY,MAEZA,IACPA,EAAKpmB,iBACPmmB,EAAc9yC,CAAKlD,IAAAA,EAAU42B,SAASsf,WAAWD,KAEjDD,EAAc9yC,CAAAA,WADE+yC,KAAQ,WACL3sC,KAAK6sC,oBAAoBF,CAEzBA,IAAAA,IAEVA,MAFUA,WAGpBD,EAAc9yC,CAAAA,IAAK+yC;AAAAA,EAEpB;AAED,SADAD,EAAc1sC,KAAK0hC,YAAAA,IAAgBhrC,EAAUiwC,YAAY8F,EAAK9yC,IAAIqG,KAAK0hC,YAChEgL,GAAAA;AACP,GACD,oBAAoBD;AACnB,QAAMC,IAAgB,CAAA,GAChBh2C,IAAYsJ,KAAK8gC,YACjB/tB,IAAOrc,EAAUod,MAAMf,KAAK05B,CAAAA;AAClC,WAAS7yC,KAAKmZ,GAAM;AACnB,QAAI45B,IAAO55B,EAAKnZ,CACO;AAAA,IAAnBA,EAAEiN,QAAQ,GAAA,MAAS,MAEZ8lC,IACPA,EAAKpmB,iBACPmmB,EAAc9yC,CAAKlD,IAAAA,EAAU42B,SAASsf,WAAWD,CAEjDD,IAAAA,EAAc9yC,KADE+yC,OAAAA,KAAQ,WACL3sC,KAAK8sC,oBAAoBH,CAAAA,IAEzBA,IAGpBD,EAAc9yC,CAAAA,IAAK;AAAA,EAEpB;AAED,SADA8yC,EAAc1sC,KAAK0hC,YAAAA,IAAgBhrC,EAAUiwC,YAAY8F,EAAK9yC,IAAIqG,KAAK0hC,YAAAA,GAChEgL;AACP,GACDK,kBAAkB,SAASN;AAC1B,SAAGzsC,KAAK0lC,mBACA1lC,KAAK6sC,oBAAoBJ,KAEzBzsC,KAAK8sC,oBAAoBL,CAEjC;AAAA,GACDnF,aAAa,SAAS3tC;AACrB,MAAIqzC,IAAWhtC,KAAK8gC,WAAW3lC,SAASxB;AAIxC,SAHKqzC,MACJA,IAAW,EAAErzC,IAAIA,EAAAA,IAEXqG,KAAK+sC,iBAAiBC,CAAAA;AAC7B;AEt7BF,MAAeC,KAAA,EACdv0C,MAAM,EACLmsB,YAAY,CAAC,gBAAgB,QAAQ,QAAQ,SAAS,QAAQ,UAAU,QAAQ,MAAM,SAAS,eAAe,gBAAgB,aAC9HD,GAAAA,aAAa,CAAC,SAAS,UAAU,QAAQ,SAAS,QAAQ,SAAS,SAAS,SAAS,UAAU,UAAU,UAAU,QAAA,GACnH8B,UAAU,CAAC,SAAS,WAAW,YAAY,YAAY,UAAU,UAAU,UAC3EF,WAAW,CAAC,OAAO,SAAS,UAAU,UAAU,QAAQ,QAAQ,KAAA,EAAA,GAEjEoL,QAAQ,EACPwO,sBAAsB,SACtB8M,SAAS,OACTC,UAAU,SACVC,WAAW,OACXn6B,WAAW,YACXo6B,WAAW,QACXC,aAAa,SACbC,cAAc,UACdC,WAAW,SACX5X,aAAa,OACb6X,iBAAiB,qCACjBpY,kBAAkB,2CAClBqY,qBAAqB,SACrBC,cAAc,kBACdjc,UAAU,cAEVkc,mBAAmB,mDACnBC,mBAAmB,eACnBC,kBAAkB,SAClBC,uBAAuB,SACvBC,oBAAoB,eACpBC,wBAAwB,cACxBC,sCAAsC,6BAGtCC,UAAU,QAGVhR,gBAAgB,kBAChBC,cAAc,gBAGd6G,YAAY,MACZC,gBAAgB,UAGhBjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAM,QACNC,QAAQ,UAGRC,kBAAkB,QAClBC,mBAAmB,UACnBC,oBAAoB,QACpBC,mBAAmB,QACnBC,uBAAuB,MACvBC,uBAAuB,OACvBC,wBAAwB,cACxBC,aAAa,aACbC,wBAAwB,4BACxBC,yBAAyB,SACzBC,0BAA0B,MAC1BC,uBAAuB,UACvBC,yBAAyB,OACzBC,iCAAiC,MACjCC,gCAAgC,OAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,OACtBC,mBAAmB,OACnBC,kBAAkB,qBAClBC,+BAA+B,WAC/BC,mBAAmB,OACnBC,mBAAmB,YAEnBC,cAAc,SACdC,cAAc,UACdC,iBAAiB,cACjBC,eAAe,YACfC,gBAAgB,UAChBC,eAAe,UACfC,eAAe,SACfC,iBAAiB,OACjBC,kBAAkB,SAClBC,mBAAmB,OACnBC,kBAAkB,OAClBC,gBAAgB,cAChBC,aAAa,SAEbC,qBAAqB,CAAC,SAAS,UAAU,QAAQ,SAAS,QAAQ,SAAS,SAAS,SAAS,UAAU,UAAU,UAAU,WAC3HC,mBAAmB,CAAC,SAAS,WAAW,YAAY,YAAY,UAAU,UAAU,OAAA,EAAA,EAAA,GCzFvEC,KAAA,EACdn4C,MAAM,EACLmsB,YAAY,CAAC,YAAY,QAAQ,WAAW,YAAY,OAAO,WAAW,UAAU,WAAW,YAAY,cAAc,YAAY,SACrID,GAAAA,aAAa,CAAC,SAAS,OAAO,OAAO,QAAQ,OAAO,OAAO,OAAO,QAAQ,OAAO,QAAQ,QAAQ,MAAA,GACjG8B,UAAU,CAAE,WAAW,cAAc,WAAW,UAAU,UAAU,WAAW,QAC/EF,GAAAA,WAAW,CAAC,MAAM,MAAM,OAAO,MAAM,OAAO,MAAM,IAEnDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,SACtB8M,SAAS,SACTC,UAAU,WACVC,WAAW,SACXn6B,WAAW,gBACXo6B,WAAW,YACXC,aAAa,YACbC,cAAc,UACdC,WAAW,WACX5X,aAAa,YACb6X,iBAAiB,IACjBpY,kBAAkB,iDAClBqY,qBAAqB,YACrBC,cAAc,eACdjc,UAAU,eAEVkc,mBAAmB,oDACnBC,mBAAmB,cACnBC,kBAAkB,aAClBC,uBAAuB,YACvBC,oBAAoB,oBACpBC,wBAAwB,sBACxBC,sCAAsC,6BAGtC4C,YAAY,QACZp4C,MAAM,QACNq4C,aAAa,YAGbC,UAAU,OAGVC,iBAAiB,QAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,SAClBC,mBAAmB,WACnBC,oBAAoB,SACpBC,mBAAmB,OACnBC,uBAAuB,SACvBC,uBAAuB,SACvBC,wBAAwB,wBACxBC,aAAa,oBACbC,wBAAwB,WACxBC,yBAAyB,aACzBC,0BAA0B,IAC1BC,uBAAuB,kBACvBC,yBAAyB,UACzBC,iCAAiC,UACjCC,gCAAgC,SAChCC,mBAAmB,IACnBC,kBAAkB,IAClBC,sBAAsB,SACtBC,mBAAmB,IACnBC,kBAAkB,uBAClBC,+BAA+B,YAC/BC,mBAAmB,IACnBC,mBAAmB,OAEnBC,cAAc,UACdC,cAAc,eACdC,iBAAiB,wBACjBC,eAAe,iBACfC,gBAAgB,eAChBC,eAAe,aACfC,eAAe,gBACfC,iBAAiB,SACjBC,kBAAkB,WAClBC,mBAAmB,SACnBC,kBAAkB,OAClBC,gBAAgB,WAChBC,aAAa,gBAEbC,qBAAqB,CAAC,YAAY,UAAU,YAAY,aAAa,OAAO,WAAW,UAAU,UAAU,WAAW,eAAe,aAAa,QAAA,GAClJC,mBAAmB,CAAC,WAAW,cAAc,WAAW,UAAU,UAAU,WAAW,QCvG1EM,EAAAA,EAAAA,GAAAA,KAAA,EACdx4C,MAAM,EACLmsB,YAAY,CAAC,SAAS,UAAU,QAAQ,SAAS,QAAQ,QAAQ,UAAU,SAAS,YAAY,WAAW,YAAY,UACvHD,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,YAAY,WAAW,WAAW,YAAY,UAAU,aAAa,UAChFF,GAAAA,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,SAEjDoL,QAAQ,EACPwO,sBAAsB,OACtB8M,SAAS,OACTC,UAAU,WACVC,WAAW,OACXn6B,WAAW,oBACXo6B,WAAW,WACXC,aAAa,cACbC,cAAc,WACdC,WAAW,UACX5X,aAAa,YACb6X,iBAAiB,IACjBpY,kBAAkB,0DAClBqY,qBAAqB,cACrBC,cAAc,oBACdjc,UAAU,cAEVkc,mBAAmB,2DACnBC,mBAAmB,6BACnBC,kBAAkB,WAClBC,uBAAuB,UACvBC,oBAAoB,cACpBC,wBAAwB,mBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,QACNq4C,aAAa,cAGbC,UAAU,OAGVC,iBAAiB,UAGjB9C,UAAU,SAGVhR,gBAAgB,kBAChBC,cAAc,gBAGd6G,YAAY,MACZC,gBAAgB,UAGhBjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAM,QACNC,QAAQ,UAGRC,kBAAkB,SAClBC,mBAAmB,YACnBC,oBAAoB,WACpBC,mBAAmB,SACnBC,uBAAuB,QACvBC,uBAAuB,OACvBC,wBAAwB,sBACxBC,aAAa,iBACbC,wBAAwB,8BACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,YACvBC,yBAAyB,OACzBC,iCAAiC,QACjCC,gCAAgC,OAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,OACtBC,mBAAmB,OACnBC,kBAAkB,8BAClBC,+BAA+B,eAC/BC,mBAAmB,WACnBC,mBAAmB,iBAEnBC,cAAc,OACdC,cAAc,YACdC,iBAAiB,sBACjBC,eAAe,gBACfC,gBAAgB,YAChBC,eAAe,YACfC,eAAe,iBACfC,iBAAiB,OACjBC,kBAAkB,WAClBC,mBAAmB,OACnBC,kBAAkB,OAClBC,gBAAgB,cAChBC,aAAa,aAEbC,qBAAqB,CAAC,SAAS,UAAU,QAAQ,SAAS,QAAQ,QAAQ,UAAU,SAAS,YAAY,WAAW,YAAY,aAChIC,mBAAmB,CAAC,YAAY,WAAW,WAAW,YAAY,UAAU,aAAa,UCnG5EO,EAAAA,EAAAA,GAAAA,KAAA,EACdz4C,MAAM,EACLmsB,YAAY,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAO,KAAA,GAChFD,aAAa,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAO,OAAO,QAClF8B,UAAU,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GACrDF,WAAW,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAAA,EAAA,GAE3CoL,QAAQ,EACPwO,sBAAsB,MACtB8M,SAAS,KACTC,UAAU,KACVC,WAAW,KACXn6B,WAAW,QACXo6B,WAAW,MACXC,aAAa,MACbC,cAAc,MACdC,WAAW,MACX5X,aAAa,MACb6X,iBAAiB,cACjBpY,kBAAkB,WAClBqY,qBAAqB,MACrBC,cAAc,QACdjc,UAAU,MAEVkc,mBAAkB,mBAClBC,mBAAkB,QAClBC,kBAAiB,MACjBC,uBAAsB,MACtBC,oBAAoB,QACpBC,wBAAwB,QACxBC,sCAAsC,6BAGtC4C,YAAW,MACXp4C,MAAK,MACLq4C,aAAY,MAGZC,UAAS,MAGTC,iBAAiB,MAGjB9C,UAAS,MAGThR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,MAClBC,mBAAmB,MACnBC,oBAAoB,MACpBC,mBAAmB,MACnBC,uBAAuB,KACvBC,uBAAuB,KACvBC,wBAAwB,SACxBC,aAAa,SACbC,wBAAwB,QACxBC,yBAAyB,MACzBC,0BAA0B,KAC1BC,uBAAuB,OACvBC,yBAAyB,KACzBC,iCAAiC,KACjCC,gCAAgC,KAChCC,mBAAmB,KACnBC,kBAAkB,KAClBC,sBAAsB,KACtBC,mBAAmB,KACnBC,kBAAkB,SAClBC,+BAA+B,OAC/BC,mBAAmB,MACnBC,mBAAmB,OAEnBC,cAAc,MACdC,cAAc,MACdC,iBAAiB,SACjBC,eAAe,MACfC,gBAAgB,MAChBC,eAAe,MACfC,eAAe,OACfC,iBAAiB,KACjBC,kBAAkB,KAClBC,mBAAmB,KACnBC,kBAAkB,KAClBC,gBAAgB,OAChBC,aAAa,MAEbC,qBAAqB,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAO,KAAA,GACzFC,mBAAmB,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,EAAA,EAAA,GC9GjDQ,KAAA,EACd14C,MAAM,EACLmsB,YAAY,CAAC,SAAS,QAAQ,UAAU,SAAS,UAAU,UAAU,YAAY,SAAS,QAAQ,SAAS,YAAY,UACvHD,GAAAA,aAAa,CAAC,OAAO,MAAM,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAAQ,OAAO,QAAQ,KAAA,GAC5F8B,UAAU,CAAC,UAAU,WAAW,SAAS,UAAU,WAAW,SAAS,QACvEF,GAAAA,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,SAEjDoL,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,SACVC,WAAW,SACXn6B,WAAW,gBACXo6B,WAAW,UACXC,aAAa,QACbC,cAAc,UACdC,WAAW,UACX5X,aAAa,UACb6X,iBAAiB,IACjBpY,kBAAkB,yCAClBqY,qBAAqB,YACrBC,cAAc,kBAGdC,mBAAmB,uDACnBC,mBAAmB,sBACnBC,kBAAkB,WAClBC,uBAAuB,WACvBC,oBAAoB,eACpBC,wBAAwB,oBACxBC,sCAAsC,6BAGtC4C,YAAY,WACZp4C,MAAM,SACNq4C,aAAa,YAGbC,UAAU,OACVtf,UAAU,YAGVuf,iBAAiB,WAGjB9C,UAAU,UAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,SAClBC,mBAAmB,SACnBC,oBAAoB,WACpBC,mBAAmB,SACnBC,uBAAuB,SACvBC,uBAAuB,OACvBC,wBAAwB,gBACxBC,aAAa,mBACbC,wBAAwB,aACxBC,yBAAyB,aACzBC,0BAA0B,MAC1BC,uBAAuB,eACvBC,yBAAyB,SACzBC,iCAAiC,SACjCC,gCAAgC,SAChCC,mBAAmB,MACnBC,kBAAkB,KAClBC,sBAAsB,SACtBC,mBAAmB,IACnBC,kBAAkB,qBAClBC,+BAA+B,YAC/BC,mBAAmB,MACnBC,mBAAmB,SAEnBC,cAAc,SACdC,cAAc,aACdC,iBAAiB,sBACjBC,eAAe,eACfC,gBAAgB,eAChBC,eAAe,aACfC,eAAe,WACfC,iBAAiB,OACjBC,kBAAkB,SAClBC,mBAAmB,SACnBC,kBAAkB,OAClBC,gBAAgB,YAChBC,aAAa,SAEbC,qBAAqB,CAAC,SAAS,QAAQ,UAAU,SAAS,UAAU,UAAU,YAAY,SAAS,QAAQ,SAAS,YAAY,UAChIC,GAAAA,mBAAmB,CAAC,WAAW,WAAW,SAAS,UAAU,WAAW,SAAS,QCxGpES,EAAAA,EAAAA,GAAAA,KAAA,EACd34C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,SAAS,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,UAAA,GACzHD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAC3F8B,UAAU,CAAC,UAAU,UAAU,WAAW,UAAU,WAAW,UAAU,QACzEF,GAAAA,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,EAAA,GAEvDoL,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,OACVC,WAAW,SACXn6B,WAAW,iBACXo6B,WAAW,OACXC,aAAa,WACbC,cAAc,YACdC,WAAW,UACX5X,aAAa,QACb6X,iBAAiB,8CACjBpY,kBAAkB,2DAClBqY,qBAAqB,eACrBC,cAAc,eAGdC,mBAAmB,yDACnBC,mBAAmB,qBACnBC,kBAAkB,aAClBC,uBAAuB,aACvBC,oBAAoB,kBACpBC,wBAAwB,mBACxBC,sCAAsC,6BAGtC4C,YAAY,aACZp4C,MAAM,QACNq4C,aAAa,eAGbC,UAAU,MAGVC,iBAAiB,aAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,WACnBC,oBAAoB,YACpBC,mBAAmB,SACnBC,uBAAuB,QACvBC,uBAAuB,OACvBC,wBAAwB,sBACxBC,aAAa,sBACbC,wBAAwB,yBACxBC,yBAAyB,YACzBC,0BAA0B,OAC1BC,uBAAuB,WACvBC,yBAAyB,SACzBC,iCAAiC,QACjCC,gCAAgC,SAChCC,mBAAmB,OACnBC,kBAAkB,KAClBC,sBAAsB,SACtBC,mBAAmB,IACnBC,kBAAkB,kBAClBC,+BAA+B,cAC/BC,mBAAmB,SACnBC,mBAAmB,QAEnBC,cAAc,UACdC,cAAc,YACdC,iBAAiB,gBACjBC,eAAe,YACfC,gBAAgB,cAChBC,eAAe,YACfC,eAAe,mBACfC,iBAAiB,OACjBC,kBAAkB,OAClBC,mBAAmB,SACnBC,kBAAkB,MAClBC,gBAAgB,WAChBC,aAAa,WAEbC,qBAAqB,CAAC,UAAU,WAAW,QAAQ,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,UACjIC,GAAAA,mBAAmB,CAAC,UAAU,UAAU,WAAW,UAAU,WAAW,UAAU,QAAA,EAAA,EAAA,GCvGrEU,KAAA,EACd54C,MAAM,EACLmsB,YAAY,CAAC,WAAW,YAAY,UAAU,UAAU,QAAQ,SAAS,SAAS,WAAW,eAAe,YAAY,cAAc,WAAA,GACtID,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAC3F8B,UAAU,CAAE,WAAW,UAAU,YAAY,aAAa,eAAe,WAAW,SAAA,GACpFF,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAAA,EAAA,GAEjDoL,QAAQ,EACPwO,sBAAsB,SACtB8M,SAAS,OACTC,UAAU,SACVC,WAAW,SACXn6B,WAAW,iBACXo6B,WAAW,aACXC,aAAa,aACbC,cAAc,WACdC,WAAW,UACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,6BAClBqY,qBAAqB,gBACrBC,cAAc,cACdjc,UAAU,cAEVkc,mBAAmB,0EACnBC,mBAAmB,gBACnBC,kBAAkB,OAClBC,uBAAuB,MACvBC,oBAAoB,4BACpBC,wBAAwB,6BACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,SACNq4C,aAAa,gBAGbC,UAAU,SAGVC,iBAAiB,UAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,WAClBC,mBAAmB,eACnBC,oBAAoB,aACpBC,mBAAmB,YACnBC,uBAAuB,SACvBC,uBAAuB,OACvBC,wBAAwB,uBACxBC,aAAa,yBACbC,wBAAwB,aACxBC,yBAAyB,YACzBC,0BAA0B,MAC1BC,uBAAuB,mBACvBC,yBAAyB,UACzBC,iCAAiC,SACjCC,gCAAgC,UAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,UACtBC,mBAAmB,IACnBC,kBAAkB,iBAClBC,+BAA+B,eAC/BE,mBAAmB,UACnBD,mBAAmB,QAEnBE,cAAc,OACdC,cAAc,aACdC,iBAAiB,iBACjBC,eAAe,cACfC,gBAAgB,eAChBC,eAAe,cACfC,eAAe,qBACfC,iBAAiB,OACjBC,kBAAkB,SAClBC,mBAAmB,SACnBC,kBAAkB,QAClBC,gBAAgB,YAChBC,aAAa,SAEbC,qBAAqB,CAAC,UAAU,WAAW,QAAQ,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,aACjIC,mBAAmB,CAAC,WAAW,UAAU,YAAY,YAAY,cAAc,WAAW,SAAA,EAAA,EAAA,GCvG7Eh1B,KAAA,EACdljB,MAAM,EACLmsB,YAAY,CAAC,cAAc,eAAe,WAAW,YAAY,SAAS,WAAW,WAAW,aAAa,eAAe,aAAa,aAAa,YACtJD,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,QAAQ,QAAQ,OAAO,OAAO,OAAO,OAAO,KAAA,GAC7F8B,UAAU,CAAC,WAAW,WAAW,SAAS,WAAW,UAAU,aAAa,SAC5EF,GAAAA,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAEjDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,UACtB8M,SAAS,SACTC,UAAU,YACVC,WAAW,SACXn6B,WAAW,YACXo6B,WAAW,cACXC,aAAa,SACbC,cAAc,gBACdC,WAAW,eACX5X,aAAa,YACb6X,iBAAiB,IACjBpY,kBAAkB,wDAClBqY,qBAAqB,aACrBC,cAAc,oBACdjc,UAAU,gBAGVkc,mBAAmB,4EACnBC,mBAAmB,yBACnBC,kBAAkB,YAClBC,uBAAuB,UACvBC,oBAAoB,2BACpBC,wBAAwB,6BACxBC,sCAAsC,6BAGtC4C,YAAY,oBACZp4C,MAAM,cACNq4C,aAAa,aAGbC,UAAU,QAGVC,iBAAiB,oBAGjB9C,UAAU,UAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,aAClBC,mBAAmB,gBACnBC,oBAAoB,YACpBC,mBAAmB,WACnBC,uBAAuB,QACvBC,uBAAuB,SACvBC,wBAAwB,iBACxBC,aAAa,mBACbC,wBAAwB,iCACxBC,yBAAyB,aACzBC,0BAA0B,OAC1BC,uBAAuB,cACvBC,yBAAyB,QACzBC,iCAAiC,QACjCC,gCAAgC,QAChCC,mBAAmB,OACnBC,kBAAkB,OAClBC,sBAAsB,SACtBC,mBAAmB,QACnBC,kBAAkB,2BAClBC,+BAA+B,eAC/BE,mBAAmB,aACnBD,mBAAmB,YAEnBE,cAAc,QACdC,cAAc,aACdC,iBAAiB,sBACjBC,eAAe,iBACfC,gBAAgB,aAChBC,eAAe,cACfC,eAAe,iBACfC,iBAAiB,SACjBC,kBAAkB,YAClBC,mBAAmB,SACnBC,kBAAkB,UAClBC,gBAAgB,iBAChBC,aAAa,SAEbC,qBAAqB,CAAC,cAAc,eAAe,WAAW,YAAY,SAAS,WAAW,WAAW,aAAa,eAAe,aAAa,aAAa,YAAA,GAC/JC,mBAAmB,CAAC,WAAW,WAAW,SAAS,WAAW,UAAU,aAAa,SAAA,EAAA,EAAA,GCxGxEW,KAAA,EACd74C,MAAK,EACJmsB,YAAW,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,aAC1HD,aAAY,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC1F8B,GAAAA,UAAS,CAAC,UAAU,UAAU,WAAW,aAAa,YAAY,UAAU,UAAA,GAC5EF,WAAU,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,UAEtDoL,QAAO,EACNwO,sBAAqB,SACrB8M,SAAQ,OACRC,UAAS,QACTC,WAAU,SACVn6B,WAAU,aACVo6B,WAAU,QACVC,aAAY,UACZC,cAAa,WACbC,WAAU,QACV5X,aAAY,UACZ6X,iBAAgB,IAChBpY,kBAAiB,oDACjBqY,qBAAoB,eACpBC,cAAa,eACbjc,UAAS,YAGTkc,mBAAkB,wBAClBC,mBAAkB,gBAClBC,kBAAiB,YACjBC,uBAAsB,WACtBC,oBAAoB,cACpBC,wBAAwB,cACxBC,sCAAsC,6BAGtC4C,YAAW,UACXp4C,MAAK,QACLq4C,aAAY,eAGZC,UAAS,QAGTC,iBAAiB,UAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,SAClBC,mBAAmB,UACnBC,oBAAoB,WACpBC,mBAAmB,UACnBC,uBAAuB,SACvBC,uBAAuB,OACvBC,wBAAwB,iBACxBC,aAAa,iBACbC,wBAAwB,mBACxBC,yBAAyB,UACzBC,0BAA0B,MAC1BC,uBAAuB,aACvBC,yBAAyB,SACzBC,iCAAiC,SACjCC,gCAAgC,SAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,OACtBC,mBAAmB,SACnBC,kBAAkB,eAClBC,+BAA+B,eAC/BC,mBAAmB,SACnBC,mBAAmB,UAEnBC,cAAc,SACdC,cAAc,aACdC,iBAAiB,iBACjBC,eAAe,cACfC,gBAAgB,eAChBC,eAAe,cACfC,eAAe,UACfC,iBAAiB,OACjBC,kBAAkB,QAClBC,mBAAmB,SACnBC,kBAAkB,QAClBC,gBAAgB,WAChBC,aAAa,QAEbC,qBAAqB,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,UACpIC,GAAAA,mBAAmB,CAAC,UAAU,UAAU,WAAW,aAAa,YAAY,UAAU,iBCrGzEY,KAAA,EACd94C,MAAM,EACLmsB,YAAY,CAAC,SAAS,WAAW,SAAS,SAAS,QAAQ,SAAS,SAAS,UAAU,cAAc,WAAW,aAAa,WAAA,GAC7HD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAC3F8B,UAAU,CAAC,WAAW,SAAS,UAAU,aAAa,UAAU,WAAW,QAAA,GAC3EF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,OACtB8M,SAAS,OACTC,UAAU,UACVC,WAAW,OACXn6B,WAAW,gBACXo6B,WAAW,WACXC,aAAa,YACbC,cAAc,YACdC,WAAW,UACX5X,aAAa,YACb6X,iBAAiB,IACjBpY,kBAAkB,qDAClBqY,qBAAqB,eACrBC,cAAc,WACdjc,UAAU,eAEVkc,mBAAmB,sDACnBC,mBAAmB,oBACnBC,kBAAkB,YAClBC,uBAAuB,aACvBC,oBAAoB,mBACpBC,wBAAwB,sBACxBC,sCAAsC,6BAGtC4C,YAAY,OACZp4C,MAAM,SACNq4C,aAAa,eAGbC,UAAU,OAGVC,iBAAiB,OAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,eAClBC,mBAAmB,gBACnBC,oBAAoB,gBACpBC,mBAAmB,cACnBC,uBAAuB,QACvBC,uBAAuB,OACvBC,wBAAwB,2BACxBC,aAAa,iBACbC,wBAAwB,WACxBC,yBAAyB,UACzBC,0BAA0B,MAC1BC,uBAAuB,aACvBC,yBAAyB,OACzBC,iCAAiC,QACjCC,gCAAgC,OAChCC,mBAAmB,MACnBC,kBAAkB,OAClBC,sBAAsB,OACtBC,mBAAmB,OACnBC,kBAAkB,6BAClBC,+BAA+B,eAC/BE,mBAAmB,OACnBD,mBAAmB,cAEnBE,cAAc,SACdC,cAAc,YACdC,iBAAiB,sBACjBC,eAAe,eACfC,gBAAgB,YAChBC,eAAe,YACfC,eAAe,iBACfC,iBAAiB,OACjBC,kBAAkB,UAClBC,mBAAmB,OACnBC,kBAAkB,OAClBC,gBAAgB,eAChBC,aAAa,WAEbC,qBAAqB,CAAC,SAAS,WAAW,SAAS,SAAS,QAAQ,SAAS,SAAS,UAAU,aAAa,WAAW,aAAa,WACrIC,GAAAA,mBAAmB,CAAC,WAAW,SAAS,UAAU,aAAa,UAAU,WAAW,QAAA,EAAA,EAAA,GC1GvEa,KAAA,EACd/4C,MAAM,EACLmsB,YAAY,CAAC,YAAY,YAAY,aAAa,YAAY,YAAY,gBAAgB,iBAAiB,UAAU,WAAW,WAAW,aAAa,UAAA,GACxJD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,aAAa,aAAa,WAAW,eAAe,WAAW,aAAa,UACvFF,GAAAA,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,SAEjDoL,QAAQ,EACPwO,sBAAsB,UACtB8M,SAAS,SACTC,UAAU,UACVC,WAAW,YACXn6B,WAAW,kBACXo6B,WAAW,YACXC,aAAa,QACbC,cAAc,UACdC,WAAW,WACX5X,aAAa,UACb6X,iBAAiB,IACjBpY,kBAAkB,yCAClBqY,qBAAqB,UACrBC,cAAc,aACdjc,UAAU,cAEVkc,mBAAmB,mEACnBC,mBAAmB,oBACnBC,kBAAkB,8BAClBC,uBAAuB,2BACvBC,oBAAoB,iBACpBC,wBAAwB,iBACxBC,sCAAsC,6BAGtC4C,YAAY,eACZp4C,MAAM,cACNq4C,aAAa,UAGbC,UAAU,UAGVC,iBAAiB,eAGjB9C,UAAU,UAGVhR,gBAAe,sBACfC,cAAa,oBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,wBAClBC,mBAAmB,eACnBC,oBAAoB,iBACpBC,mBAAmB,cACnBC,uBAAuB,QACvBC,uBAAuB,mBACvBC,wBAAwB,4BACxBC,aAAa,eACbC,wBAAwB,6CACxBC,yBAAyB,UACzBC,0BAA0B,IAC1BC,uBAAuB,+BACvBC,yBAAyB,YACzBC,iCAAiC,QACjCC,gCAAgC,YAChCC,mBAAmB,IACnBC,kBAAkB,IAClBC,sBAAsB,mBACtBC,mBAAmB,YACnBC,kBAAkB,oBAClBC,+BAA+B,wBAC/BE,mBAAmB,UACnBD,mBAAmB,IAEnBE,cAAc,cACdC,cAAc,cACdC,iBAAiB,kBACjBC,eAAe,eACfC,gBAAgB,iBAChBC,eAAe,cACfC,eAAe,cACfC,iBAAiB,SACjBC,kBAAkB,UAClBC,mBAAmB,YACnBC,kBAAkB,SAClBC,gBAAgB,oBAChBC,aAAa,WAEbC,qBAAqB,CAAC,YAAY,YAAY,aAAa,YAAY,YAAY,gBAAgB,iBAAiB,UAAU,WAAW,WAAW,aAAa,UAAA,GACjKC,mBAAmB,CAAC,aAAa,aAAa,WAAW,eAAe,WAAW,aAAa,UCvGnFc,EAAAA,EAAAA,GAAAA,KAAA,EACdh5C,MAAM,EACLmsB,YAAY,CAAC,WAAW,WAAW,QAAQ,SAAS,OAAO,QAAQ,WAAW,QAAQ,aAAa,WAAW,YAAY,aAC1HD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,QAAQ,QAAQ,OAAO,OAAO,OAAO,OAAO,KAC7F8B,GAAAA,UAAU,CAAC,YAAY,SAAS,SAAS,YAAY,SAAS,YAAY,WAC1EF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,eACtB8M,SAAS,QACTC,UAAU,WACVC,WAAW,QACXn6B,WAAW,oBACXo6B,WAAW,eACXC,aAAa,WACbC,cAAc,WACdC,WAAW,YACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,uDAClBqY,qBAAqB,eACrBC,cAAc,WACdjc,UAAU,oBAEVkc,mBAAmB,4DACnBC,mBAAmB,eACnBC,kBAAkB,aAClBC,uBAAuB,UACvBC,oBAAoB,qBACpBC,wBAAwB,sBACxBC,sCAAsC,6BAGtC4C,YAAY,QACZp4C,MAAM,QACNq4C,aAAa,eAGbC,UAAU,SAGVC,iBAAiB,QAGjB9C,UAAU,UAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,eAClBC,mBAAmB,gBACnBC,oBAAoB,aACpBC,mBAAmB,YACnBC,uBAAuB,UACvBC,uBAAuB,QACvBC,wBAAwB,6BACxBC,aAAa,uBACbC,wBAAwB,YACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,eACvBC,yBAAyB,QACzBC,iCAAiC,UACjCC,gCAAgC,QAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,QACtBC,mBAAmB,QACnBC,kBAAkB,iCAClBC,+BAA+B,eAC/BE,mBAAmB,OACnBD,mBAAmB,SAEnBE,cAAc,UACdC,cAAc,eACdC,iBAAiB,wBACjBC,eAAe,kBACfC,gBAAgB,eAChBC,eAAe,gBACfC,eAAe,gBACfC,iBAAiB,QACjBC,kBAAkB,WAClBC,mBAAmB,QACnBC,kBAAkB,SAClBC,gBAAgB,aAChBC,aAAa,cAEbC,qBAAqB,CAAC,WAAW,WAAW,QAAQ,SAAS,OAAO,QAAQ,WAAW,QAAQ,aAAa,WAAW,YAAY,UACnIC,GAAAA,mBAAmB,CAAC,YAAY,SAAS,SAAS,YAAY,SAAS,YAAY,eCvGtEe,KAAA,EACdj5C,MAAM,EACLmsB,YAAY,CAAC,SAAS,UAAU,OAAO,SAAS,OAAO,QAAQ,QAAQ,UAAU,UAAU,WAAW,UAAU,OAAA,GAChHD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,SAAS,OAAO,SAAS,SAAS,SAAS,QAAQ,KAAA,GAC9DF,WAAW,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAE3CoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,QACVC,WAAW,QACXn6B,WAAW,YACXo6B,WAAW,QACXC,aAAa,OACbC,cAAc,SACdC,WAAW,QACX5X,aAAa,OACb6X,iBAAiB,IACjBpY,kBAAkB,2BAClBqY,qBAAqB,SACrBC,cAAc,SAEdC,mBAAmB,4CACnBC,mBAAmB,eACnBC,kBAAkB,WAClBC,uBAAuB,QACvBrc,UAAU,WACVsc,oBAAoB,iBACpBC,wBAAwB,cACxBC,sCAAsC,6BAGtC4C,YAAY,WACZp4C,MAAM,SACNq4C,aAAa,SAGbC,UAAU,QAGVC,iBAAiB,WAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,kBAGb6G,YAAW,MACXC,gBAAe,OAGfjtB,MAAM,OACNm3B,MAAM,SACN7X,MAAM,OACND,OAAO,QACP3xB,KAAK,OACL0pC,MAAK,OACLC,QAAQ,OAGRC,kBAAkB,QAClBC,mBAAmB,SACnBC,oBAAoB,SACpBC,mBAAmB,QACnBC,uBAAuB,WACvBC,uBAAuB,QACvBC,wBAAwB,qBACxBC,aAAa,YACbC,wBAAwB,kBACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,WACvBC,yBAAyB,UACzBC,iCAAiC,WACjCC,gCAAgC,QAChCC,mBAAmB,MACnBC,kBAAkB,SAClBC,sBAAsB,QACtBC,mBAAmB,QACnBC,kBAAkB,mBAClBC,+BAA+B,WAC/BE,mBAAmB,YACnBD,mBAAmB,QAEnBE,cAAc,UACdC,cAAc,UACdC,iBAAiB,gBACjBC,eAAe,WACfC,gBAAgB,WAChBC,eAAe,UACfC,eAAe,eACfC,iBAAiB,OACjBC,kBAAkB,QAClBC,mBAAmB,QACnBC,kBAAkB,OAClBC,gBAAgB,UAChBC,aAAa,UAEbC,qBAAqB,CAAC,SAAS,UAAU,OAAO,SAAS,OAAO,QAAQ,QAAQ,UAAU,UAAU,WAAW,UAAU,OAAA,GACzHC,mBAAmB,CAAC,SAAS,OAAO,SAAS,SAAS,SAAS,QAAQ,KAAA,EAAA,EAAA,GCvG1DgB,KAAA,EACdl5C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,WAAW,WAAW,SAAS,UAAU,UAAU,aAAa,cAAc,WAAW,YAAY,aACvID,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,YAAY,SAAS,QAAQ,UAAU,aAAa,UAAU,SACzEF,GAAAA,WAAW,CAAC,MAAM,MAAM,MAAM,OAAO,OAAO,MAAM,KAEnDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,MACtB8M,SAAS,OACTC,UAAU,OACVC,WAAW,SACXn6B,WAAW,cACXo6B,WAAW,UACXC,aAAa,SACbC,cAAc,aACdC,WAAW,eACX5X,aAAa,UACb6X,iBAAiB,IACjBpY,kBAAkB,gDAClBqY,qBAAqB,UACrBC,cAAc,WACdjc,UAAU,eAGVkc,mBAAmB,yEACnBC,mBAAmB,qBACnBC,kBAAkB,UAClBC,uBAAuB,gBACvBC,oBAAoB,eACpBC,wBAAwB,uBACxBC,sCAAsC,6BAGtC4C,YAAY,YACZp4C,MAAM,SACNq4C,aAAa,UAGbC,UAAU,MAGV7T,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,QAClBC,mBAAmB,QACnBC,oBAAoB,QACpBC,mBAAmB,QACnBC,uBAAuB,UACvBC,uBAAuB,OACvBC,wBAAwB,mBACxBC,aAAa,yBACbC,wBAAwB,8BACxBC,yBAAyB,YACzBC,0BAA0B,SAC1BC,uBAAuB,cACvBC,yBAAyB,YACzBC,iCAAiC,UACjCC,gCAAgC,YAChCC,mBAAmB,SACnBC,kBAAkB,WAClBC,sBAAsB,OACtBC,mBAAmB,SACnBC,kBAAkB,0BAClBC,+BAA+B,WAC/BC,mBAAmB,QACnBC,mBAAmB,kBAEnBC,cAAc,QACdC,cAAc,cACdC,iBAAiB,mBACjBC,eAAe,gBACfC,gBAAgB,mBAChBC,eAAe,gBACfC,eAAe,UACfC,iBAAiB,OACjBC,kBAAkB,OAClBC,mBAAmB,SACnBC,kBAAkB,MAClBC,gBAAgB,iBAChBC,aAAa,eAEbC,qBAAqB,CAAC,UAAU,WAAW,WAAW,WAAW,SAAS,UAAU,UAAU,aAAa,cAAc,WAAW,YAAY,aAChJC,mBAAmB,CAAC,YAAY,SAAS,QAAQ,UAAU,aAAa,UAAU,SClGrEj3C,EAAAA,EAAAA,GAAAA,KAAA,EACdjB,MAAM,EACLmsB,YAAY,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,WAAW,aAAa,WAAW,YAAY,UAC5HD,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAC3F8B,UAAU,CAAC,UAAU,SAAS,UAAU,QAAQ,SAAS,SAAS,OAAA,GAClEF,WAAW,CAAC,QAAQ,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,EAAA,GAExDoL,QAAQ,EACPwO,sBAAsB,YACtB8M,SAAS,QACTC,UAAU,UACVC,WAAW,SACXn6B,WAAW,cACXo6B,WAAW,UACXC,aAAa,SACbC,cAAc,UACdC,WAAW,QACX5X,aAAa,SACb6X,iBAAiB,IACjBpY,kBAAkB,sBAClBqY,qBAAqB,cACrBC,cAAc,WACdjc,UAAU,cAGVkc,mBAAmB,mCACnBC,mBAAmB,eACnBC,kBAAkB,qBAClBC,uBAAuB,eACvBC,oBAAoB,iBACpBC,wBAAwB,oBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,WACNq4C,aAAa,cAGbC,UAAU,SAGVC,iBAAiB,UAGjB9C,UAAU,SAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,YACnBC,oBAAoB,WACpBC,mBAAmB,WACnBC,uBAAuB,UACvBC,uBAAuB,QACvBC,wBAAwB,qBACxBC,aAAa,kBACbC,wBAAwB,6BACxBC,yBAAyB,UACzBC,0BAA0B,QAC1BC,uBAAuB,eACvBC,yBAAyB,SACzBC,iCAAiC,UACjCC,gCAAgC,SAChCC,mBAAmB,QACnBC,kBAAkB,QAClBC,sBAAsB,QACtBC,mBAAmB,SACnBC,kBAAkB,uBAClBC,+BAA+B,YAC/BC,mBAAmB,WACnBC,mBAAmB,iBAEnBC,cAAc,gBACdC,cAAc,eACdC,iBAAiB,qBACjBC,eAAe,iBACfC,gBAAgB,gBAChBC,eAAe,gBACfC,eAAe,UACfC,iBAAiB,QACjBC,kBAAkB,UAClBC,mBAAmB,SACnBC,kBAAkB,SAClBC,gBAAgB,gBAChBC,aAAa,YAEbC,qBAAqB,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,WAAW,aAAa,WAAW,YAAY,aACrIC,mBAAmB,CAAC,UAAU,SAAS,UAAU,QAAQ,SAAS,SAAS,OAAA,EAAA,EAAA,GCxG9DiB,KAAA,EACdn5C,MAAM,EACLmsB,YAAY,CAAC,WAAW,YAAY,SAAS,UAAU,UAAU,UAAU,UAAU,UAAU,aAAa,WAAW,YAAY,UAAA,GACnID,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,YAAY,UAAU,WAAW,aAAa,WAAW,WAAW,QAAA,GAC/EF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,UACTC,UAAU,aACVC,WAAW,QACXn6B,WAAW,gBACXo6B,WAAW,SACXC,aAAa,UACbC,cAAc,YACdC,WAAW,YACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,0CAClBqY,qBAAqB,eACrBC,cAAc,oBACdjc,UAAU,mBAEVkc,mBAAmB,6CACnBC,mBAAmB,qBACnBC,kBAAkB,eAClBC,uBAAuB,YACvBC,oBAAoB,uBACpBC,wBAAwB,wBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,QACNq4C,aAAa,eAGbC,UAAU,QAGVC,iBAAiB,UAGjB9C,UAAU,WAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,cAClBC,mBAAmB,eACnBC,oBAAoB,WACpBC,mBAAmB,WACnBC,uBAAuB,QACvBC,uBAAuB,UACvBC,wBAAwB,4BACxBC,aAAa,kBACbC,wBAAwB,cACxBC,yBAAyB,YACzBC,0BAA0B,MAC1BC,uBAAuB,eACvBC,yBAAyB,QACzBC,iCAAiC,QACjCC,gCAAgC,QAChCC,mBAAmB,MACnBC,kBAAkB,OAClBC,sBAAsB,UACtBC,mBAAmB,QACnBC,kBAAkB,qBAClBC,+BAA+B,aAC/BE,mBAAmB,QACnBD,mBAAmB,QAEnBE,cAAc,OACdC,cAAc,eACdC,iBAAiB,uBACjBC,eAAe,kBACfC,gBAAgB,aAChBC,eAAe,aACfC,eAAe,kBACfC,iBAAiB,UACjBC,kBAAkB,aAClBC,mBAAmB,QACnBC,kBAAkB,QAClBC,gBAAgB,aAChBC,aAAa,WAEbC,qBAAqB,CAAC,WAAW,YAAY,SAAS,UAAU,UAAU,UAAU,UAAU,UAAU,aAAa,WAAW,YAAY,UAAA,GAC5IC,mBAAmB,CAAC,YAAY,UAAU,WAAW,aAAa,UAAU,WAAW,QAAA,EAAA,EAAA,GCpG1EkB,KAAA,EACdp5C,MAAM,EACLmsB,YAAY,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAO,OAAO,QACjFD,aAAa,CAAE,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAO,OAAO,KACnF8B,GAAAA,UAAU,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GACrDF,WAAW,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,QAE3CoL,QAAQ,EACPwO,sBAAsB,MACtB8M,SAAS,KACTC,UAAU,KACVC,WAAW,KACXn6B,WAAW,SACXo6B,WAAW,MACXC,aAAa,SACbC,cAAc,MACdC,WAAW,MACX5X,aAAa,MACb6X,iBAAiB,IACjBpY,kBAAkB,yBAClBqY,qBAAqB,YACrBC,cAAc,MACdC,mBAAmB,0BACnBC,mBAAmB,aACnBC,kBAAkB,MAClBC,uBAAuB,MACvBrc,UAAU,MACVsc,oBAAoB,cACpBC,wBAAwB,UACxBC,sCAAsC,6BAGtC4C,YAAY,OACZp4C,MAAM,MACNq4C,aAAa,MAGbC,UAAU,MAGVC,iBAAiB,OAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,MAClBC,mBAAmB,MACnBC,oBAAoB,MACpBC,mBAAmB,MACnBC,uBAAuB,KACvBC,uBAAuB,KACvBC,wBAAwB,QACxBC,aAAa,UACbC,wBAAwB,UACxBC,yBAAyB,QACzBC,0BAA0B,MAC1BC,uBAAuB,MACvBC,yBAAyB,KACzBC,iCAAiC,KACjCC,gCAAgC,KAChCC,mBAAmB,MACnBC,kBAAkB,KAClBC,sBAAsB,KACtBC,mBAAmB,KACnBC,kBAAkB,SAClBC,+BAA+B,MAC/BC,mBAAmB,KACnBC,mBAAmB,SAEnBC,cAAc,OACdC,cAAc,MACdC,iBAAiB,QACjBC,eAAe,MACfC,gBAAgB,MAChBC,eAAe,MACfC,eAAe,QACfC,iBAAiB,KACjBC,kBAAkB,KAClBC,mBAAmB,KACnBC,kBAAkB,KAClBC,gBAAgB,OAChBC,aAAa,MAEbC,qBAAqB,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,OAAO,OAAO,KAC1FC,GAAAA,mBAAmB,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO;ACzGjD,MAAMmB,GAAAA;AAAAA,EACpB,YAAY/6C,GAAAA;AACXgJ,SAAKgyC,WAAW;AAChB,eAAUp4C,KAAK5C;AACdgJ,WAAKgyC,SAASp4C,KAAK5C,EAAO4C,CAAAA;AAAAA,EAE3B;AAAA,EAED,UAAUqV,GAAMmV,GAAAA;AACfpkB,SAAKgyC,SAAS/iC,KAAQmV;AAAAA,EACtB;AAAA,EAED,UAAUnV,GAAAA;AACT,WAAOjP,KAAKgyC,SAAS/iC,CACrB;AAAA,EAAA;AAAA;ACdF,MAAegjC,KAAA,EACdv5C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,QAAQ,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,aACxHD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,UAAU,UAAU,WAAW,UAAU,WAAW,UAAU,WACzEF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,SACtB8M,SAAS,OACTC,UAAU,OACVC,WAAW,SACXn6B,WAAW,eACXo6B,WAAW,SACXC,aAAa,UACbC,cAAc,YACdC,WAAW,WACX5X,aAAa,SACb6X,iBAAiB,IACjBpY,kBAAkB,sDAClBqY,qBAAqB,eACrBC,cAAc,eAGdC,mBAAmB,+DACnBC,mBAAmB,qBACnBC,kBAAkB,MAClBC,uBAAuB,MACvBC,oBAAoB,kBACpBC,wBAAwB,oBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,QACNq4C,aAAa,eAGbC,UAAU,MAGVC,iBAAiB,UAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,YACnBC,oBAAoB,YACpBC,mBAAmB,SACnBC,uBAAuB,QACvBC,uBAAuB,OACvBC,wBAAwB,kBACxBC,aAAa,iBACbC,wBAAwB,WACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,YACvBC,yBAAyB,SACzBC,iCAAiC,QACjCC,gCAAgC,SAChCC,mBAAmB,MACnBC,kBAAkB,KAClBC,sBAAsB,SACtBC,mBAAmB,IACnBC,kBAAkB,mBAClBC,+BAA+B,aAC/BE,mBAAmB,YACnBD,mBAAmB,SAEnBE,cAAc,SACdC,cAAc,YACdC,iBAAiB,eACjBC,eAAe,YACfC,gBAAgB,cAChBC,eAAe,YACfC,eAAe,aACfC,iBAAiB,OACjBC,kBAAkB,OAClBC,mBAAmB,SACnBC,kBAAkB,MAClBC,gBAAgB,WAChBC,aAAa,WAEbC,qBAAqB,CAAC,UAAU,WAAW,QAAQ,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,UAAA,GACjIC,mBAAmB,CAAC,UAAU,UAAU,WAAW,UAAU,WAAW,UAAU,QCvGrEsB,EAAAA,EAAAA,GAAAA,KAAA,EACdx5C,MAAM,EACLmsB,YAAY,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,YAAY,aAAa,WAAW,YAAY,aAC7HD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GAC3F8B,UAAU,CAAC,UAAU,WAAW,WAAW,YAAY,aAAa,WAAW,UAC/EF,GAAAA,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,SAEjDoL,QAAQ,EACPwO,sBAAsB,WACtB8M,SAAS,OACTC,UAAU,QACVC,WAAW,SACXn6B,WAAW,cACXo6B,WAAW,WACXC,aAAa,aACbC,cAAc,WACdC,WAAW,YACX5X,aAAa,eACb6X,iBAAiB,IACjBpY,kBAAkB,mDAClBqY,qBAAqB,gBACrBC,cAAc,gBACdjc,UAAU,YAEVkc,mBAAmB,6CACnBC,mBAAmB,iBACnBC,kBAAkB,OAClBC,uBAAuB,OACvBC,oBAAoB,mBACpBC,wBAAwB,oBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,SACNq4C,aAAa,gBAGbC,UAAU,QAGVC,iBAAiB,UAGjB9C,UAAU,SAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,aAClBC,mBAAmB,aACnBC,oBAAoB,eACpBC,mBAAmB,aACnBC,uBAAuB,QACvBC,uBAAuB,WACvBC,wBAAwB,gBACxBC,aAAa,iBACbC,wBAAwB,8BACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,cACvBC,yBAAyB,WACzBC,iCAAiC,UACjCC,gCAAgC,WAChCC,mBAAmB,MACnBC,kBAAkB,OAClBC,sBAAsB,OACtBC,mBAAmB,SACnBC,kBAAkB,mBAClBC,+BAA+B,SAC/BE,mBAAmB,eACnBD,mBAAmB,MAEnBE,cAAc,SACdC,cAAc,YACdC,iBAAiB,gBACjBC,eAAe,aACfC,gBAAgB,cAChBC,eAAe,YACfC,eAAe,aACfC,iBAAiB,OACjBC,kBAAkB,QAClBC,mBAAmB,SACnBC,kBAAkB,QAClBC,gBAAgB,YAChBC,aAAa,WAEbC,qBAAqB,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,YAAY,aAAa,WAAW,YAAY,UACtIC,GAAAA,mBAAmB,CAAC,UAAU,WAAW,WAAW,YAAY,aAAa,WAAW,UCvG3EuB,EAAAA,EAAAA,GAAAA,KAAA,EACdz5C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,QAAQ,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,UAAA,GACxHD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAC3F8B,UAAU,CAAC,UAAU,UAAU,WAAW,UAAU,WAAW,UAAU,QACzEF,GAAAA,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,EAAA,GAEvDoL,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,OACVC,WAAW,SACXn6B,WAAW,MACXo6B,WAAW,SACXC,aAAa,UACbC,cAAc,YACdC,WAAW,SACX5X,aAAa,SACb6X,iBAAiB,6CACjBpY,kBAAkB,8CAClBqY,qBAAqB,eACrBC,cAAc,eACdjc,UAAU,YAGVkc,mBAAmB,yDACnBC,mBAAmB,yBACnBC,kBAAkB,cAClBC,uBAAuB,SACvBC,oBAAoB,kBACpBC,wBAAwB,oBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,QACNq4C,aAAa,eAGbC,UAAU,MAGVC,iBAAiB,UAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,YACnBC,oBAAoB,YACpBC,mBAAmB,SACnBC,uBAAuB,QACvBC,uBAAuB,OACvBC,wBAAwB,mBACxBC,aAAa,gBACbC,wBAAwB,oBACxBC,yBAAyB,UACzBC,0BAA0B,MAC1BC,uBAAuB,YACvBC,yBAAyB,SACzBC,iCAAiC,QACjCC,gCAAgC,SAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,OACtBC,mBAAmB,SACnBC,kBAAkB,mBAClBC,+BAA+B,eAC/BC,mBAAmB,SACnBC,mBAAmB,eAEnBC,cAAc,SACdC,cAAc,YACdC,iBAAiB,eACjBC,eAAe,YACfC,gBAAgB,cAChBC,eAAe,YACfC,eAAe,aACfC,iBAAiB,OACjBC,kBAAkB,OAClBC,mBAAmB,SACnBC,kBAAkB,MAClBC,gBAAgB,WAChBC,aAAa,WAEbC,qBAAqB,CAAC,UAAU,WAAW,QAAQ,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,aACjIC,mBAAmB,CAAC,UAAU,UAAU,WAAW,UAAU,WAAW,UAAU,QAAA,EAAA,EAAA,GCxGrEwB,KAAA,EACd15C,MAAM,EACLmsB,YAAY,CAAC,WAAW,QAAQ,UAAU,YAAY,OAAO,YAAY,UAAU,YAAY,YAAY,eAAe,YAAY,UACtID,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GAC3F8B,UAAU,CAAC,aAAa,gBAAgB,UAAU,SAAS,YAAY,UAAU,QACjFF,GAAAA,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,EAAA,GAEvDoL,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,SACTC,UAAU,WACVC,WAAW,WACXn6B,WAAW,kBACXo6B,WAAW,UACXC,aAAa,UACbC,cAAc,aACdC,WAAW,UACX5X,aAAa,QACb6X,iBAAiB,IACjBpY,kBAAkB,uDAClBqY,qBAAqB,QACrBC,cAAc,eACdjc,UAAU,cAGVkc,mBAAmB,8DACnBC,mBAAmB,qBACnBC,kBAAkB,cAClBC,uBAAuB,WACvBC,oBAAoB,gBACpBC,wBAAwB,gBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,QACNq4C,aAAa,QAGbC,UAAU,OAGVC,iBAAiB,UAGjB9C,UAAU,UAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,cAClBC,mBAAmB,aACnBC,oBAAoB,aACpBC,mBAAmB,UACnBC,uBAAuB,UACvBC,uBAAuB,QACvBC,wBAAwB,yBACxBC,aAAa,qBACbC,wBAAwB,mBACxBC,yBAAyB,UACzBC,0BAA0B,KAC1BC,uBAAuB,eACvBC,yBAAyB,WACzBC,iCAAiC,UACjCC,gCAAgC,WAChCC,mBAAmB,KACnBC,kBAAkB,WAClBC,sBAAsB,gBACtBC,mBAAmB,IACnBC,kBAAkB,oBAClBC,+BAA+B,kBAC/BE,mBAAmB,YACnBD,mBAAmB,MAEnBE,cAAc,SACdC,cAAc,cACdC,iBAAiB,uBACjBC,eAAe,cACfC,gBAAgB,cAChBC,eAAe,UACfC,eAAe,kBACfC,iBAAiB,SACjBC,kBAAkB,WAClBC,mBAAmB,WACnBC,kBAAkB,OAClBC,gBAAgB,UAChBC,aAAa,cAEbC,qBAAqB,CAAC,YAAY,UAAU,SAAS,YAAY,QAAQ,WAAW,SAAS,YAAY,WAAW,cAAc,aAAa,SAAA,GAC/IC,mBAAmB,CAAC,aAAa,eAAe,UAAU,QAAQ,YAAY,SAAS,QC9F1EyB,EAAAA,EAAAA,GAAAA,KAAA,EACd35C,MAAM,EACLmsB,YAAY,CAAC,WAAW,aAAa,SAAS,SAAS,QAAQ,SAAS,SAAS,UAAU,YAAY,WAAW,YAAY,UAC9HD,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GAC3F8B,UAAU,CAAC,WAAW,WAAW,SAAS,UAAU,UAAU,SAAS,WACvEF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,EAAA,GAEvDoL,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,UACVC,WAAW,OACXn6B,WAAW,eACXo6B,WAAW,UACXC,aAAa,YACbC,cAAc,YACdC,WAAW,UACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,mCAClBqY,qBAAqB,aACrBC,cAAc,oBACdjc,UAAU,eAEVkc,mBAAmB,gDACnBC,mBAAmB,kBACnBC,kBAAkB,eAClBC,uBAAuB,aACvBC,oBAAoB,kBACpBC,wBAAwB,oBACxBC,sCAAsC,6BAGtC4C,YAAY,OACZp4C,MAAM,QACNq4C,aAAa,aAGbC,UAAU,OAGVC,iBAAiB,OAGjB9C,UAAU,SAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,WACnBC,oBAAoB,UACpBC,mBAAmB,SACnBC,uBAAuB,QACvBC,uBAAuB,UACvBC,wBAAwB,wBACxBC,aAAa,gBACbC,wBAAwB,WACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,YACvBC,yBAAyB,OACzBC,iCAAiC,QACjCC,gCAAgC,OAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,OACtBC,mBAAmB,OACnBC,kBAAkB,kBAClBC,+BAA+B,eAC/BE,mBAAmB,OACnBD,mBAAmB,UAEnBE,cAAc,SACdC,cAAc,iBACdC,iBAAiB,uBACjBC,eAAe,eACfC,gBAAgB,YAChBC,eAAe,YACfC,eAAe,iBACfC,iBAAiB,OACjBC,kBAAkB,UAClBC,mBAAmB,OACnBC,kBAAkB,OAClBC,gBAAgB,WAChBC,aAAa,WAEbC,qBAAqB,CAAC,WAAW,aAAa,SAAS,SAAS,QAAQ,SAAS,SAAS,UAAU,YAAY,WAAW,YAAY,UACvIC,GAAAA,mBAAmB,CAAC,WAAW,WAAW,SAAS,UAAU,UAAU,SAAS,QAAA,EAAA,EAAA,GC7GnE0B,KAAA,EACd55C,MAAK,EACJmsB,YAAW,CAAC,YAAY,aAAa,UAAU,WAAW,OAAO,SAAS,SAAS,UAAU,cAAc,aAAa,YAAY,UAAA,GACpID,aAAY,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAC1F8B,UAAS,CAAC,YAAY,QAAQ,SAAS,YAAY,OAAO,UAAU,SAAA,GACpEF,WAAU,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAAA,EAAA,GAEhDoL,QAAO,EACNwO,sBAAqB,UACrB8M,SAAQ,MACRC,UAAS,aACTC,WAAU,QACVn6B,WAAU,iBACVo6B,WAAU,YACVC,aAAY,YACZC,cAAa,WACbC,WAAU,YACV5X,aAAY,UACZ6X,iBAAgB,8CAChBpY,kBAAiB,kDACjBqY,qBAAoB,aACpBC,cAAa,YACbjc,UAAS,cAGTkc,mBAAkB,uDAClBC,mBAAkB,YAClBC,kBAAiB,eACjBC,uBAAsB,YACtBC,oBAAoB,kBACpBC,wBAAwB,yBACxBC,sCAAsC,6BAGtC4C,YAAW,UACXp4C,MAAK,QACLq4C,aAAY,aAGZC,UAAS,MAGTC,iBAAiB,UAGjB9C,UAAU,SAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,cACnBC,oBAAoB,SACpBC,mBAAmB,SACnBC,uBAAuB,cACvBC,uBAAuB,UACvBC,wBAAwB,yBACxBC,aAAa,sBACbC,wBAAwB,kCACxBC,yBAAyB,aACzBC,0BAA0B,QAC1BC,uBAAuB,iBACvBC,yBAAyB,QACzBC,iCAAiC,cACjCC,gCAAgC,QAChCC,mBAAmB,MACnBC,kBAAkB,WAClBC,sBAAsB,cACtBC,mBAAmB,IACnBC,kBAAkB,wBAClBC,+BAA+B,cAC/BE,mBAAmB,WACnBD,mBAAmB,QAEnBE,cAAc,aACdC,cAAc,iBACdC,iBAAiB,4BACjBC,eAAe,wBACfC,gBAAgB,mBAChBC,eAAe,iBACfC,eAAe,gBACfC,iBAAiB,MACjBC,kBAAkB,aAClBC,mBAAmB,QACnBC,kBAAkB,MAClBC,gBAAgB,WAChBC,aAAa,cAEbC,qBAAqB,CAAC,YAAY,aAAa,UAAU,WAAW,OAAO,SAAS,SAAS,UAAU,cAAc,aAAa,aAAa,cAC/IC,mBAAmB,CAAC,YAAY,QAAQ,SAAS,YAAY,OAAO,UAAU,SAAA,EAAA,EAAA,GC5GjE2B,KAAA,EACd75C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,QAAQ,UAAU,OAAO,QAAQ,QAAQ,UAAU,YAAY,WAAW,UAAU,SACtHD,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GAC3F8B,UAAU,CAAE,eAAe,eAAe,WAAW,SAAS,WAAW,WAAW,SAAA,GACpFF,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAEjDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,WACtB8M,SAAS,QACTC,UAAU,UACVC,WAAW,SACXn6B,WAAW,iBACXo6B,WAAW,aACXC,aAAa,YACbC,cAAc,UACdC,WAAW,YACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,mDAClBqY,qBAAqB,YACrBC,cAAc,kBACdjc,UAAU,aAEVkc,mBAAmB,uDACnBC,mBAAmB,cACnBC,kBAAkB,aAClBC,uBAAuB,YACvBC,oBAAoB,uBACpBC,wBAAwB,2BACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,QACNq4C,aAAa,YAGbC,UAAU,OAGVC,iBAAiB,UAGjB9C,UAAU,WAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,QAClBC,mBAAmB,UACnBC,oBAAoB,SACpBC,mBAAmB,OACnBC,uBAAuB,UACvBC,uBAAuB,QACvBC,wBAAwB,uBACxBC,aAAa,qBACbC,wBAAwB,eACxBC,yBAAyB,aACzBC,0BAA0B,IAC1BC,uBAAuB,kBACvBC,yBAAyB,SACzBC,iCAAiC,WACjCC,gCAAgC,SAChCC,mBAAmB,IACnBC,kBAAkB,IAClBC,sBAAsB,QACtBC,mBAAmB,IACnBC,kBAAkB,sBAClBC,+BAA+B,cAC/BE,mBAAmB,OACnBD,mBAAmB,IAEnBE,cAAc,WACdC,cAAc,eACdC,iBAAiB,sBACjBC,eAAe,iBACfC,gBAAgB,gBAChBC,eAAe,cACfC,eAAe,aACfC,iBAAiB,QACjBC,kBAAkB,UAClBC,mBAAmB,SACnBC,kBAAkB,OAClBC,gBAAgB,UAChBC,aAAa,iBAEbC,qBAAqB,CAAC,UAAU,WAAW,SAAS,UAAU,OAAO,QAAQ,QAAQ,WAAW,YAAY,WAAW,UAAU,SACjIC,GAAAA,mBAAmB,CAAC,eAAe,eAAe,WAAW,SAAS,WAAW,WAAW,SCvG/E4B,EAAAA,EAAAA,GAAAA,KAAA,EACd95C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,SAAS,SAAS,OAAO,SAAS,SAAS,UAAU,aAAa,WAAW,YAAY,aAC3HD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,WAAW,cAAc,SAAS,SAAS,WAAW,SAAS,QAAA,GAC1EF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,UAEvDoL,QAAQ,EACPwO,sBAAsB,SACtB8M,SAAS,OACTC,UAAU,SACVC,WAAW,SACXn6B,WAAW,eACXo6B,WAAW,UACXC,aAAa,YACbC,cAAc,eACdC,WAAW,SACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,4CAClBqY,qBAAqB,QACrBC,cAAc,iBACdjc,UAAU,WAGVkc,mBAAmB,sDACnBC,mBAAmB,kBACnBC,kBAAkB,eAClBC,uBAAuB,aACvBC,oBAAoB,eACpBC,wBAAwB,mBACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,SACNq4C,aAAa,QAGbC,UAAU,QAGVC,iBAAiB,UAGjB9C,UAAU,QAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,YACnBC,oBAAoB,WACpBC,mBAAmB,SACnBC,uBAAuB,QACvBC,uBAAuB,OACvBC,wBAAwB,oBACxBC,aAAa,mBACbC,wBAAwB,2BACxBC,yBAAyB,aACzBC,0BAA0B,MAC1BC,uBAAuB,YACvBC,yBAAyB,SACzBC,iCAAiC,QACjCC,gCAAgC,SAChCC,mBAAmB,MACnBC,kBAAkB,MAClBC,sBAAsB,OACtBC,mBAAmB,SACnBC,kBAAkB,wBAClBC,+BAA+B,aAC/BC,mBAAmB,MACnBC,mBAAmB,aAEnBC,cAAc,UACdC,cAAc,YACdC,iBAAiB,oBACjBC,eAAe,cACfC,gBAAgB,cAChBC,eAAe,cACfC,eAAe,WACfC,iBAAiB,OACjBC,kBAAkB,SAClBC,mBAAmB,SACnBC,kBAAkB,QAClBC,gBAAgB,YAChBC,aAAa,YAEbC,qBAAqB,CAAC,UAAU,WAAW,SAAS,SAAS,OAAO,SAAS,SAAS,UAAU,aAAa,WAAW,YAAY,aACpIC,mBAAmB,CAAC,WAAW,cAAc,SAAS,SAAS,WAAW,SAAS,eCxGtE6B,KAAA,EACd/5C,MAAM,EACLmsB,YAAY,CAAC,UAAU,WAAW,SAAS,SAAS,OAAO,OAAO,OAAO,UAAU,aAAa,WAAW,YAAY,UAAA,GACvHD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,QAAQ,OAAO,OAAO,QAC5F8B,UAAU,CAAC,UAAU,YAAY,UAAU,UAAU,WAAW,UAAU,QAAA,GAC1EF,WAAW,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,IAEjDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,UACVC,WAAW,UACXn6B,WAAW,gBACXo6B,WAAW,UACXC,aAAa,QACbC,cAAc,UACdC,WAAW,UACX5X,aAAa,UACb6X,iBAAiB,wCACjBpY,kBAAkB,6CAClBqY,qBAAqB,YACrBC,cAAc,kBAGdC,mBAAmB,sDACnBC,mBAAmB,uBACnBC,kBAAkB,WAClBC,uBAAuB,WACvBC,oBAAoB,sBACpBC,wBAAwB,qBACxBC,sCAAsC,6BAGtC4C,YAAY,WACZp4C,MAAM,SACNq4C,aAAa,YAGbC,UAAU,OACVtf,UAAU,YAGVuf,iBAAiB,WAGjB9C,UAAU,WAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,SAClBC,mBAAmB,YACnBC,oBAAoB,WACpBC,mBAAmB,SACnBC,uBAAuB,SACvBC,uBAAuB,OACvBC,wBAAwB,mBACxBC,aAAa,iBACbC,wBAAwB,mBACxBC,yBAAyB,WACzBC,0BAA0B,MAC1BC,uBAAuB,aACvBC,yBAAyB,UACzBC,iCAAiC,SACjCC,gCAAgC,UAChCC,mBAAmB,MACnBC,kBAAkB,SAClBC,sBAAsB,OACtBC,mBAAmB,UACnBC,kBAAkB,wBAClBC,+BAA+B,eAC/BE,mBAAmB,UACnBD,mBAAmB,MAEnBE,cAAc,SACdC,cAAc,aACdC,iBAAiB,sBACjBC,eAAe,gBACfC,gBAAgB,gBAChBC,eAAe,aACfC,eAAe,WACfC,iBAAiB,OACjBC,kBAAkB,UAClBC,mBAAmB,UACnBC,kBAAkB,OAClBC,gBAAgB,YAChBC,aAAa,UAEbC,qBAAqB,CAAC,UAAU,WAAW,SAAS,SAAS,OAAO,OAAO,OAAO,UAAU,aAAa,WAAW,YAAY,UAAA,GAChIC,mBAAmB,CAAC,UAAU,YAAY,UAAU,UAAU,WAAW,UAAU,eCxGtE8B,KAAA,EACdh6C,MAAM,EACLmsB,YAAY,CAAC,WAAW,YAAY,QAAQ,SAAS,OAAO,QAAQ,QAAQ,WAAW,aAAa,WAAW,YAAY,UAC3HD,GAAAA,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAA,GAC3F8B,UAAU,CAAC,UAAU,UAAU,UAAU,UAAU,WAAW,UAAU,QAAA,GACxEF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,QACtB8M,SAAS,OACTC,UAAU,SACVC,WAAW,SACXn6B,WAAW,eACXo6B,WAAW,SACXC,aAAa,SACbC,cAAc,YACdC,WAAW,SACX5X,aAAa,WACb6X,iBAAiB,IACjBpY,kBAAkB,2DAClBqY,qBAAqB,eACrBC,cAAc,OACdjc,UAAU,cAGVkc,mBAAmB,2DACnBC,mBAAmB,oBACnBC,kBAAkB,eAClBC,uBAAuB,aACvBC,oBAAoB,mBACpBC,wBAAwB,qBACxBC,sCAAsC,6BAGtC4C,YAAY,cACZp4C,MAAM,SACNq4C,aAAa,eAGbC,UAAU,MAGVC,iBAAiB,cAGjB9C,UAAU,UAGVhR,gBAAe,wBACfC,cAAa,sBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,YAClBC,mBAAmB,YACnBC,oBAAoB,aACpBC,mBAAmB,WACnBC,uBAAuB,OACvBC,uBAAuB,OACvBC,wBAAwB,mBACxBC,aAAa,gBACbC,wBAAwB,sBACxBC,yBAAyB,WACzBC,0BAA0B,OAC1BC,uBAAuB,aACvBC,yBAAyB,SACzBC,iCAAiC,OACjCC,gCAAgC,SAChCC,mBAAmB,OACnBC,kBAAkB,KAClBC,sBAAsB,SACtBC,mBAAmB,SACnBC,kBAAkB,mBAClBC,+BAA+B,gBAC/BE,mBAAmB,eACnBD,mBAAmB,SAEnBE,cAAc,UACdC,cAAc,aACdC,iBAAiB,gBACjBC,eAAe,eACfC,gBAAgB,eAChBC,eAAe,YACfC,eAAe,YACfC,iBAAiB,OACjBC,kBAAkB,SAClBC,mBAAmB,SACnBC,kBAAkB,MAClBC,gBAAgB,YAChBC,aAAa,UAEbC,qBAAqB,CAAC,WAAW,YAAY,QAAQ,SAAS,OAAO,QAAQ,QAAQ,WAAW,aAAa,WAAW,YAAY,UAAA,GACpIC,mBAAmB,CAAC,UAAU,UAAU,UAAU,UAAU,WAAW,UAAU,QCxGpE+B,EAAAA,EAAAA,GAAAA,KAAA,EACdj6C,MAAM,EACLmsB,YAAY,CAAC,QAAQ,SAAS,QAAQ,SAAS,SAAS,WAAW,UAAU,WAAW,SAAS,QAAQ,SAAS,WAClHD,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,SAAS,aAAa,QAAQ,YAAY,YAAY,QAAQ,cACzEF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,SACtB8M,SAAS,OACTC,UAAU,SACVC,WAAW,MACXn6B,WAAW,SACXo6B,WAAW,UACXC,aAAa,SACbC,cAAc,YACdC,WAAW,WACX5X,aAAa,OACb6X,iBAAiB,IACjBpY,kBAAkB,8BAClBqY,qBAAqB,YACrBC,cAAc,iBACdjc,UAAU,WAGVkc,mBAAmB,iDACnBC,mBAAmB,sBACnBC,kBAAkB,SAClBC,uBAAuB,SACvBC,oBAAoB,kBACpBC,wBAAwB,4BACxBC,sCAAsC,6BAGtC4C,YAAY,UACZp4C,MAAM,SACNq4C,aAAa,YAGbC,UAAU,OAGVC,iBAAiB,UAGjB9C,UAAU,UAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,UAClBC,mBAAmB,YACnBC,oBAAoB,SACpBC,mBAAmB,UACnBC,uBAAuB,OACvBC,uBAAuB,OACvBC,wBAAwB,eACxBC,aAAa,eACbC,wBAAwB,sBACxBC,yBAAyB,aACzBC,0BAA0B,aAC1BC,uBAAuB,WACvBC,yBAAyB,MACzBC,iCAAiC,OACjCC,gCAAgC,MAChCC,mBAAmB,aACnBC,kBAAkB,QAClBC,sBAAsB,QACtBC,mBAAmB,MACnBC,kBAAkB,oBAClBC,+BAA+B,QAC/BC,mBAAmB,SACnBC,mBAAmB,mBAEnBC,cAAc,QACdC,cAAc,WACdC,iBAAiB,eACjBC,eAAe,aACfC,gBAAgB,UAChBC,eAAe,WACfC,eAAe,QACfC,iBAAiB,OACjBC,kBAAkB,SAClBC,mBAAmB,MACnBC,kBAAkB,OAClBC,gBAAgB,aAChBC,aAAa,SAEbC,qBAAqB,CAAC,QAAQ,SAAS,QAAQ,SAAS,SAAS,WAAW,UAAU,WAAW,SAAS,QAAQ,SAAS,QAC3HC,GAAAA,mBAAmB,CAAC,SAAS,aAAa,QAAQ,YAAY,YAAY,QAAQ,kBCxGrEgC,KAAA,EACdl6C,MAAM,EACLmsB,YAAY,CAAC,UAAU,SAAS,YAAY,WAAW,WAAW,WAAW,UAAU,WAAW,YAAY,WAAW,YAAY,SAAA,GACrID,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAC3F8B,GAAAA,UAAU,CAAC,UAAU,aAAa,YAAY,UAAU,UAAU,YAAY,QAAA,GAC9EF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAEvDoL,EAAAA,GAAAA,QAAQ,EACPwO,sBAAsB,YACtB8M,SAAS,QACTC,UAAU,WACVC,WAAW,UACXn6B,WAAW,cACXo6B,WAAW,YACXC,aAAa,WACbC,cAAc,UACdC,WAAW,cACX5X,aAAa,YACb6X,iBAAiB,IACjBpY,kBAAkB,2CAClBqY,qBAAqB,QACrBC,cAAc,oBACdjc,UAAU,aAGVkc,mBAAmB,sDACnBC,mBAAmB,qBACnBC,kBAAkB,cAClBC,uBAAuB,YACvBC,oBAAoB,oBACpBC,wBAAwB,wBACxBC,sCAAsC,6BAGtC4C,YAAY,WACZp4C,MAAM,QACNq4C,aAAa,QAGbC,UAAU,OAGVC,iBAAiB,WAGjB9C,UAAU,WAGVhR,gBAAe,kBACfC,cAAa,gBAGb6G,YAAW,MACXC,gBAAe,UAGfjtB,MAAM,QACNm3B,MAAM,YACN7X,MAAM,QACND,OAAO,SACP3xB,KAAK,OACL0pC,MAAK,QACLC,QAAQ,UAGRC,kBAAkB,QAClBC,mBAAmB,WACnBC,oBAAoB,UACpBC,mBAAmB,OACnBC,uBAAuB,UACvBC,uBAAuB,QACvBC,wBAAwB,uBACxBC,aAAa,sBACbC,wBAAwB,iBACxBC,yBAAyB,eACzBC,0BAA0B,IAC1BC,uBAAuB,kBACvBC,yBAAyB,UACzBC,iCAAiC,UACjCC,gCAAgC,UAChCC,mBAAmB,IACnBC,kBAAkB,IAClBC,sBAAsB,QACtBC,mBAAmB,IACnBC,kBAAkB,uBAClBC,+BAA+B,aAC/BE,mBAAmB,OACnBD,mBAAmB,IAEnBE,cAAc,UACdC,cAAc,SACdC,iBAAiB,sBACjBC,eAAe,WACfC,gBAAgB,YAChBC,eAAe,UACfC,eAAe,eACfC,iBAAiB,QACjBC,kBAAkB,WAClBC,mBAAmB,UACnBC,kBAAkB,OAClBC,gBAAgB,WAChBC,aAAa,gBAEbC,qBAAqB,CAAC,SAAS,UAAU,WAAW,UAAU,UAAU,UAAU,SAAS,UAAU,WAAW,UAAU,aAAa,QAAA,GACvIC,mBAAmB,CAAC,WAAW,cAAc,aAAa,WAAW,aAAa,aAAa,SAAA,EAAA,EAAA;ACtG1F,MAAMiC,GAAAA;AAAAA,EACZ,YAAYn8C,GAAWwG,GAAWspC,IAAQ,CAAA,GACzCxmC;AAAAA,SAAKwmC,QAAQ,EACZ9tC,MAAM,oBAAIQ,QACV45C,OAAO,CAAC,QAAQ,UAAU,OAAA,GAC1BC,cAAc,CACdC,GAAAA,YAAY,IACZC,YAAY,MACZC,kBAAkB,GACf1M,GAAAA,EAAAA,GAEJxmC,KAAK9C,YAAY,MACjB8C,KAAKxF,UAAU,MACfwF,KAAKmzC,wBAAwB,CAAA,GAC7BnzC,KAAKtJ,YAAYA,GACjBsJ,KAAKozC,aAAa18C,EAAU+lB,qBAAAA,GAC5Bzc,KAAKwmC,QAAQxmC,KAAK1E,YAClBqnC,GAAU3iC,IAAAA,GACP9C,MAEF8C,KAAK9C,YAAYA,GACjB8C,KAAKsM,OAAOtM,KAAK9C,aAGlB8C,KAAKqzC,cAAc,CAACC,GAAUC,MAAAA;AAC7BvzC,WAAKH,UAAU,iBAAiB,CAAC0zC,GAAUD,CAAU,CAAA;AAAA,IAAA,CAAA;AAAA,EAEtD;AAAA,EAED,WAAAh4C;AACC,WAAO,EACH0E,GAAAA,KAAKwmC,OACRvrC,MAAM+E,KAAKwmC,MAAMsM,MAAM9yC,KAAKwmC,MAAM0M;EAEnC;AAAA,EAED,SAASK,GACR;AAAA,UAAMD,IAAW,EAAA,GAAKtzC,KAAKwmC,MAAAA;AACxB+M,IAAAA,EAASt4C,SACXs4C,EAASL,mBAAmBlzC,KAAKwmC,MAAMsM,MAAMjsC,QAAQ0sC,EAASt4C,IAE/D+E,IAAAA,KAAKwmC,QAAQ,EAAA,GAAKxmC,KAAKwmC,OAAU+M,GAAAA,EAAAA,GAEjCvzC,KAAKwzC,mBAAmBF,GAAUtzC,KAAKwmC,KAEnCxmC,GAAAA,KAAK9C,aACR8C,KAAKsM,OAAOtM,KAAK9C;EAElB;AAAA,EAED,cAAckT,GAIb;AAAA,WAHApQ,KAAKmzC,sBAAsB95C,KAAK+W,IAGzB,MACN;AAAA,YAAM9X,IAAQ0H,KAAKmzC,sBAAsBtsC,QAAQuJ,CAClC;AAAA,MAAX9X,MAAW,MACd0H,KAAKmzC,sBAAsBjrC,OAAO5P,GAAO,CACzC;AAAA,IAAA;AAAA,EAEF;AAAA,EAED,mBAAmBg7C,GAAUC,GAC5BvzC;AAAAA,SAAKmzC,sBAAsBr4C,QAAQsV,OAAWA,EAAQkjC,GAAUC,CAChE,CAAA;AAAA,EAAA;AAAA,EAED,YAAYE,GAAAA;AAEX,YAAMx4C,MAACA,GAAIvC,MAAEA,EAAQsH,IAAAA,KAAK1E,SACpBo4C,GAAAA,IAAU,IAAIx6C,KAAKR;AACZ,IAATuC,MAAS,SACZy4C,EAAQhuB,SAAShtB,EAAKmb,aAAa4/B,CAChB,IAATx4C,MAAS,WACnBy4C,EAAQC,YAAYj7C,EAAKkb,gBAAgB6/B,CAEzCC,IAAAA,EAAQC,YAAYj7C,EAAKkb,YAAAA,IAA4B,KAAZ6/B,CAE1CzzC,GAAAA,KAAK4zC,SAAS,EAAEl7C,MAAMg7C,EAAAA,CAAAA;AAAAA,EACtB;AAAA,EAED,cAAAG;AACC,UAAMC,KAAY9zC,KAAKwmC,MAAM0M,mBAAmB,KAAKlzC,KAAKwmC,MAAMsM,MAAMj5C;AACtEmG,SAAK4zC,SAAS,EAAEV,kBAAkBY,EAClC,CAAA;AAAA,EAAA;AAAA,EAED,sBAAsB52C,GAAAA;AACrB,UAAMjC,EAAAA,MAACA,GAAIvC,MAAEA,MAAQsH,KAAK1E,SAAAA,GAEpByzB,IAASzqB,SAASC,cAAc;AACtCwqB,IAAAA,EAAOxZ,UAAU5c,IAAI,2BAAA;AAErB,UAAMo7C,IAAgBzvC,SAASC,cAAc,QAAA;AAE7CwvC,IAAAA,EAAcx+B,UAAU5c,IAAI,4BAA4B,kBAAkB,YAAA,GAC1Eo2B,EAAOtqB,YAAYsvC,CAEnB;AAAA,UAAMC,IAAa1vC,SAASC,cAAc;AAG1C,QAFAyvC,EAAWz+B,UAAU5c,IAAI,0BAAA,GAErBsC,MAAS;AACZ+4C,MAAAA,EAAWC,YAAYv7C,EAAKw7C,eAAe,WAAW,EAAE5d,OAAO,OAAA,CAAA,IAAY,MAAM59B,EAAKkb,YAAAA;AAAAA,aAC5E3Y,MAAS;AACnB+4C,MAAAA,EAAWC,YAAYv7C,EAAKkb,YAAAA;AAAAA,SACtB;AACN,YAAMugC,IAAkD,KAAtCruC,KAAK+D,MAAMnR,EAAKkb,YAAAA,IAAgB,EAClDogC;AAAAA,MAAAA,EAAWC,YAAY,GAAGE,CAAAA,MAAeA,IAAY,CACrD;AAAA,IAAA;AAEDn0C,SAAKozC,WAAWl3B,OAAO83B,GAAY,SAASh0C,KAAK6zC,YAAYhkC,KAAK7P,IAClE+uB,CAAAA,GAAAA,EAAOtqB,YAAYuvC,CAEnB;AAAA,UAAMI,IAAe9vC,SAASC,cAAc,QAE5C6vC;AAAAA,IAAAA,EAAa7+B,UAAU5c,IAAI,4BAA4B,kBAAkB,aAAA,GACzEo2B,EAAOtqB,YAAY2vC,CAAAA,GAEnBl3C,EAAUuH,YAAYsqB,CAAAA,GAEtB/uB,KAAKozC,WAAWl3B,OAAO63B,GAAe,SAAS/zC,KAAKq0C,YAAYxkC,KAAK7P,MAAO,EAAA,CAAA,GAC5EA,KAAKozC,WAAWl3B,OAAOk4B,GAAc,SAASp0C,KAAKq0C,YAAYxkC,KAAK7P,MAAM;EAC1E;AAAA,EAED,OAAO9C,GACN8C;AAAAA,SAAKozC,WAAW/2B,UAAAA,GAChBrc,KAAK9C,YAAYA,KAAa8C,KAAK9C,WACnC8C,KAAK9C,UAAUsH,YAAY,IAEvBxE,KAAKxF,YACRwF,KAAKxF,UAAU8J,SAASC,cAAc,QACtCvE,KAAKxF,QAAQ+a,UAAU5c,IAAI,oBAAA,IAE5BqH,KAAKxF,QAAQgK,YAAY,IACzBxE,KAAK9C,UAAUuH,YAAYzE,KAAKxF,OAEhCwF,GAAAA,KAAKs0C,sBAAsBt0C,KAAKxF,OAAAA;AAChC,UAAM+5C,IAAgBjwC,SAASC,cAAc,KAAA;AAC7CgwC,MAAch/B,UAAU5c,IAAI,yBAC5BqH,GAAAA,KAAKxF,QAAQiK,YAAY8vC,CAAAA;AAEzB,YAAMt5C,MAACA,EAAAA,IAAQ+E,KAAK1E,SAAAA;AACP,IAATL,MAAS,SACZ+E,KAAKw0C,eAAeD,CAAAA,IACVt5C,MAAS,WACnB+E,KAAKy0C,iBAAiBF,CAEtBv0C,IAAAA,KAAK00C,gBAAgBH,CAAAA;AAAAA,EAEtB;AAAA,EAED,qBAAqBI,GACpB;AAAA,UAAA,EAAMj8C,MAACA,GAAIu6C,YAAEA,MAAcjzC,KAAK1E,SAAAA,GAC1B5E,IAAYsJ,KAAKtJ;AAEvB,QAAIk+C,IAAcl+C,EAAUgC,KAAKY,WAAW,IAAIJ,KAAKR;AACrD,UAAMm8C,IAAUn+C,EAAUgC,KAAKC,IAAIjC,EAAUgC,KAAKY,WAAW,IAAIJ,KAAKR,CAAQ,CAAA,GAAA,GAAG;AAEjFi8C,IAAAA,EAAoBp/B,UAAU5c,IAAI,yBAAA;AAElC,UAAMm8C,IAAcp+C,EAAUgC,KAAK0tB,YAAY;AAE/C,WAAOwuB,EAAYz7C,YAAY07C,EAAQ17C,QAAAA,KAAW;AACjD,UAAA,CAAK85C,KAAcA,CAAAA,EAAW2B,IAAc;AAC3C,cAAMlqB,IAAQoqB,EAAYF,CAAAA,GAEpBG,IAAazwC,SAASC,cAAc,KAC1CwwC;AAAAA,QAAAA,EAAWt/B,aAAa,YAAYm/B,EAAYz2C,OAChD42C,CAAAA,GAAAA,EAAWx/B,UAAU5c,IAAI,4BAAA,GACzBo8C,EAAWd,YAAYvpB,GACvBiqB,EAAoBlwC,YAAYswC,CAChC;AAAA,MAAA;AAEDH,MAAAA,IAAcl+C,EAAUgC,KAAKC,IAAIi8C,GAAa,GAAG;IACjD;AAAA,EACD;AAAA,EAED,cAAc5uC,GAAKD,GAAAA;AAClB,UAAMrP,IAAYsJ,KAAKtJ;AACvB,QAAIs+C,IAAQ,GACRC,IAAW,IAAI/7C,KAAK8M,CAAAA;AACxB,WAAMivC,EAAS97C,YAAY4M,EAAI5M,QAAAA;AAC9B67C,MAAAA,KAAS,GACTC,IAAWv+C,EAAUgC,KAAKY,WAAW5C,EAAUgC,KAAKC,IAAIs8C,GAAU,GAAG,MAEtE,CAAA;AAAA,WAAOD;AAAAA,EACP;AAAA,EAED,eAAe93C,GACd;AAAA,UAAA,EAAMxE,MAACA,GAAIq6C,cAAEA,GAAYC,YAAEA,GAAUkC,UAAEA,GAAQjC,YAAEA,MAAcjzC,KAAK1E,SAAAA;AAEpE,QAAI65C,IAAmBpC,EAAa,CAAA,GAChCqC,IAAmBrC,EAAa,CAAA;AAEpC,UAAMsC,IAAiBrC,EAAWsC,OAAO,CAAC5a,GAAKhiC,OAE9CgiC,EADiB16B,KAAKtJ,UAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKR,CAC3CS,CAAAA,EAAAA,QAAAA,CAAAA,IAAAA,IACNuhC,IACL,CAAE,CAICia,GAAAA,IAAsBrwC,SAASC,cAAc;AACnDvE,SAAKu1C,qBAAqBZ;AAC1B,UAAMa,IAAab,EAAoBc,SAAS57C;AAChDqD,IAAAA,EAAUuH,YAAYkwC,CACJ,GAAfa,MAAe,KACjBt4C,EAAUvF,MAAM+9C,YAAY,+BAA+BF,CAAAA;AAG5D,UAAM9+C,IAAYsJ,KAAKtJ,WACjBi/C,IAAYj/C,EAAUgC,KAAKY,WAAW5C,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKR,MAC1Ek9C,IAAal/C,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKR,KACjDm9C,IAAWn/C,EAAUgC,KAAKC,IAAIjC,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKR,CAAAA,CAAAA,GAAQ,GAAG,OAAA;AACnF,QAAIo9C,IAAWp/C,EAAUgC,KAAKC,IAAIjC,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKR,CAAAA,CAAAA,GAAQ,GAAG,OAAA;AACjF,UAAMq9C,IAAiBr/C,EAAUgC,KAAKwF,UAAUxH,EAAU+J;AACjC,IAAtBq1C,EAAS33C,OACX23C,MADwB,MACxBA,IAAWp/C,EAAUgC,KAAKC,IAAIjC,EAAUgC,KAAKY,WAAWw8C,CAAW,GAAA,GAAG;AAGvE,QAAId,IAAQh1C,KAAKg2C,cAAcL,GAAWG,CAAAA;AACvCZ,IAAAA,KAAYF,IAAQE,MACtBY,IAAWp/C,EAAUgC,KAAKC,IAAIm9C,GAAWZ,IAAWF,GAAQ,MAAA;AAG7D,QAAI/7C,IAAW08C;AAEf,UAAMM,IAAmB3xC,SAASC,cAAc,KAAA;AAShD,SARA0xC,EAAiB1gC,UAAU5c,IAAI,yBAAA,GAE/BqH,KAAKozC,WAAWl3B,OAAO+5B,GAAkB,SAAUn/C,CAAAA;AAClD,YAAMo/C,IAAWp/C,EAAMsE,OAAOC,QAAQ,kBAChC3C,GAAAA,IAAO,IAAIQ,KAAKg9C,EAASr7C,aAAa,gBAAA,CAAA;AAC5CmF,WAAKH,UAAU,eAAe,CAACnH,GAAM5B,CAAAA,CAAAA;AAAAA,IAAO,CAGvCmC,GAAAA,EAASE,QAAY28C,IAAAA,EAAS38C,aAAU;AAC7C,UAAA,CAAK85C,MAAcA,EAAWh6C,CAAAA,GAAW;AAExC,cAAM87C,IAAazwC,SAASC,cAAc,KAC1CwwC;AAAAA,QAAAA,EAAWt/B,aAAa,kBAAkB/e,EAAUya,UAAU8c,YAAYh1B,CAAAA,CAAAA,GAC1E87C,EAAWt/B,aAAa,YAAYxc,EAASkF,OAE7C42C,CAAAA,GAAAA,EAAWvwC,YAAY9N,EAAUya,UAAU+uB,UAAUjnC,CAElDA,GAAAA,EAASE,YAAYy8C,EAAWz8C,QAAAA,IAClC47C,EAAWx/B,UAAU5c,IAAI,YAAA,IACjBM,EAASE,QAAa08C,KAAAA,EAAS18C,aACvC47C,EAAWx/B,UAAU5c,IAAI,WAGD,GAAtBM,EAASkF,OAAAA,MAAa,KAAKlF,EAASkF,aAAa,KACnD42C,EAAWx/B,UAAU5c,IAAI,4BAGvBM,GAAAA,EAASE,aAAa48C,EAAe58C,QAAAA,KACvC47C,EAAWx/B,UAAU5c,IAAI,SAAA,GAGvBw8C,KAAoBC,KACnBn8C,EAASE,aAAag8C,EAAiBh8C,QAAAA,KAAaF,EAASE,QAAYi8C,IAAAA,EAAiBj8C,QAC5F47C,KAAAA,EAAWx/B,UAAU5c,IAAI,+BAIxB08C,EAAep8C,EAASE,cAC1B47C,EAAWx/B,UAAU5c,IAAI,0BAG1Bo8C,GAAAA,EAAWx/B,UAAU5c,IAAI,yBAEzBs9C,GAAAA,EAAiBxxC,YAAYswC,CAC7B;AAAA,MAAA;AACD97C,UAAWvC,EAAUgC,KAAKC,IAAIM,GAAU,GAAG,KAC3C;AAAA,IAAA;AAEDiE,IAAAA,EAAUuH,YAAYwxC;EAEtB;AAAA,EAED,iBAAiB/4C,GAChB;AAAA,UAAA,EAAMxE,MAACA,EAAQsH,IAAAA,KAAK1E,SAEd66C,GAAAA,IAAU7xC,SAASC,cAAc;AACvC4xC,MAAQ5gC,UAAU5c,IAAI,2BAEtB;AAAA,UAAMy9C,IAAS,CACf;AAAA,aAAQx8C,IAAI,GAAGA,IAAI,IAAIA;AACtBw8C,MAAAA,EAAO/8C,KAAK,IAAIH,KAAKR,EAAKkb,YAAeha,GAAAA,GAAG,CAG7C,CAAA;AAAA,UAAMy8C,IAAcr2C,KAAKtJ,UAAUgC,KAAK0tB,YAAY;AACpDgwB,IAAAA,EAAOt7C,QAAQw7B,CAAAA;AACd,YAAMggB,IAAehyC,SAASC,cAAc,KAC5C+xC;AAAAA,MAAAA,EAAa/gC,UAAU5c,IAAI,0BAAA,GACxBD,EAAKmb,SAAeyiB,MAAAA,EAAMziB,cAC5ByiC,EAAa/gC,UAAU5c,IAAI,4BAAA,GAE5B29C,EAAa7gC,aAAa,cAAc6gB,EAAMziB,SAAAA,CAAAA,GAC9CyiC,EAAa9xC,YAAY6xC,EAAY/f,IACrCt2B,KAAKozC,WAAWl3B,OAAOo6B,GAAc,SAAS,MAAA;AAC7C,cAAM5C,IAAU,IAAIx6C,KAAKo9B,CACzBt2B;AAAAA,aAAK4zC,SAAS,EACbl7C,MAAMg7C,GACNz4C,MAAM,OACL,CAAA;AAAA,MAAA,CAAA,GAEHk7C,EAAQ1xC,YAAY6xC,CAAAA;AAAAA,IAAa,IAElCp5C,EAAUuH,YAAY0xC;AAEtB,UAAMI,IAAWjyC,SAASC,cAAc,KACxCgyC;AAAAA,IAAAA,EAAShhC,UAAU5c,IAAI,yBAAA;AACvB,UAAM69C,IAAUlyC,SAASC,cAAc,QACvCiyC;AAAAA,IAAAA,EAAQvC,YAAY,QACpBuC,EAAQjhC,UAAU5c,IAAI,6BACtBqH,GAAAA,KAAKozC,WAAWl3B,OAAOs6B,GAAS,SAAS,MACxCx2C;AAAAA,WAAK4zC,SAAS,EACb34C,MAAM;IACL,CAEHs7C,GAAAA,EAAS9xC,YAAY+xC,CACrBt5C,GAAAA,EAAUuH,YAAY8xC,CACtB;AAAA,EAAA;AAAA,EAED,gBAAgBr5C,GACf;AAAA,UAAA,EAAMxE,MAACA,EAAQsH,IAAAA,KAAK1E,YACd64C,IAAkD,KAAtCruC,KAAK+D,MAAMnR,EAAKkb,YAAgB,IAAA,EAAA,GAE5CuiC,IAAU7xC,SAASC,cAAc,KACvC4xC;AAAAA,IAAAA,EAAQ5gC,UAAU5c,IAAI,0BAAA;AACtB,aAASiB,IAAIu6C,IAAY,GAAGv6C,KAAKu6C,IAAY,IAAIv6C,KAAK;AACrD,YAAM68C,IAAcnyC,SAASC,cAAc,KAC3CkyC;AAAAA,MAAAA,EAAYxC,YAAYr6C,GACxB68C,EAAYlhC,UAAU5c,IAAI,yBAC1B89C,GAAAA,EAAYhhC,aAAa,aAAa7b,CAAAA,GACnClB,EAAKkb,YAAkBha,MAAAA,KACzB68C,EAAYlhC,UAAU5c,IAAI,4BAAA,GAE3BqH,KAAKozC,WAAWl3B,OAAOu6B,GAAa,SAAS,MAAA;AAC5Cz2C,aAAK4zC,SAAS,EACbl7C,MAAM,IAAIQ,KAAKU,GAAGlB,EAAKmb,SAAY,GAAA,CAAA,GACnC5Y,MAAM,SACL,CAAA;AAAA,MAAA,CAAA,GAEHk7C,EAAQ1xC,YAAYgyC,CAAAA;AAAAA,IAEpB;AACDv5C,IAAAA,EAAUuH,YAAY0xC,CAAAA;AAEtB,UAAMI,IAAWjyC,SAASC,cAAc,KACxCgyC;AAAAA,IAAAA,EAAShhC,UAAU5c,IAAI,yBAAA;AACvB,UAAM69C,IAAUlyC,SAASC,cAAc;AACvCiyC,IAAAA,EAAQvC,YAAY,QACpBuC,EAAQjhC,UAAU5c,IAAI,6BACtBqH,GAAAA,KAAKozC,WAAWl3B,OAAOs6B,GAAS,SAAS;AACxCx2C,WAAK4zC,SAAS,EACb34C,MAAM,SAAA,CAAA;AAAA,IACL,IAEHs7C,EAAS9xC,YAAY+xC,CACrBt5C,GAAAA,EAAUuH,YAAY8xC,CAAAA;AAAAA,EACtB;AAAA,EAED,aAAAlK;AACCrsC,SAAKmzC,wBAAwB,CAAA,GAC1BnzC,KAAKxF,YACPwF,KAAKxF,QAAQgK,YAAY,IACzBxE,KAAKxF,QAAQumB,OAGd/gB,IAAAA,KAAKozC,WAAW/2B,UAChBrc,GAAAA,KAAKH,UAAU,aAAa,CAAA,CAAA,GAC5BG,KAAK0b,gBAAAA,GAEL1b,KAAKtJ,YAAY;AAAA,EACjB;AC7Ua;AAAA,SAAQggD,GAACC,GAEvB;AAAA,QAAMjgD,IAAY,EAAEw1C,SAAS,QAE7Bx1C;AAAAA,EAAAA,EAAU6U;AC5CV,UAAMqrC,IAAiB,CAAA;AAwBvB,WAAO,EACNt7C,UAvBD,SAAkB2T,GAAAA;AAEjB,UADiB2nC,EAAe3nC,CAE/B;AAAA,eAAO2nC,EAAe3nC,CAAMzB,EAAAA,OAAAA;AACxB;AACJ,cAAM1P,IAAM,CAAA;AACZ,mBAAUlE,KAAKg9C;AACVA,UAAAA,EAAeh9C,GAAGi9C,YACrB/iC,GAAMC,MAAMjW,GAAK84C,EAAeh9C,GAAG4T,OAAU,GAAA,EAAA;AAE/C,eAAO1P;AAAAA,MACP;AAAA,IACD,GAYA0N,kBAVD,SAA0ByD,GAAM6nC,GAAUD,GAAAA;AACzCD,MAAAA,EAAe3nC,CAAQ,IAAA,EAAEzB,QAAQspC,GAAUD,UAAUA,EAAAA;AAAAA,IACrD,GASAE,oBAPD,SAA4B9nC;aACpB2nC,EAAe3nC,CAAAA;AAAAA,IACtB;EAOD,EDe2B+nC,GAE3BtgD,EAAU4E,WAAW5E,EAAU6U,eAAejQ,UEjDhC,SAAgB5E,GAAAA;AAE/B,QAAIugD,IAAc,EACjBC,QAAQ,sDACRC,MAAM,oDACN58C,KAAK,mDACLkP,MAAM,qDACNmxB,UAAU,wDACVwc,aAAa,0DACb7gB,MAAM,oDACN8gB,cAAc,+CAAA,GAGXC,IAAqB,EACxBJ,QAAQ,sCACRC,MAAM,oCACN58C,KAAK,mCACLkP,MAAM,gCACNmxB,UAAU,4GACVwc,aAAa,sCACb7gB,MAAM,oCACNljB,OAAO;AAGR3c,IAAAA,EAAU6gD,uBAAuB,EAChCC,aAAa,SAASp6C;AACrB,UACIq6C,IAAmBH,EAAmBl6C,CAAAA,IAAS,6BAA6Bk6C,EAAmBl6C,KAAQ,MAAO;AAClH,aACC,MAAIA,IAAJ,kMAHoC65C,EAAY75C,CAAAA,KAAS65C,EAAYI,gBAKxD;AAAA,KAAQI,IAAoBA,IAAmB;AAAA,IAAQ;AAAA,IACrE,GACDC,oBAAoB,SAAS31C;AAC5B,aAAO;AAAA;AAAA;AAAA;AAAA,IAGP,EAGFrL,GAAAA,EAAUihD,qBAAqB,WAAA;AAC9B,YAAM,IAAI5wC,MAAM,6FAA6FuwC,EAAmB1c,WAAhH;AAAA,kBAEGqc,EAAYrc,QAAAA;AAAAA,IAChC,GAEAlkC,EAAUkhD,kBAAkB,WAAA;AAC3B,YAAM,IAAI7wC,MAAM,0FAA0FuwC,EAAmB7tC,OAA7G;AAAA,kBAEGwtC,EAAYxtC,IAAAA;AAAAA,IAChC,GAEA/S,EAAUmhD,iBAAiB,WAAA;AAC1B,YAAM,IAAI9wC,MAAM,yFAAyFuwC,EAAmBH,OAA5G;AAAA,kBAEGF,EAAYE,IAAAA;AAAAA,IAChC,GAEAzgD,EAAU+G,oBAAoB,WAAA;AAC7B,YAAM,IAAIsJ,MAAM;AAAA;IAGjB,GAEArQ,EAAUyf,iBAAiB,WAC1B;AAAA,YAAM,IAAIpP,MAAM;AAAA,oDAGjB;AAAA,IAAA,GAEArQ,EAAUohD,cAAc,WAAA;AACvB,YAAM,IAAI/wC,MAAM,CACf,6CACA,gIACA,+EACC5C,EAAAA,KAAK;AAAA,CACR,CAAA;AAAA,IAAA,GAEAzN,EAAUqhD,cAAc,WAAA;AACvB,YAAM,IAAIhxC,MAAM,CACf,6CACA,gIACA,+EACC5C,EAAAA,KAAK;AAAA,CACR,CAAA;AAAA,IAAA;AAAA,EAGA,EFrCezN,CAAAA,GACd0S,GAAO1S,CG7CO,GAAA,SAAgBA;AAE/BisC,IAAAA,GAAUjsC,CAAAA,GAEVshD,GAAQthD,CAAAA,GAERA,EAAUuhD,kBAAkB,SAASr8B,GAAI9kB,GAAOsZ;AAC3CwL,MAAAA,EAAGG,sBACNH,EAAGG,oBAAoBjlB,GAAOsZ,KAErBwL,IAAAA,EAAGL,eACZK,EAAGL,YAAY,OAAKzkB,GAAOsZ,CAAAA;AAAAA,IAE7B,GAGA1Z,EAAUwhD,aAAa,WACtBC;AAAAA,MAAAA,GAA0BzhD,CAE1BA,GAAAA,EAAUwhD,aAAa;;IACxB;AAEA,UAAM3gD,IACK,EACT+U,QAAQ,SAAUtV,GACjB;AAAA,aAAON,EAAUwgB,cAAclgB;IAC/B,EAJGO,GAAAA,IAMK,EACT+U,QAAQ,SAAUtV;AACjB,YAAMwD,IAAU8J,SAASC,cAAc,KAEvC;AAAA,aADA/J,EAAQgL,YAAY,kBACbhL;AAAAA,IACP,EAXGjD,GAAAA,IAaO,EACX+U,QAAQ,SAAUtV,GACjB;AAAA,YAAMwD,IAAU8J,SAASC,cAAc,KAEvC;AAAA,aADA/J,EAAQgL,YAAY,gBACbhL;AAAAA,IACP,EASH;AAAA,aAAS49C,EAAmB59C,GAAAA;AAC3B,aACCA,CAAAA,EAAAA,EAAQ4c,cAAc,iBACtB5c,KAAAA,EAAQ4c,cAAc,eACtB5c,KAAAA,EAAQ4c,cAAc,kBAExB;AAAA,IAAA;AAkDA1gB,IAAAA,EAAUiuB,OAAK,SAAShrB,GAAGjB,GAAKuC,GAC/B;AAAA,UAAA,CAAG+E,KAAK4Y,YAAR;AAmCA,YAhCAlgB,IAAKA,KAAOhC,EAAU+J,aAAAA,GACtBxF,IAAKA,KAAM,QAER+E,KAAKuuB,QACPvuB,KAAK2X,cAGN3X,GAAAA,KAAKuuB,OAAa50B,OAAAA,KAAM,WAAU2K,SAAS8/B,eAAezqC,CAAIA,IAAAA,GAC9DqG,KAAKxG,aAAawG,KAAKuuB,MACvBvuB,KAAKkZ,QAAQlZ,KAAKuuB,MAEdvuB,CAAAA,KAAKxG,WAAWugB,gBAAgB/Z,KAAKxG,WAAWygB,eAAeja,KAAKxG,WAAW7B,MAAM8N,WAAW,UAEnGlP,OAAO8U,QAAQC,MAAM5U,EAAU6gD,qBAAqBG,mBAAsB13C,GAAAA,KAAKxG,aAG7EwG,KAAKhJ,OAAO8iB,uBAAuB9Z,KAAKhJ,OAAOqhD,6BACjDr4C,KAAKxG,WAAWic,aAAa,QAAQ,aAGlCzV,GAAAA,KAAKhJ,OAAO+3B,UAAWqpB,EAAmBp4C,KAAKxG,UAGlDwG,MAAAA,KAAKhJ,OAAO+3B,SA3Ed,SAA6Br4B,GAC5B;AAAA,gBAAM4hD,IAAQ,CACb,OACA,QACA,OAAA;AAWD,cAAG5hD,EAAUuG;AACZ,uBAAUrD,KAAKlD,EAAUuG;AACxBq7C,cAAAA,EAAMj/C,KAAKO;AAGb,cAAGlD,EAAUsG;AACZ,uBAAUpD,KAAKlD,EAAUsG;AACxBs7C,cAAAA,EAAMj/C,KAAKO,CAIb;AAAA,cAAGlD,EAAU6hD,SAAS7hD,EAAU6hD,MAAM7e;AACrC,uBAAU9/B,KAAKlD,EAAU6hD,MAAM7e;AAC9B4e,cAAAA,EAAMj/C,KAAKO;AAiBb,iBAbsB,CACrB,OACA,UACA,eACA,QAGakB,QAAQ,SAAS1D;AAC3BV,YAAAA,EAAUU,IAAW,YACvBkhD,EAAMj/C,KAAKjC;UAEd,CAEQkhD,GAAAA,EAAMn4C,OAvCA,CACZ,MAAA,CAAA,EAsCyBA,OApCd,CACX,QACA,SACA;QAkCF,EA6B2CH,OACzCzJ,OAAO8U,QAAQmtC,IAAI,CAClB,oHACA,0CACA,+BAA+B3pC,KAAKmB,UAAUhQ,KAAKhJ,OAAO+3B,QAAQ,MAAM,CACxE,GAAA,2FAAA,EACC5qB,KAAK;AAAA,CAGJnE,CAAAA,IAAAA,KAAKhJ,OAAO+3B;AACf/uB,eAAKxG,WAAWgL,YAAY,IAC5BxE,KAAKxG,WAAW+b,UAAU5c,IAAI,sBAC3BqH,KAAKhJ,OAAO+3B,OAAOtpB,WACrBzF,KAAKyX,GAAGC,aAAa1X,KAAKhJ,OAAO+3B,OAAOtpB,SAEzCzF,KAAKxG,WAAWiL,YAAYlN,EAAc+U,OAAOtM,KAAKhJ,OAAO+3B,MAAAA,CAAAA,GAC7D/uB,KAAKxG,WAAWiL,YAAYlN,EAAc+U,OAC1CtM,CAAAA,GAAAA,KAAKxG,WAAWiL,YAAYlN,EAAgB+U,OAG5C,CAAA;AAAA,iBAAA,CAAI8rC,EAAmBp4C,KAAKxG;AAC3B,gBAAM,IAAIuN,MAAM,CACf,mEACA,+IACA,kLACC5C,EAAAA,KAAK;AAAA,CAILnE,CAAAA;AAAAA,aAAKhJ,OAAOsgC,QAAKt3B,KAAKxG,WAAWgM,aAAa,2BAG9CxF,KAAK8/B,cACRppC,EAAUopC,WAEXppC,GAAAA,EAAUgC,KAAKisB,KAEf3kB,GAAAA,KAAKy4C,cAELz4C,KAAKO,OAAK,CACVP,GAAAA,KAAKiH,gBACLjH,KAAK04C,eAAAA,GACL14C,KAAK4X,YAAAA,GAEL5X,KAAKk4C,WAAAA,GACLl4C,KAAK04B,mBAEL14B,GAAAA,KAAK24C,aACLjiD,EAAUmJ,UAAU,oBAAoB,CACxCnJ,CAAAA,GAAAA,EAAUuiB,eAAe,IACzBjZ,KAAKuM,eAAe7T,GAAKuC,CA1ExB;AAAA,MAAA;AAAA,IA4EF,GAEAvE,EAAU+gB,KAAG,EACZmhC,kBAAiB,IACjBpa,YAAY,IACZqa,aAAY,IACZ9f,cAAa,IACb+f,cAAa,IACbC,oBAAmB,IACnBC,YAAW,IACXC,YAAW,GACXC,aAAY,GACZC,cAAa,KACbC,mBAAkB,IAClBC,qBAAqB,GAEtB3iD,GAAAA,EAAUq/B,OAAK,EACdC,WAAU,IACVC,aAAY,GAGbv/B,GAAAA,EAAUmZ,OAAO,SAAcypC,GAASnlC;AACvC,aAAGmlC,EAAQzpC,OACHypC,EAAQzpC,KAAKsE,CAEb,IAAA,WAAA;AAAY,eAAOmlC,EAAQ12C,MAAMuR,GAAOpL,SAAAA;AAAAA;IACjD,GAEArS,EAAUiiD,YAAU,WAEnB;AAAA,UAAIzgC,IAAIlY,KAAKquB,KAAKruB,KAAKuuB,KAAKlW,cAAYrY,KAAKyX,GAAGyhC,aAG5CK,IAAQv5C,KAAKmB,cAAY,IAAGnB,KAAKyX,GAAGohC,cAAY74C,KAAKyX,GAAGshB,cAExDygB,IAA2Bx5C,KAAKxG,WAAW4d,cAAc,4BAC1D1gB;AAAAA,MAAAA,EAAU8mC,kBACRgc,KAAAA,OACHA,IAA2Bl1C,SAASC,cAAc,KACzBiB,GAAAA,YAAY,6BACrCxF,KAAKxG,WAAWsnB,aAAa04B,GAA0Bx5C,KAAKO,KAAqB,eAAE,CAEpFi5C,CAAAA,IAAAA,EAAyB7hD,MAAMkgB,UAAU,SAEzC7X,KAAKy5C,OAAOD,GAAyBthC,GAAElY,KAAKyX,GAAGqhC,eAAe,GAAE,GAAG94C,KAAKO,KAAqB,eAAE,CAAA,EAAGgf,cAG/Fi6B,KACFA,EAAyBv3C,WAAWC,YAAYs3C,CAAAA,GAI9Cx5C,KAAKsS,cACJ5b,EAAU8C,WAAWygB,cAAe,QAEvCja,KAAK4yB,eAAetuB,SAAS8S,cAAc,qBAI7CpX,KAAK05C,cAAcxhC,IAAEqhC,GAErBv5C,KAAKO,KAAsB,gBAAE,CAAG5I,EAAAA,MAAM+N,QAAQwS,IAAI;AAClD,YAAM6W,IAAS/uB,KAAKO,KAAqB,eAAE,CAC3CP;AAAAA,WAAKy5C,OAAO1qB,GAAQ/uB,KAAK05C,aAAa15C,KAAKyX,GAAGqhC,eAE9C/pB,EAAOp3B,MAAME,OAAO,IACpBk3B,EAAOp3B,MAAM8lB,QAAQ,IACjBzd,KAAKmB,cAOJnB,KAAKhJ,OAAOsgC,MAGfvI,EAAOp3B,MAAM8lB,QAAQ,SAFrBsR,EAAOp3B,MAAME,OAAO,SAPlBmI,KAAKhJ,OAAOsgC,MACdvI,EAAOp3B,MAAM8lB,QAAQ,GAAGzd,KAAKyX,GAAGohC,WAEhC9pB,OAAAA,EAAOp3B,MAAME,OAAO,GAAGmI,KAAKyX,GAAGohC,WAAAA;AAAAA,IASlC,GACAniD,EAAU+iD,SAAO,SAASz8B,GAAK9E,GAAEI,GAAE0J,GAAED,GACpC;AAAA,eAAS43B,EAAa3T,GACrB;AAAA,YAAI4T,IAAW5T;AAIf,eAHIhoB,MAAMvJ,OAAOmlC,CAChBA,CAAAA,MAAAA,IAAW9zC,KAAKC,IAAI,GAAE6zC,KAAY,OAE5BA;AAAAA,MACP;AAED,UAAInG,IAAY;AAEP3V,MAAN5lB,MAAM4lB,WACR9gB,EAAKrlB,MAAM+N,QAAQi0C,EAAazhC,KAG9BI,iBACF0E,EAAKrlB,MAAM8N,SAASk0C,EAAarhC,CAAAA,IAG9BvP,UAAUlP,SAAO,MAEjBmoB,iBACEhiB,KAAKhJ,OAAOsgC,QAAKmc,IAAY,UACjCz2B,EAAKrlB,MAAM87C,CAAAA,IAAWzxB,IAAE,OAEtBD,MAFsB,WAGxB/E,EAAKrlB,MAAMC,MAAImqB,IAAE;AAAA,IAGpB,GACArrB,EAAUuQ,eAAa,WAAA;AAEtB,YAAMnF,IAAI9B,KAAKuuB,KAAKiB,qBAAqB;AACzC,eAAS51B,IAAE,GAAGA,IAAIkI,EAAIjI,QAAQD,KAAI;AACjC,YAAIigD,IAAYnjD,EAAUkQ,cAAc9E,EAAIlI;AAC5C,cAAMkgD,IAAah4C,EAAIlI,CAAAA,EAAGiB,aAAa,UAAA,KAAeiH,EAAIlI,CAAGiB,EAAAA,aAAa,WAAW;AACjFg/C,QAAAA,MAAYA,IAAaA,EAAWx/C,MAAM,GAAK,EAAA,CAAA,IAC9C2F,KAAKO,KAAKs5C,OAAa75C,KAAKO,KAAKs5C,KAAY,CAClD75C,IAAAA,KAAKO,KAAKs5C,CAAYxgD,EAAAA,KAAKyI,EAAIlI,CAAAA,CAAAA;AAI/B,YAAI8wB,IAAQh0B,EAAU0tB,OAAOwN,OAAOkoB,IAAW,MAAWpjD,KAAAA,EAAU0tB,OAAOwN,OAAOkoB,KAAYD,CACzE;AAAA,QAAA,OAAVnvB,KAAU,YAAYovB,KAAAA,CAAeh4C,EAAIlI,CAAG4K,EAAAA,cACtDkmB,IAAQovB,EAAWz/C,MAAM,KAAK,CAC3BqwB,IAAAA,MACH1qB,KAAKuxB,SAASwoB,UAAUj4C,EAAIlI,IAAI8wB,CAChC5oB,GAAAA,EAAIlI,GAAG4K,YAAYkmB;AAAAA,MAEpB;AAAA,IACF;AAGA,UAAMsvB,IAAiBtjD,EAAU+lB,qBAsiDjC;AAAA,aAASw9B,EAAkBC,GAAWC,GAAAA;AACrC,YAAMx2C,IAAQ,IAAIzK,KAAKghD,CAGjBE,GAAAA,KAFM,IAAIlhD,KAAKihD,CACQj1B,EAAAA,QAAAA,IAAYvhB,EAAMuhB,QACN,KAAA;AACzC,aAAOpf,KAAKu1B,IAAI+e;IACjB;AA1iDA1jD,IAAAA,EAAUihB,gBAAgB,WAAA;AACzBqiC,MAAAA,EAAe39B,UAAAA;AAAAA,IAChB,GAEA3lB,EAAUkhB,cAAY;AACrB,iBAAWiB,KAAK7Y,KAAKO;AACpB,YAAIP,KAAKw7B,OAAO3iB,CAAAA;AACf,mBAASjf,IAAE,GAAGA,IAAIoG,KAAKO,KAAKsY,CAAGhf,EAAAA,QAAQD,KAAI;AAC1C,kBAAMY,IAAUwF,KAAKO,KAAKsY,CAAAA,EAAGjf,IACvBwW,IAAUpQ,KAAKw7B,OAAO3iB,CAAGhJ,EAAAA,KAAKrV,CACpCw/C;AAAAA,YAAAA,EAAe99B,OAAO1hB,GAAS,SAAS4V,CACxC;AAAA,UAAA;AAIH4pC,MAAAA,EAAe99B,OAAOlc,KAAKuuB,MAAM,eAAe,SAASrzB,GAExD;AAAA,eADAA,EAAE28B,eAAAA,GAAAA;AAAAA,MAEJ,CAECmiB,GAAAA,EAAe99B,OAAOlc,KAAKuuB,MAAM,aAAa,SAASrzB,GAAAA;AACjDxE,QAAAA,EAAU6jC,qBACd7jC,EAAUwkC,eAAehgC;MAC5B,CACC8+C,GAAAA,EAAe99B,OAAOlc,KAAKuuB,MAAM,aAAa,SAASrzB,GAAAA;AACjDxE,QAAAA,EAAUulC,sBACdvlC,EAAUwlC,eAAehhC;MAC5B,CACC8+C,GAAAA,EAAe99B,OAAOlc,KAAKuuB,MAAM,WAAW,SAASrzB,GAAAA;AAC/CxE,QAAAA,EAAUulC,sBACdvlC,EAAU4jC,aAAap/B;MAC1B,CACC8+C,GAAAA,EAAe99B,OAAOlc,KAAKuuB,MAAM,YAAY,SAASrzB,GAAAA;AACrDxE,QAAAA,EAAUglC,cAAcxgC,CAAAA;AAAAA,MAC1B,IACC8+C,EAAe99B,OAAOlc,KAAKuuB,MAAM,eAAe,SAASz3B,GAOxD;AAAA,eANGJ,EAAUkJ,WAAW,eAEvB9I,KAAAA,EAAM+gC,kBAGanhC,EAAUmJ,UAAU,iBAAiB,CAACnJ,EAAUolC,cAAchlC,EAAMsE,MAAAA,GAAStE,CAEnG,CAAA;AAAA,MAAA,CAAA;AAAA,IACA,GACAJ,EAAU2nB,SAAO,SAAS1kB,GAAAA;AACrBqG,WAAKq6C,cAAY1gD,MACrBjD,EAAU4jD,iBACVt6C,GAAAA,KAAKmnC,SAAS,EAAA,GACXnnC,KAAKq6C,cACPr6C,KAAKxE,SAENwE,GAAAA,KAAKq6C,aAAa1gD,GAClBqG,KAAK2M,YAAYhT,CACjBqG,GAAAA,KAAKH,UAAU,mBAAmB,CAAClG,CAAAA,CAAAA;AAAAA,IACpC,GACAjD,EAAU8E,WAAS,SAAS7B,GAC3B;AAAA,UAAIA,KAAMA,KAAIqG,KAAKq6C;AAClB;AAED,YAAME,IAAoBv6C,KAAKq6C;AAC/Br6C,WAAKq6C,aAAa,MACdE,KAAqBv6C,KAAK7E,SAASo/C,CAAAA,KACtCv6C,KAAK2M,YAAY4tC,CAElBv6C,GAAAA,KAAKH,UAAU,qBAAqB,CAAC06C;IACtC,GACA7jD,EAAU6U,eAAeC,iBAAiB,WAAU,WACnD;AAAA,aAAO,EACNvQ,MAAM+E,KAAKoB,OACX1I,MAAM,IAAIQ,KAAK8G,KAAK8J,QACpBjF,UAAU,IAAI3L,KAAK8G,KAAKY,SACxBkE,GAAAA,UAAU,IAAI5L,KAAK8G,KAAKW,YACxB65C,WAAWx6C,KAAKy6C,UAChBvoC,aAAalS,KAAKoS,cAClBa,WAAWjT,KAAKmS,YAChBuoC,WAAW16C,KAAKq6C,YAChBM,UAAU36C,KAAK26C,UACf7f,SAAS96B,KAAKR,UACdq6B,WAAW75B,KAAKP,WAEjB;AAAA,IAAA,GAAEoQ,KAAKnZ,CAERA,CAAAA,GAAAA,EAAU8kC,SAAO,EAChBC,cAAa,SAASvgC,GAErB;AAAA,UAAIxE,EAAUulC;AAKb,eAJI/gC,EAAE28B,kBACL38B,EAAE28B,eAAAA,GACH38B,EAAEigC,eAAe,IACjBzkC,EAAUulC,qBAAqB,IAAA;AAKhC,YAAMtiC,IAAKjD,EAAUolC,cAAc5gC,EAAEE,MAAAA;AAErC,UAAKzB;AAGJ,YAAA,CAAMjD,EAAUmJ,UAAU,WAAU,CAAClG,GAAGuB,CAAOxE,CAAAA,KAAAA,EAAUM,OAAOy6B;AAAW;AAAA;AAF3E/6B,QAAAA,EAAUmJ,UAAU,gBAAe,CAACnJ,EAAU+E,cAAcP,CAAGxC,EAAAA,MAAMwC,CAKtE,CAAA;AAAA,UAAIvB,KAAMjD,EAAUM,OAAOqnB,QAAQ;AAElC3nB,QAAAA,EAAU2nB,OAAO1kB,CACjB;AAAA,cAAMihD,IAAO1/C,EAAEE,OAAOC,QAAQ,mBAExB0oB,IAAOrtB,EAAUkQ,cAAcg0C,CACT;AAAA,QAAxB72B,EAAKld,QAAQ,OAAA,KAAW,MAC3BnQ,EAAU8kC,OAAOhE,QAAQzT,EAAK1pB,MAAM,GAAA,EAAK,GAAGkU,QAAQ,SAAQ,KAAK5U,CACrE;AAAA,MAAA;AACGjD,QAAAA,EAAU4jD,iBAAAA,GACN5jD,EAAU4E,SAAAA,EAAWo/C,cAAa,oBAAIxhD,QAAOC,aAAWzC,EAAUyb,cAAY,KAAK,OACtFzb,EAAU8E,SAGZ;AAAA,IAAA,GACDuhC,qBAAoB,WAAA;AACnBrmC,MAAAA,EAAU8kC,OAAOsB,oBAAoB,KACrC;AAAA,IAAA,GACDA,qBAAoB,SAAS9c,GAAM0c,GAClC;AAAA,UAAIme,IAAW;AACXnkD,MAAAA,EAAUM,OAAOsgC,QACpBoF,KAAQA,GACRme,IAAAA,CAAYA,IAEbnkD,EAAU6V,eAAe7V,EAAUgC,KAAKC,IACvCjC,EAAUgC,KAAKhC,EAAU0K,QAAM,UAAU,IAAIlI,KAAKxC,EAAUoT,KAAS4yB,CAAAA,GAAAA,KAAMme,GAAUnkD,EAAU0K,KAChG,CAAA;AAAA,IAAA,GACDg/B,sBAAqB,WAChB1pC;AAAAA,MAAAA,EAAUmJ,UAAU,0BAA0B,CAAA,CAAA,KACjDnJ,EAAU6V,eAAe7V,EAAU+J,aAEpC,CAAA;AAAA,IAAA,GACDq6C,aAAY,WAAA;AACX,YAAM7rC,IAAOjP,KAAKnF,aAAa,UACzBkgD,GAAAA,IAAkB/6C,KAAKnF,aAAa,MAAA,GACpCI,IAAOgU,KAAQ8rC,EAAgBC,UAAU,GAAGD,EAAgB13B,OAAO;AACzE3sB,MAAAA,EAAU6V,eAAe7V,EAAUoT,OAAM7O,CAAAA;AAAAA,IACzC,GACDu8B,SAAQ,EACPyR,QAAS,SAAStvC,GAAAA;AACjB,YAAMiF,IAAIlI,EAAU0tB,OAAOwN,OAAOyD;AAClC3+B,MAAAA,EAAU4+B,gBAAgB,EAAC7iB,SAAS7T,GAAG22B,OAAO7+B,EAAU0tB,OAAOwN,OAAO4D,wBAAwBpqB,UAAS,WAAY1U;AAAAA,QAAAA,EAAUub,YAAYtY,CAAAA;AAAAA,MAAM,GAC/I3C,QAAQ,EAAC2+B,IAAIj/B,EAAU0tB,OAAOwN,OAAOgE,YAAAA,EAAAA,CAAAA;AAAAA,IAErC,GACDqlB,MAAK,SAASthD,GAAKjD;AAAAA,MAAAA,EAAUukD,KAAKthD,CAAAA;AAAAA,IAAM,GACxCuhD,MAAK,SAASvhD;AAAKjD,MAAAA,EAAUywC,SAAAA;IAAiB,GAC9CH,SAAQ,SAASrtC,GAAAA;AAAKjD,MAAAA,EAAUu8B,aAAat5B;IAAM,GACnDwhD,MAAK,SAASxhD,GAAKjD;AAAAA,MAAAA,EAAUu8B,aAAat5B,CAAM;AAAA,IAAA,GAChDiqC,QAAO,SAASjqC,GAAKjD;AAAAA,MAAAA,EAAUywC,WAAkB;AAAA,IAAA,EAAA,EAAA,GAGnDzwC,EAAU4+B,kBAAkB,SAAA,EAAS7iB,SAACA,GAAO8iB,OAAEA,GAAKnqB,UAAEA,GAAQpU,QAAEA;AAC/D,UAAKyb,CAAAA;AACJ,eAAOrH,EAERpU;AAAAA,MAAAA,IAASA,KAAU;AACnB,YAAMkzB,IAAO,EAAKlzB,GAAAA,GAAQkc,MAAMT,EAC5B8iB;AAAAA,MAAAA,MACHrL,EAAKqL,QAAQA,IAEVnqB,MACH8e,EAAK9e,WAAW,SAAS2D,GACpBA;AAAAA,QAAAA,KACH3D;MAEJ,IAEC1U,EAAUyuC,QAAQjb,CACnB;AAAA,IAAA,GACAxzB,EAAU6T,cAAY,SAAS5G,GAAMC,GAAI1I,GACxC;AAAA,UAAIkgD,IAAO,CAAA;AACP1kD,MAAAA,EAAUomB,UAAUnZ,CAAAA,KAAAA,CAAWjN,EAAUmmB,QAAQlZ,CAAAA,MACpDy3C,IAAOz3C,GACPA,IAAQ;AAGT,YAAMyP,IAA+D,OAAnDpT,KAAKhJ,OAAOm7B,kBAAgBnyB,KAAKhJ,OAAOq6B;AACrD1tB,MAAAA,MAAOA,IAAQy3C,EAAKnjD,cAAY6N,KAAKM,MAAO1P,EAAU+J,eAAgBtH,QAAUia,IAAAA,CAAAA,IAAUA;AAC/F,UAAInb,IAAa,IAAIiB,KAAKyK,CAC1B;AAAA,UAAA,CAAKC,GAAI;AACR,YAAIy3C,IAAar7C,KAAKhJ,OAAO8J;AACzBu6C,QAAAA,IAAapjD,EAAW4I,SAC3B5I,MAAAA,EAAWyH,SAAS27C,CAAAA,GACpB13C,IAAQ1L,EAAWkB,QAAAA,IAEpByK,IAAMD,EAAMxK,QAAAA,IAAUia;AAAAA,MACtB;AACD,UAAIlb,IAAW,IAAIgB,KAAK0K,CAAAA;AAGrB3L,MAAAA,EAAWkB,QAAajB,KAAAA,EAASiB,aACnCjB,EAAS+sB,QAAQ/sB,EAASiB,QAAUia,IAAAA,CAAAA,GACrCgoC,EAAKnjD,aAAamjD,EAAKnjD,cAAYA,GACnCmjD,EAAKljD,WAAYkjD,EAAKljD,YAAUA,GAChCkjD,EAAKloC,OAAOkoC,EAAKloC,QAAMlT,KAAKokB,OAAOwN,OAAO3e,WAC1CmoC,EAAKzhD,KAAKqG,KAAKR,WAAW47C,EAAKzhD,MAAMqG,KAAK+C,IAAAA,GAC1C/C,KAAKP,aAAW,YAChBO,KAAKgtB;AACL,YAAMvR,IAAUzb,KAAKuR,SAAS6pC;AAM9B,aALAp7C,KAAKH,UAAU,kBAAiB,CAACG,KAAKR,UAAStE,CAC/C8E,CAAAA,GAAAA,KAAKgtB,eAELhtB,KAAKs7C,cAAY,IACjBt7C,KAAKs6B,aAAap/B,CACXugB,GAAAA;AAAAA,IACR,GACA/kB,EAAUglC,gBAAc,SAASxgC,GAAEmP,GAAAA;AAElC,UADAA,IAAMA,KAAOnP,EAAEE,QACX4E,KAAKhJ,OAAOy6B;AAAU;AAC1B,YAAMxiB,IAAOvY,EAAUkQ,cAAcyD,GAAKhQ,MAAM,GAAA,EAAK,CACrD;AAAA,cAAO4U,GACN;AAAA,QAAA,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AACJ,cAAKvY,CAAAA,EAAUM,OAAOsT;AAAiB;AACvCtK,eAAKuK,YAAYvK,KAAKvE,cAAcP,GAAGxC,MAAK,MAAKwC;AACjD;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK,uBAAuB;AAC3B,gBAAMvB,IAAKqG,KAAK87B,cAAczxB,CAAAA;AAC9B,eAAKrK,KAAKH,UAAU,cAAa,CAAClG,GAAGuB,CAAK,CAAA;AAAA;AACtC8E,eAAKhJ,OAAOukD,uBAAuBv7C,KAAKmB,eAAAA,CAAgBnB,KAAK7E,SAASxB,CAAAA,EAAI0F,WAAWW,KAAKhJ,OAAOqnB,SACpGre,KAAKizB,aAAat5B,CAAAA,IAElBqG,KAAKi7C,KAAKthD,CAAAA;AACX;AAAA,QACA;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AACJ;AAAA,QACD,SAAS;AACR,gBAAM6hD,IAAcx7C,KAAK,cAAYiP;AACrC,cAAIusC;AACHA,YAAAA,EAAYvwC,KAAKjL,MAAK9E,CAGtB;AAAA,mBAAImP,EAAIpI,cAAcoI,KAAOrK;AAC5B,mBAAOtJ,EAAUglC,cAAcxgC,GAAEmP,EAAIpI,UAEvC;AAAA;AAAA,QACA;AAAA,MAEH;AAAA,IAAA,GAEAvL,EAAU+kD,oBAAoB,SAASC,GACtC;AAAA,UAAIC,IAAS;AACb,UAAI37C,KAAKqF,OAAM;AACd,YAAIK,IAAQ,GACR9L,IAAI;AACR,eAAO8L,IAAQ1F,KAAKqF,MAAMzL,CAAAA,IAAK8hD,KAAS9hD,IAAIoG,KAAKqF,MAAMxL;AACtD6L,UAAAA,KAAS1F,KAAKqF,MAAMzL,CACpBA,GAAAA;AAID,YAFA+hD,IAAS/hD,KAAKoG,KAAKqF,MAAMzL,CAAAA,KAAO8hD,IAAQh2C,KAAQ1F,KAAKqF,MAAMzL,KAAM,IAE7DoG,KAAKsF,YACLq2C,KAAU37C,KAAKqF,MAAMxL;AACvB,iBAAM8hD,KAAU,KAAK37C,KAAKsF,SAASQ,KAAK+D,MAAM8xC,CAAAA,CAAAA;AAC7CA,YAAAA;AAAAA,MAKH;AACD,aAAOA;AAAAA,IACR,GAGAjlD,EAAUklD,yBAAyB,SAASC,GAE3C;AAAA,UAAI77C,KAAKqF,OAEJ;AACJ,cAAMs2C,IAAS37C,KAAKy7C,kBAAkBI,EAAI75B,CAAAA;AAI1C,eAFA65B,EAAI75B,IAAElc,KAAKE,IAAIhG,KAAKqF,MAAMxL,SAAO,GAAGiM,KAAKC,IAAI,GAAED,KAAKg2C,KAAKH,CAAAA,IAAQ,CACjEE,CAAAA,GAAAA,EAAI95B,IAAEjc,KAAKC,IAAI,GAAED,KAAKg2C,KAAW,KAAND,EAAI95B,KAAM/hB,KAAKhJ,OAAOq6B,YAAUrxB,KAAKhJ,OAAOkP,aAAe,IAAA,CAAA,IAAGlG,KAAKhJ,OAAO8J,cAAY,KAAGd,KAAKhJ,OAAOq6B,YACzHwqB;AAAAA,MACP;AAPA,aAAOA;AAAAA,IAQT,GAEAnlD,EAAUqlD,gBAAc,SAASt/C,GAAAA;AAChC,UAAIo/C;AACJ,YAAMpuC,IAAOnJ,SAASmJ,MAChB2K,IAAkB9T,SAAS8T;AAG5ByjC,MAAAA,IAFA77C,KAAKg8C,KAAKj5B,QAAAA,CAAStmB,EAAGw6B,SAASx6B,CAAAA,EAAGy6B,QAE9B,EACRlV,GAAEvlB,EAAGwlB,WAAWxU,EAAK4S,cAAYjI,EAAgBiI,cAAY,KAAK5S,EAAK+S,YACvEuB,GAAEtlB,EAAGylB,WAAWzU,EAAK0S,aAAW/H,EAAgB+H,aAAW,KAAK1S,EAAK8S,UAAAA,IAHjE,EAACyB,GAAEvlB,EAAGw6B,OAAOlV,GAAEtlB,EAAGy6B,MAAAA,GAMnBl3B,KAAKhJ,OAAOsgC,OAAOt3B,KAAKi8C,UAC3BJ,EAAI75B,IAAIhiB,KAAKxG,WAAW4d,cAAc,eAAA,EAAiB6C,cAAc4hC,EAAI75B,GACzE65B,EAAI75B,KAAKhiB,KAAKi1B,YAAYjW,gBAAgBhf,KAAKuuB,IAC5B,GAAfvuB,KAAKoB,UAAU,YAClBy6C,EAAI75B,KAAKhiB,KAAKyX,GAAGohC,gBAGlBgD,EAAI75B,KAAGhiB,KAAKi1B,YAAYjW,gBAAgBhf,KAAKuuB,IAAOvuB,KAAAA,KAAKmB,cAAY,IAAEnB,KAAKyX,GAAGohC;AAGhF,YAAMqD,IAAWl8C,KAAKxG,WAAW4d,cAAc,eAAA;AAE/CykC,MAAAA,EAAI95B,KAAG/hB,KAAKi1B,YAAY9V,eAAe+8B,CAAUl8C,IAAAA,KAAKO,KAAmB,aAAE,CAAA,EAAG4f,WAC9E07B,EAAIp/C,KAAKA;AACT,YAAM2T,IAAUpQ,KAAK,WAASA,KAAKoB,KAAAA;AACnC,UAAIgP;AACHyrC,QAAAA,IAAMzrC,EAAQnF,KAAKjL,MAAK67C,CAGxB;AAAA,eAAK77C,KAAKmB,aAEH;AACN,cAAMw6C,IAAS37C,KAAKy7C,kBAAkBI,EAAI75B;AAC1C,YAAKhiB,CAAAA,KAAKqF,SAAUrF,CAAAA,KAAKi8C;AACxB,iBAAOJ;AACR,YAAIrvB,IAAG;AACP,aAAKA,IAAG,GAAGA,IAAKxsB,KAAKi8C,OAAOE,QAAQtiD,UAC/BmG,EAAAA,KAAKi8C,OAAOE,QAAQ3vB,CAAAA,IAAIqvB,EAAI95B,IADWyK;AAAAA;AAG5CqvB,QAAAA,EAAI95B,IAAEjc,KAAKg2C,KAA+C,MAAxCh2C,KAAKC,IAAI,GAAG41C,CAAyB,IAAA,IAAjB71C,KAAKC,IAAI,GAAEymB,IAAG,CAAS,KAAA,KAAGxsB,KAAKhJ,OAAOq6B,SAExE36B,IAAAA,EAAU+I,cAAcO,KAAKoB,SAAS,aACzCy6C,EAAI95B,IAAuD,MAApDjc,KAAKC,IAAI,GAAED,KAAKg2C,KAAKH,CAAAA,IAAQ,KAAoB,IAAjB71C,KAAKC,IAAI,GAAEymB,IAAG,MAAS,KAAGxsB,KAAKhJ,OAAOq6B,YAG1ErxB,KAAKP,cAAc,UAClB/I,EAAU0lD,qBAAqB1lD,EAAUM,OAAOqlD,oBACnDR,EAAIv2C,WAAW,IAEVtF,KAAKs7C,YAAYgB,kBACrBt8C,KAAKs7C,YAAYgB,gBAAgBt8C,KAAKu8C,uBAAuBv8C,KAAKs7C,YAAYrjD,YAAY+H,KAAKs7C,YAAYpjD,UAAU,EAAEskD,QAAO,GAAGC,QAAO,MAAA,CAAA,KAI3IZ,EAAI75B,IAAE;AAAA,MACN;AAzBA65B,QAAAA,IAAM77C,KAAK47C,uBAAuBC,CAAAA;AA4BpC,aADAA,EAAIa,aAAa,oBAAIxjD,QACd2iD;AAAAA,IACR,GACAnlD,EAAU4jD,mBAAiB,WAC1B;AAAA,WAAI,oBAAIphD,QAAOC,QAAWzC,KAAAA,EAAUyb,cAAY,KAAK,OAAOzb,EAAU+jD,UAAS;AAC9E,cAAMkC,IAAiBjmD,EAAU0tB,OAAOwN,OAAO6b;AAE/C/2C,QAAAA,EAAU4+B,gBAAgB,EACzB7iB,SAASkqC,GACTpnB,OAAO7+B,EAAU0tB,OAAOwN,OAAOgrB,uBAC/BxxC,UAAU,WAAA;AACT1U,UAAAA,EAAUywC,SAASzwC,EAAUM,OAAO6lD,gBAAAA;AAAAA,QACpC,MAECF,MACF38C,KAAKR,WAAWQ,KAAKw6B,YAAYx6B,KAAKP,aAAa;AAAA,MAEpD;AAAA,IACF,GACA/I,EAAUomD,iBAAe,SAASn5C,GAAOgN,GAAAA;AACxC,aAAOhN,IAAmG,OAA3F,IAAKzK,KAAKxC,EAAUkK,SAAAA,EAAYwkB,sBAAoB,IAAKlsB,KAAKyK,GAAQyhB,kBAA4BzU,MAAAA,IAAAA,KAAQ;AAAA,IAC1H,GAEAja,EAAUqmD,kBAAkB,SAASC,GAASC;AAC7C,eAASC,EAAKC,GAASC,GAAS1iB,GAAAA;AAC/B,eAAU50B,KAAKu1B,IAAI8hB,IAAUC,CAAW1iB,IAAAA;AAAAA,MACxC;AAED,aAAKsiB,CAAAA,KAAAA,CAAWh9C,KAAKw6B,aAOXx6B,CAAAA,EAAAA,KAAKw6B,UAAU6iB,aAAcr9C,CAAAA,KAAKw6B,UAAUkiB,aAAcO,EAAQP,YAAY18C,KAAKw6B,UAAUkiB,YAJzF,OAI+GQ,EAAKF,EAAQvgD,GAAGwlB,SAASg7B,EAAQxgD,GAAGwlB,SAHnJ,CAGsKi7B,KAAAA,EAAKF,EAAQvgD,GAAGylB,SAAS+6B,EAAQxgD,GAAGylB,SAH1M;IAIf,GAEAxrB,EAAU4mD,2BAA2B,SAAS35C,GAC7C;AAAA,UAAIvK;AACA1C,MAAAA,EAAUuG,WACb7D,IAAM1C,EAAUuG,OAAOvG,EAAU0K,KAClChI,IAAAA,IAAMA,KAAQ,EAAEojD,QAAO,GAAGC,QAAO,MAEjC94C,GAAAA,IAAQ,IAAIzK,KAAKyK,CAAAA;AACjB,UAAI8C,IAAM;AAIV,cAHGrN,EAAImkD,qBAAqBnkD,EAAIokD,qBAC/B/2C,IAAyB,MAAlBrN,EAAI2H,aAAW,MAA0B,KAAjB4C,EAAM9C,SAAAA,IAAc8C,EAAMxB,WAAAA,MAAiB,IAE9D,IAANwB,KAAWjN,EAAU+mD,4BAA4B95C,GAAO8C,GAAKrN,CAAAA,IAAQqN;AAAAA,IAC7E,GACA/P,EAAUgnD,yBAAyB,SAAS/5C,GAAOyP,GAAAA;AAClD,UAAIha;AACA1C,MAAAA,EAAUuG,WACb7D,IAAM1C,EAAUuG,OAAOvG,EAAU0K,KAAAA,IAElChI,IAAMA,KAAQ,EAAEojD,QAAO,GAAGC,QAAO;AAEjC,YAAM74C,IAAY,IAAND,IAAUjN,EAAU+mD,4BAA4B95C,GAAOyP,GAAUha,CAAAA;AAC7E,aAAO,IAAIF,KAAS,IAAJ0K,KAASlN,EAAU+mD,4BAA4B75C,GAAM,IAAGxK,GAAM,EAAA,IAAK,EACpF;AAAA,IAAA,GAEA1C,EAAUwkC,iBAAe,SAAShgC;AACjC,UAAI8E,KAAKP,YAAW;AACnB,YAAIo8C,IAAI77C,KAAK+7C,cAAc7gD,CAAAA;AAC3B,YAAI8E,KAAK+8C,gBAAgB/8C,KAAKw6B,WAAWqhB,CAAAA,GAAK;AAC7C,cAAIl4C,GAAOC;AAIX,cAHI5D,KAAKy6C,YAAUz6C,KAAKR,YACvBQ,KAAKs6C,qBAEFt6C,KAAKP;AACR;AAED,cAAIk+C,IAAe;AAUnB,cATG39C,KAAKw6B,aAAAA,CAAcx6B,KAAKw6B,UAAU6iB,eACpCM,IAAe39C,KAAKw6B,WACP6iB,iBAGdr9C,KAAKw6B,YAAYqhB,GAEjB77C,KAAKw6B,UAAU6iB,gBAEXr9C,KAAKP,cAAY,UAAS;AAa7B,gBAVGk+C,MACF9B,IAAM8B,IAGP39C,KAAKs6C,iBACLt6C,GAAAA,KAAKxE,SAASwE,KAAKq6C,UAAAA,GACnBr6C,KAAKgtB,WAAS,IAEdrpB,IAAQ3D,KAAK49C,mBAAmB/B,CAAK1iD,EAAAA,QAAAA,GAAAA,CAEhC6G,KAAK69C;AAET,qBADU79C,KAAKH,UAAU,wBAAwB,CAAC3E,GAAG8E,KAAKR,QAO1DQ,CAAAA,KAAAA,KAAKgtB,WAAS,IAAA,MACdhtB,KAAK69C,cAAYl6C,YANhB3D,KAAKgtB,WAAAA;AAUPppB,YAAAA,IAAMD,GACK3D,KAAK69C;AAGhB,gBAAI5lD,IAAa,IAAIiB,KAAK8G,KAAK69C,cAC3B3lD,IAAW,IAAIgB,KAAK0K,CACJ;AAAA,YAAd5D,KAAKoB,SAAS,SAASpB,KAAKoB,SAAS,UACzCnJ,EAAW4I,SAAAA,KAAc3I,EAAS2I,SACnC5I,KAAAA,EAAWkK,gBAAgBjK,EAASiK,WAAAA,MACnCjK,IAAW,IAAIgB,KAAK8G,KAAK69C,cAAY,GAIvC79C,IAAAA,KAAKR,WAASQ,KAAK+C,IAAAA,GACnB/C,KAAKuR,SAAStZ,GAAYC,GAAU8H,KAAKokB,OAAOwN,OAAO3e,WAAWjT,KAAKR,UAAUq8C,EAAIiC,MAErF99C,GAAAA,KAAKH,UAAU,kBAAiB,CAACG,KAAKR,UAAStE,CAAAA,CAAAA,GAC/C8E,KAAKgtB,WAAAA,IACLhtB,KAAKP,aAAW;AAAA,UAEhB;AAED,cAEIrG,GAFA2kD,IAAW/9C,KAAKhJ,OAAOq6B,WACvB50B,IAAGuD,KAAK7E,SAAS6E,KAAKR;AAM1B,cAJI9I,EAAUuG,WACb7D,IAAM1C,EAAUuG,OAAOvG,EAAU0K,KAAAA,IAClChI,IAAMA,KAAQ,EAAEojD,QAAO,GAAGC,QAAO,SAE7Bz8C,KAAKP,cAAY;AACpBkE,YAAAA,IAAQ3D,KAAKY,UAAUzH,QAAAA,IAAoD,OAAzC0iD,EAAI95B,IAAE/hB,KAAKhJ,OAAOq6B,YAAgB,KAANwqB,EAAI75B,IAAK,KAClE65B,CAAAA,EAAImC,UAAUh+C,KAAKmB,gBACvBwC,KAA8C,MAArC3D,KAAKtH,KAAKysB,UAAU1oB,EAAGxE,UAAAA,IAAAA,CAG5B+H,KAAKmB,eAAenB,KAAKi+C,kBAAkBj+C,KAAKs7C,YAAY4C,sBAAsBpgB,WACtF99B,KAAKs7C,YAAY4C,oBAAoBv6C,IAAQlH,EAAGxE,aAG7C+H,KAAKs7C,YAAY4C,sBACpBv6C,KAAS3D,KAAKs7C,YAAY4C,oBAG3Bv6C,IAAQ3D,KAAK88C,eAAen5C,CAExBk4C,GAAAA,EAAIv2C,YAAYtF,KAAKhJ,OAAOqlD,mBAAmBr8C,KAAKmB,eAAe/H,KAEtEuK,IAAQjN,EAAU4mD,yBAAyB35C,IAC3CC,IAAMlN,EAAUgnD,uBAAuB/5C,GAAM3D,KAAKs7C,YAAYgB,aAAAA,KAG9D14C,IAAMnH,EAAGvE,SAASiB,QAAWsD,KAAAA,EAAGxE,WAAWkB,QAAUwK,IAAAA;AAAAA,eAChD;AAGN,gBAFAA,IAAQlH,EAAGxE,WAAWkB,QACtByK,GAAAA,IAAMnH,EAAGvE,SAASiB,QAAAA,GACd6G,KAAKmB,aAAa;AACrB,kBAAIg9C,IAAcn+C,KAAKY,UAAUzH,QAAAA,IAAU0iD,EAAI95B,IAAE/hB,KAAKhJ,OAAOq6B,YAAU,OAASwqB,EAAImC,SAAO,IAAE;AAC7F,kBAAIh+C,KAAKoB,SAAS;AAEjB,oBADA+8C,IAAcn+C,KAAK88C,eAAeqB,KAC9Bn+C,GAAAA,KAAKo+C,kBAAmB;AAC3B,sBAAIz5C,IAAM;AACNw5C,kBAAAA,KAAeznD,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAK0K,IAAIe,IAAI,IAAIxL,QAChEwK,MAAAA,IAAQw6C,IAAcx5C;AAAAA,gBAC9B;AACOf,kBAAAA,IAAMu6C;AAAAA,uBAGJn+C,KAAKhJ,OAAOqlD;AACd,oBAAIR,EAAIwC;AACP16C,kBAAAA,IAAQjN,EAAU4mD,yBAAyBa,CAExC/kD,GAAAA,EAAIf,kBAAkBe,EAAI0H,cAAc1H,EAAI2H,aAAa3H,EAAIqjD,UAAU,UACzE94C,IAAQ,IAAIzK,KAAW,IAANyK,IAAUvK,EAAImkD,iBAUhC;AAAA,yBAPA35C,IAAMlN,EAAUgnD,uBAAuBS,GAAa,CAEjD/kD,GAAAA,EAAIf,kBAAkBe,EAAI0H,cAAc1H,EAAI2H,aAAa3H,EAAIqjD,UAAU,UACzE74C,IAAMlN,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAK0K,CAAAA,CAAAA,GACxCA,IAAM,IAAI1K,KAAS,IAAJ0K,IAAQxK,EAAIokD,eAGzBpkD,IAAAA,EAAIf,kBAAkB3B,EAAU,YAAUA,EAAU0K,KAAwB,KAAdhI,EAAIqjD,UAAU,OAAM;AACpF,wBAAMnrC,IAAStR,KAAK,YAAUA,KAAKoB,KAAAA;AACnC,sBAAIk9C,IAAU5nD,EAAUgC,KAAKC,IAAI,IAAIO,KAAK0K,KAAOxK,EAAIojD,QAAQpjD,EAAIqjD,MAC9DnrC;AAAAA,kBAAAA,EAAOgtC,CACT16C,MAAAA,IAAM06C;AAAAA,gBAEP;AAAA;AAIEzC,gBAAAA,EAAIwC,oBACP16C,IAAQw6C,IAERv6C,IAAMu6C;AAAAA,YAId,OAAW;AACN,kBAAII,IAAgBv+C,KAAKtH,KAAKwF,UAAU,IAAIhF,KAAKuD,EAAGvE,SAASiB,QAAY,IAAA,CAAA,CAAA,EAAIA,WACzEqlD,IAAe,IAAItlD,KAAKqlD,CAAAA,GACxBE,IAAYz+C,KAAKhJ,OAAO8J,YAExB49C,IAAiC,KAAGX,KADzB/9C,KAAKhJ,OAAO+J,YACJ09C;AAEvBz+C,mBAAKhJ,OAAOq6B,YAAY;AACxB,kBAAIstB,IAAa3+C,KAAK+7C,cAAc7gD,CACpC8E;AAAAA,mBAAKhJ,OAAOq6B,YAAY0sB;AAExB,kBAAIa,IAAU/C,EAAI95B,IAAEg8B,IAAS,KACzBlJ,IAAU/uC,KAAKE,IAAI61C,EAAI95B,IAAI,GAAG28B,CAAAA,IAAMX,IAAS,KAC7Cc,IAA2B,MAAbF,EAAW58B;AAI5Bne,cAAAA,IADEkC,KAAKu1B,IAAIujB,IAAUC,KAAe/4C,KAAKu1B,IAAIwZ,IAAUgK,CAAAA,IACjDN,IAAgB1J,IAEhB0J,IAAgBK,GAEvBh7C,KAAuF,OAA1E,IAAK1K,KAAK0K,GAAMwhB,kBAAsBo5B,IAAAA,EAAap5B,kBAChEplB,IAAAA,KAAKO,KAAmB,aAAE,GAAG5I,MAAMmgC,SAAO,YACtC93B,KAAKoB,SAAS,UAAUpB,KAAKoB,SAAS,UACzCwC,IAAM5D,KAAK88C,eAAel5C;YAC3B;AACD,gBAAI5D,KAAKP,cAAc;AACtB,kBAAImE,KAAO5D,KAAK69C,aAAY;AAC3B,oBAAIx4B,IAAQw2B,EAAIx2B,UAASrlB,KAAKmB,gBAAgB06C,EAAImC,SAAQ,QAAY;AACtEr6C,gBAAAA,IAAQC,KAAKi4C,EAAIx2B,QAAM,IAAEA,IACzBzhB,IAAM5D,KAAK69C,eAAax4B,KAAiB,MAAT04B;AAAAA,cACtC;AACMp6C,gBAAAA,IAAQ3D,KAAK69C;AAAAA;AAGVj6C,cAAAA,KAAKD,MAINC,IAFCxK,KAAOA,EAAIf,iBACVe,EAAIqjD,UAAU,UAAUrjD,EAAIqjD,UAAU,WACpC/lD,EAAUgC,KAAKC,IAAIgL,GAAOvK,EAAIojD,QAAQpjD,EAAIqjD,MAE1C/lD,IAAAA,EAAUgC,KAAKC,IAAIjC,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKyK,KAAS,GAAGvK,EAAIqjD,UAGtE94C,IAAe,MAATo6C;AAAAA,UAIb;AACD,cAAIe,IAAU,IAAI5lD,KAAK0K,IAAI,CACvBm7C,GAAAA,IAAY,IAAI7lD,KAAKyK,CAAAA;AAEzB,cAAG3D,KAAKP,cAAY,UAAU/I,EAAUM,OAAOgoD,mBAAAA,CAC5CD,KAAaroD,EAAUkK,aAAAA,CAAcgD,KAAOlN,EAAUiK,YAAW;AAEnE,gBAAIlE,CAAAA,EAAGxE,aAAcvB,CAAAA,EAAUkK,aAAcnE,CAAAA,EAAGvE,YAAYxB,EAAUiK;AAErEo+C,cAAAA,IAAY,IAAI7lD,KAAKuD,EAAGxE,UACxB2L,GAAAA,IAAM,IAAI1K,KAAKuD,EAAGvE,QAAAA;AAAAA,iBACd;AAEJ,kBAAIkb,IAAWxP,IAAMm7C;AAEjBA,eAAAA,IAAAA,CAAaroD,EAAUkK,aAC1Bm+C,IAAY,IAAI7lD,KAAKxC,EAAUkK,SAAAA,GAC3Bi7C,EAAIv2C,YAAYtF,KAAKhJ,OAAOqlD,mBAAmBr8C,KAAKmB,eACvD49C,IAAY,IAAI7lD,KAAKxC,EAAU4mD,yBAAyByB,CAAAA,CAAAA,GACrD3lD,EAAImkD,sBACNwB,IAAY,IAAI7lD,KAAK6lD,EAAU5lD,YAAYC,EAAImkD,iBAAAA,IAChD35C,IAAM,IAAI1K,KAAe,IAAV6lD,IAAc/+C,KAAKy9C,4BAA4BsB,GAAW/+C,KAAKs7C,YAAYgB,eAAeljD,CAEzGwK,CAAAA,KAAAA,IAAM,IAAI1K,KAAAA,CAAM6lD,IAAY3rC,CAAAA,MAG7BxP,IAAM,IAAI1K,KAAKxC,EAAUiK,SAErBk7C,GAAAA,EAAIv2C,YAAYtF,KAAKhJ,OAAOqlD,mBAAmBr8C,KAAKmB,eACpD/H,EAAIokD,oBACN55C,IAAM,IAAI1K,KAAK0K,EAAIzK,YAAYC,EAAIokD,eAAAA,IACpC55C,IAAM,IAAI1K,KAAS,IAAJ0K,IAAQ5D,KAAKy9C,4BAA4B75C,GAAK,GAAGxK,GAAAA,MAChE2lD,IAAY,IAAI7lD,KAAS,IAAJ0K,IAAQ5D,KAAKy9C,4BAA4B75C,GAAK5D,KAAKs7C,YAAYgB,eAAeljD,GAAAA,MAChG4G,KAAKo8C,sBACP2C,IAAYroD,EAAUgC,KAAKC,IAAIomD,GAAW3lD,EAAIojD,QAAQpjD,EAAIqjD,MAC1D74C,GAAAA,IAAM,IAAI1K,KAAS,IAAJ0K,IAAQ5D,KAAKy9C,4BAA4B75C,GAAK,GAAGxK,GAAK,EAAA,CAAA,GACrEwK,IAAMlN,EAAUgC,KAAKC,IAAIiL,GAAKxK,EAAIojD,QAAQpjD,EAAIqjD,MAI/CsC,MAAAA,IAAY,IAAI7lD,KAAM0K,CAAAA,IAAMwP;YAK9B;AACG0rC,YAAAA,IAAU,IAAI5lD,KAAK0K,IAAI,CAC3B;AAAA,UAAA;AA0CD,cArCI5D,CAAAA,KAAKmB,eAAenB,KAAKi+C,kBAAAA,CAC3BvnD,EAAUM,OAAOioD,cAAAA,CACfvoD,EAAUwoD,kBAAuBrD,KAAAA,EAAI75B,KAAKhiB,KAAKm/C,gBAAgB,EAAClnD,YAAY,IAAIiB,KAAKyK,IAAQzL,UAAS,IAAIgB,KAAKyK,CAAa,EAAA,CAAA,KAAA,IAAIzK,KAAKyK,CAAO9C,EAAAA,SAAAA,IAAab,KAAKhJ,OAAO8J,gBACpKsS,IAAWxP,IAAMm7C,GACjB/+C,KAAKP,cAAc,WAClBkF,IAAM3E,KAAKY,UAAUzH,QAAAA,IAAqB,KAAR0iD,EAAI75B,IAAS,KAAM,MACzD+8B,IAAY,IAAI7lD,KAAKyL,CAAAA,GACXjF,SAASM,KAAKhJ,OAAO8J,UAAAA,GAAAA,CAE3Bi+C,MAActiD,EAAGxE,aACpB2L,IAAM,IAAI1K,KAAAA,CAAM6lD,IAAY3rC,CAE5B2rC,IAAAA,IAAY,IAAI7lD,KAAAA,CAAM0K,IAAMwP,CAAAA,KAM3BpT,KAAKmB,eACPzK,EAAUM,OAAOioD,aACfvoD,EAAAA,CAAAA,EAAUY,aAAaukD,EAAI75B,KAAKhiB,KAAKm/C,gBAAgB,EAAClnD,YAAY,IAAIiB,KAAK0K,CAAAA,GAAM1L,UAAS,IAAIgB,KAAK0K,SAAW,IAAI1K,KAAK0K,CAAK/C,EAAAA,SAAAA,KAAcb,KAAKhJ,OAAO+J,eACrJqS,IAAWxP,IAAMm7C,GACjBp6C,IAAM3E,KAAKY,UAAUzH,QAAiB,IAAA,KAAN0iD,EAAI75B,IAAK,KAAI,MACjDpe,IAAMlN,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKyL,KACpCjF,SAASM,KAAKhJ,OAAO+J,SAAAA,GACzB+9C,IAAU,IAAI5lD,KAAK0K,IAAI,CAAA,GACpB5D,KAAKP,cAAc,WAAdA,CAEHs/C,MAActiD,EAAGxE,aACpB2L,IAAM,IAAI1K,KAAM6lD,CAAAA,IAAY3rC,KAE5B2rC,IAAY,IAAI7lD,MAAM0K,IAAMwP,CAAAA,KAAAA,CAM3BpT,KAAKmB,eAAezK,EAAUM,OAAOioD,WAAU;AAClD,gBAAIt6C,IAAM3E,KAAKY,UAAUzH,YAAiB,KAAN0iD,EAAI75B,IAAK,KAAI;AAC9C,gBAAI9oB,KAAKxC,EAAUmnD,WAAAA,EAAa1/C,YAAY,IAAIjF,KAAKyL,OACvDA,IAAM,IAAIzL,KAAKxC,EAAUmnD,WAAAA;AAE1B,gBAAIuB,IAAuB,IAAIlmD,KAAKyL,GAAKjF,SAASM,KAAKhJ,OAAO+J,SAC1DrK;AAAAA,YAAAA,EAAUmnD,eAAe79C,KAAKP,cAAc,cAAc2/C,IAAuB,IAAIlmD,KAAK0K,QAC7FA,IAAMlN,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKyL,CACpCjF,CAAAA,GAAAA,SAASM,KAAKhJ,OAAO+J,SACzB+9C,GAAAA,IAAU,IAAI5lD,KAAK0K,IAAI;UAExB;AAGD,cAAG5D,KAAKmB,eAAezK,EAAU,YAAUsJ,KAAKoB,KAA4B,MAAjBpB,KAAKP,cAAY,YAAYO,KAAKP,cAAY,eAAgBmE,CAAAA,IAAAA,CAAOlN,EAAUiK,WAAU;AACnJiD,YAAAA,IAAM,IAAI1K,KAAKxC,EAAUiK;AACzB,kBAAM2Q,IAAStR,KAAK,YAAUA,KAAKoB;AACnC,mBAAOkQ,EAAO1N;AACbA,cAAAA,IAAMlN,EAAUgC,KAAKC,IAAIiL,GAAAA,CAAMxK,EAAIojD,QAAQpjD,EAAIqjD;AAEhD74C,YAAAA,IAAMlN,EAAUgC,KAAKC,IAAIiL,GAAKxK,EAAIojD,QAAQpjD,EAAIqjD,MAAAA;AAAAA,UAC9C;AAGD,cAAKz8C,KAAKmB,eAAgB29C,EAAQvgD,QAAAA,KAAWwgD,EAAUxgD,QAAAA,KAAaugD,EAAQj+C,SAAAA,IAAWb,KAAKhJ,OAAO+J,aAAcrK,EAAU2oD;AAG1H,gBAFA5iD,EAAGxE,aAAW8mD,GACdtiD,EAAGvE,WAAS,IAAIgB,KAAK0K,IACjB5D,KAAKhJ,OAAOsoD,eAAc;AAE7B,kBAAIC,IAAK7oD,EAAU6J,KAAmB,aAAE,CAAA,EAAG4f;AAC3CngB,mBAAKw/C,eACL9oD,EAAU6J,KAAmB,aAAE,CAAG4f,EAAAA,YAAYo/B;AAAAA,YAC9C;AACAv/C,mBAAK2M,YAAY3M,KAAKR,QAEpBQ;AAAAA,eAAKmB,eACRnB,KAAKm8B,aAAan8B,KAAKR,UAAS,SAASiP;AACxCA,YAAAA,EAAEjJ,aAAW;AAAA,UAClB,CAAA,GAGGxF,KAAKH,UAAU,eAAe,CAACG,KAAKR,UAAUQ,KAAKP,YAAYvE;QAC/D;AAAA,MACH,WACMxE,EAAUkJ,WAAW,aAAA,GAAe;AACvC,YAAIjG,IAAKqG,KAAK87B,cAAc5gC,EAAEE,UAAQF,EAAEoiB,UAAAA;AACxCtd,aAAKH,UAAU,eAAc,CAAClG,GAAGuB,CACjC,CAAA;AAAA,MAAA;AAAA,IAEH,GACAxE,EAAUwlC,iBAAe,SAAShhC,GAAEmP,GAAAA;AAGnC,UAAInP,EAAEqjB,UAAU,KAAVA,CAGFve,KAAKhJ,OAAOy6B,YAAAA,CAAYzxB,KAAKP,YAAjC;AACA4K,QAAAA,IAAMA,KAAMnP,EAAEE,UAAQF,EAAEoiB;AACxB,YAAIH,IAAYzmB,EAAUkQ,cAAcyD,GAAKhQ,MAAM,GAAA,EAAK;AASxD,gBAPI2F,KAAKhJ,OAAOyoD,mBAAmBtiC,KAAa,cAC5C9S,EAAIpI,cAAcoI,EAAIpI,WAAWuD,UAAUqB,QAAQ,qBACrDsW,MADiF,OACjFA,IAAY,kBACZnd,KAAKi+C,iBAAiB,KAIhB9gC;UACP,KAAK;AAAA,UACL,KAAK;AACAnd,iBAAKmB,gBACRnB,KAAKP,aAAW;AACjB;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AACJO,iBAAKP,aAAW;AAChB;AAAA,UACD,KAAK;AACJO,iBAAKP,aAAW,UACA/I,EAAUkQ,cAAcyD,GACzBxD,QAAQ,sBAAA,IAA0B,IAChDnQ,EAAU0nD,mBAAAA,KAEV1nD,EAAU0nD,mBAAAA;AAEX;AAAA,UACD,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AACJp+C,iBAAKP,aAAW;AAChB;AAAA,UACD,KAAK;AACJ,gBAAI4K,EAAIpI;AACP,qBAAOvL,EAAUwlC,eAAehhC,GAAEmP,EAAIpI,UAAAA;AACvC;AAAA,UACD;AACC,kBAAKvL,EAAUkJ,WAAW,kBAAkBlJ,EAAUmJ,UAAU,eAAe,CAACsd,GAAWjiB,CACtFmP,CAAAA,MAAAA,EAAIpI,cAAcoI,KAAOrK,QAAQmd,KAAa;AACjD,qBAAOzmB,EAAUwlC,eAAehhC,GAAEmP,EAAIpI,UAAAA;AAGxCjC,iBAAKP,aAAW,MAChBO,KAAKR,WAAS;AAAA,QAGhB;AAAA,YAAIQ,KAAKP,YAAW;AACnB,cAAI9F,IAAKqG,KAAK87B,cAAczxB,CAAAA;AAC5B,cAAKrK,KAAKhJ,OAAO,UAAQgJ,KAAKP,eAAgBO,KAAKH,UAAU,gBAAe,CAAClG,GAAIqG,KAAKP,YAAYvE,CAE7F,CAAA,GAAA;AAKJ,gBAJA8E,KAAKR,WAAU7F,IAEXqG,KAAKy6C,YAAUz6C,KAAKR,YAAaQ,KAAKy6C,YAAYz6C,KAAKP,cAAc,aACxEO,KAAKs6C,iBACFt6C,GAAAA,CAAAA,KAAKP;AACR;AAEDO,iBAAKs7C,cAAc5kD,EAAUiM,YAAY3C,KAAK7E,SAAS6E,KAAKR,QAAAA,KAAa,CAAA,CACzEQ,GAAAA,KAAKw6B,YAAYx6B,KAAK+7C,cAAc7gD;UACpC;AAXA8E,iBAAKP,aAAWO,KAAKR,WAAS;AAAA,QAY/B;AACDQ,aAAK69C,cAAY;AAAA,MAnEmC;AAAA,IAoErD,GAGAnnD,EAAUgpD,0BAA0B,SAAS5oD,GAC5C;AAAA,UAAIgnD,IAAS,CAAA;AACb,eAAQlkD,KAAK9C;AACU,QAAnB8C,EAAEiN,QAAQ,GAAA,MAAS,MACrBi3C,EAAOlkD,CAAAA,IAAAA;AAGT,aAAOkkD;AAAAA,IACR,GACApnD,EAAUipD,8BAA8B,SAASC,GAAOC;AACvD,UAAIC,IAAU9/C,KAAK0/C,wBAAwBE,CACvCG,GAAAA,IAAgB//C,KAAK0/C,wBAAwBG,CAAAA;AACjD,eAAQjmD,KAAKmmD;AACRD,QAAAA,EAAQlmD,CAAAA,KAAAA,OACJimD,EAAcjmD,CAAAA;AAAAA,IAGxB,GAGAlD,EAAU4jC,eAAa,SAASp/B,GAAAA;AAC/B,WAAIA,KAAKA,EAAEqjB,UAAU,KAAKve,CAAAA,KAAKg5B,SAA/B;AACA,YAAIh5B,KAAKP,cAAcO,KAAKR,UAAS;AACpCQ,eAAKO,KAAmB,aAAE,CAAG5I,EAAAA,MAAMmgC,SAAO;AAG1C,cAAIgD,IAAU96B,KAAKR,UACfvE,IAAO+E,KAAKP,YAEZugD,IAAAA,CAAShgD,KAAKw6B,aAAax6B,KAAKw6B,UAAU6iB;AAAAA,iBACvCr9C,KAAKs7C,YAAY4C;AAExB,cAAIzhD,IAAGuD,KAAK7E,SAAS6E,KAAKR;AAC1B,cAAIwgD,MAAUhgD,KAAKs7C,YAAY2E,gBAAAA,CAAiBjgD,KAAKs7C,YAAYrjD,cAAcwE,EAAGxE,WAAWkB,QAAAA,KAAW6G,KAAKs7C,YAAYrjD,WAAWkB,QAAasD,KAAAA,EAAGvE,SAASiB,QAAAA,KAAW6G,KAAKs7C,YAAYpjD,SAASiB,YAAW;AAC5M,gBAAI+mD,IAAQlgD,KAAKP,cAAY;AAC7B,gBAAKO,KAAKH,UAAU,wBAAuB,CAACpD,GAAIvB,GAAGglD,GAAQlgD,KAAKs7C;AAY/D,kBADAt7C,KAAKR,WAAWQ,KAAKP,aAAa,MAC9BygD,KAAUlgD,KAAKhJ,OAAOmpD,gBAAe;AAIxC,oBAHAngD,KAAKxE,SACLwE,GAAAA,KAAKmS,aAAW,oBAAIjZ,QAEhB8G,KAAKmB,eAAenB,KAAKhJ,OAAOopD,sBAAsBpgD,KAAKhJ,OAAOqnB,WAAWre,KAAKV,cAAcU,KAAK7E,SAAS2/B,CAEjH,CAAA;AAAA,yBADApkC,EAAUmJ,UAAU,aAAa,CAACi7B,GAAS7/B,GAAMC,KAC1C8E,KAAKizB,aAAa6H,CAE1B96B;AAAAA,qBAAKw6B,YAAY,IACjBx6B,KAAKq6C,aAAar6C,KAAKy6C,WAAW3f;AAAAA,cACvC;AACU96B,qBAAKmS,cACTnS,KAAKH,UAAUqgD,IAAO,iBAAe,kBAAiB,CAACplB,GAAQ96B,KAAK7E,SAAS2/B,CAvB3EolB,CAAAA,CAAAA;AAAAA;AAAAA,cAAAA,IACHlgD,KAAKiS,YAAYxV,EAAG9C,MAEpBqG,KAAAA,KAAKs7C,YAAY2E,eAAe,IAChCjgD,KAAK2/C,4BAA4BljD,GAAIuD,KAAKs7C,WAC1C5kD,GAAAA,EAAU0M,WAAW3G,GAAIuD,KAAKs7C,WAAAA,GAC9Bt7C,KAAK2M,YAAYlQ,EAAG9C;UAoBtB;AACGqG,eAAKw6B,cAAcx6B,KAAKw6B,UAAU6iB,aAAar9C,KAAKw6B,cAAc,QACrEx6B,KAAKR,WAAWQ,KAAKP,aAAa,MAClCO,KAAK0M,qBAENhW,EAAUmJ,UAAU,aAAa,CAACi7B,GAAS7/B,GAAMC;QACjD;AACD8E,aAAKR,WAAW,MAChBQ,KAAKP,aAAW,MAChBO,KAAKw6B,YAAU,MACfx6B,KAAKs7C,cAAc,MACnBt7C,KAAKo+C,mBAAmB;AAAA,MApDuB;AAAA,IAqDhD,GAEA1nD,EAAU2pD,uBAAuB,WAAA;AAChC,aAAIrgD,EAAAA,CAAAA,KAAK2oB,cAAc3oB,CAAAA,KAAKsoB,YAC3BtoB,KAAKktB,eAAAA,IACE;AAAA,IAIT,GACAx2B,EAAU8oD,cAAY,WAAA;AACrBx/C,WAAKsgD,eAAAA,GACLtgD,KAAKqX,gBACJrX,KAAKhJ,OAAO+3B,QACZ/uB,KAAKxG,WAAW4d,cAAc;AAE/B,UAAIha,IAAO4C,KAAKA,KAAKoB,QAAQ,OAAA;AAO7B,UANGhE,IACFA,EAAK6N,KAAKjL,MAAM,EAAA,IAEhBA,KAAKugD,aAGFvgD,GAAAA,KAAKqgD;AACR,eAAO;AAERrgD,WAAK0M,iBACN;AAAA,IAAA,GAEAhW,EAAU8pD,eAAe,SAASvlD;AACjC,aAAUvE,CAAAA,EAAAA,EAAUuE,IAAM,OAAA,KACxBvE,EAAUgC,KAAKuC,IAAM,QAAavE,KAAAA,EAAUya,UAAUlW,IAAM,OAAA,KAAYvE,EAAUya,UAAUlW,IAAM,aACrG;AAAA,IAAA,GAEAvE,EAAU+pD,0BAA0B;AAEnC,eADIC,IAAe,CAAC,uBAAuB,uBAAuB,eAAe,sBAAA,GACzE9mD,IAAI,GAAGA,IAAI8mD,EAAa7mD,QAAQD;AAEvC,iBADI+mD,IAAQ3gD,KAAKO,KAAKmgD,EAAa9mD,CAAAA,CAAAA,GAC3B2wB,IAAI,GAAGo2B,KAASp2B,IAAIo2B,EAAM9mD,QAAQ0wB,KAAK;AAC9C,cAAItb,IAAO0xC,EAAMp2B,CAAG1vB,EAAAA,aAAa,UAAe8lD,KAAAA,EAAMp2B,CAAG1vB,EAAAA,aAAa,SAClE6vB,IAAQ1qB,KAAKokB,OAAOwN,OAAO8uB,EAAa9mD;AACzCqV,UAAAA,MACFyb,IAAQ1qB,KAAKokB,OAAOwN,OAAO3iB,IAAO,WAAWjP,KAAKokB,OAAOwN,OAAO3iB,CAASyb,KAAAA,IAEvEg2B,EAAa9mD,CAAAA,KAAM,wBACrB8wB,IAAQ1qB,KAAKokB,OAAOwN,OAAO3a,OACnBypC,EAAa9mD,MAAM,0BAC3B8wB,IAAQ1qB,KAAKokB,OAAOwN,OAAOwc,OAE5BpuC,KAAKuxB,SAASqvB,wBAAwBD,EAAMp2B,IAAIG,KAAS,EAAA;AAAA,QACzD;AAAA,IAEH,GAEAh0B,EAAU8V,aAAa,SAAS9T,GAAMuC,GAErC;AAAA,UAAA,CAAK+E,KAAKxG;AACT,cAAM,IAAIuN,MAAM;AAAA;AAGjBrO,MAAAA,IAAOA,KAAQsH,KAAK8J,OACpB7O,IAAOA,KAAQ+E,KAAKoB;AACpB,UAAIq6B,IAAe;AAEfz7B,WAAKokB,OAAOwN,OAAOivB,cACtB7gD,KAAKokB,OAAOwN,OAAOivB,YAAY7gD,KAAKokB,OAAOwN,OAAO4b;AAGnD,UAAItwC,IAAY8C,KAAKuuB,MACjBuyB,IAAW,mBAAmB9gD,KAAKoB,OACnC2/C,IAAW,mBAAmB9lD;AAE7B+E,WAAKoB,SAAUlE,EAAUsI,UAAUqB,QAAQi6C,CAAAA,UAG/C5jD,EAAUsI,YAAYtI,EAAUsI,UAAU+I,QAAQuyC,GAAUC,CAAAA,IAF5D7jD,EAAUsI,aAAa,MAAMu7C;AAK9B,UAIIC,GAJAC,IAAgB,iBAEhBC,IAAAA,EAAelhD,KAAKoB,SAASnG,KAAQ+E,CAAAA,KAAKhJ,OAAOmqD,oBAAmBnhD,KAAKO,KAAKk7B,CAAc,EAAA,CAAA,EAAGtb;AAGhGngB,WAAKO,KAAK0gD,CAAkBjhD,KAAAA,KAAKO,KAAK0gD,CAAAA,EAAe,OACvDD,IAAiBhhD,KAAKO,KAAK0gD,CAAe,EAAA,CAAA,EAAG9gC,YAI1CngB,KAAKA,KAAKoB,QAAQ,OAAYnG,KAAAA,KAAQ+E,KAAKoB,SAASnG,KACvD+E,KAAKA,KAAKoB,QAAQ,WAEnBpB,GAAAA,KAAKs6C,iBAEDt6C,GAAAA,KAAKO,KAAK0gD,CAAAA,MACbjhD,KAAKO,KAAK0gD,CAAAA,EAAe,GAAGh/C,WAAWC,YAAYlC,KAAKO,KAAK0gD,CAAAA,EAAe,CAC5EjhD,CAAAA,GAAAA,KAAKO,KAAK0gD,CAAAA,IAAiB,OAG5BjhD,KAAKoB,QAAQnG,GACb+E,KAAK8J,QAAQpR,GACbsH,KAAKmB,cAAenB,KAAKoB,SAAS,SAElCpB,KAAKohD,YAAY,GAGjBphD,KAAKw/C,eAELx/C,KAAKygD,wBAAAA;AAEL,UAAIngB,IAAOtgC,KAAKO,KAAkB;AAClC,UAAG+/B;AACF,iBAAS1mC,IAAI,GAAGA,IAAI0mC,EAAKzmC,QAAQD,KAAK;AACrC,cAAIymC,IAAMC,EAAK1mC,CAAAA;AAEXymC,UAAAA,EAAIxlC,aAAa,UAAA,KAAemF,KAAKoB,SAASi/B,EAAIxlC,aAAa,MAAWmF,KAAAA,KAAKoB,QAAQ,UAC1Fi/B,EAAI9qB,UAAU5c,IAAI,QAClBqH,GAAAA,KAAKuxB,SAAS8vB,kBAAkBhhB,GAAAA,QAEhCA,EAAI9qB,UAAUwL,OAAO,QAAA,GACrB/gB,KAAKuxB,SAAS8vB,kBAAkBhhB,GAAK,EAAA;AAAA,QAEtC;AAGwB,MAAf6gB,OAAAA,KAAe,aACzBlhD,KAAKO,KAAKk7B,CAAAA,EAAc,CAAGtb,EAAAA,YAAY+gC,IAEZ,OAAlBF,KAAkB,YAAYhhD,KAAKO,KAAK0gD,MAAkBjhD,KAAKO,KAAK0gD,GAAe,CAC5FjhD,MAAAA,KAAKO,KAAK0gD,CAAAA,EAAe,CAAG9gC,EAAAA,YAAY6gC;AAAAA,IAG1C,GACAtqD,EAAU6V,iBAAiB,SAAS7T,GAAMuC;AACpC+E,WAAKH,UAAU,sBAAsB,CAACG,KAAKoB,OAAOpB,KAAK8J,OAAO7O,KAAQ+E,KAAKoB,OAAO1I,KAAQsH,KAAK8J,KACpG9J,CAAAA,MAAAA,KAAKwM,WAAW9T,GAAMuC,CACtB+E,GAAAA,KAAKH,UAAU,gBAAgB,CAACG,KAAKoB,OAAOpB,KAAK8J;IAClD,GAEApT,EAAU4V,SAAS,SAAS5T,GAAMuC,GAAAA;AACjCvE,MAAAA,EAAU6V,eAAe7T,GAAMuC;IAChC,GAEAvE,EAAU4qD,mBAAmB,SAAS1nD,GAAE/B,GAAKa,GAAKwE,GAAWqkD,GAAAA;AAC5DA,MAAAA,IAAaA,KAAc;AAE3B,UAAI7iC,IAAKpa,SAASC,cAAc,KAChCma;AAAAA,MAAAA,EAAKlZ,YAAY,iBAEdxF,KAAKmR,UAAUnR,KAAKoB,QAAM,eAAA,MAE5Bsd,EAAKlZ,aAAa,MAAMxF,KAAKmR,UAAUnR,KAAKoB,QAAM,eAAA,EAAiB1I,CAGpE;AAAA,UAAIgN,IAAQ1F,KAAKqF,MAAMzL;AAEL,MAAdoG,KAAKoB,SAAS,WAAWxH,MAAM,KAAKoG,KAAKhJ,OAAOwqD,gBACnD9iC,EAAKlZ,aAAa,yBAClB3N,KAAY,IAGbmI,KAAKy5C,OAAO/6B,GAAMhZ,GAAO1F,KAAKyX,GAAGqhC,eAAa,GAAGjhD,GAAM0pD,CAEvD;AAAA,UAAIE,IAAmBzhD,KAAKmR,UAAUnR,KAAKoB,QAAM,aAAA,EAAe1I,GAAKsH,KAAKoB,KAC1Esd;AAAAA,MAAAA,EAAKla,YAAYi9C,GAEjBzhD,KAAKuxB,SAASmwB,cAAchjC,GAAM+iC,IAElCvkD,EAAUuH,YAAYia,CACvB;AAAA,IAAA,GAEAhoB,EAAUirD,mBAAmB,SAASp5B,GAAME,GAAAA;AAC3C,UAAIm5B,IAAQ;AACZ,WAAKlrD,EAAUyK,aAAY;AAC1B,YAAI0gD,IAAUnrD,EAAUgC,KAAK,SAAOhC,EAAU0K,QAAM,MAChDygD;AAAAA,QAAAA,MAASp5B,IAAKo5B,EAAQt5B,CAAAA,IAC1Bq5B,IAAQ97C,KAAKM,OAAOqiB,EAAGtvB,YAAUovB,EAAKpvB,QAAAA,KAAY;MAClD;AACD,aAAOyoD;AAAAA,IACR,GACAlrD,EAAUorD,sBAAsB,WAAA;AAE/B,aAAO9hD,KAAKtH,KAAKsH,KAAKoB,QAAM,UAAU,IAAIlI,KAAK8G,KAAK8J,MAAM3Q,QAAAA,CAAAA,CAAAA;AAAAA,IAC3D,GAEAzC,EAAUqrD,gBAAgB,WAAA;AACzB,UAAIr1B,IAAK1sB,KAAK8hD,uBACVE,IAAKtrD,EAAUgC,KAAKC,IAAI+zB,GAAI,GAAG1sB,KAAKoB,KACxC;AAAA,UAAA,CAAK1K,EAAUyK,aAAY;AAC1B,YAAI0gD,IAAUnrD,EAAUgC,KAAK,SAAOhC,EAAU0K,QAAM,MAAA;AAChDygD,QAAAA,MAASG,IAAKH,EAAQn1B,CAC1B;AAAA,MAAA;AACD,aAAOs1B;AAAAA,IACR,GACAtrD,EAAUurD,oBAAoB,SAASv8C,GAAO6iB,GAAME,GAEnD;AAAA,UAAI6O,IAAMt3B,KAAKhJ,OAAOsgC,KAClB4qB,IAAOx8C,GACPk8C,IAAQ5hD,KAAK2hD,iBAAiBp5B,GAAME,CAAAA;AAGxCzoB,WAAKmiD,iBAAiB55B,GAAMq5B,GAAO,OAAO;AAE1C,eADIQ,IAAYR,IAAQ5hD,KAAKo8C,mBACpBxiD,IAAE,GAAGA,IAAEgoD,GAAOhoD;AAClBoG,aAAKsF,SAAS1L,CACjBoG,KAAAA,KAAKqF,MAAMzL,CAAK,IAAA,GAChBwoD,OAEApiD,KAAKqF,MAAMzL,CAAAA,IAAGkM,KAAK+D,MAAMq4C,KAAME,IAAUxoD,EAE1CsoD,GAAAA,KAAMliD,KAAKqF,MAAMzL,CAAAA,GACjBoG,KAAKi8C,OAAOriD,CAAIoG,KAAAA,KAAKqF,MAAMzL,IAAE,CAAA,KAAI,MAAIoG,KAAKi8C,OAAOriD,IAAE,CAAKoG,MAAAA,KAAKmB,cAAY,IAAGm2B,IAAMt3B,KAAKyX,GAAGshB,eAAe/4B,KAAKyX,GAAGohC;AAGlH74C,WAAKi8C,OAAmB,aAAI2F,GAC5B5hD,KAAKi8C,OAAO2F,CAAAA,IAAU5hD,KAAKqF,MAAMu8C,IAAM,KAAG5hD,KAAKi8C,OAAO2F,IAAM,CAAO,KAAA;AAAA,IAEpE,GAEAlrD,EAAU2rD,sBAAsB,SAAStgD,GAAK2D,GAAO7N,GAAAA;AACpD,UAAI+G,IAAIoB,KAAKhJ;AACbgJ,WAAKy5C,OAAO13C,GAAK2D,GAAO9G,EAAEsH,gBAActH,EAAEmC,YAAUnC,EAAEkC,aAAajJ,IAAKmI,KAAKyX,GAAGohC,cAAc,GAAG,CAClG;AAAA,IAAA,GAEAniD,EAAU4rD,iBAAiB,SAASvzB,GAAQwzB,GAAAA;AAE3C,UAAIC,IAAK,IAAItpD,KAAKxC,EAAUkK,SAAAA,GAC3BohD,IAAK,IAAI9oD,KAAKxC,EAAUiK,YACxB8hD,IAAQziD,KAAKtH,KAAKwF,UAAWxH,EAAU+J,iBAEpCyhD,IAAO5iC,SAASyP,EAAOp3B,MAAM+N,OAAM,EAAA,IAAM,GACzC2C,IAAI,IAAInP,KAAK8G,KAAKY,SAAAA,GAIlBghD,IAAQ5hD,KAAK2hD,iBAAiBa,GAAIR,CAAAA;AACtChiD,WAAKiiD,kBAAkBC,GAAMM,GAAIR,CAAAA;AACjC,UAAInqD,IAAK;AAETk3B,MAAAA,EAAOvqB,YAAY;AACnB,eAAS5K,IAAE,GAAGA,IAAEgoD,GAAOhoD,KAAI;AAI1B,YAHKoG,KAAKsF,SAAS1L,CAClBoG,KAAAA,KAAKshD,iBAAiB1nD,GAAE/B,GAAKwQ,GAAE0mB,CAE3B/uB,GAAAA,CAAAA,KAAKmB,aAAY;AACrB,cAAIuhD,IAAOp+C,SAASC,cAAc,KAC9Bo+C,GAAAA,IAAM;AACNt6C,UAAAA,EAAElP,aAAaspD,EAAMtpD,QAAAA,MAAWwpD,KAAO,0BAE3CD,EAAOjtC,aAAa,qBAAqB7b,CAAAA,GACrCoG,KAAKo8C,qBAAqBp8C,KAAKsF,SAAS1L,OAC3C+oD,KAAO;AAGR,mBAAS/oD,IAAyB,IAAvBoG,KAAKhJ,OAAO8J,YAAclH,IAAIoG,KAAKhJ,OAAO+J,WAAWnH,KAAK;AACpE,kBAAMgpD,IAAYt+C,SAASC,cAAc,KACzCq+C;AAAAA,YAAAA,EAAUp9C,YAAU,sDACpBo9C,EAAUjrD,MAAM8N,SAAOzF,KAAKhJ,OAAOkP,eAAa,IAAE;AAElD,gBAAI28C,IAAW,IAAI3pD,KAAKmP,EAAEuL,YAAevL,GAAAA,EAAEwL,YAAYxL,EAAE9J,QAAAA,GAAW3E,GAAG,CACvEgpD;AAAAA,YAAAA,EAAUntC,aAAa,kBAAkBzV,KAAKmR,UAAU8c,YAAY40B,CAEpE,CAAA;AAAA,gBAAIC,IAAc9iD,KAAKmR,UAAU4xC,eAAeF,CAC7CC;AAAAA,YAAAA,MACFF,EAAUp+C,YAAYs+C;AAEvB,gBAAIxtC,IAAWtV,KAAKmR,UAAU6xC,gBAAgBH,CAC3CvtC;AAAAA,YAAAA,KACFstC,EAAUrtC,UAAU5c,IAAI2c,IAGzBotC,EAAOj+C,YAAYm+C;AAEnB,kBAAMK,IAAa3+C,SAASC,cAAc,KAAA;AAC1C0+C,YAAAA,EAAWz9C,YAAU,uBACrBq9C,IAAW,IAAI3pD,KAAKmP,EAAEuL,YAAAA,GAAevL,EAAEwL,SAAAA,GAAYxL,EAAE9J,QAAW3E,GAAAA,GAAG,KACnEqpD,EAAWxtC,aAAa,kBAAkBzV,KAAKmR,UAAU8c,YAAY40B,CAAAA,CAAAA,GACrEI,EAAWtrD,MAAM8N,SAAOzF,KAAKhJ,OAAOkP,eAAa,IAAE,MACnD48C,IAAc9iD,KAAKmR,UAAU4xC,eAAeF,CAAAA,GACzCC,MACFG,EAAWz+C,YAAYs+C,IAExBxtC,IAAWtV,KAAKmR,UAAU6xC,gBAAgBH,IACvCvtC,KACF2tC,EAAW1tC,UAAU5c,IAAI2c,CAE1BotC,GAAAA,EAAOj+C,YAAYw+C,CACnB;AAAA,UAAA;AAEDP,UAAAA,EAAOl9C,YAAYm9C,IAAI,MAAI3iD,KAAKmR,UAAU+xC,gBAAgB76C,GAAEo6C,CAC5DziD,GAAAA,KAAKuxB,SAAS4xB,cAAcT,GAAQr6C,IACpCrI,KAAKqiD,oBAAoBK,GAAQ1iD,KAAKqF,MAAMzL,CAAI/B,GAAAA,CAAAA,GAEhD0qD,EAAU99C,YAAYi+C,IACtB1iD,KAAKH,UAAU,cAAa,CAAC6iD,GAAQr6C;QACrC;AACDxQ,QAAAA,KAAMmI,KAAKqF,MAAMzL,CAGjByO,GAAAA,IAAErI,KAAKtH,KAAKC,IAAI0P,GAAE,GAAE,KAAA,GACpBA,IAAIrI,KAAKtH,KAAKitB,UAAUtd,CAAAA;AAAAA,MACxB;AAAA,IACF,GAEA3R,EAAU0sD,qBAAqB,WAAA;AAC9B,aAAOpjD,KAAKxG,WAAW4d,cAAc,eACtC;AAAA,IAAA,GAEA1gB,EAAU6pD,eAAa,WAGtB;AAAA,UAAKvgD,KAAKmR,UAAUnR,KAAKoB,QAAQ,OAAjC,GAAA;AAEA,YAAI2tB,IAAS/uB,KAAKO,KAAqB,eAAE,CACrCgiD,GAAAA,IAAYviD,KAAKO,KAAmB,aAAE,IACtC3B,IAAIoB,KAAKhJ;AAEb+3B,QAAAA,EAAOvqB,YAAY,IAEnB+9C,EAAU/9C,YAAY;AAEtB,YAUI6D,GAAEm6C,GAVF7lC,KAAQ/d,EAAE6yB,YAAAA,CAAc7yB,EAAEykD,cAAgB,uBAAuB,OAAQzkD,EAAE6yB,YAAc7yB,CAAAA,EAAE0kD,YAAc,qBAAqB;AAClIf,QAAAA,EAAU/8C,YAAY,iBAAiBmX,GAEvC3c,KAAKmF,UAAU,IACfnF,KAAKqF,QAAQ,IACbrF,KAAKi8C,SAAS,EAACx2C,QAAQ,EAAA,GACvBzF,KAAKohD,YAAY,GAEjBphD,KAAK24C,UAAAA;AAGL,YAAIjsB,IAAK1sB,KAAK8hD,oBACbE,GAAAA,IAAKtrD,EAAUqrD,cAEhB15C;AAAAA,QAAAA,IAAIm6C,IAAKxiD,KAAKmB,cAAczK,EAAUgC,KAAKY,WAAWozB,CAAAA,IAAMA,GAG5D1sB,KAAKY,YAAUyH;AAEf,YAAIk7C,IAAgBvjD,KAAKmR,UAAUnR,KAAKoB,QAAM,OAASsrB,EAAAA,GAAGs1B,GAAGhiD,KAAKoB,KAAAA,GAE9DoiD,IAAexjD,KAAKojD,mBAAAA;AASxB,YARGI,MACFA,EAAah/C,YAAY++C,GACzBvjD,KAAKuxB,SAASkyB,eAAeD,GAAcD,CAAAA,IAG5CvjD,KAAKW,YAAYqhD,GACjBtrD,EAAU4rD,eAAevzB,GAAQwzB,CAE7BviD,GAAAA,KAAKmB;AACRnB,eAAK0jD,mBAAmBnB,GAAU71B,GAAG81B;iBAErCxiD,KAAK2jD,mBAAmBpB,GAAU71B,GAAG81B,CACjC5jD,GAAAA,EAAEglD,WAAW;AAChB,cAAI3C,IAAgB;AAEjBjhD,eAAKO,KAAK0gD,CAAAA,MACZjhD,KAAKO,KAAK0gD,CAAAA,EAAe,CAAGh/C,EAAAA,WAAWC,YAAYlC,KAAKO,KAAK0gD,CAAe,EAAA,CAAA,CAAA,GAC5EjhD,KAAKO,KAAK0gD,CAAAA,IAAiB;AAG5B,cAAI4C,IAAKv/C,SAASC,cAAc,KAChCs/C;AAAAA,UAAAA,EAAGr+C,YAAYy7C,GACf4C,EAAGlsD,MAAMgmB,aAAW,UACpBkmC,EAAGlsD,MAAMkgB,UAAQ;AACjB,cAAIisC,IAAa9jD,KAAKi8C,OAAOj8C,KAAKi8C,OAAO8H,aACrC97C,IAASrJ,EAAE04B,MAAMt3B,KAAKyX,GAAGohC,cAAc74C,KAAKyX,GAAGshB,cAC/CirB,IAAcl+C,KAAKC,IAAI+9C,IAAa77C,GAAQ,CAAA;AAChDjI,eAAKy5C,OAAOoK,GAAIG,GAAa,GAAG,CAChCzB,GAAAA,EAAUtgD,WAAW6e,aAAa+iC,GAAGtB;AAErC,cAAI0B,IAAKJ,EAAG/pD,UAAU,EAAA;AACtBmqD,UAAAA,EAAGz+C,YAAYy7C,IAAc,SAC7BgD,EAAGtsD,MAAMgmB,aAAW,UACpBsmC,EAAGtsD,MAAMkgB,UAAQ,QACjB7X,KAAKy5C,OAAOwK,GAAIjkD,KAAKyX,GAAGohC,cAAc,GAAG,GAAG,IAE5CgL,EAAGp/C,YAAYw/C,IACfjkD,KAAKO,KAAK0gD,CAAe,IAAA,CAAC4C,GAAGI,CAAAA,GAC7BvtD,EAAUI,MAAMkJ,KAAKO,KAAK0gD,CAAe,EAAA,CAAA,GAAI,SAASjhD,KAAKw7B,OAAOC,YAClE;AAAA,QAAA;AAAA,MAvEgD;AAAA,IAyEnD,GACA/kC,EAAUitD,qBAAmB,SAAS7qC,GAAE4T,GAAG81B,GAAAA;AAC1C,UAAI5jD,IAAE0F,SAASC,cAAc,KAAA;AAC7B3F,MAAAA,EAAE4G,YAAU;AAGZ,eADI9M,IAAO,IAAIQ,KAAK,MAAK,GAAE,GAAE8G,KAAKhJ,OAAO8J,YAAW,GAAE,IAC7ClH,IAAyB,IAAvBoG,KAAKhJ,OAAO8J,YAAclH,IAAIoG,KAAKhJ,OAAO+J,WAAWnH,KAAK;AACpE,YAAIsqD,IAAG5/C,SAASC,cAAc;AAC9B2/C,QAAAA,EAAG1+C,YAAU,kBACb0+C,EAAGvsD,MAAM8N,SAAOzF,KAAKhJ,OAAOkP,eAAa;AACzC,YAAIR,IAAQ1F,KAAKyX,GAAGohC;AAChB74C,aAAKhJ,OAAOwqD,gBACf0C,EAAG1+C,aAAa,2BAEjB0+C,EAAGvsD,MAAM+N,QAAQA,IAAQ;AAEzB,YAAIs+B,IAAUttC,EAAUya,UAAU4uB,WAAWrnC,CAAAA;AAC7CwrD,QAAAA,EAAG1/C,YAAYw/B,GACfhkC,KAAKuxB,SAAS4yB,cAAcD,GAAIlgB,CAAAA,GAEhCplC,EAAE6F,YAAYy/C,CAAAA,GACdxrD,IAAKsH,KAAKtH,KAAKC,IAAID,GAAK,GAAE,MAAA;AAAA,MAC1B;AACDogB,MAAAA,EAAErU,YAAY7F,IACVoB,KAAKhJ,OAAOotD,gBACftrC,EAAEqH,YAAYngB,KAAKhJ,OAAOkP,gBAAclG,KAAKhJ,OAAOotD,cAAYpkD,KAAKhJ,OAAO8J;AAAAA,IAC9E,GAEApK,EAAU+J,eAAe,WACxB;AAAA,aAAG/J,EAAUM,OAAOqtD,WACZ,IAAInrD,KAAKxC,EAAUM,OAAOqtD,QAE3B,IAAA,oBAAInrD;AAAAA,IACZ,GAEAxC,EAAU4pD,iBAAiB;AAC1BtgD,WAAKsF,WAAS,IACdtF,KAAKo8C,oBAAoB;AAAA,IAC1B,GAEA1lD,EAAUyrD,mBAAmB,SAASK,GAAI7mD,GAAGV,GAAMyhC,GAAM4nB;AACxDtkD,WAAKsgD,eAAAA;AACL,UAAIhvC,IAAS5a,EAAU,YAAUsJ,KAAKoB,KACtC;AAAA,UAAIkQ;AAEH,iBADIizC,IAAW,IAAIrrD,KAAKspD,IACf5oD,IAAE,GAAGA,IAAE+B,GAAG/B;AACd0X,UAAAA,EAAOizC,OACVvkD,KAAKo8C,qBAAqB,GAC1Bp8C,KAAKsF,SAAS1L,SACV0qD,KACH3oD,MAEF4oD,IAAW7tD,EAAUgC,KAAKC,IAAI4rD,GAAU7nB,GAAMzhC,IAC3CvE,EAAUgC,KAAKuC,IAAO,QACxBspD,MAAAA,IAAW7tD,EAAUgC,KAAKuC,IAAO,QAAA,EAAUspD;IAG/C,GAEA7tD,EAAU8tD,sBAAsB,SAASziD,GAAK2qB,GAAmB81B,GAAkBhsC,GAAAA;AAGlF,UAAIwrC,IAAGtrD,EAAUgC,KAAKC,IAAI+zB,GAAG,GAAE,UAC9B+3B,IAAa,IAAIvrD,KAAKspD,CACnBkC,GAAAA,IAAKhuD,EAAU+J,aAAAA;AAEnBikD,MAAAA,IAAK1kD,KAAKtH,KAAKwF,UAAUwmD,CAAAA,GACzBlC,IAAKxiD,KAAKtH,KAAKwF,UAAUskD,CAEzBhsC,GAAAA,IAAOA,KAAQ1Q,KAAKg2C,KAAKh2C,KAAKM,OAAO47C,EAAG7oD,QAAAA,IAAUqpD,EAAGrpD,QAAc,KAAA,KAAA,IAAmB;AAGtF,eAFIwrD,IAAS,CAAA,GAEJ/qD,IAAE,GAAGA,KAAG,GAAGA,KAAK;AACxB,YAAIgrD,IAAa5kD,KAAKqF,MAAMzL,CAAAA,KAAM;AAC9BokB,cAAMvJ,OAAOmwC,QAChBA,KAA0B,OAE3BD,EAAS/qD,CAAKgrD,IAAAA;AAAAA,MACd;AAED,eAASC,EAAcrb,GACtB;AAAA,YAAIlxB,IAAI5hB,EAAUulD,OAAOx2C;AAIzB,eAHG/O,EAAUulD,OAAOE,QAAQ3S,IAAM,CAAA,MAGlC,WAFClxB,IAAI5hB,EAAUulD,OAAOE,QAAQ3S,IAAM,CAAM9yC,KAAAA,EAAUulD,OAAOE,QAAQ3S,CAAAA,KAAM,KAElElxB;AAAAA,MACP;AAGD,UAAIwsC,IAAa;AAEjB,YAAMC,IAAQzgD,SAASC,cAAc;AAIrC,WAHAwgD,EAAMxvC,UAAU5c,IAAI,qBAAA,GAGXiB,IAAE,GAAGA,IAAE4c,GAAM5c,KAAI;AACzB,YAAI4vC,IAAMllC,SAASC,cAAc;AACjCilC,QAAAA,EAAIj0B,UAAU5c,IAAI,mBAAA,GAClB6wC,EAAI7xC,MAAM8N,SAASo/C,EAAcjrD,CAAAA,IAAK,MACtCmrD,EAAMtgD,YAAY+kC;AAElB,iBAASjf,IAAE,GAAGA,IAAE,GAAGA,KAAK;AACvB,cAAIy6B,IAAO1gD,SAASC,cAAc;AAClCilC,UAAAA,EAAI/kC,YAAYugD,CAEhB;AAAA,cAAIrC,IAAM;AACNH,UAAAA,IAAG91B,IACNi2B,KAAO,gBACCH,KAAIR,IACZW,KAAO,eACCH,EAAGrpD,aAAWurD,EAAGvrD,QAAAA,MACzBwpD,KAAO,aAEJ3iD,KAAKo8C,qBAAqBp8C,KAAKsF,SAASilB,OAC3Co4B,KAAO,sBAGRqC,EAAKx/C,YAAYm9C,IAAM,MAAM3iD,KAAKmR,UAAU8zC,iBAAiBzC,GAAIkC,CAEjEM,GAAAA,EAAKvvC,aAAa,kBAAkB/e,EAAUya,UAAU8c,YAAYu0B,CACpE,CAAA;AAAA,cAAI0C,IAAa,kBACbC,IAAa;AAKjB,cAJI56B,MAAM,KAAKvqB,KAAKhJ,OAAOwqD,gBAC1B0D,KAAc,0BACdC,KAAc,2BAEVnlD,KAAKo8C,qBAAsBp8C,KAAKsF,SAASilB,CAAAA;AAiB7Cy6B,YAAAA,EAAKvgD,YAAYH,SAASC,cAAc,KAAA,CAAA,GACxCygD,EAAKvgD,YAAYH,SAASC,cAAc,KAAA,CAAA;AAAA,eAlBQ;AAChDygD,YAAAA,EAAKrtD,MAAM+N,QAAQi/C,EAASp6B,CAAAA,GAC5BvqB,KAAKuxB,SAAS6zB,cAAcJ,GAAMxC;AAElC,gBAAI6C,IAAW/gD,SAASC,cAAc,KAAA;AACtC8gD,YAAAA,EAAS1tD,MAAM8N,SAAS/O,EAAU+gB,GAAG2hC,oBAAoB,MACzDiM,EAAS7/C,YAAY2/C,GACrBE,EAAS7gD,YAAYxE,KAAKmR,UAAU+uB,UAAUsiB,CAAAA,GAC9CwC,EAAKvgD,YAAY4gD,CAEjB;AAAA,gBAAIC,IAAWhhD,SAASC,cAAc;AACtC+gD,YAAAA,EAAS9/C,YAAY0/C,GAGrBF,EAAKvgD,YAAY6gD;UAErB;AAKG,cAAIC,IAAM/C,EAAGjkD,QAAAA;AAAAA,WACbikD,IAAGxiD,KAAKtH,KAAKC,IAAI6pD,GAAG,GAAE,KACfjkD,GAAAA,QAAAA,IAAYgnD,IAAM,MACxB/C,IAAK,IAAItpD,KAAKspD,EAAG5uC,YAAe4uC,GAAAA,EAAG3uC,YAAY0xC,IAAM,GAAG,IAAI,CAAA;AAAA,QAC7D;AAED7uD,QAAAA,EAAUulD,OAAOE,QAAQviD,CAAAA,IAAKkrD,GAC9BA,KAAcD,EAAcjrD;MAC5B;AAiBD,aAfAoG,KAAKY,YAAY6jD,GACjBzkD,KAAKW,YAAY6hD,GAEjBzgD,EAAIyC,YAAY,IAChBzC,EAAI0C,YAAYsgD,CAEhB/kD,GAAAA,KAAKmF,UAAU,IACHpD,EAAItI,iBAAiB,kBAC3BqB,EAAAA,QAASkqD,CAAAA;AACd,cAAMtsD,IAAOhC,EAAUya,UAAUC,WAAW4zC,EAAKnqD,aAAa,gBACxD4S,CAAAA,GAAAA,IAAOu3C,EAAK5tC,cAAc,iBAAA;AAChCpX,aAAKmF,QAASzM,CAAAA,CAAAA,IAAQ+U,GACtBzN,KAAKH,UAAU,cAAc,CAACG,KAAKmF,QAAAA,CAASzM,IAAOA,CAAM,CAAA;AAAA,MAAA,CAAA,GAGnDsH,KAAKW;AAAAA,IACb,GAEAjK,EAAUgtD,qBAAmB,SAAS5qC,GAAE4T,GAAG81B,GAAGhsC,GAAAA;AAE7C,UAAIwrC,IAAGtrD,EAAUgC,KAAKC,IAAI+zB,GAAG,GAAE,OAE/B81B;AAAAA,MAAAA,IAAKxiD,KAAKtH,KAAKwF,UAAUskD,CAAAA,GAEzBhsC,IAAOA,KAAQ1Q,KAAKg2C,KAAKh2C,KAAKM,OAAO47C,EAAG7oD,QAAUqpD,IAAAA,EAAGrpD,QAAc,KAAA,KAAA,IAAmB,CAEtF;AAAA,UAAIsM,IAAUK,KAAK+D,MAAMiP,EAAEN,eAAahC,CAAAA,IAAQxW,KAAKyX,GAAG2hC;AAKxD,aAHAp5C,KAAKi8C,OAAOx2C,SAASA,IAASzF,KAAKyX,GAAG2hC,mBACtCp5C,KAAKi8C,OAAOE,UAAU,CAEfzlD,GAAAA,EAAU8tD,oBAAoB1rC,GAAG4T,GAAI81B,GAAIhsC;IAEjD,GAEA9f,EAAUY,UAAU,SAAUF,GAAAA;AAI7B,aAHKA,MACJA,IAAWV,EAAU4E,SAAAA,EAAWL,OAE7BvE,EAAUuG,UAAUvG,EAAUuG,OAAO7F,KACjCV,EAAUuG,OAAO7F,KAGrBV,EAAUsG,UAAUtG,EAAUsG,OAAO5F,CACjCV,IAAAA,EAAUsG,OAAO5F,CAGlB,IAAA;AAAA,IACR,GAEAV,EAAU8uD,WAAW,SAASroD,GAAU4M,GAAAA;AAEvC,eADIhS,IAAWiI,KAAKhJ,OAAO63B,SAAS92B,UAC3B6B,IAAE,GAAGA,IAAE7B,EAAS8B,QAAQD;AAChC,YAAG7B,EAAS6B,CAAGM,EAAAA,UAAUiD;AAExB,mBADIb,IAAUvE,EAAS6B,CAAAA,EAAG0C,SACjBiuB,IAAE,GAAGA,IAAEjuB,EAAQzC,QAAQ0wB;AAC/B,gBAAGjuB,EAAQiuB,GAAGxgB,OAAOA;AACpB,qBAAOzN,EAAQiuB,CAAAA,EAAGG;AAAAA;AAKtB,aAAO;AAAA,IACR,GACAh0B,EAAU+uD,mBAAmB,SAASC,GAAWr6B,GAChD;AAAA,UAAI7P,IAAO9kB,EAAU2zB,WAAWq7B,CAChC;AAAA,aAAA,CAAA,CAAKlqC,MACLA,EAAKtT,OAAO,GAAGsT,EAAK3hB,SACpB2hB,EAAKniB,KAAKuJ,MAAM4Y,GAAM6P,KAAc,CACpC30B,CAAAA,GAAAA,EAAUmJ,UAAU,iBAAiB,KACrCnJ,EAAUk+B,cAAAA,GACVl+B,EAAUy9B,UACH,GAAA;AAAA,IACR,GACAz9B,EAAUiM,cAAc,SAASwR,GAAQwxC,GACxC;AAAA,UAAI/rD,GAAGqP,GAAG8F;AAIV,WAFA42C,IAAQA,KAAS,IAEZ/rD,IAAE,GAAGA,IAAE+rD,EAAM9rD,QAAQD,KAAG;AAC5B,YAAGua,MAAWwxC,EAAM/rD,CACnB;AAAA,iBAAO+rD,EAAM/rD,IAAE,CAAA;AAEjB,UAAIua,KAAiBA,OAAAA,KAAU,UAAU;AAGxC,aAFApF,IAAS6F,OAAOo0B,OAAO70B,CAAAA,GACvBlL,IAAI,CAAC1G,OAAMrJ,MAAKub,QAAOra,QAAOsa,OAAAA,GACzB9a,IAAE,GAAGA,IAAEqP,EAAEpP,QAAQD;AACjBua,UAAAA,aAAkBlL,EAAErP,CAAAA,MACvBmV,IAASnV,IAAI,IAAIqP,EAAErP,GAAGua,CAAU,IAAA,IAAIlL,EAAErP,CAGxC;AAAA,aAAKA,KADL+rD,EAAMtsD,KAAK8a,GAAQpF,CAAAA,GACToF;AACLS,iBAAOL,UAAUtR,eAAeL,MAAMuR,GAAQ,CAACva,CAAAA,CAAAA,MAClDmV,EAAOnV,CAAKlD,IAAAA,EAAUiM,YAAYwR,EAAOva,CAAI+rD,GAAAA,CAAAA;AAAAA,MAE/C;AACD,aAAO52C,KAAUoF;AAAAA,IAClB,GACAzd,EAAU0M,aAAa,SAAShI,GAAQ4Y,GACvC;AAAA,eAASjK,KAAOiK;AACXA,QAAAA,EAAO/Q,eAAe8G,OACzB3O,EAAO2O,CAAAA,IAAOiK,EAAOjK,CAGvB;AAAA,aAAO3O;AAAAA,IACR,GACA1E,EAAUknD,qBAAqB,SAAS/B,GACvC;AAAA,UAAIl4C,IAAM3D,KAAKY,UAAUzH,YAAyE,OAA9D0iD,EAAI95B,IAAE/hB,KAAKhJ,OAAOq6B,YAAqC,MAA1BrxB,KAAKmB,cAAY,IAAE06C,EAAI75B,KAAM;AAE9F,aAAO,IAAI9oB,KAAK8G,KAAK88C,eAAen5C,CAAAA,CAAAA;AAAAA,IACrC,GAEAjN,EAAU+E,gBAAgB,SAASmqD,GAClC;AAAA,UAAI/J,IAAM77C,KAAK+7C,cAAc6J,CAC7B;AAAA,aAAO,EACNltD,MAAKsH,KAAK49C,mBAAmB/B,CAAAA,GAC7BngD,SAAQmgD,EAAIngD,QAAAA;AAAAA,IAEd,GACAhF,EAAUw5B,SAAS,SAASlT,GAAMqB,GAAAA;AACjC,UAAIrB,KAAQA,EAAK+S;AAChB,YAAI/vB,KAAKg5B;AACRziC,iBAAOoY,WAAW,WACjBqO;AAAAA,YAAAA,EAAK+S,MACL;AAAA,UAAA,GAAC;;AAEF,cACK1R;AAAAA,YAAAA,KAAUrB,EAAKqB,UAAUrB,EAAK/C,eACjC+C,EAAKqB,OAAAA,GAENrB,EAAK+S,MAAAA;AAAAA,UACL;UACA;AAAA,IAGJ,GAWAr5B,EAAU6lD,yBAAuB,SAASrC,GAAWC,GAASnjD,GAAAA;AAC7D,UAOC6uD,GAPGC,IAAc3L,IAAUD,GAIxB5oC,IAAStR,KAAK,YAAUA,KAAKoB,KAAAA,GAE7B2kD,IAAmB;AAEnB/uD,MAAAA,EAAOsV,UACVy5C,IAAmB/lD,KAAKzH,gBAAgBvB,GAAQkjD,CAChD2L,GAAAA,IAAiB7lD,KAAKzH,gBAAgBvB,GAAQmjD,IAE3CD,EAAU/gD,QAAAA,IAAYzC,EAAU4E,SAAAA,EAAWuJ,SAAS1L,QAAAA,MACtD4sD,KAAoB9L,EAAkBC,GAAWxjD,EAAU4E,SAAWuJ,EAAAA,QAAAA,IAEpEs1C,EAAQhhD,QAAYzC,IAAAA,EAAU4E,SAAWwJ,EAAAA,SAAS3L,QACpD0sD,MAAAA,KAAkB5L,EAAkBE,GAASzjD,EAAU4E,WAAWwJ,QAGnE+gD,MAAAA,IAAiB//C,KAAKM,MAAM0/C,IAAY,KAAG,KAAG,MAAK,EAAA;AAIpD,eADIE,IAAAA,IACGD,IAAmBF,KAAe;AACxC,YAAII,IAAQvvD,EAAUgC,KAAKC,IAAIwhD,GAAAA,CAAUnjD,EAAOwlD,QAAQxlD,EAAOylD;AAC/D,YAAInrC,KAAUA,EAAO6oC,CAAc6L,MAAAA,CAAAA,KAAgBA,KAAe10C,EAAO20C,CACxEH;AAAAA,UAAAA,KAAgB3L,IAAQ8L;AAAAA,aAEpB;AACJ,cAAIC,IAAmB;AACvB,gBAAMC,IAAgB,IAAIjtD,KAAK4M,KAAKC,IAAIkgD,EAAM9sD,WAAW+gD,EAAU/gD,QAAAA,CAAAA,CAAAA,GAC7DitD,IAAcjM,GACdkM,IAAsB,IAAIntD,KAAKitD,EAAcvyC,YAAeuyC,GAAAA,EAActyC,SAAYsyC,GAAAA,EAAc5nD,WAAWvH,EAAO8J,cAAc,IACpIwlD,IAAoB,IAAIptD,KAAKitD,EAAcvyC,YAAAA,GAAeuyC,EAActyC,SAAAA,GAAYsyC,EAAc5nD,QAAAA,GAAWvH,EAAO+J,aAAa,EAAA,GACjIwlD,IAAuB,IAAIrtD,KAAKihD,EAAQvmC,YAAeumC,GAAAA,EAAQtmC,SAAYsmC,GAAAA,EAAQ57C,QAAWvH,GAAAA,EAAO8J,cAAc,CACnH0lD,GAAAA,IAAqB,IAAIttD,KAAKihD,EAAQvmC,eAAeumC,EAAQtmC,SAAAA,GAAYsmC,EAAQ57C,QAAAA,GAAWvH,EAAO+J,aAAa;AAEnHqlD,UAAAA,EAAYjtD,QAAAA,IAAYqtD,EAAmBrtD,QAC7C+sD,MAAAA,KAAoBE,IAAcI,IAGhCJ,EAAYjtD,QAAYotD,IAAAA,EAAqBptD,QAC/C+sD,IAAAA,KAAoBlvD,EAAOumD,oBAE3B2I,KAA2C,KAAvBE,EAAYvlD,SAAAA,IAAc,KAAG,MAAgC,KAAzBulD,EAAYjkD,WAAgB,IAAA,KAGlFgkD,EAAchtD,QAAamtD,KAAAA,EAAkBntD,cAC/C+sD,KAAoBlvD,EAAOwmD,kBAGzB2I,EAAchtD,QAAAA,IAAYktD,EAAoBltD,QAAAA,MAChD+sD,KAAqBG,EAAoBltD,YAAYgtD,EAAchtD,QAAAA,IAIpE2sD,KAAeI,GACfF,IAAAA;AAAAA,QACA;AACD7L,QAAAA,IAAU8L,GACVJ;AAAAA,MACA;AACD,aAAOC;AAAAA,IACR,GACApvD,EAAU+mD,8BAA4B,SAASvlD,GAAUuuD,GAAWrtD,GAAKuX,GAAAA;AACxE,UAAI6xC,IAAK,IAAItpD,KAAKhB,IACdwuD,IAAM/1C,IAAAA,KAAY;AAGtB,UAAIvX,EAAImkD,qBAAqBnkD,EAAIokD,iBAAgB;AAChD,YAAIiF;AAEHA,QAAAA,IADG9xC,IACoB,KAAd6xC,EAAG3hD,SAAc2hD,IAAAA,EAAGrgD,eAAoC,MAAnB/I,EAAI0H,cAAY,KAEnC,MAAlB1H,EAAI2H,aAAW,MAAuB,KAAdyhD,EAAG3hD,SAAc2hD,IAAAA,EAAGrgD;AACtD,YAAIwkD,IAA2C,MAAhCvtD,EAAI2H,YAAY3H,EAAI0H,aAC/B1E,IAAO0J,KAAKg2C,MAAO2K,UAAwBhE,KAAUkE,CACtDvqD;AAAAA,QAAAA,IAAO,MAAGA,IAAO,IACpBqqD,KAAarqD,KAAQ,OAAQuqD,KAAW,KAAK;AAAA,MAC7C;AAED,UAICC,GAJGC,IAAK,IAAI3tD,KAAc,IAAThB,IAAWuuD,IAAUC,CAAAA,GACnCp1C,IAAStR,KAAK,YAAUA,KAAKoB,KAE7B0lD,GAAAA,IAAa;AAajB,WAXI1tD,EAAIkT,UACPw6C,IAAa9mD,KAAKzH,gBAAgBa,GAAKopD,CACvCoE,GAAAA,IAAW5mD,KAAKzH,gBAAgBa,GAAKytD,CAErCD,KAAAA,IAAW9gD,KAAKM,MAAMqgD,IAAU,KAAG,KAAG,MAAK,EAIV,GAAfrtD,EAAIqjD,WAAW,QACZqK,IAAaJ,IAAME,IAAWF,IAAMI,IAAaJ,KAAOE,IAAWF,KAEtE;AAClB,YAAIT,IAAQvvD,EAAUgC,KAAKC,IAAI6pD,GAAIppD,EAAIojD,SAAOkK,GAAKttD,EAAIqjD,MACnDnrC;AAAAA,QAAAA,KAAUA,EAAOkxC,CACpBiE,MAAAA,MAAcR,IAAMzD,KAAIkE,GACxBE,KAAYF,IAGblE,IAAKyD,GACLa,KAAYJ;AAAAA,MACZ;AAED,aAAOD;AAAAA,IACR,GAEA/vD,EAAUwoD,oBAAoB,WAAA;AAC7B,aAAOl/C,KAAK1I,QACb;AAAA,IAAA,GAEAZ,EAAUqwD,wBAAwB,WAAA;AACjC,aAAG/mD,KAAK/C,UAAU+C,KAAK/C,OAAO+C,KAAKoB,KAC3BpB,IAAAA,KAAK/C,OAAO+C,KAAKoB,OAAOnH,aACvB+F,KAAKhD,UAAUgD,KAAKhD,OAAOgD,KAAKoB,KACjCpB,IAAAA,KAAKhD,OAAOgD,KAAKoB,KAAAA,EAAOlH,SAEzB;AAAA,IACR,GAEAxD,EAAUswD,kBAAkB,WAAA;AAC3B,UAAIxgB,IAAQxmC,KAAK1E,SACjB;AAAA,aAAQ0E,KAAKuuB,QAAQiY,EAAM9tC,QAAQ8tC,EAAMvrC;AAAAA,IAC1C,GACAvE,EAAUwjC,oBAAoB,WAC7B;AAAA,UAAIsM,IAAQxmC,KAAK1E,SACjB;AAAA,aAAOkrC,EAAMt0B,gBAAgB,QAAQs0B,EAAMt0B,gBAA9BA;AAAAA,IACd;AAAA,EAEA,EHr8Dexb,CIpDA,GAAA,SAAgBA,GAE/B;AAAA,KAAA,WAAA;AAGC,UAAIuwD,IAAW,IAAIx7B,OAAO;AAAA,OAAgB,IAAA,GACtCy7B,IAAc,IAAIz7B,OAAO,MAAM,IAAA;AAEnC,eAAS07B,EAAcC;AACtB,gBAAQA,IAAW,IACjB74C,QAAQ04C,GAAU,KACnB14C,QAAQ24C,GAAa,GACtB;AAAA,MAAA;AAED,UAAIG,IAAe,IAAI57B,OAAO,KAAK;AACnC,eAAS67B,EAAap0C;AACrB,gBAAQA,IAAO,IAAI3E,QAAQ84C,GAAc,OAAA;AAAA,MACzC;AAwUD,eAAQztD,KAtURlD,EAAU66B,WAAW,EACpBg2B,oBAAoB,SAAS58B,GAC5B;AAAA,YAAIF,IAAa,CAAC;AAClB,iBAAQ7wB,KAAK+wB;AACZ,qBAAUA,EAAK/wB,CAAAA,KAAM,cAAqB+wB,OAAAA,EAAK/wB,CAAgB,KAAV,UAAU;AAC9D,gBAAIsZ,IAAOo0C,EAAaH,EAAcx8B,EAAK/wB,CAAAA,CAAAA,CAAAA;AAC3C6wB,YAAAA,EAAWpxB,KAAKO,IAAI,OAAOsZ,IAAO,GAClC;AAAA,UAAA;AAGF,eADAuX,EAAWpxB,KAAK,MACToxB,EAAWtmB,KAAK;MACvB,GACDqjD,eAAe,SAASzlD,GAAK29B,GAC5B;AAAA,iBAAQ9lC,KAAK8lC;AACZ39B,UAAAA,EAAI0T,aAAa7b,GAAGutD,EAAcznB,EAAO9lC,CAAAA,CAAAA,CAAAA;AAE1C,eAAOmI;AAAAA,MACP,GAEDg4C,WAAW,SAASh4C,GAAKiiC,GAAAA;AACxB,eAAOhkC,KAAKwnD,cAAczlD,GAAK,EAAC,cAAciiC,EAC9C,CAAA;AAAA,MAAA,GACDtZ,OAAO,SAASA;AACf,eAAOh0B,EAAU66B,SAASg2B,mBAAmB,EAAC,cAAc78B,EAC5D,CAAA;AAAA,MAAA,GAIDy5B,eAAe,SAASpiD,GAAKiiC,GAAAA;AAC5BhkC,aAAK+5C,UAAUh4C,GAAKiiC;MAEpB,GACDohB,eAAe,SAASrjD,GAAKrJ,GAAAA;AAC5BsH,aAAK+5C,UAAUh4C,GAAKrL,EAAUya,UAAU+rB,SAASxkC,CAAAA,CAAAA;AAAAA,MACjD,GAED+qD,gBAAgB,SAAS1hD,GAAKiiC,GAC7BhkC;AAAAA,aAAK+5C,UAAUh4C,GAAKiiC,CACpB;AAAA,MAAA,GACD0d,eAAe,SAAS3/C,GAAKiiC;AAC5BhkC,aAAK+5C,UAAUh4C,GAAKiiC,CACpB;AAAA,MAAA,GAEDmf,eAAe,SAASphD,GAAKrJ;AAC5BsH,aAAK0hD,cAAc3/C,GAAKrL,EAAUya,UAAU+rB,SAASxkC,CACrD,CAAA;AAAA,MAAA,GAEDkoD,yBAAyB,SAAS7+C,GAAK2oB,GAAAA;AACtC,eAAO1qB,KAAKwnD,cAAczlD,GAAK,EAAC0lD,MAAO,UAAU,cAAa/8B,EAAAA,CAAAA;AAAAA,MAC9D,GAED22B,mBAAmB,SAASt/C,GAAK2I;AAChC,eAAO1K,KAAKwnD,cAAczlD,GAAK,EAAC,gBAAgB2I,IAAW,SAAS,QACpE,CAAA;AAAA,MAAA,GAGDg9C,mBAAkB,SAAS9/B;AAE1B,eAAOlxB,EAAU66B,SAASg2B,mBAAmB,EAAC,cAAc3/B,EAC5D,CAAA;AAAA,MAAA,GAGD+/B,WAAW,SAAS7wD,GAAOiL,GAAAA;AAC1B/B,aAAK4nD,iBAAiB9wD,GAAOiL;MAC7B,GAGD6lD,kBAAkB,SAAS9wD,GAAOiL,GAAAA;AACjCA,QAAAA,EAAI0T,aAAa,cAAc0xC,EAAczwD,EAAUya,UAAU02C,WAAW/wD,EAAMmB,YAAYnB,EAAMoB,UAAUpB,CAE3GJ,CAAAA,CAAAA,GAAAA,EAAUM,OAAOy6B,YACnB1vB,EAAI0T,aAAa,mBAIf3e,GAAAA,EAAMgxD,wBACR/lD,EAAI0T,aAAa,eAIlB1T,GAAAA,EAAI0T,aAAa,iBACf/e,EAAU4E,SAAAA,EAAWo/C,aAAa5jD,EAAM6C,KAAM,SAAS,OACzD;AAAA,MAAA,GAEDouD,iBAAiB,SAASjxD,GAAOiL,GAChC/B;AAAAA,aAAK4nD,iBAAiB9wD,GAAOiL;MAC7B,GAEDimD,gBAAgB,SAASC,GAAiBC,GAAAA;AACzC,YAAIn5C,IAAS,EACZ0G,cAAa,SAASxG,GAAMC,GAAAA;AAC3BlP,eAAKiP,CAAQC,IAAAA;AAAAA,QACb;AAIF,eADA+4C,EAAgBrlD,MAAM5C,MAAM,CAACkoD,GAAKn5C,CAAAA,CAAAA,GAC3BA;AAAAA,MAEP,GAEDo5C,oBAAoB,SAASrxD,GAAAA;AAC5B,eAAOkJ,KAAKunD,mBAAmBvnD,KAAKgoD,eAAehoD,KAAK+nD,iBAAiBjxD,CAAAA,CAAAA;AAAAA,MACzE,GAIDsxD,sBAAsB;AACrB,eAAOpoD,KAAKunD,mBAAmB,EAACE,MAAM;MACtC,GACDY,sBAAsB,SAAS39B,GAAAA;AAC9B,eAAO1qB,KAAKunD,mBAAmB,EAACE,MAAM,gBAAgB,cAAc/8B,EAAAA,CAAAA;AAAAA,MACpE,GACD49B,6BAA6B,SAAS59B,GACrC;AAAA,eAAO1qB,KAAKqoD,qBAAqB39B;MACjC,GACD69B,sBAAsB;AACrB,eAAOvoD,KAAKunD,mBAAmB,EAACE,MAAM,OACtC,CAAA;AAAA,MAAA,GACDe,uBAAuB,SAAS1xD;AAC/B,YAAI0zB,IAAQxqB,KAAKgoD,eAAehoD,KAAK4nD,kBAAkB9wD,CAIvD;AAAA,eAFA0zB,EAAY,OAAI,OAETxqB,KAAKunD,mBAAmB/8B,CAE/B;AAAA,MAAA,GACDi+B,wBAAwB,WACvB;AAAA,eAAOzoD,KAAKunD,mBAAmB,EAACE,MAAO,UAAU,cAAa/wD,EAAU0tB,OAAOwN,OAAO2b;MACtF,GAGDmb,gBAAgB;AACf,eAAO1oD,KAAKunD,mBAAmB,EAACE,MAAM,OAAA,CAAA;AAAA,MACtC,GAEDkB,mBAAmB,SAAS7xD;AAC3B,eAAOkJ,KAAKwoD,sBAAsB1xD,CAClC;AAAA,MAAA,GAED8xD,oBAAoB,SAAS9xD,GAAO6kD,GAAQzsC;AAC3C,eAAOlP,KAAKunD,mBAAmB,EAACE,MAAO,YAAY,cAAc,CAC/D9L,EAAOjxB,UADwD,SAClCixB,EAAOhiD,KAAKgiD,EAAOjxB,OACjD,MACAxb,CAED,EAAA,CAAA;AAAA,MAAA,GAED25C,eAAe,WACd;AAAA,eAAO7oD,KAAK0oD,eAAAA;AAAAA,MACZ,GACDI,kBAAkB,SAAShyD,GAC1B;AAAA,eAAOkJ,KAAK2oD,kBAAkB7xD,CAAAA;AAAAA,MAC9B,GACDiyD,qBAAqB,WAAA;AACpB,eAAO/oD,KAAKyoD,uBACZ;AAAA,MAAA,GAEDO,eAAe,SAASjnD,GAAKknD;AAC5BjpD,aAAKwnD,cAAczlD,GAAK,EACvBpI,IAAKsvD,IAAS,IACd,aAAY,aACZ,eAAc,OAGf,CAAA;AAAA,MAAA,GACDC,aAAa,SAASnnD,GAAKknD;AAC1BjpD,aAAKwnD,cAAczlD,GAAK,EACvB,mBAAkBknD,IAAS,IAC3BxB,MAAO,OAAA,CAAA;AAAA,MAER,GACD0B,YAAY,SAASpnD;AACpB/B,aAAKwnD,cAAczlD,GAAK,EACvB0lD,MAAO,MAAA,CAAA;AAAA,MAER,GACD2B,gBAAgB,SAASrnD,GAAKrJ,GAC7B;AAAA,YAAI2wD,IAAY3wD,EAAKS,QAAAA,IAAYzC,EAAUiK,UAAUxH,QAAaT,KAAAA,EAAKS,aAAazC,EAAUkK,UAAUzH;AACxG6G,aAAKwnD,cAAczlD,GAAK,EACvB0lD,MAAO,YACP,cAAc/wD,EAAUya,UAAU+rB,SAASxkC,CAC3C,GAAA,iBAAiB2wD,IAAW,SAAS,QAAA,CAAA;AAAA,MAEtC,GACDC,iBAAiB,SAASvnD,GACzB/B;AAAAA,aAAKwnD,cAAczlD,GAAK,EACvB0lD,MAAO,eAAA,CAAA;AAAA,MAER,GAGD8B,mBAAmB,SAASxnD,GAAKrJ,GAChC;AAAA,YAAIq2B,IAAShtB,EAAIqV,cAAc,mBAAA,GAC3B4sB,IAAUjiC,EAAIqV,cAAc,qBAC5B6xC,IAAWvyD,EAAUqM,QAAQ;AACjC/C,aAAKwnD,cAAcz4B,GAAQ,EAAEp1B,IAAMsvD,MACnCjpD,KAAKwnD,cAAcxjB,GAAS,EAAE,mBAAmBilB;MAEjD,GACDO,iBAAiB,SAASznD,GAAKjL,GAC9BkJ;AAAAA,aAAK2nD,UAAU7wD,GAAOiL,CAAAA;AAAAA,MACtB,GAED4yB,oBAAoB,SAAS5yB;AAC5BA,QAAAA,EAAI0T,aAAa,eAAe,MAAA;AAAA,MAChC,GAED0d,qBAAqB,SAASpxB,GAC7BA;AAAAA,QAAAA,EAAI0T,aAAa,eAAe,OAAA;AAAA,MAChC,GAEDuiB,iCAAiC,SAAStN;AACzC,eAAO1qB,KAAKunD,mBAAmB,EAACE,MAAO,UAAU,cAAa/8B,GAAO++B,UAAW,IAChF,CAAA;AAAA,MAAA,GAEDC,YAAY,SAAS3nD,GAAKknD,GAAAA;AACzBjpD,aAAKwnD,cAAczlD,GAAK,EACvBpI,IAAKsvD,IAAS;MAEf,GACDU,UAAU,SAAS5nD,GAAKknD,GACvBjpD;AAAAA,aAAKkpD,YAAYnnD,GAAKknD,CAAAA;AAAAA,MACtB,GACDW,cAAc,SAAS7nD;AACtB,eAAO/B,KAAKspD,gBAAgBvnD,CAAAA;AAAAA,MAC5B,GACD8nD,SAAS,SAAS9nD,GACjB;AAAA,eAAO/B,KAAKmpD,WAAWpnD,CAAAA;AAAAA,MACvB,GACD+nD,aAAa,SAAS/nD,GACrB/B;AAAAA,aAAKwnD,cAAczlD,GAAK,EACvB0lD,MAAO,WAAA,CAAA;AAAA,MAER,GAED1vB,cAAc,SAASh2B;AACtBA,QAAAA,EAAI0T,aAAa,QAAQ,QAAA,GACzB1T,EAAI0T,aAAa,eAAe,MAChC1T,GAAAA,EAAI4E,WAAW8O,aAAa,QAAQ;MACpC,GAEDiiB,0BAAyB,SAASqyB,GAAAA;AACjC,eAAO/pD,KAAKunD,mBAAmB,EAACE,MAAO,UAAU,cAAa/wD,EAAU0tB,OAAOwN,OAAOm4B,CAAAA,GAAaN,UAAW,IAAA,CAAA;AAAA,MAC9G,GACDO,qBAAqB,SAASC,GAC7B;AAAA,eAAOjqD,KAAKunD,mBAAmB,EAACE,MAAO,UAAU,cAAa/wD,EAAU0tB,OAAOwN,OAAOq4B;MACtF,GACD72B,gBAAgB,SAASrxB,GAAKmoD,GAAAA;AAC7BnoD,QAAAA,EAAI0T,aAAa,cAAcy0C,CAC/B;AAAA,MAAA,GAED14B,0BAA0B,SAASb;AAClC,YAAIjG,IAAQ;AAEZ,gBAAQiG,GAAAA;AAAAA,UACP,KAAK;AACJjG,YAAAA,IAAQh0B,EAAU0tB,OAAOwN,OAAO2E;AAChC;AAAA,UACD,KAAK;AACJ7L,YAAAA,IAAQh0B,EAAU0tB,OAAOwN,OAAO0E;AAChC;AAAA,UACD,KAAK;AACJ5L,YAAAA,IAAQh0B,EAAU0tB,OAAOwN,OAAOjtB;AAChC;AAAA,UACD,KAAK;AACJ+lB,YAAAA,IAAQh0B,EAAU0tB,OAAOwN,OAAOyc,OAAO,MAAM33C,EAAU0tB,OAAOwN,OAAO0c;AAAAA,QAAAA;AAMvE,eAAO53C,EAAU66B,SAASg2B,mBAAmB,EAAC,cAAc78B,EAC5D,CAAA;AAAA,MAAA,GAGD+Y,yBAAyB,SAAS0mB;AACjC,eAAO,4CAA0CA,IAAY;AAAA,MAC7D,GAEDvlB,iBAAiB,SAAS7iC,GAAAA;AACzBA,QAAAA,EAAI0T,aAAa,QAAQ,OAAA;AAAA,MAEzB,GAEDquB,kBAAkB,SAAS/hC,GAAKgB,GAC/BhB;AAAAA,QAAAA,EAAI0T,aAAa,QAAQ,QAAA,GACtB1S,KACFhB,EAAI0T,aAAa,mBAAmB1S;MAIrC,GAEDqnD,eAAe,SAASroD,GACvBA;AAAAA,QAAAA,EAAI0T,aAAa,QAAQ,QAAA;AAAA,MACzB,GAED40C,2BAA2B,WAAA;AAC1B,eAAO;AAAA,MACP,GAEDC,iBAAiB,SAASvoD,GAAKgtB;AAC9BhtB,QAAAA,EAAI0T,aAAa,cAAcsZ,CAAAA;AAAAA,MAC/B,GAEDw7B,2BAA2B,SAAS7/B,GACnC;AAAA,eAAOh0B,EAAU66B,SAASg2B,mBAAmB,EAACE,MAAO,UAAU,cAAa/8B,GAAO++B,UAAW,IAAA,CAAA;AAAA,MAC9F,GAEDe,aAAa,SAASzoD;AACrBA,QAAAA,EAAI0T,aAAa,QAAQ,SACzB;AAAA,MAAA,GAEDg1C,oBAAoB,SAAS1oD,GAC5BA;AAAAA,QAAAA,EAAI0T,aAAa,eAAe,OAAA;AAAA,MAChC,GAEDi1C,mBAAmB,SAAS3oD;AAC3BA,QAAAA,EAAI0T,aAAa,eAAe,MAAA;AAAA,MAChC,EAOW/e,GAAAA,EAAU66B;AACtB76B,QAAAA,EAAU66B,SAAS33B,KAAK,SAAU2rC,GAAAA;AACjC,iBAAO,WACN;AAAA,mBANM7uC,EAAUM,OAAO8iB,sBAShByrB,EAAQ3iC,MAAM5C,MAAM+I,SAAAA,IAFnB;AAAA,UAGZ;AAAA,QACG,EAAErS,EAAU66B,SAAS33B,CAIvB,CAAA;AAAA,IAAA,GAED;AAAA,EAAA,EJlTUlD,CAGTA,GAAAA,EAAUod,QAAQA,IAClBpd,EAAUu+B,cAAclW,IACxBroB,EAAUod,MAAM62C,MAAM5rC,IACtBroB,EAAUqM,MAAM+Q,GAAM/Q,KACtBrM,EAAUqd,QAAQD,GAAMC,OACxBrd,EAAUme,UAAUf,GAAMe,SAC1Bne,EAAUk0D,SK9DI,SAASl0D,GACvB;AAAA,WAAO,SAAgBuvD,GAAOxzC,GAAAA;AACxBwzC,MAAAA,KACDvvD,EAAUM,OAAO6zD,eAAen0D,EAAUmJ,UAAU,WAAU,CAAC4S,CAAAA,CAAAA,MAAc,OAC3E/b,EAAU+b,UACb/b,EAAU+b,QAAQ,EAAClW,MAAM,SAAS2W,MAAMT,GAASU,QAAAA,QAIjD9H,QAAQmtC,IAAI/lC;IAOjB;AAAA,EACA,EL6C2B/b,CAC1BA,GAAAA,EAAUqc,OAAOe,GAAMf,MAEvBrc,EAAUo0D,oBAAoB,SAAS5tD,GAAWlG;AACjD,WAAO,IAAI67C,GAAWn8C,GAAWwG,GAAWlG,CAC9C;AAAA,EAAA,GAMCN,EAAUq0D,qBAAqBhsC,GAAYmC,mBAC3CxqB,EAAUkQ,gBAAgBmY,GAAYhC,cACtCrmB,EAAUs0D,cAAcjsC,GAAY7B;AAEpC,QAAM+tC,IAAax4C,GAAQ/b;AM7Eb,MAIJw0D,GACNC,GACA1gD;ANwEJ/T,EAAAA,EAAUod,MAAMC,MAAMrd,GAAWu0D,CAEjCv0D,GAAAA,EAAUosB,MAAMpsB,EAAUslD,OAAOl5B,IACjCpsB,EAAU4Y,UAAU/Y,OAAO+Y,SOjFb,SAAgB5Y,GAE/BA;AAAAA,IAAAA,EAAU21C,aAAa,WAAA;AAyBtB,eAAQzyC,KAxBRlD,EAAUmJ,UAAU,aAAa,CACjCG,CAAAA,GAAAA,KAAKorD,YAEFprD,KAAKxG,eAEPwG,KAAKxG,WAAWgL,YAAY,KAI1BxE,KAAKwc,mBACPxc,KAAKwc,gBAGHxc,GAAAA,KAAK40B,iBACP50B,KAAK40B,cAAAA,GAGH50B,KAAK6L,OAAO7L,KAAK6L,IAAIwgC,cACvBrsC,KAAK6L,IAAIwgC,cAIVrsC,KAAK0b,gBAAAA,GAEQ1b;AACU,QAAnBpG,EAAEiN,QAAQ,GAAA,MAAS,KAAT,OACL7G,KAAKpG,CAAAA;AAGdlD,MAAAA,EAAUkiB,aAAa;AAAA,IACxB;AAAA,EAEA,EP+CYliB,IQhFG,SAAgBA,GAAAA;AAI/B,aAAS20D,EAAa79C,GAAQgC,GAAAA;AAC7B,UAAIT,IAAS,EACZvB,QAAQA,EAGT;AAAA,UAAIgC,EAAK3V,WAAW;AACnB,cAAM,IAAIkN,MAAM,mCAAA;AAEjB,UAAIyI,EAAK3V,WAAW;AAqBnB,eApBuB,OAAZ2V,EAAK,CACfT,KADsB,YACtBA,EAAOlC,MAAM2C,EAAK,CAClBT,GAAAA,EAAOu8C,eAEPv8C,EAAOlC,MAAM2C,EAAK,CAAA,EAAG3C,KACrBkC,EAAOu8C,QAAS97C,EAAK,CAAA,EAAG87C,SAAS,IACjCv8C,EAAO3D,WAAWoE,EAAK,GAAGpE,UAC1B2D,EAAOxB,UAAUiC,EAAK,CAAA,EAAGjC,UAGrBiC,EAAK,CAAGlJ,EAAAA,cACAkJ,EAAK,CAAA,EAAGlJ,QAAS,WAC3ByI,EAAOzI,OAAOonB,GAAUle,EAAK,CAAA,EAAGlJ,IAEhCyI,IAAAA,EAAOzI,OAAOkJ,EAAK,GAAGlJ,OAGvByI,EAAOzI,OAAO,IAGTyI;AAIR,cADAA,EAAOlC,MAAM2C,EAAK,CAAA,GACXhC,GACN;AAAA,QAAA,KAAK;AAAA,QACL,KAAK;AACJuB,UAAAA,EAAO3D,WAAWoE,EAAK,IACvBT,EAAOxB,UAAUiC,EAAK,CAAA;AACvB;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AACAA,UAAAA,EAAK,CACe,IAAA,OAAZA,EAAK,CACfT,KADsB,WACtBA,EAAOzI,OAAOonB,GAAUle,EAAK,CAAA,CAAA,IAE7BT,EAAOzI,OAAOkJ,EAAK,KAGpBT,EAAOzI,OAAO,IAEfyI,EAAO3D,WAAWoE,EAAK,CAAA,GACvBT,EAAOxB,UAAUiC,EAAK,CAGxB;AAAA,MAAA;AAAA,aAAOT;AAAAA,IACR;AAzDArY,IAAAA,EAAU4Y,UAAU/Y,OAAO+Y,SA0D3B5Y,EAAUsyB,OAAO,EAGhB28B,OAAAA,IAGAn4C,QAAQ,OAER+9C,wBAAwB79B,IACxB7f,OAAO,SAASvH,GACf;AAAA,aAAWA,OAAAA,KAAS,WAAiBA,KAGrCA,IAAOA,EAAKiI,QAAQ,UAAS,KAClBi9C,OAAAA,YAAc,OAAgB90D,EAAUslD,KAAKj5B,OAEtCxsB,OAAOk1D,kBAF+B1oC,YAGvD3pB,IAAM,IAAI7C,OAAOk1D,cAAc,qBAC3BH,QAAQ,SACZlyD,EAAIsyD,QAAQplD,CAAAA,KAJZlN,IAAM,IAAKoyD,YAAaG,gBAAgBrlD,GAAM,UAAA,GAMxClN;AATP,UAAIA;AAAAA,IAUJ,GACDywB,QAAQ,SAAS+hC,GAASpiC,GAAKpwB,GAC9B;AAAA,UAAWowB,EAAI/Z,WAAf,UAAwC+Z,EAAI/Z,SAAS,KAAK;AACzD,YAAI6Z,IAAQE,EAAIC,cAAsDD,EAAIC,eAAeD,IAA1DxpB,KAAK6N,MAAM2b,EAAIG,gBAAgBH,CAAAA;AAC9D,YAAIF,KAAOA,EAAIlR,oBAAoB,QAApBA,CAA6BkR,EAAIkG,qBAAqB,eAAe31B;AACnF,iBAAOyvB,EAAIkG,qBAAqBo8B,CAAAA,EAAS;MAE1C;AAED,aADIxyD,MACJ,MADgB1C,EAAUmJ,UAAU,kBAAiB,CAAC,iBAAiBkJ,UAAU,CAAI3P,GAAAA,CAAAA,CAAAA,GAC9EkL,SAASC,cAAc,KAAA;AAAA,IAC9B,GACD4lB,OAAO,SAAS0hC,GAAUC;AAEzB,UADKA,EAAO5tC,aAAU4tC,IAASA,EAAOriC,eAAeqiC,IACjDp1D,EAAUslD,KAAKj5B;AAClB,eAAO+oC,EAAOC,YAAYF,CAAW,KAAA,CAAA;AAMrC,eAHIp7B,GADAja,IAAO,CAEPqpB,GAAAA,KAAOisB,EAAOE,iBAAeF,GAAQG,SAASJ,GAAUC,GAAQ,MAAMI,YAAYC,UAAU,IAAA,GAG/F17B,IAAQoP,EAAIusB,YAAAA;AAEX51C,QAAAA,EAAKnd,KAAKo3B,CAKZ;AAAA,aAAOja;AAAAA,IAER,GACD+xB,OAAO,SAASvxC,GACf;AAAA,aAAOgJ,KAAKqsD,MACVr1D,EAAOwW,UAAU,OAClBxW,EAAO6V,KACP7V,EAAOsP,QAAQ,IACdtP,EAAOs0D,SAAS,IACjBt0D,EAAOoU,UACPpU,EAAOuW,OAER;AAAA,IAAA,GACD0b,KAAK,SAASpc,GAAKy/C,GAAQ/+C,GAAAA;AAC1B,UAAIvW,IAASq0D,EAAa,OAAOtiD,SACjC;AAAA,aAAO/I,KAAKuoC,MAAMvxC,CAClB;AAAA,IAAA,GACDu1D,SAAS,SAAS1/C,GAAKU;AACtB,UAAIvW,IAASq0D,EAAa,OAAOtiD,SAAAA;AAEjC,aADA/R,EAAOs0D,QAAQ,IACRtrD,KAAKuoC,MAAMvxC,CAAAA;AAAAA,IAClB,GACDw1D,KAAK,SAAS3/C,GAAK4/C,GAAUH,GAAQ/+C,GACpC;AAAA,UAAIvW,IAASq0D,EAAa,OAAOtiD,SACjC;AAAA,aAAO/I,KAAKuoC,MAAMvxC,CAAAA;AAAAA,IAClB,GACD01D,KAAK,SAAS7/C,GAAKy/C,GAAQ/+C,GAO1B;AAAA,UAAIvW,IAASq0D,EAAa,UAAUtiD;AACpC,aAAO/I,KAAKuoC,MAAMvxC,CAClB;AAAA,IAAA,GACD21D,MAAM,SAAS9/C,GAAK4/C,GAAUH,GAAQ/+C,GACb;AAAA,MAApBxE,UAAUlP,UAAU,IACvB4yD,IAAW,KACD1jD,UAAUlP,UAAU,KAAY,OAAAgf,KAAa,eACvDyzC,IAASG,GACTA,IAAW;AAEZ,UAAIz1D,IAASq0D,EAAa,QAAQtiD,SAAAA;AAClC,aAAO/I,KAAKuoC,MAAMvxC,CAAAA;AAAAA,IAClB,GACD41D,UAAU,SAAS//C,GAAK4/C,GAAUl/C,GAAAA;AACjCk/C,MAAAA,IAAYA,MAAa,OAAO,KAAKryD,OAAOqyD,CAE5C;AAAA,UAAIz1D,IAASq0D,EAAa,QAAQtiD;AAElC,aADA/R,EAAOs0D,YACAtrD,KAAKuoC,MAAMvxC,CAAAA;AAAAA,IAClB,GACDq1D,OAAO,SAAS7+C,GAAQX,GAAK4/C,GAAUnB,GAAOgB,GAAQ/+C;AACrD,aAAO,IAAI7W,EAAU4Y,SAAS,SAASI,GAASC;AAC/C,YAAI1G,WAAY4jD,mBAAZ5jD,UAA6CvS,EAAUslD,KAAKj5B,OAA8B,IAAIxsB,OAAOk1D,cAAc,mBAAhD,IAAA,IAAIoB,kBACvEC,IAAQhtC,UAAUC,UAAUiE,MAAM,mBAAmB,QAAQlE,UAAUC,UAAUiE,MAAM,IAA0D,MAAhD,QAAQlE,UAAUC,UAAUiE,MAAM,cAAc;AA4BrJ,YA1BMsnC,KACLriD,EAAE4S,iBAAiB,oBAAoB,WACtC;AAAA,cAAK5S,EAAE8jD,cAAc,KAAOD,KAAQ7jD,EAAE8jD,cAAc,GAAI;AACvD,iBAAI9jD,EAAEwG,UAAU,OAAOxG,EAAE0gB,iBAAiB,QACpCjzB,EAAUmJ,UAAU,eAAe,CAACoJ,CAAAA,CAAAA;AAAK;AAE/C0F,uBAAW,WAAA;AACY,cAAX,OAAA/U,KAAW,cACrB0yD,EAAO1pD,MAAMrM,QAAQ,CAAC,EAACmzB,QAAOzgB,GAAG+jD,UAASngD,OAE3C6C,EAAQzG,CAAAA,GACG,OAAArP,KAAW,eACrB0yD,IAAS,MACTrjD,IAAI;AAAA,YAEL,GAAE;UACH;AAAA,QACN,CAAA,GAGOuE,KAAU,SAAUxN,KAAK2lD,UAC5B94C,MAAQA,EAAIhG,QAAQ,QAAM,IAAE,MAAI,OAAK,UAAO,oBAAI3N,QAAOgsB,QAAU,IAAA,OAGlEjc,EAAEgkD,KAAKz/C,GAAQX,GAAKy+C,IAEhB/9C;AACH,mBAASxD,KAAOwD;AACftE,YAAAA,EAAE0/B,iBAAiB5+B,GAAKwD,EAAQxD,CAAAA,CAAAA;AAAAA;AACC,UAAxByD,EAAO0/C,iBAAiB,UAAU1/C,KAAU,SAASA,KAAU,WACzEvE,EAAE0/B,iBAAiB,gBAAgB,mCAAA,IACzBn7B,KAAU,UACpBi/C,IAAW;AAOZ,YAJAxjD,EAAE0/B,iBAAiB,oBAAoB,gBAEvC1/B,GAAAA,EAAEiH,KAAKu8C,CAEFnB,GAAAA,CAAAA;AAAO,iBAAO,EAAC5hC,QAAOzgB,GAAG+jD,UAASngD,EAC1C;AAAA,MAAA,GAAIgD,KAAK7P,IACP,CAAA;AAAA,IAAA,GACD6nC,cAAc,SAASlrB,GAAAA;AACtB,aAAIA,EAAI9V,QAAQ,GACR,UAAA,MAEA;AAAA,IACR,EAGFnQ,GAAAA,EAAUy2D,QAAQz2D,EAAUsyB;AAAAA,EAE5B,ER3IMtyB,CAEL0kD,GAAAA,GAAK1kD,ISrFS,SAAgBA,GAAAA;AAkB/BA,IAAAA,EAAUM,SAAO,EAChBo2D,cAAc,YACdC,YAAY,SACZC,WAAW,YACXC,WAAW,MACXrwB,UAAU,SACV8C,WAAW,SACXE,WAAW,MAEXstB,aAAa,kBACbC,UAAU,kBACV5lC,oBAAoB,IACpBw0B,qBACAhrB,WAAW,GACX+M,uBAAuB,WACvBC,4BAA4B,WAC5BxM,WAAW,GACX67B,oBAAoB,GACpBvvB,uBAAAA,IACAzoB,kBAAkB,IAClB4P,qBACAxkB,YAAY,GACZC,WAAW,IACX0wB,UAAU,IACV4xB,aAAa,IACbC,eACAqK,aAAAA,IACAlO,iBAAiB,IACjBn1C,qBACAixC,qBAAAA,IACA4E,gBAAAA,IACAC,mBAAAA,IACArxB,QAAQ,MACR7oB,cAAc,IACd0nD,qBAAAA,IACAC,oBAAmB,IACnB/6B,qBAAqB,IACrBg7B,uBAAuB,IACvBx2B,SAEA/7B,uBAAAA,IACAwyD,qBAAqB,GACrBC,sBAAsB,IAEtBpK,WAAAA,IACAqK,wBAAwB,KAExBr2B,eAAAA,IACAupB,iBAAiB,IACjB9iC,YACArL,cAAAA,IACA2Z,YAAY,IACZgM,OAAM,IACN0D,WAAU,IACVT,YAAW,KACXW,mBAAAA,IACA2xB,qBAAoB,IAEpBrR,sBAEA5lD,gBAAAA,IACA+nD,gBAAAA,IACAmP,YAAY,CAAC,aAAa,aAAA,GAC1BC,cAAc,CAAC,gBAAgB,aAAa,aAC5C32B,GAAAA,eAAe,CAAC,gBAAgB,gBAChCE,GAAAA,cAAc,CAAC,gBACf9I,GAAAA,UAAU,EACT92B,UAAU,CACT,EAACkX,MAAM,eAAe/U,QAAQ,QAAQqC,MAAM,YAAYwzB,UACxD,GAAA,EAAC9gB,MAAM,QAAQxJ,QAAQ,IAAIlJ,MAAM,QAAQrC,QAAQ,OAAA,CAAA,EAAA,GAGnDm0D,2BAA2B,IAC3B7M,iBAEA8M,YAAY,SACZC,cAAc,GACdC,0BACA10C,qBAAAA,IACAu+B,2BAAAA,IAEA3zB,KAAK,QACLhrB,iBAAiB,iBACjBmxD,gBAGDn0D,GAAAA,EAAUM,OAAO2gC,aAAa82B,WAAW/3D,EAAUM,OAAO2gC,aAAaxzB,KAAAA,GACvEzN,EAAUM,OAAOygC,cAAcg3B,WAAW/3D,EAAUM,OAAOygC,cAActzB,KAEzEzN,GAAAA,EAAU42B,WAAW,EACpBC,WAAW,SAAmB70B,GAE7B;AAAA,cADYhC,EAAUya,UAAUu9C,YAAYh4D,EAAUya,UAAUC,YACnD1Y,CACb;AAAA,IAAA,GACDk0C,YAAY,SAAoBl0C;AAE/B,cADahC,EAAUya,UAAU6c,cAAct3B,EAAUya,UAAU8c,aACrDv1B,CAAAA;AAAAA,IACd,EAGFhC,GAAAA,EAAUya,YAAU,CAAA,GACpBza,EAAUgiD,iBAAe;AAIxB,UAAIrwC,IAAE3R,EAAUgC,KAAK0tB,aACjBxnB,IAAElI,EAAUM;AACR,OAAA,SAAS6hB,GAAEC,GAClB;AAAA,iBAASla,KAAKka;AACRD,UAAAA,EAAEja,CAAIia,MAAAA,EAAEja,CAAGka,IAAAA,EAAEla,CACrB;AAAA,MAAA,GACGlI,EAAUya,WAAU,EACrB+rB,UAAS70B,EAAEzJ,EAAEwuD,YACbC,GAAAA,YAAWhlD,EAAEzJ,EAAEyuD,UACfE,GAAAA,WAAU,SAASoB,GAAGC,GAAAA;AACrB,eAAGhwD,EAAE04B,MACG5gC,EAAUya,UAAU+rB,SAASxmC,EAAUgC,KAAKC,IAAIi2D,GAAAA,IAAM,KAAQ,CAAA,IAAA,cAAYl4D,EAAUya,UAAU+rB,SAASyxB,KAExGj4D,EAAUya,UAAU+rB,SAASyxB,CAAAA,IAAI,cAAYj4D,EAAUya,UAAU+rB,SAASxmC,EAAUgC,KAAKC,IAAIi2D,GAAAA,IAAM,KAC1G,CAAA;AAAA,MAAA,GACDC,gBAAexmD,EAAEzJ,EAAEwuD,YAAAA,GACnBrK,gBAAgB,SAASrqD,GAAAA;AACxB,eAAO;AAAA,MACP,GACDsqD,iBAAiB,SAAStqD,GAAAA;AACzB,eAAO;AAAA,MACP,GAEDo2D,kBAAiBzmD,EAAEzJ,EAAE2uD,SAAAA,GACrBwB,iBAAgB1mD,EAAEzJ,EAAEs+B,WACpB6C,YAAW13B,EAAEzJ,EAAEohC,SAAAA,GACf5O,aAAY/oB,EAAEzJ,EAAEohC,SAChBgvB,GAAAA,YAAW3mD,EAAEzJ,EAAEohC,SAAAA,GACfE,WAAU73B,EAAEzJ,EAAEshC,SAEdrX,GAAAA,aAAaxgB,EAAEzJ,EAAE0uD,YAGjBr/B,aAAa5lB,EAAEzJ,EAAE4uD,aAAa5uD,EAAE+tB,aAChCvb,YAAW1a,EAAUgC,KAAKuuB,YAAYroB,EAAE4uD,aAAY5uD,EAAE+tB,UACtD8gC,GAAAA,UAAS/2D,EAAUgC,KAAKuuB,YAAYroB,EAAE6uD,UAAU,IAAA,EAChDj6B,GAAAA,cAAa,SAAS7vB,GAAMC,GAAInH,GAE/B;AAAA,eAAGA,EAAG2E,UAAU,WAAW3E,EAAG2E,UAAU,aAChC1K,EAAUya,UAAU69C,WAAWrrD,CAAAA,IAE/BjN,EAAUya,UAAU69C,WAAWrrD,KAAO,QAAMjN,EAAUya,UAAU69C,WAAWprD,CAAAA;AAAAA,MAEnF,GACDikD,YAAW,SAASlkD,GAAMC,GAAInH,GAC7B;AAAA,eAAOA,EAAGyW;AAAAA,MACV,GACD+7C,aAAY,SAAStrD,GAAMC,GAAInH,GAC9B;AAAA,eAAO;AAAA,MACP,GACDwoD,kBAAiB,SAAS58C,GACzB;AAAA,eAAO;AAAA,MACP,GACD66C,iBAAgB,SAAS76C,GAAAA;AACxB,eAAO;AAAA,MACP,GACD6mD,gBAAe,SAASvrD,GAAMC,GAAInH,GAAAA;AACjC,eAAO/F,EAAUya,UAAU69C,WAAWrrD,CAAAA;AAAAA,MACtC,GACD+vB,gBAAe,SAAS/vB,GAAMC,GAAInH;AACjC,eAAOA,EAAGyW;AAAAA,MACV,GACDi8C,mBAAoB,SAASz2D,GAAMkpD,GAClC;AAAA,eAAO,kBAAgBA,IAAM;AAAA,MAC7B,GACDwN,mBAAoB,SAASzrD,GAAOC,GAAK9M,GAAAA;AACxC,eAAO;AAAA,MACP,GACDu4D,qBAAsB,SAAS1rD,GAAOC,GAAK9M;AAC1C,eAAO;AAAA,MACP,GAEDw4D,qBAAqB54D,EAAUgC,KAAK0tB,YAAY,gBAChDmpC,GAAAA,cAAc,SAAS5rD,GAAOC,GAAK9M;AAClC,eAAO,mBAAmBA,EAAMoc,OAAO,6BAA6Bxc,EAAUya,UAAUm+C,oBAAoB3rD,CAAAA,IAAS,2BAA2BjN,EAAUya,UAAUm+C,oBAAoB1rD,CACxL;AAAA,MAAA,GAED4rD,gBAAgBnnD,EAAE,OAAA,GAClBonD,qBAAqBpnD,EAAE,IACvBqnD,GAAAA,eAAernD,EAAE,IACjBsnD,GAAAA,eAAetnD,EAAE,UAGlBrI,EAAAA,CAAAA,GAAAA,KAAKH,UAAU,oBAAmB,CAAA,CAAA;AAAA,IACnC;AAAA,EAGA,ET5HQnJ,CAAAA,GUtFO,SAAgBA,GAE/BA;AAAAA,IAAAA,EAAU0W,UAAU,CAAA,GACpB1W,EAAU00D,WAAW,WAAA;AACpBprD,WAAKoN,UAAU,IACfpN,KAAKqoB,UAAU,IAEfroB,KAAKy6C,WAAW,MAChBz6C,KAAKq6C,aAAa,MAClBr6C,KAAKR,WAAW,MAChBQ,KAAKP,aAAa,MAClBO,KAAKw6B,YAAY,MACjBx6B,KAAKmS,aAAa,MAElBnS,KAAK4vD,WAAAA,GACL5vD,KAAKH,UAAU,cAAc,CAC9B,CAAA;AAAA,IAAA,GACAnJ,EAAU6a,WAAW,SAAStZ,GAAYC,GAAUgb,GAAMvZ,GAAIk2D,GAAAA;AAC7D,UAAK9mD,CAAAA,UAAUlP;AACd,eAAOmG,KAAKuK;AACb,UAAI9N,IAAKxE;AACe,MAApB8Q,UAAUlP,UAAU,OACvB4C,IAAKozD,KAAc,IAChB53D,aAAaA,GAChBwE,EAAGvE,WAAWA,GACduE,EAAGyW,OAAOA,GACVzW,EAAG9C,KAAKA,IAET8C,EAAG9C,KAAK8C,EAAG9C,MAAMjD,EAAUqM,IAC3BtG,GAAAA,EAAGyW,OAAOzW,EAAGyW,QAAQ,IAEO,OAAjBzW,EAAGxE,cAAc,aAAWwE,EAAGxE,aAAa+H,KAAKmR,UAAUs8C,SAAShxD,EAAGxE,cACvEwE,OAAAA,EAAGvE,YAAY,aAAWuE,EAAGvE,WAAW8H,KAAKmR,UAAUs8C,SAAShxD,EAAGvE,QAC9E;AAAA,UAAImQ,IAA4D,OAAvDrI,KAAKhJ,OAAOm7B,kBAAkBnyB,KAAKhJ,OAAOq6B;AAE/C,UAAIn4B,KAAKuD,EAAGvE,QAAUiB,EAAAA,QAAAA,IAAY,IAAID,KAAKuD,EAAGxE,UAAYkB,EAAAA,QAAAA,KAAakP,KAC1E5L,EAAGvE,SAAS+sB,QAAQxoB,EAAGvE,SAASiB,QAAYkP,IAAAA,CAAAA,GAE7C5L,EAAGxE,WAAW+sB,gBAAgB,CAC9BvoB,GAAAA,EAAGvE,SAAS8sB,gBAAgB,IAE5BvoB,EAAG4C,SAASW,KAAKV,cAAc7C,CAAAA;AAE/B,UAAIyjD,IAAUlgD,CAAAA,KAAKoN,QAAQ3Q,EAAG9C,EAK9B;AAAA,aAJAqG,KAAKoN,QAAQ3Q,EAAG9C,MAAM8C,GACtBuD,KAAK4qC,cAAcnuC,CACduD,GAAAA,KAAKgtB,YACThtB,KAAKH,UAAUqgD,IAAS,iBAAiB,kBAAkB,CAACzjD,EAAG9C,IAAI8C,CAAAA,CAAAA,GAC7DA,EAAG9C;AAAAA,IACX,GACAjD,EAAUub,cAAc,SAAStY,GAAIm2D;AACpC,UAAIrzD,IAAKuD,KAAKoN,QAAQzT,CAAAA;AAAAA,OACjBm2D,KAAY9vD,KAAKH,UAAU,uBAAuB,CAAClG,GAAI8C,CAAAA,CAAAA,KAASuD,KAAKH,UAAU,gCAAgC,CAAClG,GAAI8C,CAAAA,CAAAA,OAErHA,MACA/F,EAAU4E,SAAAA,EAAWo/C,aAAa/gD,KACpCjD,EAAU8E,mBAEJwE,KAAKoN,QAAQzT,IACpBqG,KAAK4qC,cAAcnuC,IAEhBuD,KAAKR,YAAY/C,EAAG9C,OACtBqG,KAAKR,WAAW,MAChBQ,KAAKP,aAAW,MAChBO,KAAKw6B,YAAU,QAIjBx6B,KAAKH,UAAU,kBAAkB,CAAClG,GAAI8C,CAAAA,CAAAA;AAAAA,IACvC,GACA/F,EAAUyE,WAAW,SAASxB,GAC7B;AAAA,aAAOqG,KAAKoN,QAAQzT,CAAAA;AAAAA,IACrB,GACAjD,EAAUs9B,WAAW,SAASr6B,GAAIo2D,GAC7BA;AAAAA,MAAAA,EAAKp2D,OACRo2D,EAAKp2D,KAAKA,IAEXqG,KAAKoN,QAAQzT,CAAMo2D,IAAAA;AAAAA,IACpB,GACAr5D,EAAUylC,eAAe,SAASxiC,GAAI6T;AACrC,eAAS5T,IAAIoG,KAAKo8B,UAAUviC,SAAS,GAAGD,KAAK,GAAGA;AAC3CoG,aAAKo8B,UAAUxiC,GAAGiB,aAAamF,KAAKhJ,OAAO0C,eAAoBC,KAAAA,KAClE6T,EAAOxN,KAAKo8B,UAAUxiC,CAAAA,GAAIA;IAC7B,GACAlD,EAAUgb,gBAAgB,SAAS/X,GAAI8+B;AACtC,UAAI9+B,KAAM8+B,GAAV;AACA,YAAIh8B,IAAKuD,KAAKoN,QAAQzT,CAAAA;AAClB8C,QAAAA,MACHA,EAAG9C,KAAK8+B,GACRz4B,KAAKoN,QAAQqrB,KAAUh8B,GAChBuD,OAAAA,KAAKoN,QAAQzT,CAErBqG,IAAAA,KAAKm8B,aAAaxiC,GAAI,SAAS8U;AAC9BA,UAAAA,EAAEgH,aAAa,YAAYgjB,CAAAA,GAC3BhqB,EAAEgH,aAAa/e,EAAUM,OAAO0C,iBAAiB++B;QACnD,CACKz4B,GAAAA,KAAKq6C,cAAc1gD,MAAIqG,KAAKq6C,aAAa5hB,IACzCz4B,KAAKy6C,YAAY9gD,MAAIqG,KAAKy6C,WAAWhiB,IAEzCz4B,KAAKH,UAAU,mBAAmB,CAAClG,GAAI8+B,CAdd,CAAA;AAAA,MAAA;AAAA,IAe1B,GAEA,WAAA;AAcC,eAbIjO,IAAQ,CAAC,QAAQ,QAAQ,cAAc,aAAa,YAAY,SAChEwlC,GAAAA,IAAgB,SAAS/gD,GAAAA;AAC5B,eAAO,SAAStV,GAAAA;AAAM,iBAAQjD,EAAUyE,SAASxB,GAAKsV;;MACxD,GACKghD,IAAgB,SAAShhD,GAAAA;AAC5B,eAAO,SAAStV,GAAIuV;AACnB,cAAIzS,IAAK/F,EAAUyE,SAASxB,CAAAA;AAC5B8C,UAAAA,EAAGwS,CAAAA,IAAQC,GACXzS,EAAG4pC,eACH5pC,EAAG4C,SAASW,KAAKV,cAAc7C,IAC/B/F,EAAUk0C,cAAcnuC,GAAI,EAAA;AAAA,QAC/B;AAAA,MACA,GACU7C,IAAI,GAAGA,IAAI4wB,EAAM3wB,QAAQD,KAAK;AACtClD,QAAAA,EAAU,aAAa8zB,EAAM5wB,IAAI,CAAMo2D,CAAAA,IAAAA,EAAcxlC,EAAM5wB,CAC3DlD,CAAAA,GAAAA,EAAU,aAAa8zB,EAAM5wB,IAAI,MAAMq2D,EAAczlC,EAAM5wB,CAE5D,CAAA;AAAA,IAAA,EAEDlD,GAAAA,EAAUk0C,gBAAgB,SAASnuC,GAAIwX;AAClCjU,WAAKkwD,kBAAkBzzD,KAC1BuD,KAAK0M,iBAAAA,IAEL1M,KAAKmwD,YAAY1zD,EAAG9C,EAAAA;AAAAA,IACtB,GACAjD,EAAUw5D,oBAAoB,SAASzzD,GACtC;AAAA,UAAA,CAAIuD,KAAKY,aAAcZ,CAAAA,KAAKW;AAC3B,eAAA;AAMD,UAFwBlE,EAAGxE,WAAWkB,QAAAA,IAAY6G,KAAKW,UAAUxH,QAAAA,KAAa6G,KAAKY,UAAUzH,QAAAA,IAAYsD,EAAGvE,SAASiB,QAEjG,GAAA;AAGnB,YAAIi3D,IAAc3zD,EAAGxE,WAAW4I,SAC/BwvD,GAAAA,IAAa5zD,EAAGvE,SAAS2I,SAAAA,IAAcpE,EAAGvE,SAASiK,WAAa,IAAA,IAChEmuD,IAAWtwD,KAAKhJ,OAAO+J,WACvB09C,IAAYz+C,KAAKhJ,OAAO8J;AAIzB,eAAA,EAAA,CAFyBd,KAAKmB,gBAAkBkvD,IAAaC,KAAYD,KAAc5R,OAAe2R,KAAeE,KAAYF,IAAc3R,MAAAA,GAOxHhiD,EAAGvE,SAASiB,QAAAA,IAAYsD,EAAGxE,WAAWkB,QAAS,KAAA,OAClD,MAAM6G,KAAKhJ,OAAO+J,YAAYf,KAAKhJ,OAAO8J,eAEZsvD,IAAcE,KAAYD,IAAa5R;AAAAA,MAG3F;AACE;IAEF,GACA/nD,EAAU4I,gBAAgB,SAAS7C;AAIlC,UAAI8zD,IAAe,IAAIr3D,KAAKuD,EAAGvE,SAASiB,YAAY,CACpD;AAAA,aACCsD,EAAGxE,WAAW2b,YAAAA,MAAkB28C,EAAa38C,YAC7CnX,KAAAA,EAAGxE,WAAW4b,SAAAA,MAAe08C,EAAa18C,SAAAA,KAC1CpX,EAAGxE,WAAWsG,QAAAA,MAAcgyD,EAAahyD,QACnC9B,KAAAA,EAAGvE,SAASiB,QAAYsD,IAAAA,EAAGxE,WAAWkB,QAAAA,IAAS;AAAA,IACvD,GAEAzC,EAAU85D,qBAAqB,SAASC;AAEvC,UAAI/oB,IAAQ;AAEZ,eAAS/tC,KAAMqG,KAAKoN;AACfpN,aAAKkwD,kBAAkBlwD,KAAKoN,QAAQzT,QAClC82D,KAAczwD,CAAAA,KAAKoN,QAAQzT,CAAI0F,EAAAA,UAC/BW,KAAK0wD,aAAa/2D,GAAIqG,KAAKoN,QAAQzT,CACtC+tC,CAAAA,KAAAA,EAAMruC,KAAK2G,KAAKoN,QAAQzT;AAE5B,aAAO+tC;AAAAA,IACR,GACAhxC,EAAUg6D,eAAe,SAAS/2D,GAAI8C,GACrC;AAAA,UAAIsT,IAAS/P,KAAK,YAAYA,KAAKoB,KACnC;AAAA,aAAA,CAAOyX,KAAW9I,EAAOpW,GAAI8C,CAAAA;AAAAA,IAC9B,GACA/F,EAAUi6D,sBAAsB,SAASl0D,GACxC;AAAA,aAAA,CAAA,CAASA,EAAG4C;AAAAA,IACb,GACA3I,EAAUgW,mBAAmB,SAAS7N,GAAK+xD;AAC1C,UAAIC,IAAAA;AACJ,UAAKhyD,CAAAA,GAAK;AAET,YADAgyD,IAAAA,IACI7wD,KAAKitB;AAER,iBAAA,MADAjtB,KAAKktB,eAAe;AAGrBltB,aAAKktB,eAAe,IAEpBltB,KAAK4vD,WACL/wD,GAAAA,IAAMmB,KAAKwwD,mBAAAA,EAAqBxwD,KAAKmB,eAAenB,KAAKhJ,OAAO4sD,UAAAA;AAAAA,MAChE;AACD,eAAQhqD,IAAG,GAAG6M,IAAM5H,EAAIhF,QAAQD,IAAI6M,GAAK7M;AACxCoG,aAAK8wD,mBAAmBjyD,EAAIjF,CAG7B,CAAA;AAAA,UAAIoG,KAAKhJ,OAAO4sD,aAAAA,CAAc5jD,KAAKmB,aAAa;AAE/C,YAAI4vD,IAAM,CACNC,GAAAA,IAAM;AACV,aAASp3D,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC3BoG,eAAK2wD,oBAAoB9xD,EAAIjF,CAChCm3D,CAAAA,IAAAA,EAAI13D,KAAKwF,EAAIjF,CAAAA,CAAAA,IAEbo3D,EAAI33D,KAAKwF,EAAIjF,CAGf,CAAA;AAAA,YAAA,CAAIoG,KAAKO,KAAoB,eAAE;AAC9B,cAAIkS,IAAU/b,EAAU6gD,qBAAqBC,YAAYx3C,KAAKoB,KAAAA;AAC9D,gBAAM,IAAI2F,MAAM0L,CAAAA;AAAAA,QAChB;AAGDzS,aAAKixD,qBAAqBjxD,KAAKO,KAAoB,cAAE,IACrDP,KAAKmB,cAAAA,IACLnB,KAAKyM,YAAYukD,GAAKJ,CACtB5wD,GAAAA,KAAKmB,kBAGLnB,KAAKixD,qBAAqBjxD,KAAKO,KAAmB,aAAE,CAAA,GACpDP,KAAKmB,cAAAA,IACLnB,KAAKyM,YAAYskD,GAAKH,CAExB;AAAA,MAAA,OAAQ;AACN,YAAIM,IAAS5sD,SAAS0S,uBAAAA,GAClBm6C,IAAmBnxD,KAAKO,KAAmB,aAAE,CAAA;AACjDP,aAAKixD,qBAAqBC,GAC1BlxD,KAAKyM,YAAY5N,GAAK+xD,CACtBO,GAAAA,EAAiB1sD,YAAYysD,CAAAA,GAC7BlxD,KAAKixD,qBAAqBE;AAAAA,MAE1B;AAEEN,MAAAA,KACF7wD,KAAKH,UAAU,gBAAgB,CAAA,CAAA;AAAA,IAEjC,GAGAnJ,EAAU06D,kBAAkB,SAASl2D;AACpC,UAAIxC,IAAOhC,EAAU+E,cAAcP,CAAAA,EAAGxC;AAClChC,MAAAA,EAAUmJ,UAAU,mBAAmB,CAACnH,CAE5ChC,CAAAA,KAAAA,EAAU6V,eAAe7T,GAAM,KAAA;AAAA,IAChC,GAEAhC,EAAU26D,qBAAqB,SAAS50D,GAKvC;AAAA,eAJIuF,IAAShC,KAAKixD,oBACdK,IAAWtxD,KAAK2C,YAAYlG,IAGxB4L,IAAI5L,EAAG80D,OAAOlpD,IAAI5L,EAAG+0D,OAAOnpD,KAAI;AAEvCipD,QAAAA,EAASC,QAAQlpD,GACjBipD,EAASE,QAAQnpD,IAAE;AAEnB,YAAI3P,IAAOhC,EAAUgC,MACjB+4D,IAAO/6D,EAAUkK;AACrB6wD,QAAAA,IAAO/4D,EAAKC,IAAI84D,GAAMH,EAASI,QAAQ,SACvCD,IAAO/4D,EAAKC,IAAI84D,GAAMH,EAASC,OAAO;AACtC,YAAI3P,IAAQlrD,EAAUqkC,UAAU02B,GAAM/4D,EAAKC,IAAI84D,GAAM,GAAG,KAAA,CAAA,EAAQ53D,QAE5DgiD,IAAM77C,KAAK2xD,mBAAmBL,CAAAA,GAC9BM,IAAQ/V,EAAIgW,KAAKhW,EAAI75B,GAErBpG,IAAKtX,SAASC,cAAc,KAChC7N;AAAAA,QAAAA,EAAUI,MAAM8kB,GAAI,SAAS,SAAS1gB,GAAGxE;AAAAA,UAAAA,EAAU06D,gBAAgBl2D,CAAG;AAAA,QAAA,CAAA,GACtE0gB,EAAGpW,YAAY,kBACfoW,EAAGjkB,MAAMC,MAAMikD,EAAI95B,IAAI,MACvBnG,EAAGjkB,MAAME,OAAOgkD,EAAI75B,IAAI,MACxBpG,EAAGjkB,MAAM+N,QAAQksD,IAAO,MACxBh2C,EAAGpX,YAAY9N,EAAUya,UAAUg+C,kBAAkBsC,GAAM7P,CAC3D5hD,GAAAA,KAAKo8B,UAAU/iC,KAAKuiB,IAEpB5Z,EAAOyC,YAAYmX;MACnB;AAAA,IACF,GAEAllB,EAAUo6D,qBAAqB,SAASn3D,GAEvC;AAAA,UAAI8C;AADA9C,MAAAA,MAGH8C,IADE,OAAAwM,KAAc,WACXjJ,KAAKoN,QAAQzT,CAAAA,IAEbA,OAEN8C,EAAG4C,SAAS3I,EAAU4I,cAAc7C,CAAAA;AAAAA,IACrC,GACA/F,EAAUsE,YAAY,kBAAkBtE,EAAUo6D,kBAAAA,GAClDp6D,EAAUsE,YAAY,gBAAgBtE,EAAUo6D,kBAAAA,GAEhDp6D,EAAU+V,cAAc,SAAS5N,GAAK+xD,GAAAA;AACrC/xD,MAAAA,IAAMmB,KAAK8xD,mBAAmBjzD,GAAK+xD,CAEnC;AAAA,eADI7zD,IAAa,CAAA,GACRnD,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC/B,YAAIoG,KAAKmB;AACR,cAAGzK,EAAU0K,SAAS;AACrBpB,iBAAK+xD,iBAAiBlzD,EAAIjF;eACtB;AAEJ,gBAAIo4D,IAAUt7D,EAAUM,OAAOi7D;AAC5BD,YAAAA,MAAoB,IAARA,KAAanzD,EAAIjF,CAAGohC,EAAAA,UAAUg3B,IAE5ChyD,KAAK+xD,iBAAiBlzD,EAAIjF,CACNkkC,CAAAA,IAAZk0B,MAAYl0B,UAAaj/B,EAAIjF,CAAGohC,EAAAA,WAAWg3B,KAEnDt7D,EAAU26D,mBAAmBxyD,EAAIjF,CAIlC,CAAA;AAAA,UAAA;AAAA,aAIG;AACJ,cAAI6C,IAAKoC,EAAIjF,CAAAA,GACToI,IAAStL,EAAUmP,cAAcpJ,EAAG80D,KAAAA;AACxC,eAAKvvD;AAAQ;AAETjF,UAAAA,EAAWN,EAAG80D,KAAAA,MACjBx0D,EAAWN,EAAG80D,KAAS,IAAA,EACtBW,MAAMlwD,GACNkvD,QAAQ5sD,SAAS0S,uBACjBtR,GAAAA,OAAO1D,EAAOqW,YAIhB;AAAA,cAAInb,IAAYH,EAAWN,EAAG80D;AAC9BvxD,eAAKmyD,aAAa11D,GAAIS,EAAUg0D,QAAQh0D,EAAUwI,KAClD;AAAA,QAAA;AAED,eAAQ9L,KAAKmD;AAAAA,SACRG,IAAYH,EAAWnD,CAAAA,GACds4D,QAAQh1D,EAAUg0D,UAC9Bh0D,EAAUg1D,KAAKztD,YAAYvH,EAAUg0D,MAAAA;AAAAA,IAGzC,GAEAx6D,EAAU07D,0BAA0B,SAAS74D,GAAAA;AAC5C,eAASK,IAAI,GAAGA,IAAIL,EAAMM,QAAQD;AACjC,aAAKL,EAAMK,CAAG4L,EAAAA,aAAa,IAAIqB,QAAQ,kBAAA,KAAwB;AAC9D,iBAAOtN,EAAMK,CAAAA;AAIf,aAAOL,EAAM,CACd;AAAA,IAAA,GAEA7C,EAAUo7D,qBAAqB,SAASjzD,GAAK+xD,GAC5C;AAAA,UAAIyB,IAAKryD,KAAKyX,GAAG+mB,YACb8zB,IAAQtyD,KAAKi8C,OAAOE,SACpB7jC,IAAItY,KAAKi8C,OAAOE,UAAU,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAA,GAC7C71C,IAAOtG,KAAKO,KAAmB,aAAE,CAQrC;AAAA,UAFC1B,IAJImB,KAAKmB,cAIHnB,KAAKuyD,yBAAyB1zD,GAAK+xD,CAAAA,IAHnC5wD,KAAKwyD,wBAAwB3zD,GAAK+xD,IAKrC5wD,KAAKmB;AACR,YAAIyvD;AACH5wD,eAAKi8C,OAAOE,UAAUmW;AAAAA,aAClB;AACJ,cAAIG,IAAYnsD,EAAK7M,iBAAiB,oBAAA;AACtC,cAAIg5D,EAAU54D,QAAQ;AACrB,qBAASD,IAAI,GAAGA,IAAI64D,EAAU54D,QAAQD,KAAK;AAC1C0e,cAAAA,EAAE1e,CACF;AAAA,kBAAIL,IAAQk5D,EAAU74D,CAAGH,EAAAA,iBAAiB,wBACtCi5D,IAAa1yD,KAAKi8C,OAAOx2C,SAASzF,KAAKyX,GAAG2hC;AAC9C,kBAAK9gC,EAAE1e,CAAAA,IAAMy4D,IAAKK,GAAY;AAG7B,oBAAIC,IAAUD;AACkB,oBAA7B1yD,KAAKhJ,OAAOi7D,qBAAuBjyD,KAAKhJ,OAAOi7D,oBAAoB35C,EAAE1e,CAAAA,KAAMoG,KAAKhJ,OAAOi7D,mBACzFU,IAAUr6C,EAAE1e,CAAAA,IAAKy4D,KACPryD,KAAKhJ,OAAOi7D,mBAAmB,KAAKI,IAAKK,MACnDC,KAAW3yD,KAAKhJ,OAAOi7D,mBAAmB,KAAKI,IAGhDI,EAAU74D,CAAGjC,EAAAA,MAAM8N,SAAUktD,IAAU3yD,KAAKyX,GAAG2hC,oBAAqB;AAAA,cACpE;AAED9gC,cAAAA,EAAE1e,CAAM0e,KAAAA,EAAE1e,IAAI,CAAM,KAAA,KAAKlD,EAAU07D,wBAAwB74D,CAAOwgB,EAAAA;AAAAA,YAClE;AACDzB,YAAAA,EAAEs6C,QAAQ;AACV,kBAAM1W,IAAWl8C,KAAKxG,WAAW4d,cAAc,eAC/C;AAAA,gBAAI8kC,EAASniC,eAAemiC,EAAS2W,gBAAiBn8D,CAAAA,EAAUulD,OAAO6W,cAAcp8D,EAAU+gB,GAAGshB,cAAc;AAE/G,kBAAIg6B,IAAiBr8D,EAAUulD,QAC9B+W,IAAYD,EAAeA,EAAehP,aAC1CkP,IAAcF,EAAe5W,QAAQ15C,MAEtCuwD;AAAAA,cAAAA,KAAct8D,EAAU+gB,GAAGshB,gBAAgB,GAC3C/4B,KAAKiiD,kBAAkB+Q,GAAWhzD,KAAKY,WAAWZ,KAAKW,YACvDjK,EAAUulD,OAAOE,UAAU8W,GAE3BjzD,KAAKy5C,OAAOz5C,KAAKO,KAAqB,eAAE,IAAIyyD,CAC5Ct8D,GAAAA,EAAU4rD,eAAetiD,KAAKO,KAAqB,eAAE,CAAA,CAAA,GACrD7J,EAAU8tD,oBAAoBxkD,KAAKO,KAAmB,aAAE,IAAIP,KAAK8hD,oBAAAA,GAAuB9hD,KAAKY,SAE7FmyD,GAAAA,EAAeD,aAAa;AAAA,YAC5B;AAAA,UACL,WACSj0D,EAAIhF,UAAUmG,KAAKO,KAAoB,cAAE,CAAG5I,EAAAA,MAAMgmB,cAAc,cACpErF,EAAE,CAAM,IAAA,KACLzZ,EAAIhF,UAAUye,EAAE,CAAU,KAAH,IAAG;AAK7B,gBAAI46C,KAAyB56C,EAAE,CAAK,IAAA,KAAK+5C,IAAK,GAE1Cc,IAAwBD,GACxBE,IAA4BF,IAAwB;AACpDlzD,iBAAKhJ,OAAOi3D,2BAEfmF,KADAD,IAAwBrtD,KAAKE,IAAIktD,GAAuBlzD,KAAKhJ,OAAOi3D,2BAChB;AAGrD,gBAAIoF,IAAoBrzD,KAAKO,KAAoB,cAAE,CAAA;AACnD8yD,YAAAA,EAAkB17D,MAAM8N,SAAS2tD,GACjCC,EAAkB17D,MAAMgmB,aAAcrF,EAAE,CAAW,KAAJ,KAAI,WAAW,WAC9D+6C,EAAkB17D,MAAMkgB,UAAWS,EAAE,CAAA,KAAbT,KAAwB,SAAS;AAGzD,gBAAIy7C,IAAiBtzD,KAAKO,KAAoB,cAAE,CAAA;AAChD+yD,YAAAA,EAAe37D,MAAM8N,SAAS2tD,GAC9BE,EAAe37D,MAAMgmB,aAAcrF,EAAE,CAAW,KAAJ,KAAI,WAAW,WAC3Dg7C,EAAe37D,MAAMkgB,UAAWS,EAAE,CAAA,KAAbT,KAAwB,SAAS,IACtDy7C,EAAe9tD,YAAY8S,EAAE,CAAA,IAAK,uBAAuB,4BACzDtY,KAAKohD,aAAa9oC,EAAE,CAAK,IAAA,KAAK+5C,GAC3BryD,KAAKhJ,OAAOi3D,2BACdjuD,KAAKohD,YAAYt7C,KAAKE,IAAIhG,KAAKhJ,OAAOi3D,wBAAwBjuD,KAAKohD,SAAAA,IAEpE9oC,EAAE,CAAK,IAAA,GAEH66C,KAAyBD,MAE5BG,EAAkB17D,MAAM47D,YAAY,QAGpCD,EAAe37D,MAAM8J,WAAW,SAChC6xD,EAAe37D,MAAMC,MAAM,IAC3B07D,EAAe37D,MAAME,OAAO;AAAA,UAE7B;AAAA,QAEF;AAEF,aAAOgH;AAAAA,IACR,GACAnI,EAAUyoD,kBAAkB,SAAS1iD;AAGpC,UAAI+2D,IAAWxzD,KAAKtH,KAAKitB,UAAU,IAAIzsB,KAAKuD,EAAGxE,UAAAA,CAAAA;AAC/C,aAAO6N,KAAKM,OAAOotD,EAASr6D,QAAY6G,IAAAA,KAAKY,UAAUzH,QAAAA,KAAc,KACtE;AAAA,IAAA,GACAzC,EAAU+8D,6BAA6B,SAASh3D;AAC/C,UAAIvE,IAAWuE,EAAGvE;AAClB,UAAI8H,KAAKhJ,OAAO82D,uBAAuB;AACtC,YAAI4F,KAAej3D,EAAGvE,WAAWuE,EAAGxE,cAAc;AAC9Cy7D,QAAAA,IAAc1zD,KAAK2zD,yBACtBz7D,IAAW8H,KAAKtH,KAAKC,IAAIT,GAAU8H,KAAK2zD,uBAAuBD,GAAa,QAAA;AAAA,MAE7E;AACD,aAAOx7D;AAAAA,IACR,GACAxB,EAAU87D,0BAA0B,SAAS3zD,GAAK+xD,GACjD/xD;AAAAA,MAAAA,EAAIyiB,KAAK,SAASzI,GAAGC;AACpB,eAAID,EAAE5gB,WAAWkB,QAAAA,KAAa2f,EAAE7gB,WAAWkB,YACnC0f,EAAElf,KAAKmf,EAAEnf,KAAK,IAAA,KACfkf,EAAE5gB,aAAa6gB,EAAE7gB,aAAa,IAAK;AAAA,MAC5C;AACC,UAAImE,IAAO,IACPw3D,IAAgB,CAAA;AAEpB5zD,WAAK2zD,uBAAuB7tD,KAAK+D,MAAiC,KAA3B7J,KAAKyX,GAAGmhC,mBAAwB54C,KAAKhJ,OAAOkP,YAEnF;AAAA,eAAStM,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,YAAI6C,IAAKoC,EAAIjF,CAGT4oD,GAAAA,IAAK/lD,EAAGxE,YACR+pD,IAAKvlD,EAAGvE,UAER27D,IAAKrR,EAAG3hD,YACRizD,IAAK9R,EAAGnhD;AAEZ,YADApE,EAAG80D,QAAQvxD,KAAKm/C,gBAAgB1iD,CAC5BuD,GAAAA,KAAKsF,SAAS7I,EAAG80D;AAEpB1yD,UAAAA,EAAIqJ,OAAOtO,GAAE,CACbA,GAAAA;AAAAA,aAHD;AASA,cAFKwC,EAAKK,EAAG80D,KAAAA,MAAQn1D,EAAKK,EAAG80D,SAAS,CAEjCX,IAAAA,CAAAA,GAAM;AACVn0D,YAAAA,EAAGs3D,SAAAA;AAIH,qBAFIrsB,IAAQtrC,EAAKK,EAAG80D,KAAAA,GAEb7pB,EAAM7tC,UAAQ;AACpB,kBAAIm6D,IAAOtsB,EAAMA,EAAM7tC,SAAS,CAAA;AAEhC,kBADiBmG,EAAAA,KAAKyzD,2BAA2BO,CAAAA,EAClC76D,aAAasD,EAAGxE,WAAWkB;AAGzC;AAFAuuC,cAAAA,EAAMx/B,OAAOw/B,EAAM7tC,SAAS,GAAG,CAAA;AAAA,YAIhC;AAGD,qBAFIo6D,IAAavsB,EAAM7tC,QACnBq6D,IAAY,IACP3pC,IAAI,GAAGA,IAAImd,EAAM7tC,QAAQ0wB;AAGjC,kBAFIypC,IAAOtsB,EAAMnd,CAAAA,GACAvqB,KAAKyzD,2BAA2BO,CAAAA,EAClC76D,aAAasD,EAAGxE,WAAWkB,QAAW,GAAA;AACpD+6D,gBAAAA,IAAY,IACZz3D,EAAGu+B,UAAUg5B,EAAKh5B,SAClBi5B,IAAa1pC,GACb9tB,EAAGs3D,SAAS;AACZ;AAAA,cACA;AAMF,gBAHIrsB,EAAM7tC,WACT6tC,EAAMA,EAAM7tC,SAAS,CAAGk6D,EAAAA,SAAAA,MAEpBG;AACJ,kBAAIxsB,EAAM7tC;AACT,oBAAI6tC,EAAM7tC,UAAU6tC,EAAMA,EAAM7tC,SAAS,CAAGmhC,EAAAA,SAAS;AACpD,sBAAK0M,EAAMA,EAAM7tC,SAAS,CAAGmhC,EAAAA;AAG5B,yBAAKzQ,IAAI,GAAGA,IAAImd,EAAM7tC,QAAQ0wB,KAAK;AAElC,+BADI4pC,IAAAA,IACK9wD,IAAI,GAAGA,IAAIqkC,EAAM7tC,QAAQwJ;AACjC,4BAAIqkC,EAAMrkC,CAAG23B,EAAAA,WAAWzQ,GAAG;AAC1B4pC,0BAAAA,IAAa;AACb;AAAA,wBACA;AAEF,0BAAA,CAAKA,GAAY;AAChB13D,wBAAAA,EAAGu+B,UAAUzQ;AACb;AAAA,sBACA;AAAA,oBACD;AAAA;AAdD9tB,oBAAAA,EAAGu+B,UAAU;AAedv+B,kBAAAA,EAAGs3D,SAAAA;AAAAA,gBACT,OAAY;AACN,sBAAIK,IAAc1sB,EAAM,GAAG1M;AAC3B,uBAAKzQ,IAAI,GAAGA,IAAImd,EAAM7tC,QAAQ0wB;AACzBmd,oBAAAA,EAAMnd,CAAGyQ,EAAAA,UAAUo5B,MACtBA,IAAc1sB,EAAMnd,CAAAA,EAAGyQ;AAEzBv+B,kBAAAA,EAAGu+B,UAAUo5B,IAAc,GAC3B33D,EAAGs3D;gBACH;AAAA;AAGDt3D,gBAAAA,EAAGu+B,UAAU;AAGf0M,YAAAA,EAAMx/B,OAAO+rD,GAAYA,KAAcvsB,EAAM7tC,SAAS,IAAI,GAAG4C,CAEzDirC,GAAAA,EAAM7tC,UAAU6tC,EAAM2sB,aAAa,MACtC3sB,EAAM2sB,YAAY3sB,EAAM7tC,QACxB4C,EAAGw+B,SAASyM,EAAM7tC,UAElB4C,EAAGw+B,SAAUx+B,EAAS,SAAIA,EAAGw+B,SAAS;AAAA,UAEvC;AAAA,WAEG44B,IAAK7zD,KAAKhJ,OAAO8J,cAAcgzD,KAAM9zD,KAAKhJ,OAAO+J,eAGpD6yD,EAAcv6D,KAAKoD,IACnBoC,EAAIjF,CAAAA,IAAK6C,IAAKuD,KAAKs0D,YAAY73D,IAE3Bo3D,IAAK7zD,KAAKhJ,OAAO8J,eACpBrE,EAAGxE,WAAWyH,SAASM,KAAKhJ,OAAO8J,aACnCrE,EAAGxE,WAAW0H,WAAW,CAEtBm0D,IAAAA,KAAM9zD,KAAKhJ,OAAO+J,cACrBtE,EAAGvE,SAASyH,WAAW,CAAA,GACvBlD,EAAGvE,SAASwH,SAASM,KAAKhJ,OAAO+J,SAAAA,IAG9BtE,EAAGxE,aAAawE,EAAGvE,YAAY27D,KAAM7zD,KAAKhJ,OAAO+J,eACpDlC,EAAIqJ,OAAOtO,GAAG,CAAA,GACdA;AAAAA,QAhGD;AAAA,MAoGD;AACD,UAAA,CAAKg3D,GAAM;AACV,aAASh3D,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC/BiF,UAAAA,EAAIjF,CAAAA,EAAGqhC,SAAS7+B,EAAKyC,EAAIjF,CAAG23D,EAAAA,KAAAA,EAAO8C;AAEpC,aAASz6D,IAAI,GAAGA,IAAIg6D,EAAc/5D,QAAQD;AACzCg6D,UAAAA,EAAch6D,CAAAA,EAAGqhC,SAAS7+B,EAAKw3D,EAAch6D,GAAG23D,KAAO8C,EAAAA;AAAAA,MACxD;AAED,aAAOx1D;AAAAA,IACR,GACAnI,EAAU69D,cAAc,SAAS11D;AAChCA,MAAAA,EAAIyiB,KAAK,SAASzI,GAAGC,GAAAA;AACpB,eAAID,EAAE5gB,WAAWkB,QAAa2f,KAAAA,EAAE7gB,WAAWkB,QAAAA,IACtC0f,EAAExZ,UAAWyZ,CAAAA,EAAEzZ,SAAe,IAC7BwZ,CAAAA,EAAExZ,UAAUyZ,EAAEzZ,SAAAA,KACZwZ,EAAElf,KAAKmf,EAAEnf,KAAK,IAAK,KAEpBkf,EAAE5gB,aAAa6gB,EAAE7gB,aAAa,IAAK;AAAA,MAC5C,CACA;AAAA,IAAA,GAEAvB,EAAU89D,gCAAgC,SAASjsC,GAAME,GAAI3xB;AAC5D,UAAI2f,IAAOzW,KAAKqF,MAAMxL,QAClB46D,QACAC,IAAYnsC,GACZosC,IAAU,IACVC,IAAa,IAAI17D,KAAKuvB;AAK1B,WAJG/xB,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKuvB,IAAKtvB,QAAasvB,KAAAA,EAAGtvB,cACzDy7D,IAAal+D,EAAUgC,KAAKitB,UAAUivC,CAAAA,GACtCA,IAAal+D,EAAUgC,KAAKC,IAAIi8D,GAAY,GAAG,KAAA,IAE1CF,IAAYE,KAAW;AAC5BD,QAAAA;AACA,YACIE,IADY70D,KAAKgB,kBAAkB0zD,GAAAA,IAAkB59D,CACzB2f,IAAAA;AAChC,aAAIzW,KAAKsF,SAASuvD,IAAe;AAChCJ,UAAAA,IAAAA;AACA;AAAA,QACA;AACDC,QAAAA,IAAYh+D,EAAUgC,KAAKC,IAAI+7D,GAAW,GAAG,KAAA;AAAA,MAC7C;AACD,aAAOC,KAAWF;AAAAA,IACnB,GAEA/9D,EAAU67D,2BAA2B,SAAS1zD,GAAK+xD,GAAAA;AAClD5wD,WAAKu0D,YAAY11D,CAAAA;AAgBjB,eAJI5G,GAXAqxC,IAAM,CAAA,GACN0L,IAAQ,CACX,IACA,CACA,GAAA,CAAA,GACA,IACA,CACA,GAAA,CAAA,GACA,KAEGjvC,IAAM/F,KAAKi8C,OAAOE,SAElB1lC,IAAOzW,KAAKqF,MAAMxL,QAClBi7D,IAAc,CAAA,GAETl7D,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,YAAI6C,IAAKoC,EAAIjF,CAAAA,GACTD,IAAK8C,EAAG9C;AACPm7D,QAAAA,EAAYn7D,CAChBm7D,MAAAA,EAAYn7D,CAAM,IAAA,EACjBo7D,aAAa,IACbC,eAGF;AAAA,YAAIC,IAAaH,EAAYn7D,CAAAA,GACzB6oD,IAAMvqD,KAAcwE,EAAGxE,YACvB+pD,IAAKvlD,EAAGvE;AAERsqD,QAAAA,IAAKxiD,KAAKY,cACbq0D,EAAWF,cAAc,IACzBvS,IAAKxiD,KAAKY,YAEPohD,IAAKhiD,KAAKW,cACbs0D,EAAWD,iBACXhT,IAAKhiD,KAAKW;AAGX,YAAIu0D,IAAWl1D,KAAKgB,kBAAkBwhD,GAAI,IAAO/lD,CAGjD;AAAA,YAFAA,EAAG80D,QAAQ2D,IAAWz+C,IAElBzW,KAAKsF,SAAS7I,EAAG80D,KAAU90D,KAAAA,CAAAA,EAAG4C,QAAlC;AAEA,cAAI81D,IAAWn1D,KAAKgB,kBAAkBghD,GAAAA,IAAUvlD,CAAOga,KAAAA;AAQvD,cAPAha,EAAG+0D,QAAS2D,IAAW1+C,KAASA,GAChCha,EAAG24D,UAAUD,IAAWD,GAExBz4D,EAAGi1D,SAAS5rD,KAAK+D,OAAO7J,KAAK88C,eAAe0F,EAAGrpD,QAAAA,GAAW,CAAK6G,IAAAA,KAAKY,UAAUzH,QAAc,MAAA,QAAsBsd,KAE3F/f,EAAU89D,8BAA8BhS,GAAIR,GAAIvlD,CAAAA,GAEvE;AAMA,gBAEI44D,GAFA3tB,IAAQsN,EAAMv4C,EAAGi1D;AAIrB,iBAAK2D,IAAa,GAAGA,IAAa3tB,EAAM7tC,UACnC6tC,EAAAA,EAAM2tB,CAAY7D,EAAAA,SAAS/0D,EAAG80D,QADa8D;AAAAA;AAQhD,gBAJK54D,EAAGu+B,WAAY41B,MACnBn0D,EAAGu+B,UAAUq6B,IAGV54D,EAAG80D,QAAQ90D,EAAG24D,WAAW3+C;AAC5Bxe,cAAAA,IAAa,MACbqxC,EAAIjwC,KAAKoD,IACTirC,EAAM2tB,CAAAA,IAAc54D,GAEpBsJ,EAAItJ,EAAGi1D,MAAAA,IAAUhqB,EAAM7tC,SAAS,GAChC4C,EAAG64D,eAAeL,EAAWF,aAC7Bt4D,EAAG84D,cAAcN,EAAWD;AAAAA,iBAP7B;AASC,kBAAIjiD,IAAO/S,KAAKs0D,YAAY73D;AAC5BsW,cAAAA,EAAKpZ,KAAK8C,EAAG9C,IACboZ,EAAKqiD,UAAU3+C,IAAOha,EAAG80D,OACzBx+C,EAAKy+C,QAAQ/6C,GACb1D,EAAKw+C,QAAQ90D,EAAG80D,OAChBx+C,EAAK2+C,SAASj1D,EAAGi1D,QACjB3+C,EAAKioB,UAAUv+B,EAAGu+B,SAClBjoB,EAAK7a,WAAW8H,KAAKtH,KAAKC,IAAI6pD,GAAIzvC,EAAKqiD,SAAS,KAAA,GAChDriD,EAAKuiD,eAAeL,EAAWF,aAC3BE,EAAWF,gBACdE,EAAWF,cAAAA,KAGZzrB,EAAIjwC,KAAK0Z,CACT20B,GAAAA,EAAM2tB,CAActiD,IAAAA,GACpB9a,IAAa8a,EAAK7a,UAElB6N,EAAItJ,EAAGi1D,MAAAA,IAAUhqB,EAAM7tC,SAAS,GAChCD;AAAAA,YAEA;AAAA,UA5CA;AAFA3B,YAAAA,IAAa;AAAA,QAXqC;AAAA,MA0DnD;AACD,aAAOqxC;AAAAA,IACR,GACA5yC,EAAU8+D,cAAc,WAAA;AACvB,UAAI38C,IAAI,IAAI3f,KAAK8G,KAAK/H,UAClB6gB,GAAAA,IAAI,IAAI5f,KAAK8G,KAAK9H;AACtB8H,WAAK/H,aAAa4gB,GAClB7Y,KAAK9H,WAAW4gB;AAAAA,IACjB,GACApiB,EAAU49D,cAAc,SAAS73D,GAEhC;AAAA,aADAuD,KAAKw1D,YAAYjhD,YAAY9X,GACtB,IAAIuD,KAAKw1D;AAAAA,IAEjB,GACA9+D,EAAU0lC,YAAY,IACtB1lC,EAAUk5D,aAAa;AACtB,eAASh2D,IAAI,GAAGA,IAAIoG,KAAKo8B,UAAUviC,QAAQD,KAAK;AAC/C,YAAIR,IAAM4G,KAAKo8B,UAAUxiC,CAAAA;AACrBR,QAAAA,EAAI6I,cAAY7I,EAAI6I,WAAWC,YAAY9I,CAC/C;AAAA,MAAA;AACD4G,WAAKo8B,YAAY,CAAA;AAAA,IAClB,GACA1lC,EAAUiW,cAAc,SAAShT,GAAAA;AAChC,UAAI8C,IAAKuD,KAAK7E,SAASxB,CAAAA;AACvBqG,WAAKmwD,YAAYx2D,CAAAA,GAEb8C,KAAMuD,KAAKkwD,kBAAkBzzD,MAAOuD,KAAK0wD,aAAa/2D,GAAI8C,CAAQuD,MAAAA,KAAKmB,eAAenB,KAAKhJ,OAAO4sD,aAAannD,EAAG4C,YACjHW,KAAKhJ,OAAOsoD,gBACft/C,KAAK0M,qBAEF1M,KAAK1E,WAAWL,QAAQ,WAAY+E,KAAK1E,WAAWw/B,WAAY96B,KAAKV,cAAc7C,CAAAA,IAGrFuD,KAAK0M,iBAAiB,CAACjQ,CAAK,GAAA,EAAA,IAF5BuD,KAAK0M,iBAMT;AAAA,IAAA,GACAhW,EAAUy5D,cAAc,SAASx2D,GAChCqG;AAAAA,WAAKm8B,aAAaxiC,GAAI,SAASqjB,GAAMpjB,GAAAA;AAChCojB,QAAAA,EAAK/a,cACR+a,EAAK/a,WAAWC,YAAY8a,CAAAA,GAC7BtmB,EAAU0lC,UAAUl0B,OAAOtO,GAAG;MAChC,CACA;AAAA,IAAA,GACAlD,EAAU++D,eAAe,SAAS/8D;AACjC,UAAIg9D,IAAuB,KAAlBh9D,EAAKmI,SAAkBnI,IAAAA,EAAKyJ;AACrC,aAAS2D,KAAKM,OAAY,KAALsvD,IAAU,MAAgC,KAAzB11D,KAAKhJ,OAAO8J,aAAkB,KAAK,OAAQd,KAAKhJ,OAAOkP,eAAgB,SAAgD,KAA3BlG,KAAKhJ,OAAOkP;AAAAA,IAC/I,GACAxP,EAAUi/D,gBAAgB,SAASl5D,GAAIm5D;AACtCA,MAAAA,IAAaA,KAAc;AAC3B,UAAIF,IAAgC,KAA3Bj5D,EAAGxE,WAAW4I,SAAkBpE,IAAAA,EAAGxE,WAAWkK,WAAAA,GACnD0zD,IAA+B,KAAzBp5D,EAAGvE,SAAS2I,SAAkBpE,IAAAA,EAAGvE,SAASiK,WAA+C,KAAA,KAA7BzL,EAAUM,OAAO+J;AAIvF,aAAO,EACNnJ,KAJSoI,KAAKy1D,aAAah5D,EAAGxE,UAAAA,GAK9BwN,QAHYK,KAAKC,IAAI6vD,IAAaC,IAAKH,KAAM11D,KAAKhJ,OAAOkP,eAAe,EAAA,EAAA;AAAA,IAK1E,GACAxP,EAAUy7D,eAAe,SAAS11D,GAAIy0D,GAAQ4E,GAC7C;AAAA,UAAIC,IAAOr/D,EAAU+gB,GAAGuhC,YACpBgd,IAAeh2D,KAAKhJ,OAA4B,wBAAI,IAAI++D;AAC5D,UAAA,EAAIt5D,EAAG80D,QAAQ,IAAf;AAEA,YAAIvvD,IAAStL,EAAUmP,cAAcpJ,EAAG80D,KAAAA;AACxC,YAAKvvD,GAAL;AAEAkvD,UAAAA,IAASA,KAAUlvD;AAEnB,cAAIi0D,IAAQj2D,KAAK21D,cAAcl5D,GAAI/F,EAAU+gB,GAAGmhC,mBAC5ChhD,IAAMq+D,EAAMr+D,KACf6N,IAASwwD,EAAMxwD,QAEZywD,IAAWz5D,EAAGw+B,UAAU,GACxBk7B,IAAY15D,EAAGu+B,WAAW;AAE9B86B,UAAAA,IAAcA,KAAe9zD,EAAOqW,aACjCrY,KAAKhJ,OAAO02D,uBACdoI,KAAe91D,KAAKhJ,OAAO02D;AAG5B,cAAIhoD,IAAQI,KAAK+D,OAAOisD,IAAcE,KAAeE,IACjDr+D,IAAOs+D,IAAYzwD,IAAQ;AAE/B,cADKjJ,EAAGs3D,WAAQruD,KAAiBwwD,IAAWC,IACxCn2D,KAAKhJ,OAAOuE,uBAAuB;AACtC,kBAAM8X,IAAQrT,KAAKhJ,OAAO+2D,qBACpBqI,IAASp2D,KAAKhJ,OAAOg3D;AAC3B,gBAAIvwC,GACA44C,KAAeH,IAAWC,IAAY,KAAK9iD,IAAQ+iD,GACnDt+D,IAAaq+D,IAAY9iD,IAAQ+iD;AACjCF,YAAAA,IAAWE,IAASN,IAAc91D,KAAKhJ,OAAO02D,qBACjDjwC,IAAShhB,EAAS,SAAI45D,IAAc,IAAG,KAEvC54C,IAAShhB,EAAS,SAAI45D,IAAc,IAAG,GACvCx+D,IAAOC,IAAa,GAChBo+D,IAAWE,IAAS,IAAIN,IAAc91D,KAAKhJ,OAAO02D,uBACrDjwC,IAAShhB,EAAS,SAAI45D,IAAchjD,IAAO,GAC3Cxb,IAAOC,IAAaub,KAGtB3N,IAAQI,KAAK+D,MAAMisD,IAAcE,IAAcn+D,IAAO4lB,CACtD;AAAA,UAAA;AAGAhhB,UAAAA,EAAG2E,QADDqE,IAAS,KACA,aACHA,IAAS,KACN,UAEA;AAGZ,cAAI4C,IAAIrI,KAAKs2D,cAAc75D,GAAIu5D,IAAcn+D,GAAMD,GAAK8N,GAAOD,GAAQhJ,EAAG85D,aAAa7/D,EAAUya,UAAUqiB,aAAa/2B,EAAGxE,YAAYwE,EAAGvE,UAAUuE,IAAK/F,EAAUya,UAAU02C,WAAWprD,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAgBpN,CAAA;AAAA,cAdGA,EAAG2E,UAAU,aACfiH,EAAEkN,UAAU5c,IAAI,uBACM,IAAb8D,EAAG2E,UAAU,WACtBiH,EAAEkN,UAAU5c,IAAI,yBAGjBqH,KAAKuxB,SAASo2B,UAAUlrD,GAAI4L,CAAAA,GAC5BrI,KAAKo8B,UAAU/iC,KAAKgP,CAAAA,GACpB6oD,EAAOzsD,YAAY4D,CAAAA,GAInBxQ,IAAOA,IAFcynB,SAAUtf,KAAKhJ,OAAOsgC,MAAMt1B,EAAOrK,MAAM8lB,QAAQzb,EAAOrK,MAAME,MAAM,EAAA,IAE1Dm+D,GAE3Bh2D,KAAKy6C,YAAYh+C,EAAG9C,IAAI;AAE3B0O,YAAAA,EAAE1Q,MAAM6+D,SAAS,GACjB9wD,IAAQI,KAAKC,IAAIL,GAAOhP,EAAU+gB,GAAG0hC,gBACrC9wC,IAAI/D,SAASC,cAAc,KAAA,GACzBkR,aAAa,YAAYhZ,EAAG9C,EAC9B0O,GAAAA,EAAEoN,aAAazV,KAAKhJ,OAAO0C,iBAAiB+C,EAAG9C,EAAAA,GAE/CqG,KAAKuxB,SAASo2B,UAAUlrD,GAAI4L,IAE5BA,EAAE7C,YAAY,gCACVxF,KAAKhJ,OAAOsgC,OAAKz/B,KACrBmI,KAAKy5C,OAAOpxC,GAAG3C,GAAOD,GAAQ5N,GAAMD,CAAAA,GAGjC6E,EAAGg6D,SACLpuD,EAAE1Q,MAAM+9C,YAAY,oCAAoCj5C,EAAGg6D,KAAAA;AAE5D,gBAAIC,IAAWhgE,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAExEi6D;AAAAA,YAAAA,MACFruD,EAAE7C,aAAa,MAAMkxD;AAEtB,gBAAI9H,IAAKtqD,SAASC,cAAc,KAChCqqD;AAAAA,YAAAA,EAAGj3D,MAAMgzC,WAAW,+BAEpBtiC,EAAE5D,YAAYmqD,CACd5uD,GAAAA,KAAKO,KAAmB,aAAE,CAAA,EAAGkE,YAAY4D,CACzCrI,GAAAA,KAAKo8B,UAAU/iC,KAAKgP,CAAAA,GAEpBumD,EAAGpqD,YAAY,sCAAsC/H,EAAGyW,OAAO,eAC/DlT,KAAK22D,UAAU/H,EAAGx3C,cAAc,aAEhC1gB,EAAUI,MAAMkJ,KAAK22D,SAAS,WAAW,SAASz7D;AACjD,kBAAIA,EAAE46B;AAAU,uBAAO;AACvB,kBAAIvjB,IAAOrX,EAAE26B;AACTtjB,cAAAA,KAAQ7b,EAAUq/B,KAAKC,aAAWt/B,EAAUywC,SAAAA,KAC5C50B,KAAQ7b,EAAUq/B,KAAKE,eAAav/B,EAAUywC,SAAS,EAAA,GAExD50B,KAAQ7b,EAAUq/B,KAAKC,aAAazjB,KAAQ7b,EAAUq/B,KAAKE,eAC1D/6B,EAAE28B,kBAAgB38B,EAAE28B,eAE3B;AAAA,YAAA,CAAA,GACEnhC,EAAUI,MAAMkJ,KAAK22D,SAAS,eAAe,SAAUz7D,GAEtD;AAAA,qBADAA,EAAEigC,eAAe,IAAA;AAAA,YAEpB,CAAA,GACEzkC,EAAUw5B,OAAOlwB,KAAK22D,SAAS,EAAA,GAE/B32D,KAAKO,KAAmB,aAAE,GAAG8f,aAAa;AAAA,UAC1C;AACD,cAAIrgB,KAAKyX,GAAGuhC,eAAe,KAAKh5C,KAAKq6C,cAAc59C,EAAG9C,IAAI;AAErDqG,iBAAKhJ,OAAOuE,yBAAyByE,KAAKP,eAC7C4I,EAAE1Q,MAAM6+D,SAAS;AAMlB,qBAFII,GAHAC,IAAQ72D,KAAKhJ,OAAO,YAAagJ,KAAKy6C,YAAYh+C,EAAG9C,KAAM,SAAS,SAAA,GACpEm9D,IAAY,IAIPl9D,IAAI,GAAGA,IAAIi9D,EAAMh9D,QAAQD,KAAK;AACtC,oBAAMm9D,IAAcF,EAAMj9D,CAAAA;AAC1Bg9D,cAAAA,IAAW52D,KAAKuxB,SAASy4B,oBAAoB+M,CAC7CD,GAAAA,KAAa,6BAA6BC,CAAAA,YAAuB/2D,KAAKokB,OAAOwN,OAAOmlC,CAAiBH,CAAAA,KAAAA,CAAAA;AAAAA,YACrG;AACD,gBAAIx9D,IAAM4G,KAAKs2D,cAAc75D,GAAI5E,IAAOk+D,IAAO,GAAGn+D,GAAKm+D,GAAM,MAAM,IAAI,qCAAqCe,GAAW,EAAA;AAEpHr6D,YAAAA,EAAGg6D,SACLr9D,EAAIzB,MAAM+9C,YAAY,oCAAoCj5C,EAAGg6D,KAE3Dh6D,GAAAA,EAAGu6D,aACL59D,EAAIzB,MAAM+9C,YAAY,+BAA+Bj5C,EAAGu6D,SAIzDh3D,GAAAA,KAAKO,KAAmB,aAAE,GAAGkE,YAAYrL,CAAAA,GACzC4G,KAAKo8B,UAAU/iC,KAAKD;UACpB;AACE4G,eAAKhJ,OAAOC,kBAAkB+I,KAAKR,YAAY/C,EAAG9C,MACpDqG,KAAKi3D,uBAAuBx6D,CA7IT;AAAA,QAAA;AAAA,MAHK;AAAA,IAkJ1B,GACA/F,EAAU4/D,gBAAgB,SAAU75D,GAAIulB,GAAGD,GAAG7J,GAAGI,GAAG3gB,GAAOu/D,GAAUC,GAAUr1C;AAC9E,UAAIzZ,IAAI/D,SAASC,cAAc,KAC3B5K,GAAAA,IAAK8C,EAAG9C,IACRy3C,IAAK/oC,IAAW,sCAAsC,iBAEtDm+B,IAAQ9vC,EAAU4E,SAAAA;AACnBkrC,MAAAA,EAAM1L,WAAWr+B,EAAG9C,OACtBy3C,KAAM,wBAGJ5K,EAAMkU,aAAaj+C,EAAG9C,OACxBy3C,KAAM;AAGP,UAAIgmB,IAAM1gE,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAClE26D;AAAAA,MAAAA,MAAKhmB,IAAKA,IAAK,MAAMgmB,IAEtBp3D,KAAKhJ,OAAOuE,0BACd61C,KAAM;AAGP,UAAIimB,IAAWn/C,IAAI,GACf9f,IAAO,kBAAkBuB,CAAAA,KAAOqG,KAAKhJ,OAAO0C,eAAoBC,KAAAA,CAAAA,YAAcy3C;oCAC/CrvB,CAAU/hB,OAAAA,KAAKhJ,OAAU,MAAI,WAAS,UAAWgrB,CAAcq1C,aAAAA,CAAAA,cAAsB/+C,CAAS3gB,OAAAA,KAAS,EACrH8E;AAAAA,sBAAAA,EAAGxE,WAAWkB,QAA4BsD,CAAAA,mBAAAA,EAAGvE,SAASiB,QAG3EkP,CAAAA;AAAAA;AAAAA,MAAAA,EAAE7D,YAAYpM;AAEd,UAAI8E,IAAYmL,EAAEvO,UAAU,EAAA,EAAM6M;AAElC,UAAKmb,CAAAA,KAAUprB,EAAU4gE,YAAYp6D,GAAWT,GAAIyb,GAAGI,GAAG4+C,GAAUC,CAAAA;AAQnE,eAPG16D,EAAGg6D,SACLv5D,EAAUvF,MAAM+9C,YAAY,oCAAoCj5C,EAAGg6D,QAEjEh6D,EAAGu6D,aACL95D,EAAUvF,MAAM+9C,YAAY,+BAA+Bj5C,EAAGu6D,SAGxD95D,GAAAA;AAEPA,MAAAA,IAAYmL,EAAE1B,YACXlK,EAAGg6D,SACLv5D,EAAUvF,MAAM+9C,YAAY,oCAAoCj5C,EAAGg6D,QAEjEh6D,EAAGu6D,aACL95D,EAAUvF,MAAM+9C,YAAY,+BAA+Bj5C,EAAGu6D,SAAAA;AAG/D,UAAIO,IAAa;AACjBA,MAAAA,KAAc,2CAA2CL,IAAW,UACpEK,KAAc,2BAA2BJ,IAAW;AAEpD,UAAIK,IAAe;AASpB,cARK11C,KAAUrlB,EAAGg7D,iBAAiB,QACjCD,IAAe,uBAAuBA,IAEvCD,KAAc,iBAAiBC,IAAe,sBAAsB11C,IAAS,sBAAsB,MAAM,aAEzG5kB,EAAUsH,YAAY+yD,GAGhBr6D;AAAAA,IACR,GACAxG,EAAU4gE,cAAc,WAAA;AACvB,aAAO;AAAA,IACR,GACA5gE,EAAUmP,gBAAgB,SAASlB,GAAAA;AAClC,aAAI3E,KAAKoB,SAAS,QAAcpB,KAAKO,KAAmB,aAAE,CAAA,EAAGoG,aACtD3G,KAAKO,KAAmB,aAAE,CAAA,EAAGmG,WAAW/B,CAChD;AAAA,IAAA,GACAjO,EAAUsK,oBAAoB,SAAStI,GAAMg/D,GAAAA;AAC5C,UAAI/yD,IAAMmB,KAAK+D,OAAO7J,KAAK88C,eAAepkD,GAAM,CAAA,IAAKsH,KAAKY,aAAS,KAAA;AAGnE,aADI82D,KAAQ13D,KAAKtH,KAAKysB,UAAUzsB,CAAOiM,KAAAA,KAChCA;AAAAA,IACR,GAIAjO,EAAUihE,iBAAiB,SAAShyD,GAAOiyD,GAAWC,GAAAA;AACrD,UAAI73D,CAAAA,KAAKs7C;AACR,eAAO31C;AACJ3F,WAAKs7C,YAAYwc,eAGpBnyD,IAAQ3F,KAAKs7C,YAAYwc,eAFzB93D,KAAKs7C,YAAYwc,eAAenyD;AAKjC,eADIoyD,IAAQH,IAAYjyD,GACjBoyD,IAAQH,IAAaC;AAC3BlyD,QAAAA,KACAoyD,KAASH;AAGV,aADQ9xD,KAAKC,IAAIJ,GAAO;IAEzB,GAEAjP,EAAUi7D,qBAAqB,SAASl1D,GAAAA;AACvC,UAAI66B,IAAMt3B,KAAKhJ,OAAOsgC,KAClB0gC,IAAUh4D,KAAKi8C,QACfj6B,IAAIg2C,EAAQv7D,EAAG80D,KACfM,GAAAA,IAAKmG,EAAQv7D,EAAG+0D,KAChBl6B;AAAAA,MAAAA,MACHtV,IAAIg2C,EAAQA,EAAQjU,cAAciU,EAAQv7D,EAAG+0D,SAASwG,EAAQ,CAAA,GAC9DnG,IAAKmG,EAAQA,EAAQjU,UAAAA,IAAciU,EAAQv7D,EAAG80D,KAAAA,IAASyG,EAAQ,CAG5DnG,IAAAA,KAAM7vC,MAAG6vC,IAAKmG,EAAQv7D,EAAG+0D,QAAQ,CACrC;AAAA,UAAIa,IAAKryD,KAAKyX,GAAG+mB,YAEb74B,IAAQlJ,EAAGu+B;AACf,UAAGv+B,EAAG9C,MAAMqG,KAAKR,UAAS;AACzB,YAAIkzD,IAAasF,EAAQ7b,QAAQ1/C,EAAGi1D,SAAS,KAAKsG,EAAQ7b,QAAQ1/C,EAAGi1D,MAAAA,IAAS1xD,KAAKyX,GAAG2hC;AACtFzzC,QAAAA,IAAQjP,EAAUihE,eAAehyD,GAAO0sD,GAAIK;MAC5C;AACD,UAAIuF,IAAkBtyD,IAAQ0sD;AAE9B,aAAO,EAACrwC,GAAEA,GAAG6vC,IAAGA,GAAI9vC,GADZi2C,EAAQ7b,QAAQ1/C,EAAGi1D,MAAWsG,KAAAA,EAAQvyD,SAAUzF,KAAKyX,GAAGshC,qBAAqB,IAAK,KAAMkf,EAEjG;AAAA,IAAA,GAEAvhE,EAAUq7D,mBAAmB,SAAUt1D;AACtC,UAAIuF,IAAShC,KAAKixD,oBACdpV,IAAM77C,KAAK2xD,mBAAmBl1D,CAAAA,GAC9BslB,IAAI85B,EAAI95B,GACRC,IAAI65B,EAAI75B,GACR6vC,IAAKhW,EAAIgW,IAETqG,IAAgB;AAIpB,UAAKrG,GAAL;AAEA,YAAIsG,IAAYzhE,EAAUM,OAAO42D,uBAAuB5tD,KAAKoB,SAAS,YACnE3E,CAAAA,EAAG4C,UAAU3I,EAAUM,OAAO62D,qBAE7BxlD,IAAI/D,SAASC,cAAc,KAAA,GAC3B6zD,IAAc37D,EAAGwG,eAAe,cAAmBxG,KAAAA,EAAG64D,cACzD+C,IAAe57D,EAAGwG,eAAe,aAAkBxG,KAAAA,EAAG84D,aAEnD+C,IAAcH,MAAc17D,EAAG4C,UAAU+4D,IACzCG,IAAeJ,MAAc17D,EAAG4C,UAAUg5D,IAE1CG,IAAQ,IACRpnB,IAAK;AACJ30C,QAAAA,EAAG4C,UAAAA,CAAU84D,MACjBK,IAAQ,IACRpnB,IAAK,uBAEHgnB,MACFhnB,KAAM,8BAEJinB,MACFjnB,KAAM,4BAEJknB,MACFJ,KAAiB,gEAEfK,MACFL,KAAiB;AAGlB,YAAId,IAAM1gE,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE;AAClE26D,QAAAA,MACHhmB,KAAM,MAAMgmB;AAGb,YAAIqB,IAAYh8D,EAAGg6D,QAAS,sCAAsCh6D,EAAGg6D,QAAQ,MAAO,IAChFA,IAASh6D,EAAGu6D,YAAa,iCAAiCv6D,EAAGu6D,YAAY,MAAO,IAEhF0B,IAAa,CAChB,qBACA,SAAS32C,IAAI,MACb,UAAUC,IAAI,MACd,YAAY6vC,IAAK7vC,KAAKw2C,IAAQ,IAAI,MAAM,MACxC,aAAax4D,KAAKyX,GAAG+mB,aAAa,KAAK,MACvCi4B,GACAgC,GACCh8D,EAAG85D,eAAe,EAAA,EAClBpyD,KAAK,GAAA,GAEH/L,IAAO,oBAAoBqE,EAAG9C,KAAK,OAAOqG,KAAKhJ,OAAO0C,kBAAkB,OAAO+C,EAAG9C,KAAK,cAAay3C,IAAK,cAAYsnB,IAAW,MAAI14D,KAAKuxB,SAAS42B,mBAAmB1rD,KAAI;AACzK07D,QAAAA,MACH//D,KAAQ8/D,IAGNxhE,EAAU4E,WAAWL,QAAQ,WAAYwB,EAAGk8D,4BAC9Cl8D,IAAK/F,EAAUyE,SAASsB,EAAG9C,EAAAA,IAGxB8C,EAAG4C,WACNjH,KAAQ,0CAA0C1B,EAAUya,UAAU+9C,eAAezyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAGlHrE,CAAAA,YAAAA,KAAQ,4CACRA,KAAQ1B,EAAUya,UAAUuiB,eAAej3B,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAAA,IAAM,UAC7ErE,KAAQ,UACRA,KAAQ,UAERiQ,EAAE7D,YAAYpM,GAEd4H,KAAKo8B,UAAU/iC,KAAKgP,EAAE1B,aACtB3E,EAAOyC,YAAY4D,EAAE1B,UAAAA;AAAAA,MAvEL;AAAA,IAwEjB,GAEAjQ,EAAUolC,gBAAgB,SAAS9e;AAElC,eADIrjB,IAAK,MACFqjB,KAAAA,CAASrjB,KAAMqjB,EAAKniB;AAC1BlB,QAAAA,IAAKqjB,EAAKniB,aAAamF,KAAKhJ,OAAO0C,eACnCsjB,GAAAA,IAAOA,EAAK/a;AAEb,aAAOtI;AAAAA,IACR,GAEAjD,EAAUukD,OAAO,SAASthD,GACrBqG;AAAAA,WAAKy6C,YAAY9gD,MACrBqG,KAAKmnC,aAAgBxtC,CAAAA,GACrBqG,KAAKy6C,WAAW9gD,GAChBqG,KAAK2M,YAAYhT,CAClB;AAAA,IAAA,GACAjD,EAAUywC,WAAW,SAASlsC,GAAMtB,GACnC;AAAA,UAAA,CAAIA,KAAMqG,KAAKy6C,YAAY9gD,GAA3B;AACA,YAAI8C,IAAKuD,KAAK7E,SAAS6E,KAAKy6C;AACxBh+C,QAAAA,MACCxB,MAAMwB,EAAGyW,OAAOlT,KAAK22D,QAAQznD,QACjClP,KAAKy6C,WAAW,MAChBz6C,KAAK22D,UAAU,MACf32D,KAAK2M,YAAYlQ,EAAG9C,EAAAA,GACpBqG,KAAKi0B,iBAAiBx3B,GAAIxB,CAPW;AAAA,MAAA;AAAA,IASvC,GACAvE,EAAUu9B,mBAAmB,SAASx3B,GAAIxB,GAAAA;AACrC+E,WAAKmS,cACHlX,IAIJ+E,KAAKH,UAAU,gBAAgB,CAACpD,EAAG9C,IAAI8C,CAAAA,CAAAA,IAHnCA,KACHuD,KAAKiS,YAAYxV,EAAG9C,IAAAA,EAItBqG,GAAAA,KAAKmS,aAAa,QAEdlX,KACH+E,KAAKH,UAAU,kBAAkB,CAACpD,EAAG9C,IAAI8C,CAG5C,CAAA;AAAA,IAAA,GAEA/F,EAAUqkC,YAAY,SAASxS,GAAME,GAAAA;AACpC,UAAI1Z,IAAS,CAAA;AACb,eAAS8J,KAAK7Y,KAAKoN,SAAS;AAC3B,YAAI3Q,IAAKuD,KAAKoN,QAAQyL;AAClBpc,QAAAA,MAAU8rB,CAAAA,KAAAA,CAASE,KAAQhsB,EAAGxE,aAAawwB,KAAMhsB,EAAGvE,WAAWqwB,MAClExZ,EAAO1V,KAAKoD,CAAAA;AAAAA,MACb;AACD,aAAOsS;AAAAA,IACR,GACArY,EAAUkiE,mBAAmB,SAASj/D,GAAAA;AACrC,UAAKA,GAAL;AAGA,iBADIk/D,IAAkBniE,EAAU0lC,WACvBxiC,IAAE,GAAGA,IAAEi/D,EAAgBh/D,QAAQD,KAAK;AAC5C,cAAIk/D,IAAiBD,EAAgBj/D;AACrC,cAAIk/D,EAAej+D,aAAanE,EAAUM,OAAO0C,eAAoBC,KAAAA;AACpE,mBAAOm/D;AAAAA,QAER;AACD,eAAO;AAAA,MARC;AAAA,IAST,GACApiE,EAAUqiE,YAAY,SAASp/D,GAAIsB;AAE/BtB,MAAAA,KAAoB,OAAPA,KAAO,aACtBsB,IAAOtB,EAAGsB,MACVS,IAAU/B,EAAG+B,SACb/B,IAAKA,EAAG+B;AAET,UAAIe,IAAmB,OAAN9C,KAAM,YAAmBA,OAAAA,KAAM,WAAYjD,EAAUyE,SAASxB,CAAAA,IAAMA;AAGrF,UAFAsB,IAAOA,KAAMvE,EAAU0K,OAElB3E,MAAAA,CAAOuD,KAAKJ,WAAW,sBAAA,KAA4BI,KAAKH,UAAU,wBAAwB,CAACpD,GAAIxB,CAAAA,CAAAA,IAApG;AAGA,YAAImpD,IAAc1tD,EAAUM,OAAOotD;AACnC1tD,QAAAA,EAAUM,OAAOotD,cAAc3nD,EAAGxE,WAAW4I,SAC7C;AAAA,YAAIsgD,IAAkBzqD,EAAUM,OAAOmqD;AACvCzqD,QAAAA,EAAUM,OAAOmqD,kBAAAA;AAEjB,YAAI6X,IAAiBv8D,EAAGg6D,OACpBwC,IAAsBx8D,EAAGu6D;AAgB7B,YAfItgE,EAAUM,OAAOq3D,8BACpB5xD,EAAGg6D,QAAQ//D,EAAUM,OAAOonC,uBAC5B3hC,EAAGu6D,YAAYtgE,EAAUM,OAAOqnC,6BAGjC3nC,EAAU6V,eAAe,IAAIrT,KAAKuD,EAAGxE,UAAagD,GAAAA,CAAAA,GAOlDvE,EAAUM,OAAOotD,cAAcA,GAC/B1tD,EAAUM,OAAOmqD,kBAAkBA,GAE/BzqD,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CAAAA,GAAO;AAC/C,cAAI2/B,IAAWlkC,EAAUY,QAAAA,GACrB6F,IAAWy9B,EAAS3gC,YAEpBnD,IAAQJ,EAAUyE,SAASsB,EAAG9C,EAAAA;AAElC,cAAG7C,GAAM;AACR,gBAAI4E,CAAAA,GAAQ;AACX,kBAAIA,IAAU5E,EAAMqG,CAAAA;AACjBoF,oBAAM6R,QAAQ1Y,CAAAA,IAChBA,IAAUA,EAAQ,CAAA,IACHA,OAAAA,KAAY,YAAYhF,EAAUM,OAAOsD,qBAAqBoB,EAAQmL,QAAQnQ,EAAUM,OAAOsD,iBAAAA,IAAAA,OAC9GoB,IAAUA,EAAQrB,MAAM3D,EAAUM,OAAOsD,iBAAAA,EAAmB;YAE7D;AACD,gBAAI1C,IAAMgjC,EAASs+B,cAAcx9D,IAC7B7D,IAAO+iC,EAASu+B,YAAYriE,EAAMmB,UAClCiF,GAAAA,IAAYxG,EAAU8C,WAAW4d,cAAc;AAInD,gBAHAvf,MAAeqF,EAAU+c,cAAc2gB,EAASiC,MAAM,GACtDjlC,IAAMA,IAAMsF,EAAU6c,eAAe,IAAI6gB,EAASpO,KAAG,GAEjDoO,EAASw+B,uBACZ;AAAA,kBAAIr+C,IAAY6f,EAAS5/B,YAAY,YAAY;AAChDq+D,gBAAAA,EACAz+B,GAAAA,EAASrf,YAAYR,CAC1B;AAAA,cAAA,CAAA;AAGG6f,YAAAA,EAAS0+B,SAAS,EACjBzhE,MAAMA,GACND,KAAKA,EAAAA,CAAAA,GAEDgjC,EAASw+B,uBACbC,KAAAA,EAAAA;AAAAA,UAED;AAAA,QACH;AACEA,UAAAA,EAAAA;AAGD3iE,QAAAA,EAAUmJ,UAAU,uBAAuB,CAACpD,GAAIxB,CAAAA,CAAAA;AAAAA,MAhExC;AAgBR,eAASo+D,IAAAA;AACR58D,QAAAA,EAAGg6D,QAAQuC,GACXv8D,EAAGu6D,YAAYiC;AAAAA,MACf;AAAA,IA8CF;AAAA,EAGA,EVxsCOviE,IWvFQ,SAAgBA,GAAAA;AAG/BA,IAAAA,EAAU6iE,sBAAsB,SAASC;AACxC,UAAGA,CAAAA,EAAEv3D,YAAL;AACA,YAEIw3D,IAFO/iE,EAAU6J,KAAmB,aAAE,GAEzBm5D,WACbl0D,IAAY9O,EAAUkQ,cAAc6yD,CAAAA;AACrCj0D,QAAAA,EAAUqB,QAAQ,kBAAsB,IAAA,KAAK4yD,EAAM3nC,oBACrD2nC,IAAQA,EAAM3nC,kBAGftsB,IAAY9O,EAAUkQ,cAAc6yD,CAAAA,GAChCA,KAASj0D,EAAUqB,QAAQ,wBAAwB,KACtD4yD,EAAMh1D,YAAY+0D;MAXK;AAAA,IAazB,GAEA9iE,EAAUijE,0BAA0B,SAASH,GAAG1iE,GAAAA;AAC/C,UAAI0K,IAAO9K,EAAUi/D,cAAc7+D,GAAO;AAC1C0iE,MAAAA,EAAE7hE,MAAMC,MAAM4J,EAAK5J,MAAM,MACzB4hE,EAAE7hE,MAAM8N,SAASjE,EAAKiE,SAAS;AAAA,IAChC,GAEA/O,EAAUugE,yBAAyB,SAASngE,GAC3C;AAAA,UAAI0iE,IAAIl1D,SAASC,cAAc,KAAA;AAE/Bi1D,MAAAA,EAAE/jD,aAAa,YAAY3e,EAAM6C,EACjC6/D,GAAAA,EAAE/jD,aAAazV,KAAKhJ,OAAO0C,iBAAiB5C,EAAM6C,EAClDqG,GAAAA,KAAKo8B,UAAU/iC,KAAKmgE,CAAAA,GACpBx5D,KAAK25D,wBAAwBH,GAAG1iE;AAEhC,UAAIqB,IAAM6H,KAAKmR,UAAUi+C,kBAAkBt4D,EAAMmB,YAAYnB,EAAMoB,UAAUpB,IACzEsB,IAAO4H,KAAKmR,UAAUk+C,oBAAoBv4D,EAAMmB,YAAYnB,EAAMoB,UAAUpB,CAAAA;AAChF0iE,MAAAA,EAAEh0D,YAAY,mBACXrN,MACFqhE,EAAEh0D,aAAa,MAAMrN,IACnBC,MACFohE,EAAEh1D,YAAYpM,IACf4H,KAAKu5D,oBAAoBC,CAC1B;AAAA,IAAA;AAAA,EAEA,EX6CiB9iE,CAAAA,GAChBga,GAAKha,CACLm4B,GAAAA,GAASn4B,CACTiiC,GAAAA,GAAMjiC,CY3FQ,GAAA,SAAgBA;AAE/BA,IAAAA,EAAUkjE,cAAc;AACvB,aAAO,EACNx8D,MAAM,EACLkP,QAAQ,WACP;AAAA,eAAO,EACNm8B,KAAK,OACLlsC,MAAM,GACNiuB,OAAO,EACN7yB,OAAO,6BAERkiE,OAAO,EACNC,WAAa,WAAA;AACZpjE,UAAAA,EAAU6V,eAAAA;AAAAA,QACV,KAEFkB,MAAM,CACL,EACCmO,IAAI5b,KAAK4b,IACTrf,MAAM,EAAA,CAAA,EAAA;AAAA,MAIT,GACDooB,MAAM,WACL;AAAA,YAAIznB,IAAYoH,SAASC,cAAc;AACvCrH,QAAAA,EAAUvD,KAAK,eAAcjD,EAAUqM,IAAAA,GACvC7F,EAAUvF,MAAM+N,QAAQ,QACxBxI,EAAUvF,MAAM8N,SAAS,QACzBvI,EAAUqY,UAAU5c,IAAI,mBAAA,GACxBuE,EAAU68D,MAAM,QAChB78D,EAAUsH,YAAY,4YAatB9N,EAAUiuB,KAAKznB,CAEf8C,GAAAA,KAAK4b,KAAK1e;AAAAA,MACV,EAAA,GAEFX,MAAM,EAAA;AAAA,IAER;AAAA,EAEA,EZsCoB7F,CAEnBsjE,GAAAA,GAAMtjE,IM5FHH,OAAO0jE,WAEA/O,IAkDR30D,OAAO0jE,QAjDL9O,IAAU,GACV1gD,IAAU,CAAA,GACdygD,EAAEgP,GAAGC,gBAAgB,SAASnjE,GAC7B;AAAA,eAAWkE,KAAY,UAMhB;AACN,UAAIo9C,IAAQ,CA+BZ;AAAA,aA9BAt4C,KAAKo6D,KAAK,WAAA;AACT,YAAIp6D,QAAQA,KAAKnF;AAChB,cAAKmF,KAAKnF,aAAa,cAAA;AAwBtBy9C,YAAAA,EAAMj/C,KAAK9C,OAAOyJ,KAAKnF,aAAa;eAxBE;AACtC,gBAAIoU,IAAO;AACPk8C,YAAAA,MACHl8C,IAAO,eAAek8C,IAAQ,IAC9B50D,OAAO0Y,CAAQorD,IAAAA,UAAUC;AAE1B,gBAAIC,IAAQhkE,OAAO0Y,CAGnB;AAAA,qBAASlF,KADT/J,KAAKyV,aAAa,gBAAgBxG,CAClBjY,GAAAA;AACN,cAAL+S,KAAK,WACRwwD,EAAKvjE,OAAO+S,CAAO/S,IAAAA,EAAO+S,CAEvB/J;AAAAA,iBAAKwvB,qBAAqB,KAAA,EAAO31B,WACrCmG,KAAKwE,YAAY,0fACjBxE,KAAKwF,aAAa,uBAEnB+0D,EAAK51C,KAAK3kB,MAAMu6D,EAAKvjE,OAAO0B,MAAM6hE,EAAKvjE,OAAOiE,IAAAA,GAC1CjE,EAAOsP,QACVi0D,EAAK1sD,MAAM7W,EAAOsP,IAAAA,GAEnBgyC,EAAMj/C,KAAKkhE,CACXpP,GAAAA;AAAAA,UACA;AAAA,MAGN,CAEwB,GAAjB7S,EAAMz+C,WAAW,IAAUy+C,EAAM,KAC9BA;AAAAA,IACP;AAvCA,QAAI7tC,EAAQzT,CACX;AAAA,aAAOyT,EAAQzT,CAAQ4L,EAAAA,MAAM5C,MAAM,CAEnCkrD,CAAAA;AAAAA,IAAAA,EAAE5/C,MAAM,YAAatU,IAAS,yCAqClC;AAAA,EAAA,IO/Ce,SAAgBN,GAAAA;AAAAA,KAE/B;AAEC,UAAI6V,IAAiB7V,EAAU6V,gBAC9BC,IAAa9V,EAAU8V,YACpBguD,IAAoB,MACvBC,IAAkB,MAEfC,IAAsB,SAAShiE,GAAMuC,GAAAA;AACxC,YAAI8sC,IAAO/nC;AACXxJ,QAAAA,EAAO2e,aAAaslD,CAAAA,GACpBjkE,EAAO2e,aAAaqlD,CAEpB;AAAA,YAAIG,IAAU5yB,EAAKj+B,OAClB8wD,IAAU7yB,EAAK3mC;AAChBy5D,QAAAA,EAAY76D,MAAMtH,GAAMuC,CAExBw/D,GAAAA,IAAkB9rD,WAAW,WAAA;AAEzBjY,UAAAA,EAAUkiB,eAIRmvB,EAAKloC,UAAU,sBAAsB,CAAC+6D,GAASD,GAAS1/D,KAAQ8sC,EAAK3mC,OAAO1I,KAAQqvC,EAAKj+B,KAK9F0C,CAAAA,KAAAA,EAAWvB,KAAK88B,GAAMrvC,GAAMuC,IAC5B8sC,EAAKloC,UAAU,gBAAgB,CAACkoC,EAAK3mC,OAAO2mC,EAAKj+B,KAEjDtT,CAAAA,GAAAA,EAAO2e,aAAaqlD,CACpBC,GAAAA,IAAkB,KARjBI,EAAY9yB,GAAM4yB,GAASC,CAAAA;AAAAA,QAS/B,GAAKlkE,EAAUM,OAAOu3D,YACtB;AAAA,MAAA,GACKuM,IAAkB,SAASpiE,GAAMuC;AACpC,YAAI8sC,IAAO/nC,MACV+6D,IAAMhyD;AAEP8xD,QAAAA,EAAY76D,MAAMtH,GAAMuC,CAAAA,GAExBzE,EAAO2e,aAAaqlD,CAAAA,GACpBA,IAAoB7rD,WAAW,WAAA;AAC3BjY,UAAAA,EAAUkiB,cAIV6hD,KAGHjuD,EAAW5J,MAAMmlC,GAAMgzB,CAAAA;AAAAA,QAC1B,GAAKrkE,EAAUM,OAAOu3D;MACtB;AACC,eAASsM,EAAYnkE,GAAWgC,GAAMuC,GAAAA;AAClCvC,QAAAA,MACFhC,EAAUoT,QAAQpR,IAChBuC,MACFvE,EAAU0K,QAAQnG;AAAAA,MAEnB;AACDvE,MAAAA,EAAUsE,YAAY,oBAAoB,WAAA;AACtCtE,QAAAA,EAAUM,OAAOu3D,gBACnB73D,EAAU6V,iBAAiBmuD,GAC3BhkE,EAAU8V,aAAasuD,MAEvBpkE,EAAU6V,iBAAiBA,GAC3B7V,EAAU8V,aAAaA;AAAAA,MAE1B,CAAA;AAAA,IAEC,GAED;AAAA,EAAA,EbqBc9V,CjC01BC,GAAA,SAAgBA,GAE/BA;AAAAA,IAAAA,EAAUskE,sBAAsB,SAAShkE;AACxC,UAAI4uC,GACAq1B;AACAjkE,MAAAA,aAAkBsd,WACrBsxB,IAAS5uC,IACCA,EAAOiM,eAAe,QAAA,IAChC2iC,IAAS5uC,EAAO4uC,SACP5uC,EAAOiM,eAAe,aAC/B2iC,IAAS5uC,IAITikE,IADGr1B,IACK,WAEA5uC,EAAOiE,QAAQ;AAGxB,UAAI4lC,IAAK,IAAIe,GAAc5qC,EAAO6V,GAMlC;AAAA,aALAg0B,EAAGlc,KAAKjuB,CAAAA,GACRmqC,EAAGwE,mBAAmB,EACrBpqC,MAAMggE,GACNr1B,QAAQA,EAAAA,GACN5uC,EAAOsc,WACHutB,GAAAA;AAAAA,IACR,GAEAnqC,EAAUkrC,gBAAgBA;AAAAA,EAE1B,EiCv3BqBlrC,CAAAA,Gc/FN,SAAgBA,GAa/BA;AAAAA,IAAAA,EAAUsE,YAAY,oBAAoB,WAAA;AACf,aAAhBkgE,cAAgB,OACzB3kE,OAAO2kE,YAAYC,WAAW,WAAW,SAAStiD,GAAGC,GAAGla,GAAAA;AACvD,YAAI6T,IAAU7T,EAAE,GAAG+qB;AAEnB,gBAAQjzB,EAAUM,OAAOs3D,YACxB;AAAA,UAAA,KAAK;AACJ93D,YAAAA,EAAO0uC,MAAMzyB;AACb;AAAA,UACD,KAAK;AACJjc,YAAAA,EAAO6U,QAAQmtC,IAAI/lC,CAAAA;AAAAA,QAAAA;AAAAA,MAKxB,CAEA;AAAA,IAAA,CAAA;AAAA,EAGA,EdgEW/b,CAAAA;AACV,QAAM0kE,IelEC,IAAIrpB,GAAc,EACxBR,IAAAA,IACAtE,QACA4D,IACAK,IAAAA,IAAAA,IACAC,QACAC,IACAC,IAAAA,IAAAA,IACAC,QACA11B,IACA41B,IAAAA,IAAAA,IACAC,QACAC,IACAC,IAAAA,IAAAA,IACAC,IACAj4C,IAAAA,IAAAA,IACAk4C,IACAC,IAAAA,IAAAA,IACAG,QACAC,IACAC,IAAAA,IAAAA,IACAC,QACAC,IACAC,IAAAA,IAAAA,IACAC,QACAC,IACAC,IAAAA,IAAAA,IACAC,IACAC,IAAAA,IAAAA,IACAC,IfsCDl8C,GAAAA,CAAAA;AAAAA,EAAAA,EAAU0kE,OAAO,EAChBC,WAAWD,EAAKC,WAChBC,WAAW,SAASl3C,GACnB;AAAA,QAAUA,OAAAA,KAAW,UAAS;AAC7B,UAAIm3C,IAAeH,EAAKI,UAAUp3C;AAC9Bm3C,MAAAA,MACHA,IAAeH,EAAKI,UAAU,IAAA,IAG/B9kE,EAAU0tB,SAASm3C;AAAAA,IACnB,WAAQn3C;AACR,UAAI1tB,EAAU0tB;AAGb,iBAAQxqB,KAAKwqB;AACTA,UAAAA,EAAOxqB,CAAAA,KAAawqB,OAAAA,EAAOxqB,MAAO,YAChClD,EAAU0tB,OAAOxqB,OACpBlD,EAAU0tB,OAAOxqB,KAAK,KAGvBlD,EAAUqd,MAAMrd,EAAU0tB,OAAOxqB,IAAIwqB,EAAOxqB,CAAAA,GAAAA,OAE5ClD,EAAU0tB,OAAOxqB,KAAKwqB,EAAOxqB,CAAAA;AAAAA;AAV/BlD,QAAAA,EAAU0tB,SAASA;AAgBrB,QAAIwN,IAASl7B,EAAU0tB,OAAOwN;AAC9BA,IAAAA,EAAO6pC,eAAgB7pC,EAAOyb,WAC9Bzb,EAAO8pC,iBAAkB9pC,EAAO0b,aAChC1b,EAAO+pC,iBAAkB/pC,EAAOgE,aAE7Bl/B,EAAU8C,cACZ9C,EAAUuQ;EAGX,GACDu0D,WAAWJ,EAAKI,UAAAA,GAEjB9kE,EAAU0kE,KAAKE,UAAU,IACzB5kE,GAAAA,EAAU6c,MAAM,IAChBqoD,GAAWllE,CAGX;AAAA,QAAMmlE,IAAgB,CAAA;AAiEtB,SAhEAnlE,EAAUolE,UAAU,SAAS9kE;AAc5B+kE,KAaD,SAA0B/kE,GAAQglE,GAAcC,GAC/C;AAAA,YAAMltD,IAAS,CAAA;AAEf,iBAAUnV,KAAK5C;AACd,YAAGA,EAAO4C,IAAG;AACZ,gBAAMsiE,IAAYtiE,EAAE8gB,YACjBshD;AAAAA,UAAAA,EAAaE,MACfF,EAAaE,CAAAA,EAAWphE,QAAQ,SAASqhE,GAAAA;AACxC,kBAAMC,IAAiBD,EAAIzhD,YACvB1jB;AAAAA,YAAAA,EAAOolE,CACVrtD,KAAAA,EAAO1V,KAAK+iE,CAEnB;AAAA,UAAA,CAAA,GAEIrtD,EAAO1V,KAAK6iE,CAAAA;AAAAA,QACZ;AAeF,aAZAntD,EAAOuS,KAAK,SAASzI,GAAGC,GAAAA;AACvB,cAAMujD,IAASJ,EAAWpjD,MAAM,GAC1ByjD,IAASL,EAAWnjD,CAAM,KAAA;AAChC,eAAGujD,IAASC,IACJ,IACCD,IAASC,IACT,KAED;AAAA,MAEX,CAESvtD,GAAAA;AAAAA,IACP,GAzDuC/X,GAAQ,EAC7CulE,cAAc,CAAC,aACfC,aAAa,CAAC,aACdC,WAAW,CAAC,aACV,EACFC,QAAQ,GACRrpD,OAAO,GACPunB,UAAU,GACV4hC,aAAa,GACbD,cAAc,GACdE,WAAU,KAGE3hE,QAAQ,SAASmU,GAAAA;AAC9B,UAAI4sD,CAAAA,EAAc5sD,IAAM;AACvB,cAAM0tD,IAAShmB,EAAiBimB,aAAa3tD;AAC7C,YAAG0tD,CAAAA;AAIF,gBAAM,IAAI51D,MAAM,oBAAoBkI;AAHpC0tD,QAAAA,EAAOjmE,CAAAA,GACPmlE,EAAc5sD,CAAQ,IAAA;AAAA,MAIvB;AAAA,IACJ,CACA;AAAA,EAAA,GAmCCvY,EAAUolE,QAAQ,EACjB7c,WAAW,YAGLvoD;AAER;AgBrNe,MAAMmmE,GACpB;AAAA,EAAA,YAAY7lE,GACXgJ;AAAAA,SAAK88D,cAAc;AACnB,eAAUljE,KAAK5C;AACdgJ,WAAK88D,YAAYljE,CAAAA,IAAK5C,EAAO4C,CAE9B;AAAA,EAAA;AAAA,EAED,aAAaqV,GAAMsE,GAAAA;AAClBvT,SAAK88D,YAAY7tD,CAAAA,IAAQsE;AAAAA,EACzB;AAAA,EAED,aAAatE,GACZ;AAAA,WAAOjP,KAAK88D,YAAY7tD,CACxB;AAAA,EAAA;AAAA;OCXS+a,SAAU,OAAeA,OAAO+yC,aAC1C/yC,OAAO+yC,SAASC,kBAAkB,SAAUr4D,GAAK1J,GAAMqlC,GAAM5pC,GACxD4pC;AAAAA,EAAAA,IAAOA,KAAQ;AAAnB,MACIlnC,IAAMkL,SAASC,cAAc;AAajC,SAZAnL,EAAIO,KAAK,iBAAiBqG,KAAKi9D,QAAQ,KACvC7jE,EAAIoL,YAAY,cAAcpL,EAAIO,KAAK,qPAAqP2mC,IAAO,kFACnSh8B,SAASmJ,KAAKhJ,YAAYrL,EAAIuN,aAE9B3G,KAAKk9D,aAAa9jE,EAAIO,IAAI,IAAA,KAE1BqG,KAAKm9D,GAAGn9D,KAAKo9D,EAAAA,EAAIC,QAAQ3mE,GACzBsJ,KAAKm9D,GAAGn9D,KAAKo9D,IAAIE,UAAUlkE,EAAIO,IAC/BjD,EAAU6mE,WAAW7mE,EAAU8V,YAC/B9V,EAAU21C,aAAa;KACvB31C,EAAUiuB,KAAKvrB,EAAIO,IAAIgL,GAAK1J,CAErB+E,GAAAA,KAAKm9D,GAAGn9D,KAAKw9D,aAAgBH,CAAAA,EAAAA;AACtC;ACpBe,SAAShoD,GAAO3e;AAS1BA,IAAU+mE,gCACd/mE,EAAUsE,YAAY,mBAAmB,SAAUw9B,GAAQC,GAC1D;AAAA,QAAIilC,IAAS19D,KAAK29D;AAClB,QAAKD,KAEDA,EAAOllC,OAAYklC,EAAOjlC,CAAAA,GAAS;AACtC,UAAImlC,IAAcF,EAAOllC;aAClBklC,EAAOllC,CAAAA,GACdklC,EAAOjlC,CAAUmlC,IAAAA;AAAAA,IACjB;AAAA,EACH,CACClnE,GAAAA,EAAU+mE,mCAGX/mE,EAAUmnE,yBAAyB,SAASh/D,GAAAA;AAC3C,aAAQjF,IAAE,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC5BoG,WAAK89D,eAAej/D,EAAIjF,CAC1B,CAAA;AAAA,EAAA,GACAlD,EAAUonE,iBAAiB,SAAS/qD;AACnC,QAAI/S,KAAK29D,sBAAT;AAII39D,WAAK29D,qBAAqB5qD,EAAKpZ,EAClCqG,MAAAA,KAAK29D,qBAAqB5qD,EAAKpZ,EAAAA,IAAM,CAAA;AAEtC,UAAI+B,IAAUqX,EAAK/S,KAAK+mD,sBAAAA,CAAAA;AACd/mD,WAAK29D,qBAAqB5qD,EAAKpZ,IACrC+B,CAAWqX,IAAAA;AAAAA,IAPd;AAAA,EAQF,GACArc,EAAUqnE,oBAAoB,SAASC,GAAUtiE,GAAAA;AAChD,SAAIsE,KAAK29D,qBAAqBK;AAC7B,aAAO;AAER,QAAGh+D,KAAK29D,qBAAqBK,CAAUtiE,EAAAA,CAAAA;AACtC,aAAOsE,KAAK29D,qBAAqBK,CAAUtiE,EAAAA,CAAAA;AAE5C,QAAIuiE,IAAQj+D,KAAK29D,qBAAqBK,CAEtC;AAAA,QAAGtnE,EAAU4kD,eAAe5kD,EAAU4kD,YAAY4iB,iBAAiBD,EAAMvnE,EAAU4kD,YAAY4iB,aAC9F;AAAA,aAAOD,EAAMvnE,EAAU4kD,YAAY4iB,aAEnC;AAAA,QAAIC,IAAaC,IAAAA,GAChB3hE,IAAK;AACN,aAAQ7C,KAAKqkE;AACTA,MAAAA,EAAMrkE,CAAGohC,EAAAA,UAAUmjC,MACrB1hE,IAAKwhE,EAAMrkE,IACXukE,IAAaF,EAAMrkE,GAAGohC;AAGxB,WAAOv+B;AAAAA,EAET,GACA/F,EAAU2nE,uBAAuB,WAAA;AAChCr+D,SAAK29D,uBAAuB;EAC7B,GAEAjnE,EAAU4nE,wBAAwB,SAASC;AAE1C,aADIrkE,IAAS8F,KAAK+mD,sBACVntD,GAAAA,IAAE,GAAGA,IAAI2kE,EAAY1kE,QAAQD,KAAI;AACxC,UAAI6C,IAAK8hE,EAAY3kE,CACjB4kE,GAAAA,IAAa9nE,EAAUqnE,kBAAkBthE,EAAG9C,IAAI8C,EAAGvC;AACvD,UAAGskE;AACF,iBAAQp/D,KAAKo/D;AACU,UAAnBp/D,EAAEyH,QAAQ,SAAS,MACrBpK,EAAG2C,CAAAA,IAAKo/D,EAAWp/D,CAItB;AAAA,IAAA;AAAA,EACF;AAEA;ACjFA,MAAMq/D,KAAe,EACpBC,gBAAgB,MAChBC,cAAc,MACdC,WAAU,MACVC,kBAAmB,MACnBC,mBAAoB,WACnB;AAAA,MAAI9hD,IAAOhd,KAAK6+D;AACZ7hD,QAEDA,EAAK/a,cACP+a,EAAK/a,WAAWC,YAAY8a,CAAAA,GAC7B1Y,SAASmJ,KAAKjI,YAAYlB,SAASmJ,KAAKjI,UAAU+I,QAAQ,kBAAkB,EAC5EvO,GAAAA,KAAK6+D,mBAAmB;AACxB,GACDE,iBAAkB,SAASjoE,GAAOJ;AAEjC,WADIsoE,IAAQ,MACHplE,IAAI,GAAGA,IAAIlD,EAAU0lC,UAAUviC,QAAQD,KAAI;AACnD,QAAIojB,IAAOtmB,EAAU0lC,UAAUxiC,CAC/B;AAAA,QAAIojB,EAAKniB,aAAanE,EAAUM,OAAO0C,eAAoB5C,KAAAA,EAAM6C,MAAMqjB,EAAKniB,aAAanE,EAAUM,OAAO0C,eAAoBhD,KAAAA,EAAU8I,UAAU;AACjJw/D,OAAAA,IAAQhiD,EAAKljB,UAAU,EAAA,GACjBnC,MAAM8J,WAAWu9D,EAAMrnE,MAAMC,MAAMonE,EAAMrnE,MAAME,OAAO;AAC5D;AAAA,IACA;AAAA,EACD;AACD,SAAOmnE,KAAS16D,SAASC,cAAc,KAAA;AACvC,GACD06D,mBAAoB,SAASnoE,GAAOJ,GACnC;AAAA,MAAGsJ,KAAK6+D;AACP,WAAO7+D,KAAK6+D;AAEb,MAAIK,IAAS56D,SAASC,cAAc,KAAA,GAChCnM,IAAO1B,EAAUya,UAAUguD,cAAcroE,EAAMmB,YAAYnB,EAAMoB,UAAUpB,CAY/E;AAAA,SAXGsB,IACF8mE,EAAO16D,YAAYpM,IAEnB8mE,EAAOz6D,YAAYzE,KAAK++D,gBAAgBjoE,GAAOJ,CAGhDwoE,CAAAA,GAAAA,EAAO15D,YAAY,wBACnB05D,EAAOvnE,MAAM8J,WAAW,YACxBzB,KAAK6+D,mBAAmBK,GACxB56D,SAASmJ,KAAKhJ,YAAYy6D,CAAAA,GAC1B56D,SAASmJ,KAAKjI,aAAa,kBACpB05D;AACP,GACDE,iBAAkB,SAASlkE;AAC1B,MAAI2gD,IAAM,EAAC75B,GAAG9mB,EAAE+mB,SAASF,GAAG7mB,EAAEgnB,QAAAA;AAE9B,MADAliB,KAAKi/D,kBAAkBj/D,KAAK4+D,UAAUniE,IAAIuD,KAAK0+D,cAAAA,GAC3C1+D,KAAK6+D,kBAAT;AAGA,QAAI78C,IAAI65B,EAAI75B,GACXD,IAAI85B,EAAI95B,GAEL3pB,IAAOkM,SAAS8T,iBACnB3K,IAAOnJ,SAASmJ,MAChByxD,IAASl/D,KAAK6+D;AAEfK,IAAAA,EAAOvnE,MAAME,OAAO,KAAKmqB,KAAK5pB,KAAQA,EAAKioB,cAAc5S,KAAQA,EAAK4S,cAAc,MAAMjoB,EAAKooB,cAAc,KAAK,MAClH0+C,EAAOvnE,MAAMC,MAAM,KAAKmqB,KAAK3pB,KAAQA,EAAK+nB,aAAa1S,KAAQA,EAAK0S,aAAa,MAAM/nB,EAAKmoB,aAAa,KAAK;AAAA,EAT7G;AAUD,GACD8+C,qBAAsB,SAAS3oE,GAC9BA;AAAAA,IAAU8I,WAAW9I,EAAU8jC,YAAY9jC,EAAU+I,aAAa/I,EAAU4kD,cAAc5kD,EAAUyb,aAAa;AACjH,GACDmtD,WAAY,SAAS5oE;AACjBA,OACFsJ,KAAKq/D,oBAAoB3oE,CAE1BsJ,GAAAA,KAAK8+D,qBACL9+D,KAAK4+D,YAAY;AACjB,GACDW,uBAAwB,SAASzoE,GAAOJ,GAAW8oE;AAClD1oE,IAAMmkC,SAAS,GACfnkC,EAAMkkC,UAAU,GAEblkC,EAAM6a,aAAa7a,EAAM6a,aAAa,QACxC7a,EAAM6a,YAAY,MAClB7a,EAAMgI,WAAWhI,EAAM+zC,cAAc,IACrC/zC,EAAM2oE,eAAe,IAGtB/oE,EAAU4kD,cAAcxkD,GACxBJ,EAAU0W,QAAQtW,EAAM6C,EAAM7C,IAAAA,GAC9BJ,EAAU8I,WAAW1I,EAAM6C,IAC3BjD,EAAU+I,aAAa,QAGpB+/D,KACF9oE,EAAUwkC,eAAeskC,CAAAA;AAC1B,GACDE,WAAY,SAAShpE,GAAAA;AACpB,MAAIA,EAAUM,OAAO2oE,UAArB;AAGA3/D,SAAK0+D,iBAAiBhoE,GACtBsJ,KAAK2+D,eAAejoE;AACpB,QAAIkpE,IAAO5/D,KAAK4+D,YAAY;AAC5BgB,IAAAA,EAAKnjE,KAAK/F,EAAU4kD,aACpBskB,EAAKC,UAAUnpE,EAAU4kD,YAAY3hD;AAAAA,EAN7B;AAOR,GACDmmE,qBAAsB,SAASppE,GAAWwE,GAAAA;AACzC,OAAIxE,EAAUM,OAAO+oE;AAEpB,WADA//D,KAAKo/D,gBAAgBlkE;AAItB,MAAI0kE,IAAO5/D,KAAK4+D,WAEZniE,IAAK/F,EAAUiM,YAAYi9D,EAAKnjE,EAAAA;AAEpC,MAAG/F,KAAasJ,KAAK0+D,gBAAe;AACnCjiE,IAAAA,EAAG9C,KAAKjD,EAAUqM;AAClB,QAAIqQ,IAAW3W,EAAGvE,WAAWuE,EAAGxE;AAChCwE,IAAAA,EAAGxE,aAAa,IAAIiB,KAAKxC,EAAU4E,SAAAA,EAAWuJ,WAC9CpI,EAAGvE,WAAW,IAAIgB,KAAKuD,EAAGxE,WAAWkB,YAAYia,CACpD;AAAA,EAAA;AACG3W,IAAAA,EAAG9C,KAAKqG,KAAK4+D,UAAUiB,SACvBpjE,EAAGwjD,eAAe;AAGnB,SADAjgD,KAAK4+D,UAAUoB,YAAYvjE,EAAG9C,MAC1BjD,EAAUmJ,UAAU,uBAAuB,CAACpD,EAAG9C,IAAI8C,GAAIvB,CAE3D8E,CAAAA,MAAAA,KAAK2+D,eAAejoE,GACpBsJ,KAAKu/D,sBAAsB9iE,GAAI/F,GAAWwE,IAC1C8E,KAAK8+D,kBAAAA,GACLpoE,EAAU8V,WAAAA,GACV9V,EAAUmJ,UAAU,iBAAiB,CAACpD,EAAG9C,IAAI8C,GAAIvB,CAAAA,CAAAA,GAAAA;AAEjD,GAED+kE,qBAAsB,SAASvpE,GAAWwE,GACzC;AAAA,MAAG8E,KAAK4+D,aAAaloE,EAAU8I,YAAY9I,EAAUM,OAAO2oE,UAAS;AACpE,QAAA,CAAIjpE,EAAUmJ,UAAU,wBAAwB,CAACnJ,EAAU8I,UAAU9I,EAAU4kD,aAAapgD,CAC3F,CAAA;AAAA,aAAA;AAEE8E,SAAK2+D,gBAAgBjoE,MACvBsJ,KAAK2+D,eAAe,OAGrB3+D,KAAKi/D,kBAAkBj/D,KAAK4+D,UAAUniE,IAAI/F;AAC1C,QAAIiD,IAAKjD,EAAU8I;AAMnB,WALAQ,KAAK4+D,UAAUoB,YAAY,MAAA,OACpBtpE,EAAU0W,QAAQzT,CAAAA,GACzBqG,KAAKq/D,oBAAoB3oE,CAAAA,GACzBA,EAAUiW,YAAYhT,CACtBjD,GAAAA,EAAUmJ,UAAU,kBAAkB,CAAClG,GAAIqG,KAAK4+D,UAAUniE,IAAIvB,CACvD,CAAA,GAAA;AAAA,EAEV;AACG,SAAA;AAED,GACDglE,aAAc,SAASppE,GAAOJ;AAC7BsJ,OAAKu/D,sBAAsBzoE,GAAOJ,CAClCsJ,GAAAA,KAAKs/D,UAAU5oE,CAAAA,GACfA,EAAU8V,WAAAA;AACV,GACD2zD,kBAAmB,SAASC,GAAgBC,GAAa93C,GAAME;AAC9DA,EAAAA,EAAG5oB,UAAU,gBAAgB,CAACwgE,EAAY1mE,IAAI0mE,KAG9CrgE,KAAKu/D,sBAAsBa,GAAgB73C,CAC3CvoB,GAAAA,KAAKs/D,UAAU/2C,CACZ63C,GAAAA,EAAezuD,aAAayuD,EAAezuD,aAAa,OAC1D4W,EAAK1oB,UAAU,gCAAgC,CAACugE,EAAezmE,EAAAA,CAAAA,GAC/D4uB,EAAK5b,YAAY0zD,EAAY1uD,SAE7B4W,KAAAA,EAAKtW,YAAYmuD,EAAezmE,KAEjC4uB,EAAK/b,WAAAA,GACLic,EAAGjc,WACH;AAAA,EAAA;AAGF,IAAI8zD,KAA2B;AAC/B,MAAMC,KAAsB,CAmE5B;AAAA,SAASC,GAAiB9pE,GACzBA;AAAAA,IAAUsE,YAAY,oBAAoB,WAAA;AAAA,KAnE3C,SAAgCtE,GAC/BA;AAAAA,MAAAA,EAAUI,MAAMwN,SAASmJ,MAAM,aAAa,SAASvS,GACpD;AAAA,YAAIy/B,IAAM8jC,IACNgC,IAAmB9lC,EAAI8lC;AAE3B,YAAGA;AACF,cAAI9lC,EAAI+jC;AAMP,gBAAG+B,CAAAA,EAAiBjhE,UAEf;AAEJ,kBAAIwU,IAAS2mB,EAAIgkC;AACb3qD,mBAAAA,CAAU2mB,EAAIslC,oBAAoBjsD,GAAQ9Y,CAAAA,KAC7Cy/B,EAAImlC,oBAAoBW,GAAkBvlE;YAE3C;AAAA;AAZ2C,YAAzCulE,EAAiBnlE,SAAWu+B,EAAAA,aAAa,UAAU4mC,EAAiBzpE,OAAO2oE,YAC7EhlC,EAAI+kC,UAAUe,CAaR9lC;AAAAA;AAAAA,UAAAA,EAAI+jC,mBACR/jC,EAAIgkC,eAKPhkC,EAAIslC,oBAAoBtlC,EAAIgkC,cAAczjE,CAAAA,IAH1Cy/B,EAAIykC,gBAAgBlkE;AAOtBy/B,QAAAA,EAAI8lC,mBAAmB;AAAA,MACzB,CACC/pE,GAAAA,EAAUI,MAAMwN,SAASmJ,MAAM,WAAW,SAASvS,GAClD;AAAA,YAAIy/B,IAAM8jC,IACNl2C,IAAOoS,EAAI+jC,gBACdj2C,IAAKkS,EAAIgkC;AAEV,YAAGp2C;AACF,cAAGE,KAAMF,KAAQE;AAEhBF,YAAAA,EAAK5b,YAAYguB,EAAIikC,UAAUoB,SAAAA;AAAAA,mBACvBv3C,KAAMF,MAASE,GAAG;AAE1B,gBAAIkK,IAAWgI,EAAIikC,UAAUniE,IACzBA,IAAKgsB,EAAGttB,SAASw/B,EAAIikC,UAAUoB,SAChCz3C;AAAAA,YAAAA,EAAK1oB,UAAU,kBAAkB,CAAC8yB,EAASh5B,IAAIg5B,GAAUlK,GAAIvtB,CAAAA,CAAAA,IAC/Dy/B,EAAIwlC,iBAAiBxtC,GAAUl2B,GAAI8rB,GAAME,CAEzCkS,IAAAA,EAAIulC,YAAYvtC,GAAUpK,CAAAA;AAAAA,UAE/B;AAEQoK,YAAAA,IAAWgI,EAAIikC,UAAUniE,IAC1B8rB,EAAK1oB,UAAU,kBAAkB,CAAC8yB,EAASh5B,IAAIg5B,GAAU,MAAMz3B,OACjEy/B,EAAIulC,YAAYvtC,GAAUpK,CAI7BoS;AAAAA,QAAAA,EAAI2kC,UACJ3kC,GAAAA,EAAI+lC,oBAAoB/lC,EAAI+jC,iBAAiB/jC,EAAIgkC,eAAe;AAAA,MAClE,CAEA;AAAA,IAAA,GAIyBjoE,CACvB4pE,GAAAA,KAAAA;AAAAA,EACF,GAAI,EAAC3tD,MAAAA,OAEJjc,EAAUsE,YAAY,aAAa,WAClCslE;AAAAA,IAAAA,KAAAA;AACA,UAAMK,IAAgBJ,GAAoBlsD,IAAAA;AACvCssD,IAAAA,KACFH,GAAiBG;EAEpB,GAAI,EAAChuD,SACL,CAAA;AAAA;AC/Pe,SAAQiuD,GAAClqE,GAAAA;AAAAA,GAIxB,WACC;AAAA,QAAImqE,IAAc,CAAA;AAElB,aAASC,IACR;AAAA,aAAA,CAAA,CAAUD,EAAkB;AAAA,IAC5B;AAUD,aAASE,EAAWphD,GAAAA;AACnBhR,iBAAW,WACV;AAAA,YAAGjY,EAAUkiB;AACZ,iBAAA;AAEGkoD,QAAAA,EAbN,KAAA,SAAmB7/C,GAAOjf,GACzB;AAAA,iBAAMif,KAASA,KAASjf;AACvBif,YAAAA,IAAQA,EAAMhf;AAGf,iBAAUgf,KAASjf;AAAAA,QACnB,EAO8BsC,SAASmd,eAAe/qB,EAAU8C,UAAAA,KAC9D9C,EAAUq5B,MAAAA;AAAAA,MAEX,GAAE,CACH;AAAA,IAAA;AA0BD,aAASixC,EAAUlqE,GAAAA;AAClB,UACIsE,KADAtE,IAAQA,KAASP,OAAOO,OACTmqE;AACJ7lE,MAAAA,KARAylE,EAAYA,EAAYhnE,SAAS,CAUhDnD,KAAAA,EAAUwqE,oBAAoBF,UAAU5lE,GAAQtE,CAChD;AAAA,IAAA;AAWD,QALAJ,EAAUsE,YAAY,cAJtB,WAAA;AAjCA,UAAoB2kB;AAkCRjpB,MAAAA,IAAAA,EAAUo4B,eAjCrBp4B,EAAUolB,YAAY6D,GAAK,WAAWqhD,CACtCtqE,GAAAA,EAAUI,MAAM6oB,GAAK,WAAWqhD,IAChCH,EAAYxnE,KAAKsmB;IAgCjB,CAGDjpB,GAAAA,EAAUsE,YAAY,mBA/BtB,WACC;AAAA,UAAI2kB,IAAMkhD,EAAYxsD,IAAAA;AACnBsL,MAAAA,KACFjpB,EAAUolB,YAAY6D,GAAK,WAAWqhD,CAAAA,GAEvCD,EAEA;AAAA,IAAA,CAAA,GA0BDrqE,EAAUsE,YAAY,oBAAoB,WAAW+lE;AAAAA,MAAAA,EAAAA;AAAAA,IAAa,KAE9DrqE,EAAUyqE,qBAAqB;AAClCzqE,QAAUyqE,sBAAAA;AAEV,UAAIC,IAAe,MACfC,IAAc;AAClB,YAAMR,IAAc,CAAA;AACpBnqE,QAAUsE,YAAY,kBAAkB,SAAS2kB,GAAAA;AAIhD,aAHAyhD,IAAe98D,SAASmd,eACxB4/C,IAAcD,GAERC,KAAe3qE,EAAUkQ,cAAcy6D,CAAax6D,EAAAA,QAAQ,cAAkB,IAAA;AACnFw6D,UAAAA,IAAcA,EAAYp/D;AAExBo/D,QAAAA,MACFA,IAAcA,EAAYp/D,aAG3BvL,EAAUolB,YAAY6D,GAAK,WAAWqhD,CACtCtqE,GAAAA,EAAUI,MAAM6oB,GAAK,WAAWqhD,CAChCH,GAAAA,EAAYxnE,KAAKsmB,CACpB;AAAA,MAAA,CAAA,GAGEjpB,EAAUsE,YAAY,uBAAuB,WAC5C;AAAA,YAAI2kB,IAAMkhD,EAAYxsD;AACnBsL,QAAAA,KACFjpB,EAAUolB,YAAY6D,GAAK,WAAWqhD,IAEvCryD,WAAW,WAAA;AACV,cAAGjY,EAAUkiB;AACZ,mBAAA;AAGD,mBADIqoD,IAAgB38D,SAASmd,eACvBw/C,KAAiBvqE,EAAUkQ,cAAcq6D,CAAep6D,EAAAA,QAAQ,eAAmB,IAAA;AACxFo6D,YAAAA,IAAgBA,EAAch/D;AAE5Bg/D,UAAAA,MAIAG,KAAgBA,EAAan/D,aAC/Bm/D,EAAarxC,MAAAA,IAELsxC,KAAeA,EAAYp/D,cACnCo/D,EAAYtxC,SAEbqxC,IAAe,MACfC,IAAc;AAAA,QAEd,GAAE;MACN,CACE;AAAA,IAAA;AAED3qE,MAAUwqE,oBAAoBJ,UAAUA;AAAAA,EAGxC,GAED;AAAA;ACjIe,SAAQQ,GAAC5qE,GAAAA;AAGxBA,IAAU6qE,kBAAkB,WAAA;AAE3B7qE,MAAUM,OAAOwqE,UAAU,IAE3B9qE,EAAUwqE,oBAAoBO,aAAa,MAC3C/qE,EAAUwqE,oBAAoBQ,gBAAgB;AAC9C,QAAIC,IAAS,MAET9lB,IAAM,CAAA;AAUV,aAAS+lB,EAAmB9qE;AAC3BA,MAAAA,IAAQA,KAASP,OAAOO,OACxB+kD,EAAI75B,IAAIlrB,EAAMmrB,SACd45B,EAAI95B,IAAIjrB,EAAMorB;AAAAA,IACd;AACD,aAAS++C,IAAAA;AAMR,eAJIY,GACAC,GAEA1mE,IAASkJ,SAASy9D,iBAAiBlmB,EAAI75B,GAAG65B,EAAI95B,IAC5C3mB,KAAUA,KAAU1E,EAAU63B;AACnCnzB,YAASA,EAAO6G;AAMjB,aAJA4/D,IAAkBzmE,KAAU1E,EAAU63B,MAEtCuzC,IAAgBprE,EAAUwqE,oBAAoBc,WAAWjrE,UAElD8qE,GAAAA,KAAgBC;AAAAA,IACvB;AAmBD,aAASG,EAAUxlE;AAClB,aAAO/F,EAAU0M,WAAW,CAAE,GAAE3G;IAChC;AAhDG6H,aAASmJ,OAKZ/W,EAAUI,MAAMwN,SAASmJ,MAAM,aAAam0D,CAAAA,IAJ5ClrE,EAAUI,MAAMP,QAAQ,QAAQ,WAC/BG;AAAAA,QAAUI,MAAMwN,SAASmJ,MAAM,aAAam0D,CAC/C;AAAA,IAAA,CAAA,GA0BClrE,EAAUsE,YAAY,eAAe,SAASrB,GAAGuB,GAAAA;AAChD,UAAIsrC,IAAQ9vC,EAAU4E,SAAAA;AAGtB,UAAKkrC,EAAMvrC,QAAQurC,EAAM3hC,UAAzB;AAGA,YAAIpD,IAAW/K,EAAU+E,cAAcP,CAAAA;AACvCxE,UAAUwqE,oBAAoBO,aAAahgE,EAAS/I,MACpDhC,EAAUwqE,oBAAoBQ,gBAAgBjgE,EAAS/F;AAAAA,MAHtD;AAAA,IAIH,CAWChF,GAAAA,EAAUwrE,qBAAqB,SAASzlE;AACvC,UAAI/D,IAAOhC,EAAUwqE,oBAAoBO,YACrC/lE,IAAUhF,EAAUwqE,oBAAoBQ,eAExCvvC,IAAiB11B,EAAGvE,WAASuE,EAAGxE,YAEhC8a,IAAOkvD,EAAUxlE,CAKrB;AAAA,UApBD,SAA2BA,GACnBA;AAAAA,eAAAA,EAAGqC,UAAiBrC,OAAAA,EAAGouC,aACvBpuC,OAAAA,EAAGkV,kBAAkBlV,EAAGgjE;AAAAA,MAC/B,EAakB1sD,CAAAA,GAClBA,EAAK9a,aAAa,IAAIiB,KAAKR,CAAAA,GAC3Bqa,EAAK7a,WAAW,IAAIgB,KAAK6Z,EAAK9a,WAAWkB,QAAYg5B,IAAAA,CAAAA,GAElDz2B,GAAQ;AACV,YAAIyB,IAAWzG,EAAUqwD,sBAEtBrwD;AAAAA,UAAUM,OAAOmrE,gBAAgB1lE,EAAGU,MAAazG,EAAU0rE,uBAAuB1rE,EAAU0rE,oBAAoB3lE,CAAAA,IAClHsW,EAAK5V,CAAAA,IAAYV,EAAGU,CAAAA,IAEpB4V,EAAK5V,CAAYzB,IAAAA;AAAAA,MAClB;AACD,aAAOqX;AAAAA,IACT,GACCrc,EAAU2rE,YAAY,SAASC,GAASC,GAAaC,GAAAA;AAAAA,MACjD9rE,EAAUmJ,UAAU,uBAAuB,CAACyiE,GAASC,GAAaC,CAGrE9rE,CAAAA,MAJoD8rE,OAIpD9rE,EAAU6a,SAASgxD,CAAAA,GACnB7rE,EAAUmJ,UAAU,iBAAiB,CAACyiE,GAASC,GAAaC,CAC9D,CAAA;AAAA,IAAA,GAEC9rE,EAAU+rE,qBAAqB,WAAA;AAC9B,aAAGziE,EAAAA,CAAAA,KAAKgnD,gBAAsBhnD,KAAAA,KAAKk6B,wBAAuBl6B,KAAKhJ,OAAOwqE;AAAAA,IAIxE,GAQC9qE,EAAUI,MAAMwN,UAAU,WAAW,SAASpJ,GAAAA;AAAAA,OAExCA,EAAEwnE,WAAWxnE,EAAEynE,YAAYznE,EAAE26B,WAAW,MAAOn/B,EAAUksE,kBAAkBlsE,EAAUwqE,oBAAoBc,WAAWjrE,UAAAA,MACxHL,EAAUwqE,oBAAoBc,WAAWt3D,WAAWu2D,EAAAA;AAAAA,IAEvD,IAECvqE,EAAUmsE,sBAAsB,SAAS3nE,GACxC;AAAA,UAAA,CAAIxE,EAAU+rE,mBAAAA;AAAsB,eAAO;AAE3C,UAAIvnE,EAAE26B,WAAW,MAAM36B,EAAE26B,WAAW,IAAI;AACvC36B,QAAAA,EAAEigC,eAAe;AAEjB,YAAIlkB,IAAOvgB,EAAUgC,KAAKC,IAAIjC,EAAUoT,OAAO5O,EAAE26B,WAAW,KAAM,KAAI,GAAIn/B,EAAU0K,KAAAA;AAEpF,eADA1K,EAAU6V,eAAe0K;MAEzB;AAED,UAvBI+F,GAuBA09B,KAvBA19B,IAAOtmB,EAAUwqE,oBAAoBc,WAAWc,oBACzC9lD,EAAKvB,UAAgBuB,EAAKvB,UAC9B/kB,EAAU2jD;AAsBjB,WAAKn/C,EAAEwnE,WAAWxnE,EAAEynE,YAAYznE,EAAE26B,WAAW;AAM5C,eALI6kB,MACHhkD,EAAUksE,gBAAgBX,EAAUvrE,EAAUyE,SAASu/C,CACvDinB,CAAAA,GAAAA,IAAAA,IACAjrE,EAAUmJ,UAAU,iBAAiB,CAACnJ,EAAUyE,SAASu/C,CAAAA,CAAAA,CAAAA,IAAAA;AAI3D,WAAKx/C,EAAEwnE,WAAWxnE,EAAEynE,YAAYznE,EAAE26B,WAAW,MACxC6kB,GAAW;AACdinB,QAAAA,IAAS;AACT,YAAIllE,IAAK/F,EAAUksE,gBAAgBX,EAAUvrE,EAAUyE,SAASu/C;AAEhEhkD,UAAUiW,YAAYlQ,EAAG9C,EACzBjD,GAAAA,EAAUmJ,UAAU,cAAc,CAACpD,CACnC,CAAA;AAAA,MAAA;AAGF,WAAKvB,EAAEwnE,WAAWxnE,EAAEynE,YAAYznE,EAAE26B,WAAW,MAAMorC,KAAkB;AAIpE,YAFAxkE,KADIA,IAAK/F,EAAUksE,gBAAgBlsE,EAAUyE,SAASzE,EAAUksE,cAAcjpE,EAAMjD,IAAAA,EAAUksE,kBACnFlsE,EAAUksE,eAEb;AACP,cAAIG,IAASrsE,EAAUwrE,mBAAmBzlE,CAC1C;AAAA,UAAIklE,KACHoB,EAAOppE,KAAKjD,EAAUqM,IACtBrM,GAAAA,EAAU2rE,UAAUV,GAAQoB,GAAQtmE,CAAAA,KAG1B/F,EAAUmJ,UAAU,wBAAuB,CAACkjE,GAAQ7nE,GAAAA,IAAUuB,CAEvE/F,CAAAA,MAAAA,EAAU2rE,UAAUV,GAAQoB,GAAQtmE,CAAAA,GACpCklE;QAIF;AACD;MACA;AAAA,IACH;AAAA,EACA,GACAjrE,EAAU6qE,gBAEV;AAAA;ACvKe,SAAQyB,GAACtsE;AAExBA,IAAUwqE,oBAAoB+B,0BAA0B,WACvD;AAAA,QAcIC,GAdAlB,IAAatrE,EAAUwqE,oBAAoBc,YAE3CmB,IAAiB,SAASjoE;AAC7B,UAAIxE,EAAUM,OAAOwqE;AAErB,eAAOQ,EAAWmB,eAAejoE,CAAAA;AAAAA,IACnC,GAEKkoE,IAAe,WAClBpB;AAAAA,MAAAA,EAAWqB,mBAAmB,WAC7BrB;AAAAA,QAAAA,EAAWsB;MACd,CACA;AAAA,IAAA;AAGC5sE,MAAUsE,YAAY,gBAAgB,WACjCtE;AAAAA,QAAUM,OAAOwqE,WAChBQ,EAAWjrE,UAAgBL,KAAAA,CAAAA,EAAU4E,WAAWk/C,cAErDrlC,aAAa+tD,IACbA,IAAWv0D,WAAW,WACrB;AAAA,YAAGjY,EAAUkiB;AACZ;AAEGopD,QAAAA,EAAWjrE,eACdirE,EAAWuB,OAAAA,GACZC;MACH,CACA;AAAA,IAAA,CAAA;AAEC,QAAIA,IAAoB,WAAA;AACvB,UAAIxB,EAAWjrE,UAAAA,GAAf;AAGA,YAAI0sE,IAAazB,EAAWc,cACxBW;AAAAA,QAAAA,MAGAA,EAAWC,QAAAA,MACdD,IAAaA,EAAWnrC,cAGrBmrC,KAAcA,aAAsB/sE,EAAUwqE,oBAAoByC,iBAAiBF,aAAsB/sE,EAAUwqE,oBAAoB0C,eAG3I5B,EAAWqB,mBAAmB,WAAA;AAC7BI,UAAAA,EAAW1zC,MAAM,EAAA;AAAA,QACpB;MAfU;AAAA,IAgBV;AAsBC,aAAS8zC,EAAiB3oE,GAAAA;AACzB,UAAIxE,CAAAA,EAAUM,OAAOwqE;AAAS;AAE9B,YAAMpkE,IAAO1G,EAAUY,QAAAA;AACvB,UAAIwsE,IAAgB;AACpB,UAAIptE,EAAU4E,SAAAA,EAAWL,SAAS;AACjC6oE,QAAAA,IAAgBptE,EAAUwqE,oBAAoBlgD,UAAU9lB,EAAEE,UAAUF,EAAEoiB,YAAY5mB,EAAU8C,WAAW4d,cAAc,sBAAA,CAAA;AAAA,eAC3Gha,KAAQA,EAAK7F,WAAW;AAClCusE,QAAAA,IAAgBptE,EAAUwqE,oBAAoBlgD,UAAU9lB,EAAEE,UAAUF,EAAEoiB,YAAY5mB,EAAU8C,WAAW4d,cAAc;WAC/G;AACN,cAAM2sD,IAAertE,EAAU8C,WAAWC,iBAAiB,mBAAA;AAE3DqqE,QAAAA,IADoBvhE,MAAMgmB,KAAKw7C,CACHC,EAAAA,KAAKvK,CAAAA,MAASA,MAAUv+D,EAAEE,OAAO6G,UAC7D;AAAA,MAAA;AAED,UAEI2f,GAFAi6B,IAAMnlD,EAAU+E,cAAcP,CAAAA;AAG/BxE,QAAUolC,cAAc5gC,EAAEE,UAAUF,EAAEoiB,UAAAA,IACxCsE,IAAY,IAAIlrB,EAAUwqE,oBAAoB+C,MAAMvtE,EAAUolC,cAAc5gC,EAAEE,UAAUF,EAAEoiB,eAClFwmD,MACRliD,IAAY,IAAIlrB,EAAUwqE,oBAAoBgD,YAC3CroB,EAAInjD,QAAQorE,MACdliD,IAAYA,EAAUuiD,SAAS,IAAIztE,EAAUwqE,oBAAoBgD,SAASroB,EAAInjD,MAAM,MAAMmjD,EAAIngD,OAI7FkmB,CAAAA,KAAAA,MACGogD,EAAWjrE,UAIX8kD,IAAAA,EAAInjD,QAAQorE,KACf9B,EAAWltD,MAAM,WAAA;AAChBktD,QAAAA,EAAWoC,cAAcxiD;MAC/B,CANIogD,IAAAA,EAAWyB,aAAa7hD;AAAAA,IAU1B;AA3DDlrB,MAAUsE,YAAY,oBAAoB,WACzC;AAAA,UAAIkC,IAAYxG,EAAU8C;AAC1B9C,QAAUolB,YAAYxX,UAAU,WAAW6+D,CAAAA,GAC3CzsE,EAAUolB,YAAY5e,GAAW,aAAa2mE,CAAAA,GAC9CntE,EAAUolB,YAAY5e,GAAW,SAASkmE,CAAAA,GAGvC1sE,EAAUM,OAAOwqE,WAEnB9qE,EAAUI,MAAMwN,UAAU,WAAW6+D,CAAAA,GACrCzsE,EAAUI,MAAMoG,GAAW,aAAa2mE,CAAAA,GACxCntE,EAAUI,MAAMoG,GAAW,SAASkmE,CAEpClmE,GAAAA,EAAUuY,aAAa,YAAY,GAAA,KAGnCvY,EAAUmnE,gBAAgB,UAAA;AAAA,IAE7B;AAqEC,QAAI13D,IAAcjW,EAAUiW;AAC5BjW,MAAUiW,cAAc,SAAShT,GAChC;AAAA,UAAImE,IAAM6O,EAAY/J,MAAM5C,MAAM+I,SAClC;AAAA,UAAGrS,EAAUM,OAAOwqE,WAAWQ,EAAWjrE,UAAAA,KACtCL,EAAU4E,SAAAA,EAAWo/C,aAAa/gD,GAAG;AACvC,YAAIa,IAAU,IAAI9D,EAAUwqE,oBAAoB+C,MAAMtqE,CAElDjD;AAAAA,UAAU4E,SAAW4W,EAAAA,eAjC5B,SAAoBoyD,GACnB;AAAA,cAAI5tE,EAAUM,OAAOwqE,WACjBQ,EAAWjrE,UAAf,GAAA;AAGA,gBAAIwtE,IAAYD,GACZ1iD,IAAY,IAAIlrB,EAAUwqE,oBAAoB+C,MAAMM,EAAU9oD,OAAAA;AAClE,iBAAImG,EAAU8hD,QAAAA,GAAU;AACvB,kBAAIc,IAAY5iD,EAAUje,SAAS4gE,EAAU5gE,OACzC8gE,IAAU7iD,EAAUhe,OAAO2gE,EAAU3gE,KACrC8gE,IAAc9iD,EAAUlmB,WAAW6oE,EAAU7oE;AAAAA,eAEjDkmB,IAAY,IAAIlrB,EAAUwqE,oBAAoBgD,SAASM,GAAWC,GAASC,CAC7DhB,GAAAA,QAAAA,MACb9hD,IAAY,IAAIlrB,EAAUwqE,oBAAoBgD;AAAAA,YAE/C;AAEDlC,YAAAA,EAAWoC,cAAcxiD,CACzB;AAAA,gBAAI5E,IAAOglD,EAAWc,cAAAA;AACnB9lD,YAAAA,KAAQA,EAAK2nD,WAAWrgE,SAASmd,iBAAiBzE,EAAK2nD,QAAAA,KACzD3C,EAAWpgD,UAAUogD,EAAWc;UAnBE;AAAA,QAqBnC,EAWctoE,CAAAA;AAAAA,MAEZ;AAEF,aAAOsD;AAAAA,IACT,GAECpH,EAAUsE,YAAY,kBAAkB,SAASrB;AAChD,aAAIjD,EAAUM,OAAOwqE,WAClBQ,EAAWjrE,UACIirE,KAAAA,EAAWc,gBACdrnD,WAAW9hB,KACxBqoE,EAAWoC,cAAc,IAAI1tE,EAAUwqE,oBAAoBgD,UAG7D,GAAA;AAAA,IACF,CAECxtE,GAAAA,EAAUsE,YAAY,cAAc,WAAA;AACnC,WAAItE,EAAUM,OAAOwqE;AAAS,eAAA;AAC3BQ,MAAAA,EAAWjrE,eACVirE,EAAWc,cAAAA,aAA2BpsE,EAAUwqE,oBAAoB+C,SACtEjC,EAAWoC,cAAc,IAAI1tE,EAAUwqE,oBAAoBgD,UAG/D;AAAA,IAAA,CAAA;AAAA,EAEA;AAEA;AC/Ke,SAAShJ,GAAY3+D,GAAM0S,GAAMy1B;AAI/C,SAHK1kC,KAAK4kE,YACT5kE,KAAK4kE,UAAU,CAAA,IAET5kE;AACR;AAEAk7D,GAAY3mD,UAAU4mD,aAAa,SAAU5+D,GAAMsoE,GAClD7kE;AAAAA,OAAK4kE,QAAQroE,CAAAA,IAAQsoE;AACtB,GAEA3J,GAAY3mD,UAAUuwD,aAAa,SAAUvoE,GAAM0S,GAAMy1B;AACxD,SAAI1kC,KAAK4kE,QAAQroE,CACTyD,IAAAA,KAAK4kE,QAAQroE,CAAMA,EAAAA,GAAM0S,GAAMy1B,CAEnC1kC,IAAAA,KAAK4kE,QAAa,MACd5kE,KAAK4kE,QAAa,IAAEroE,GAAM0S,GAAMy1B,MAExCluC,OAAO0uC,MAAM,iBAAiBn8B,UAAU,CAAA,IAAK;AAAA,iBAAoBA,UAAU,CAAA,CAAA,GACpE;AACR;ACnBO,MAAMg8D,GAAAA;AAAAA,EAMZ,YAAYruE,GAAAA;AACXsJ,SAAKzF,MAAM,MACXyF,KAAKglE,WAAW,CAAA,GAChBhlE,KAAKtJ,YAAYA;AAAAA,EAClB;AAAA,EACA,aAAaI,GAAAA;AACZ,QAAIkJ,KAAKglE,YAAYhlE,KAAKglE,SAASnrE,SAAS;AAC3C,eAASD,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACzC,YAAI9C,EAAM6C,MAAMqG,KAAKglE,SAASprE,CAAG9C,EAAAA,MAAM6C,IAAI;AAC1C,cAAIsrE,IAAOjlE,KAAKnH,SAASqsE,sBAAsBllE,KAAKnH,SAASssE;AACzDruE,UAAAA,EAAMsuE,OAAOtuE,EAAMuuE,OACtBrlE,KAAKzF,IAAI+qE,UAAU,EAClBF,KAAKtuE,EAAMsuE,KACXC,KAAKvuE,EAAMuuE,IAAAA,CAAAA,GAEPrlE,KAAAzF,IAAIgrE,QAAQN,CAEjBjlE,MAAAA,KAAKzF,IAAI+qE,UAAU,EAClBF,KAAKplE,KAAKnH,SAAS2sE,eAAeJ,KAClCC,KAAKrlE,KAAKnH,SAAS2sE,eAAeH,IAAAA,CAAAA,GAE9BrlE,KAAAzF,IAAIgrE,QAAQN,KAEXQ,OAAAC,KAAK5uE,MAAM6uE,QAAQ3lE,KAAKglE,SAASprE,GAAGiwC,QAAQ,OAAA;AAAA,QACpD;AAAA;AAAA,EAGH;AAAA,EAEA,WAAW3sC,GAAwBZ,GAAAA;AAClC0D,SAAKnH,WAAWyD;AAChB,QAAI5F,IAAYsJ,KAAKtJ,WACjBkvE,IAAa,EAChBC,QAAQ,EAAET,KAAK9oE,EAAQwpE,iBAAiBV,KAAKC,KAAM/oE,EAAQwpE,iBAAiBT,IAC5EJ,GAAAA,MAAM3oE,EAAQ6oE,cACdY,OAAO7oE,EAAUvD,IACjBqsE,aAAAA,IACAC,WAAW3pE,EAAQC,KAAAA;AAGhB,QAAAyD,KAAKzF,QAAQ;AAChByF,WAAKzF,MAAM,IAAIkrE,OAAOC,KAAKQ,IAAIhpE,GAAW0oE,CAEtC;AAAA,SAAA;AACJ,UAAIrrE,IAAMyF,KAAKzF;AACf2C,MAAAA,EAAUuH,YAAYzE,KAAKzF,IAAI4rE,KAAKC,cACpClpE,GAAAA,EAAUuH,YAAYzE,KAAKzF,IAAI4rE,KAAKE,cAAAA,GACpC13D,WAAW,WACVpU;AAAAA,QAAAA,EAAI+rE,WAAW,EAACppE,WAAWA,EAAUvD,GAAAA,CAAAA;AAAAA,SACnC,GAAA;AAAA,IACJ;AACA8rE,WAAOC,KAAK5uE,MAAMyvE,YAAYvmE,KAAKzF,KAAK,YAAY,SAASzD;AAC5D,YAAM0vE,IAAW,IAAIf,OAAOC,KAAKe;AAEjC,UAAK/vE,CAAAA,EAAUM,OAAOy6B,YAAY/6B,EAAUM,OAAOsT,iBAAiB;AACnE,YAAIo8D,IAAQ5vE,EAAM6vE;AACTH,QAAAA,EAAAI,QACR,EAAED,QAAUD,EACZ,GAAA,SAASG,GAASp3D,GAAAA;AACbA,UAAAA,KAAUg2D,OAAOC,KAAKoB,eAAeC,MAChCL,IAAAG,EAAQ,CAAA,EAAGG,SAAS54D,UAC5B1X,EAAU6T,YAAY,EACrB66D,KAAKsB,EAAMtB,OACXC,KAAKqB,EAAMrB,OACX4B,gBAAgBJ,EAAQ,GAAGK,mBAC3BjvE,YAAYvB,EAAU4E,SAAAA,EAAW5C,MACjCR,UAAUxB,EAAUgC,KAAKC,IAAIjC,EAAU4E,SAAW5C,EAAAA,MAAMhC,EAAUM,OAAOq6B,WAAW,QAG7EhmB,EAAAA,CAAAA,KAAAA,QAAAC,MAAM,0DAA0DmE;QAE1E,CAEF;AAAA,MAAA;AAAA,IAAA;EAEF;AAAA,EAEA,QAAQvS,GAIP;AAAA,SAHOuoE,OAAAC,KAAK5uE,MAAMqwE,uBAAuB5wE,SAClCkvE,OAAAC,KAAK5uE,MAAMqwE,uBAAuB7iE,QAAAA,GAClCmhE,OAAAC,KAAK5uE,MAAMqwE,uBAAuBjqE,CAAAA,GAClCA,EAAUyJ;AAChBzJ,MAAAA,EAAUyJ,WAAWoa,OAAAA;AAEtB7jB,IAAAA,EAAUsH,YAAY;AAAA,EACvB;AAAA,EAEA,MAAM4iE,eAAetwE,GACpB;AAAA,QAAIE,IAAS,EACZu+B,OAAOz+B,EAAMoc,MACbzR,UAAU,CAAC,GACXlH,KAAK,CAAC,EAAA;AAGHzD,IAAAA,EAAMsuE,OAAOtuE,EAAMuuE,MACtBruE,EAAOyK,WAAW,EAAE2jE,KAAKtuE,EAAMsuE,KAAKC,KAAKvuE,EAAMuuE,IAAAA,IAExCruE,EAAAyK,WAAW,EAAE2jE,KAAKplE,KAAKnH,SAAS2sE,eAAeJ,KAAKC,KAAKrlE,KAAKnH,SAAS2sE,eAAeH,IAAAA;AAE9F,UAAMgC,EAAAA,uBAAEA,EAAgC5B,IAAAA,MAAAA,OAAOC,KAAK4B,cAAc,QAAA;AAC9D,QAAAz9B;AACA7pC,SAAKtJ,UAAU6c,IAAIg0D,QAAQC,gBAC9BxwE,EAAOuD,MAAMyF,KAAKzF,KAClBsvC,IAAS7pC,KAAKtJ,UAAU6c,IAAIg0D,QAAQC,aAAaxwE,CAExC6yC,MAAAA,IAAA,IAAIw9B,EAAsBrwE,CACnC6yC,GAAAA,EAAOtvC,MAAMyF,KAAKzF,MAEZsvC,EAAA49B,OAAOznE,KAAKzF,MAEfzD,EAAM,sBACT+yC,KADoC,kBACpCA,EAAO49B,OAAO,IAAA,GAEfhC,OAAOC,KAAK5uE,MAAMyvE,YAAY18B,GAAQ,SAAS;AAC1C7pC,WAAK0nE,cACR1nE,KAAK0nE,WAAWv5D,MAEZnO,GAAAA,KAAA0nE,aAAa,IAAIjC,OAAOC,KAAKiC,WAAW,EAACC,UAAU5nE,KAAKnH,SAASgvE,0BACtE7nE,KAAK0nE,WAAWI,WAAW9nE,KAAKtJ,UAAUya,UAAU42D,iBAAiBjxE,CAAAA,CAAAA,GACrEkJ,KAAK0nE,WAAWza,KAAK,EACpB+a,QAAQn+B,GACRtvC,KAAKyF,KAAKzF,IACV,CAAA;AAAA,IAAA,CAAA;AAEF,QAAI0tE,IAAa,EAACnxE,aAAUE,GAAQ6yC,QAAAA,EAAAA;AAC/B7pC,SAAAglE,SAAS3rE,KAAK4uE,CAAAA;AAAAA,EACpB;AAAA,EAEA,kBAAkBxsD;AACjB,aAAS7hB,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACrC6hB,MAAAA,KAAWzb,KAAKglE,SAASprE,GAAG9C,MAAM6C,OACrCqG,KAAKglE,SAASprE,CAAAA,EAAGiwC,OAAOq+B,WAAAA,EACxBloE,GAAAA,KAAKglE,SAASprE,CAAGiwC,EAAAA,OAAO49B,OAAO,IAC/BznE,GAAAA,KAAKglE,SAASprE,CAAGiwC,EAAAA,OAAOs+B,YAAY,IAAA,GAC/BnoE,KAAAglE,SAASprE,GAAGiwC,SAAS,MACrB7pC,KAAAglE,SAAS98D,OAAOtO,GAAE,CACvBA,GAAAA;AAAAA,EAGH;AAAA,EAEA,kBAAkB9C,GAAAA;AACjB,aAAS8C,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACzC,UAAGoG,KAAKglE,SAASprE,CAAAA,EAAG9C,MAAM6C,MAAM7C,EAAM6C,IAAI;AACpCqG,aAAAglE,SAASprE,CAAG9C,EAAAA,QAAQA,GACzBkJ,KAAKglE,SAASprE,GAAG6H,SAAS2jE,MAAMtuE,EAAMsuE,KACtCplE,KAAKglE,SAASprE,CAAG6H,EAAAA,SAAS4jE,MAAMvuE,EAAMuuE,KACtCrlE,KAAKglE,SAASprE,CAAGsZ,EAAAA,OAAOpc,EAAMoc;AAC1B,YAAAk1D,IAAS,IAAI3C,OAAOC,KAAK2C,OAAOvxE,EAAMsuE,KAAKtuE,EAAMuuE,GACrDrlE;AAAAA,aAAKglE,SAASprE,CAAGiwC,EAAAA,OAAOs+B,YAAYC,CACrC;AAAA,MAAA;AAAA,EAEF;AAAA,EAEA,oBACK;AAAA,QAAApoE,KAAKglE,SAASnrE,SAAS,GAAG;AAC7B,eAASD,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACzCoG,aAAKglE,SAASprE,GAAGiwC,OAAO49B,OAAO;AAEhCznE,WAAKglE,WAAW,CACjB;AAAA,IAAA;AAAA,EACD;AAAA,EAEA,QAAQsD,GAAkBC,GAAmBtD;AAC5CjlE,SAAKzF,IAAI+qE,UAAU,EAClBF,KAAKkD,GACLjD,KAAKkD,EAEDvoE,CAAAA,GAAAA,KAAAzF,IAAIgrE,QAAQN,CAAAA;AAAAA,EAClB;AAAA,EAEA,MAAMuD,eAAeC;AACpB,UAAMjC,IAAW,IAAIf,OAAOC,KAAKe;AAiB1B,iBAhBmB,IAAIn3D,QAASI;AAC7B82D,QAAAI,QACR,EAAE8B,SAAWD,EAAAA,GACb,SAAS5B,GAASp3D,GAAAA;AACbA,QAAAA,KAAUg2D,OAAOC,KAAKoB,eAAeC,KAChCr3D,EAAA,EACP01D,KAAKyB,EAAQ,CAAGG,EAAAA,SAAS54D,SAASg3D,IAAAA,GAClCC,KAAKwB,EAAQ,CAAA,EAAGG,SAAS54D,SAASi3D,IAAAA,EAAAA,CAAAA,KAG3Bh6D,QAAAC,MAAM,0DAA0DmE,CACxEC,GAAAA,EAAQ,CAAE,CAAA;AAAA,MAEZ;IACD,CAGF;AAAA,EAAA;AAAA;ACnMM,MAAMi5D,GAKZ;AAAA,EAAA,YAAYjyE,GACXsJ;AAAAA,SAAKzF,MAAM,MACXyF,KAAKglE,WAAW,IAChBhlE,KAAKtJ,YAAYA;AAAAA,EAClB;AAAA,EACA,aAAaI,GACZ;AAAA,QAAIkJ,KAAKglE,YAAYhlE,KAAKglE,SAASnrE,SAAS;AAC3C,eAASD,IAAI,GAAGA,IAAKoG,KAAKglE,SAASnrE,QAAQD;AACtC9C,QAAAA,EAAM6C,MAAOqG,KAAKglE,SAASprE,CAAAA,EAAG9C,MAAM6C,OACvCqG,KAAKglE,SAASprE,CAAGiwC,EAAAA,OAAO++B,UACxB5oE,GAAAA,KAAKglE,SAASprE,CAAAA,EAAGiwC,OAAOg/B,aACpB/xE,GAAAA,EAAMsuE,OAAOtuE,EAAMuuE,MACjBrlE,KAAA8oE,QAAQhyE,EAAMsuE,KAAKtuE,EAAMuuE,KAAKrlE,KAAKnH,SAASqsE,sBAAsBllE,KAAKnH,SAASssE,YAErFnlE,IAAAA,KAAK8oE,QAAQ9oE,KAAKnH,SAAS2sE,eAAeJ,KAAKplE,KAAKnH,SAAS2sE,eAAeH,KAAKrlE,KAAKnH,SAASqsE,sBAAsBllE,KAAKnH,SAASssE,YAKxI;AAAA,EAAA;AAAA,EAEA,WAAWjoE,GAAwBZ,GAAAA;AAClC,QAAI5F,IAAYsJ,KAAKtJ,WACjBqyE,IAAazkE,SAASC,cAAc,KACxCwkE;AAAAA,IAAAA,EAAWvjE,YAAY,cACvBujE,EAAWpvE,KAAK,cACLovE,EAAApxE,MAAM+N,QAAQxI,EAAUvF,MAAM+N,OAC9BqjE,EAAApxE,MAAM8N,SAASvI,EAAUvF,MAAM8N,QAC1CvI,EAAUuH,YAAYskE,CAAAA;AAElB,QAAAxuE,IAAMyuE,EAAEzuE,IAAIwuE,GAAY,EAC3BlD,QAAQmD,EAAErC,OAAOrqE,EAAQwpE,iBAAiBV,KAAK9oE,EAAQwpE,iBAAiBT,GACxEJ,GAAAA,MAAM3oE,EAAQ6oE,cACdhiC,UAAAA,GAED6lC,CAAAA;AAAAA,MAAEC,UAAU,mDAAA,EAAqDC,MAAM3uE,CACnEA,GAAAA,EAAAuW,GAAG,YAAYw6C,eAAepwD;AAOjC,UAAIiuB,IAAAA,MAAiBzb,MAAM,mDAAmDxS,EAAEktE,OAAOhD,WAAWlqE,EAAEktE,OAAO/C,mBAN1F,EAChB73D,QAAU,OACVD,SAAS,EACR,mBAAoB,KAAA,EAAA,CAAA,EAGkHI,KAAKwb,CAAAA,MAAYA,EAASvb,KAClK,CAAA;AAAA,UAAIub,EAASu/C,SAAS;AACjB,YAAAA,IAAUv/C,EAASu/C,QAAQS;AAC/BzyE,UAAU6T,YAAY,EACrB66D,KAAKlqE,EAAEktE,OAAOhD,KACdC,KAAKnqE,EAAEktE,OAAO/C,KACd4B,gBAAgByB,GAChBzwE,YAAYvB,EAAU4E,SAAW5C,EAAAA,MACjCR,UAAUxB,EAAUgC,KAAKC,IAAIjC,EAAU4E,SAAAA,EAAW5C,MAAMhC,EAAUM,OAAOq6B,WAAW;MACpF;AAEOhmB,gBAAAC,MAAM,0CAA0C6d,EAAS7d;IAClE,CAEDtL,GAAAA,KAAKzF,MAAMA,GACXyF,KAAKnH,WAAWyD;AAAAA,EACjB;AAAA,EAEA,QAAQY,GAEP;AAAA,SADA8C,KAAKzF,IAAIwmB,OAAAA,GACF7jB,EAAUyJ;AAChBzJ,MAAAA,EAAUyJ,WAAWoa;AAEtB7jB,IAAAA,EAAUsH,YAAY;AAAA,EACvB;AAAA,EAEA,eAAe1N,GACR;AAAA,UAAAsyE,IAASJ,EAAEpuB,KAAK,EACrByuB,SAAS,+DACTC,UAAc,CAAC,IAAI,EAAA,GACnBC,YAAc,CAAC,IAAI,EACnBC,GAAAA,YAAc,CAAC,IAAI,KACnBC,cAAc,CAAC,GAAG,EAEnB,EAAA,CAAA;AAAA,QAAIC,IAAc,EACjBC,UAAU,KACV/B,UAAU5nE,KAAKnH,SAASgvE;AAEnB,UAAA+B,IAAcZ,EAAEa,MAAMH,CAAAA,EAAa5B,WAAW9nE,KAAKtJ,UAAUya,UAAU42D,iBAAiBjxE,CACxFgzE,CAAAA,GAAAA,IAAUd,EAAEc,QAAUhC,EAAAA,WAAWhxE,EAAMoc,IAE7C;AAAA,QAAI62D,IAAe,CAClBjzE,EAAMsuE,KACNtuE,EAAMuuE,GAGFvuE;AAAAA,IAAAA,EAAMsuE,OAAQtuE,EAAMuuE,QACT0E,IAAA,CAAC/pE,KAAKnH,SAAS2sE,eAAeJ,KAAKplE,KAAKnH,SAAS2sE,eAAeH,GAAAA;AAE1E,UAGA4C,IAAa,EAACnxE,UAAO+yC,QAHZm/B,EAAEn/B,OAAOkgC,GAAc,EACrCnvB,MAAMwuB,EAAAA,CAAAA,EACJY,UAAUJ,CAAAA,EAAaK,YAAYH,CAASZ,EAAAA,MAAMlpE,KAAKzF,GAErDyF,EAAAA;AAAAA,SAAAglE,SAAS3rE,KAAK4uE,CAAAA;AAAAA,EACpB;AAAA,EAEA,kBAAkBxsD,GAAAA;AACjB,aAAS7hB,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACrC6hB,MAAAA,KAAWzb,KAAKglE,SAASprE,CAAAA,EAAG9C,MAAM6C,OACrCqG,KAAKzF,IAAI2vE,YAAYlqE,KAAKglE,SAASprE,CAAGiwC,EAAAA,MAAAA,GACjC7pC,KAAAglE,SAAS98D,OAAOtO,GAAE,IACvBA;AAAAA,EAGH;AAAA,EAEA,kBAAkB9C,GAAAA;AACjB,aAAS8C,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACtCoG,WAAKglE,SAASprE,CAAG9C,EAAAA,MAAM6C,MAAM7C,EAAM6C,OAChCqG,KAAAglE,SAASprE,CAAAA,EAAG9C,QAAQA,GACpBA,EAAMsuE,OAAQtuE,EAAMuuE,MAGnBrlE,KAAAglE,SAASprE,CAAAA,EAAGiwC,OAAOsgC,UAAU,CAACrzE,EAAMsuE,KAAKtuE,EAAMuuE,GAAAA,CAAAA,IAFpDrlE,KAAKglE,SAASprE,CAAAA,EAAGiwC,OAAOsgC,UAAU,CAACnqE,KAAKnH,SAAS2sE,eAAeJ,KAAKplE,KAAKnH,SAAS2sE,eAAeH;EAMtG;AAAA,EAEA;AACC,QAAGrlE,KAAKglE,UAAU;AACjB,eAASprE,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACzCoG,aAAKzF,IAAI2vE,YAAYlqE,KAAKglE,SAASprE,CAAAA,EAAGiwC;AAEvC7pC,WAAKglE,WAAW;IACjB;AAAA,EACD;AAAA,EAEA,QAAQsD,GAAkBC,GAAmBtD,GAAAA;AAC5CjlE,SAAKzF,IAAIuuE,QAAQ,CAACR,GAAUC,IAAYtD,CACzC;AAAA,EAAA;AAAA,EAEA,qBAAqBwD,GAAAA;AAOpB,QAAIhnE,IAAe,CAAA,GACf0nB,UAAiBzb,MAAM,gDAAgD+6D,iBAP1D,EAChBj7D,QAAU,OACVD,SAAS,EACR,mBAAoB,KAAA,EAAA,CAAA,EAIqFI,KAAKwb,CAAAA,MAAYA,EAASvb,KAO9H,CAAA;AAAA,WANHub,KAAYA,EAAStvB,UACxB4H,EAAS2jE,MAAOj8C,CAAAA,EAAS,CAAGi8C,EAAAA,KAC5B3jE,EAAS4jE,MAAAA,CAAOl8C,EAAS,CAAGihD,EAAAA,OAEpB/+D,QAAAC,MAAM,sDAAsDm9D,MAE9DhnE;AAAAA,EACR;AAAA;AC3JM,MAAM4oE,GAAAA;AAAAA,EAKZ,YAAY3zE;AACXsJ,SAAKzF,MAAM,MACXyF,KAAKglE,WAAW,IAChBhlE,KAAKtJ,YAAYA;AAAAA,EAClB;AAAA,EACA,aAAaI;AACZ,QAAIkJ,KAAKglE,YAAYhlE,KAAKglE,SAASnrE,SAAS;AAC3C,eAASD,IAAI,GAAGA,IAAKoG,KAAKglE,SAASnrE,QAAQD,KAAK;AACnC,cAAMiwE,IAAQ7pE,KAAKglE,SAASprE,CAAGiwC,EAAAA,OAAOygC,SAClCT;AAAAA,UAAMU,YACNV,EAAM9oD,OAAAA,GAElBjqB,EAAM6C,MAAOqG,KAAKglE,SAASprE,CAAG9C,EAAAA,MAAM6C,OACvCqG,KAAKglE,SAASprE,CAAAA,EAAGiwC,OAAO2gC,YACpB1zE,GAAAA,EAAMsuE,OAAOtuE,EAAMuuE,MACjBrlE,KAAA8oE,QAAQhyE,EAAMsuE,KAAKtuE,EAAMuuE,KAAKrlE,KAAKnH,SAASqsE,sBAAsBllE,KAAKnH,SAASssE,YAErFnlE,IAAAA,KAAK8oE,QAAQ9oE,KAAKnH,SAAS2sE,eAAeJ,KAAKplE,KAAKnH,SAAS2sE,eAAeH,KAAKrlE,KAAKnH,SAASqsE,sBAAsBllE,KAAKnH,SAASssE,YAGtI;AAAA,MAAA;AAAA,EAEF;AAAA,EAEA,WAAWjoE,GAAwBZ,GAC5B;AAAA,QAAI5F,IAAYsJ,KAAKtJ;AAE3B+zE,aAASC,cAAcpuE,EAAQouE;AACnB,UAAAnwE,IAAM,IAAIkwE,SAASvE,IAAI,EACzBhpE,cACA2oE,QAAQ,CAACvpE,EAAQwpE,iBAAiBT,KAAK/oE,EAAQwpE,iBAAiBV,GAChEH,GAAAA,MAAO3oE,EAAQ6oE,eAAe,EAAA,CAAA;AAE9B5qE,IAAAA,EAAAuW,GAAG,YAAWw6C,eAAepwD,GAClC;AAAA,UAAAiuB,IAAiBzb,MAAAA,MAAM,qDAAqDxS,EAAEyvE,OAAOtF,GAAQnqE,IAAAA,EAAEyvE,OAAOvF,GAAyB9oE,sBAAAA,EAAQouE,eAAe/8D,KAAKwb,CAAAA,MAAYA,EAASvb,KAAAA,CAAAA;AACpL,UAAIub,EAASyhD,UAAS;AACrB,YAAIlC,IAAUv/C,EAASyhD,SAAS,GAAGC;AACnCn0E,UAAU6T,YAAY,EACrB66D,KAAKlqE,EAAEyvE,OAAOvF,KACdC,KAAKnqE,EAAEyvE,OAAOtF,KACd4B,gBAAgByB,GAChBzwE,YAAYvB,EAAU4E,SAAAA,EAAW5C,MACjCR,UAAUxB,EAAUgC,KAAKC,IAAIjC,EAAU4E,SAAW5C,EAAAA,MAAMhC,EAAUM,OAAOq6B,WAAW,QACpF,EAAA,CAAA;AAAA,MAAA;AAEDhmB,gBAAQC,MAAM;IACf,CAEKtL,GAAAA,KAAKzF,MAAMA,GACXyF,KAAKnH,WAAWyD;AAAAA,EACvB;AAAA,EAEA,QAAQY,GAAAA;AAED,SADN8C,KAAKzF,IAAIwmB,UACI7jB,EAAUyJ;AACtBzJ,MAAAA,EAAUyJ,WAAWoa,OAAAA;AAEhB7jB,IAAAA,EAAUsH,YAAY;AAAA,EAC7B;AAAA,EAEA,eAAe1N,GAAAA;AACR,QAAIE,IAAS,CAClBF,EAAMuuE,KACNvuE,EAAMsuE,GAGFtuE;AAAAA,IAAAA,EAAMsuE,OAAQtuE,EAAMuuE,QACfruE,IAAA,CAACgJ,KAAKnH,SAAS2sE,eAAeH,KAAKrlE,KAAKnH,SAAS2sE,eAAeJ,GAAAA;AAGpE,UAAAyE,IAAQ,IAAIY,SAASK,MAAM,EAAE7iE,QAAQ,IAAI8iE,mBACpCC,CAAAA,EAAAA,YAAY,GAAGhrE,KAAKnH,SAASgvE,qBAAAA,IAAAA,EAC7BoD,QAAQjrE,KAAKtJ,UAAUya,UAAU42D,iBAAiBjxE,CAAAA,CAAAA,GAKjDmxE,IAAa,EAACnxE,OAAAA,GAAO+yC,QAJZ,IAAI4gC,SAASS,SACvBC,UAAUn0E,CACVo0E,EAAAA,SAASvB,GACTX,MAAMlpE,KAAKzF;AAEXyF,SAAAglE,SAAS3rE,KAAK4uE,CAAAA;AAAAA,EAC1B;AAAA,EAEA,kBAAkBxsD,GACjB;AAAA,aAAS7hB,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACrC6hB,MAAAA,KAAWzb,KAAKglE,SAASprE,CAAG9C,EAAAA,MAAM6C,OACrCqG,KAAKglE,SAASprE,GAAGiwC,OAAO9oB,OAAAA,GACP/gB,KAAAglE,SAAS98D,OAAOtO,GAAE,CACnCA,GAAAA;AAAAA,EAGH;AAAA,EAEA,kBAAkB9C;AACjB,aAAS8C,IAAI,GAAGA,IAAIoG,KAAKglE,SAASnrE,QAAQD;AACtCoG,WAAKglE,SAASprE,CAAAA,EAAG9C,MAAM6C,MAAM7C,EAAM6C,OAChCqG,KAAAglE,SAASprE,CAAAA,EAAG9C,QAAQA,GACpBA,EAAMsuE,OAAQtuE,EAAMuuE,MAGnBrlE,KAAAglE,SAASprE,CAAAA,EAAGiwC,OAAOshC,UAAU,CAACr0E,EAAMuuE,KAAKvuE,EAAMsuE,GAAAA,CAAAA,IAFpDplE,KAAKglE,SAASprE,CAAAA,EAAGiwC,OAAOshC,UAAU,CAACnrE,KAAKnH,SAAS2sE,eAAeH,KAAKrlE,KAAKnH,SAAS2sE,eAAeJ;EAMtG;AAAA,EAEA;AACC,aAASxrE,IAAI,GAAGA,IAAGoG,KAAKglE,SAASnrE,QAAQD;AACxCoG,WAAKglE,SAASprE,CAAAA,EAAGiwC,OAAO9oB,OAEzB/gB;AAAAA,SAAKglE,WAAW,CAAA;AAAA,EACjB;AAAA,EAEA,QAAQsD,GAAkBC,GAAmBtD;AAC5CjlE,SAAKzF,IAAI+qE,UAAU,CAACiD,GAAWD,CACpBtoE,CAAAA,GAAAA,KAAAzF,IAAIgrE,QAAQN;EACxB;AAAA,EAEA,MAAA,eAAqBwD,GACpB;AAAA,QAAIt/C,UAAiBzb,MAAM,qDAAqD+6D,CAA4BzoE,sBAAAA,KAAKnH,SAAS6xE,WAAAA,EAAAA,EAAe/8D,KAAKwb,CAAAA,MAAYA,EAASvb,SAC/JnM,IAAe,CAAA;AAOZ,WANH0nB,KAAYA,EAASyhD,SAAS/wE,UACjC4H,EAAS4jE,MAAMl8C,EAASyhD,SAAS,GAAG/E,OAAO,CAAA,GAC3CpkE,EAAS2jE,MAAMj8C,EAASyhD,SAAS,CAAA,EAAG/E,OAAO,CAAA,KAEnCx6D,QAAAC,MAAM,sDAAsDm9D,MAE9DhnE;AAAAA,EACR;AAAA;ACrIM,IAAI4pE,KAAe,CACtB,MACA,MACA,MACA,MACA,MACA,MACA,IAAA,GAEAC,KAAyB,WACzB;AAAA,WAASA,EAAQC,GAAS5vE,GAAAA;AACtB,QAAIA,MAAM;AACN,YAAM,IAAIoL,MAAM,kCAAA;AACpB/G,SAAKurE,UAAUA,GACfvrE,KAAKrE,IAAIA;AAAAA,EACZ;AAuBD,SAtBA2vE,EAAQE,UAAU,SAAU7uD,GACxB;AAAA,WAAO,IAAI2uD,EAAQD,GAAaxkE,QAAQ8V,CAChD,CAAA;AAAA,EAAA,GAGI2uD,EAAQ/2D,UAAUk3D,MAAM,SAAU9vE;AAC9B,WAAOqE,KAAKrE,MAAMA,IAAIqE,OAAO,IAAIsrE,EAAQtrE,KAAKurE,SAAS5vE,CAAAA;AAAAA,EAC/D,GAEI2vE,EAAQ/2D,UAAUm3D,SAAS,SAAUC;AACjC,WAAO3rE,KAAKurE,YAAYI,EAAMJ,WAAWvrE,KAAKrE,MAAMgwE,EAAMhwE;AAAAA,EAClE,GAEI2vE,EAAQ/2D,UAAUzE,WAAW,WAAA;AACzB,QAAIhT,IAAIuuE,GAAarrE,KAAKurE,OAAAA;AAG1B,WAFIvrE,KAAKrE,MACLmB,KAAKkD,KAAKrE,IAAI,IAAI,MAAM,MAAMvB,OAAO4F,KAAKrE,CAAKmB,IAAAA,IAC5CA;AAAAA,EACf,GACIwuE,EAAQ/2D,UAAUq3D,eAAe;AAC7B,WAAO5rE,KAAKurE,YAAY,IAAI,IAAIvrE,KAAKurE,UAAU;AAAA,EACvD,GACWD;AACX,KCtCWO,IAAY,SAAU38D,GAAAA;AAC7B,SACJ,KADWA;AACX,GACW48D,KAAW,SAAU58D,GAC5B;AAAA,gBAAcA,KAAU;AAC5B,GACW68D,KAAe,SAAU78D,GAAAA;AAChC,SAAcA,OAAAA,KAAU,YAAYm8D,GAAaW,SAAS98D,CAC9D;AAAA,GACWkF,KAAU7R,MAAM6R,SAIhByc,KAAQ,SAAUltB,GAAOC;EAC5BA,iBAAkBA,IAAMD,IACxBoF,UAAUlP,WAAW,MACrB+J,IAAMD,GACNA,IAAQ;AAGZ,WADIsoE,IAAO,CAAA,GACFryE,IAAI+J,GAAO/J,IAAIgK,GAAKhK;AACzBqyE,IAAAA,EAAK5yE,KAAKO;AACd,SAAOqyE;AACX,GAIWC,IAAS,SAAUh9D,GAAOi9D,GAAAA;AACjC,MAAIvyE,IAAI,GACJu0B,IAAQ,CAAA;AACZ,MAAI/Z,GAAQlF,CAAAA;AACR,WAAOtV,IAAIuyE,GAAOvyE;AACdu0B,MAAAA,EAAMv0B,CAAK,IAAA,CAAA,EAAGuG,OAAO+O,CAGzB;AAAA;AAAA,WAAOtV,IAAIuyE,GAAOvyE;AACdu0B,MAAAA,EAAMv0B,CAAKsV,IAAAA;AAEnB,SAAOif;AACX;AAOO,SAASi+C,GAAS3/B,GAAM4/B,GAAcC;EACrCA,iBAAwBA,IAAY;AACxC,MAAI3vD,IAAMviB,OAAOqyC,CAEjB;AAAA,SADA4/B,KAA+B,GAC3B1vD,EAAI9iB,SAASwyE,IACNjyE,OAAOuiB,OAElB0vD,KAA8B1vD,EAAI9iB,UACfyyE,EAAUzyE,WACzByyE,KAAaJ,EAAOI,GAAWD,IAAeC,EAAUzyE,MAErDyyE,IAAAA,EAAU7pE,MAAM,GAAG4pE,CAAAA,IAAgBjyE,OAAOuiB,CAAAA;AACrD;AAIO,IAqBI4vD,KAAQ,SAAU1zD,GAAGC;AAC5B,MAAIrK,IAAIoK,IAAIC;AAEZ,SAAOrK,IAAIqK,IAAI,IAAIrK,IAAIqK,IAAIrK;AAC/B,GAIW+9D,KAAS,SAAU3zD,GAAGC;AAC7B,SAAO,EAAE/W,KAAK+D,KAAK+D,MAAMgP,IAAIC,IAAI2zD,KAAKF,GAAM1zD,GAAGC,CACnD,EAAA;AAAA,GACW4zD,KAAQ,SAAUtzE,GAAAA;AACzB,UAAQyyE,EAAUzyE,CAAAA,KAAQA,EAAIS,WAAW;AAC7C,GAQW8yE,KAAW,SAAUvzE;AAC5B,SAAQszE,CAAAA,GAAMtzE,CAClB;AAAA,GAIW4yE,IAAW,SAAU5hD,GAAK4b,GACjC;AAAA,SAAO2mC,GAASviD,CAA8B,KAAtBA,EAAIvjB,QAAQm/B,CAAAA,MAAU;AAClD,GCnHW4mC,KAAW,SAAU7qD,GAAGy3C,GAAGnxD,GAAGiQ,GAAG1e,GAAGkD,GAI3C;AAAA,SAHIwb,MAGJ,WAHoBA,IAAI,IACpB1e,MAAM,WAAUA,IAAI,IACpBkD,iBAAgBA,IAAI,IACjB,IAAI5D,KAAKA,KAAKqrB,IAAIxC,GAAGy3C,IAAI,GAAGnxD,GAAGiQ,GAAG1e,GAAGkD,CAAAA,CAAAA;AAChD,GAMW+vE,KAAa,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAI1DC,GAAAA,KAAU,OAUVC,KAAeH,GAAS,MAAM,GAAG,CAKjCI,GAAAA,KAAc,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CASjCC,GAAAA,KAAa,SAAU12C,GAAAA;AAC9B,SAAQA,IAAO,KAAM,KAAKA,IAAO,OAAQ,KAAMA,IAAO,OAAQ;AAClE,GACW5iB,KAAS,SAAUzE,GAC1B;AAAA,SAAOA,aAAiBhW;AAC5B,GACWg0E,KAAc,SAAUh+D,GAAAA;AAC/B,SAAOyE,GAAOzE,CAAAA,KAAAA,CAAW8O,MAAM9O,EAAMgW,QACzC,CAAA;AAAA,GAuBWioD,KAAY,SAAUz0E,GAAAA;AAC7B,SAdsC00E,IAcbL,IARrBM,IAQe30E,EAXCwsB,QAAAA,IACNkoD,EAAMloD,QAAAA,GAIbpf,KAAKM,MAAMinE,IAAeP,EARZ;AAAA,MAAiBM,GAMlCC;AASR,GAIWC,KAAc,SAAUC,GAAAA;AAC/B,SAAO,IAAIr0E,KAAK6zE,GAAa7nD,YAAYqoD,IAAUT,EAAAA;AACvD,GACWU,KAAe,SAAU90E;AAChC,MAAI49B,IAAQ59B,EAAK4tB,YAAAA;AACjB,SAAOgQ,MAAU,KAAK22C,GAAWv0E,EAAK6tB,oBAChC,KACAsmD,GAAWv2C;AACrB,GAIWm3C,KAAa,SAAU/0E,GAAAA;AAC9B,SAAOs0E,GAAYt0E,EAAK+tB,UAC5B,CAAA;AAAA,GAIWinD,KAAa,SAAUn3C,GAAMD;AACpC,MAAI59B,IAAOk0E,GAASr2C,GAAMD,IAAQ,GAAG;AACrC,SAAO,CAACm3C,GAAW/0E,CAAO80E,GAAAA,GAAa90E;AAC3C,GAIWi1E,KAAU,SAAUj1E,GAAMm3B,GAEjC;AAAA,SADAA,IAAOA,KAAQn3B,GACR,IAAIQ,KAAKA,KAAKqrB,IAAI7rB,EAAK6tB,eAAAA,GAAkB7tB,EAAK4tB,YAAe5tB,GAAAA,EAAK2tB,cAAcwJ,EAAKhvB,SAAAA,GAAYgvB,EAAK1tB,WAAc0tB,GAAAA,EAAK/I,cAAc+I,EAAK+9C,gBAAAA,CAAAA,CAAAA;AACvJ,GACW5O,KAAQ,SAAUtmE,GAAAA;AAEzB,SADY,IAAIQ,KAAKR,EAAKwsB,QAE9B,CAAA;AAAA,GACW2oD,KAAa,SAAUhqE,GAAAA;AAE9B,WADIiqE,IAAS,CAAA,GACJl0E,IAAI,GAAGA,IAAIiK,EAAMhK,QAAQD;AAC9Bk0E,IAAAA,EAAOz0E,KAAK2lE,GAAMn7D,EAAMjK,CAAAA,CAAAA,CAAAA;AAE5B,SAAOk0E;AACX,GAIWxsD,KAAO,SAAUzd;AACxBA,IAAMyd,KAAK,SAAUzI,GAAGC,GAAAA;AACpB,WAAOD,EAAEqM,QAAYpM,IAAAA,EAAEoM;EAC/B,CACA;AAAA,GACW6oD,KAAoB,SAAUl+C,GAAMhM;EACvCA,iBAAkBA,IAAM;AAC5B,MAAInrB,IAAO,IAAIQ,KAAK22B,CAAAA;AACpB,SAAO,CACHu8C,GAAS1zE,EAAK6tB,eAAiBzW,EAAAA,SAAAA,GAAY,GAAG,GAAA,GAC9Cs8D,GAAS1zE,EAAK4tB,gBAAgB,GAAG,GAAG,MACpC8lD,GAAS1zE,EAAK2tB,cAAc,GAAG,GAAA,GAC/B,KACA+lD,GAAS1zE,EAAKiuB,YAAAA,GAAe,GAAG,GAChCylD,GAAAA,GAAS1zE,EAAKkuB,cAAiB,GAAA,GAAG,MAClCwlD,GAAS1zE,EAAKmuB,iBAAiB,GAAG,GAAA,GAClChD,IAAM,MAAM,EAAA,EACd1f,KAAK,EACX;AAAA,GACW6pE,KAAoB,SAAUC,GAAAA;AACrC,MACIC,IADK,qDACKliD,KAAKiiD;AACnB,MAAKC,CAAAA;AACD,UAAM,IAAInnE,MAAM,wBAAwB5G,OAAO8tE,CAAAA,CAAAA;AACnD,SAAO,IAAI/0E,KAAKA,KAAKqrB,IAAIjF,SAAS4uD,EAAK,IAAI,EAAK5uD,GAAAA,SAAS4uD,EAAK,CAAI,GAAA,EAAA,IAAM,GAAG5uD,SAAS4uD,EAAK,CAAA,GAAI,KAAK5uD,SAAS4uD,EAAK,IAAI,EAAO,KAAA,GAAG5uD,SAAS4uD,EAAK,CAAA,GAAI,EAAO,KAAA,GAAG5uD,SAAS4uD,EAAK,IAAI,EAAO,KAAA,CAAA,CAAA;AACvL,GACIC,KAAkB,SAAUz1E,GAAM01E,GAIlC;AAAA,SAFc11E,EAAKw7C,eAAe,SAAS,EAAEk6B,UAAUA,EAExC7/D,CAAAA,EAAAA,QAAQ,KAAK,GAAO,IAAA;AACvC,GCpJI8/D,KAA4B,WAAA;AAC5B,WAASA,EAAW7gE,GAAQgC,GAAAA;AACxBxP,SAAK4+C,UAAU,MACf5+C,KAAK60C,UAAU,MACf70C,KAAKsuE,UAAU,CAAA,GACftuE,KAAKslC,QAAQ,GACbtlC,KAAKwN,SAASA,GACdxN,KAAKwP,OAAOA,GACRhC,MAAW,aACXxN,KAAK60C,UAAUrlC,EAAKqW,MACdrW,EAAK++D,SACL,IAAIr1E,KAAKsW,EAAK++D,OAAOrpD,QAAAA,IAAY,IACvCllB,KAAK4+C,UAAUpvC,EAAKqW,MAAMrW,EAAKg/D,QAAQ,IAAIt1E,KAAKsW,EAAKg/D,MAAMtpD,QAAY,IAAA,CAAA,KAElE1X,MAAW,WAChBxN,KAAK60C,UAAUrlC,EAAKqW,MAAMrW,EAAK+gB,KAAK,IAAIr3B,KAAKsW,EAAK+gB,GAAGrL,QAAAA,IAAY,KAE5D1X,MAAW,YAChBxN,KAAK4+C,UAAUpvC,EAAKqW,MAAMrW,EAAK+gB,KAAK,IAAIr3B,KAAKsW,EAAK+gB,GAAGrL,YAAY,CAExE;AAAA,EAAA;AA6DD,SApDAmpD,EAAW95D,UAAUk6D,SAAS,SAAU/1E,GAClCsH;AAAAA,MAAAA,KAAKslC;AACP,QAAIopC,IAAW1uE,KAAK4+C,WAAWlmD,IAAOsH,KAAK4+C,SACvC+vB,IAAU3uE,KAAK60C,WAAWn8C,IAAOsH,KAAK60C;AAC1C,QAAI70C,KAAKwN,WAAW,WAAW;AAC3B,UAAIkhE;AACA,eAAO;AACX,UAAIC;AACA,eAAA;AAAA,IACP,WACQ3uE,KAAKwN,WAAW;AACrB,UAAImhE;AACA,eAAO;AAAA,eAEN3uE,KAAKwN,WAAW;AACrB,aAAIkhE,CAAAA,CAAAA,MAEJ1uE,KAAKrH,IAAID,CAAAA,GAAAA;AAGb,WAAOsH,KAAKrH,IAAID;EACxB,GAMI21E,EAAW95D,UAAU5b,MAAM,SAAUD;AAEjC,WADAsH,KAAKsuE,QAAQj1E,KAAKX,CACX,GAAA;AAAA,EACf,GAOI21E,EAAW95D,UAAUya,WAAW,WAC5B;AAAA,QAAIlxB,IAAMkC,KAAKsuE;AACf,YAAQtuE,KAAKwN,QACT;AAAA,MAAA,KAAK;AAAA,MACL,KAAK;AACD,eAAO1P;AAAAA,MAGX;AACI,eAAQA,EAAIjE,SAASiE,EAAIA,EAAIjE,SAAS,CAAA,IAAK;AAAA;EAE3D,GACIw0E,EAAW95D,UAAUyqD,QAAQ,WAAA;AACzB,WAAO,IAAIqP,EAAWruE,KAAKwN,QAAQxN,KAAKwP,IAAAA;AAAAA,EAChD,GACW6+D;AACX,KCrEIO,KAAgB,SAASvmE,GAAGyQ,GAI9B;AAAA,SAHA81D,KAAgBh6D,OAAOi6D,kBAClB,EAAEC,WAAW,CAAgBvsE,EAAAA,aAAAA,SAAS,SAAU8F,GAAGyQ,GAAAA;AAAKzQ,IAAAA,EAAEymE,YAAYh2D;AAAAA,EAAE,KACzE,SAAUzQ,GAAGyQ,GAAAA;AAAK,aAAS1Z,KAAK0Z;AAAOlE,aAAOL,UAAUtR,eAAegI,KAAK6N,GAAG1Z,CAAIiJ,MAAAA,EAAEjJ,CAAK0Z,IAAAA,EAAE1Z;KACzFwvE,GAAcvmE,GAAGyQ,CAC1B;AAAA;AAEO,SAASi2D,GAAU1mE,GAAGyQ;AAC3B,MAAiB,OAANA,KAAM,cAAcA,MAAM;AACjC,UAAM,IAAIk2D,UAAU,yBAAyB50E,OAAO0e,CAAAA,IAAK,+BAE7D;AAAA,WAASm2D,IAAOjvE;AAAAA,SAAKwU,cAAcnM;AAAAA,EAAI;AADvCumE,EAAAA,GAAcvmE,GAAGyQ,CAAAA,GAEjBzQ,EAAEkM,YAAYuE,MAAM,OAAOlE,OAAOo0B,OAAOlwB,CAAAA,KAAMm2D,EAAG16D,YAAYuE,EAAEvE,WAAW,IAAI06D;AACjF;AAEO,IAAIC,KAAW,WAQpB;AAAA,SAPAA,KAAWt6D,OAAOu6D,UAAU,SAAkBlmE,GAAAA;AAC1C,aAASnM,GAAGlD,IAAI,GAAG+B,IAAIoN,UAAUlP,QAAQD,IAAI+B,GAAG/B;AAE5C,eAASwF,KADTtC,IAAIiM,UAAUnP;AACOgb,eAAOL,UAAUtR,eAAegI,KAAKnO,GAAGsC,CAAAA,MAAI6J,EAAE7J,CAAKtC,IAAAA,EAAEsC;AAE9E,WAAO6J;AAAAA,EACV,GACMimE,GAAStsE,MAAM5C,MAAM+I,SAAAA;AAC9B;AA6KO,SAASqmE,EAAc3mD,GAAIF,GAAM8mD;AACtC,MAAIA,KAAQtmE,UAAUlP,WAAW;AAAG,aAAiCozC,GAAxBrzC,IAAI,GAAG01E,IAAI/mD,EAAK1uB,QAAYD,IAAI01E,GAAG11E;OACxEqzC,KAAQrzC,KAAK2uB,MACR0kB,MAAIA,IAAK1qC,MAAMgS,UAAU9R,MAAMwI,KAAKsd,GAAM,GAAG3uB,CAAAA,IAClDqzC,EAAGrzC,CAAK2uB,IAAAA,EAAK3uB,CAGrB;AAAA,SAAO6uB,EAAGtoB,OAAO8sC,KAAM1qC,MAAMgS,UAAU9R,MAAMwI,KAAKsd,CAAAA,CAAAA;AACpD;ACvNA,ICNWgnD,GDMPC,KAAoC,SAAUC,GAE9C;AAAA,WAASD,EAAmBhiE,GAAQgC,GAAMkgE;AACtC,QAAIC,IAAQF,EAAOxkE,KAAKjL,MAAMwN,GAAQgC,MAASxP;AAE/C,WADA2vE,EAAMD,WAAWA,GACVC;AAAAA,EACV;AAQD,SAbAZ,GAAUS,GAAoBC,CAM9BD,GAAAA,EAAmBj7D,UAAU5b,MAAM,SAAUD;AACzC,WAAIsH,CAAAA,CAAAA,KAAK0vE,SAASh3E,GAAMsH,KAAKsuE,QAAQz0E,MAAAA,MACjCmG,KAAKsuE,QAAQj1E,KAAKX,CACX,GAAA;AAAA,EAGnB,GACW82E;AACX,EAAEnB,EElBEuB,GAAAA,KAAU,EACVC,UAAU,CACN,UACA,UACA,WACA,aACA,YACA,UACA,UAAA,GAEJC,YAAY,CACR,WACA,YACA,SACA,SACA,OACA,QACA,QACA,UACA,aACA,WACA,YACA,aAEJC,QAAQ,EACJC,MAAM,oBACNC,QAAQ,gBACRC,cAAc,qBACdC,OAAO,WACP,UAAU,WACV,cAAc,eACd,WAAW,YACX,WAAW,YACX,aAAa,cACb,YAAY,aACZ,WAAW,YACXr/D,IAAI,aACJs/D,IAAI,UACJC,KAAK,SACL5/C,OAAO,WACP6/C,QAAQ,YACRC,OAAO,WACP9E,KAAK,mCACLj7C,MAAM,UACNggD,KAAK,SACL,WAAW,YACXvC,OAAO,cACPwC,QAAQ,kBACRC,SAAS,sBACTC,WAAW,wBACXC,UAAU,uBACVC,QAAQ,kBACRC,UAAU,oBACVC,QAAQ,kBACRC,SAAS,gBACTC,UAAU,iBACVC,OAAO,cACPC,OAAO,cACPC,KAAK,SACLC,MAAM,WACNC,MAAM,WACNC,QAAQ,eACRC,WAAW,qBACXC,SAAS,gBACTC,UAAU,iBACVC,UAAU,iBACVC,OAAO,wBAAA,EAAA,GC5DX55D,KAAW,SAAUoS,GAAK4b;AAC1B,SAAO5b,EAAIvjB,QAAQm/B,CACvB,MADiC;AACjC,GACI6rC,KAAiB,SAAUl4E,GAAAA;AAAM,SAAOA,EAAGmW,SAAAA;GAC3CgiE,KAAuB,SAAUv7C,GAAMD,GAAO3xB,GAAO;AAAA,SAAO,GAAGxE,OAAOm2B,GAAO,KAAKn2B,OAAOwE,GAAK,MAAMxE,OAAOo2B,CAAAA;GAS3Gw7C,KAAwB,WACxB;AAAA,WAASA,EAAOngE,GAAOogE,GAASC,GAAUC,GAWtC;AAAA,QAVIF,MAUJ,WAV0BA,IAAUH,KAChCI,MAAa,WAAUA,IAAWrC,KAClCsC,iBAA4BA,IAAgBJ,KAChD9xE,KAAKkT,OAAO,CACZlT,GAAAA,KAAKiyE,WAAWA,KAAYrC,IAC5B5vE,KAAKgyE,UAAUA,GACfhyE,KAAKkyE,gBAAgBA,GACrBlyE,KAAK4R,QAAQA,GACb5R,KAAK1D,UAAUsV,EAAMtV,SACrB0D,KAAKmyE,cAAcvgE,EAAMugE,aACrBnyE,KAAKmyE,YAAYC,YAAY;AAC7B,UAAIA,IAAa,CAAGjyE,EAAAA,OAAOH,KAAK1D,QAAQ81E,aACpCC,IAAc,CAAA,EAAGlyE,OAAOH,KAAK1D,QAAQ+1E;AACzCD,MAAAA,EAAW9wD,KAAK,SAAUzI,GAAGC,GAAK;AAAA,eAAOD,IAAIC;AAAAA,MAAE,CAAA,GAC/Cu5D,EAAY/wD,KAAK,SAAUzI,GAAGC,GAAK;AAAA,eAAOA,IAAID;AAAAA,MAAE,CAEhD7Y,GAAAA,KAAKoyE,aAAaA,EAAWjyE,OAAOkyE,IAC/BryE,KAAKoyE,WAAWv4E,WACjBmG,KAAKoyE,aAAa;AAAA,IACzB;AACD,QAAIvG,EAAU7rE,KAAKmyE,YAAYG,YAAY;AACvC,UAAIA,IAAal+D,GAAQpU,KAAKmyE,YAAYG,SAAAA,IAEpCtyE,KAAKmyE,YAAYG,YADjB,CAACtyE,KAAKmyE,YAAYG,SAEpBl2E,GAAAA,IAAOhC,OAAOk4E,CAClBtyE;AAAAA,WAAKsyE,YAAY,EACbC,UAAUD,EAAUviE,OAAO,SAAUw7D,GAAAA;AACjC,gBAAQA,EAAQ5vE;AAAAA,MACpC,IACgB62E,WAAWF,EAAUviE,OAAO,SAAUw7D,GAClC;AAAA,eAAO72D,EAAQ62D,EAAQ5vE;AAAAA,MAC3C,IACgB82E,YAAYr2E,EAAKyK,QAAQ,IAAA,MAAW,MAChCzK,EAAKyK,QAAQ,IAAA,MADQ,MAErBzK,EAAKyK,QAAQ,UADA,MAEbzK,EAAKyK,QAAQ,IACW,YAAxBzK,EAAKyK,QAAQ,IACW,MADA,MACxBzK,EAAKyK,QAAQ,IAAA,MAAW,MACxBzK,EAAKyK,QAAQ,UADA,IAEjB6rE,YAAYt2E,EAAKyK,QAAQ,IACG,MADQ,MAChCzK,EAAKyK,QAAQ,IAAA,MAAW,MACxBzK,EAAKyK,QAAQ,UADA,MAEbzK,EAAKyK,QAAQ,IAAA,YACbzK,EAAKyK,QAAQ,IACW,MAFX,MAEbzK,EAAKyK,QAAQ,IAAA,MAAW,MACxBzK,EAAKyK,QAAQ,UADA;AAGrB,UAAI8rE,IAAe,SAAU95D,GAAGC,GAAAA;AAC5B,eAAOD,EAAE0yD,UAAUzyD,EAAEyyD;AAAAA,MACrC;AACYvrE,WAAKsyE,UAAUC,SAASjxD,KAAKqxD,IAC7B3yE,KAAKsyE,UAAUE,UAAUlxD,KAAKqxD,CAAAA,GACzB3yE,KAAKsyE,UAAUC,SAAS14E,WACzBmG,KAAKsyE,UAAUC,WAAW,OACzBvyE,KAAKsyE,UAAUE,UAAU34E,WAC1BmG,KAAKsyE,UAAUE,YAAY;AAAA,IAClC;AAEGxyE,WAAKsyE,YAAY;AAAA,EAExB;AAmTD,SA5SAP,EAAOa,qBAAqB,SAAUhhE,GAAAA;AAIlC,UAFMA,EAAMtV,QAAQu2E,QAAQd,EAAOe,gBAE/BlhE,EAAMugE,YAAYlE,SAASr8D,EAAMugE,YAAYvwB;AAC7C,aAAA;AACJ,aAAS73C,KAAO6H,EAAMugE,aAAa;AAC/B,UAAIn6D,GAAS,CAAC,WAAW,QAAQ,QAAQ,MAASjO,GAAAA,CAAAA;AAC9C,eAAO;AACX,WAAKiO,GAAS+5D,EAAOe,YAAYlhE,EAAMtV,QAAQu2E,OAAO9oE,CAClD;AAAA,eAAA;AAAA,IACP;AACD,WAXiB;AAAA,EAYzB,GACIgoE,EAAOx9D,UAAUq+D,qBAAqB,WAClC;AAAA,WAAOb,EAAOa,mBAAmB5yE,KAAK4R;EAC9C,GAQImgE,EAAOx9D,UAAUzE,WAAW,WAAA;AACxB,QAAIkiE,IAAUhyE,KAAKgyE;AACnB,QAAMhyE,EAAAA,KAAK1D,QAAQu2E,QAAQd,EAAOe;AAC9B,aAAOd,EAAQ,yDAAA;AAMnB,QAJAhyE,KAAKkT,OAAO,CAAC8+D,EAAQ,OAAA,CAAA,GAGrBhyE,KAAK+yE,EAAMC,YAAYhzE,KAAK1D,QAAQu2E,IAChC7yE,CAAAA,EAAAA,GAAAA,KAAK1D,QAAQ2xE,OAAO;AACpBjuE,WAAKrH,IAAIq5E,EAAQ,OACjB,CAAA;AAAA,UAAI/D,IAAQjuE,KAAK1D,QAAQ2xE;AACzBjuE,WAAKrH,IAAIqH,KAAKkyE,cAAcjE,EAAM1nD,eAAkBvmB,GAAAA,KAAKiyE,SAASnC,WAAW7B,EAAM3nD,YAAAA,CAAAA,GAAgB2nD,EAAM5nD,WAC5G,CAAA,CAAA;AAAA,IAAA;AACQrmB,WAAK1D,QAAQslD,SAClB5hD,KAAKrH,IAAIq5E,EAAQ,KACZr5E,CAAAA,EAAAA,IAAIqH,KAAK1D,QAAQslD,MAAM9xC,SACvBnX,CAAAA,EAAAA,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQslD,KAASowB,IAAAA,EAAQ,OAAWA,IAAAA,EAAQ,MAI1E,CAAA;AAAA,WAFKhyE,KAAK4yE,mBACN5yE,KAAAA,KAAKrH,IAAIq5E,EAAQ,iBAAA,CAAA,GACdhyE,KAAKkT,KAAK/O,KAAK,EAC9B;AAAA,EAAA,GACI4tE,EAAOx9D,UAAU2+D,SAAS,WACtB;AAAA,QAAIlB,IAAUhyE,KAAKgyE;AACW,IAA1BhyE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,SAAAA,CAAAA,GACnC9P,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAAYymC,IAAAA,EAAQ,OAAWA,IAAAA,EAAQ;EACjF,GACID,EAAOx9D,UAAU4+D,WAAW,WAAA;AACxB,QAAInB,IAAUhyE,KAAKgyE;AACW,IAA1BhyE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,aACnC9P,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,YAC5BymC,EAAQ,SAAA,IACRA,EAAQ,QACtB,CAAA;AAAA,EAAA,GACID,EAAOx9D,UAAU6+D,QAAQ,WACrB;AAAA,QAAIpB,IAAUhyE,KAAKgyE;AACW,IAA1BhyE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,SAAAA,CAAAA,GAC/B9P,KAAKsyE,aAAatyE,KAAKsyE,UAAUG,aACjCzyE,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAC5BymC,IAAAA,EAAQ,UACRA,IAAAA,EAAQ,cAGdhyE,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAAYymC,IAAAA,EAAQ,MAAUA,IAAAA,EAAQ,KAExEhyE,CAAAA,GAAAA,KAAKmyE,YAAYkB,YACjBrzE,KAAKrH,IAAIq5E,EAAQ,IAAA,CAAA,GACjBhyE,KAAKszE,SAELtzE,IAAAA,KAAKoyE,aACLpyE,KAAKuzE,YAAAA,IAEAvzE,KAAKsyE,YACVtyE,KAAKwzE,eAEAxzE,KAAKmyE,YAAYsB,UACtBzzE,KAAK0zE,QAAAA;AAAAA,EAEjB,GACI3B,EAAOx9D,UAAUo/D,SAAS;AACtB,QAAI3B,IAAUhyE,KAAKgyE;AACW,IAA1BhyE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,SAAYnX,CAAAA,EAAAA,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAAYymC,IAAAA,EAAQ,OAAWA,IAAAA,EAAQ,MAE/GhyE,CAAAA,GAAAA,KAAKsyE,aAAatyE,KAAKsyE,UAAUG,aAC7BzyE,KAAK1D,QAAQivC,aAAa,IAC1BvrC,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAC5BymC,IAAAA,EAAQ,cACRA,EAAQ,SAAA,CAAA,IAGdhyE,KAAKrH,IAAIq5E,EAAQ,IAAOr5E,CAAAA,EAAAA,IAAIq5E,EAAQ,UAAA,CAAA,IAGnChyE,KAAKsyE,aAAatyE,KAAKsyE,UAAUI,aACtC1yE,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAAYymC,IAAAA,EAAQ,UAAUA,EAAQ,KAAA,CAAA,KAGpEhyE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIq5E,EAAQ,MAAA,CAAA,GACjBhyE,KAAKmyE,YAAYkB,YACjBrzE,KAAKrH,IAAIq5E,EAAQ,IACjBhyE,CAAAA,GAAAA,KAAKszE,aAELtzE,KAAKoyE,aACLpyE,KAAKuzE,YAAAA,IAEAvzE,KAAKsyE,aACVtyE,KAAKwzE,WAELxzE,GAAAA,KAAKmyE,YAAYsB,UACjBzzE,KAAK0zE;EAGrB,GACI3B,EAAOx9D,UAAUq/D,UAAU,WACvB;AAAA,QAAI5B,IAAUhyE,KAAKgyE;AACfhyE,SAAKmyE,YAAYkB,WACbrzE,KAAK1D,QAAQivC,aAAa,MAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,SAAAA,CAAAA,EAAYnX,IAAIq5E,EAAQ,QAAA,CAAA,GACnDhyE,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAAAA,KACzBvrC,KAAKrH,IAAIq5E,EAAQ,IAKzBhyE,CAAAA,IAAAA,KAAKszE,eAGDtzE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,aAEnC9P,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAC5BymC,IAAAA,EAAQ,QACRA,IAAAA,EAAQ,OAEdhyE,CAAAA,IAAAA,KAAKoyE,aACLpyE,KAAKuzE,YAAAA,IAEAvzE,KAAKsyE,aAAatyE,KAAKsyE,UAAUG,aACtCzyE,KAAKrH,IAAIq5E,EAAQ,IAAOr5E,CAAAA,EAAAA,IAAIq5E,EAAQ,UAE/BhyE,CAAAA,IAAAA,KAAKsyE,aACVtyE,KAAKwzE,WAAAA;AAAAA,EAEjB,GACIzB,EAAOx9D,UAAUs/D,SAAS,WAAA;AACtB,QAAI7B,IAAUhyE,KAAKgyE;AACfhyE,SAAKmyE,YAAYkB,WACbrzE,KAAK1D,QAAQivC,aAAa,MAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,SAAAA,CAAAA,GAC/B9P,KAAKrH,IAAIq5E,EAAQ,YAKrBhyE,KAAKszE,SAAAA,MAGDtzE,KAAK1D,QAAQivC,aAAa,KAC1BvrC,KAAKrH,IAAIqH,KAAK1D,QAAQivC,SAASz7B,SAAAA,CAAAA,GAEnC9P,KAAKrH,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQivC,QAAAA,IAAYymC,EAAQ,OAAWA,IAAAA,EAAQ,WAEzEhyE,KAAKoyE,aACLpyE,KAAKuzE,YAEAvzE,IAAAA,KAAKsyE,aACVtyE,KAAKwzE,WAELxzE,GAAAA,KAAK1D,QAAQw3E,aACb9zE,KAAKrH,IAAIq5E,EAAQ,QAAA,CAAA,EACZr5E,IAAIqH,KAAKwb,KAAKxb,KAAK1D,QAAQw3E,WAAW9zE,KAAKyrE,KAAKuG,EAAQ,KAAA,CAAA,CAAA,EACxDr5E,IAAIq5E,EAAQ,KAAA,CAAA,GAEjBhyE,KAAK1D,QAAQy3E,YACb/zE,KAAKrH,IAAIq5E,EAAQ,IAAA,CAAA,EACZr5E,IAAIqH,KAAKizE,OAAOjzE,KAAK1D,QAAQy3E,SAASl6E,UACrCm4E,EAAQ,OAAA,IACRA,EAAQ,MAAA,CAAA,EACTr5E,IAAIqH,KAAKwb,KAAKxb,KAAK1D,QAAQy3E,kBAAqB/B,EAAQ;EAEzE,GACID,EAAOx9D,UAAUg/D,cAAc,WAC3B;AAAA,QAAIvB,IAAUhyE,KAAKgyE;AACfhyE,SAAKsyE,aAAatyE,KAAKsyE,UAAUC,WACjCvyE,KAAKrH,IAAIq5E,EAAQ,IACZr5E,CAAAA,EAAAA,IAAIqH,KAAKwb,KAAKxb,KAAKsyE,UAAUC,UAAUvyE,KAAKg0E,aAAahC,EAAQ,IAAA,CAAA,CAAA,EACjEr5E,IAAIq5E,EAAQ,KACZr5E,CAAAA,EAAAA,IAAIqH,KAAKwb,KAAKxb,KAAKoyE,YAAYpyE,KAAKyrE,KAAKuG,EAAQ,IAGtDhyE,CAAAA,CAAAA,IAAAA,KAAKrH,IAAIq5E,EAAQ,QAAWr5E,CAAAA,EAAAA,IAAIqH,KAAKwb,KAAKxb,KAAKoyE,YAAYpyE,KAAKyrE,KAAKuG,EAAQ,KAGzF,CAAA,CAAA;AAAA,EAAA,GACID,EAAOx9D,UAAUi/D,aAAa,WAAA;AAC1B,QAAIxB,IAAUhyE,KAAKgyE;AACfhyE,SAAKsyE,UAAUC,aAAavyE,KAAKsyE,UAAUG,cAC3CzyE,KAAKrH,IAAIq5E,EAAQ,OAAOr5E,IAAIqH,KAAKwb,KAAKxb,KAAKsyE,UAAUC,UAAUvyE,KAAKg0E,WAAAA,CAAAA,GAEpEh0E,KAAKsyE,UAAUE,cACXxyE,KAAKsyE,UAAUC,YACfvyE,KAAKrH,IAAIq5E,EAAQ,KAAA,CAAA,GACrBhyE,KAAKrH,IAAIq5E,EAAQ,QAAWr5E,CAAAA,EAAAA,IAAIqH,KAAKwb,KAAKxb,KAAKsyE,UAAUE,WAAWxyE,KAAKg0E,aAAahC,EAAQ;EAE1G,GACID,EAAOx9D,UAAUm/D,UAAU,WACvB;AAAA,QAAI1B,IAAUhyE,KAAKgyE;AACnBhyE,SAAKrH,IAAIq5E,EAAQ,OAAOr5E,IAAIqH,KAAKwb,KAAKxb,KAAKmyE,YAAYsB,gBAAmBzB,EAAQ;EAC1F,GACID,EAAOx9D,UAAU++D,WAAW,WAAA;AACxBtzE,SAAKrH,IAAIqH,KAAKwb,KAAKxb,KAAK1D,QAAQ+2E,SAASrzE,KAAKi0E,WAAWj0E,KAAKgyE,QAAQ,KAC9E,CAAA,CAAA;AAAA,EAAA,GACID,EAAOx9D,UAAUk3D,MAAM,SAAU9vE;AAE7B,QAAI8vE;AADJ9vE,IAAAA,IAAI2jB,SAAS3jB,EAAEmU,YAAY,EAE3B;AAAA,QAAIkiE,IAAUhyE,KAAKgyE;AACnB,QAAIr2E,MAAJ;AACI,aAAOq2E,EAAQ,MACnB;AAAA,QAAIkC,IAAOpuE,KAAKu1B,IAAI1/B,CACpB;AAAA,YAAQu4E,GACJ;AAAA,MAAA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AACDzI,YAAMyI,IAAOlC,EAAQ,IAAA;AACrB;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AACDvG,YAAMyI,IAAOlC,EAAQ,IACrB;AAAA;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AACDvG,YAAMyI,IAAOlC,EAAQ;AACrB;AAAA,MACJ;AACIvG,YAAMyI,IAAOlC,EAAQ;;AAE7B,WAAOr2E,IAAI,IAAI8vE,IAAM,MAAMuG,EAAQ,UAAUvG;AAAAA,EACrD,GACIsG,EAAOx9D,UAAU0/D,YAAY,SAAUza,GACnC;AAAA,WAAOx5D,KAAKiyE,SAASnC,WAAWtW,IAAI;EAC5C,GACIuY,EAAOx9D,UAAUy/D,cAAc,SAAUG;AACrC,QAAI5I,IAAUO,GAASqI,CAAAA,KAASA,IAAO,KAAK,IAAIA,EAAKvI,aAAAA;AACrD,YAASuI,EAAKx4E,IAAIqE,KAAKyrE,IAAI0I,EAAKx4E,CAAK,IAAA,MAAM,MACvCqE,KAAKiyE,SAASpC,SAAStE,CAAAA;AAAAA,EACnC,GACIwG,EAAOx9D,UAAU0+D,SAAS,SAAUt3E,GAAAA;AAChC,WAAOA,IAAI,OAAQ;AAAA,EAC3B,GACIo2E,EAAOx9D,UAAU5b,MAAM,SAAUmE,GAAAA;AAG7B,WAFAkD,KAAKkT,KAAK7Z,KAAK,GAAA,GACf2G,KAAKkT,KAAK7Z,KAAKyD,CACRkD,GAAAA;AAAAA,EACf,GACI+xE,EAAOx9D,UAAUiH,OAAO,SAAU4O,GAAKhf,GAAUgpE,GAAYC,GACzD;AAAA,QAAI1E,IAAQ3vE;AACE,IAAVq0E,MAAU,WAAUA,IAAQ,MAC3BjgE,GAAQgW,CACTA,MAAAA,IAAM,CAACA,CAAAA,IAiBXhf,IACIA,KACI,SAAUoD,GACN;AAAA,aAAOA,EAAEsB,SAC7B;AAAA,IAAA;AACQ,QAAIwkE,IAAe,SAAUpsB,GACzB;AAAA,aAAO98C,KAAYA,EAASH,KAAK0kE,GAAOznB,CAAAA;AAAAA,IACpD;AACQ,WAAIksB,IAvBY,SAAUjmD,GAAOomD,GAAWC;AAExC,eADIh5D,IAAO,IACF5hB,IAAI,GAAGA,IAAIu0B,EAAMt0B,QAAQD;AACpB,QAANA,MAAM,MACFA,MAAMu0B,EAAMt0B,SAAS,IACrB2hB,KAAQ,MAAMg5D,IAAiB,MAG/Bh5D,KAAQ+4D,IAAY,MAG5B/4D,KAAQ2S,EAAMv0B,CAAAA;AAElB,aAAO4hB;AAAAA,IACnB,EAU6B4O,EAAI7vB,IAAI+5E,CAAeD,GAAAA,GAAOD,KAGxChqD,EAAI7vB,IAAI+5E,CAAcnwE,EAAAA,KAAKkwE,IAAQ,GAAA;AAAA,EAEtD,GACWtC;AACX,KCnYI0C,KAAwB,WAAA;AACxB,WAASA,EAAOC,GAAAA;AACZ10E,SAAK20E,OAAAA,IACL30E,KAAK00E,QAAQA;AAAAA,EAChB;AAiED,SAhEAD,EAAOlgE,UAAU5Q,QAAQ,SAAUuP,GAAAA;AAG/B,WAFAlT,KAAKkT,OAAOA,GACZlT,KAAK20E,OAAO,IACL30E,KAAK40E,WACpB;AAAA,EAAA,GACIH,EAAOlgE,UAAUsgE,SAAS,WACtB;AAAA,WAAO70E,KAAK20E,QAAQ30E,KAAK80E,WAAW;AAAA,EAC5C,GACIL,EAAOlgE,UAAUqgE,aAAa,WAC1B;AAAA,QAAIG,GACAC;AACJh1E,SAAK80E,SAAS,MACd90E,KAAKkP,QAAQ;AACb,OAAG;AACC,UAAIlP,KAAK20E;AACL,eAAO;AAGX,eAASM,KADTF,IAAO,MACY/0E,KAAK00E,OAAO;AAE3B,YAAI1wD,IADGhkB,KAAK00E,MAAMO,CAAAA,EACDjpD,KAAKhsB,KAAKkT;AACvB8Q,QAAAA,MACI+wD,MAAS,QAAQ/wD,EAAM,CAAA,EAAGnqB,SAASk7E,EAAK,CAAA,EAAGl7E,YAC3Ck7E,IAAO/wD,GACPgxD,IAAaC;AAAAA,MAGxB;AAMD,UALIF,KAAQ,SACR/0E,KAAKkT,OAAOlT,KAAKkT,KAAKkZ,OAAO2oD,EAAK,CAAGl7E,EAAAA,MAAAA,GACjCmG,KAAKkT,SAAS,OACdlT,KAAK20E,OAAO,MAEhBI,KAAQ;AAIR,eAHA/0E,KAAK20E,OAAAA,IACL30E,KAAK80E,SAAS,MACd90E,MAAAA,KAAKkP,QAAQ;AAAA,IAG7B,SAAiB8lE,MAAe;AAGxB,WAFAh1E,KAAK80E,SAASE,GACdh1E,KAAKkP,QAAQ6lE,GACN;AAAA,EACf,GACIN,EAAOlgE,UAAUk6D,SAAS,SAAUx/D,GAAAA;AAChC,QAAIjP,KAAK80E,WAAW7lE,GAAM;AACtB,UAAIjP,KAAKkP,OAAO;AACZ,YAAI+hB,IAAIjxB,KAAKkP;AAEb,eADAlP,KAAK40E,WACE3jD,GAAAA;AAAAA,MACV;AAED,aADAjxB,KAAK40E;IAER;AACD;EACR,GACIH,EAAOlgE,UAAU2gE,eAAe;AAC5B,WAAOl1E,KAAKyuE,OAAO,QAC3B;AAAA,EAAA,GACIgG,EAAOlgE,UAAU4gE,SAAS,SAAUlmE,GAAAA;AAChC,QAAIjP,KAAKyuE,OAAOx/D,CACZ;AAAA,aAAA;AACJ,UAAM,IAAIlI,MAAM,cAAckI,IAAO,gBAAgBjP,KAAK80E,MAClE;AAAA,EAAA,GACWL;AACX;AACe,SAASW,GAAUliE,GAAM++D;EAChCA,iBAAuBA,IAAWrC;AACtC,MAAItzE,IAAU,CAAA,GACV+4E,IAAM,IAAIZ,GAAOxC,EAASlC;AAC9B,SAAKsF,EAAI1xE,MAAMuP,CAAAA,KAIf,WAEImiE;AAAAA,IAAAA,EAAIF,OAAO,OACX;AAAA,QAAIx5E,IAAI05E,EAAIH,aAAAA;AAGZ,QAFIv5E,MACAW,EAAQivC,WAAWjsB,SAAS3jB,EAAE,CAAI,GAAA,EAAA,IAClC05E,EAAIR,OAAAA;AACJ,YAAM,IAAI9tE,MAAM;AACpB,YAAQsuE,EAAIP,QACR;AAAA,MAAA,KAAK;AACDx4E,QAAAA,EAAQu2E,OAAOE,EAAMK,OACjBiC,EAAIT,WACJU,MAAAA,EAAAA,GACAC;AAEJ;AAAA,MAGJ,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMY,QACrBr3E,EAAQg2E,YAAY,CAACS,EAAMyC,IAAIzC,EAAM0C,IAAI1C,EAAM2C,IAAI3C,EAAM4C,IAAI5C,EAAM6C,KACnEP,EAAIT,WAAAA,GACJU,KACAC,EACA;AAAA;AAAA,MACJ,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMY,QACjB0B,EAAIT,iBACJiB,EACAP,GAAAA,EAAAA,GACAC;AAEJ;AAAA,MACJ,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMG,QACjBmC,EAAIT,WAAAA,MACJiB,KACAN,EAEJ;AAAA;AAAA,MACJ,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMI,UACjBkC,EAAIT,WAAAA,MACJiB,EACAN,GAAAA,EAAAA;AAEJ;AAAA,MACJ,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMa,SACjByB,EAAIT,WAAAA,MACJiB,EACAN,GAAAA,EAAAA;AAEJ;AAAA,MACJ,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMc,QACjBwB,EAAIT,iBACJiB,EACAN,GAAAA,EAAAA;AAEJ;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AACDj5E,QAAAA,EAAQu2E,OAAOE,EAAMY;AACrB,YAAI5pE,IAAMsrE,EAAIP,OACT1oD,OAAO,GAAG,CAAA,EACV8gC,YAEL;AAAA,YADA5wD,EAAQg2E,YAAY,CAACS,EAAMhpE,CAAAA,CAAAA,GAAAA,CACtBsrE,EAAIT,WACL;AAAA;AAEJ,eAAOS,EAAI5G,OAAO,YAAU;AACxB,cAAI4G,EAAIR,OACJ;AAAA,kBAAM,IAAI9tE,MAAM,gBAAA;AACpB,cAAI+uE,IAAMC,EAAAA;AACV,cAAKD,CAAAA;AACD,kBAAM,IAAI/uE,MAAM,uBAAuBsuE,EAAIP,SAAS,oBAExDx4E;AAAAA,UAAAA,EAAQg2E,UAAUj5E,KAAK05E,EAAM+C,CAC7BT,CAAAA,GAAAA,EAAIT,WACP;AAAA,QAAA;AACDU,QAAAA,KA6LZ,WACID;AAAAA,UAAAA,EAAI5G,OAAO,IACX4G,GAAAA,EAAI5G,OAAO,KACX;AAAA,cAAIhD,IAAMuK,EAAAA;AACV,cAAKvK;AAIL,iBAFAnvE,EAAQ81E,aAAa,CAAC3G,CACtB4J,GAAAA,EAAIT,cACGS,EAAI5G,OAAO,OAAA,KAAU;AAExB,kBAAA,EADAhD,IAAMuK,EAEF;AAAA,sBAAM,IAAIjvE,MAAM,uBAAuBsuE,EAAIP,SAAS,qBAAA;AAExDx4E,cAAAA,EAAQ81E,WAAW/4E,KAAKoyE,CAAAA,GACxB4J,EAAIT,WACP;AAAA,YAAA;AAAA,QACJ,EA3MWW,GAAAA,EAAAA;AACA;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAGD,YAFAj5E,EAAQu2E,OAAOE,EAAMc,QACrBv3E,EAAQ+2E,UAAU,CAAC4C,OACdZ,EAAIT,WAAAA;AACL;AAEJ,eAAOS,EAAI5G,OAAO,OAAU,KAAA;AACxB,cAAI4G,EAAIR,OACJ;AAAA,kBAAM,IAAI9tE,MAAM,gBAAA;AACpB,cAAIyyD,IAAIyc,EAAAA;AACR,eAAKzc;AACD,kBAAM,IAAIzyD,MAAM,uBAAuBsuE,EAAIP,SAAS,kBAExDx4E;AAAAA,UAAAA,EAAQ+2E,QAAQh6E,KAAKmgE,CAAAA,GACrB6b,EAAIT,WACP;AAAA,QAAA;AACDiB,QAAAA,EACAN,GAAAA,EAAAA;AACA;AAAA,MACJ;AACI,cAAM,IAAIxuE,MAAM;;EAE3B,EA7HDmvE,GACO55E,KAFI;AA+HX,WAASu5E,IACL;AAAA,QAAI/kE,IAAKukE,EAAI5G,OAAO,IAChB4B,GAAAA,IAAMgF,EAAI5G,OAAO,KAAA;AACrB,QAAM39D,KAAMu/D;AAEZ,SAAG;AACC,YAAI5E,IAAMuK,KACNF,IAAMC,EAAAA,GACNvc,IAAIyc,EAER;AAAA,YAAIxK;AAEIqK,UAAAA,KACAT,EAAIT,WACCt4E,GAAAA,EAAQg2E,cACTh2E,EAAQg2E,YAAY,CACxBh2E,IAAAA,EAAQg2E,UAAUj5E,KAAK05E,EAAM+C,GAAKrK,IAAIA,CAAAA,CAAAA,MAGjCnvE,EAAQ81E,eACT91E,EAAQ81E,aAAa,KACzB91E,EAAQ81E,WAAW/4E,KAAKoyE,CACxB4J,GAAAA,EAAI5G,OAAO,QAId;AAAA,iBAAIqH;AACLT,UAAAA,EAAIT,WAAAA,GACCt4E,EAAQg2E,cACTh2E,EAAQg2E,YAAY,CACxBh2E,IAAAA,EAAQg2E,UAAUj5E,KAAK05E,EAAM+C,CAE5B,CAAA;AAAA,iBAAIT,EAAIP,WAAW;AACpBO,UAAAA,EAAIT,WAAAA,GACCt4E,EAAQg2E,cACTh2E,EAAQg2E,YAAY,CAACS,EAAMyC,IAAIzC,EAAM0C,IAAI1C,EAAM2C,IAAI3C,EAAM4C,IAAI5C,EAAM6C,EAGtE;AAAA,iBAAIP,EAAIP,WAAW,WAAW;AAC/BO,UAAAA,EAAIT,WACJ;AAAA,cAAIj5E,IAAI05E,EAAIH,aAAAA;AACZ,eAAKv5E;AACD,kBAAM,IAAIoL,MAAM,uBAAuBsuE,EAAIP,SAAS,wBAGxD;AAAA,eADAx4E,EAAQy3E,WAAW,CAACz0D,SAAS3jB,EAAE,CAAA,GAAI,MAC5B05E,EAAI5G,OAAO,OAAU,KAAA;AAExB,gBADA9yE,EAAAA,IAAI05E,EAAIH,aAEJ;AAAA,oBAAM,IAAInuE,MAAM,uBAAuBsuE,EAAIP,SAAS,qBAAA;AAExDx4E,YAAAA,EAAQy3E,SAAS16E,KAAKimB,SAAS3jB,EAAE,CAAI,GAAA,EAAA,CAAA;AAAA,UACxC;AAAA,QACJ,OACI;AAAA,cAAA,CAAI69D;AAOL;AANA6b,UAAAA,EAAIT,WACCt4E,GAAAA,EAAQ+2E,YACT/2E,EAAQ+2E,UAAU,CACtB/2E,IAAAA,EAAQ+2E,QAAQh6E,KAAKmgE,CAAAA;AAAAA,QAIxB;AAAA,MACJ,SAAQ6b,EAAI5G,OAAO,OAAY4G,KAAAA,EAAI5G,OAAO,KAAU4G,KAAAA,EAAI5G,OAAO,IACnE;AAAA,EAAA;AACD,WAAS6G,IAEL;AAAA,QADSD,EAAI5G,OAAO,IAGpB;AAAA,SAAG;AACC,YAAI9yE,IAAI05E,EAAIH,aACZ;AAAA,YAAA,CAAKv5E;AACD,gBAAM,IAAIoL,MAAM,uBAAuBsuE,EAAIP,SAAS;AAGxD,aADAx4E,EAAQm3E,SAAS,CAACn0D,SAAS3jB,EAAE,CAAI,GAAA,EAAA,CAAA,GAC1B05E,EAAI5G,OAAO,OAAU,KAAA;AAExB,gBADA9yE,IAAI05E,EAAIH;AAEJ,kBAAM,IAAInuE,MAAM,uBAAuBsuE,EAAIP,SAAS,iBAAA;AAExDx4E,UAAAA,EAAQm3E,OAAOp6E,KAAKimB,SAAS3jB,EAAE,IAAI,EACtC,CAAA;AAAA,QAAA;AAAA,MACb,SAAiB05E,EAAI5G,OAAO,OAAY4G,KAAAA,EAAI5G,OAAO,IAAA;AAAA,EAC9C;AACD,WAASwH,IAAAA;AACL,YAAQZ,EAAIP,QAAAA;AAAAA,MACR,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX,KAAK;AACD,eAAO;AAAA,MACX;AACI,eAAO;AAAA,IAAA;AAAA,EAElB;AACD,WAASiB,IAAAA;AACL,YAAQV,EAAIP,QACR;AAAA,MAAA,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AACD,eAAOO,EAAIP,OAAO1oD,OAAO,GAAG,CAAA,EAAG8gC;MACnC;AACI,eAAA;AAAA,IAEX;AAAA,EAAA;AACD,WAAS8oB,IAAAA;AACL,YAAQX,EAAIP,QAAAA;AAAAA,MACR,KAAK;AAED,eADAO,EAAIT,WACI,GAAA;AAAA,MACZ,KAAK;AAED,eADAS,EAAIT,cACG;AAAA,MACX,KAAK;AAED,eADAS,EAAIT,cACGS,EAAI5G,OAAO,MAAW,IAAA,KAAI;AAAA,MACrC,KAAK;AAED,eADA4G,EAAIT,cACGS,EAAI5G,OAAO,eAAe;AAAA,MACrC,KAAK;AACD,YAAIx9C,IAAI3R,SAAS+1D,EAAInmE,MAAM,IAAI,EAC/B;AAAA,YAAI+hB,YAAYA,IAAI;AAChB,gBAAM,IAAIlqB,MAAM,uBAAuBkqB,CAE3C;AAAA,eADAokD,EAAIT,WACGS,GAAAA,EAAI5G,OAAO,MAAWx9C,IAAAA,CAAAA,IAAIA;AAAAA,MACrC;AACI,eAAO;AAAA,IAAA;AAAA,EAElB;AAkBD,WAASskD,IAAAA;AACL,QAAIF,EAAIP,WAAW,SAAS;AACxB,UAAIp8E,IAAOQ,KAAK2U,MAAMwnE,EAAIniE;AAC1B,UAAKxa,CAAAA;AACD,cAAM,IAAIqO,MAAM,6BAA6BsuE,EAAIniE,IAAAA;AACrD5W,MAAAA,EAAQ2xE,QAAQ,IAAI/0E,KAAKR;IAC5B;AACQ28E,MAAAA,EAAI5G,OAAO,KAChBnyE,MAAAA,EAAQslD,QAAQtiC,SAAS+1D,EAAInmE,MAAM,CAAA,GAAI,EACvCmmE,GAAAA,EAAIF,OAAO,QAGlB;AAAA,EAAA;AACL;AH3XO,SAASgB,GAAqBtD;AACjC,SAAOA,IAAOtD,EAAU2D;AAC5B;AAAA,CAXA,SAAW3D;AACPA,IAAUA,EAAkB,SAAI,CAAK,IAAA,UACrCA,EAAUA,EAAmB,UAAI,CAAK,IAAA,WACtCA,EAAUA,EAAkB,SAAI,CAAK,IAAA,UACrCA,EAAUA,EAAiB,QAAI,KAAK,SACpCA,EAAUA,EAAkB,SAAI,CAAK,IAAA,UACrCA,EAAUA,EAAoB,WAAI,KAAK,YACvCA,EAAUA,EAAoB,WAAI,CAAA,IAAK;AAC1C,GAAEA,MAAcA,IAAY,CAAE;AIqF/B,IAAI6G,KAAW,SAAUljE,GAAM++D,GAAAA;AAE3B,SADIA,MAAa,WAAUA,IAAWrC,KAC/B,IAAImD,EAAMqC,GAAUliE,GAAM++D,CAAAA,KAAAA;AACrC,GACI7oE,KAAS,CACT,SACA,SACA,YACA,aACA,cACA,SAAA;AAEJ2oE,GAAOe,cAAc,CAAA,GACrBf,GAAOe,YAAYvD,EAAU2D,MAAU9pE,IAAAA,IACvC2oE,GAAOe,YAAYvD,EAAU4D,QAAY/pE,IAAAA,IACzC2oE,GAAOe,YAAYvD,EAAU6D,SAAS,CAAC,QAAA,EAAUjzE,OAAOiJ,EAAAA,GACxD2oE,GAAOe,YAAYvD,EAAUoE,MAAUvqE,IAAAA,IACvC2oE,GAAOe,YAAYvD,EAAUqE,WAAWxqE,IACxC2oE,GAAOe,YAAYvD,EAAUsE,MAAU,IAAA,CAAC,YAAY,WAAa1zE,EAAAA,OAAOiJ;AAIxE,IAGIwpE,KAAqBb,GAAOa,oBCnH5ByD,KAAsB,WACtB;AAAA,WAASA,EAAKhoC,GAAMC,GAAQgiC,GAAQgG,GAAAA;AAChCt2E,SAAKquC,OAAOA,GACZruC,KAAKsuC,SAASA,GACdtuC,KAAKswE,SAASA,GACdtwE,KAAKs2E,cAAcA,KAAe;AAAA,EACrC;AAiBD,SAhBAD,EAAK9hE,UAAU1T,WAAW,WAAA;AACtB,WAAOb,KAAKquC;AAAAA,EACpB,GACIgoC,EAAK9hE,UAAUpS,aAAa;AACxB,WAAOnC,KAAKsuC;AAAAA,EACpB,GACI+nC,EAAK9hE,UAAUuS,aAAa,WACxB;AAAA,WAAO9mB,KAAKswE;AAAAA,EACpB,GACI+F,EAAK9hE,UAAUq5D,kBAAkB;AAC7B,WAAO5tE,KAAKs2E;AAAAA,EACpB,GACID,EAAK9hE,UAAU2Q,UAAU,WACrB;AAAA,WAAiE,OAA5C,KAAZllB,KAAKquC,OAAY,KAAmB,KAAdruC,KAAKsuC,SAActuC,KAAKswE,UACnDtwE,KAAKs2E;AAAAA,EACjB,GACWD;AACX,KAEIE,KAA0B,SAAU9G,GAAAA;AAEpC,WAAS8G,EAAShgD,GAAMD,GAAO3xB,GAAK0pC,GAAMC,GAAQgiC,GAAQgG,GACtD;AAAA,QAAI3G,IAAQF,EAAOxkE,KAAKjL,MAAMquC,GAAMC,GAAQgiC,GAAQgG,MAAgBt2E;AAIpE,WAHA2vE,EAAMp5C,OAAOA,GACbo5C,EAAMr5C,QAAQA,GACdq5C,EAAMhrE,MAAMA,GACLgrE;AAAAA,EACV;AAgJD,SAvJAZ,GAAUwH,GAAU9G,CAQpB8G,GAAAA,EAASC,WAAW,SAAU99E,GAAAA;AAC1B,WAAO,IAAIsH,KAAKtH,EAAK6tB,kBAAkB7tB,EAAK4tB,YAAAA,IAAgB,GAAG5tB,EAAK2tB,WAAAA,GAAc3tB,EAAKiuB,YAAejuB,GAAAA,EAAKkuB,iBAAiBluB,EAAKmuB,cAAAA,GAAiBnuB,EAAKS,QAAY,IAAA,GAAA;AAAA,EAC3K,GACIo9E,EAAShiE,UAAUk5D,aAAa,WAC5B;AAAA,WAAOA,GAAW,IAAIv0E,KAAK8G,KAAKklB;EACxC,GACIqxD,EAAShiE,UAAU2Q,UAAU,WAAA;AACzB,WAAO,IAAIhsB,KAAKA,KAAKqrB,IAAIvkB,KAAKu2B,MAAMv2B,KAAKs2B,QAAQ,GAAGt2B,KAAK2E,KAAK3E,KAAKquC,MAAMruC,KAAKsuC,QAAQtuC,KAAKswE,QAAQtwE,KAAKs2E,WAAAA,CAAAA,EAAcpxD;EAC9H,GACIqxD,EAAShiE,UAAUpW,SAAS,WAAA;AACxB,WAAO6B,KAAK2E;AAAAA,EACpB,GACI4xE,EAAShiE,UAAUV,WAAW;AAC1B,WAAO7T,KAAKs2B;AAAAA,EACpB,GACIigD,EAAShiE,UAAUkiE,UAAU,WAAA;AACzB,WAAOz2E,KAAKu2B;AAAAA,EACpB,GACIggD,EAAShiE,UAAUmiE,WAAW,SAAUC,GACpC32E;AAAAA,SAAKu2B,QAAQogD;AAAAA,EACrB,GACIJ,EAAShiE,UAAUqiE,YAAY,SAAUxgC;AAErC,QADAp2C,KAAKs2B,SAAS8f,GACVp2C,KAAKs2B,QAAQ,IAAI;AACjB,UAAIugD,IAAU/wE,KAAK+D,MAAM7J,KAAKs2B,QAAQ,EAAA,GAClCwgD,IAAWvK,GAAMvsE,KAAKs2B,OAAO,EACjCt2B;AAAAA,WAAKs2B,QAAQwgD,GACb92E,KAAKu2B,QAAQsgD,GACT72E,KAAKs2B,UAAU,MACft2B,KAAKs2B,QAAQ,MACXt2B,KAAKu2B;AAAAA,IAEd;AAAA,EACT,GACIggD,EAAShiE,UAAUwiE,YAAY,SAAU36E,GAAM46E;AACvCA,IAAAA,IAAOh3E,KAAKytE,eACZztE,KAAK2E,OAAAA,EAAS3E,KAAKytE,WAAAA,IAAe,KAAK,IAAIuJ,MAAgB,IAAP56E,IAGpD4D,KAAK2E,OAAS3E,EAAAA,KAAKytE,eAAeuJ,KAAe,IAAP56E,GAE9C4D,KAAKi3E,OACb;AAAA,EAAA,GACIV,EAAShiE,UAAU2iE,WAAW,SAAU96E,GACpC4D;AAAAA,SAAK2E,OAAOvI,GACZ4D,KAAKi3E,OACb;AAAA,EAAA,GACIV,EAAShiE,UAAU4iE,WAAW,SAAUnxD,GAAOoxD,GAAU3D,GAKrD;AAAA,SAJI2D,MAEAp3E,KAAKquC,QAAQvoC,KAAK+D,OAAO,KAAK7J,KAAKquC,QAAQroB,CAASA,IAAAA,QAE/C;AACLhmB,WAAKquC,QAAQroB;AACb,UAAIqxD,IAAK7K,GAAOxsE,KAAKquC,MAAM,EAAA,GAAKipC,IAASD,EAAGt1E,KAAKw1E,IAAUF,EAAG5K;AAK9D,UAJI6K,MACAt3E,KAAKquC,OAAOkpC,GACZv3E,KAAKk3E,SAASI,KAEd5K,GAAM+G,CAAAA,KAAWzH,EAASyH,GAAQzzE,KAAKquC;AACvC;AAAA,IACP;AAAA,EACT,GACIkoC,EAAShiE,UAAUijE,aAAa,SAAUC,GAASL,GAAU3D,GAAQiE,GAAAA;AAMjE,SALIN,MAEAp3E,KAAKsuC,UACDxoC,KAAK+D,OAAO,QAAoB,KAAZ7J,KAAKquC,OAAYruC,KAAKsuC,WAAWmpC,CAAAA,IAAWA,QAE/D;AACLz3E,WAAKsuC,UAAUmpC;AACf,UAAIJ,IAAK7K,GAAOxsE,KAAKsuC,QAAQ,KAAKqpC,IAAUN,EAAGt1E,KAAK61E,IAAYP,EAAG5K;AAKnE,UAJIkL,MACA33E,KAAKsuC,SAASspC,GACd53E,KAAKm3E,SAASQ,GAAS,IAAOlE,MAE7B/G,GAAM+G,CAAAA,KAAWzH,EAASyH,GAAQzzE,KAAKquC,IAAAA,OACvCq+B,GAAMgL,CAAa1L,KAAAA,EAAS0L,GAAU13E,KAAKsuC,MAAAA;AAC5C;AAAA,IAEP;AAAA,EACT,GACIioC,EAAShiE,UAAUsjE,aAAa,SAAUC,GAASV,GAAU3D,GAAQiE,GAAUK,GAO3E;AAAA,SANIX,MAEAp3E,KAAKswE,UACDxqE,KAAK+D,OAAO,SAAqB,OAAZ7J,KAAKquC,OAA4B,KAAdruC,KAAKsuC,SAActuC,KAAKswE,WAC5DwH,CAAWA,IAAAA,QAEd;AACL93E,WAAKswE,UAAUwH;AACf,UAAIT,IAAK7K,GAAOxsE,KAAKswE,QAAQ,EAAA,GAAK0H,IAAYX,EAAGt1E,KAAKk2E,IAAYZ,EAAG5K;AAKrE,UAJIuL,MACAh4E,KAAKswE,SAAS2H,GACdj4E,KAAKw3E,WAAWQ,GAAW,IAAOvE,GAAQiE,CAAAA,KAEzChL,GAAM+G,CAAAA,KAAWzH,EAASyH,GAAQzzE,KAAKquC,WACvCq+B,GAAMgL,CAAAA,KAAa1L,EAAS0L,GAAU13E,KAAKsuC,MAC3Co+B,OAAAA,GAAMqL,CAAa/L,KAAAA,EAAS+L,GAAU/3E,KAAKswE,MAAAA;AAC5C;AAAA,IAEP;AAAA,EACT,GACIiG,EAAShiE,UAAU0iE,SAAS,WACxB;AAAA,QAAA,EAAIj3E,KAAK2E,OAAO,KAAhB;AAGA,UAAIuzE,IAAcxK,GAAW1tE,KAAKu2B,MAAMv2B,KAAKs2B,QAAQ,CAAG,EAAA,CAAA;AACxD,UAAIt2B,EAAAA,KAAK2E,OAAOuzE;AAGhB,eAAOl4E,KAAK2E,MAAMuzE,KAAa;AAG3B,cAFAl4E,KAAK2E,OAAOuzE,GAAAA,EACVl4E,KAAKs2B,OACHt2B,KAAKs2B,UAAU,OACft2B,KAAKs2B,QAAQ,GAAA,EACXt2B,KAAKu2B,MACHv2B,KAAKu2B,OTxIJ;ASyID;AAGR2hD,UAAAA,IAAcxK,GAAW1tE,KAAKu2B,MAAMv2B,KAAKs2B,QAAQ,CAAA,EAAG;QACvD;AAAA,IAhBA;AAAA,EAiBT,GACIigD,EAAShiE,UAAU5b,MAAM,SAAU2D,GAAS86E,GAAAA;AACxC,QAAIvE,IAAOv2E,EAAQu2E,MAAMtnC,IAAWjvC,EAAQivC,UAAUyrC,IAAO16E,EAAQ06E,MAAMvD,IAASn3E,EAAQm3E,QAAQiE,IAAWp7E,EAAQo7E,UAAUK,IAAWz7E,EAAQy7E;AACpJ,YAAQlF,GACJ;AAAA,MAAA,KAAKtD,EAAUsE;AACX,eAAO7zE,KAAK02E,SAASnrC,CAAAA;AAAAA,MACzB,KAAKgkC,EAAUqE;AACX,eAAO5zE,KAAK42E,UAAUrrC,CAAAA;AAAAA,MAC1B,KAAKgkC,EAAUoE;AACX,eAAO3zE,KAAK+2E,UAAUxrC,GAAUyrC,CACpC;AAAA,MAAA,KAAKzH,EAAU6D;AACX,eAAOpzE,KAAKk3E,SAAS3rC,CACzB;AAAA,MAAA,KAAKgkC,EAAU2D;AACX,eAAOlzE,KAAKm3E,SAAS5rC,GAAU6rC,GAAU3D,CAAAA;AAAAA,MAC7C,KAAKlE,EAAU4D;AACX,eAAOnzE,KAAKw3E,WAAWjsC,GAAU6rC,GAAU3D,GAAQiE,CACvD;AAAA,MAAA,KAAKnI,EAAU4I;AACX,eAAOn4E,KAAK63E,WAAWtsC,GAAU6rC,GAAU3D,GAAQiE,GAAUK,CAAAA;AAAAA,IAAAA;AAAAA,EAE7E,GACWxB;AACX,EAAEF,EAAAA;AChLK,SAAS+B,GAAkB97E;AAI9B,WAHIkmC,IAAU,CAGL61C,GAAAA,IAAK,GAAGC,IAFN1jE,OAAOmhB,KAAKz5B,CAAAA,GAES+7E,IAAKC,EAAOz+E,QAAQw+E,KAAM;AACtD,QAAItuE,IAAMuuE,EAAOD;AACZrM,IAAAA,EAASuM,IAAaxuE,CACvBy4B,KAAAA,EAAQnpC,KAAK0Q,CAAAA,GACb4J,GAAOrX,EAAQyN,CAAAA,CAAAA,KAAAA,CAAUmjE,GAAY5wE,EAAQyN,CAAAA,CAAAA,KAC7Cy4B,EAAQnpC,KAAK0Q,CAAAA;AAAAA,EAEpB;AACD,MAAIy4B,EAAQ3oC;AACR,UAAM,IAAIkN,MAAM,sBAAsBy7B,EAAQr+B,KAAK;AAEvD,SAAO+qE,GAAS,IAAI5yE,CACxB;AAAA;AACO,SAASk8E,GAAal8E,GAAAA;AACzB,MAAI4tB,IAAOglD,GAASA,GAAS,CAAA,GAAIuJ,EAAkBL,GAAAA,GAAkB97E,CAGrE,CAAA;AAAA,MAFIuvE,EAAU3hD,EAAKwuD,QAAAA,MACfxuD,EAAK2oD,OAAOE,EAAMc,UAChBhI,EAAU3hD,EAAK2oD,IAASE,KAAAA,CAAAA,EAAMC,YAAY9oD,EAAK2oD;AACjD,UAAM,IAAI9rE,MAAM,sBAAsB5G,OAAO+pB,EAAK2oD,MAAM,GAAA,EAAK1yE,OAAO7D,EAAQu2E,IAahF,CAAA;AAAA,MAXK3oD,EAAKyuD,YACNzuD,EAAKyuD,UAAU,IAAIz/E,MAAK,oBAAIA,QAAO8rB,gBAAgB,CAClD6mD,CAAAA,IAAAA,EAAU3hD,EAAK8sD,IAAAA,IAGXlL,GAAS5hD,EAAK8sD,IAAAA,MAInB9sD,EAAK8sD,OAAO9sD,EAAK8sD,KAAKzL,WANtBrhD,EAAK8sD,OAAOjE,EAAMyC,GAAGjK,SAQrBM,EAAU3hD,EAAK0uD,QAAAA,GAAW;AACtB9M,IAAAA,GAAS5hD,EAAK0uD,cACd1uD,EAAK0uD,WAAW,CAAC1uD,EAAK0uD,QAAAA;AAC1B,aAASh/E,IAAI,GAAGA,IAAIswB,EAAK0uD,SAAS/+E,QAAQD;AAEtC,WADIq3B,IAAI/G,EAAK0uD,SAASh/E,CAAAA,OACZ,KADYA,EACLq3B,aAAaA,KAAK;AAC/B,cAAM,IAAIlqB,MAAM,4DAAA;AAAA,EAG3B;AACD,QAAcmjB,EAAK6pD,YACfpH,GAASziD,EAAK6pD,aACdpH,GAASziD,EAAK4pD,SACdp/D,KAAQwV,EAAKkoD,cACbzF,GAASziD,EAAKkoD,UAAAA,KACdvG,EAAU3hD,EAAKooD,SAAAA,KACfzG,EAAU3hD,EAAKwuD,QAAAA;AACf,YAAQxuD,EAAK2oD,MACT;AAAA,MAAA,KAAKE,EAAMc;AACF3pD,QAAAA,EAAKmpD,YACNnpD,EAAKmpD,UAAUnpD,EAAKyuD,QAAQryD,YAAAA,IAAgB,IAChD4D,EAAKkoD,aAAaloD,EAAKyuD,QAAQtyD,WAC/B;AAAA;AAAA,MACJ,KAAK0sD,EAAMa;AACP1pD,QAAAA,EAAKkoD,aAAaloD,EAAKyuD,QAAQtyD,WAAAA;AAC/B;AAAA,MACJ,KAAK0sD,EAAMY;AACPzpD,QAAAA,EAAKooD,YAAY,CAAC7E,GAAWvjD,EAAKyuD,OAe9C,CAAA;AAAA,IAAA;AAAA,MAVI9M,EAAU3hD,EAAKmpD,OAAaj/D,KAAAA,CAAAA,GAAQ8V,EAAKmpD,OACzCnpD,MAAAA,EAAKmpD,UAAU,CAACnpD,EAAKmpD,WAGrBxH,EAAU3hD,EAAK4pD,SACd1/D,KAAAA,CAAAA,GAAQ8V,EAAK4pD,SAAAA,KACdhI,GAAS5hD,EAAK4pD,SAAAA,MACd5pD,EAAK4pD,YAAY,CAAC5pD,EAAK4pD,SAGtBjI,IAAAA,EAAU3hD,EAAKkoD,UAAAA;AAIf,QAAIh+D,GAAQ8V,EAAKkoD,UAAa,GAAA;AAC/B,UAAIA,IAAa,CAAA,GACbC,IAAc,CAClB;AAAA,WAASz4E,IAAI,GAAGA,IAAIswB,EAAKkoD,WAAWv4E,QAAQD,KAAK;AAC7C,YAAIq3B;AAAAA,SAAAA,IAAI/G,EAAKkoD,WAAWx4E,CAAAA,KAChB,IACJw4E,EAAW/4E,KAAK43B,CAAAA,IAEXA,IAAI,KACTohD,EAAYh5E,KAAK43B,CAExB;AAAA,MAAA;AACD/G,MAAAA,EAAKkoD,aAAaA,GAClBloD,EAAKmoD,cAAcA;AAAAA,IACtB;AACQnoD,MAAAA,EAAKkoD,aAAa,KACvBloD,EAAKmoD,cAAc,CAACnoD,EAAKkoD,UACzBloD,GAAAA,EAAKkoD,aAAa,CAAA,MAGlBloD,EAAKmoD,cAAc,IACnBnoD,EAAKkoD,aAAa,CAACloD,EAAKkoD,UAAAA;AAAAA;AAxBxBloD,IAAAA,EAAKkoD,aAAa,CAAA,GAClBloD,EAAKmoD,cAAc,CA8BvB;AAAA,MAJIxG,EAAU3hD,EAAK6pD,QAAAA,KAAAA,CAAc3/D,GAAQ8V,EAAK6pD,QAAAA,MAC1C7pD,EAAK6pD,WAAW,CAAC7pD,EAAK6pD,QAAAA,IAGrBlI,EAAU3hD,EAAKooD;AAGf,QAAIxG,GAAS5hD,EAAKooD,SACnBpoD;AAAAA,MAAAA,EAAKooD,YAAY,CAACpoD,EAAKooD,YACvBpoD,EAAK2uD,aAAa;AAAA,aAEb9M,GAAa7hD,EAAKooD,SACvBpoD;AAAAA,MAAAA,EAAKooD,YAAY,CAAChH,GAAQE,QAAQthD,EAAKooD,SAAW/G,EAAAA,OAAAA,GAClDrhD,EAAK2uD,aAAa;AAAA,aAEb3uD,EAAKooD,qBAAqBhH;OAC1BphD,EAAKooD,UAAU32E,KAAKuuB,EAAK2oD,OAAOE,EAAMa,WACvC1pD,EAAKooD,YAAY,CAACpoD,EAAKooD,UAAU/G,UACjCrhD,EAAK2uD,aAAa,SAGlB3uD,EAAK2uD,aAAa,CAAC,CAAC3uD,EAAKooD,UAAU/G,SAASrhD,EAAKooD,UAAU32E,KAC3DuuB,EAAKooD,YAAY;AAAA,SAGpB;AACD,UAAIA,IAAY,IACZuG,IAAa,CAAA;AACjB,WAASj/E,IAAI,GAAGA,IAAIswB,EAAKooD,UAAUz4E,QAAQD,KAAK;AAC5C,YAAIu6E,IAAOjqD,EAAKooD,UAAU14E;AACtBkyE,QAAAA,GAASqI,CAAAA,IACT7B,EAAUj5E,KAAK86E,CAAAA,IAGVpI,GAAaoI,CAAAA,IAClB7B,EAAUj5E,KAAKiyE,GAAQE,QAAQ2I,CAAAA,EAAM5I,YAGpC4I,EAAKx4E,KAAKuuB,EAAK2oD,OAAOE,EAAMa,UAC7BtB,EAAUj5E,KAAK86E,EAAK5I,WAGpBsN,EAAWx/E,KAAK,CAAC86E,EAAK5I,SAAS4I,EAAKx4E,CAE3C,CAAA;AAAA,MAAA;AACDuuB,MAAAA,EAAKooD,YAAY3F,GAAS2F,CAAAA,IAAaA,IAAY,MACnDpoD,EAAK2uD,aAAalM,GAASkM,CAAAA,IAAcA,IAAa;AAAA,IACzD;AAAA;AA1CG3uD,IAAAA,EAAK2uD,aAAa;AAkEtB,SAtBKhN,EAAU3hD,EAAKupD,MAAAA,IAGX3H,GAAS5hD,EAAKupD,MAAAA,MACnBvpD,EAAKupD,SAAS,CAACvpD,EAAKupD,MAAAA,KAHpBvpD,EAAKupD,SAASvpD,EAAK2oD,OAAOE,EAAMG,SAAS,CAAChpD,EAAKyuD,QAAQhyD,YAAiB,CAAA,IAAA,MAMvEklD,EAAU3hD,EAAKwtD,QAIX5L,IAAAA,GAAS5hD,EAAKwtD,QACnBxtD,MAAAA,EAAKwtD,WAAW,CAACxtD,EAAKwtD,aAJtBxtD,EAAKwtD,WACDxtD,EAAK2oD,OAAOE,EAAMI,WAAW,CAACjpD,EAAKyuD,QAAQ/xD,mBAAmB,MAMjEilD,EAAU3hD,EAAK6tD,QAIXjM,IAAAA,GAAS5hD,EAAK6tD,QAAAA,MACnB7tD,EAAK6tD,WAAW,CAAC7tD,EAAK6tD,QAAAA,KAJtB7tD,EAAK6tD,WACD7tD,EAAK2oD,OAAOE,EAAMoF,WAAW,CAACjuD,EAAKyuD,QAAQ9xD,cAAAA,CAAAA,IAAmB,MAK/D,EAAEiyD,eAAe5uD;AAC5B;ACnLO,SAAS6uD,GAAYC,GACxB;AAAA,MAAI18E,IAAU08E,EACT3+E,MAAM;AAAA,CAAA,EACNE,IAAI0+E,EACJlpE,EAAAA,OAAO,SAAUiS,GAAK;AAAA,WAAOA,MAAM;AAAA,EAAK,CAAA;AAC7C,SAAOktD,GAASA,GAAS,CAAA,GAAI5yE,EAAQ,KAAKA,EAAQ,CAAA,CAAA;AACtD;AACO,SAAS48E,GAAaC,GACzB;AAAA,MAAI78E,IAAU,CAAA,GACV88E,IAAkB,+CAA+CptD,KAAKmtD,CAC1E;AAAA,MAAA,CAAKC;AACD,WAAO98E;AAEX,MAAI+8E,IAAOD,EAAgB,CAAA,GAAIT,IAAUS,EAAgB,CAAA;AAKzD,SAJIC,MACA/8E,EAAQ+8E,OAAOA,IAEnB/8E,EAAQq8E,UAAU3K,GAAkB2K,CAC7Br8E,GAAAA;AACX;AACA,SAAS28E,GAAUD;AAEf,MADAA,EAAAA,IAAYA,EAAUzqE,QAAQ,aAAa,EAC5B1U,GAAAA;AACX,WAAO;AACX,MAAIk1B,IAAS,iBAAiB/C,KAAKgtD,EAAU9rB,YAAAA,CAAAA;AAC7C,OAAKn+B;AACD,WAAOuqD,GAAWN,CAAAA;AAEtB,MAAIjvE,IAAMglB,EAAO,CACjB;AAAA,UAAQhlB,EAAImjD,YACR,GAAA;AAAA,IAAA,KAAK;AAAA,IACL,KAAK;AACD,aAAOosB,GAAWN,CACtB;AAAA,IAAA,KAAK;AACD,aAAOE,GAAaF;IACxB;AACI,YAAM,IAAIjyE,MAAM,wBAAwB5G,OAAO4J,GAAK,MAAQ5J,EAAAA,OAAO64E;;AAE/E;AACA,SAASM,GAAWH,GAChB;AAAA,MACI78E,IAAU48E,GADKC,EAAK5qE,QAAQ,YAAY,EAAA,CAAA;AAiD5C,SA/CY4qE,EAAK5qE,QAAQ,uBAAuB,EAAIlU,EAAAA,MAAM,KACpDS,QAAQ,SAAU6vB,GACpB;AAAA,QAAI0sD,IAAK1sD,EAAKtwB,MAAM,GAAM0P,GAAAA,IAAMstE,EAAG,CAAInoE,GAAAA,IAAQmoE,EAAG,CAClD;AAAA,YAAQttE,EAAImjD,YAAAA,GAAAA;AAAAA,MACR,KAAK;AACD5wD,QAAAA,EAAQu2E,OAAOtD,EAAUrgE,EAAMg+C,YAC/B,CAAA;AAAA;AAAA,MACJ,KAAK;AACD5wD,QAAAA,EAAQ06E,OAAOuC,GAAKrqE,EAAMg+C,YAAAA,CAAAA;AAC1B;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AACD,YAAI/mC,IA6BpB,SAAqBjX,GACjB;AAAA,iBAAIA,EAAMrI,QAAQ,SAAlB,KACiBqI,EAAM7U,MAAM,GAAA,EACXE,IAAIi/E,EAAAA,IAEfA,GAAsBtqE,CACjC;AAAA,QAAA,EAnCsCA,CAClBuqE,GAAAA,IAAY1vE,EAAI2Q,YAGpBpe;AAAAA,QAAAA,EAAQm9E,CAAatzD,IAAAA;AACrB;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AACD7pB,QAAAA,EAAQg2E,YAkCxB,SAAsBpjE;AAClB,cAAI9S,IAAO8S,EAAM7U,MAAM,GAAA;AACvB,iBAAO+B,EAAK7B,IAAI,SAAUoK,GACtB;AAAA,gBAAIA,EAAI9K,WAAW;AAEf,qBAAO0/E,GAAK50E,CAGhB;AAAA,gBAAIs5D,IAAQt5D,EAAIqf,MAAM;AACtB,gBAAKi6C,CAAAA,KAASA,EAAMpkE,SAAS;AACzB,oBAAM,IAAI6/E,YAAY,2BAA2Bv5E,OAAOwE,CAE5D,CAAA;AAAA,gBAAIhJ,IAAI8Y,OAAOwpD,EAAM,KACjB0b,IAAW1b,EAAM,CACjBkW,GAAAA,IAAOoF,GAAKI,CAAAA,EAAUpO;AAC1B,mBAAO,IAAID,GAAQ6I,GAAMx4E,CAAAA;AAAAA,UACjC;QACA,EAnDiDuT,CACjC;AAAA;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AAED,YAAIypE,IAAUO,GAAaC,CAAAA;AAC3B78E,QAAAA,EAAQ+8E,OAAOV,EAAQU,MACvB/8E,EAAQq8E,UAAUA,EAAQA;AAC1B;AAAA,MACJ,KAAK;AACDr8E,QAAAA,EAAQ2xE,QAAQD,GAAkB9+D,CAClC;AAAA;AAAA,MACJ,KAAK;AACD5S,QAAAA,EAAQo8E,WAAWjkE,OAAOvF,CAC1B;AAAA;AAAA,MACJ;AACI,cAAM,IAAInI,MAAM,6BAA6BgD,IAAM,GAEnE;AAAA,IAAA;AAAA,EAAA,CAAA,GACWzN;AACX;AAQA,SAASk9E,GAAsBtqE,GAAAA;AAC3B,SAAI,aAAa2Q,KAAK3Q,KACXuF,OAAOvF,CAAAA,IAEXA;AACX;AC3GA,IAAI0qE,KAA8B;AAC9B,WAASA,EAAalhF,GAAM2gF,GACxB;AAAA,QAAIr7D,MAAMtlB,EAAKwsB,QAAAA,CAAAA;AACX,YAAM,IAAI20D,WAAW,qCAAA;AAEzB75E,SAAKtH,OAAOA,GACZsH,KAAKq5E,OAAOA;AAAAA,EACf;AAwBD,SAvBAzkE,OAAOklE,eAAeF,EAAarlE,WAAW,SAAS,EACnD0U,KAAK,WAAA;AACD,YAAQjpB,KAAKq5E,QAAQr5E,KAAKq5E,KAAKnsB,YAClC,MADoD;AAAA,EACpD,GACD6sB,YAAY,IACZC,iBAEJJ,CAAAA,GAAAA,EAAarlE,UAAUzE,WAAW,WAAA;AAC9B,QAAIgY,IAAUimD,GAAkB/tE,KAAKtH,KAAKwsB,QAAWllB,GAAAA,KAAKi6E;AAC1D,WAAKj6E,KAAKi6E,QAGH,IAAI95E,OAAO2nB,KAFP,SAAS3nB,OAAOH,KAAKq5E,MAAM,GAAKl5E,EAAAA,OAAO2nB;EAG1D,GACI8xD,EAAarlE,UAAU2Q,UAAU,WAAA;AAC7B,WAAOllB,KAAKtH,KAAKwsB,QACzB;AAAA,EAAA,GACI00D,EAAarlE,UAAU2lE,cAAc,WACjC;AAAA,WAAIl6E,KAAKi6E,QACEj6E,KAAKtH,QZ4HcA,IY1HRsH,KAAKtH,MZ0HS01E,IY1HHpuE,KAAKq5E,MZ2HtCc,IAAgBC,KAAKC,eAAAA,EAAiBC,kBAAkBlM,UAExDmM,IAAgB,IAAIrhF,KAAKi1E,GAAgBz1E,GAAMyhF,CAE/CK,CAAAA,GAAAA,IADiB,IAAIthF,KAAKi1E,GAAgBz1E,GAAiD01E,KAAW,QAC5ElpD,QAAYq1D,IAAAA,EAAcr1D,QACjD,GAAA,IAAIhsB,KAAKR,EAAKwsB,YAAYs1D,CANT;AAAA,QAAU9hF,GAAM01E,GACpC+L,GAEAI,GAEAC;AAAAA,EY9HR,GACWZ;AACX,EC5BO;AAAA,SAASa,GAAgBn+E,GAK5B;AAAA,WdkC2BmwC,GctCvB76B,IAAQ,IACR+mE,IAAU,IACV5iD,IAAOnhB,OAAOmhB,KAAKz5B,CAAAA,GACnBi8E,IAAc3jE,OAAOmhB,KAAK0iD,KACrB7+E,IAAI,GAAGA,IAAIm8B,EAAKl8B,QAAQD;AAC7B,QAAIm8B,EAAKn8B,OAAO,UAEXoyE,EAASuM,GAAaxiD,EAAKn8B,CAAhC,CAAA,GAAA;AAEA,UAAImQ,IAAMgsB,EAAKn8B,CAAGszD,EAAAA,YAAAA,GACdh+C,IAAQ5S,EAAQy5B,EAAKn8B,CACrB8gF,CAAAA,GAAAA,IAAW;AACf,UAAK7O,EAAU38D,QAAWkF,GAAQlF,CAAAA,KAAWA,EAAMrV,SAAnD;AAEA,gBAAQkQ;UACJ,KAAK;AACD2wE,YAAAA,IAAW3H,EAAMC,YAAY12E,EAAQu2E,IACrC;AAAA;AAAA,UACJ,KAAK;AAEG6H,YAAAA,IADA5O,GAAS58D,KACE,IAAIo8D,GAAQp8D,GAAOY,SAGnBZ,IAAAA,EAAMY;AAErB;AAAA,UACJ,KAAK;AAYD/F,YAAAA,IAAM,SACN2wE,KdDejuC,IcCIv9B,GdA3BkF,GAAQq4B,KACDA,IAEJ,CAACA,IcFSlyC,IAAI,SAAU45E,GACf;AAAA,qBAAIA,aAAgB7I,KACT6I,IAEP//D,GAAQ+/D,CAAAA,IACD,IAAI7I,GAAQ6I,EAAK,IAAIA,EAAK,CAAA,CAAA,IAE9B,IAAI7I,GAAQ6I,CACvC;AAAA,YAAA,CAAA,EACqBrkE;AACL;AAAA,UACJ,KAAK;AACD6oE,YAAAA,IAAUgC,GAAazrE,GAAO5S,EAAQ+8E,IAAAA;AACtC;AAAA,UACJ,KAAK;AACDqB,YAAAA,IAAW3M,GAAkB7+D,GAAQ5S,CAAAA,EAAQ+8E;AAC7C;AAAA,UACJ;AACI,gBAAIjlE,GAAQlF,CAAAA,GAAQ;AAEhB,uBADI0rE,IAAY,IACPrwD,IAAI,GAAGA,IAAIrb,EAAMrV,QAAQ0wB;AAC9BqwD,gBAAAA,EAAUrwD,CAAAA,IAAKnwB,OAAO8U,EAAMqb,CAEhCmwD,CAAAA;AAAAA,cAAAA,IAAWE,EAAU9qE,SACxB;AAAA,YAAA;AAEG4qE,cAAAA,IAAWtgF,OAAO8U,CAAAA;AAAAA,QAAAA;AAG1BwrE,QAAAA,KACA9oE,EAAMvY,KAAK,CAAC0Q,GAAK2wE,CAzDR,CAAA;AAAA,MAAA;AAAA,IALA;AAiEjB,MAAIhG,IAAQ9iE,EACPrX,IAAI,SAAU88E;AACf,QAAIttE,IAAMstE,EAAG,CAAA,GAAInoE,IAAQmoE,EAAG;AAC5B,WAAO,GAAGl3E,OAAO4J,GAAK,GAAA,EAAK5J,OAAO+O,EAAMY,SAAAA,CAAAA;AAAAA,EAChD,GACS3L,KAAK,GAAA,GACN02E,IAAa;AAIjB,SAHInG,MAAU,OACVmG,IAAa,SAAS16E,OAAOu0E,CAAAA,IAE1B,CAACiE,GAASkC,CAAY9qE,EAAAA,OAAO,SAAUiS,GAAK;AAAA,WAAA,CAAA,CAASA;AAAAA,EAAE,CAAI7d,EAAAA,KAAK;AAAA;AAC3E;AACA,SAASw2E,GAAahC,GAASU,GAC3B;AAAA,SAAKV,IAGE,YAAY,IAAIiB,GAAa,IAAI1gF,KAAKy/E,IAAUU,CAAMvpE,EAAAA,SAAAA,IAFlD;AAGf;AC7FA,SAASgrE,GAAUjjF,GAAM4lB,GACrB;AAAA,SAAIlb,MAAM6R,QAAQvc,CAAAA,IAAAA,CAAAA,CACT0K,MAAM6R,QAAQqJ,CAAAA,KAEf5lB,EAAKgC,WAAW4jB,EAAM5jB,UAEnBhC,EAAKs4E,MAAM,SAAUz3E,GAAMkB,GAAK;AAAA,WAAOlB,EAAKwsB,QAAczH,MAAAA,EAAM7jB,CAAGsrB,EAAAA,QAAAA;AAAAA,EAAY,CAEtFrtB,IAAAA,aAAgBqB,OACTukB,aAAiBvkB,QAAQrB,EAAKqtB,QAAczH,MAAAA,EAAMyH,YAEtDrtB,MAAS4lB;AACpB;AACA,IAAIs9D,KAAuB,WAAA;AACvB,WAASA,IACL/6E;AAAAA,SAAKg7E,UACLh7E,KAAKuuE,SAAS,CACdvuE,GAAAA,KAAKwuE,QAAQ,CAAA,GACbxuE,KAAKi7E,UAAU;EAClB;AAqED,SA/DAF,EAAMxmE,UAAU2mE,YAAY,SAAUC,GAAMjsE,GAAOM,GAC3CN;AAAAA,UACAA,IAAQA,aAAiBhW,OAAO8lE,GAAM9vD,CAAAA,IAAS2+D,GAAW3+D,CAEjD,IAATisE,MAAS,QACTn7E,KAAKg7E,MAAM9rE,KAGXM,EAAK4rE,SAASlsE,GACdlP,KAAKm7E,CAAM9hF,EAAAA,KAAKmW;EAE5B,GAQIurE,EAAMxmE,UAAU8mE,YAAY,SAAUF,GAAM3rE,GAAAA;AACxC,QAAI8rE,IAAAA,IACAC,IAAW/rE,IAAOoF,OAAOmhB,KAAKvmB,CAAAA,IAAQ,IACtCgsE,IAAgB,SAAU/uC,GAC1B;AAAA,eAAS7yC,IAAI,GAAGA,IAAI2hF,EAAS1hF,QAAQD,KAAK;AACtC,YAAImQ,IAAMwxE,EAAS3hF,CACnB;AAAA,YAAA,CAAKkhF,GAAUtrE,EAAKzF,IAAM0iC,EAAK1iC,CAAAA,CAAAA;AAC3B;MAEP;AACD;IACZ,GACY0xE,IAAez7E,KAAKm7E,CACxB;AAAA,QAAIA,MAAS;AACTG,UAASt7E,KAAKg7E;AAAAA,aAET5mE,GAAQqnE,CAGb;AAAA,eAAS7hF,IAAI,GAAGA,IAAI6hF,EAAa5hF,QAAQD,KAAK;AAC1C,YAAI6yC,IAAOgvC,EAAa7hF,CACxB;AAAA,YAAA,CAAI2hF,EAAS1hF,UAAAA,CAAU2hF,EAAc/uC,CAAAA,GAArC;AAEA6uC,cAAS7uC,EAAK2uC;AACd;AAAA,QAFa;AAAA,MAGhB;AAEL,QAAKE,CAAAA,KAAUt7E,KAAKg7E,KAAK;AAGrB,UAAIU,IAAa,IAAIrN,GAAW8M,GAAM3rE,CAAAA;AACtC,WAAS5V,IAAI,GAAGA,IAAIoG,KAAKg7E,IAAInhF,UACpB6hF,EAAWjN,OAAOzuE,KAAKg7E,IAAIphF,CADCA,CAAAA,GAAAA;AAAAA;AAIrC0hF,UAASI,EAAW1sD,SAAAA,GACpBhvB,KAAKk7E,UAAUC,GAAMG,GAAQ9rE;IAChC;AACD,WAAO4E,GAAQknE,CACTzN,IAAAA,GAAWyN,KACXA,aAAkBpiF,OACd8lE,GAAMsc,CAAAA,IACNA;AAAAA,EAClB,GACWP;AACX,KCtFIY,KAAWvM,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAIlD,GAAAA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,EAAA,GAAA,KAAYA,EAAO,GAAG,OAAYA,GAAAA,EAAO,GAAG,EAAA,GAAA,EAAYA,GAAAA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,EAAA,GAAA,KAAYA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,OAAYA,GAAAA,EAAO,IAAI,EAAK,GAAA,EAAA,GAAOA,EAAO,IAAI,EAAA,GAAA,KAAYA,EAAO,IAAI,OAAYA,GAAAA,EAAO,GAAG,CAAI,GAAA,EAAA,GAC9d0P,KAAWxM,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAIlD,GAAAA,EAAO,GAAG,EAAA,GAAA,EAAYA,GAAAA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,EAAA,GAAA,KAAYA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,OAAYA,GAAAA,EAAO,GAAG,EAAK,GAAA,EAAA,GAAOA,EAAO,GAAG,EAAA,GAAA,EAAYA,GAAAA,EAAO,GAAG,EAAA,GAAA,KAAYA,EAAO,GAAG,OAAYA,GAAAA,EAAO,IAAI,EAAK,GAAA,EAAA,GAAOA,EAAO,IAAI,EAAK,GAAA,EAAA,GAAOA,EAAO,IAAI,EAAA,GAAA,KAAYA,EAAO,GAAG,MAC1d2P,GAAAA,KAAMhrD,GAAM,GAAG,EACfirD,GAAAA,KAAMjrD,GAAM,GAAG,EAAA,GACfkrD,KAAMlrD,GAAM,GAAG,KACfmrD,KAAMnrD,GAAM,GAAG,EAAA,GACforD,KAAc7M,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,IAAI4M,IAAK,EAAA,GAAOF,MAAYE,GAAAA,IAAAA,KAAYD,IAAK,EAAA,GAAOC,IAAK,EAAA,GAAOD,IAAK,EAAA,GAAOC,MAAYA,GAAAA,IAAAA,KAAYD,IAAK,EAAA,GAAOC,MAAYD,GAAAA,IAAAA,EAAYC,GAAAA,IAAAA,EAAYA,GAAAA,GAAIv5E,MAAM,GAAG,CAAA,GAAA,KACrWy5E,KAAc9M,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAA,GAAI4M,MAAYH,GAAAA,IAAAA,EAAYG,GAAAA,IAAAA,EAAYD,GAAAA,IAAAA,KAAYC,IAAK,EAAA,GAAOD,MAAYC,GAAAA,IAAAA,KAAYA,IAAK,EAAA,GAAOD,IAAK,EAAA,GAAOC,IAAK,EAAA,GAAOD,MAAYC,GAAAA,IAAAA,KAAYA,GAAIv5E,MAAM,GAAG,CAAI,GAAA,EAAA,GACzW05E,KAAOtrD,GAAAA,KAAW,CAAA,GAClBurD,KAAOvrD,GAAO,KAAI,IAClBwrD,KAAOxrD,GAAAA,KAAW,CAClByrD,GAAAA,KAAOzrD,GAAO,KAAI,CAClB0rD,GAAAA,KAAenN,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,IAAIkN,IAAM,EAAA,GAAOF,MAAaE,GAAAA,IAAAA,KAAaD,IAAM,EAAA,GAAOC,IAAM,EAAA,GAAOD,IAAM,EAAA,GAAOC,MAAaA,GAAAA,IAAAA,KAAaD,IAAM,EAAA,GAAOC,MAAaD,GAAAA,IAAAA,EAAaC,GAAAA,IAAAA,EAAaA,GAAAA,GAAK75E,MAAM,GAAG,CAAA,GAAA,KACnX+5E,KAAepN,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAcA,EAAc,CAAA,GAAIkN,MAAaH,GAAAA,IAAAA,EAAaG,GAAAA,IAAAA,EAAaD,GAAAA,IAAAA,KAAaC,IAAM,EAAA,GAAOD,MAAaC,GAAAA,IAAAA,KAAaA,IAAM,EAAA,GAAOD,IAAM,EAAA,GAAOC,IAAM,EAAA,GAAOD,MAAaC,GAAAA,IAAAA,KAAaA,GAAK75E,MAAM,GAAG,CAAI,GAAA,EAAA,GACvXg6E,KAAY,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,GAAA,GACpEC,KAAY,CAAC,GAAG,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MACpEC,KAAW,WAAA;AAEX,WADIC,IAAW,IACNhjF,IAAI,GAAGA,IAAI,IAAIA;AACpBgjF,QAAWA,EAASz8E,OAAO0wB,GAAM;AACrC,SAAO+rD;AACV,ECvBM;AAAA,SAASC,GAAYtmD,GAAMj6B,GAC9B;AAAA,MAUIwgF,GACAC,GAXAC,IAAYpQ,GAASr2C,GAAM,GAAG,IAC9B0mD,IAAUhQ,GAAW12C,CAAQ,IAAA,MAAM,KACnC2mD,IAAcjQ,GAAW12C,IAAO,CAAA,IAAK,MAAM,KAC3C4mD,IAAchQ,GAAU6P,CACxBI,GAAAA,IAAc3P,GAAWuP,CAAAA,GACzBjuE,IAASmgE,GAASA,GAAS,EAAE+N,SAASA,GAASC,aAAaA,GAAaC,aAAaA,GAAaC,aAAaA,EAgGxH,GAAA,SAAuB7mD,GACnB;AAAA,QAAI0mD,IAAUhQ,GAAW12C,CAAAA,IAAQ,MAAM,KACnCymD,IAAYpQ,GAASr2C,GAAM,GAAG,CAC9B49C,GAAAA,IAAO1G,GAAWuP,CAAAA;AACtB,WAAIC,MAAY,MACL,EACHI,OAAO1B,IACP2B,UAAUpB,IACVqB,WAAWf,IACXI,UAAUD,GAASl6E,MAAM0xE,CACzBqJ,GAAAA,QAAQd,OAGT,EACHW,OAAOzB,IACP0B,UAAUrB,IACVsB,WAAWhB,IACXK,UAAUD,GAASl6E,MAAM0xE,CAAAA,GACzBqJ,QAAQf,GAEhB;AAAA,EAAA,EApHqJlmD,CAAQ,CAAA,GAAA,EAAEknD,SAAS,KAAA,CAAA;AACpK,MAAI/Q,GAAMpwE,EAAQy3E,QACd;AAAA,WAAOhlE;AAEXA,EAAAA,EAAO0uE,UAAUvR,EAAO,GAAG+Q,IAAU,CAGrC;AAAA,MAAIS,IAAWZ,IAAYvQ,GAAM,IAAI6Q,IAAc9gF,EAAQ06E,MAAM,CAAA;AAC7D0G,EAAAA,KAAW,KACXA,IAAU,GAGVX,IAAWhuE,EAAOkuE,UAAU1Q,GAAM6Q,IAAc9gF,EAAQ06E,MAAM,CAK9D+F,KAAAA,IAAWE,IAAUS;AAKzB,WAHI37E,IAAM+D,KAAK+D,MAAMkzE,IAAW,CAC5BtQ,GAAAA,IAAMF,GAAMwQ,GAAU,CAAA,GACtBY,IAAW73E,KAAK+D,MAAM9H,IAAM0qE,IAAM,CAC7BliD,GAAAA,IAAI,GAAGA,IAAIjuB,EAAQy3E,SAASl6E,QAAQ0wB,KAAK;AAC9C,QAAI5uB,IAAIW,EAAQy3E,SAASxpD,CAIzB;AAAA,QAHI5uB,IAAI,MACJA,KAAKgiF,IAAW,IAEdhiF,IAAI,KAAKA,KAAKgiF,GAApB;AAGA,UAAI/jF,IAAI;AACJ+B,MAAAA,IAAI,KACJ/B,IAAI8jF,IAAoB,KAAT/hF,IAAI,IACf+hF,MAAYZ,MACZljF,KAAK,IAAIkjF,MAIbljF,IAAI8jF;AAER,eAASr6E,IAAI,GAAGA,IAAI,MAChB0L,EAAO0uE,QAAQ7jF,CAAAA,IAAK,GACpBA,KACImV,EAAO6tE,SAAShjF,CAAAA,MAAO0C,EAAQ06E,OAHhB3zE;AAAAA;AAAAA,IAXtB;AAAA,EAiBJ;AACD,MAAI2oE,EAAS1vE,EAAQy3E,UAAU,CAAA,MAGvBn6E,IAAI8jF,IAAqB,IAAXC,GACdD,MAAYZ,MACZljF,KAAK,IAAIkjF,IACTljF,IAAIqjF;AAGJ,SAAS1yD,IAAI,GAAGA,IAAI,MAChBxb,EAAO0uE,QAAQ7jF,CAAK,IAAA,GACpBA,KAAK,GACDmV,EAAO6tE,SAAShjF,OAAO0C,EAAQ06E,OAHhBzsD;;AAQ/B,MAAImzD,GAAS;AAOT,QAAIE,IAAY;AAChB,QAAK5R,EAAS1vE,EAAQy3E,UAAW,EAAA;AAe7B6J,MAAAA;SAfiC;AACjC,UAAIC,IAAepQ,GAAWb,GAASr2C,IAAO,GAAG,GAAG,KAChDunD,IAAWvR,GAAM,IAAIsR,EAAa1kF,QAAAA,IAAYmD,EAAQ06E,MAAM,CAAA,GAC5D+G,IAAW9Q,GAAW12C,IAAO,CAAA,IAAK,MAAM,KACxCynD,IAAAA;AACAF,MAAAA,KAAY,KACZA,IAAW,GACXE,IAASD,IAAWxR,GAAMsR,IAAevhF,EAAQ06E,MAAM,CAGvDgH,KAAAA,IAASf,IAAUS,GAEvBE,IAAY93E,KAAK+D,MAAM,KAAK0iE,GAAMyR,GAAQ,CAAK,IAAA,CAAA;AAAA,IAClD;AAID,QAAIhS,EAAS1vE,EAAQy3E,UAAU6J,CAAAA;AAC3B,WAAShkF,IAAI,GAAGA,IAAI8jF,GAAS9jF;AACzBmV,QAAAA,EAAO0uE,QAAQ7jF,CAAK,IAAA;AAAA,EAE/B;AACD,SAAOmV;AACX;AC/FA,IAAIkvE,KAA0B,WAE1B;AAAA,WAASA,EAAS3hF,GAAAA;AACd0D,SAAK1D,UAAUA;AAAAA,EAClB;AA0KD,SAzKA2hF,EAAS1pE,UAAU2pE,UAAU,SAAU3nD,GAAMD,GAAAA;AACzC,QAAIh6B,IAAU0D,KAAK1D;AAInB,QAHIi6B,MAASv2B,KAAKm+E,aACdn+E,KAAKo+E,WAAWvB,GAAYtmD,GAAMj6B,CAAAA,IAElCqwE,GAASrwE,EAAQu8E,gBAChBviD,MAAUt2B,KAAKq+E,aAAa9nD,MAASv2B,KAAKm+E,WAAW;AACtD,UAAI9G,IAAKr3E,KAAKo+E,UAAUnB,IAAU5F,EAAG4F,SAASO,IAASnG,EAAGmG,QAAQZ,IAAWvF,EAAGuF;AAChF58E,WAAKs+E,YCrBV,SAAsB/nD,GAAMD,GAAO2mD,GAASO,GAAQZ,GAAUtgF;AACjE,YAAIyS,IAAS,EACTovE,UAAU5nD,GACV8nD,WAAW/nD,GACXioD,WAAW,MAEXC,IAAS,CAAA;AACb,YAAIliF,EAAQu2E,SAASE,EAAMc;AACvB,cAAInH,GAAMpwE,EAAQ+2E,OACdmL;AAAAA,YAAAA,IAAS,CAAC,CAAC,GAAGvB;;AAGd,qBAAS1yD,IAAI,GAAGA,IAAIjuB,EAAQ+2E,QAAQx5E,QAAQ0wB;AACxC+L,cAAAA,IAAQh6B,EAAQ+2E,QAAQ9oD,IACxBi0D,EAAOnlF,KAAKmkF,EAAO/6E,MAAM6zB,IAAQ,GAAGA,IAAQ,CAI/Ch6B,CAAAA;AAAAA;AAAAA,UAAAA,EAAQu2E,SAASE,EAAMa,YAC5B4K,IAAS,CAAChB,EAAO/6E,MAAM6zB,IAAQ,GAAGA,IAAQ,CAAA,CAAA;AAE9C,YAAIo2C,GAAM8R;AACN,iBAAOzvE;AAKX,aADAA,EAAOwvE,YAAYrS,EAAO,GAAG+Q,CAAAA,GACpB1yD,IAAI,GAAGA,IAAIi0D,EAAO3kF,QAAQ0wB;AAI/B,mBAHI0hD,IAAOuS,EAAOj0D,IACdkG,IAAQw7C,EAAK,CACbz7C,GAAAA,IAAOy7C,EAAK,CAAA,IAAK,GACZ5oE,IAAI,GAAGA,IAAI/G,EAAQu8E,WAAWh/E,QAAQwJ,KAAK;AAChD,gBAAIzJ,IAAAA,QACAy9E,IAAK/6E,EAAQu8E,WAAWx1E,CAAAA,GAAI8wE,IAAOkD,EAAG,CAAA,GAAI17E,IAAI07E,EAAG,CAAA;AACjD17E,YAAAA,IAAI,KACJ/B,IAAI42B,IAAiB,KAAT70B,IAAI,IAChB/B,KAAK2yE,GAAMqQ,EAAShjF,CAAKu6E,IAAAA,GAAM,CAG/Bv6E,MAAAA,IAAI62B,IAAkB,KAAT90B,IAAI,IACjB/B,KAAK2yE,GAAM,IAAIqQ,EAAShjF,KAAKu6E,GAAM,CAAA,IAEnC1jD,KAAS72B,KAAKA,KAAK42B,MACnBzhB,EAAOwvE,UAAU3kF,CAAAA,IAAK;AAAA,UAC7B;AAEL,eAAOmV;AAAAA,MACX,ED1B0CwnB,GAAMD,GAAO2mD,GAASO,GAAQZ,GAAUtgF,CACzE;AAAA,IAAA;AACGuvE,IAAAA,EAAUvvE,EAAQo8E,QAAAA,MAClB14E,KAAKy+E,aE1BV,SAAgB18D,GAAG9Z,GAAAA;AAAAA,MAClBA,MADkBA,WACGA,IAAS;AAClC,UAAI4Q,IAAIkJ,IAAI,IACRjJ,IAAIhT,KAAK+D,MAAMkY,IAAI,GAAA,GACnBnjB,IAAImjB,IAAI,KACR1Z,IAAIvC,KAAK+D,MAAMiP,IAAI,CAAA,GACnB5d,IAAI4d,IAAI,GACR5E,IAAIpO,KAAK+D,OAAOiP,IAAI,KAAK,EACzB4lE,GAAAA,IAAI54E,KAAK+D,OAAOiP,IAAI5E,IAAI,KAAK,CAAA,GAC7BoE,IAAIxS,KAAK+D,MAAM,KAAKgP,IAAIC,IAAIzQ,IAAIq2E,IAAI,EAAM,IAAA,IAC1C9kF,IAAIkM,KAAK+D,MAAMjL,IAAI,CACnByE,GAAAA,IAAIzE,IAAI,GACR0wE,IAAIxpE,KAAK+D,MAAM,KAAK,IAAI3O,IAAI,IAAItB,IAAI0e,IAAIjV,CAAK,IAAA,GAC7Cm2D,IAAI1zD,KAAK+D,OAAOgP,IAAI,KAAKP,IAAI,KAAKg3D,KAAK,GAAA,GACvCh5C,IAAQxwB,KAAK+D,OAAOyO,IAAIg3D,IAAI,IAAI9V,IAAI,OAAO,EAC3C70D,GAAAA,KAAQ2T,IAAIg3D,IAAI,IAAI9V,IAAI,OAAO,KAAM,GACrC9gE,IAAOQ,KAAKqrB,IAAIxC,GAAGuU,IAAQ,GAAG3xB,IAAMsD,CACpC02E,GAAAA,IAAYzlF,KAAKqrB,IAAIxC,GAAG,GAAG;AAC/B,aAAO,CAACjc,KAAKg2C,MAAMpjD,IAAOimF,UAC9B,CAAA;AAAA,IAAA,EFOqCpoD,GAAMj6B,EAAQo8E,QAAAA;AAAAA,EAEnD,GACI9jE,OAAOklE,eAAemE,EAAS1pE,WAAW,YAAY,EAClD0U,KAAK,WAAA;AACD,WAAOjpB,KAAKs+E,YAAYt+E,KAAKs+E,UAAUH,WAAW;AAAA,EACrD,GACDpE,YAAY,IACZC,iBAEJplE,CAAAA,GAAAA,OAAOklE,eAAemE,EAAS1pE,WAAW,aAAa,EACnD0U,KAAK,WAAA;AACD,WAAOjpB,KAAKs+E,YAAYt+E,KAAKs+E,UAAUD,YAAY;AAAA,EACtD,GACDtE,YAAY,IACZC,iBAEJplE,CAAAA,GAAAA,OAAOklE,eAAemE,EAAS1pE,WAAW,WAAW,EACjD0U,KAAK,WACD;AAAA,WAAOjpB,KAAKo+E,SAASnB;AAAAA,EACxB,GACDlD,YAAAA,IACAC,cAAc,GAAA,CAAA,GAElBplE,OAAOklE,eAAemE,EAAS1pE,WAAW,eAAe,EACrD0U,KAAK;AACD,WAAOjpB,KAAKo+E,SAASjB;AAAAA,EACxB,GACDpD,gBACAC,cAAAA,GAEJplE,CAAAA,GAAAA,OAAOklE,eAAemE,EAAS1pE,WAAW,UAAU,EAChD0U,KAAK,WACD;AAAA,WAAOjpB,KAAKo+E,SAASZ;AAAAA,EACxB,GACDzD,YAAAA,IACAC,cAAAA,OAEJplE,OAAOklE,eAAemE,EAAS1pE,WAAW,YAAY,EAClD0U,KAAK,WAAA;AACD,WAAOjpB,KAAKo+E,SAASxB;AAAAA,EACxB,GACD7C,YAAY,IACZC,iBAEJplE,CAAAA,GAAAA,OAAOklE,eAAemE,EAAS1pE,WAAW,SAAS,EAC/C0U,KAAK,WAAA;AACD,WAAOjpB,KAAKo+E,SAASf;AAAAA,EACxB,GACDtD,YAAAA,IACAC,cAAc,GAAA,CAAA,GAElBplE,OAAOklE,eAAemE,EAAS1pE,WAAW,WAAW,EACjD0U,KAAK;AACD,WAAOjpB,KAAKo+E,SAASX;AAAAA,EACxB,GACD1D,gBACAC,cAAAA,OAEJplE,OAAOklE,eAAemE,EAAS1pE,WAAW,aAAa,EACnD0U,KAAK,WAAA;AACD,WAAOjpB,KAAKs+E,YAAYt+E,KAAKs+E,UAAUC,YAAY,CAAA;AAAA,EACtD,GACDxE,YAAY,IACZC,iBAEJplE,CAAAA,GAAAA,OAAOklE,eAAemE,EAAS1pE,WAAW,eAAe,EACrD0U,KAAK,WAAA;AACD,WAAOjpB,KAAKo+E,SAASlB;AAAAA,EACxB,GACDnD,YAAAA,IACAC,cAAAA,GAEJplE,CAAAA,GAAAA,OAAOklE,eAAemE,EAAS1pE,WAAW,YAAY,EAClD0U,KAAK;AACD,WAAOjpB,KAAKo+E,SAASd;AAAAA,EACxB,GACDvD,YAAAA,IACAC,cAAc,GAAA,CAAA,GAElBplE,OAAOklE,eAAemE,EAAS1pE,WAAW,aAAa,EACnD0U,KAAK,WAAA;AACD,WAAOjpB,KAAKo+E,SAASb;AAAAA,EACxB,GACDxD,gBACAC,cAAAA,OAEJiE,EAAS1pE,UAAUqqE,UAAU,WAAA;AACzB,WAAO,CAAC/tD,GAAM7wB,KAAKi9E,OAAAA,GAAU,GAAGj9E,KAAKi9E,OAAAA;AAAAA,EAC7C,GACIgB,EAAS1pE,UAAUsqE,UAAU,SAAU35E,GAAGoxB,GAAAA;AAItC,aAHI3yB,IAAQ3D,KAAKw9E,OAAOlnD,IAAQ,IAC5B1yB,IAAM5D,KAAKw9E,OAAOlnD,CAAAA,GAClBpS,IAAMgoD,EAAO,MAAMlsE,KAAKi9E,OAAAA,GACnBrjF,IAAI+J,GAAO/J,IAAIgK,GAAKhK;AACzBsqB,MAAAA,EAAItqB,CAAKA,IAAAA;AACb,WAAO,CAACsqB,GAAKvgB,GAAOC,CAAAA;AAAAA,EAC5B,GACIq6E,EAAS1pE,UAAUuqE,UAAU,SAAUvoD,GAAMD,GAAO3xB,GAAAA;AAKhD,aAHIuf,IAAMgoD,EAAO,MAAMlsE,KAAKi9E,UAAU,CAAA,GAClCrjF,IAAIuzE,GAAUP,GAASr2C,GAAMD,GAAO3xB,CAAQ3E,CAAAA,IAAAA,KAAKm9E,aACjDx5E,IAAQ/J,GACH2wB,IAAI,GAAGA,IAAI,MAChBrG,EAAItqB,CAAAA,IAAKA,GACPA,EAAAA,GACEoG,KAAK48E,SAAShjF,OAAOoG,KAAK1D,QAAQ06E,OAHnBzsD;AAMvB;AAAA,WAAO,CAACrG,GAAKvgB,GAAO/J,CAC5B;AAAA,EAAA,GACIqkF,EAAS1pE,UAAUwqE,UAAU,SAAUxoD,GAAMD,GAAO3xB,GAChD;AAAA,QAAIuf,IAAMgoD,EAAO,MAAMlsE,KAAKi9E,OAAAA,GACxBrjF,IAAIuzE,GAAUP,GAASr2C,GAAMD,GAAO3xB,MAAQ3E,KAAKm9E;AAErD,WADAj5D,EAAItqB,CAAAA,IAAKA,GACF,CAACsqB,GAAKtqB,GAAGA,IAAI,CAC5B;AAAA,EAAA,GACIqkF,EAAS1pE,UAAUyqE,WAAW,SAAU3wC,GAAMnpC,GAAGorE,GAAQgG,GACrD;AAAA,QAAI3G,IAAQ3vE,MACRkkB,IAAM;AAKV,WAJAlkB,KAAK1D,QAAQo7E,SAAS58E,QAAQ,SAAUwzC,GAAAA;AACpCpqB,MAAAA,IAAMA,EAAI/jB,OAAOwvE,EAAMsP,SAAS5wC,GAAMC,GAAQgiC,GAAQgG;IAClE,CACQh1D,GAAAA,GAAK4C,CACEA,GAAAA;AAAAA,EACf,GACI+5D,EAAS1pE,UAAU0qE,WAAW,SAAU5wC,GAAMC,GAAQppC,GAAGoxE;AACrD,QAAIpyD,IAAMlkB,KAAK1D,QAAQy7E,SAASx9E,IAAI,SAAU+1E,GAAU;AAAA,aAAO,IAAI+F,GAAKhoC,GAAMC,GAAQgiC,GAAQgG,CAAAA;AAAAA,IAAa,CAE3G;AAAA,WADAh1D,GAAK4C,CAAAA,GACEA;AAAAA,EACf,GACI+5D,EAAS1pE,UAAU2qE,WAAW,SAAU7wC,GAAMC,GAAQgiC,GAAQgG,GAC1D;AAAA,WAAO,CAAC,IAAID,GAAKhoC,GAAMC,GAAQgiC,GAAQgG,CAC/C,CAAA;AAAA,EAAA,GACI2H,EAAS1pE,UAAU4qE,YAAY,SAAUtM,GAAAA;AACrC,YAAQA,GAAAA;AAAAA,MACJ,KAAKtD,EAAUsE;AACX,eAAO7zE,KAAK4+E,QAAQ/uE,KAAK7P,IAC7B;AAAA,MAAA,KAAKuvE,EAAUqE;AACX,eAAO5zE,KAAK6+E,QAAQhvE,KAAK7P,IAAAA;AAAAA,MAC7B,KAAKuvE,EAAUoE;AACX,eAAO3zE,KAAK8+E,QAAQjvE,KAAK7P,IAAAA;AAAAA,MAC7B,KAAKuvE,EAAU6D;AAAAA,MAEf;AACI,eAAOpzE,KAAK++E,QAAQlvE,KAAK7P;;EAEzC,GACIi+E,EAAS1pE,UAAU6qE,aAAa,SAAUvM,GAAAA;AACtC,YAAQA,GACJ;AAAA,MAAA,KAAKtD,EAAU2D;AACX,eAAOlzE,KAAKg/E,SAASnvE,KAAK7P,IAC9B;AAAA,MAAA,KAAKuvE,EAAU4D;AACX,eAAOnzE,KAAKi/E,SAASpvE,KAAK7P,IAC9B;AAAA,MAAA,KAAKuvE,EAAU4I;AACX,eAAOn4E,KAAKk/E,SAASrvE,KAAK7P,IAAAA;AAAAA,IAAAA;AAAAA,EAE1C,GACWi+E;AACX;AGvLO,SAASoB,GAAazG,GAAU0G,GAAS37E,GAAOC,GAAK27E,GAAIC,GAE5D;AAAA,WADIC,IAAU,CAAA,GACLl1D,IAAI,GAAGA,IAAIquD,EAAS/+E,QAAQ0wB,KAAK;AACtC,QAAIm1D,IAAS,QACTC,YACA9jC,IAAM+8B,EAASruD,CACfsxB;AAAAA,IAAAA,IAAM,KACN6jC,IAAS55E,KAAK+D,MAAMgyC,IAAMyjC,EAAQzlF,MAAAA,GAClC8lF,IAAUpT,GAAM1wB,GAAKyjC,EAAQzlF,MAG7B6lF,MAAAA,IAAS55E,KAAK+D,OAAOgyC,IAAM,KAAKyjC,EAAQzlF,MACxC8lF,GAAAA,IAAUpT,GAAM1wB,IAAM,GAAGyjC,EAAQzlF,MAGrC;AAAA,aADI+lF,IAAM,CAAA,GACDv8E,IAAIM,GAAON,IAAIO,GAAKP,KAAK;AAC9B,UAAI2iC,IAAMw5C,EAAOn8E;AACZwoE,MAAAA,EAAU7lC,CAAAA,KAEf45C,EAAIvmF,KAAK2sC,CACZ;AAAA,IAAA;AACD,QAAIpsC,IAAI;AAEJA,IAAAA,IADA8lF,IAAS,IACLE,EAAIn9E,MAAMi9E,CAAAA,EAAQ,CAGlBE,IAAAA,EAAIF,CAEZ;AAAA,QAAI7vD,IAAOyvD,EAAQK,CAAAA,GACfjnF,IAAO40E,GAAYiS,EAAGpC,cAAcvjF,CACpCkE,GAAAA,IAAM6vE,GAAQj1E,GAAMm3B,CAGnBm8C;AAAAA,IAAAA,EAASyT,GAAS3hF,CACnB2hF,KAAAA,EAAQpmF,KAAKyE,CACpB;AAAA,EAAA;AAED,SADAwjB,GAAKm+D,CAAAA,GACEA;AACX;AC/BO,SAASI,GAAKnE,GAAYp/E,GAC7B;AAAA,MAAIq8E,IAAUr8E,EAAQq8E,SAAS9F,IAAOv2E,EAAQu2E,MAAMtnC,IAAWjvC,EAAQivC,UAAU0iC,IAAQ3xE,EAAQ2xE,OAAO2K,IAAWt8E,EAAQs8E,UACvHh3B,IAAQtlD,EAAQslD;AACpB,MAAIA,MAAU,KAAKrW,MAAa;AAC5B,WAAOu0C,GAAWpE,CAAAA;AAEtB,MAAIqE,IAAcxJ,GAASC,SAASmC,CAChC4G,GAAAA,IAAK,IAAItB,GAAS3hF,CACtBijF;AAAAA,EAAAA,EAAGrB,QAAQ6B,EAAYxpD,MAAMwpD,EAAYzpD,KAEzC;AAAA,WADIgpD,IAqGR,SAAqBC,GAAIQ,GAAazjF,GAAAA;AAClC,QAAIu2E,IAAOv2E,EAAQu2E,MAAMY,IAASn3E,EAAQm3E,QAAQiE,IAAWp7E,EAAQo7E,UAAUK,IAAWz7E,EAAQy7E;AAClG,WAAI5B,GAAqBtD,CAAAA,IXgEtB,SAAsB3oD,GAAAA;AACzB,UAAI81D,IAAoB91D,EAAKyuD,QAAQzzD,QAAAA,IAAY;AACjD,UAAA,CAAKixD,GAAqBjsD,EAAK2oD,IAAAA;AAC3B,eAAO,CAEX;AAAA,UAAIyM,IAAU,CAQd;AAAA,aAPAp1D,EAAKupD,OAAO34E,QAAQ,SAAUuzC;AAC1BnkB,QAAAA,EAAKwtD,SAAS58E,QAAQ,SAAUwzC,GAAAA;AAC5BpkB,UAAAA,EAAK6tD,SAASj9E,QAAQ,SAAUw1E,GAAAA;AAC5BgP,YAAAA,EAAQjmF,KAAK,IAAIg9E,GAAKhoC,GAAMC,GAAQgiC,GAAQ0P,CAAAA,CAAAA;AAAAA,UAC5D;QACA,CACA;AAAA,MAAA,CAAA,GACWV;AAAAA,IACX,EW7E4BhjF,CAAAA,IAEnBu2E,KAAQE,EAAMG,UACfvG,GAAS8G,CAAAA,KAAAA,CACRzH,EAASyH,GAAQsM,EAAY1xC,IAC7BwkC,KAAAA,KAAQE,EAAMI,YACXxG,GAAS+K,CACR1L,KAAAA,CAAAA,EAAS0L,GAAUqI,EAAYzxC,MAAAA,KACnCukC,KAAQE,EAAMoF,YACXxL,GAASoL,CAAAA,KAAAA,CACR/L,EAAS+L,GAAUgI,EAAYzP,MACpC,IAAO,KAEJiP,EAAGH,WAAWvM,CAAd0M,EAAoBQ,EAAY1xC,MAAM0xC,EAAYzxC,QAAQyxC,EAAYzP,QAAQyP,EAAYzJ,WACrG;AAAA,EAAA,EAtH8BiJ,GAAIQ,GAAazjF,CAClC,OAAA;AACL,QAAI+6E,IAAKkI,EAAGJ,UAAUtM,CAAAA,EAAMkN,EAAYxpD,MAAMwpD,EAAYzpD,OAAOypD,EAAYp7E,GAAM66E,GAAAA,IAASnI,EAAG,CAAA,GAAI1zE,IAAQ0zE,EAAG,CAAA,GAAIzzE,IAAMyzE,EAAG,CAAA,GACvHD,IAAW6I,GAAmBT,GAAQ77E,GAAOC,GAAK27E,GAAIjjF,CAAAA;AAC1D,QAAIqwE,GAASiM,CAAAA;AAET,eADI6G,IAAUJ,GAAazG,GAAU0G,GAAS37E,GAAOC,GAAK27E,GAAIC,CAAAA,GACrDj1D,IAAI,GAAGA,IAAIk1D,EAAQ5lF,QAAQ0wB,KAAK;AACrC,YAAIzsB,IAAM2hF,EAAQl1D,CAAAA;AAClB,YAAI0jD,KAASnwE,IAAMmwE;AACf,iBAAO6R,GAAWpE,CAEtB;AAAA,YAAI59E,KAAO66E,GAAS;AAChB,cAAIuB,IAAcgG,GAAepiF,GAAKxB;AAItC,cAHKo/E,CAAAA,EAAWjN,OAAOyL,CACnB,KAEAt4B,KACEA,CAAAA,EAAAA;AAEE,mBAAOk+B,GAAWpE;QAG7B;AAAA,MACJ;AAAA;AAGD,WAASnxD,IAAI5mB,GAAO4mB,IAAI3mB,GAAK2mB,KAAK;AAC9B,YAAI41D,IAAaX,EAAOj1D;AACxB,YAAKshD,EAAUsU;AAIf,mBADIznF,IAAO40E,GAAYiS,EAAGpC,cAAcgD,CAAAA,GAC/B98E,IAAI,GAAGA,IAAIi8E,EAAQzlF,QAAQwJ,KAAK;AACrC,gBAAIwsB,IAAOyvD,EAAQj8E,CAAAA;AAKnB,gBAJIvF,IAAM6vE,GAAQj1E,GAAMm3B,CAAAA,GACpBo+C,KAASnwE,IAAMmwE,KAGfnwE,KAAO66E,MACHuB,IAAcgG,GAAepiF,GAAKxB,CACtC,GAAA,CAAKo/E,EAAWjN,OAAOyL,CAAAA,KAGnBt4B,KAAAA,CAAAA,EACEA;AAEE,qBAAOk+B,GAAWpE,CAG7B;AAAA,UACJ;AAAA,MACJ;AAOL,QALIp/E,EAAQivC,aAAa,MAIzBw0C,EAAYpnF,IAAI2D,GAAS86E,IACrB2I,EAAYxpD,OrBxDH;AqByDT,aAAOupD,GAAWpE,CAEjBvF;AAAAA,IAAAA,GAAqBtD,CACtByM,MAAAA,IAAUC,EAAGH,WAAWvM,CAAAA,EAAMkN,EAAY1xC,MAAM0xC,EAAYzxC,QAAQyxC,EAAYzP,QAAQ,CAAA,IAE5FiP,EAAGrB,QAAQ6B,EAAYxpD,MAAMwpD,EAAYzpD;EAC5C;AACL;AACA,SAAS8pD,GAAWb,GAAIY,GAAY7jF,GAChC;AAAA,MAAI+2E,IAAU/2E,EAAQ+2E,SAASU,IAAWz3E,EAAQy3E,UAAUzB,IAAYh2E,EAAQg2E,WAAWoG,IAAWp8E,EAAQo8E,UAAUtG,IAAa91E,EAAQ81E,YAAYC,IAAc/1E,EAAQ+1E,aAAayB,IAAYx3E,EAAQw3E;AAChN,SAASnH,GAAS0G,CAAAA,KAAAA,CAAarH,EAASqH,GAASkM,EAAGlC,MAAM8C,CAAAA,CAAAA,KACrDxT,GAASoH,CAAcwL,KAAAA,CAAAA,EAAG9B,QAAQ0C,CAClCxT,KAAAA,GAAS2F,CAAetG,KAAAA,CAAAA,EAASsG,GAAWiN,EAAG3C,SAASuD,CACxDxT,CAAAA,KAAAA,GAAS4S,EAAGhB,SAAegB,KAAAA,CAAAA,EAAGhB,UAAU4B,CAC3B,KAAbzH,MAAa,QAAS1M,CAAAA,EAASuT,EAAGd,YAAY0B,OAC7CxT,GAASyF,CAAAA,KAAezF,GAAS0F,CAC9BrG,MAAAA,CAAAA,EAASoG,GAAYmN,EAAGjC,SAAS6C,CACjCnU,CAAAA,KAAAA,CAAAA,EAASqG,GAAakN,EAAGhC,UAAU4C,CACvCxT,CAAAA,KAAAA,GAASmH,OACJqM,IAAaZ,EAAGtC,YACbjR,EAAS8H,GAAWqM,IAAa,CAAA,KAAA,CACjCnU,EAAS8H,GAAAA,CAAYyL,EAAGtC,UAAUkD,CAAAA,KAClCA,KAAcZ,EAAGtC,WAAAA,CACbjR,EAAS8H,GAAWqM,IAAa,IAAIZ,EAAGtC,OACxCjR,KAAAA,CAAAA,EAAS8H,IAAYyL,EAAGrC,cAAciD,IAAaZ,EAAGtC,OAAAA;AAC3E;AACA,SAASiD,GAAexnF,GAAM4D,GAAAA;AAC1B,SAAO,IAAIs9E,GAAalhF,GAAM4D,EAAQ+8E,MAAMa,YAChD;AAAA;AACA,SAAS4F,GAAWpE,GAAAA;AAChB,SAAOA,EAAW1sD,SACtB;AAAA;AACA,SAASixD,GAAmBT,GAAQ77E,GAAOC,GAAK27E,GAAIjjF;AAEhD,WADI86E,IAAW,IACNiJ,IAAa18E,GAAO08E,IAAaz8E,GAAKy8E,KAAc;AACzD,QAAIF,IAAaX,EAAOa,CACxBjJ;AAAAA,KAAAA,IAAWgJ,GAAWb,GAAIY,GAAY7jF,CAAAA,OAElCkjF,EAAOW,CAAc,IAAA;AAAA,EAC5B;AACD,SAAO/I;AACX;ACxGO,IAAImC,KAAO,EACd/D,IAAI,IAAIlK,GAAQ,IAChBmK,IAAI,IAAInK,GAAQ,CAChBoK,GAAAA,IAAI,IAAIpK,GAAQ,CAAA,GAChBqK,IAAI,IAAIrK,GAAQ,CAAA,GAChBsK,IAAI,IAAItK,GAAQ,IAChBgV,IAAI,IAAIhV,GAAQ,CAChBiV,GAAAA,IAAI,IAAIjV,GAAQ,CAETmN,EAAAA,GAAAA,KAAkB,EACzB5F,MAAMtD,EAAUsE,QAChB8E,SAAS,MACTptC,UAAU,GACVyrC,MAAMuC,GAAK/D,IACX5zB,OAAO,MACPqsB,OAAO,MACPoL,MAAM,MACNT,UAAU,MACVvF,SAAS,MACTjB,YAAY,MACZC,aAAa,MACbyB,WAAW,MACXC,UAAU,MACVzB,WAAW,MACXuG,YAAY,MACZpF,QAAQ,MACRiE,UAAU,MACVK,UAAU,MACVW,UAAU,KAAA,GAEHH,KAAc3jE,OAAOmhB,KAAK0iD,KAOjC1F,IAAuB,WAAA;AACvB,WAASA,EAAMz2E,GAASkkF,GAAAA;AAAAA,IAChBlkF,MADgBkkF,WACMlkF,IAAU,CAAE,IAClCkkF,MAAY,WAAUA,IAAU,KAEpCxgF,KAAKygF,SAASD,IAAU,OAAO,IAAIzF,MAEnC/6E,KAAKmyE,cAAciG,GAAkB97E,CAAAA;AACrC,QAAIw8E,IAAgBN,GAAal8E,CAASw8E,EAAAA;AAC1C94E,SAAK1D,UAAUw8E;AAAAA,EAClB;AAuKD,SAtKA/F,EAAMqC,YAAY,SAAUliE,GAAM++D,GAC9B;AAAA,WAAOmD,GAAUliE,GAAM++D,CAC/B;AAAA,EAAA,GACIc,EAAMqD,WAAW,SAAUljE,GAAM++D,GAC7B;AAAA,WAAOmE,GAASljE,GAAM++D,CAAAA;AAAAA,EAC9B,GACIc,EAAM2N,aAAa,SAAU/jE;AACzB,WAAO,IAAIo2D,EAAMA,EAAMgG,YAAYp8D,YAC3C;AAAA,EAAA,GACIo2D,EAAMx+D,UAAUosE,QAAQ,SAAUjF;AAC9B,WAAOmE,GAAKnE,GAAY17E,KAAK1D,OAAAA;AAAAA,EACrC,GACIy2E,EAAMx+D,UAAU8mE,YAAY,SAAUF,GAAM3rE,GAAAA;AACxC,aAAKxP,KAAKygF,UAEHzgF,KAAKygF,OAAOpF,UAAUF,GAAM3rE,CAC3C;AAAA,EAAA,GACIujE,EAAMx+D,UAAU2mE,YAAY,SAAUC,GAAMjsE,GAAOM,GAAAA;AAC/C,QAAKxP,KAAKygF;AAEV,aAAOzgF,KAAKygF,OAAOvF,UAAUC,GAAMjsE,GAAOM,CAAAA;AAAAA,EAClD,GAOIujE,EAAMx+D,UAAUymE,MAAM,SAAUtL,GAAAA;AAC5B,QAAIA;AACA,aAAO1vE,KAAK2gF,MAAM,IAAInR,GAAmB,OAAO,CAAE,GAAEE;AAExD,QAAI3gE,IAAS/O,KAAKq7E,UAAU,KAAA;AAK5B,WAJItsE,MAAW,OACXA,IAAS/O,KAAK2gF,MAAM,IAAItS,GAAW,OAAO,CAAE,KAC5CruE,KAAKk7E,UAAU,OAAOnsE,CAAAA,IAEnBA;AAAAA,EACf,GASIgkE,EAAMx+D,UAAU0mE,UAAU,SAAUzM,GAAOD,GAAQ1oD,GAAK6pD,GAEpD;AAAA,QADI7pD,MACJ,WADsBA,IAAM,KAAA,CACvBqnD,GAAYsB,CAAWtB,KAAAA,CAAAA,GAAYqB;AACpC,YAAM,IAAIxnE,MAAM,yCAEpB;AAAA,QAAIyI,IAAO,EACP++D,QAAQA,GACRC,OAAOA,GACP3oD,KAAKA;AAET,QAAI6pD;AACA,aAAO1vE,KAAK2gF,MAAM,IAAInR,GAAmB,WAAWhgE,GAAMkgE,CAE9D,CAAA;AAAA,QAAI3gE,IAAS/O,KAAKq7E,UAAU,WAAW7rE,CAKvC;AAAA,WAJIT,MAIJ,OAHIA,IAAS/O,KAAK2gF,MAAM,IAAItS,GAAW,WAAW7+D,CAC9CxP,CAAAA,GAAAA,KAAKk7E,UAAU,WAAWnsE,GAAQS,CAE/BT,IAAAA;AAAAA,EACf,GAQIgkE,EAAMx+D,UAAUg6D,SAAS,SAAUh+C,GAAI1K,GAEnC;AAAA,QADIA,MACJ,WADsBA,IAAAA,KACjBqnD,CAAAA,GAAY38C,CACb;AAAA,YAAM,IAAIxpB,MAAM,wCAAA;AAEpB,QAAIyI,IAAO,EAAE+gB,IAAIA,GAAI1K,KAAKA,EACtB9W,GAAAA,IAAS/O,KAAKq7E,UAAU,UAAU7rE,CAKtC;AAAA,WAJIT,MAIJ,OAHIA,IAAS/O,KAAK2gF,MAAM,IAAItS,GAAW,UAAU7+D,CAC7CxP,CAAAA,GAAAA,KAAKk7E,UAAU,UAAUnsE,GAAQS,KAE9BT;AAAAA,EACf,GAQIgkE,EAAMx+D,UAAUi6D,QAAQ,SAAUj+C,GAAI1K,GAElC;AAAA,QADIA,MACJ,WADsBA,IAAAA,MACjBqnD,GAAY38C,CAAAA;AACb,YAAM,IAAIxpB,MAAM,uCAEpB;AAAA,QAAIyI,IAAO,EAAE+gB,IAAIA,GAAI1K,KAAKA,KACtB9W,IAAS/O,KAAKq7E,UAAU,SAAS7rE,CAAAA;AAKrC,WAJIT,aACAA,IAAS/O,KAAK2gF,MAAM,IAAItS,GAAW,SAAS7+D,KAC5CxP,KAAKk7E,UAAU,SAASnsE,GAAQS,CAE7BT,IAAAA;AAAAA,EACf,GAKIgkE,EAAMx+D,UAAUqtC,QAAQ,WACpB;AAAA,WAAO5hD,KAAKg7E,IAAMnhF,EAAAA;AAAAA,EAC1B,GAOIk5E,EAAMx+D,UAAUzE,WAAW;AACvB,WAAO2qE,GAAgBz6E,KAAKmyE,WACpC;AAAA,EAAA,GAKIY,EAAMx+D,UAAUqsE,SAAS,SAAU5O,GAASC,GAAUC,GAAAA;AAClD,Wd1EK,SAAUtgE,GAAOogE,GAASC,GAAUC,GAAAA;AAC7C,aAAO,IAAIH,GAAOngE,GAAOogE,GAASC,GAAUC,CAAAA,EAAepiE;IAC/D,EcwEsB9P,MAAMgyE,GAASC,GAAUC;EAC/C,GACIa,EAAMx+D,UAAUssE,2BAA2B,WACvC;AAAA,WAAOjO,GAAmB5yE,IAClC;AAAA,EAAA,GAKI+yE,EAAMx+D,UAAUyqD,QAAQ;AACpB,WAAO,IAAI+T,EAAM/yE,KAAKmyE,WAC9B;AAAA,EAAA,GAEIY,EAAMC,cAAc,CAChB,UACA,WACA,UACA,SACA,UACA,YACA,UAEJD,GAAAA,EAAMc,SAAStE,EAAUsE,QACzBd,EAAMa,UAAUrE,EAAUqE,SAC1Bb,EAAMY,SAASpE,EAAUoE,QACzBZ,EAAMK,QAAQ7D,EAAU6D,OACxBL,EAAMG,SAAS3D,EAAU2D,QACzBH,EAAMI,WAAW5D,EAAU4D,UAC3BJ,EAAMoF,WAAW5I,EAAU4I,UAC3BpF,EAAMyC,KAAK+D,GAAK/D,IAChBzC,EAAM0C,KAAK8D,GAAK9D,IAChB1C,EAAM2C,KAAK6D,GAAK7D,IAChB3C,EAAM4C,KAAK4D,GAAK5D,IAChB5C,EAAM6C,KAAK2D,GAAK3D,IAChB7C,EAAMuN,KAAK/G,GAAK+G,IAChBvN,EAAMwN,KAAKhH,GAAKgH,IAChBxN,EAAMgG,cAAcA,IACpBhG,EAAM0H,kBAAkBA,IACjB1H;AACX,KC3NI0F,KAAkB,EAClBE,SAAS,MACThzB,WACAm7B,QAAAA,IACAC,UAAU,IACVC,YAAY,IACZ3H,MAAM,KAAA;AAEH,SAAS4H,GAAWnkF,GAAGR;AAC1B,MAAI4kF,IAAY,IACZC,IAAY,CAAA,GACZC,IAAa,CAAA,GACbC,IAAa,CAAA,GACbC,IAAgBpI,GAAap8E,CAAAA,GAC7B67E,IAAU2I,EAAc3I,SACxBU,IAAOiI,EAAcjI,MACrBkI,IA0HR,SAAwBzkF,GAAGgkF,GAAAA;AAGvB,QAFIA,MADmBA,WACEA,IAAAA,KACzBhkF,IAAIA,KAAKA,EAAE8f,KAAAA,GAAAA,CACN9f;AACD,YAAM,IAAIiK,MAAM;AAGpB,QAAK+5E,CAAAA;AACD,aAAOhkF,EAAEzC,MAAM;AAInB,aAFIknF,IAAQzkF,EAAEzC,MAAM;AAAA,CAChBT,GAAAA,IAAI,GACDA,IAAI2nF,EAAM1nF,UAAQ;AAErB,UAAIs/E,IAAQoI,EAAM3nF,CAAK2nF,IAAAA,EAAM3nF,CAAG2U,EAAAA,QAAQ,SAAS,EAC5C4qE;AAAAA,MAAAA,IAGIv/E,IAAI,KAAKu/E,EAAK,CACnBoI,MAD0B,OAC1BA,EAAM3nF,IAAI,CAAA,KAAMu/E,EAAK12E,MAAM,IAC3B8+E,EAAMr5E,OAAOtO,GAAG,CAGhBA,KAAAA,KAAK,IAPL2nF,EAAMr5E,OAAOtO,GAAG,CAAA;AAAA,IASvB;AACD,WAAO2nF;AAAAA,EACX,EArJ+BzkF,GAAGR,EAAQwkF,MAAAA;AAmCtC,SAlCAS,EAAMzmF,QAAQ,SAAUq+E,GAAAA;AACpB,QAAI9B;AACJ,QAAK8B,GAAL;AAEA,UAAIqI,IA0GZ,SAAuBrI;AACnB,YAAI9B,IAdR,SAAqB8B,GAAAA;AACjB,cAAIA,EAAKtyE,QAAQ,GAAA,MAAU;AACvB,mBAAO,EACHoI,MAAM,SACNC,OAAOiqE,EAAAA;AAGf,cAAI9B,KxBjEqB16D,IwBiEVw8D,GxBjEesI,IwBiET,KxBjEct7D,IwBiET,GxBhEtBu7D,IAAS/kE,EAAItiB,MAAMonF,CAChBt7D,GAAAA,IACDu7D,EAAOj/E,MAAM,GAAG0jB,GAAKhmB,OAAO,CAACuhF,EAAOj/E,MAAM0jB,CAAAA,EAAKhiB,KAAKs9E,CACpDC,CAAAA,CAAAA,IAAAA,IwB6DwBzyE,IAAOooE,EAAG,CAAInoE,GAAAA,IAAQmoE,EAAG,CxBjExC,GAAU16D,GAAK8kE,GAAKt7D,GAC/Bu7D;AwBiEJ,iBAAO,EACHzyE,MAAMA,GACNC,OAAOA,EAAAA;AAAAA,QAEf,EAEyBiqE,CAAAA,GAAOlqE,IAAOooE,EAAGpoE,MAAMC,IAAQmoE,EAAGnoE,OACnDyyE,IAAQ1yE,EAAK5U,MAAM,GAAA;AACvB,aAAKsnF;AACD,gBAAM,IAAI56E,MAAM,qBAAA;AACpB,eAAO,EACHkI,MAAM0yE,EAAM,CAAA,EAAGz0B,YACfy0B,GAAAA,OAAOA,EAAMl/E,MAAM,CAAA,GACnByM,OAAOA,EAEf;AAAA,MAAA,EApH+BiqE,CAAOlqE,GAAAA,IAAOuyE,EAAGvyE,MAAM0yE,IAAQH,EAAGG,OAAOzyE,IAAQsyE,EAAGtyE;AAC3E,cAAQD,EAAKi+C;QACT,KAAK;AACD,cAAIy0B,EAAM9nF;AACN,kBAAM,IAAIkN,MAAM,2BAA2B5G,OAAOwhF,EAAMx9E,KAAK;AAEjE+8E,UAAAA,EAAU7nF,KAAK0/E,GAAYI,CAAAA,CAAAA;AAC3B;AAAA,QACJ,KAAK;AACD,cAA4FyI,MAAlFvK,IAAK,4BAA4BrrD,KAAKmtD,CAA0B,OAAf,QAAQ9B,MAAO,SAASA,IAAK,CAAmB,GAAA,CAAA;AACvGuK,UAAAA,MAAcvI,MACdA,IAAOuI,IAEXT,IAAYA,EAAUhhF,OAAO0hF,GAAW3yE,GAAOyyE,CAC/C,CAAA;AAAA;AAAA,QACJ,KAAK;AACD,cAAIA,EAAM9nF;AACN,kBAAM,IAAIkN,MAAM,4BAA4B5G,OAAOwhF,EAAMx9E,KAAK,GAAA,CAAA,CAAA;AAElEi9E,UAAAA,EAAW/nF,KAAK0/E,GAAY7pE,CAC5B,CAAA;AAAA;AAAA,QACJ,KAAK;AACDmyE,UAAAA,IAAaA,EAAWlhF,OAAO0hF,GAAW3yE,GAAOyyE,CAAAA,CAAAA;AACjD;AAAA,QACJ,KAAK;AACD;AAAA,QACJ;AACI,gBAAM,IAAI56E,MAAM,2BAA2BkI,CA5BxC;AAAA,MAAA;AAAA,IAAA;AAAA,EA8BnB,CACW,GAAA,EACH0pE,SAASA,GACTU,MAAMA,GACN6H,WAAWA,GACXC,WAAWA,GACXC,YAAYA,GACZC,YAAYA,EAEpB;AAAA;AAmCO,SAASS,GAAShlF,GAAGR,GAExB;AAAA,SADIA,MACJ,WAD0BA,IAAU,CAAE,IAnC1C,SAAmBQ,GAAGR,GAAAA;AAClB,QAAI+6E,IAAK4J,GAAWnkF,GAAGR,CAAAA,GAAU4kF,IAAY7J,EAAG6J,WAAWC,IAAY9J,EAAG8J,WAAWC,IAAa/J,EAAG+J,YAAYC,IAAahK,EAAGgK,YAAY1I,IAAUtB,EAAGsB,SAASU,IAAOhC,EAAGgC,MACzKmH,IAAUlkF,EAAQqpD,UAAlB66B;AAKJ,QAJIlkF,EAAQ0kF,eACR1kF,EAAQykF,WAAW,IACnBzkF,EAAQwkF,SAAS,KAEjBxkF,EAAQykF,YACRG,EAAUrnF,SAAS,KACnBsnF,EAAUtnF,UACVunF,EAAWvnF,UACXwnF,EAAWxnF,QAAQ;AACnB,UAAIkoF,IAAS,IAAIC,GAASxB,CAAAA;AAiB1B,aAhBAuB,EAAOpJ,QAAQA,IACfoJ,EAAO1I,KAAKA,WACZ6H,GAAAA,EAAUpmF,QAAQ,SAAUkrC,GACxB+7C;AAAAA,QAAAA,EAAOnwE,MAAM,IAAImhE,EAAMkP,GAAkBj8C,GAAK2yC,GAASU,IAAOmH,CAC1E,CAAA;AAAA,MAAA,CAAA,GACQW,EAAUrmF,QAAQ,SAAUpC,GAAAA;AACxBqpF,QAAAA,EAAOG,MAAMxpF,CAAAA;AAAAA,MACzB,IACQ0oF,EAAWtmF,QAAQ,SAAUkrC,GACzB+7C;AAAAA,QAAAA,EAAOI,OAAO,IAAIpP,EAAMkP,GAAkBj8C,GAAK2yC,GAASU,CAAAA,GAAOmH;MAC3E,CACQa,GAAAA,EAAWvmF,QAAQ,SAAUpC,GAAAA;AACzBqpF,QAAAA,EAAOK,OAAO1pF,CAC1B;AAAA,MAAA,CAAA,GACY4D,EAAQ0kF,cAAc1kF,EAAQq8E,WAC9BoJ,EAAOG,MAAMvJ,IACVoJ;AAAAA,IACV;AACD,QAAI/7C,IAAMk7C,EAAU,CAAA,KAAM,CAAA;AAC1B,WAAO,IAAInO,EAAMkP,GAAkBj8C,GAAKA,EAAI2yC,WAAWr8E,EAAQq8E,WAAWA,GAAS3yC,EAAIqzC,QAAQ/8E,EAAQ+8E,QAAQA,IAAOmH,CAC1H;AAAA,EAAA,EAGqB1jF,GAKrB,SAA2BR,GACvB;AAAA,QAAIkmC,IAAU,CAAA,GACVzM,IAAOnhB,OAAOmhB,KAAKz5B,IACnBi8E,IAAc3jE,OAAOmhB,KAAK0iD,EAK9B;AAAA,QAJA1iD,EAAKj7B,QAAQ,SAAUiP,GAAAA;AACdiiE,MAAAA,EAASuM,GAAaxuE,CAAAA,KACvBy4B,EAAQnpC,KAAK0Q,CAAAA;AAAAA,IACzB,IACQy4B,EAAQ3oC;AACR,YAAM,IAAIkN,MAAM,sBAAsBy7B,EAAQr+B,KAAK,IAAA,CAAA;AAEvD,WAAO+qE,GAASA,GAAS,CAAA,GAAIuJ,EAAAA,GAAkBn8E,CACnD;AAAA,EAAA,EAjB0CA,CAAAA,CAAAA;AAC1C;AACA,SAAS2lF,GAAkBj8C,GAAK2yC,GAASU,GAAAA;AACrC,SAAOnK,GAASA,GAAS,CAAE,GAAElpC,CAAM,GAAA,EAAE2yC,SAASA,GAASU,MAAMA;AACjE;AAyEA,SAASwI,GAAWQ,GAAUV,GAAAA;AAE1B,SATJ,SAA0BA,GACtBA;AAAAA,IAAAA,EAAM7mF,QAAQ,SAAUwnF,GAAAA;AACpB,WAAK,+BAA+BziE,KAAKyiE;AACrC,cAAM,IAAIv7E,MAAM,oCAAoCu7E,CAEhE;AAAA,IAAA,CAAA;AAAA,EACA,EAEqBX,CAAAA,GACVU,EAAShoF,MAAM,GAAA,EAAKE,IAAI,SAAUutB,GAAAA;AAAW,WAAOkmD,GAAkBlmD,CAAAA;AAAAA,EAAW;AAC5F;ACnLA,SAASy6D,GAAmBC,GACxB;AAAA,MAAI7S,IAAQ3vE;AACZ,SAAO,SAAUyiF,GAAAA;AAIb,QAHIA,MAAU3kD,WACV6xC,EAAM,IAAIxvE,OAAOqiF,CAAcC,CAAAA,IAAAA,IAE/B9S,EAAM,IAAIxvE,OAAOqiF,CAAAA,CAAAA,MAFcC;AAG/B,aAAO9S,EAAM,IAAIxvE,OAAOqiF,CAAAA,CAAAA;AAE5B,aAAS5oF,IAAI,GAAGA,IAAI+1E,EAAM+S,OAAO7oF,QAAQD,KAAK;AAC1C,UAAI+oF,IAAUhT,EAAM+S,OAAO9oF,CAAGu4E,EAAAA,YAAYqQ;AAC1C,UAAIG;AACA,eAAOA;AAAAA,IAEd;AAAA,EACT;AACA;AACA,IAAIX,KAA0B,SAAUvS,GAQpC;AAAA,WAASuS,EAASxB,GACE;AAAA,IAAZA,MAAY,WAAUA,IAAAA;AAC1B,QAAI7Q,IAAQF,EAAOxkE,KAAKjL,MAAM,IAAIwgF,MAAYxgF;AAO9C,WANA2vE,EAAMgJ,UAAU4J,GAAmB3/E,MAAM+sE,GAAO,CAAC,SAAA,CAAA,GACjDA,EAAM0J,OAAOkJ,GAAmB3/E,MAAM+sE,GAAO,CAAC,MAC9CA,CAAAA,GAAAA,EAAM+S,SAAS,CAAA,GACf/S,EAAMiT,SAAS,CAAA,GACfjT,EAAMkT,UAAU,CAAA,GAChBlT,EAAMmT,UAAU,CAAA,GACTnT;AAAAA,EACV;AA+GD,SAhIAZ,GAAUiT,GAAUvS,CAkBpBuS,GAAAA,EAASztE,UAAUosE,QAAQ,SAAUjF;AACjC,WCzCD,SAAiBA,GAAYgH,GAAQG,GAASD,GAAQE,GAASzJ,GAClE;AAAA,UAAI0J,IAAc,CAAA,GACdC,IAAUtH,EAAWjN;AACzB,eAASwU,EAAWzU,GAAOD,GAAAA;AACvBsU,QAAAA,EAAQ/nF,QAAQ,SAAU8W;AACtBA,UAAAA,EAAMqpE,QAAQzM,GAAOD,GAAQ,EAAA,EAAMzzE,QAAQ,SAAUpC,GACjDqqF;AAAAA,cAAYtuE,OAAO/b,CAAS,CAAA,IAAA;AAAA,UAC5C;QACA,CACK;AAAA,MAAA;AACDoqF,MAAAA,EAAQhoF,QAAQ,SAAUpC,GACtB;AAAA,YAAIwqF,IAAY,IAAItJ,GAAalhF,GAAM2gF,CAAAA,EAAMa;AAC7C6I,UAAYtuE,OAAOyuE;MAC3B,CAAA,GACIxH,EAAWjN,SAAS,SAAU/1E,GAAAA;AAC1B,YAAI63B,IAAK9b,OAAO/b;AAChB,eAAIslB,MAAMuS,KACCyyD,EAAQ/3E,KAAKjL,MAAMtH,CAAAA,IAAAA,EAAAA,CACzBqqF,EAAYxyD,CAAAA,MACb0yD,EAAW,IAAI/pF,KAAKq3B,IAAK,CAAI,GAAA,IAAIr3B,KAAKq3B,IAAK,CAAA,CAAA,GAAA,CACtCwyD,EAAYxyD,CAAAA,QACbwyD,EAAYxyD,CAAAA,IAAAA,IACLyyD,EAAQ/3E,KAAKjL,MAAMtH,CAI1C;AAAA,MAAA,GACQgjF,EAAWluE,WAAW,cACtBy1E,EAAWvH,EAAWlsE,KAAKg/D,OAAOkN,EAAWlsE,KAAK++D,SAClDmN,EAAWjN,SAAS,SAAU/1E,GAC1B;AAAA,YAAI63B,IAAK9b,OAAO/b,CAChB;AAAA,eAAA,CAAA,CAAKqqF,EAAYxyD,CACbwyD,MAAAA,EAAYxyD,SACLyyD,EAAQ/3E,KAAKjL,MAAMtH,CAAAA;AAAAA,MAG1C;AAEI,eAASkB,IAAI,GAAGA,IAAIgpF,EAAO/oF,QAAQD,KAAK;AACpC,YAAIspF,IAAY,IAAItJ,GAAagJ,EAAOhpF,CAAIy/E,GAAAA,CAAAA,EAAMa;AAClD,YAAKwB,CAAAA,EAAWjN,OAAO,IAAIv1E,KAAKgqF,EAAUh+D,QACtC,CAAA,CAAA;AAAA;AAAA,MACP;AACDw9D,MAAAA,EAAO5nF,QAAQ,SAAU8W;AACrBiuE,WAAKnE,GAAY9pE,EAAMtV,OAC/B;AAAA,MAAA,CAAA;AACI,UAAIwB,IAAM49E,EAAWpN;AAErB,cADAhtD,GAAKxjB,CAAAA,GACG49E,EAAWluE,QACf;AAAA,QAAA,KAAK;AAAA,QACL,KAAK;AACD,iBAAO1P;AAAAA,QACX,KAAK;AACD,iBAASA,EAAIjE,UAAUiE,EAAIA,EAAIjE,SAAS,MAAO;AAAA,QAEnD;AACI,iBAASiE,EAAIjE,UAAUiE,EAAI,CAAA,KAAO;AAAA,MAE9C;AAAA,IAAA,EDjBuB49E,GAAY17E,KAAK0iF,QAAQ1iF,KAAK6iF,SAAS7iF,KAAK4iF,QAAQ5iF,KAAK8iF,SAAS9iF,KAAKq5E,KAC9F,CAAA;AAAA,EAAA,GAMI2I,EAASztE,UAAU3C,QAAQ,SAAUA,GACjCuxE;AAAAA,IAAAA,GAASvxE,GAAO5R,KAAK0iF,MAAAA;AAAAA,EAC7B,GAMIV,EAASztE,UAAU4tE,SAAS,SAAUvwE,GAClCuxE;AAAAA,IAAAA,GAASvxE,GAAO5R,KAAK6iF,OAAAA;AAAAA,EAC7B,GAMIb,EAASztE,UAAU2tE,QAAQ,SAAUxpF,GACjC0qF;AAAAA,IAAAA,GAAS1qF,GAAMsH,KAAK4iF,MAAAA;AAAAA,EAC5B,GAMIZ,EAASztE,UAAU6tE,SAAS,SAAU1pF,GAAAA;AAClC0qF,IAAAA,GAAS1qF,GAAMsH,KAAK8iF,OAAAA;AAAAA,EAC5B,GAMId,EAASztE,UAAU8uE,SAAS,WACxB;AAAA,WAAOrjF,KAAK0iF,OAAOnoF,IAAI,SAAUW,GAAAA;AAAK,aAAO4mF,GAAS5mF,EAAE4U,SAAc,CAAA;AAAA,IAAA,CAAA;AAAA,EAC9E,GAMIkyE,EAASztE,UAAU+uE,UAAU,WACzB;AAAA,WAAOtjF,KAAK6iF,QAAQtoF,IAAI,SAAUW;AAAK,aAAO4mF,GAAS5mF,EAAE4U,SAAc,CAAA;AAAA,IAAA,CAAA;AAAA,EAC/E,GAMIkyE,EAASztE,UAAUgvE,SAAS,WAAA;AACxB,WAAOvjF,KAAK4iF,OAAOroF,IAAI,SAAUW;AAAK,aAAO,IAAIhC,KAAKgC,EAAEgqB,QAAAA,CAAAA;AAAAA,IAAa,CAC7E;AAAA,EAAA,GAMI88D,EAASztE,UAAUivE,UAAU,WACzB;AAAA,WAAOxjF,KAAK8iF,QAAQvoF,IAAI,SAAUW,GAAK;AAAA,aAAO,IAAIhC,KAAKgC,EAAEgqB;IAAa,CAC9E;AAAA,EAAA,GACI88D,EAASztE,UAAUpb,UAAU;AACzB,QAAI4V,IAAS,CAoBb;AAAA,WAAA,CAnBK/O,KAAK0iF,OAAO7oF,UAAUmG,KAAKyjF,aAC5B10E,IAASA,EAAO5O,OAAOs6E,GAAgB,EAAE9B,SAAS34E,KAAKyjF,SAAAA,CAAAA,CAAAA,IAE3DzjF,KAAK0iF,OAAO5nF,QAAQ,SAAU8W,GAAAA;AAC1B7C,MAAAA,IAASA,EAAO5O,OAAOyR,EAAM9B,SAAWzV,EAAAA,MAAM;AAAA,CAC1D,CAAA;AAAA,IAAA,CAAA,GACQ2F,KAAK6iF,QAAQ/nF,QAAQ,SAAUqnF,GAAAA;AAC3BpzE,MAAAA,IAASA,EAAO5O,OAAOgiF,EAClBryE,SACAzV,EAAAA,MAAM;AAAA,CACNE,EAAAA,IAAI,SAAU4+E,GAAAA;AAAQ,eAAOA,EAAK5qE,QAAQ,WAAW;SACrDwB,OAAO,SAAUopE,GAAAA;AAAQ,eAAQ,CAAA,WAAWt5D,KAAKs5D,CAAAA;AAAAA,MAAQ;IAC1E,CACYn5E,GAAAA,KAAK4iF,OAAO/oF,UACZkV,EAAO1V,KAAKqqF,GAAe,SAAS1jF,KAAK4iF,QAAQ5iF,KAAKq5E,KAAAA,CAAAA,CAAAA,GAEtDr5E,KAAK8iF,QAAQjpF,UACbkV,EAAO1V,KAAKqqF,GAAe,UAAU1jF,KAAK8iF,SAAS9iF,KAAKq5E,KAAAA,CAAAA,CAAAA,GAErDtqE;AAAAA,EACf,GAOIizE,EAASztE,UAAUzE,WAAW;AAC1B,WAAO9P,KAAK7G,UAAUgL,KAAK;AAAA,CAAA;AAAA,EACnC,GAII69E,EAASztE,UAAUyqD,QAAQ;AACvB,QAAI2kB,IAAM,IAAI3B,EAAWhiF,CAAAA,CAAAA,KAAKygF;AAK9B,WAJAzgF,KAAK0iF,OAAO5nF,QAAQ,SAAU8oF,GAAAA;AAAQ,aAAOD,EAAI/xE,MAAMgyE,EAAK5kB,MAAW,CAAA;AAAA,IAAA,CAAA,GACvEh/D,KAAK6iF,QAAQ/nF,QAAQ,SAAU8oF,GAAAA;AAAQ,aAAOD,EAAIxB,OAAOyB,EAAK5kB,MAAAA,CAAAA;AAAAA,IAAW,IACzEh/D,KAAK4iF,OAAO9nF,QAAQ,SAAUpC,GAAAA;AAAQ,aAAOirF,EAAIzB,MAAM,IAAIhpF,KAAKR,EAAKwsB,QAAAA,CAAAA,CAAAA;AAAAA,IAAc,IACnFllB,KAAK8iF,QAAQhoF,QAAQ,SAAUpC,GAAAA;AAAQ,aAAOirF,EAAIvB,OAAO,IAAIlpF,KAAKR,EAAKwsB,QAAAA,CAAAA,CAAAA;AAAAA,IAAc,IAC9Ey+D;AAAAA,EACf,GACW3B;AACX,EAAEjP,CAEF;AAAA,SAASoQ,GAASvxE,GAAOyZ;AACrB,MAAMzZ,EAAAA,aAAiBmhE;AACnB,UAAM,IAAI/D,UAAU50E,OAAOwX,CAAAA,IAAS,wBAEnCo6D;AAAAA,EAAAA,EAAS3gD,EAAW9wB,IAAIH,SAASA,OAAOwX,CAAAA,CAAAA,KACzCyZ,EAAWhyB,KAAKuY,CAAAA;AAExB;AACA,SAASwxE,GAAS1qF,GAAM2yB,GAAAA;AACpB,MAAM3yB,EAAAA,aAAgBQ;AAClB,UAAM,IAAI81E,UAAU50E,OAAO1B,CAAAA,IAAQ;AAElCszE,EAAAA,EAAS3gD,EAAW9wB,IAAIka,MAASA,GAAAA,OAAO/b,QACzC2yB,EAAWhyB,KAAKX,IAChB4oB,GAAK+J,CAAAA;AAEb;AACA,SAASq4D,GAAez3D,GAAOs3D,GAAQlK,GACnC;AAAA,MAAIY,KAASZ,KAAQA,EAAKnsB,YACtBn+B,MADwC,OACxCA,IAASkrD,IAAQ,GAAG95E,OAAO8rB,GAAO,GAAA,IAAO,GAAG9rB,OAAO8rB,GAAO,QAAU9rB,EAAAA,OAAOk5E,GAAM,GACjFzxD,GAAAA,IAAa27D,EACZhpF,IAAI,SAAU2nF,GAAS;AAAA,WAAOnU,GAAkBmU,EAAM/oF,WAAW8gF;KACjE91E,KAAK,GACV;AAAA,SAAO,GAAGhE,OAAO4uB,CAAAA,EAAQ5uB,OAAOynB,CAAAA;AACpC;AElLe,SAAQi8D,GAACntF,GAExB;AAAA,MAEI60C,IAAW,MACXu4C,IAAW;AA4Bf,WAASC,EAAmBjtF,GACxBy0C;AAAAA,IAAAA,KACF7M,cAAc6M,CAAAA;AAEf,UAAMnuC,IAAO1G,EAAUuG,OAAOvG,EAAU0K,KAAAA;AACxC,SAAIhE;AACH;AACD1G,MAAUstF,kBAAmBttF,EAAU8C,WAAW4d,cAAc,4BAC3Dha,GAAAA,EAAKw/B,eACTlmC,EAAUstF,kBAAkBttF,EAAU8C,WAAW4d,cAAc,eAGhE;AAAA,UAAM6sE,IAAW,EAChBhtD,OAASngC,EAAMsiC,UAAUtiC,EAAMsiC,QAAQ,CAAA,EAAGnC,QAAQngC,EAAMmgC,OACxDC,OAASpgC,EAAMsiC,UAAUtiC,EAAMsiC,QAAQ,CAAGlC,EAAAA,QAAQpgC,EAAMogC,MAEzDqU;AAAAA,IAAAA,IAAW3M,YAAY,WAOxB;AAAA,OAAA,SAAc1jC,GACb;AAAA,YAAA,CAAIxE,EAAU4E,SAAAA,EAAWw/B;AAGxB,iBAFA4D,cAAc6M,UACdu4C,IAAW;AAIZ,cAAM1mF,IAAO1G,EAAUuG,OAAOvG,EAAU0K,KACxC;AAAA,YAAA,CAAIhE;AACH;AAID,cAAM8mF,IAAWxtF,EAAUstF,iBACrBrkE,IA/DP,SAAiCzkB,GAAG8G,GACnC;AAAA,gBAAM5E,IAAO1G,EAAUuG,OAAOvG,EAAU0K,KAAAA,GAClCy6C,IAAM,CAAA,GACN5zC,IAAS,CAAA;AACf,cAAI/K,IAAY8E;AAQhB,eANA65C,EAAI75B,IAAM9mB,EAAEk+B,UAAUl+B,EAAEk+B,QAAS,GAAInC,QAAQ/7B,EAAE+7B,OAC/C4kB,EAAI95B,IAAO7mB,EAAEk+B,UAAUl+B,EAAEk+B,QAAS,GAAIlC,QAAQh8B,EAAEg8B,OAEhDjvB,EAAOpQ,OAAOqF,EAAUsiB,aAAapiB,EAAKy/B,IAC1C50B,EAAOrQ,MAAMsF,EAAUqiB,WAEfriB;AAEP+K,YAAAA,EAAOpQ,QAAQqF,EAAUsiB,YACzBvX,EAAOrQ,OAAOsF,EAAUqiB,WAExBriB,IAAYA,EAAUuiB;AAGvB,iBAAO,EACNuC,GAAI65B,EAAI75B,IAAI/Z,EAAOpQ,MACnBkqB,GAAI85B,EAAI95B,IAAI9Z,EAAOrQ,IAAAA;AAAAA,QAErB,EAuCoCsD,GAAGgpF,IAEhCC,IAAaD,EAASjqE,cAAc7c,EAAKy/B,IACzCunD,IAAcF,EAASnqE,cAEvBsqE,IAAO1kE,EAAIqC,GACXsiE,IAAO3kE,EAAIoC;AAEjB,YAAIlpB,IAAWuE,EAAKymF,cAAc;QAC/BhrF,aACFA,IAAW,CAAA,IAGZnC,EAAU6tF,OAAO1rF,GAAU,EAC1B2rF,SAAS,KACTC,SAAS,KACTC,SAAS,IACTC,SAAS,GAGV,CAAA;AAAA,YAAItkE,IAAaukE,EAAYP,GAAMF,GAAYL,IAAWA,EAAS9hE,IAAI,GAAGnpB,EAAS2rF,OAAAA;AAC/EpnF,QAAAA,EAAKw/B,eACRvc,IAAa;AAEd,YAAIF,IAAYykE,EAAYN,GAAMF,GAAaN,IAAWA,EAAS/hE,IAAI,GAAGlpB,EAAS4rF,OAE/EtkE;AAAAA,SAAAA,KAAAA,CAAaE,KAAgByjE,MAChCA,IAAW,EACV9hE,GAAGqiE,GACHtiE,GAAGuiE,KAGJjkE,IAAa,GACbF,IAAY,IAGbE,KAA0BxnB,EAAS6rF,SACnCvkE,KAAwBtnB,EAAS8rF,SAE9BtkE,KAAcF,MACbra,KAAKu1B,IAAIhb,IAAa,KAAKva,KAAKu1B,IAAIlb,KACtCA,IAAY,IACJra,KAAKu1B,IAAIlb,IAAY,KAAKra,KAAKu1B,IAAIhb,OAC3CA,IAAa,KAIZA,KAAcF,KAChB2jE,EAASe,UAAU,IAgBrB,SAAgBhtF,GAAMD;AACrB,gBAAMssF,IAAWxtF,EAAUstF;AACxBpsF,UAAAA,MACFssF,EAAS/jE,aAAavoB,IAEnBC,MACHqsF,EAAS7jE,cAAcxoB;AAAAA,QAEzB,EAvBSwoB,GAAYF,MAEnBue,cAAc6M,CAAAA;AAAAA,MAEhB,GA1EwC04C,CAAAA;AAAAA,IAAU,GA/C7B,EAAA;AAAA,EAgDrB;AA2EA,WAASW,EAAY/oC,GAAKipC,GAASC,GAAYC,GAC9C;AAAA,WAAGnpC,IAAMmpC,MAAiBlB,CAAAA,KAAYA,EAASe,WAAWhpC,IAAMkpC,KAAAA,KAEvDD,IAAUjpC,IAAMmpC,OAAiBlB,KAAYA,EAASe,WAAWhpC,IAAMkpC,KACxE,IAED;AAAA,EACR;AAhFAruF,IAAUsE,YAAY,aAAa,WAAA;AAClC0jC,kBAAc6M,CACf;AAAA,EAAA,CAAA;AA2FA,MAAI05C,IAAOvuF,EAAUsE,YAAY,oBAAoB,WAChDtE;AAAAA,MAAUuG,WACbvG,EAAUI,MAAMwN,SAASmJ,MAAM,aAAas2E,IAC5CrtF,EAAU6kB,YAAY0pE,CAExB;AAAA,EAAA,CAAA;AAIA;AC5JA,MAAAC,KACQ,WACN;AAAA,MAuFIC,GAvFAryC,IAAQ,EACXsyC,QAAS,WACTC,QAAS,WACTC,SAAU,WAAA;AAkBX,WAASC,IACR;AAAA,QAAIx2E,IAAS+jC,EAAMsyC,QACfI,IAjBL,WACC;AAAA,UAAItoF,IAAYoH,SAASC,cAAc,KAAA;AACvCrH,MAAAA,EAAUvF,MAAMgzC,UAAW;AAO3B,UAAI3G,IAAU1/B,SAASC,cAAc,KAAA;AAGrC,aAFAy/B,EAAQrsC,MAAMgzC,UAAU,gCACxBztC,EAAUuH,YAAYu/B,IACf9mC;AAAAA,IACP;AA0BA,WArBAoH,SAASmJ,KAAKhJ,YAAY+gF,CAENA,GAAAA,EAAYnlE,aACb,IAGlBtR,IAAS+jC,EAAMsyC,UAEfI,EAAYnlE,kBAIXtR,IAHEy2E,EAAYnlE,eAGdtR,MAAS+jC,EAAMwyC,UAINxyC,EAAMuyC,SAIjB/gF,SAASmJ,KAAKvL,YAAYsjF,IACnBz2E;AAAAA,EACP;AAED,WAAS02E,EAAev2E,GAAOw2E,GAAAA;AAC9B,QAAIzqF,IAAO0qF,EAAAA;AACX,WAAG1qF,MAAS63C,EAAMwyC,UACdp2E,IACMA,CAAAA,IAED,IAECjU,MAAS63C,EAAMsyC,SACjBM,IAAcx2E,IAEdA;AAAAA,EAER;AA2BD,WAASy2E,IAAAA;AAIR,WAHIR,MACHA,IAAcI,EAERJ,IAAAA;AAAAA,EACP;AACD,SAAO,EACNryC,OAAOA,GACP6yC,SAASA,GACTF,gBAAgBA,GAChBG,gBAlCD,SAAwBprF,GAEvB;AAAA,QAAIi5C,IAAYr6B,iBAAiB5e,GAASi5C;AAC1C,QAAIA,KAAaA,MAAc,OAEzB;AACL,UAAIoyC,IAAYrrF,EAAQkrF,cAAclrF,EAAQyf;AAC9C,aAAOwrE,EAAejrF,EAAQ6lB,YAAYwlE,CAC1C;AAAA,IAAA;AAJA,WAAOrrF,EAAQ6lB;AAAAA,EAKhB,GA0BAylE,gBAxBD,SAAwBtrF,GAAS0U;AAEhC,QAAIukC,IAAYr6B,iBAAiB5e,CAASi5C,EAAAA;AAC1C,QAAIA,KAAaA,MAAc,OAEzB;AACL,UACIsyC,IAAaN,EAAev2E,GADhB1U,EAAQkrF,cAAclrF,EAAQyf,WAAAA;AAE9Czf,MAAAA,EAAQ6lB,aAAa0lE;AAAAA,IACrB;AALAvrF,MAAAA,EAAQ6lB,aAAanR;AAAAA,EAMtB;AAgBH;AC3FO,MAAM82E;EAKZ,YAAYtvF;AACXsJ,SAAKimF,aAAavvF;AAAAA,EACnB;AAAA,EAEA,UAAAiuE;AACC,UAAMjuE,IAAYsJ,KAAKimF;AAYvB,WAXKjmF,KAAKkmF,iBACJlmF,KAAAkmF,eAAe5hF,SAASC,cAAc,KAC3CvE,GAAAA,KAAKkmF,aAAa1gF,YAAY,2CAEpB9O,EAAA66B,SAASi5B,YAAYxqD,KAAKkmF,YAElCxvF,IAAAA,EAAUM,OAAOsgC,MACdt3B,KAAAkmF,aAAa3wE,UAAU5c,IAAI,mBAAA,IAE3BqH,KAAAkmF,aAAa3wE,UAAUwL,OAAO,mBAE7B/gB,GAAAA,KAAKkmF;AAAAA,EACb;AAAA,EAEA,YAAYlpE,GAEJ;AAAA,WADPhd,KAAKmmF,QAAQnpE,GACNhd;AAAAA,EACR;AAAA,EAIA,KAAKnI,GAA2BD,GAC/B;AAAA,UAAMlB,IAAYsJ,KAAKimF,YACjB7iD,IAAa1sC,EAAUu+B,aACvB/3B,IAAYoH,SAASmJ,MACrBuP,IAAOhd,KAAK2kE,QAOd;AAAA,QALAvhC,EAAWpiB,UAAUhE,GAAM9f,OAC9B8C,KAAKK,KAAAA,GACLnD,EAAUuH,YAAYuY,CAAAA,IAGnBhd,KAAKomF,kBAAkBvuF,CAAO,GAAA;AAC3B,YAAA4J,IAAWzB,KAAKqmF,0BAA0BxuF,CAChDD;AAAAA,UAAM6J,EAAS7J,KACfC,IAAO4J,EAAS5J;AAAAA,IACjB;AAMO,WAJFmlB,EAAArlB,MAAMC,MAAMA,IAAM,MAClBolB,EAAArlB,MAAME,OAAOA,IAAO,MAEfnB,EAAA66B,SAASk5B,mBAAmBztC,IAC/Bhd;AAAAA,EACR;AAAA,EACA,OACC;AAAA,UAAMtJ,IAAYsJ,KAAKimF,YACjBjpE,IAAOhd,KAAK2kE,QAKX;AAAA,WAJJ3nD,KAAQA,EAAK/a,cACV+a,EAAA/a,WAAWC,YAAY8a,IAEnBtmB,EAAA66B,SAASm5B,kBAAkB1tC,CAAAA,GAC9Bhd;AAAAA,EACR;AAAA,EAEA,WAAW5H,GAAAA;AAGH,WAFM4H,KAAK2kE,QAAAA,EACbngE,YAAYpM,GACV4H;AAAAA,EACR;AAAA,EAGQ,kBAAkBlJ,GAAAA;AACzB,cAAKA,KAA0B,OAAVA,KAAU,aAGxB,aAAaA,KAAS,aAAaA;AAAAA,EAC3C;AAAA,EAEQ,eAAAwvF;AACA,WAAAtmF,KAAKmmF,SAAS7hF,SAASmJ;AAAAA,EAC/B;AAAA,EAGQ,0BAA0B3W;AACjC,UAAMJ,IAAYsJ,KAAKimF,YACjB7iD,IAAa1sC,EAAUu+B,aAEvBivD,IAAYlkF,KAAKumF,oBACjBC,IAAcxmF,KAAK2kE,WACnBmF,IAAoB,EACzBlyE,KAAI,GACJC,MAAM,GACN6N,OAAO8gF,EAAYvsE,aACnBxU,QAAQ+gF,EAAYzsE,cACpB+H,QAAQ,GACRrE,OAAO,EAGFgpE,GAAAA,IAAU/vF,EAAUM,OAAO0vF,kBAC3BC,IAAUjwF,EAAUM,OAAO4vF,kBAE3B1pF,IAAYoH,SAASmJ,MACrBo5E,IAAQzjD,EAAWvhB,yBAAyB/qB,GAAOoG,CAAAA,GACnD4pF,IAAe1jD,EAAW9gB,gBAAgBplB;AAChD2pF,IAAAA,EAAM9kE,KAAK+kE,EAAa/kE,GAExB+nD,EAAQlyE,MAAMivF,EAAM9kE,GACpB+nD,EAAQjyE,OAAOgvF,EAAM7kE,GACrB8nD,EAAQlyE,OAAO+uF,GACf7c,EAAQjyE,QAAQ4uF,GACR3c,EAAAhoD,SAASgoD,EAAQlyE,MAAMkyE,EAAQrkE,QAC/BqkE,EAAArsD,QAAQqsD,EAAQjyE,OAAOiyE,EAAQpkE;AAEjC,UAAAya,IAAY5pB,OAAOwwF,UAAU7pF,EAAUijB;AAmCtC,WAjCJ2pD,EAAQlyE,MAAMssF,EAAStsF,MAAMuoB,KAC/B2pD,EAAQlyE,MAAMssF,EAAStsF,KACfkyE,EAAAhoD,SAASgoD,EAAQlyE,MAAMkyE,EAAQrkE,UAC/BqkE,EAAQhoD,SAASoiE,EAASpiE,WAClCgoD,EAAQhoD,SAASoiE,EAASpiE,QAClBgoD,EAAAlyE,MAAMkyE,EAAQhoD,SAASgoD,EAAQrkE,SAGrCqkE,EAAQjyE,OAAOqsF,EAASrsF,QAC1BiyE,EAAQjyE,OAAOqsF,EAASrsF,MAChBiyE,EAAArsD,QAAQymE,EAASrsF,OAAOiyE,EAAQpkE,SAChCokE,EAAQrsD,QAAQymE,EAASzmE,UACjCqsD,EAAQrsD,QAAQymE,EAASzmE,OACjBqsD,EAAAjyE,OAAOiyE,EAAQrsD,QAAQqsD,EAAQpkE,QAGrCmhF,EAAM7kE,KAAK8nD,EAAQjyE,QAAQgvF,EAAM7kE,KAAK8nD,EAAQrsD,UAChDqsD,EAAQjyE,OAAOgvF,EAAM7kE,IAAI8nD,EAAQpkE,QAAQ+gF,GACjC3c,EAAArsD,QAAQqsD,EAAQjyE,OAAOiyE,EAAQpkE,QAGrCmhF,EAAM9kE,KAAK+nD,EAAQlyE,OAAOivF,EAAM9kE,KAAK+nD,EAAQhoD,WAC/CgoD,EAAQlyE,MAAMivF,EAAM9kE,IAAI+nD,EAAQrkE,SAASkhF,GACjC7c,EAAAhoD,SAASgoD,EAAQlyE,MAAMkyE,EAAQrkE,SAGrCqkE,EAAQjyE,OAAO,MACjBiyE,EAAQjyE,OAAO,IAEbiyE,EAAQrsD,QAAQ,MAClBqsD,EAAQrsD,QAAQ,IAGVqsD;AAAAA,EACR;AAAA,EAEQ;AACP,UAAMpzE,IAAYsJ,KAAKimF,YACjB7iD,IAAa1sC,EAAUu+B,aACvB/3B,IAAY8C,KAAKsmF,aAAAA;AACvB,QAGIzqC,GAHAqoC,IAAWhnF,GACXijB,IAAY5pB,OAAOwwF,UAAUziF,SAASmJ,KAAK0S,WAC3CE,IAAa9pB,OAAOywF,UAAU1iF,SAASmJ,KAAK4S;AAWzC,WARJnjB,MAAcxG,EAAUuwF,eAC1B/C,IAAWxtF,EAAUwwF,QACT/mE,IAAA,GACCE,IAAA,GACPw7B,IAAAzY,EAAW9gB,gBAAgB5rB,EAAUwwF,WAErCrrC,IAAAzY,EAAW9gB,gBAAgB4hE,CAE3B,GAAA,EACNrsF,MAAKgkD,EAAI75B,IAAI3B,GACbzoB,KAAKikD,EAAI95B,IAAI5B,GACbza,OAAOm2C,EAAIn2C,OACXD,QAAQo2C,EAAIp2C,QACZqc,QAAQ+5B,EAAI95B,IAAI85B,EAAIp2C,SAAS0a,GAC7B1C,OAAOo+B,EAAI75B,IAAI65B,EAAIn2C,QAAQ2a,EAAAA;AAAAA,EAE7B;AC5KM;AAAA,MAAM8mE,GAQZ;AAAA,EAAA,YAAYzwF,GALZsJ;AAAAA,SAAQonF,aAAqB,IAMvBpnF,KAAA8pE,UAAU,IAAIkc,GAAQtvF,CAC3BsJ,GAAAA,KAAKimF,aAAavvF,GACbsJ,KAAAozC,aAAa18C,EAAU+lB,qBAAAA,GAC5Bzc,KAAKqnF,sBACN;AAAA,EAAA;AAAA,EAEA,aAAAh7C;AACCrsC,SAAK8pE,QAAQzpE,QACbL,KAAKozC,WAAW/2B;EACjB;AAAA,EACA;AACCrc,SAAKsnF,UAAAA;AAAAA,EACN;AAAA,EACA,OAAOtwF,GAAAA;AACN,QAAImiB,IAAO7U,SAASmJ;AACpB,UAAM/W,IAAYsJ,KAAKimF,YACjB7iD,IAAa1sC,EAAUu+B;AACzBj+B,IAAAA,EAAOR,WACV2iB,IAAOziB,EAAUwiB;AAGlB,QAAIquE,IAAkB;AAChB,UAAAn3E,IAAWtZ,CAAAA,MAAAA;AACV,YAAA0wF,IAAcpkD,EAAWjhB,cAAcrrB,IACvC2wF,IAAarkD,EAAW/nC,QAAQmsF,GAAaxwF,EAAOypB;AAC1D,UAAG2iB,EAAWpiB,UAAUwmE,GAAaxnF,KAAK8pE,QAAQnF;AACjD;AAGD,YAAM+iB,IAAiB,MACJH;AAAAA,QAAAA,IAAAE,GACXzwF,EAAA2wF,aAAa7wF,GAAO2wF,CAAAA;AAAAA,MAAU;AAGlC/wF,QAAUsiC,WAAWtiC,EAAUM,OAAO4wF,kBACtCH,IACaC,EAAAA,IAER1wF,EAAA6wF,aAAa/wF,GAAO2wF,CAI1BF,IAAAA,IACCE,KAAcA,MAAeF,IACxBvwF,EAAA8wF,YAAYhxF,GAAO2wF,CAEnBzwF,KAAAA,EAAA6wF,aAAa/wF,GAAOywF,CAAAA,GACTA,IAAA,MAEfE,KAAcA,MAAeF,KAChBG,EAAAA,KAIdD,KACaC,EAEjB;AAAA,IAAA;AAGI1nF,SAAAoc,OAAOplB,EAAOypB,QACnBzgB,GAAAA,KAAKozC,WAAWl3B,OAAO/C,GAAM,aAAa/I,CAAAA,GACrCpQ,KAAAonF,WAAWpwF,EAAOypB,YAAY,EAClCzD,MAAM7D,GACN/I,SAAAA,EAAAA;AAAAA,EAEF;AAAA,EAEA,OAAOqQ,GACA;AAAA,UAAAsnE,IAAW/nF,KAAKonF,WAAW3mE;AAC9BsnE,SACF/nF,KAAKozC,WAAWh3B,OAAO2rE,EAAS/qE,MAAM,aAAa+qE,EAAS33E,OAAAA;AAAAA,EAE9D;AAAA,EAEA,WAAWpZ;AACJ,UAAAgxF,IAAiBlxF,CAAAA,MACtB;AAAA,UAAIkoE,IAAQloE;AAOL,aAJJwN,SAA4B,qBAAA,CAAMA,SAAS40B,gBAErC8lC,IAAA16D,SAA4B,kBAAExN,CAAAA,IAEhCkoE;AAAAA,IAAA;AAERh/D,SAAKqnF,sBAAAA,GACLrnF,KAAKkc,OAAO,EACXuE,UAAUzpB,EAAOypB,UACjBjqB,QAAQQ,EAAOR,QACfmxF,cAAa,CAAC7wF,GAAmBkmB,MAAAA;AAChC,YAAM5kB,IAAOpB,EAAOoB,KAAKtB,GAAOkmB,CAAAA;AAC7B5kB,MAAAA,KACF4H,KAAKioF,UAAUD,EAAclxF,CAAAA,GAAQsB,CACtC;AAAA,IAAA,GAED0vF,aAAY,CAAChxF,GAAmBkmB;AAC/B,YAAM5kB,IAAOpB,EAAOoB,KAAKtB,GAAOkmB;AAC7B5kB,MAAAA,IACF4H,KAAKioF,UAAUD,EAAclxF,CAAAA,GAAQsB,MAErC4H,KAAKioF,UAAUhzE,kBACfjV,KAAKsnF,UAAAA;AAAAA,IACN,GAEDO,cAAa,MACZ7nF;AAAAA,WAAKioF,UAAUhzE,eACfjV,GAAAA,KAAKsnF;IAAU,EAGlB,CAAA;AAAA,EAAA;AAAA,EAEQ,wBACP;AAAA,UAAM5wF,IAAYsJ,KAAKimF;AAEpBjmF,SAAKioF,aACPjoF,KAAKioF,UAAUhzE,kBAEbjV,KAAKsnF,aACPtnF,KAAKsnF,UAAUryE,eAAAA,GAEhBjV,KAAK8pE,QAAQzpE,KAEbL,GAAAA,KAAKioF,YAAaC,GAAsBpzE,MAAM,CAAChe,GAAmBsB,MAAAA;AAAAA,MAC9D1B,EAAUmJ,UAAU,mBAAmB,CAAC/I,CAC1CkJ,CAAAA,MAFgE5H,KAEhE4H,KAAK8pE,QAAQzpE,KAERL,KAAAA,KAAA8pE,QAAQhC,WAAW1vE,CAAAA,GACnB4H,KAAA8pE,QAAQqe,KAAKrxF,CACnB;AAAA,IAAA,GACEJ,EAAUM,OAAOoxF,mBAAmB,CAEvCpoF,GAAAA,KAAKsnF,YAAaY,GAAsBpzE,MAAM;AAC7C9U,WAAKioF,UAAUhzE,eACfjV,GAAAA,KAAK8pE,QAAQzpE,KAAAA;AAAAA,IAAK,GAChB3J,EAAUM,OAAOqxF,wBAAwB,CAC7C;AAAA,EAAA;AAAA;ACzHD,MAAeC,KAAA,EACdC,cC1Cc,SAAS7xF,GAExBA;AAAAA,IAAUM,OAAOwxF,mBAAmB,OACpC9xF,EAAU+xF,qBAAqB,SAASvtF;AACvC,QACIutB,IADQvtB,EAAEE,OACCP,aAAa,gBAAA,GACxB6tF,IAAMhyF,EAAUgC,KAAKuuB,YAAYvwB,EAAUM,OAAOy2D,cAAiB,EAAA;AACvE,QAAIhlC;AAIH,aAHA/xB,EAAU6V,eAAem8E,EAAIjgE,CAAAA,GAAK/xB,EAAUM,OAAOwxF,gBAAAA,GAC/CttF,KAAKA,EAAE28B,kBACV38B,EAAE28B,eAAAA,GAAAA;AAAAA,EAGL,GACAnhC,EAAUsE,YAAY,oBAAoB;AACzC,QAAI2tF,IAAa,SAAS5+E,GAAK6+E,GAAAA;AAC9BA,MAAAA,IAAWA,KAAa7+E,IAAI,eAExBrT,EAAUya,UAAU,uBAAsBy3E,OAC7ClyF,EAAUya,UAAU,uBAAsBy3E,CAAYlyF,IAAAA,EAAUya,UAAUy3E,CAAAA;AAE3E,UAAIC,IAASnyF,EAAUya,UAAU,uBAAsBy3E,IACnDE,IAAMpyF,EAAUgC,KAAK0tB,YAAY1vB,EAAUM,OAAOy2D,QAAAA;AACtD/2D,QAAUya,UAAUy3E,KAAY,SAASlwF,GAAAA;AACxC,eAAO,wBAAwBowF,EAAIpwF,KAAQ,gBAAgBmwF,EAAOnwF,CAAQ,IAAA;AAAA,MAC7E;AAAA,IACA;AAIC,QAFAiwF,EAAW,MAAA,GACXA,EAAW,IAAI,WAAA,GACX3oF,KAAK/C;AACR,eAAS8M,KAAO/J,KAAK/C;AACpB0rF,QAAAA,EAAW5+E,CAGb/J;AAAAA,SAAKi4C,gBAAgBj4C,KAAKuuB,MAAM,SAAS73B,EAAU+xF,kBAAAA,GACnD/xF,EAAUI,MAAMkJ,KAAKuuB,MAAM,SAAS73B,EAAU+xF;EAC/C,CAEA;AAAA,GDICM,eE3Cc,SAASryF,GAAAA;AAExBA,IAAUgC,KAAKswF,oBAAoB,SAAStwF;AAC3C,WAAOhC,EAAUgC,KAAKC,IAAID,GAAM,GAAG,MACpC;AAAA,EAAA,GAEAhC,EAAUya,UAAU83E,qBAAqB,SAAStlF,GAAMC,GAAInH,GAAAA;AAC3D,WAAIA,EAAG4C,SACCW,KAAKk9B,SAASzgC,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAAA,IAAI,MAAIuD,KAAKgvD,WAAWrrD,KAElEjN,EAAUya,UAAU+rB,SAASv5B,CAAO,IAAA,cAAYjN,EAAUya,UAAU+rB,SAASt5B,CAAAA;AAAAA,EACtF,GACAlN,EAAUya,UAAU+3E,qBAAqB,SAASvlF,GAAMC,GAAI9M,GAC3D;AAAA,WAAOA,EAAMoc;AAAAA,EACd,GACAxc,EAAUya,UAAUg4E,qBAAqB,WAAA;AAAY,WAAO;AAAA,EAAG,GAE/DzyF,EAAUgC,KAAK0wF,sBAAoB,WAAY;AAAA,WAAO1yF,EAAUgC,KAAKwF,UAAUxH,EAAU+J,aAAAA,CAAAA;AAAAA,EAAgB,GAEzG/J,EAAUsE,YAAY,oBAAmB,WACxC;AAAA,QAAIquF,IAA4B3yF,EAAU4yF;AAC1C5yF,MAAU4yF,wBAAwB,WACjC;AAAA,UAAItpF,KAAKoB,SAAS;AAATA,SACHpB,KAAKhJ,OAAOy6B,YAAYzxB,KAAKhJ,OAAOsT,mBACxCtK,KAAKuK;eAEF8+E;AACH,eAAOA,EAA0BzmF,MAAM5C,MAAM+I,SAEjD;AAAA,IAAA;AAGC,QAAI+b,IAAMpuB,EAAU+V;AACpB/V,MAAU+V,cAAY,SAAS5N;AAC9B,UAAImB,KAAKoB,SAAS;AAGjB,eAAO0jB,EAAIliB,MAAM5C,MAAK+I,SAAAA;AAFtBwgF,MAAAA;IAGH;AAEC,QAAIC,IAAuB9yF,EAAUgW;AA4BrC,aAAS68E,IAGR;AAAA,UAAI/2E,IAAS9b,EAAU85D,mBACvBh+C;AAAAA,MAAAA,EAAO8O,KAAK,SAASzI,GAAEC;AAAI,eAAOD,EAAE5gB,aAAW6gB,EAAE7gB,aAAW,IAAG;AAAA,MAAE,CAMjE;AAAA,eAHIuwD,GAEApwD,IAAK,kCAHO1B,EAAU66B,SAASg3B,yBAGgB,KAC1C3uD,IAAE,GAAGA,IAAE4Y,EAAO3Y,QAAQD,KAAI;AAClC,YAAI6C,IAAK+V,EAAO5Y,CAAAA,GACZ6+D,IAAYh8D,EAAGg6D,QAAO,sCAAoCh6D,EAAGg6D,QAAM,MAAK,IACxEA,IAASh6D,EAAGu6D,YAAW,iCAA+Bv6D,EAAGu6D,YAAU,MAAK,IACxEyyB,IAAW/yF,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAE3E+rD;AAAAA,QAAAA,IAAwB9xD,EAAU66B,SAASi3B,sBAAsB/rD;AACjE,YAAIitF,IAA0BhzF,EAAU66B,SAASk3B,uBAAAA;AAEjDrwD,QAAAA,KAAM,UAAQowD,IAAsB,6BAA2BihC,IAAS,MAAIA,IAAS,MACnF,iBAAehtF,EAAG9C,KAAG,OAAKjD,EAAUM,OAAO0C,kBAAgB,OAAK+C,EAAG9C,KAAG,cAAY88D,IAASgC,KAC1Fh8D,EAAG85D,eAAa,MAAI,2CACpB7/D,EAAUM,OAAOsgC,MAAM5gC,EAAUya,UAAUw4E,YAAYltF,EAAGvE,UAASuE,EAAGxE,YAAYwE,CAAAA,IAAI/F,EAAUya,UAAUw4E,YAAYltF,EAAGxE,YAAYwE,EAAGvE,UAASuE,CAClJ,KAAA,UACFrE,KAAM,QAAQsxF,CAGdtxF;AAAAA;AAAAA,kBAAAA,KAAM,WAAS1B,EAAUya,UAAUy4E,YAAYntF,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAAA,IAAI;AAAA,MAC/E;AACDrE,MAAAA,KAAM,0CAGN1B,EAAU6J,KAAmB,aAAE,GAAGiE,YAAYpM,GAC9C1B,EAAU6J,KAAmB,aAAE,CAAGmG,EAAAA,WAAW,CAAGyZ,EAAAA,YAAYzpB,EAAUmzF,oBAAkB;AAGxF,UAAIC,IAAcpzF,EAAU6J,KAAmB,aAAE,CAAA,EAAGmG,WAAW,CAAA;AAChDojF,MAAAA,EAAYpjF,WAAWojF,EAAYpjF,WAAW7M,SAAO,GAC3DlC,MAAM8N,SAAUqkF,EAAY/vE,eAAerjB,EAAU6J,KAAmB,aAAE,CAAGwZ,EAAAA,eAAgB,SAAU+vE,EAAY/vE,eAAa;AAEzI,UAAI9Q,IAAEvS,EAAU6J,KAAmB,aAAE,CAAGoG,EAAAA,WAAWD,YAE/CqjF,IAAcrzF,EAAU0sD,mBACzB2mC;AAKH,WALGA,MACFA,EAAYvlF,YAAU9N,EAAUya,UAAU64E,YAAYtzF,EAAUkK,WAAWlK,EAAUiK,WAAWjK,EAAU0K,SAG3G1K,EAAU0lC,YAAU,IACXxiC,IAAE,GAAGA,IAAIqP,EAAEpP,SAAO,GAAGD;AAC7BlD,UAAU0lC,UAAUxiC,CAAGqP,IAAAA,EAAErP;IAE1B;AA9EDlD,MAAUgW,mBAAmB,WAK5B;AAAA,aAJG1M,KAAKoB,SAAS,oBAChB1K,EAAUmzF,mBAAmBnzF,EAAU6J,KAAmB,aAAE,CAAGmG,EAAAA,WAAW,GAAGyZ,WAC7EzpB,EAAU6J,KAAmB,aAAE,CAAGmG,EAAAA,WAAW,GAAGyZ,YAAY,IAEtDqpE,EAAqB5mF,MAAM5C,MAAK+I;IACzC,GA0ECrS,EAAUuzF,qBAAmB,SAAShvF,GACrCvE;AAAAA,QAAUkK,YAAYlK,EAAUM,OAAOkzF,gBAAcxzF,EAAUgC,KAAK0wF,oBAAoB1yF,EAAUoT,KAAAA,GAClGpT,EAAUiK,YAAYjK,EAAUM,OAAOmzF,cAAYzzF,EAAUgC,KAAKswF,kBAAkBtyF,EAAUkK,WAAW,IAxE1G,SAAuB3F,GAAAA;AACtB,YAAIA,GAAK;AACR,cAAIq0E,IAAI54E,EAAU0tB,OAAOwN,QAErBw4D,IAAU1zF,EAAU66B,SAAS62B,qBAAAA,GAC7BiiC,IAAa3zF,EAAU66B,SAAS82B,qBAAqBinB,EAAE52E,IACvD4xF,GAAAA,IAAoB5zF,EAAU66B,SAAS+2B,4BAA4BgnB,EAAEv+B,WAEzEr6C;AAAAA,YAAU6J,KAAqB,eAAE,CAAGiE,EAAAA,YAAU,UAAQ4lF,IAAR,0DACrCC,IAAW,MAAI/a,EAAE52E,OADoB,wEAEmB4xF,IAAkB,MAAIhb,EAAEv+B,cAF3C,iBAI9Cr6C,EAAUyK,cAAY,IACtBzK,EAAUiiD,UACV;AAAA,QAAA;AAAA,MACD,EA2Dc19C,CAAAA,GACVA,KACHvE,EAAU2O,QAAQ,MAClB3O,EAAUulD,SAAS,MACnBvlD,EAAUyK,cAAc,IAExBooF,OAEA7yF,EAAUyK,cAAAA;AAAAA,IAGb;AAAA,EACA,CAGA;AAAA,GFhGCopF,aG5Cc,SAAS7zF,GAAAA;AAEvBA,IAAUgC,KAAK8xF,aAAa,SAAS9xF,GAAMmtB,GAAAA;AAC1C,WAAOnvB,EAAUgC,KAAKC,IAAID,GAAM,IAAEmtB,GAAK;EACzC,GAECnvB,EAAUya,UAAUw4E,cAAc,SAAShmF,GAAMC,GAAInH,GACpD;AAAA,WAAIA,EAAG4C,SACC,GAAGW,KAAKgvD,WAAWrrD,CAAAA,CAAAA,MAAY3D,KAAKgvD,WAAWprD,CAAAA,CAAAA,KAE/ClN,EAAU0tB,OAAOwN,OAAOF;AAAAA,EAElC,GACCh7B,EAAUya,UAAUy4E,cAAc,SAASjmF,GAAMC,GAAInH,GAAAA;AACpD,WAAOA,EAAGyW;AAAAA,EACZ;AAEC,QAAMu3E,IAAe/zF,EAAUgC,KAAK0tB,YAAY,OAAA,GAC1CskE,IAAch0F,EAAUgC,KAAK0tB,YAAY,IAAA;AAE/C1vB,IAAUya,UAAUw5E,aAAa,SAASjyF,GAAAA;AACzC,WAAO,oCAAoC+xF,EAAa/xF;oCACtBgyF,EAAYhyF,CAAAA,CAAAA;AAAAA,EAChD,GACChC,EAAUya,UAAU64E,cAAc,SAASrmF,GAAOC,GAAAA;AACjD,WAAOlN,EAAUya,UAAUk8C,WAAW32D,EAAU4E,SAAAA,EAAW5C,IAC7D;AAAA,EAAA,GAEChC,EAAUgC,KAAKwxF,eAAa,SAASxxF,GAAAA;AACpC,WAAOhC,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKR,CAC7C,CAAA;AAAA,EAAA;AAEC,MAAIynB,IAAY;AAEhBzpB,IAAUsE,YAAY,oBAAmB,WACxC;AAAA,QAAIquF,IAA4B3yF,EAAU4yF;AAC1C5yF,MAAU4yF,wBAAwB,WACjC;AAAA,UAAItpF,KAAKoB,SAAS;AAATA,SACHpB,KAAKhJ,OAAOy6B,YAAYzxB,KAAKhJ,OAAOsT,mBACxCtK,KAAKuK,YAAAA;AAAAA,eAEF8+E;AACH,eAAOA,EAA0BzmF,MAAM5C,MAAM+I,SAElD;AAAA,IAAA;AAGE,QAAI+b,IAAMpuB,EAAU+V;AACpB/V,MAAU+V,cAAY,SAAS5N,GAC9B;AAAA,UAAImB,KAAKoB,SAAS;AAGjB,eAAO0jB,EAAIliB,MAAM5C,MAAK+I,SAAAA;AAFtBwgF,MAAAA,EAGJ;AAAA,IAAA;AAEE,QAAIC,IAAuB9yF,EAAUgW;AASrC,aAAS68E,IAAAA;AACR,YAAM/2E,IAAS9b,EAAU85D,mBACzBh+C;AAAAA,MAAAA,EAAO8O,KAAK,SAASzI,GAAEC,GAAI;AAAA,eAAOD,EAAE5gB,aAAW6gB,EAAE7gB,aAAW,IAAG;AAAA,MAAE,CAEjE;AAAA,YAAM2yF,IAAe,CAAA;AACrB,UAAI3xF,IAAWvC,EAAU4E,SAAWuJ,EAAAA;AACpC,YAAMgwC,IAAUn+C,EAAU4E,SAAWwJ,EAAAA;AACrC,aAAM7L,EAASE,YAAY07C,EAAQ17C,QAAAA;AAClCyxF,QAAAA,EAAa3xF,EAASE,QAAAA,CAAAA,IAAa,IACnCF,IAAWvC,EAAUgC,KAAKC,IAAIM,GAAU,GAAG;AAG5C,UAAI4xF,IAAAA;AAaJ,UAXAr4E,EAAO1X,QAAS2B,CAAAA,MACf;AAAA,YAAI2B,IAAa1H,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKuD,EAAGxE;AACtD,eAAOmG,EAAWjF,YAAYsD,EAAGvE,SAASiB,QACrCyxF;AAAAA,UAAAA,EAAaxsF,EAAWjF,QAAAA,CAAAA,MAC3ByxF,EAAaxsF,EAAWjF,QAAAA,CAAAA,EAAWE,KAAKoD,CACxCouF,GAAAA,IAAAA,KAEDzsF,IAAa1H,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAIyF,GAAY,GAAG;MACxE,CAGEysF,GAAAA,GAEC;AACJ,YAAIzyF,IAAO;AACX,iBAAQuM,KAAOimF;AACXl0F,YAAUo0F,iBAAiBp0F,EAAUo0F,cAAc,IAAI5xF,KAAS,IAAJyL,CAAAA,CAAAA,MAG/DvM,KAAQ2yF,EAAU,IAAI7xF,KAAS,IAAJyL,CAAQimF,GAAAA,EAAajmF;AAGjDjO,UAAU6J,KAAmB,aAAE,CAAGiE,EAAAA,YAAYpM;AAAAA,MAC9C;AAXA1B,UAAU6J,KAAmB,aAAE,CAAGiE,EAAAA,YAyB5B,yCAAyC9N,EAAU0tB,OAAOwN,OAAOkf,UAZxEp6C;AAAAA,QAAU6J,KAAmB,aAAE,CAAG4f,EAAAA,YAAYA;AAE9C,UAAIlX,IAAIvS,EAAU6J,KAAmB,aAAE,GAAG9G,iBAAiB,4BAAA;AAC3D/C,QAAU0lC,YAAY,CACtB;AAAA,eAASxiC,IAAI,GAAGA,IAAIqP,EAAEpP,SAAS,GAAGD;AACjClD,UAAU0lC,UAAUxiC,CAAAA,IAAKqP,EAAErP,CAAAA;AAAAA,IAE5B;AAQD,aAASmxF,EAAUpmF,GAAK6N,GACvB;AAAA,UAAA,CAAIA,EAAO3Y;AACV,eAAO;AAER,UAAIzB,IAAO;AAAA,6CAC+B1B,EAAUya,UAAU8c,YAAYtpB,iBAAmBA,EAAIxG,OAAAA,CAAAA;AAAAA,0CAC1DzH,EAAUya,UAAUw5E,WAAWhmF;;;AAStE,aALA6N,EAAO1X,QAASkwF,CAAAA,MACf5yF;AAAAA,QAAAA,KAOF,SAAwBuM,GAAKqmF,GAAAA;AAC5B,gBAAMnnF,IAAQnN,EAAUya,UAAUw4E,YAAYqB,EAAc/yF,YAAY+yF,EAAc9yF,UAAU8yF,CAAAA,GAC1FC,IAAav0F,EAAU4E,SAAAA,EAAWo/C,WAClCiI,IAAMjsD,EAAUya,UAAU89C,YAAY+7B,EAAc/yF,YAAY+yF,EAAc9yF,UAAU8yF,CAAAA,GACxFj6C,IAAcr6C,EAAUya,UAAUy4E,YAAYoB,EAAc/yF,YAAY+yF,EAAc9yF,UAAU8yF,CAEtG;AAAA,cAAIrzF,IAAQ;AACZ,kBAAGqzF,EAAcv0B,SAASu0B,EAAch0B,eAGvCr/D,IAAQ,WAFIqzF,EAAcv0B,QAAS,sCAAsCu0B,EAAcv0B,QAAQ,MAAO,KACvFu0B,EAAch0B,YAAa,iCAAiCg0B,EAAch0B,YAAY,MAAO,EAAA,OAItG,yCAAyCrU,KAAK,EAAA,IAAMqoC,EAAcrxF,MAAMsxF,IAAa,uCAAuC,EAAOtzF,KAAAA,CAAAA,IAASjB,EAAUM,OAAO0C,eAAoBsxF,KAAAA,EAAcrxF;;+CAE1JkK,CACAktC;AAAAA,+CAAAA,CAAAA;AAAAA;AAAAA,QAE5C,EAzBwBpsC,GAAKqmF;MAAc,CAG3C5yF,GAAAA,KAAQ,gBACDA;AAAAA,IACP;AA9ED1B,MAAUgW,mBAAmB,WAK5B;AAAA,aAJG1M,KAAKoB,SAAS,aAChB+e,IAAYzpB,EAAU6J,KAAmB,aAAE,CAAA,EAAG4f,WAC9CzpB,EAAU6J,KAAmB,aAAE,CAAA,EAAG4f,YAAY,IAExCqpE,EAAqB5mF,MAAM5C,MAAK+I,SAAAA;AAAAA,IAC1C,GA8FErS,EAAU6zF,cAAY,SAAStvF;AAC9B,MAAIA,KACHvE,EAAUkK,YAAYlK,EAAUM,OAAOkzF,gBAAgBxzF,EAAUgC,KAAKwxF,aAAaxzF,EAAUoT,QAC7FpT,EAAUiK,YAAYjK,EAAUM,OAAOmzF,cAAczzF,EAAUgC,KAAK8xF,WAAW9zF,EAAUkK,WAAW,CACpGlK,GAAAA,EAAU2O,QAAQ,MAClB3O,EAAUulD,SAAS,MACnBvlD,EAAUyK,kBAESzK,EAAU0sD,mBAClB5+C,EAAAA,YAAY9N,EAAUya,UAAU64E,YAAYtzF,EAAUoT,KAAAA,GAEjEy/E,OAEA7yF,EAAUyK;IAGd;AAAA,EACA,CAeA;AAAA,GH/IC89C,WI7Cc,SAASvoD;AAEvBA,IAAUM,OAAOioD,YAAY,SAC7BvoD,EAAUM,OAAOk0F,kBAAkB,IAEnCx0F,EAAU6c,IAAI43E,WAAW,EACxBC,iBAAiB,SAAS3uF,GAAAA;AACzB,cAAUA,EAAG4C,UAAU3I,EAAUM,OAAOioD,cAA3B5/C,MAAkD3I,EAAUM,OAAOioD,aAAa,WAAWosC,EAAe5uF,CAAAA;AAAAA,EACvH;AAGF,MAAI4uF,IAAiB,SAAU5uF,GAC9B;AAAA,WAAA,GAAMA,EAAGvE,WAAWuE,EAAGxE,sBAA4B,OAKhDvB,EAAU+I,cAAc,YAAY/I,EAAU8I,YAAY/C,EAAG9C;AAAAA,EAIlE;AAICjD,IAAU40F,aAAa,SAASx0F,GAC/B;AAAA,QAAIy0F,IAAQ,MACXx4E,IAAOrc,EAAU49D,YAAYx9D,CAAAA;AAY9B,WAXGA,EAAM6a,cACR45E,IAAQ70F,EAAUyE,SAASrE,EAAM6a,aAG9B45E,KAASA,EAAMC,cAAc10F,CACzBic,MAAAA,OAAAA,EAAK0sD,cACL1sD,OAAAA,EAAKpB,WACLoB,OAAAA,EAAK83B,oBACL93B,EAAKjU,WAGNiU;AAAAA,EACT;AAEC,MAAI04E,IAA4B/0F,EAAU87D,yBACtCk5B,IAA6Bh1F,EAAU67D,0BAEvCo5B,IAAmB,SAAU9sF,GAAK+xD,GAAAA;AACrC,WAAK5wD,KAAKmB,cAIHuqF,EAA2BzgF,KAAKjL,MAAMnB,GAAK+xD,CAAAA,IAH1C66B,EAA0BxgF,KAAKjL,MAAMnB,GAAK+xD,CAAAA;AAAAA,EAIpD;AAECl6D,IAAU87D,0BAA0B97D,EAAU67D,2BAA2B,SAAS1zD,GAAK+xD,GAAAA;AACtF,QAAK5wD,CAAAA,KAAKhJ,OAAOioD,aACfj/C,KAAKmB,eAAenB,KAAKoB,SAAS,WAClCpB,KAAKoB,SAAS,WAAYpB,CAAAA,KAAKhJ,OAAOk0F;AACvC,aAAOS,EAAiB1gF,KAAKjL,MAAMnB,GAAK+xD,CAAAA;AAEzC,aAASh3D,IAAE,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AAClC,UAAI6C,IAAGoC,EAAIjF,CAAAA;AAEX,WAAI6C,EAAG4C;AAGP,YAAIW,KAAKhJ,OAAOioD,aAAa,WACvBosC,EAAe5uF,CAAAA,GADrB;AASA,cAAImvF,IAAK5rF,KAAKsrF,WAAW7uF,CAAAA;AACrBA,UAAAA,EAAGovF,WAGND,EAAGt2B,eAAAA,KAFHs2B,EAAGt2B,eAAAA,IAIJs2B,EAAGn0B,eAAAA,IACHm0B,EAAGC,WAAAA,IACHD,EAAG3zF,aAAa,IAAIiB,KAAK0yF,EAAG3zF,UAAAA,GAEvB6zF,EAAiBrvF,CAIrBmvF,KAAAA,EAAG1zF,WAAW6zF,EAAWH,EAAG3zF,UACC,GAAzB+H,KAAKhJ,OAAO+J,aAAa,OAC5B6qF,EAAG1zF,WAAW8zF,EAAYJ,EAAG3zF,YAAY+H,KAAKhJ,OAAO+J,SAAAA,MALtD6qF,EAAG1zF,WAAW,IAAIgB,KAAKuD,EAAGvE,QAS3B;AAAA,cAAI+zF;AACAL,UAAAA,EAAG3zF,aAAa+H,KAAKW,aAAairF,EAAG1zF,WAAW8H,KAAKY,aAAagrF,EAAG3zF,aAAa2zF,EAAG1zF,aACxF2G,EAAIjF,CAAAA,IAAKgyF,GACTK,IAAgB;AAMjB,cAAIC,IAAKlsF,KAAKsrF,WAAW7uF;AAQzB,cAPAyvF,EAAGL,eACHK,EAAGh0F,WAAW,IAAIgB,KAAKgzF,EAAGh0F,QACtBg0F,GAAAA,EAAGj0F,aAAa+H,KAAKY,YACxBsrF,EAAGj0F,aAAa+zF,EAAYhsF,KAAKY,WAAWZ,KAAKhJ,OAAO8J,UAAAA,IAExDorF,EAAGj0F,aAAa+zF,EAAYD,EAAWtvF,EAAGxE,aAAa+H,KAAKhJ,OAAO8J,aAEhEorF,EAAGj0F,aAAa+H,KAAKW,aAAaurF,EAAGj0F,aAAai0F,EAAGh0F,UAAU;AAClE,iBAAI+zF,GAEE;AACLptF,cAAAA,EAAIjF,GAAOsyF,IAAAA;AACX;AAAA,YACA;AAJArtF,YAAAA,EAAIqJ,OAAOtO,IAAE,GAAE,GAAEsyF,IAKlBA,EAAG32B,cAAAA;AAAAA,UACP;AACIq2B,YAAAA,EAAGr2B,cAAc,IACjBq2B,EAAGn0B,eAAAA;AAAAA,QAjDH;AALmB,UAAdz3D,KAAKoB,SAAS,WACjBvC,EAAIqJ,OAAOtO,KAAK,CAAA;AAAA,IAwDnB;AAGD,QAAIuyF,IAAUnsF,KAAKP,cAAc,UAAcmxD;AAC/C,WAAO+6B,EAAiB1gF,KAAKjL,MAAMnB,GAAKstF,CAAAA;AAGxC,aAASL,EAAiBrvF,GACzB;AAAA,UAAI2vF,IAAWL,EAAWtvF,EAAGxE;AAC7B,aAASwE,CAAAA,EAAGvE,YAAYk0F;AAAAA,IACxB;AACD,aAASL,EAAWrzF,GACnB;AAAA,UAAI0zF,IAAW11F,EAAUgC,KAAKC,IAAID,GAAM,GAAG;AAE3C,aADA0zF,IAAW11F,EAAUgC,KAAKwF,UAAUkuF;IAEpC;AACD,aAASJ,EAAYtzF,GAAMstB,GAAAA;AAC1B,UAAIggB,IAAMtvC,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKR;AAE5C,aADAstC,EAAItmC,SAASsmB,CACNggB,GAAAA;AAAAA,IACP;AAAA,EACH;AACC,MAAIqmD,IAAyB31F,EAAU85D;AACvC95D,IAAU85D,qBAAqB,SAASC,GAAAA;AACvC,WAAMzwD,KAAKhJ,OAAOioD,aAAaj/C,KAAKhJ,OAAO4sD,YAEpCyoC,EAAuBphF,KAAKjL,MAAAA,MAD3BqsF,EAAuBphF,KAAKjL,MAAMywD,CAE5C;AAAA,EAAA,GACC/5D,EAAUsE,YAAY,sBAAsB,SAAUsxF,GAAUC,GAAUtxF,GAAMvC;AAE/E,WADAhC,EAAU2oD,aAAcpkD,KAAQ,SAASA,KAAQ,UAAUvE,EAAUY,QAAQ2D,CAAAA,GAAAA;AAAAA,EAE/E,CAAA,GAECvE,EAAUi6D,sBAAsB,SAASl0D;AACxC,WAAO/F,EAAU6c,IAAI43E,SAASC,gBAAgB3uF,CAChD;AAAA,EAAA;AAEC,MAAI+vF,IAAY91F,EAAUiW;AAC1BjW,IAAUiW,cAAc,SAAShT,GAAAA;AAIhC,QACI8yF,GACA3sC,GAFArjD,IAAK/F,EAAUyE,SAASxB,CAAAA;AAGzB8C,IAAAA,MACFgwF,IAAoB/1F,EAAUM,OAAOioD,aAAevoD,EAAAA,EAAU4I,cAAc5I,EAAU0W,QAAQzT,OAAQjD,EAAU4E,SAAAA,EAAWw/B,cAE1HglB,IAAUppD,EAAUM,OAAOsoD,eAC3B5oD,EAAUM,OAAOsoD,gBAAgB,KAGnCktC,EAAU5pF,MAAMlM,GAAWqS,SAAAA,GAExBtM,KACEgwF,MACH/1F,EAAUM,OAAOsoD,gBAAgBQ;AAAAA,EAGrC;AAEA,GJ3IC4sC,WK9Cc,SAASh2F,GAAAA;AAExB,MAAIi2F,GACApe;AAIJ,WAASqe,EAAgB5uB;AACHtnE,MAAUwoD,kBAAAA,KACZ8e,MAClB2uB,IAAej2F,EAAUyE,SAAS6iE,CAAAA,EAAUtnE,EAAUqwD,sBAAAA,CAAAA;AAAAA,EAExD;AAPArwD,IAAUM,OAAO61F,kBAAkB,GASnCn2F,EAAUsE,YAAY,gBAAe,SAASrB,GAE7C;AAAA,WADAizF,EAAgBjzF,CAAAA,GAAAA;AAAAA,EAEjB,CACAjD,GAAAA,EAAUsE,YAAY,oBAAmB,SAASrB;AACjD,UAAM8C,IAAK/F,EAAUyE,SAASxB,CAG9B;AAAA,WAFA40E,IAAS,CAAC9xE,EAAGxE,YAAYwE,EAAGvE,QAAAA,GAC5B00F,EAAgBjzF,CACT,GAAA;AAAA,EACR,CACAjD,GAAAA,EAAUsE,YAAY,kBAAiB,SAASrB,GAC/C;AAAA,QAAA,CAAKA,MAAOjD,EAAUyE,SAASxB;AAAK,aAAO;AAC3C,UAAM8C,IAAK/F,EAAUyE,SAASxB;AAC9B,QAAKjD,CAAAA,EAAUo2F,eAAerwF,CAAI,GAAA;AACjC,WAAK8xE;AAAQ,eAAA;AACb9xE,QAAGxE,aAAas2E,EAAO,IACvB9xE,EAAGvE,WAAWq2E,EAAO,CACrB9xE,GAAAA,EAAG4C,SAAOW,KAAKV,cAAc7C,CAC7B;AAAA,IAAA;AACD,WAAO;AAAA,EACR,IACA/F,EAAUsE,YAAY,wBAAuB,SAASyB,GAAGvB,GAAEglD,GAC1D;AAAA,WAAOxpD,EAAUo2F,eAAerwF,CACjC;AAAA,EAAA,CAAA,GACA/F,EAAUsE,YAAY,gBAAe,SAASrB,GAAG8C,GAAAA;AACjC/F,MAAUo2F,eAAerwF,CAAAA,KAEvC/F,EAAUub,YAAYtY,CACxB;AAAA,EAAA,CAAA,GACAjD,EAAUsE,YAAY,eAAc,SAASrB,GAAIozF,GAAW7sC;AAK3D,SAJA6sC,IAAYr2F,EAAUiM,YAAYoqF,CACxBpzF,GAAAA,KAAKA,IAGVozF,EAAU90F,cAAAA,CAAc80F,EAAU70F,UAAU;AAChD,YAAMuE,IAAK/F,EAAUyE,SAASxB,CAAAA;AAC9BozF,MAAAA,EAAU90F,aAAa,IAAIiB,KAAKuD,EAAGxE,aACnC80F,EAAU70F,WAAW,IAAIgB,KAAKuD,EAAGvE,QACjC;AAAA,IAAA;AAKD,YAHI60F,EAAUn7E,UAAUm7E,EAAUC,sBAAuBD,EAAUjuF,aAClEpI,EAAUmb,iBAAiBk7E,CAErBr2F,GAAAA,EAAUo2F,eAAeC,CAAAA;AAAAA,EACjC,CAEAr2F,GAAAA,EAAUu2F,4BAA4B,SAASx8D,GAAO6/C;AACrD,UAAMp2E,IAASxD,EAAUqwD,sBACzB;AAAA,WAAIt2B,EAAMv2B,CAAWo2E,KAAAA,EAAOp2E,MAAWu2B,EAAM92B,MAAM22E,EAAO32E;AAAAA,EAG3D,GAEAjD,EAAUo2F,iBAAiB,SAASrwF,GACnC;AAAA,QAAIoC,IAAM,CAAA;AACV,UAAMguF,IAAkBn2F,EAAUM,OAAO61F;AAEzC,QAAIpwF,EAAGqC,UAAU;AAChB,UAAIouF,IAAYx2F,EAAUy2F,YAAY1wF;AACtC,eAAS4G,IAAI,GAAGA,IAAI6pF,EAAUrzF,QAAQwJ,KAAK;AAC1C,YAAI+pF,IAAO12F,EAAUqkC,UAAUmyD,EAAU7pF,CAAAA,EAAGpL,YAAWi1F,EAAU7pF,CAAAA,EAAGnL;AACpE,iBAASqyB,IAAI,GAAGA,IAAI6iE,EAAKvzF,QAAQ0wB;AAC3B6iE,WAAAA,EAAK7iE,GAAG5Y,aAAay7E,EAAK7iE,GAAG5wB,OAAO8C,EAAG9C,MAC3CkF,EAAIxF,KAAK+zF,EAAK7iE;MAEhB;AAAA,IACH,WAAY9tB,EAAGmV,OAAO;AACpB,UAAIs7E,IAAYx2F,EAAUy2F,YAAY1wF,CACtC;AAAA,eAAS4G,IAAI,GAAGA,IAAI6pF,EAAUrzF,QAAQwJ,KAAK;AAC1C,YAAI+pF,IAAO12F,EAAUqkC,UAAUmyD,EAAU7pF,GAAGpL,YAAWi1F,EAAU7pF,GAAGnL,QACpE;AAAA,iBAASqyB,IAAI,GAAGA,IAAI6iE,EAAKvzF,QAAQ0wB;AAAAA,WAC3BnwB,OAAOgzF,EAAK7iE,CAAAA,EAAG5wB,IAAIU,MAAM,GAAA,EAAK,MAAM+yF,EAAK7iE,CAAAA,EAAG5wB,OAAO8C,EAAG9C,MAC1DkF,EAAIxF,KAAK+zF,EAAK7iE,CAAAA,CAAAA;AAAAA,MAEhB;AAAA,IACH,OAAQ;AACN1rB,UAAMnI,EAAUqkC,UAAUt+B,EAAGxE,YAAYwE,EAAGvE,QAAAA;AAC5C,eAAS0B,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,YAAIyzF,IAAaxuF,EAAIjF,CAAAA;AAErB,YAAIyzF,EAAW1zF,MAAM8C,EAAG9C,MAAO0zF,EAAW5tB,gBAAgB,CAAC4tB,EAAW17E,WAAW07E,EAAW5tB,YAAct7D,EAAAA,KAAK,QAAQ1H,EAAG9C,IAAK;AAC9HkF,YAAIqJ,OAAOtO,GAAE,CACb;AAAA;AAAA,QACA;AAED,YAAIyzF,EAAWL,sBAAsB,CAACK,EAAWL,oBAAoBK,EAAWC,SAAWnpF,EAAAA,KAAK,QAAQ1H,EAAG9C,IAAI;AAC9GkF,YAAIqJ,OAAOtO,GAAE;AACb;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAED,UAAM2zF,IAAe72F,EAAUwoD,kBAAAA,GACzBhlD,IAASxD,EAAUqwD,sBAEzB;AAAA,QAAIymC;AACJ,QAAID,GAAc;AACjB,UAAI3rC,IAAQ;AAEZ,eAAShoD,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC3BiF,UAAIjF,CAAAA,EAAGD,MAAM8C,EAAG9C,MAAMqG,KAAKitF,0BAA0BpuF,EAAIjF,CAAAA,GAAI6C,MAChEmlD;AAGEA,MAAAA,KAASirC,MAEZW,IAAS;AAAA,IAEV;AAEK3uF,QAAIhF,UAAUgzF,MAClBW,IAAAA;AAEF,QAAA,CAAKA,GAAQ;AACZ,UAAI1vF,KAAOpH,EAAUmJ,UAAU,oBAAmB,CAACpD,GAAGoC,CAItD,CAAA;AAAA,aAHKf,MACJrB,EAAGvC,KAAUyyF,KAAclwF,EAAGvC,KAExB4D;AAAAA,IACP;AACD,WAAO0vF;AAAAA,EAER;AAEA,GL3FCC,sBM/Cc,SAAS/2F,GAAAA;AAEvBA,IAAUM,OAAOy2F,uBAAAA,IACjB/2F,EAAUM,OAAO02F,uBAAuB,IACxCh3F,EAAUM,OAAO22F,gBAAgB,IACjCj3F,EAAUM,OAAO42F,eAAe;AAEhC,MAAIC,IAAuBn3F,EAAUo7D,oBAGjCg8B,IAAS,IACTC,IAAe,GACfC,IAAkB;AAEtBt3F,IAAUo7D,qBAAqB,SAASjzD,GAAK+xD,GAC5C;AAAA,QAAA,CAAMl6D,EAAUM,OAAOy2F,wBAAAA,CAAwBK;AAC9C,aAAOD,EAAqBjrF,MAAM5C,MAAM+I,SAGzC;AAAA,QAAIspD,IAAKryD,KAAKyX,GAAG+mB,YACb8zB,IAAQtyD,KAAKi8C,OAAOE,SACpB7jC,IAAItY,KAAKi8C,OAAOE,UAAU,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAC7C71C,GAAAA,IAAOtG,KAAKO,KAAmB,aAAE,CAOrC;AAAA,QAFC1B,IAHImB,KAAKmB,cAGHnB,KAAKuyD,yBAAyB1zD,GAAK+xD,CAFnC5wD,IAAAA,KAAKwyD,wBAAwB3zD,GAAK+xD,IAIrC5wD,KAAKmB;AACR,UAAIyvD;AACH5wD,aAAKi8C,OAAOE,UAAUmW;AAAAA,WAChB;AACN,YAAI27B,IAAM3nF,EAAKK;AACf,cAAM6P,IAAOy3E,EAAIx0F,iBAAiB,oBAAA;AAClC,YAAI+c,KAAQA,EAAK3c,QAAQ;AACxB,mBAASD,IAAI,GAAGA,IAAI4c,EAAK3c,QAAQD,KAAK;AAGrC,gBAFA0e,EAAE1e,CAEG0e,KAAAA,EAAE1e,CAAMy4D,IAAAA,IAAKryD,KAAKi8C,OAAOx2C,SAASzF,KAAKyX,GAAG2hC,mBAAmB;AAEjE,kBAAI7/C,IAAQid,EAAK5c,CAAAA,EAAGH,iBAAiB,qBAAA,GAEjCk5D,IAAU3yD,KAAKi8C,OAAOx2C,SAASzF,KAAKyX,GAAG2hC;AACX,kBAA7Bp5C,KAAKhJ,OAAOi7D,qBAAuBjyD,KAAKhJ,OAAOi7D,oBAAoB35C,EAAE1e,CAAAA,KAAMoG,KAAKhJ,OAAOi7D,mBACzFU,IAAUr6C,EAAE1e,CAAAA,IAAKy4D,KACPryD,KAAKhJ,OAAOi7D,mBAAmB,KAAKI,IAAKryD,KAAKi8C,OAAOx2C,SAASzF,KAAKyX,GAAG2hC,sBAChFuZ,KAAW3yD,KAAKhJ,OAAOi7D,mBAAmB,KAAKI,IAGhD77C,EAAK5c,GAAGjC,MAAM8N,SAAUktD,IAAU3yD,KAAKyX,GAAG2hC,oBAAqB;AAG/D,uBAAS7uB,IAAI,GAAGA,IAAIhxB,EAAMM,QAAQ0wB;AACjChxB,gBAAAA,EAAMgxB,CAAG7jB,EAAAA,WAAW,CAAG/O,EAAAA,MAAM8N,SAASktD,IAAU;AAEjDr6C,cAAAA,EAAE1e,CAAAA,KAAM0e,EAAE1e,IAAI,CAAA,KAAM,KAAKL,EAAM,CAAA,EAAGwgB;AAAAA,YAClC;AAEDzB,YAAAA,EAAE1e,CAAAA,KAAM0e,EAAE1e,IAAI,CAAA,KAAM,KAAK4c,EAAK5c,CAAAA,EAAGH,iBAAiB,qBAAuB,EAAA,CAAA,EAAGsgB;AAAAA,UAC5E;AACDzB,UAAAA,EAAEs6C,QAAQ,IACNq7B,EAAIhsF,WAAW8X,eAAek0E,EAAIhsF,WAAW4wD,gBAAiBo7B,EAAIC;AAAAA,QAK3E,WACUrvF,EAAIhF,UAAUmG,KAAKO,KAAoB,cAAE,CAAG5I,EAAAA,MAAMgmB,cAAc,cACpErF,EAAE,CAAA,IAAA,KACCzZ,EAAIhF,UAAUye,EAAE,CAAU,KAAH,IAAG;AAG7B,cAAI+T,KAAO/T,EAAE,KAAK,KAAK+5C,IAAK;AACzB27B,UAAAA,KAAmB3hE,IAAK,MAC1BrsB,KAAKuuB,KAAK52B,MAAM8N,SAAUsoF,IAAeC,IAAkB3hE,IAAK,IAAK,OAEtEA,KAAM;AACN,gBAAM8hE,IAAYnuF,KAAKO,KAAsB,gBAAE,CAAGwZ,EAAAA,cAC5Cq0E,IAAgBpuF,KAAKO,KAAqB,eAAE,CAAA,EAAGwZ;AACrDzT,UAAAA,EAAK3O,MAAM8N,SAAUzF,KAAKuuB,KAAKxU,eAAeo0E,IAAYC,KAAgBpuF,KAAKyX,GAAGwhC,cAAc,KAAM;AACtG,cAAIzoB,IAAOxwB,KAAKO,KAAoB,cAAE,CACtCiwB;AAAAA,UAAAA,EAAK74B,MAAM8N,SAAS4mB,GACpBmE,EAAK74B,MAAMgmB,aAAcrF,EAAE,CAAW,KAAJ,KAAI,WAAW,WACjDkY,EAAK74B,MAAMkgB,UAAWS,EAAE,CAAW,UAAA,SAAS,KAC5CkY,IAAOxwB,KAAKO,KAAoB,cAAE,IAC7B5I,MAAM8N,SAAS4mB,GACpBmE,EAAK74B,MAAMgmB,aAAcrF,EAAE,CAAA,KAAO,KAAI,WAAW,WACjDkY,EAAK74B,MAAMkgB,UAAWS,EAAE,CAAW,KAAJ,KAAI,SAAS,IAE5CkY,EAAKhrB,YAAY8S,EAAE,KAAK,uBAAuB,4BAC/CtY,KAAKohD,aAAa9oC,EAAE,KAAK,KAAK+5C,GAC9B/5C,EAAE,CAAK,IAAA;AAAA,QACP;AAAA,MAEF;AAGF,WAAOzZ;AAAAA,EACT;AAEC,MAAIwvF,IAAe,CAAC,mBAAmB,kBAAkB,iBAAiB,cACtEC,GAAAA,IAAyB,SAASC,GACrCR;AAAAA,IAAAA,IAAe;AACf,aAASn0F,IAAI,GAAGA,IAAIy0F,EAAax0F,QAAQD,KAAK;AAE7C,UAAI4L,IAAY6oF,EAAaz0F,IACzB40F,IAAe93F,EAAU6J,KAAKiF,CAAc9O,IAAAA,EAAU6J,KAAKiF,CAAAA,EAAW,CAAK,IAAA,MAC3EC,IAAS;AACb,cAAQD;QACP,KAAK;AAAA,QACL,KAAK;AACJC,UAAAA,IAAS+oF,EAAYz0E;AACrB;AAAA,QACD,KAAK;AACJtU,UAAAA,IAAS3I,IAAgB0xF,EAAYz0E,eAAe,IAAI,GACxDi0E,IAAkBvoF;AAClB;AAAA,QACD,KAAK;AACJ,cAAIxK,IAAOvE,EAAU4E,SAAAA,EAAWL;AAEhC,cAAGuzF,EAAY9nF,WAAW,CAAc,KAARzL,KAAQ,SAAS;AAChD,gBAAIwzF,IAAY;AAChB,qBAAQ70F,IAAI,GAAGA,IAAI40F,EAAY9nF,WAAW7M,QAAQD;AAC9C40F,cAAAA,EAAY9nF,WAAW9M,CAAAA,EAAGmgB,eAAe00E,MAC3CA,IAAYD,EAAY9nF,WAAW9M,CAAAA,EAAGmgB;AAGxCtU,YAAAA,IAASgpF;AAAAA,UACT;AAEAhpF,YAAAA,IAASK,KAAKC,IAAIyoF,EAAYz0E,eAAe,GAAGy0E,EAAY37B,YAE7D;AAAA,cAAI53D,KAAQ;AACX,YAAIvE,EAAUM,OAAO02F,wBAAAA,CAAyBa,MAE7C9oF,IADkB+oF,EAAY/0F,iBAAiB,oBAAsBI,EAAAA,SAC9CnD,EAAUM,OAAO02F,uBAErCa,MACHC,EAAY72F,MAAM8N,SAASA,IAAS;AAAA,mBAG7BxK,KAAQ;AAChBwK,YAAAA,IAAS,MAAM/O,EAAUM,OAAO03F;AAAAA,mBAEzBzzF,KAAQ,UAAS;AAGxB,gBAFAwK,IAAS,GAEN+oF,EAAY/4C,YAAY+4C,EAAY/4C,SAAS57C;AAC/C,kBAAG20F,EAAY/4C,SAAS57C,WAAW,KAAK20F,EAAY/4C,SAAS,CAAGlgC,EAAAA,UAAUyC,SAAS,0BAClFvS;AAAAA,gBAAAA,IAAS;AAAA;AAET,yBAAQ8kB,IAAI,GAAGA,IAAIikE,EAAY/4C,SAAS57C,QAAQ0wB;AAC/C9kB,kBAAAA,KAAU+oF,EAAY/4C,SAASlrB,CAAGxQ,EAAAA;AAIlCtU,YAAAA,IAAS,IAAI/O,EAAUM,OAAO22F,gBAChCloF,IAAS/O,EAAUM,OAAO22F,gBAG1BloF,KAAU;AAAA,UAEX,WACQxK,KAAQ,eAAc;AAK9B,qBAHC0zF,GAEGhzC,GAHAia,IAAal/D,EAAU+gB,GAAGm3E,2BAA2Bl4F,EAAUM,OAAO22F,eAIlEtqF,IAAI,GAAGA,IAAImrF,EAAY9nF,WAAW7M,QAAQwJ;AAEjD,mBADAs4C,IAAS6yC,EAAY9nF,WAAWrD,CAChC,GAAQknB,IAAI,GAAGA,IAAIoxB,EAAOj1C,WAAW7M,QAAQ0wB,KAAK;AAIjD,yBAHIhS,IAAc,GACjBs2E,IAAkBlzC,EAAOj1C,WAAW6jB,CAAAA,EAAG7jB,WAAW,CAE3Cg4E,GAAAA,IAAG,GAAGA,IAAImQ,EAAgBnoF,WAAW7M,QAAQ6kF;AACpDnmE,kBAAAA,KAAes2E,EAAgBnoF,WAAWg4E,CAAAA,EAAG3kE;AAG9C40E,gBAAAA,IAAap2E,IAAc7hB,EAAU+gB,GAAGm3E,2BACxCD,IAActrF,KAAK,KAAMknB,KAAK,KAAKA,KAAK,IAAuBokE,IAAJ,IAAbA,KAE7B/4B,MAChBA,IAAa+4B;AAAAA,cAEd;AAGFlpF,YAAAA,IAAsB,IAAbmwD;AAAAA,UACT,WACO36D,KAAQ,OAAO;AACtBwK,YAAAA,IAAS;AACT,gBAAI5G,IAAM2vF,EAAY/0F,iBAAiB,eAAA;AAEvC,iBAAS8wB,IAAI,GAAGA,IAAI1rB,EAAIhF,QAAQ0wB;AAC/B9kB,cAAAA,KAAU5G,EAAI0rB,CAAGxQ,EAAAA;AAGdtU,YAAAA,IAAS,IAAI/O,EAAUM,OAAO42F,eACjCnoF,IAAS/O,EAAUM,OAAO42F,eAG1BnoF,KAAU;AAAA,UAEX,WACO/O,EAAUo4F;AAGjB,gBAFArpF,IAAS,GAEL+oF,EAAY9nF,WAAW,CAAA,EAAGA,WAAW,CAAGA,EAAAA,cAAc8nF,EAAY9nF,WAAW,CAAGA,EAAAA,WAAW,GAAGA,WAAW7M,QAAQ;AAGpH,mBAFIgF,IAAM2vF,EAAY9nF,WAAW,CAAA,EAAGA,WAAW,CAAA,EAAGA,WAAW,CAAA,EAAGA,YAEvD6jB,IAAI,GAAGA,IAAI1rB,EAAIhF,QAAQ0wB;AAC/B9kB,gBAAAA,KAAU5G,EAAI0rB,CAAGxQ,EAAAA;AAAAA,eAGlBtU,KAAU,KAEE/O,EAAUM,OAAO22F,kBAC5BloF,IAAS/O,EAAUM,OAAO22F;AAAAA,YAE3B;AAEAloF,cAAAA,IAAS/O,EAAUM,OAAO22F;AAI5B,cAAIj3F,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CAAO,GAAA;AAC/C,gBAAIszF;AACH9oF,cAAAA,KAAU,GACV+oF,EAAY72F,MAAM8N,SAASA,IAAS;AAAA,iBAC9B;AACNA,cAAAA,IAAS;AAGT,uBAFI1K,IAAMrE,EAAUuG,OAAOhC,CAAAA,GACvBub,IAAOzb,EAAIg0F,QACPtgF,IAAE,GAAGA,IAAI+H,EAAK3c,QAAQ4U;AAC7BhJ,gBAAAA,KAAU1K,EAAIi0F,iBAAiBx4E,EAAK/H,CAAG1E,EAAAA,GAAAA;AAGrCrT,gBAAU8C,WAAW6e,eAAe3hB,EAAU8C,WAAWksF,gBAC3DjgF,KAAUwpF,EAEX;AAAA,YAAA;AACDxpF,YAAAA,KAAU;AAAA,UACV;AAAA,WACGxK,KAAQ,SAASA,KAAQ,UAAWvE,EAAUsG,UAAUtG,EAAUsG,OAAO/B,CAAAA,OAC5EwK,KAAU;AAAA,MAAA;AAKbsoF,MAAAA,KADAtoF,KAAU;AAAA,IAEV;AACD/O,MAAU63B,KAAK52B,MAAM8N,SAAS9J,IAAiB,MAE1C4yF,KACJ73F,EAAU8V,WAAAA;AAAAA,EACb;AAEC,WAAS0iF;AACRpB,IAAAA,IAAS,IACTp3F,EAAUmJ,UAAU,0BAA0B,KAC9CiuF,IAAS;AAAA,EACT;AAED,MAAIqB,IAAmC,WAAA;AACtC,SAAKz4F,EAAUM,OAAOy2F,yBAAwBK;AAC7C,aAAA;AAED,QAAI7yF,IAAOvE,EAAU4E,SAAAA,EAAWL;AAEhC,QAAA,CAAIA;AACH,aAAO;AAGR,QAAIm0F,IAAe74F,OAAO84F,yBAAyB94F,OAAOoY,YACtDwR,IAAY7b,SAAS8T,gBAAgB+H;AAEzCivE,IAAAA,EAAa,WACT14F;AAAAA,OAAAA,EAAUkiB,cAAeliB,EAAUuiB,gBAGtCq1E;IACH,CAEQ53F,GAAAA,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CAAAA,KAAUA,KAAQ,UAC5Dm0F,EAAa;OACT14F,EAAUkiB,cAAeliB,EAAUuiB,iBAGtCq1E,EAAAA,EACAhqF,GAAAA,SAAS8T,gBAAgB+H,YAAYA,GACrC+uE,EACA;AAAA,IAAA,GAAE,KAEHA,EAEH;AAAA,EAAA;AA8CC,WAASD,IACR;AAAA,QAAIltF,IAAMuC,SAASC,cAAc,KAAA;AACjCxC,IAAAA,EAAIpK,MAAMgzC,UAAU,wIAEpBrmC,SAASmJ,KAAKhJ,YAAY1C,CAC1B;AAAA,QAAIP,IAAOO,EAAIkY,cAAclY,EAAIsW;AAEjC,WADA/T,SAASmJ,KAAKvL,YAAYH,CAAAA,GACnBP;AAAAA,EACP;AApDD9K,IAAUsE,YAAY,sBAAsB,WAC3C;AAAA,QAAIs0F,IAAkB54F,EAAUM,OAAOy2F;AAOvC,QANI/2F,EAAU+gB,GAAG83E,2BAChB74F,EAAU+gB,GAAG83E,yBAAyB74F,EAAU+gB,GAAGshB,eAGpDriC,EAAU+gB,GAAGshB,eAAeu2D,IAAkB,IAAI54F,EAAU+gB,GAAG83E,wBAE5D74F,EAAUuG;AACZ,eAAQrD,KAAKlD,EAAUuG,QAAO;AAC7B,YAAI29B,IAAWlkC,EAAUuG,OAAOrD,CAAAA;AAC5BghC,QAAAA,EAAS40D,iCACZ50D,EAAS40D,+BAA+B50D,EAAS60D,qBAGjD70D,EAAS60D,sBADPH,KAG4B10D,EAAS40D;AAAAA,MAExC;AAEF,WAAA;AAAA,EACF,CAAA,GAEC94F,EAAUsE,YAAY,gBAAgBm0F,CACtCz4F,GAAAA,EAAUsE,YAAY,SAASm0F,CAAAA,GAC/Bz4F,EAAUsE,YAAY,kBAAkBm0F,CACxCz4F,GAAAA,EAAUsE,YAAY,kBAAkBm0F,IACxCz4F,EAAUsE,YAAY,gBAAgBm0F,CACtCz4F,GAAAA,EAAUsE,YAAY,kBAAkBm0F,CAAAA,GACxCz4F,EAAUsE,YAAY,0BAA0Bm0F,IAChDz4F,EAAUsE,YAAY,cAAcm0F,CAGpCz4F,GAAAA,EAAUsE,YAAY,kBAAkB,WAAA;AAEvC,WADA8yF,IAAAA,IACO;AAAA,EACT,IAECp3F,EAAUsE,YAAY,oBAAoB,WAEzC;AAAA,WADA8yF,QACO;AAAA,EACT,CAaA;AAAA,GNjTC4B,QOhDc,SAASh5F;AAoBvB,WAASi5F,EAAcj5F;AACtB,YAAQA,EAAU63B,KAAK50B,MAAM,eAAe;AAAA,EAC5C;AAED,MAAI82B,IAAAA;AACJ/5B,IAAUsE,YAAY,sBAAqB,SAAS4/D,GAAQD,GAAQ1/D,GAAKvC,GAAAA;AAExE,QAAI+3B,KAAS/5B,EAAUk5F,cAAa;AACnC,UAAIC,IAAsBn5F,EAAUk5F,aACjCC;AAAAA,OAAAA,EAAoBn3F,QAAQm3F,EAAoB50F,QAAQ40F,EAAoB/4F,WAC9E25B,IAAQ;AAAA,IAET;AAED,QAAIi/D,IAASC,EAAcj5F,CAE3B;AAAA,QAAI+5B,GAAM;AACTA,MAAAA,IAAAA;AACA,UAAIq/D,IAjCN,SAAmB7gF;AAClB,YAAIoU,IAASpU,IAAO;AACpB,YAAI3K,SAASorF,OAAO71F,SAAS,GAAG;AAC/B,cAAIoO,IAAS3D,SAASorF,OAAO7oF,QAAQwc;AACrC,cAAIpb,KAAW,IAAG;AACjBA,YAAAA,KAAUob,EAAOxpB;AACjB,gBAAI+J,IAAMU,SAASorF,OAAO7oF,QAAQ,KAAKoB,CAAAA;AAGvC,mBAFIrE,YACHA,IAAMU,SAASorF,OAAO71F,SAChByK,SAASorF,OAAO10C,UAAU/yC,GAAQrE,CACzC;AAAA,UAAA;AAAA,QACD;AACD,eAAO;AAAA,MACP,EAoBiC8rF,CAChC;AAAA,UAAII,GAAgB;AAEfp5F,UAAUkK,cAGblK,EAAUkK,YAAYlI,KAGvBo3F,IAAkBC,SAASD,CAAiBz1F,EAAAA,MAAM,GAClC,GAAA,CAAA,IAAK2F,KAAKstB,SAASC,UAAUuiE,EAAgB,CAC7D,CAAA;AAAA,YAAI1yF,IAAO4C,KAAKwgD,aAAasvC,EAAgB,CAAA,CAAA,IAAMA,EAAgB,CAAA,IAAK70F;AACvEvC,eAAAA,IAAQslB,MAAAA,CAAO8xE,EAAgB,CAA2Bp3F,CAAAA,IAAAA,IAArBo3F,EAAgB,CAQtD,GANAv5F,OAAOoY,WAAW,WACdjY;AAAAA,YAAUkiB,cAGbliB,EAAU6V,eAAe7T,GAAK0E,CAC9B;AAAA,QAAA,GAAC;MAEF;AAAA,IACD;AACD,WAAA;AAAA,EACF,CAAA,GAEC1G,EAAUsE,YAAY,gBAAgB,SAAUg1F,GAAUt8C,GAAAA;AACzD,QAhEuBu8C,GACnBtzE,GA+DA+yE,IAASC,EAAcj5F,CACvBwc,GAAAA,IAAO2yB,OAAO7lC,KAAKstB,SAASsf,WAAW8G,CAAS,IAAA;AAhEhD/2B,IAAAA,IAiEM+yE,IAjEO,MAiEwCx8E,MAlElC+8E,IAkEN,2CAjE8B,OAAKA,IAAc,KAClE3rF,SAASorF,SAAS/yE;AAAAA,EAiEpB,CAGC;AAAA,MAAIuzE,IAAWx5F,EAAU4xB;AACzB5xB,IAAU4xB,QAAQ,WACjB;AAAA,QAAI9Y,IAAOzG;AAEX,QAAKrS,EAAUoT;AAMdomF,MAAAA,EAASttF,MAAM5C,MAAMwP,CANA;AAAA,SAAA;AACrB,UAAI46B,IAAOpqC;AACXzJ,aAAOoY,WAAW,WAAA;AACjBuhF,QAAAA,EAASttF,MAAMwnC,GAAM56B,CACrB;AAAA,MAAA,GAAC,CACL;AAAA,IAAA;AAAA,EAGA;AACA,GPnCCgtD,aQ9Cc,SAAS9lE,GACvBy5F;AAAAA,EAAAA,GAAuBz5F;AACvB,MAAI05F,IAAe15F,EAAUihD;AAE7BjhD,IAAUihD,qBAAqB,SAAU3gD,GACxC;AAAA,QAAGA,EAAOsV,UAAU,QAApB;AAKA,UAAI2C,IAAOjY,EAAOiY,MAEd9R,IAAWnG,EAAOiD,aAAa,kBAAkBgV;AACrDjY,MAAAA,EAAO+3F,SAAS,CAAA,GAChB/3F,EAAOsV,SAAS,OAChBtV,EAAOoF,OAAOpF,EAAOoF,QAAQ,GAE7Bg0F,EAAanlF,KAAKjL,MAAMhJ,CAExBN,GAAAA,EAAUya,UAAUlC,IAAO,eAAA,IAAmB,WAAU;AAAA,MAAA,GACxDvY,EAAUya,UAAUlC,IAAO,eAAmB,IAAA,WAAA;AAAA,MAAU,GACxDvY,EAAUya,UAAUlC,IAAK,cAAkB,IAAA,SAASohF,GAAYC,GAAeC,GAC9E;AAAA,eAAO75F,EAAUya,UAAU+rB,SAASozD;MACvC,GAEE55F,EAAUgC,KAAKuW,IAAO,QAAA,IAAY,SAAUvW,GAAAA;AAG3C,eAFAA,IAAOhC,EAAUgC,KAAKY,WAAWZ,IACjCA,IAAOhC,EAAUgC,KAAKC,IAAID,GAAM1B,EAAOwlD,SAAOxlD,EAAOw5F,SAASx5F,EAAOylD,MAExE;AAAA,MAAA,GACE/lD,EAAUgC,KAAK,SAASuW,KAAQ,SAAUvW,GAAMmtB,GAC/C;AAAA,eAAOnvB,EAAUgC,KAAKC,IAAID,GAAMmtB,IAAI7uB,EAAOoF,MAAM,KAAA;AAAA,MACpD;AAoBE,UAAIq0F,IAAe/5F,EAAUg6F;AAC7Bh6F,QAAUg6F,gBAAgB,SAASz1F,GAAM01F,GAAAA;AACrC11F,QAAAA,KApBJ,WACC;AAAA,cAAIvC,IAAO,IAAIQ,KAAKxC,EAAU4E,SAAAA,EAAW5C,IACrCw/B,GAAAA,IAAKxhC,EAAUgC,KAAKuW,IAAO,UAAUvW,CAEzCw/B;AAAAA,UAAAA,IAAKxhC,EAAUgC,KAAKwF,UAAUg6B,CAE9B;AAAA,cAAI1c,IAAO,CAAA,GACPpiB,IAAM1C,EAAUuG,OAAOgS;AAC3B7V,UAAAA,EAAI21F,SAASvzE,GACbpiB,EAAIuM,QAAQ;AAEZ,mBAAS/L,IAAI,GAAGA,IAAI5C,EAAOoF,MAAMxC;AAChC4hB,YAAAA,EAAKniB,KAAK,EAAE0Q,MAAMmuB,GAAIxN,OAAOwN,MAE7B9+B,EAAIuM,MAAMvM,EAAI21F,OAAOn1F,CAAAA,EAAGmQ,OAAOnQ,GAC/Bs+B,IAAKxhC,EAAUgC,KAAKC,IAAIu/B,GAAI,GAAG,KAEhC;AAAA,QAAA,KAMAu4D,EAAa7tF,MAAM5C,MAAM+I,SAC5B;AAAA,MAAA;AAUE,UAAI6nF,IAAel6F,EAAUo2F;AAC7Bp2F,QAAUo2F,iBAAiB,SAAUrwF;AAChCA,eAAAA,EAAGU,CAAAA,KAAAA,QACFV,IAVN,SAAqBA,GAAAA;AACpB,cAAIqB,IAAM,CAAA;AACV,mBAASlE,KAAK6C;AACbqB,YAAAA,EAAIlE,CAAAA,IAAK6C,EAAG7C,CACb;AAAA,iBAAOkE;AAAAA,QACP,EAKsBrB,CAAAA,GACXU,IAEJyzF,EAAahuF,MAAMlM,GAAW,CAAC+F;MACzC,GAGE/F,EAAUsE,YAAY,gBAAgB,SAAUrB,GAAIkgC,GAAW3+B,GAC9D;AAAA,YAAImiB,IAAMniB,EAAEE,UAAUF,EAAEoiB,YACpB9X,IAAY9O,EAAUkQ,cAAcyW,CACxC;AAAA,YAAIwc,KAAa;AACZr0B,UAAAA,EAAUqB,QAAQ,sBAA0B,IAAA,IAC/CnQ,EAAUm6F,0BAA0B,KAEpCn6F,EAAUm6F,0BAAAA;AAAAA,iBAEHh3D,KAAa,UACjBr0B,EAAUqB,QAAQ,cAAmB,KAAA;AACxC;AAIF,eAAA;AAAA,MACH,CAAA;AACE,UAAIiqF,IAAYp6F,EAAU,WAAWuY,CAAAA;AACrCvY,QAAU,WAAWuY,CAAAA,IAAQ,SAAU4sC,GACtC;AAAA,YAAIk1C;AACA/wF,aAAKs7C,gBACRy1C,IAAa/wF,KAAKs7C,YAAY01C;AAE/B,YAAI53F,IAAM1C,EAAUuG,OAAO+C,KAAKoB,KAAAA;AAQhC,YANIhI,EAAIwjC,cAAgBif,CAAAA,EAAIo1C,cAC3Bp1C,EAAIo1C,YAAW,GACfp1C,EAAI75B,KAAAA,CAAO5oB,EAAI83F,WACfr1C,EAAI95B,KAAK3oB,EAAI+3F,YAGXJ,MAAejzD,UAAapnC,EAAU+I,cAAc,QAAO;AAE7D,cAAI2xF,IAAW,EAACrvE,GAAI85B,EAAI95B,EAAAA;AACxBrrB,YAAU26F,0BAA0Bj4F,GAAKg4F,CACzC;AAAA,cAAIpvE,IAAI65B,EAAI75B,IAAI5oB,EAAIyjC,IAEhB3kC,IAAW,IAAIgB,KAAKk4F,EAAS11F,OAAAA;AACjC41F,UAAAA,EAAc56F,EAAU66F,oBAAoBn4F,GAAK4oB,CAAI9pB,GAAAA,CAAAA;AACrD,cAAIs5F,IAAa96F,EAAU4kD,aAEvB7+C,IAAKuD,KAAK7E,SAAS6E,KAAKR,QACzB/C;AAAAA,UAAAA,MACF+0F,EAAWR,eAAev0F,EAAGxE,aAAWC,KAAU,KAC9C8H,KAAKhJ,OAAOqlD,mBAAmBR,EAAIv2C,aACtCksF,EAAWR,cAAchxF,KAAKu8C,uBAAuB9/C,EAAGxE,YAAWC,GAAUkB,CAAAA,GAC7Eo4F,EAAWl1C,gBAAgBt8C,KAAKu8C,uBAAuB9/C,EAAGxE,YAAWwE,EAAGvE,UAAUkB,CAAAA;AAAAA,QAGpF;AAGD,YADIyiD,IAAMi1C,EAAUluF,MAAMlM,GAAWqS,SACrC,GAAIrS,EAAU+I,cAAc/I,EAAU+I,cAAc,QAAQ;AAE3D,cAAIgyF,IAAM;AAETA,UAAAA,IADG/6F,EAAU4kD,eAAe5kD,EAAU4kD,YAAY,kBAAkBrsC,CAAAA,IAC9D,IAAI/V,KAAKxC,EAAU4kD,YAAY,kBAAkBrsC,CAAAA,CAAAA,IAEjD,IAAI/V,KAAK2iD,EAAIngD,OAAAA,GAGpBmgD,EAAI95B,KAAKjc,KAAKM,OAAOqrF,IAAM/6F,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKxC,EAAUkK,SAAgB,CAAA,MAAA,MAAYZ,KAAKhJ,OAAOq6B,UAAAA,GAE3G36B,EAAU+I,cAAc,aAE3Bo8C,EAAIwC,oBAAoB3nD,EAAUm6F;AAAAA,QAGvC,WACQn6F,EAAU4kD,aAAa;AAC1B,cAAIo2C,IAAS5rF,KAAK+D,MAAM/D,KAAKu1B,IAAIwgB,EAAI95B,KAAK,OAAUrrB,EAAUM,OAAOq6B;AACrEqgE,UAAAA,KAAU71C,EAAI95B,IAAI,IAAI,IAAA,IACtB85B,EAAI95B,IAAI85B,EAAI95B,KAAK,OAAUrrB,EAAUM,OAAOq6B;AAC5C,cAAIsgE,IAAUj7F,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKxC,EAAUkK,SAAAA,CAAAA;AACtD+wF,UAAAA,EAAQx4F,QAAAA,KAAa,IAAID,KAAK2iD,EAAIngD,SAASvC,QAC9C0iD,MAAAA,EAAI75B,IAAIlc,KAAK+D,OAAOgyC,EAAIngD,UAAUi2F,aAClC91C,EAAI75B,KAAK0vE;AAAAA,QAEV;AAEF,eAAO71C;AAAAA,MACV,GAEEnlD,EAAUsE,YAAY,kBAAkB,SAAUrB,GAAIuB,GAAAA;AAIrD,eAHIxE,EAAU0W,QAAQzT,aACdjD,EAAU0W,QAAQzT,GAAIwD,CAEvB,GAAA;AAAA,MACV,CACEzG,GAAAA,EAAUsE,YAAY,wBAAwB,SAAUyB,GAAIvB,GAAG02F,GAAMC,GAIpE;AAAA,eAHIn7F,EAAU0W,QAAQ3Q,EAAG9C,EACjBjD,KAAAA,OAAAA,EAAU0W,QAAQ3Q,EAAG9C,IAAIwD,CAE1B,GAAA;AAAA,MACV;AAEE,UAAI20F,IAA2Bp7F,EAAUq7F;AACzCr7F,QAAUq7F,2BAA2B,SAASjjF,GAC7C;AAAA,YAAIhY,GAAOk7F;AACPhyF,aAAKoB,SAAS6N,MACjBnY,IAAQgY,EAAOhY,WAEdk7F,IAAWt7F,EAAUqnE,kBAAkBjnE,EAAM6C,IAAIjD,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKpC,EAAMmB,WAAWkB,QAEnG2V,CAAAA,CAAAA,CAAAA,OAAAA,EAAOhY,MAAMkkC,UAAUg3D,EAASh3D,SAChClsB,EAAOhY,MAAMmkC,SAAS+2D,EAAS/2D,SAIlC62D,EAAyBlvF,MAAM5C,MAAM+I,SAAAA,GAClCjS,KAASk7F,MACXA,EAAS/2D,SAASnkC,EAAMmkC,QACxB+2D,EAASh3D,UAAUlkC,EAAMkkC;AAAAA,MAE7B;AAEE,UAAIi3D,IAAYv7F,EAAUgW;AAC1BhW,QAAUgW,mBAAmB,SAAU7N,GAAK+xD;AAO3C,eANI5wD,KAAKoB,SAAS6N,KACbpQ,MACHA,IAAMqzF,EAAgBrzF,CACtBnI,GAAAA,EAAU4nE,sBAAsBz/D,CAG3BozF,IAAAA,EAAUrvF,MAAMlM,GAAW,CAACmI,GAAK+xD,CAC3C,CAAA;AAAA,MAAA;AACE,UAAIuhC,IAAcz7F,EAAU85D;AAC5B95D,QAAU85D,qBAAqB,WAAA;AAC9B,YAAIxwD,KAAKoB,SAAS6N,GAAM;AACvBjP,eAAKq+D,qBACL3nE,GAAAA,EAAUiK,YAAYjK,EAAUgC,KAAKwF,UAAUxH,EAAUgC,KAAKC,IAAIjC,EAAUkK,WAAW5J,EAAOoF,MAAM,KACpG,CAAA;AAAA,cAAIyC,IAAMszF,EAAYvvF,MAAMlM,GAAWqS,SAAAA;AAIvC,iBAFAlK,IAAMqzF,EAAgBrzF,IACtBnI,EAAUmnE,uBAAuBh/D,CAC1BA,GAAAA;AAAAA,QACP;AACD,eAAOszF,EAAYvvF,MAAMlM,GAAWqS;MACvC;AAEE,UAAIqpF,IAAoB17F,EAAU6T;AAClC7T,QAAU6T,cAAc,SAAUzT,GAAAA;AACjC,YAAIJ,EAAU4E,SAAAA,EAAWL,QAAQgU;AAChC,cAAInY,EAAMqG,CAAW,GAAA;AACpB,gBAAIs0F,IAAM,IAAIv4F,KAAKpC,EAAMqG,CAAAA,CAAAA;AACzBk1F,YAAAA,EAAcZ,GAAK36F,EAAMmB,aACzBo6F,EAAcZ,GAAK36F,EAAMoB,QAAAA;AAAAA,UAE9B,OAAW;AACN,gBAAIQ,IAAO,IAAIQ,KAAKpC,EAAMmB,UAAAA;AAC1BnB,YAAAA,EAAMqG,CAAazG,IAAAA,CAAAA,EAAUgC,KAAKwF,UAAUxF,CAC5C;AAAA,UAAA;AAIF,eAAO05F,EAAkBxvF,MAAMlM,GAAWqS,SAC7C;AAAA,MAAA;AA4GE,UAAIupF,IAA6B57F,EAAUmL;AAC3CnL,QAAUmL,0BAA0B,WAAA;AACnC,YAAInL,EAAU0K,SAAS6N;AAGvB,iBAAOqjF,EAA2B1vF,MAAM5C,MAAM+I,SAAAA;AAAAA,MACjD;AAAA,IApVG;AAFAqnF,MAAAA,EAAaxtF,MAAM5C,MAAM+I,SAsO1B;AAAA,aAASspF,EAAcr+E,GAAQ5Y,GAAAA;AAE9BA,MAAAA,EAAOoqB,QAAQ,CAAA,GAEfpqB,EAAOu4C,YAAY3/B,EAAOJ,YAAAA,CAAAA,GAC1BxY,EAAOsqB,SAAS1R,EAAOH,aACvBzY,EAAOoqB,QAAQxR,EAAOzV,QACtB,CAAA;AAAA,IAAA;AAED,aAAS2zF,EAAgBrzF,GAExB;AAAA,eADIf,IAAM,CAAA,GACDlE,IAAG,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACnC,YAAI6C,IAAK81F,EAAoB1zF,EAAIjF,CACjC,CAAA;AAAA,YAAIlD,EAAU4I,cAAc7C,CAAAA;AAkB3B+1F,UAAAA,EAAkB/1F,CAClBqB,GAAAA,EAAIzE,KAAKoD,CAnBsB;AAAA,aAAA;AAM/B,mBAJIgsB,IAAK,IAAIvvB,KAAK4M,KAAKE,KAAKvJ,EAAGvE,UAAAA,CAAWxB,EAAUiK,SAAAA,CAAAA,GACnD4nB,IAAO,IAAIrvB,KAAK4M,KAAKC,IAAAA,CAAKtJ,EAAGxE,YAAavB,CAAAA,EAAUkK,aAEjD6xF,IAAkB,CAAA,GAAA,CACflqE,IAAQE,CAAAA,KAAG;AACjB,gBAAIiqE,IAAQH,EAAoB91F,CAAAA;AAChCi2F,YAAAA,EAAMz6F,aAAaswB,GACnBmqE,EAAMx6F,WAAW,IAAIgB,KAAK4M,KAAKE,IAAK2sF,CAAAA,EAAaD,EAAMz6F,UAAcwwB,GAAAA,CAAAA,CAAAA,CAAAA,GACrEF,IAAOoqE,EAAapqE,CAAAA,GACpBiqE,EAAkBE,CAClB50F,GAAAA,EAAIzE,KAAKq5F,CAAAA,GACTD,EAAgBp5F,KAAKq5F;UACrB;AAEDE,UAAAA,EAAmBH,GAAiBh2F,CACzC;AAAA,QAAA;AAAA,MAMI;AACD,aAAOqB;AAAAA,IACP;AAED,aAAS80F,EAAmBC,GAAQlgE;AAGnC,eAFIlC,QACAD,IAAAA,IACI52B,IAAI,GAAG6M,IAAMosF,EAAOh5F,QAAQD,IAAI6M,GAAK7M,KAAI;AAChD,YAAI84F,IAAQG,EAAOj5F;AACnB62B,QAAAA,IAASiiE,CAAAA,EAAMI,iBAAkBngE,CAAAA,EAAS16B,YAC1Cu4B,IAAAA,CAASkiE,EAAMK,eAAgBpgE,CAAAA,EAASz6B,UAExCw6F,EAAMM,mBAAmBN,EAAMO,iBAAiB,IAE7CxiE,MACFiiE,EAAMM,mBAAmB,KAEvBxiE,MACFkiE,EAAMO,iBAAAA;AAAAA,MACP;AAAA,IACD;AAED,aAASV,EAAoB91F,GAAAA;AAC5B,UAAIy2F,IAAMx8F,EAAUyE,SAASsB,EAAGkV,SAUhC;AAAA,aATIuhF,KAAOA,EAAI1H,cAAc/uF,cAC5BA,IAAK/F,EAAU49D,YAAY73D,CAAAA,GACjBgjE,cACHhjE,OAAAA,EAAGkV,kBACHlV,EAAGouC,aAAAA,OACHpuC,EAAGqC,YAEVrC,IAAK/F,EAAUiM,YAAYlG,CAAAA,GAErBA;AAAAA,IACP;AACD,aAAS+1F,EAAkB/1F;AAC1B,UAAIA,CAAAA,EAAGq2F,kBAAiBr2F,EAAGs2F,aAA3B;AAGA,YAAIr6F,IAAOhC,EAAUgC,MACpBiL,IAAQlH,EAAGq2F,gBAAgB,IAAI55F,KAAKuD,EAAGxE,UACvC2L,GAAAA,IAAMnH,EAAGs2F,cAAc,IAAI75F,KAAKuD,EAAGvE,QACpCuE;AAAAA,QAAAA,EAAGU,MAAazE,EAAKwF,UAAUzB,EAAGxE,UAE7BwE,GAAAA,EAAGw+B,WACPx+B,EAAGw+B,SAAS,IACRx+B,EAAGu+B,YACPv+B,EAAGu+B,UAAU;AAEd,YAAI5nB,IAAWxP,IAAMD;AACrBlH,QAAAA,EAAGxE,aAAa,IAAIiB,KAAKxC,EAAUkK,SACnC0wF,GAAAA,EAAc3tF,GAAOlH,EAAGxE,UAAAA,GACxBwE,EAAGvE,WAAW,IAAIgB,MAAMuD,EAAGxE,aAAamb,IAGrCzP,EAAMyhB,kBAAAA,KAAuBxhB,EAAIwhB,kBACnC3oB,MAAAA,EAAGvE,WAAW,IAAIgB,KAAKuD,EAAGvE,SAASiB,QAAAA,IAAgE,OAAnDwK,EAAMyhB,kBAAsBxhB,IAAAA,EAAIwhB;MAlBhF;AAAA,IAoBD;AAED,aAASksE,EAAct9E,GAAQ5Y;AAC9BA,MAAAA,EAAOuE,WAAWqU,EAAO7R,WAAAA,CAAAA,GACzB/G,EAAOsE,SAASsU,EAAOnT,SACvB,CAAA;AAAA,IAAA;AACD,aAAS8xF,EAAaj6F,GAAAA;AACrB,UAAI0zF,IAAW11F,EAAUgC,KAAKC,IAAID,GAAM,GAAG;AAE3C,aADA0zF,IAAW11F,EAAUgC,KAAKwF,UAAUkuF;IAEpC;AAAA,EASH;AAEA,GRhTC+G,cxC+Mc,SAASz8F,GAAAA;AACpBH,SAAO8jE,aAAa9jE,OAAO8jE,UAAUsC,WACvCpmE,OAAO8jE,UAAU+4B,cAAc30B,KAGhC8B,GAAoBlnE,KAAK3C,CACrB4pE,GAAAA,MACHE,GAAiB9pE,CAGlBA,GAAAA,EAAUM,OAAO+oE,UAAU,IAC3BrpE,EAAUM,OAAO2oE,WAAAA,IACjBjpE,EAAUya,UAAUguD,gBAAgB,SAASx7D,GAAOC,GAAK9M;;AACzD,MAAI6jC,IAAM8jC;AACV/nE,IAAUsE,YAAY,oBAAoB,WACzCtE;AAAAA,MAAUI,MAAMJ,EAAU63B,MAAM,aAAa,SAASrzB,GAAAA;AACrDy/B,MAAAA,EAAI8lC,mBAAmB/pE;AAAAA,IAC1B,CACEA,GAAAA,EAAUI,MAAMJ,EAAU63B,MAAM,WAAW,SAASrzB;AACnDy/B,MAAAA,EAAI8lC,mBAAmB/pE;AAAAA,IAC1B,CACA;AAAA,EAAA,CAAA;AACA,GwCpOC28F,SSnDc,SAAS38F,GAAAA;AAExBA,IAAUu4B,YAAmB,QAAE,EAC9B3iB,QAAO,SAASwjB;AACVA,IAAAA,EAAIwjE,mBACRxjE,EAAIwjE,iBAAiB;AAEtB,UAAMC,IAAgBzjE,EAAIrqB,SAAS,iBAAiBqqB,EAAIrqB,eAAe;AACvE,QAAI3H,IAAM;AAEV,WADAA,KAAO,eAAegyB,EAAIvzB,IAAAA,KAASg3F;EAEnC,GACDnkE,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAAAA;AAAAA,KAChC,WACCw8F;AAAAA,MAAAA,EAAAA;AACA,UAAI75F,IAAKjD,EAAUsE,YAAY,mBAAkB,WAAA;AAEhDw4F,QAAAA,KACA98F,EAAU6kB,YAAY5hB,CAC1B;AAAA,MAAA,CAAA;AACG,eAAS65F,IAAAA;AACR,YAAGx2E,EAAKy2E,UAAUz2E,EAAKy2E,OAAOC,WAAW;AACxC,cAAIC,IAAQ32E,EAAKy2E;AACdE,UAAAA,EAAMC,SACRD,EAAMC,OACED,IAAAA,EAAMtnD,cACdsnD,EAAMtnD,WAAAA,GAGPsnD,EAAMD,YAAYC,EAAME,UAAU;AAAA,QAClC;AAAA,MACD;AAAA,IACD,GACDt9F,GAAAA,OAAOu9F,oBAAoB98F,EAAO+8F,cAAY,KAC9C/2E,EAAKy2E,SAAS,IAAIO,YAAYh3E,GAAMhmB,EAAOiY,MAAM+N,EAAK/C,cAAY,CAC9DjjB,GAAAA,EAAOo5B,YACVpT,EAAKy2E,OAAOz4F,YAAY,YAAYhE,EAAOo5B,QAAAA,GAExCp5B,EAAOi9F,kBACVj3E,EAAKy2E,OAAOS,gBAAgBl9F,EAAOi9F;AACpC,QAAIN,IAAQ32E,EAAKy2E;AAGjB,QAFAE,EAAMQ,oBAAoBn9F,EAAOo9F,WAAWp9F,EAAOq9F,eAAa,MAAA,CAAA,CAAQr9F,EAAO2uD,KAE1E3uD,GAAAA,EAAOq9F,aAgBL;AACN,UAAIC,IAAc73F,EAAGzF,EAAOkD,MAAAA;AACxBo6F,MAAAA,IACCt9F,EAAOs8F,eAAegB,MACzBX,EAAMY,UAAUD,GAAat9F,EAAOs8F,eAAegB,CAAAA,CAAAA,GACnDX,EAAMa,QAAQ,CAAA,GACdb,EAAMc,aAAa,CAAA,GACnBd,EAAMa,QAAQ,CAAA,KAEd99F,EAAUsyB,KAAKC,IAAIjyB,EAAOq9F,cAAY,SAAOC,IAAY,UAAQ59F,EAAUqM,IAAAA,GAAO,SAASgM,GAC1F;AAAA,YACI2b,GADAf,IAAe5a,EAAO2a,OAAOC;AAEjC,YAECe;AAAAA,UAAAA,IADU7b,KAAKhB,MAAM8b,CAAAA,EACTrtB,QAAQ,CAAG4W,EAAAA;AAAAA,QACvB,QAEAwX;AAAAA,UAAAA,IADah0B,EAAUsyB,KAAKmB,MAAM,YAAYpb,EAAO2a,MAAAA,EAAQ,GAC9ChjB,WAAW,CAAA,EAAGkkB;AAAAA,QAC7B;AACD5zB,QAAAA,EAAOs8F,eAAegB,KAAe5pE,GACrCipE,EAAMY,UAAUD,GAAa5pE,CAAAA,GAC7BipE,EAAMa,QAAQ,CAAA,GACdb,EAAMc,aAAa,CACnBd,GAAAA,EAAMa,QAAQ,CACpB;AAAA,MAAA,CAAA,IAGIb,EAAMe,cAAc,EAAA;AAAA,IAErB,OA7CwB;AAExB,eADIC,IAAc,CACT/6F,GAAAA,IAAI,GAAGA,IAAI5C,EAAOsF,QAAQzC,QAAQD,KAAK;AAC/C,YAAI0xB,IAASt0B,EAAOsF,QAAQ1C,CACxBg7F,GAAAA,IAAgB,CACnBtpE,EAAOvhB,KACPuhB,EAAOZ,OACPY,EAAOnzB;AAERw8F,QAAAA,EAAYt7F,KAAKu7F,CACjB;AAAA,MAAA;AAED,UADAjB,EAAMY,UAAUI,CACZl4F,GAAAA,EAAGzF,EAAOkD,MAAS,GAAA;AACtB,YAAI5B,IAAQq7F,EAAMkB,gBAAgBp4F,EAAGzF,EAAOkD,MAAAA,CAAAA;AAC5Cy5F,QAAAA,EAAMc,aAAan8F,CAAAA;AAAAA,MACnB;AAAA,IACJ;AAAA,EA8BE,GACD42B,WAAU,SAASlS,GAAKvgB,GAAGzF,GAAAA;AAC1B,QAAIs9F,IAAct3E,EAAKy2E,OAAOqB,iBAAAA;AAI9B,WAHI99F,EAAOq9F,gBACVr9F,EAAOs8F,eAAegB,CAAAA,IAAet3E,EAAKy2E,OAAOsB,gBAE3CT,IAAAA;AAAAA,EACP,GACDvkE,OAAM,SAAS/S;EACd,EAGFtmB,GAAAA,EAAUu4B,YAAmB,QAAE,EAC9B3iB,QAAO,SAASwjB,GAAAA;AACf,QAAIhyB,IAAM;AACVA,IAAAA,KAAO,2CAA2CgyB,EAAIklE,WAAW,2BAA0B,EAAA,mBAAqBllE,EAAIrqB,MAAAA;AACpH,aAAS7L,IAAE,GAAGA,IAAEk2B,EAAIxzB,QAAQzC,QAAQD,KAAK;AACxC,UAAID,IAAKjD,EAAUqM,IACnBjF;AAAAA,MAAAA,KAAO,4CAA0CnE,IAAG,kBAAgBA,IAAG,0BAAwBm2B,EAAI7gB,OAAK,cAAY6gB,EAAIxzB,QAAQ1C,CAAAA,EAAGmQ,MAA5H,cAA+I+lB,EAAIxzB,QAAQ1C,CAAAA,EAAG8wB,QAAM;AAAA,IAC3K;AAGD,WAFA5sB,KAAO;AAAA,EAGP,GACDsxB,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAAAA;AAEhC,aADIi+F,IAAej4E,EAAKwS,qBAAqB,OAAA,GACpC51B,IAAI,GAAGA,IAAIq7F,EAAap7F,QAAQD,KAAK;AAC7Cq7F,MAAAA,EAAar7F,CAAGm4B,EAAAA,UAAAA;AAChB,UAAImjE,IAAgBz4F,EAAGzF,EAAOkD,MAASgV,KAAAA;AACnC+lF,MAAAA,EAAar7F,CAAGsV,EAAAA,SAASgmF,MAC5BD,EAAar7F,CAAAA,EAAGm4B;IAEjB;AAAA,EACD,GACD7C,WAAU,SAASlS,GAAKvgB,GAAGzF,GAE1B;AAAA,aADIi+F,IAAej4E,EAAKwS,qBAAqB,OACrC51B,GAAAA,IAAE,GAAGA,IAAEq7F,EAAap7F,QAAQD;AACnC,UAAGq7F,EAAar7F,CAAGm4B,EAAAA;AAClB,eAAOkjE,EAAar7F,CAAAA,EAAGsV;AAAAA,EAGzB,GACD6gB,OAAM,SAAS/S;EACd,EAGFtmB,GAAAA,EAAUu4B,YAAsB,WAAE,EACjC3iB,QAAO,SAASwjB,GAAAA;AACf,WAAIp5B,EAAUM,OAAO66B,YACb,8CAEA;AAAA,EACR,GACDzC,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAAAA;AAChCgmB,IAAAA,IAAKtmB,EAAU4b,UAAU8E,cAAc,IAAIpgB,EAAO2C,EAAAA,EAAAA,GAE/C3C,EAAOyO,WACTuX,EAAKrlB,MAAM8N,SAAS,GAAGzO,EAAOyO,MAAAA;AAE/B,QAAI9L,IAAKjD,EAAUqM,IACfoyF,GAAAA,IAAoBn+F,EAAOk+F,kBAA3BC,SAA2DjmF,KAASlY,EAAOk+F,gBAAAA,CAAAA,CAAkBhmF;AACjG8N,IAAAA,EAAKxX,aAAa;AAClB,QAAI4vF,IAAa,gBAAcz7F,IAAG,0CAAwC3C,EAAOiY,OAAK,OAAKT,IAAY,mBAAiB,MAAI,MACxH6mF,IAAa,iBAAe17F,IAAG,QAAMjD,EAAU0tB,OAAOwN,OAAO,aAAW56B,EAAOiY,IAAAA,KAAOjY,EAAOiY,QAAM;AAOvG,QANIvY,EAAUM,OAAO66B,aACpB7U,EAAKxY,YAAY6wF,GACjBr4E,EAAK6D,YAAYrc,YAAU4wF,KAE3Bp4E,EAAKxY,YAAU4wF,IAAWC,GAEvBr+F,EAAOoZ,SAAS;AACnB,UAAIklF,IAAWt4E,EAAKwS,qBAAqB,OAAS,EAAA,CAAA;AAClD,UAAG8lE,EAASt/E;AACX;AAEDs/E,MAAAA,EAASt/E,sBACTtf,EAAUI,MAAMw+F,GAAU,SAASt+F,EAAOoZ,OAAAA;AAAAA,IAE1C;AAAA,EACD,GACD8e,WAAU,SAASlS,GAAKvgB,GAAGzF,GAE1B;AAAA,QAAIs+F,KADJt4E,IAAKtmB,EAAU4b,UAAU8E,cAAc,IAAIpgB,EAAO2C,OAC9B61B,qBAAqB,OAAA,EAAS;AAGlD,WAFK8lE,MACJA,IAAWt4E,EAAK6D,YAAY2O,qBAAqB,OAAA,EAAS,CACnD8lE,IAAAA,EAAgB,UAAGt+F,EAAOk+F,iBAAAA,KAAsBl+F,EAAOu+F,mBAAAA;AAAAA,EAC/D,GACDxlE,OAAM,SAAS/S,GAAAA;AAAAA,EACd,EAIF;AAAA,GTjICw4E,QUpDc,SAAS9+F,GAAAA;AAExBA,IAAU6c,IAAIkiF,aAAa,EAC1BC,YAAY,KAAA,GAGbh/F,EAAU8+F,SAAS,WAClB;AAAA,QAAI9+F,EAAUmJ,UAAU,kBAAkB,KAA1C;AAEA,UAAIoJ,IAAIvS,EAAU63B;AAClB;AACCtlB,QAAAA,EAAE0sF,YAAY1sF,EAAEtR,MAAM8J,YAAY,IAClCwH,EAAEtR,MAAM8J,WAAW;AAAA,cACVwH,IAAIA,EAAEhH,eAAegH,EAAEtR;AACjCsR,OAAAA,IAAIvS,EAAU63B,MACZ52B,MAAM8J,WAAW,YACnBwH,EAAE2sF,SAAS3sF,EAAEtR,MAAM+N,OACnBuD,EAAE4sF,UAAU5sF,EAAEtR,MAAM8N,QACpBwD,EAAEtR,MAAM+N,QAAQuD,EAAEtR,MAAM8N,SAAS,QACjCwD,EAAEtR,MAAMC,MAAMqR,EAAEtR,MAAME,OAAO;AAE7B,UAAID,IAAM0M,SAASmJ;AACnB7V,MAAAA,EAAIuoB,YAAY,IAEhBvoB,IAAMA,EAAIqK,gBAETrK,EAAIuoB,YAAY,IACjB7b,SAASmJ,KAAKqoF,YAAYxxF,SAASmJ,KAAK9V,MAAMo+F,YAAY,IAC1DzxF,SAASmJ,KAAK9V,MAAMo+F,WAAW,UAC/Br/F,EAAUs/F,UACVt/F,GAAAA,EAAUmJ,UAAU,YAAY,CAAA,CAAA;AAAA,IAtBxB;AAAA,EAuBT,GACAnJ,EAAUu/F,WAAW;AACpB,QAAIv/F,EAAUmJ,UAAU,oBAAoB,CAAA,CAAA,GAA5C;AAEA,UAAIoJ,IAAIvS,EAAU63B;AAClB;AACCtlB,QAAAA,EAAEtR,MAAM8J,WAAWwH,EAAE0sF;AAAAA,cACZ1sF,IAAIA,EAAEhH,eAAegH,EAAEtR;AAAAA,OACjCsR,IAAIvS,EAAU63B,MACZ52B,MAAM+N,QAAQuD,EAAE2sF,QAClB3sF,EAAEtR,MAAM8N,SAASwD,EAAE4sF,SACnBvxF,SAASmJ,KAAK9V,MAAMo+F,WAAWzxF,SAASmJ,KAAKqoF,WAC7Cp/F,EAAUs/F,UACVt/F,GAAAA,EAAUmJ,UAAU,cAAc,CAAA,CAAA;AAAA,IAV1B;AAAA,EAWT,GACAnJ,EAAUsE,YAAY,oBAAoB,WACzC;AAAA,QAAIiO,IAAI3E,SAASC,cAAc;AAC/B0E,IAAAA,EAAEzD,YAAY,mBACd9O,EAAU6c,IAAIkiF,WAAWC,aAAazsF,GACtCA,EAAEzE,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAad9N,EAAU63B,KAAK9pB,YAAYwE,CAAAA,GAC3BvS,EAAUI,MAAMmS,GAAG,SAAU;AACvBvS,QAAUikD,WAEdjkD,EAAUu/F,SADVv/F,IAAAA,EAAU8+F;IAEb,CACA;AAAA,EAAA,CAAA,GACA9+F,EAAUs/F,YAAY,WACrBh2F;AAAAA,SAAK26C,YAAY36C,KAAK26C,UACnB36C,KAAK26C,WACP36C,KAAKuT,IAAIkiF,WAAWC,WAAWngF,UAAU5c,IAAI,2BAG7CqH,IAAAA,KAAKuT,IAAIkiF,WAAWC,WAAWngF,UAAUwL,OAAO,2BAAA;AAMjD,aADIm1E,IAAa,CAAC,QAAQ,KACjBt8F,GAAAA,IAAI,GAAGA,IAAIs8F,EAAWr8F,QAAQD,KAAK;AAE3C,UAAIu8F,IAAcz/F,EAAU,kBAAkBw/F,EAAWt8F,CACrDlD,CAAAA;AAAAA,QAAU+gB,GAAG,YAAYy+E,EAAWt8F,OACvClD,EAAU,kBAAkBw/F,EAAWt8F,CAAMlD,CAAAA,IAAAA,EAAU+gB,GAAG,YAAYy+E,EAAWt8F,CAAAA,CAAAA,GACjFlD,EAAU+gB,GAAG,YAAYy+E,EAAWt8F,CAAM,CAAA,IAAA,KAEtCu8F,MACHz/F,EAAU+gB,GAAG,YAAYy+E,EAAWt8F,CAAMlD,CAAAA,IAAAA,EAAU,kBAAkBw/F,EAAWt8F,CAAAA,CAAAA,GAAAA,OAC1ElD,EAAU,kBAAkBw/F,EAAWt8F;IAGhD;AAEDlD,MAAU6V,eACX;AAAA,EAAA;AAGA,GV/CC6pF,YWrDc,SAAS1/F,GAGxB;AAAA,GAAA,WAAA;AAEA,aAASi5B,EAASv2B,GAAKi9F;AACtB,eAAStsF,KAAOssF;AACVj9F,QAAAA,EAAI2Q,CAAAA,MACR3Q,EAAI2Q,CAAOssF,IAAAA,EAAItsF;AACjB,aAAO3Q;AAAAA,IACR;AAEA,aAASk9F,EAAgB97F,GAAS9D,GAAAA;AACjC,UAAI6/F,IAAQ,CAAA;AASZ,cARA/7F,IAAU9D,EAAU6J,KAAK/F,OACVA,EAAQ,CAAA,KACtB+7F,EAAMv0E,IAAIxnB,EAAQ,CAAA,EAAGkrF,aACrB6Q,EAAMx0E,IAAIvnB,EAAQ,CAAGq4D,EAAAA,iBAErB0jC,EAAMv0E,IAAI,GACVu0E,EAAMx0E,IAAI,IAEJw0E;AAAAA,IACR;AAGIhgG,WAAOigG,eACVjgG,OAAOigG,aAAa,EACnB7pC,MAAM,SAAS9/C,GAAKvG,GAAM8E,GAAAA;AACzB,aAAO7U,OAAOkgG,KAAKztE,KAAK2jC,KAAK9/C,GAAKvG,GAAM8E,CAAAA;AAAAA,IACxC,GACD6d,KAAK,SAASpc,GAAKzB,GAClB;AAAA,aAAO7U,OAAOyyB,KAAKC,IAAIpc,GAAKzB,CAC5B;AAAA,IAAA,EAAA,IAIH,SAA4B1U,GA0K3B;AAAA,eAASggG,IACR;AAAA,YAAIz7F,IAAOvE,EAAU4E,WAAWL;AAChC,eAAIvE,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CACjCvE,IAAAA,EAAUuG,OAAOhC,CAAAA,IAElB;AAAA,MACP;AA9KDvE,MAAAA,EAAUqhD,cAAc,SAAS/gD;SAChCA,IAAS24B,EAAU34B,KAAU,IAAK,EACjCiY,MAAK,gBACL2U,QAAO,MACP+yE,aAAY,aACZC,KAAI,IACJ3xB,MAAK,GACL3tC,KAAK5gC,EAAUM,OAAOsgC,IAAAA,CAAAA,GAEhBl/B,OAAO4H,KAAK62F,aAAa7/F,CAChCA,GAAAA,EAAOiE,OAAO+E,KAAK1E,SAAAA,EAAWL,MAC9B+E,KAAK82F,gBAAgB9/F,GAAQ,KAAA;AAAA,MAC/B,GAECN,EAAUohD,cAAc,SAAS9gD,GAAAA;AAAAA,SAChCA,IAAS24B,EAAU34B,KAAU,IAAK,EACjCiY,MAAK,gBACL2U,QAAO,MACP+yE,aAAY,aACZC,KAAI,IACJ3xB,MAAK,GACL3tC,KAAK5gC,EAAUM,OAAOsgC,IAEhBl/B,CAAAA,GAAAA,OAAO4H,KAAK62F,aAAa7/F,IAChCA,EAAOiE,OAAO+E,KAAK1E,SAAWL,EAAAA,MAC9B+E,KAAK82F,gBAAgB9/F,GAAQ,KAC/B;AAAA,MAAA,GAECN,EAAUqgG,eAAe,SAAS//F,GACjCA;AAAAA,QAAAA,IAAS24B,EAAU34B,KAAU,IAAK,EACjCiY,MAAK,iBACL3I,MAAKtG,KAAKg3F,iBAAiB,MAAMhgG,CAElCgJ,EAAAA,CAAAA,GAAAA,KAAK82F,gBAAgB9/F,GAAQ,MAAA;AAAA,MAC/B,GAECN,EAAUugG,gBAAgB,SAASjgG,GAAAA;AAClCA,QAAAA,IAAS24B,EAAU34B,KAAU,IAAK,EACjCiY,MAAK,iBACLsmB,OAAM,UACNjvB,MAAKtG,KAAKg3F,iBAAkBh3F,KAAKmR,UAAU6c,YAAYh3B,CACvDghE,GAAAA,SAAQh4D,KAAKk3F,mBAEdl3F,EAAAA,CAAAA,GAAAA,KAAK82F,gBAAgB9/F,GAAQ,OAAA;AAAA,MAC/B,GAECN,EAAUygG,kBAAkB,SAAS7wF,GAAM/J,GAAM6O,GAAAA;AAAAA,eACzC9E,EAAK8E;AACZ,YAAIyB,IAAMvG,EAAK8wF,UAAU;AAEzB7gG,eAAOigG,WAAW7pC,KAAK9/C,GACtB,UAAQtQ,IAAK,mBAAiBmnB,mBAAmB7U,KAAKmB,UAAU1J,CAChE,CAAA,GAAA,SAASwjB,GACR;AAAA,cACIutE,IAAO;AAEX,gBAHWvtE,EAAOJ,OAAOja,SAAS;AAIjC,gBAAA;AACC4nF,cAAAA,IAAOxoF,KAAKhB,MAAMic,EAAOJ,OAAOC,YAChC;AAAA,YAAA,QAAU;AAAA,YAAA;AAEZve,UAAAA,EAASisF,CACT;AAAA,QAAA,CAAA;AAAA,MAEJ,GAEC3gG,EAAU4gG,qBAAqB,SAAStjF,GAAQ4P,GAAAA;AAC/C,YAAIxoB,IAAS,CAAA;AACb,iBAAS2O,KAAOiK;AACf5Y,UAAAA,EAAO2O,CAAOiK,IAAAA,EAAOjK,CAMtB;AAAA,eAJA3O,EAAOnD,aAAa2rB,EAAOxoB,EAAOnD,UAClCmD,GAAAA,EAAOlD,WAAW0rB,EAAOxoB,EAAOlD,QAChCkD,GAAAA,EAAOm8F,QAAQv3F,KAAKmR,UAAU02C,WAAW7zC,EAAO/b,YAAY+b,EAAO9b,UAAU8b,IAEtE5Y;AAAAA,MACT,GAEC1E,EAAUsgG,mBAAmB,SAASpzE,GAAQ5sB;AAG7C,YAAIwb;AAFJoR,QAAAA,IAASA,KAAUltB,EAAUgC,KAAK0tB,YAAY,iBAAA,EAI7C5T,GAAAA,IADGxb,KAAUA,EAAO2M,SAAS3M,EAAO4M,MAC3BlN,EAAUqkC,UAAU/jC,EAAO2M,OAAO3M,EAAO4M,GAAAA,IAEzClN,EAAUqkC,UAAAA;AAGpB,iBADIz0B,IAAO,CACF1M,GAAAA,IAAI,GAAGA,IAAG4Y,EAAO3Y,QAAQD;AACjC0M,YAAK1M,CAAKoG,IAAAA,KAAKs3F,mBAAmB9kF,EAAO5Y,IAAIgqB,CAE9C;AAAA,eAAOtd;AAAAA,MACT,GAEC5P,EAAUwgG,qBAAqB,WAC9B;AAAA,eAAO,CACN,EAAEv9F,IAAG,cAAco1B,QAAO,cAAcrpB,OAAM,MAC9C,EAAE/L,IAAG,YAAYo1B,QAAO,YAAYrpB,OAAM,GAC1C,GAAA,EAAE/L,IAAG,SAASo1B,QAAO,QAAQrpB,OAAM,IAAA,CAAA;AAAA,MAEtC,GAEChP,EAAUogG,kBAAkB,SAASxwF,GAAM/J,GAS1C;AAAA,YARI+J,EAAK4lC,YACR5lC,EAAK4lC,UAAUx1C,EAAUw1C,UAGtB5lC,EAAK23B,SACR33B,EAAK23B,OAAOvnC,EAAUunC,OAGnB33B,EAAK8E;AACP,iBAAO1U,EAAUygG,gBAAgB7wF,GAAM/J,GAAM+J,EAAK8E,QAEpD;AAAA,YAAI+vC,IAAOn7C,KAAKw3F,oBAEhBr8C;AAAAA,QAAAA,EAAKx0C,WAAWmI,SAASxI,EAAK8wF,UAAU,uCACxCj8C,EAAKx0C,WAAWD,WAAW,CAAA,EAAGwI,QAAQL,KAAKmB,UAAU1J,CAAAA,GACrD60C,EAAKx0C,WAAWD,WAAW,GAAGwI,QAAQ3S,GACtC4+C,EAAKx0C,WAAW8wF,OAAAA;AAAAA,MAClB,GAEC/gG,EAAU8gG,sBAAsB,WAAA;AAC/B,aAAKx3F,KAAK03F,qBAAoB;AAC7B,cAAIzuF,IAAIjJ,KAAK03F,sBAAsBpzF,SAASC,cAAc,KAAA;AAC1D0E,UAAAA,EAAEtR,MAAMkgB,UAAU,QAClB5O,EAAEzE,YAAY,wHACdF,SAASmJ,KAAKhJ,YAAYwE,CAAAA;AAAAA,QAC1B;AACD,eAAOjJ,KAAK03F;AAAAA,MACd,GAEChhG,EAAUihG,mBAAmB,SAAS/zE,GAAQ+yE,GAAa1xB,GAAM2xB,GAAK7nE,GAAQ6oE,GAAQl1C,GAErFk0C;AAAAA,YAAMt3E,SAASs3E,CAAK,IAAA,QAAQ;AAE5B,YAAIL,IAAQ,EACXsB,IAAK,EAAE71E,GAAE,KAAKD,GAAE,IAAA,GAChB+1E,IAAK,EAAE91E,GAAE,KAAKD,GAAE,IAAA,GAChBg2E,IAAK,EAAE/1E,GAAE,KAAKD,GAAE,IAChBi2E,GAAAA,IAAK,EAAEh2E,GAAE,KAAKD,GAAE,IAChBk2E,GAAAA,IAAK,EAAEj2E,GAAE,KAAKD,GAAE,IAAA,GAChBm2E,IAAK,EAAEl2E,GAAE,KAAKD,GAAE,UAGbo2E,IAAQ7B,EAAgB,gBAAgBt2F,IAAMgiB,EAAAA,GAK9Co2E,IAAQ,EACXr2E,GALWu0E,EAAgB,gBAAgBt2F,IAAM+hB,EAAAA,IACtCu0E,EAAgB,kBAAkBt2F,IAAAA,EAAM+hB,IACxCu0E,EAAgB,iBAAiBt2F,IAAM+hB,EAAAA,EAAAA;AAiBnD,eAVCq2E,EAAMp2E,IADH4B,MAAW,SACJu0E,IAEAryF,KAAK+D,OAAQ8sF,MAAgB,cAAcJ,EAAM3yE,CAAQ7B,EAAAA,IAAIw0E,EAAM3yE,CAAAA,EAAQ5B,KAAK40E,CAGvFl0C,GAAAA,MACH01C,EAAMp2E,KAAMq2E,WAAW31C,EAAO1gC,CAAM,KAAA,GACpCo2E,EAAMr2E,KAAMs2E,WAAW31C,EAAO3gC,MAAM,IAG9Bq2E;AAAAA,MACT,GA0DC1hG,EAAUmgG,eAAe,SAAUz9F,GAClC;AAAA,YAAIk/F,IAjDL,WAAA;AACC,cAAIC,IAAAA,QACH37D,IAAakB,QAEVlD,IAAW87D,EAMf;AAAA,iBALI97D,MACHgC,IAAahC,EAASgC,YACtB27D,IAAiB39D,EAAS49D,kBAGpB,EACN9gF,YAAYhhB,EAAU+gB,GAAGC,YACzBqhB,cAAcriC,EAAU+gB,GAAGshB,cAC3B0/D,aAAa/hG,EAAU63B,KAAK52B,MAAM+N,OAClCgzF,cAAchiG,EAAU63B,KAAK52B,MAAM8N,QACnCkzF,qBAAqB/7D,GACrBg8D,0BAA0BL,EAE3B;AAAA,QAAA,EAgCI/2F,GAAAA,IAAO9K,EAAUihG,iBAAiBv+F,EAAIwqB,QAAQxqB,EAAIu9F,aAAav9F,EAAI6rE,MAAM7rE,EAAIw9F,KAAKx9F,EAAI21B,QAAQ31B,EAAIw+F,QAAQx+F,EAAIspD,MAAAA,GAE9GtqD,IAAO;AACX,YAAA;AAAA,WAjCD,SAAwBoJ,GAAM82F,GAAAA;AAC7B5hG,YAAAA,EAAU63B,KAAK52B,MAAM+N,QAASlE,EAAKwgB,IAAI,MACvCtrB,EAAU63B,KAAK52B,MAAM8N,SAASjE,EAAKugB,IAAI,MAEvCrrB,EAAU+gB,GAAGC,aAAa,GAC1BhhB,EAAU+gB,GAAGshB,eAAe;AAE5B,gBAAI6B,IAAW87D,EACX4B;AAAAA,aAAAA,EAAaK,uBAAuBL,EAAaM,8BAEpDh+D,EAASgC,iBACThC,EAAS49D;UAEV,GAqBgBh3F,GAAM82F,CAAAA,GACrB5hG,EAAU6V,eACVnU,GAAAA,IAAO1B,EAAU63B,KAAK/pB;AAAAA,QACtB,SAAQtJ,GAAAA;AAGRmQ,kBAAQC,MAAMpQ,CAAAA;AAAAA,QACjB,UAAY;AAAA,WA1BX,SAAyBo9F,GAAAA;AACxB5hG,YAAAA,EAAU+gB,GAAGshB,eAAeu/D,EAAav/D,cACzCriC,EAAU+gB,GAAGC,aAAa4gF,EAAa5gF,YACvChhB,EAAU63B,KAAK52B,MAAM+N,QAAS4yF,EAAaG,aAC3C/hG,EAAU63B,KAAK52B,MAAM8N,SAAS6yF,EAAaI;AAE3C,gBAAI99D,IAAW87D,EACX4B;AAAAA,aAAAA,EAAaK,uBAAuBL,EAAaM,8BACpDh+D,EAASgC,aAAa07D,EAAaK,qBACnC/9D,EAAS49D,kBAAkBF,EAAaM;AAAAA,UAEzC,GAgBiBN,IAChB5hG,EAAU6V,eAAAA;AAAAA,QACV;AAED,eAAOnU;AAAAA,MACT;AAAA,IAEA,EAEmB1B,CAGlB;AAAA,EAAA,GAED;AAAA,GX7OCmiG,WYtDc,SAASniG,GAAAA;AAGvBA,IAAU6hD,QAAQ,EACjB7e,OAAO,CAAE,GACTo/D,YAAW,EACVC,KAAM,SAASlgF,GAAEC,GAAGkgF,GAAAA;AAAS,WAAiB,IAAVA,EAAOngF,KAAiB,IAAVmgF,EAAOlgF,CAAK,IAAA,IAAA;AAAA,EAAO,GACrE6D,KAAM,SAAS9D,GAAEC,GAAGkgF,GAAS;AAAA,WAAOA,EAAOngF,CAAKmgF,IAAAA,EAAOlgF,CAAG,IAAA,IAAA;AAAA,EAAO,GACjEpgB,MAAO,SAASmgB,GAAEC,GAAGkgF,GAAS;AAAA,WAAO,IAAI9/F,KAAK8/F,EAAOngF,CAAK,CAAA,IAAA,IAAI3f,KAAK8/F,EAAOlgF,MAAI,IAAG;AAAA,EAAI,KAEtFmgF,aAAY,SAAShqF;AACpB,WAAO,UAAQA;AAAAA,EACf,GACDiqF,cAAa,SAASC;AACrB,WAAOA,EAAQ5qF,QAAQ,UAAS,EAAA;AAAA,EAChC,KAqBH7X,EAAUmhD,iBAAe,SAASz+C,GAAAA;AACjC,QAAI6V,IAAO7V,EAAI6V,QAAQ,QACnBkqF,IAAUziG,EAAU6hD,MAAM0gD,YAAYhqF,CAY1C;AAAA,aAASmqF,EAAY53F,GAAAA;AACpB,aAAkBs8B,EAATt8B,MAASs8B,WAAmB,IAALt8B,KAAUA,KAAQA,IAAO;AAAA,IACzD;AAZD9K,MAAU6hD,MAAM7e,MAAMzqB,CAAAA,IAAQA,GAC9BvY,EAAUM,OAAOiY,IAAO,QAAA,IAAY7V,EAAImvB,4BAAarvB,KAAK,CAC1DxC,GAAAA,EAAUM,OAAOiY,IAAO,MAAU7V,IAAAA,EAAIqvB,MAAO,IAAIvvB,KAAK,MAAK,GAAE,CAAA,GAE7DxC,EAAUyiG,CAAW//F,IAAAA,GACrB1C,EAAUyiG,CAAAA,EAASE,aAAa,GAChC3iG,EAAUyiG,CAASnhC,EAAAA,UAAUthE,EAAUyiG,CAASr7C,EAAAA,QAChDpnD,EAAUyiG,CAAS1vF,EAAAA,OAAOrQ,EAAIqQ,QAAQ,SACtC/S,EAAUyiG,CAASz8D,EAAAA,OAAOtjC,EAAIsjC,QAAQ,GAAA,OAC/BhmC,EAAUyiG,CAASr7C,EAAAA;AAM1B,aADIrnC,IAAO/f,EAAUyiG,GAASnhC,SACtBp+D,IAAE,GAAGA,IAAI6c,EAAK5c,QAAQD;AAC1Bw/F,MAAAA,EAAY3iF,EAAK7c,CAAAA,EAAG8L,KACtB+Q,MAAAA,EAAK7c,GAAG0/F,eAAe7iF,EAAK7c,GAAG8L,QAC5B0zF,EAAY3iF,EAAK7c,CAAG2/F,EAAAA,WAAAA,KAAAA,OAChB9iF,EAAK7c,CAAAA,EAAG2/F,aACZH,EAAY3iF,EAAK7c,CAAG4/F,EAAAA,YAAAA,KAAAA,OAChB/iF,EAAK7c,CAAG4/F,EAAAA;AAGjB9iG,MAAUyiG,CAAS96E,EAAAA,SAASjlB,EAAIilB,WAAbA,UAA2CjlB,EAAIilB,QAC/D3nB,EAAU0tB,OAAOwN,OAAO3iB,IAAM,uBAChCvY,EAAU0tB,OAAOwN,OAAO3iB,IAAM,MAAUvY,IAAAA,EAAUyiG,GAASzuE,SAASh0B,EAAU0tB,OAAOwN,OAAOuc,WAE7Fz3C,EAAUyiG,CAASM,EAAAA,iBAAiB,CAEpC/iG,GAAAA,EAAUgC,KAAKuW,IAAK,YAAU,SAAS5G,GAAAA;AACtC,aAAG3R,EAAUgC,KAAKU,EAAIqQ,OAAK,QAAA,IACnB/S,EAAUgC,KAAKU,EAAIqQ,OAAK,UAAUpB,CAEzC,IAAAwQ;AAAA,IACH,GACCniB,EAAUgC,KAAK,SAASuW,CAAQ,IAAA,SAASvW,GAAMmtB,GAAAA;AAC9C,aAAOnvB,EAAUgC,KAAKC,IAAID,GAAMmtB,IAAInvB,EAAUyiG,CAAAA,EAASz8D,MAAMhmC,EAAUyiG,CAAAA,EAAS1vF,IAClF;AAAA,IAAA,GAEC/S,EAAUya,UAAUlC,IAAK,OAAW,IAAA,SAAStL,GAAOC,GACnD;AAAA,aAAIlN,EAAUM,OAAOsgC,MACb5gC,EAAUya,UAAU+rB,SAASt5B,CAAAA,IAAK,QAAMlN,EAAUya,UAAU+rB,SAASv5B,CAErEjN,IAAAA,EAAUya,UAAU+rB,SAASv5B,CAAAA,IAAO,QAAMjN,EAAUya,UAAU+rB,SAASt5B;IAEjF,GACClN,EAAUya,UAAUlC,IAAO,YAAA,IAAgB,SAAStL,GAAMC,GAAInH,GAC7D;AAAA,aAAI/F,EAAU4I,cAAc7C,KACpBuD,KAAKiP,IAAO,gBAAgBtL,CACzBjN,IAAAA,EAAUM,OAAOsgC,MACpB5gC,EAAUya,UAAU+rB,SAASt5B,CAAK,IAAA,cAAYlN,EAAUya,UAAU+rB,SAASv5B,KAE3EjN,EAAUya,UAAU+rB,SAASv5B,CAAO,IAAA,cAAYjN,EAAUya,UAAU+rB,SAASt5B,CAAAA;AAAAA,IAEvF,GACClN,EAAUya,UAAUlC,IAAO,cAAkB,IAAA,SAASvW;AACrD,aAAOhC,EAAUya,UAAU+rB,SAASxkC,CAAM,IAAA,MAAIsH,KAAKgvD,WAAWt2D,CAAAA;AAAAA,IAChE,GACChC,EAAUya,UAAUlC,IAAO,QAAY,IAAA,SAASyqF,GAAY5iG,GAC3D;AAAA,aAAOA,EAAM4iG,CACf;AAAA,IAAA,GAEChjG,EAAUsE,YAAY,oBAAmB;AACxCtE,QAAUsE,YAAY,mBAAmB,SAASrB,GACjD;AAAA,YAAGqG,KAAKoB,SAAS6N,KAAQvY,EAAUyiG,CAAS96E,EAAAA;AAE3C,iBADA3nB,EAAU6hD,MAAMohD,YAAYhgG,GAAIsV,CACzB,GAAA;AAAA,MAEX,IACEvY,EAAUsE,YAAY,qBAAqB,SAASrB,GAAAA;AAChDqG,aAAKoB,SAAS6N,KAAQvY,EAAUyiG,CAAAA,EAAS96E,UAC3C3nB,EAAU6hD,MAAMqhD,cAAc,IAAI3qF;MAEtC,CAEE;AAAA,UAAI6V,IAAMpuB,EAAU+V;AACpB/V,QAAU+V,cAAY,SAAS5N,GAAAA;AAC9B,YAAImB,KAAKoB,SAAS6N;AAGjB,iBAAO6V,EAAIliB,MAAM5C,MAAK+I,SAAAA;AAFtBrS,UAAU6hD,MAAMshD,eAAeV,CAAAA;AAAAA,MAGnC;AAEE,UAAI3P,IAAuB9yF,EAAUgW;AACrChW,QAAUgW,mBAAiB,WAC1B;AAAA,YAAIotF,IAAiBpjG,EAAU6J,KAAmB,aAAE,GAAGm5D;AAKvD,eAJG15D,KAAKoB,SAAS6N,KAAQ6qF,MACxBpjG,EAAU6hD,MAAMwhD,iBAAiBD,EAAe35E,YAG1CqpE,EAAqB5mF,MAAM5C,MAAK+I,SAAAA;AAAAA,MAC1C;AAAA,IACA,CAGCrS,GAAAA,EAAUuY,IAAK,OAAS,IAAA,SAAShU;AAOhC,UANAvE,EAAU6hD,MAAMyhD,eAAe,MAAA,OACxBtjG,EAAUo4F,WACjBp4F,EAAU6hD,MAAMwhD,iBAAiB,GACjCrjG,EAAU0lC,YAAU,CACpB1lC,GAAAA,EAAUyiG,GAASM,iBAAiB,CAAA,GAEhCx+F,GAAK;AACR,YAAI+K,IAAM,MACTD,IAAM;AACIrP,UAAUyiG,CACbc,EAAAA,UACPj0F,IAAMtP,EAAUgC,KAAKuW,IAAK,QAAU,EAAA,IAAI/V,KAAKxC,EAAUoT,KAAAA,CAAAA,GACvD/D,IAAMrP,EAAUgC,KAAK,SAAOuW,GAAMjJ,GAAK,CAAA,MAEvCA,IAAMtP,EAAUM,OAAOiY,IAAO,QAC9BlJ,GAAAA,IAAMrP,EAAUM,OAAOiY,IAAO,MAAA,IAG/BvY,EAAUkK,YAAYoF,GACtBtP,EAAUiK,YAAYoF,GAEtBrP,EAAU6hD,MAAM2hD,cAAcf,CAE9B;AAAA,YAAIpqE,IAAS;AAAA,SACT/oB,KAAO,oBAAI9M,KAAK,OAAO6M,IAAM,CAAA,IAAM7M,KAAK,MAAK,GAAE,CAClD61B,MAAAA,IAASr4B,EAAUya,UAAUlC,IAAK,OAASjJ,EAAAA,GAAKD;AAGjD,YAAIgkF,IAAcrzF,EAAU0sD,mBACzB2mC;AAAAA,QAAAA,MACFA,EAAYvlF,YAAUuqB,IAIvBr4B,EAAUo4F,YAAYqK;AAAAA,MAGtB;AAAA,IACH;AAAA,EAGA,GAGAziG,EAAUyjG,yBAAuB,WAC3Bn6F;AAAAA,KAAAA,KAAKhJ,OAAOy6B,YAAYzxB,KAAKhJ,OAAOsT,mBACxCtK,KAAKuK;EACP,GAEG7T,EAAU8kC,OAAO4+D,mBACnB1jG,EAAU2jG,oBAAoB3jG,EAAU8kC,OAAO4+D,iBAEhD1jG,EAAU8kC,OAAO4+D,iBAAe,SAASl/F,GACxC;AAAA,QAAGxE,EAAUo4F,WAAU;AACtB,UAAIh4F,IAAQoE,KAAG3E,OAAOO,OAElB6kD,IAASjlD,EAAU6hD,MAAM+hD,mBAAmBxjG,GAAOJ,EAAUo4F,SACjEp4F;AAAAA,QAAU6hD,MAAMgiD,mBAAmB7jG,EAAUo4F,WAAWnzC,EAAOhiD,EAC/DjD,GAAAA,EAAUk5D,cACVl5D,EAAU6hD,MAAMshD,eAAenjG,EAAUo4F,SAAAA;AAAAA,IACzC,WACOp4F,EAAU2jG;AACjB,aAAO3jG,EAAU2jG,kBAAkBz3F,MAAM5C,MAAK+I,SAAAA;AAAAA,EAChD,GAEArS,EAAU6hD,MAAMohD,cAAc,SAAShgG,GAAI6gG,GAAAA;AAC1C,QAAG9jG,EAAUmJ,UAAU,qBAAoB,CAAClG,CAAAA,CAAAA,GAAK;AAChD,UAAIw/F,IAAUziG,EAAU6hD,MAAM0gD,YAAYuB,CAAAA;AAE1C9jG,QAAUylC,aAAaxiC,GAAI,SAAS8gG,GACnCA;AAAAA,QAAAA,EAAUllF,UAAU5c,IAAI,yBAAA,GACxBjC,EAAUyiG,CAAAA,EAASM,eAAepgG,KAAKohG;MAC1C,CAEE;AAAA,IAAA;AAAA,EACF,GAEA/jG,EAAU6hD,MAAMmiD,eAAc,SAAS34F,GAAAA;AACtCA,IAAAA,EAAIyD,YAAYzD,EAAIwT,UAAUwL,OAAO,yBACtC;AAAA,EAAA,GACArqB,EAAU6hD,MAAMqhD,gBAAgB,SAASjgG,GAAI6gG,GAAAA;AAC5C,QAAIrB,IAAUziG,EAAU6hD,MAAM0gD,YAAYuB,CAC1C;AAAA,QAAIrB,KAAYziG,EAAUyiG,CAAAA,EAASM;AAGnC,UAAI9/F;AAOH,aAAQC,IAAE,GAAGA,IAAElD,EAAUyiG,CAASM,EAAAA,eAAe5/F,QAAQD;AACxD,cAAGlD,EAAUyiG,CAASM,EAAAA,eAAe7/F,CAAGiB,EAAAA,aAAanE,EAAUM,OAAO0C,oBAAoBC,GAAG;AAC5FjD,cAAU6hD,MAAMmiD,aAAahkG,EAAUyiG,CAASM,EAAAA,eAAe7/F,CAC/DlD,CAAAA,GAAAA,EAAUyiG,CAASM,EAAAA,eAAeh3F,MAAM7I,GAAE,CAAA;AAC1C;AAAA,UACA;AAAA,aAZI;AACN,iBAAQA,IAAE,GAAGA,IAAElD,EAAUyiG,CAAAA,EAASM,eAAe5/F,QAAQD;AACxDlD,YAAU6hD,MAAMmiD,aAAahkG,EAAUyiG,CAASM,EAAAA,eAAe7/F,CAEhElD,CAAAA;AAAAA,UAAUyiG,CAASM,EAAAA,iBAAiB;MAEtC;AAAA,EAQA,GAEA/iG,EAAU6hD,MAAM+hD,qBAAqB,SAASxjG,GAAOqiG,GAAAA;AACpD,QAAIwB,IAAO7jG,EAAM8jG,kBAAkB9jG,EAAMwmB;AAEzB,IADA5mB,EAAUkQ,cAAc+zF,CAAAA,KACxB,yBACfA,IAAOA,EAAK14F;AAGb,aADI3J,IAAQ,GACJsB,IAAG,GAAGA,IAAI+gG,EAAK14F,WAAWyE,WAAW7M,QAAQD;AACpD,UAAG+gG,EAAK14F,WAAWyE,WAAW9M,MAAM+gG,GAAK;AACxCriG,QAAAA,IAAQsB;AACR;AAAA,MACA;AAGF,WAAOlD,EAAUyiG,CAASnhC,EAAAA,QAAQ1/D,CACnC;AAAA,EAAA,GAEA5B,EAAU6hD,MAAMsiD,kBAAkB,SAAS1B,GAE1C;AAAA,WADWziG,EAAUyiG,CACT73E,EAAAA;AAAAA,EACb,GAEA5qB,EAAU6hD,MAAMgiD,qBAAqB,SAASpB,GAASx9C,GAAAA;AACtD,QAAIr6B,IAAOthB,KAAK66F,gBAAgB1B,CAC5BhiD,GAAAA,IAAOzgD,EAAUyiG,CAAAA;AAElB73E,IAAAA,KAAQA,EAAKq6B,UAAUA,IACzBr6B,EAAKmyB,YAAYnyB,EAAKmyB,aAAa,QAAQ,SAAS,QAEpD0D,EAAK71B,OAAO,EACXq6B,QAAQA,GACRlI,WAAW,OAAA;AAAA,EAGd,GAEA/8C,EAAU6hD,MAAMuiD,6BAA6B,SAASn/C,GAAAA;AACrD,QAAIzsC,IAAQ;AACZ,QAAGysC,EAAO/rB,UAAS;AAClB,UAAIA,IAAW+rB,EAAO/rB;AACtB1gB,UAAQ,SAASzS,GAChB;AAAA,eAAOmzB,EAASnzB,EAAGxE,YAAYwE,EAAGvE,UAAUuE;MAC/C;AAAA,IACA,OAAM;AACJ,UAAIgmF,IAAQ9mC,EAAOhiD;AACP,MAAT8oF,KAAS,WACXA,IAAQ,eACTvzE,IAAQ,SAASzS,GAAK;AAAA,eAAOA,EAAGgmF;;IAChC;AACD,WAAOvzE;AAAAA,EACR,GAEAxY,EAAU6hD,MAAMwiD,mBAAmB,SAAS/iC,GAAS12C,GAAAA;AAOpD,QALG5qB,EAAU6hD,MAAMyhD,iBAClBtjG,EAAU6hD,MAAMyhD,aAAax0F,YAAY9O,EAAU6hD,MAAMyhD,aAAax0F,UAAU+I,QAAQ,gCAAgC,EACxH7X,GAAAA,EAAU6hD,MAAMyhD,aAAa93F,YAAYxL,EAAU6hD,MAAMyhD,aAAatgC,SAAAA,IAGpEp4C,GAAK;AACP,UAAItE,IAAOtmB,EAAU6hD,MAAMyiD,iBAAiBhjC,GAAS12C,EAAKq6B,MAAAA;AAE1D3+B,MAAAA,EAAKxX,aAAa,oBAAmB8b,EAAKmyB,WAC1C/8C,EAAU6hD,MAAMyhD,eAAeh9E;AAC/B,UAAI5kB,IAAO,kDAAiD4kB,CAAAA,EAAKrlB,MAAM+N,MAAM6I,QAAQ,MAAK,EAAK,IAAA,KAAGyO,EAAKwC,cAAY;AACnHxC,MAAAA,EAAKxY,aAAapM;AAAAA,IAClB;AAAA,EACF,GAEA1B,EAAU6hD,MAAM0iD,YAAU,SAAS35E,GAAAA;AAElCA,IAAAA,IAAOA,KAAQ,EAACmyB,WAAU,QAAQvkC,OAAM,SAASzS;AAAI,aAAOA,EAAGxE;AAAAA,IAAW,GAAG2rF,MAAKltF,EAAU6hD,MAAMugD,WAAiB;AAEnH,QAAItmF,IAAS9b,EAAU85D,mBAMvB;AAAA,WAJAh+C,EAAO8O,KAAK,SAASzI,GAAEC,GAAG;AAAA,aAAOwI,EAAKsiE,KAAK/qE,GAAEC,GAAEwI,EAAKpS,KAAO;AAAA,IAAA,CAAA,GACxDoS,EAAKmyB,aAAa,UACpBjhC,IAASA,EAAOmuB,QAAAA,IAEVnuB;AAAAA,EACR,GAIA9b,EAAU6hD,MAAM2hD,gBAAgB,SAASj/F,GAAAA;AACxC,QAAIA,GAAK;AAER,UAAI7C,IAAM1B,EAAU6hD,MAAM2iD,mBAAmBjgG,CAE7CvE;AAAAA,QAAU6J,KAAqB,eAAE,CAAA,EAAGiE,YAAWpM,GAC/C1B,EAAUyK,kBACVzK,EAAUiiD,UACV;AAAA,IAAA;AAAA,EACF,GACAjiD,EAAU6hD,MAAM4iD,eAAe,SAASx/C,GAAQ35C,GAC/C;AAAA,YAAQ25C,EAAO49C,gBAAf,SAA2C,IAAE59C,EAAO49C,cAAc7iG,EAAUsL,GAAQq3F,eAClF19C,EAAO69C,iBAAiB17D,SAAY,IAAE6d,EAAO69C,eAAe9iG,EAAUsL,CAAQq3F,EAAAA;AAAAA,EACjF,GAEA3iG,EAAU6hD,MAAM6iD,aAAa,SAASz/C,GAAQ7kC,GAE7C;AAAA,aADIukF,IAAa,CAAA,GAAI1jG,IAAQ,IACrBiC,IAAE,GAAGkd,EAAMld,CAAIA,GAAAA;AAEtB,cADAjC,IAAQmf,EAAMld,KAAK,KACXkd,EAAMld,CACb,GAAA;AAAA,QAAA,KAAK;AACD+hD,UAAAA,EAAOjlC,SACT2kF,EAAWhiG,KAAK1B,IAAMgkD,EAAOjlC,KAAAA;AAC9B;AAAA,QACD,KAAK;AACDilC,UAAAA,EAAO2/C,UACTD,EAAWhiG,KAAK1B,IAAMgkD,EAAO2/C,MAAAA;AAC9B;AAAA,QACD,KAAK;AAAA,UACD3/C,EAAO49C,gBADN,UAEH8B,EAAWhiG,KAAK1B,KAAOgkD,EAAO49C,eAAa,OAAO,IAAA;AACnD;AAAA,QACD,KAAK;AAAA,UACD59C,EAAO69C,iBADN,UAEH6B,EAAWhiG,KAAK1B,KAAOgkD,EAAO69C,gBAAc,OAAO,IAAA;AAAA,MAAA;AAIvD,WAAO6B;AAAAA,EACR,GAEA3kG,EAAU6hD,MAAMyiD,mBAAmB,SAAShjC,GAASr+D,GAEpD;AAAA,aADIrB,IAAS,IACLsB,IAAI,GAAGA,IAAIo+D,EAAQn+D,QAAQD;AAClC,UAAGo+D,EAAQp+D,CAAGD,EAAAA,MAAMA,GAAG;AACtBrB,QAAAA,IAAQsB;AACR;AAAA,MACA;AAGF,WAAGtB,IAAQ,IAAU,OAEd5B,EAAU63B,KAAK90B,iBAAiB,wBAAwBnB,CAChE;AAAA,EAAA,GAEA5B,EAAU6hD,MAAMgjD,iBAAiB,SAASpC,GACzC;AAAA,QAEIqC,GAFArkD,IAAOzgD,EAAUyiG,CAAAA,GACjB73E,IAAOthB,KAAK66F,gBAAgB1B;AAEhC,QAAG73E,GAAK;AAGP,eAFIq6B,GAEI/hD,IAAI,GAAGA,IAAIu9C,EAAK6gB,QAAQn+D,QAAQD;AACvC,YAAGu9C,EAAK6gB,QAAQp+D,CAAAA,EAAGD,MAAM2nB,EAAKq6B,QAAO;AACpCA,UAAAA,IAASxE,EAAK6gB,QAAQp+D;AACtB;AAAA,QACA;AAGF,UAAG+hD,GAAO;AACT,YAAIzsC,IAAQxY,EAAU6hD,MAAMuiD,2BAA2Bn/C,CAEnDioC,GAAAA,IAAOjoC,EAAOr6B;AACA,QAAA,OAARsiE,KAAQ,eACjBA,IAAOltF,EAAU6hD,MAAMugD,WAAWlV,CAASltF,KAAAA,EAAU6hD,MAAMugD,WAAgB,MAG5E0C,IAAW,EAAC/nD,WAAWnyB,EAAKmyB,WAAWmwC,MAAMA,GAAM10E,OAAOA,EAC1D;AAAA,MAAA;AAAA,IACD;AACD,WAAOssF;AAAAA,EACR,GAEA9kG,EAAU6hD,MAAMshD,iBAAiB,SAASV,GAAAA;AACzC,QAAIhiD,IAAOzgD,EAAUyiG,CAAAA,GACjB73E,IAAOthB,KAAK66F,gBAAgB1B,IAE5BqC,IAAWx7F,KAAKu7F,eAAepC,CAEhCqC;AAAAA,IAAAA,KACF9kG,EAAU6hD,MAAMwiD,iBAAiB5jD,EAAK6gB,SAAS12C,CAahD;AAAA,aAPI9O,IAAS9b,EAAU6hD,MAAM0iD,UAAUO,CAAAA,GAGnCxjC,IAAUthE,EAAUyiG,CAASnhC,EAAAA,SAE7B5/D,IAAO,SACPP,IAAAA,IACI+B,IAAE,GAAGA,IAAIo+D,EAAQn+D,QAAQD;AAGhC,MADA/B,KAAOmgE,EAAQp+D,CAAAA,EAAG8L,OACf9L,IAAIo+D,EAAQn+D,SAAS,MAEvBzB,KAAQ,4CADE1B,EAAUM,OAAOsgC,MAAM,UAAU,UACa,MAAMz/B,IAAO;AAQvE,SALAO,KAAQ,UAGRA,KAAO,uCADQ1B,EAAU66B,SAASm3B,eAAAA,IACmB,KAE5C9uD,IAAE,GAAGA,IAAE4Y,EAAO3Y,QAAQD;AAC9BxB,MAAAA,KAAQ1B,EAAU6hD,MAAMkjD,iBAAiBjpF,EAAO5Y,IAAIu/F,CAGrD/gG;AAAAA,IAAAA,KAAO,kBAGP1B,EAAU6J,KAAmB,aAAE,CAAGiE,EAAAA,YAAYpM,GAC9C1B,EAAU6J,KAAmB,aAAE,GAAGm5D,UAAUv5C,YAAYzpB,EAAU6hD,MAAMwhD,kBAAgB;AAExF,QAAI9wF,IAAEvS,EAAU6J,KAAmB,aAAE,CAAA,EAAGivB,qBAAqB,IAE7D94B;AACA,SADAA,EAAU0lC,YAAU,CACpB,GAASxiC,IAAE,GAAGA,IAAIqP,EAAEpP,QAAQD;AAC3BlD,QAAU0lC,UAAUxiC,CAAGqP,IAAAA,EAAErP;EAG3B,GAEAlD,EAAU6hD,MAAMmjD,kBAAkB,SAAS5kG,GAAO6kD,GAAAA;AACjD,QACIvkD,IAAWV,EAAU4E,SAAWL,EAAAA;AAWpC,WATG0gD,EAAO/rB,WACD+rB,EAAO/rB,SAAS94B,EAAMmB,YAAYnB,EAAMoB,UAAUpB,KAClD6kD,EAAOhiD,MAAM,SACbjD,EAAUya,UAAU/Z,IAAW,YAAcN,EAAAA,EAAMmB,YAAYnB,EAAMoB,UAAUpB,CAAAA,IAC/E6kD,EAAOhiD,MAAM,gBAAgBgiD,EAAOhiD,MAAM,aAC1CjD,EAAUya,UAAU/Z,IAAW,cAAgBN,EAAAA,EAAM6kD,EAAOhiD,EAAAA,CAAAA,IAE5DjD,EAAUya,UAAU/Z,IAAW,UAAUukD,EAAOhiD,IAAI7C;EAG9D,GAEAJ,EAAU6hD,MAAMkjD,mBAAmB,SAASh/F,GAAI08F;AAE/C,QAAIp6D,IAAS;AACVtiC,IAAAA,EAAGg6D,SACL13B,EAAO1lC,KAAK,sCAAoCoD,EAAGg6D,KAAAA,GACjDh6D,EAAGu6D,aACLj4B,EAAO1lC,KAAK,iCAA+BoD,EAAGu6D,SAC5Cv6D,GAAAA,EAAG85D,eACLx3B,EAAO1lC,KAAKoD,EAAG85D,WAAAA,GACb7/D,EAAUyiG,CAAAA,EAAoB,aAC/Bp6D,EAAO1lC,KAAK,YAAU3C,EAAUyiG,CAAAA,EAAoB,YAAI,IAE1D;AAAA,QAAIxhG,IAAQ;AACTonC,IAAAA,EAAOllC,WACTlC,IAAQ,YAAUonC,EAAO56B,KAAK,GAAK,IAAA;AAGpC,QAAI6zD,IAAUthE,EAAUyiG,CAASnhC,EAAAA,SAC7ByxB,IAAW/yF,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE;AACxE/F,MAAU4E,SAAAA,EAAWo/C,aAAaj+C,EAAG9C,OACvC8vF,KAAY;AASb,aAJIrxF,IAAM,SAFQ1B,EAAU66B,SAASo3B,kBAAkBlsD,CAAAA,IAE1B,4BAA0BgtF,IAAU,MAAIA,IAAS,MAAI,iBAAehtF,EAAG9C,KAAG,OAAKjD,EAAUM,OAAO0C,kBAAgB,OAAK+C,EAAG9C,KAAG,OAAOhC,IAAQ,KAGnKgkG,IAAc,CAAC,cAAc,kBAAkB,gBAAe,kBAC1D/hG,IAAG,GAAGA,IAAIo+D,EAAQn+D,QAAQD,KAAI;AACrC,UAAIsV,IAAQxY,EAAU6hD,MAAMmjD,gBAAgBj/F,GAAIu7D,EAAQp+D,CAAAA,CAAAA,GACpDgiG,IAAoBllG,EAAU66B,SAASq3B,mBAAmBnsD,GAAIu7D,EAAQp+D,CAAAA,GAAIsV,IAE1EmsF,IAAa3kG,EAAU6hD,MAAM6iD,WAAWpjC,EAAQp+D,CAAI+hG,GAAAA,CAAAA,GAEpDn2F,IAAYwyD,EAAQp+D,GAAGzB,MAAO,aAAY6/D,EAAQp+D,CAAGzB,EAAAA,MAAI,MAAQ;AAErEC,MAAAA,KAAO,SAAOwjG,IAAkB,mBAAmB5jC,EAAQp+D,WAAW,QAAMyhG,EAAWl3F,KAAK,GAAA,IAAK,OAAKqB,IAAU,MAAI0J,IAAM;AAAA,IAE1H;AAGD,WAFA9W,KAAM;AAAA,EAGP,GAEA1B,EAAU6hD,MAAM2iD,qBAAqB,SAAS/B,GAQ7C;AAAA,aAPIz6E,IAAO,+BAEPs5C,IAAUthE,EAAUyiG,CAAAA,EAASnhC,SAC7B6jC,IAAS,CAAA,GAETC,IAAkB9jC,EAAQn+D,QAC1BkiG,IAAcrlG,EAAU63B,KAAKlW,cAAc,IAAE2/C,EAAQn+D,SAAQ,IACzD0jB,IAAI,GAAGA,IAAMy6C,EAAQn+D,QAAQ0jB,KAAM;AAE1C,UAAIyoB,IAAgC,IAA1BgyB,EAAQz6C,CAAAA,EAAK+7E;AACnBt7E,YAAMgoB,CAAAA,KAAQgyB,EAAQz6C,CAAAA,EAAK+7E,iBAAiB,MAAMthC,EAAQz6C,CAAAA,EAAK+7E,iBAAiB,QAAethC,OAAAA,EAAQz6C,GAAK+7E,gBAAgB,YAM/HuC,EAAOt+E,KAAO,QAJdu+E,KACAC,KAAe/1D,GACf61D,EAAOt+E,CAAAA,IAAOyoB;AAAAA,IAIf;AAID,aAFIg2D,IAAgBl2F,KAAK+D,MAAMkyF,IAAcD,CAAAA,GACzCH,IAAc,CAAC,cAAe,gBAAe,kBACzC/hG,IAAE,GAAGA,IAAIo+D,EAAQn+D,QAAQD,KAAI;AACpC,UAAIqiG,IAAgBJ,EAAOjiG,CAAqBiiG,IAAAA,EAAOjiG,KAAvBoiG;AAChChkC,MAAAA,EAAQp+D,GAAG8L,QAAQu2F;AACnB,UAAIZ,IAAa3kG,EAAU6hD,MAAM6iD,WAAWpjC,EAAQp+D,CAAAA,GAAI+hG;AACxDj9E,MAAAA,KAAQ,4DAA0DhoB,EAAU+gB,GAAGqhC,eAAa,cAAakf,EAAQp+D,CAAAA,EAAQ,QAAE,QAAMyhG,EAAWl3F,KAAK,OAAK,QAAQ6zD,EAAQp+D,CAAG8wB,EAAAA,UAAUoT,SAAYk6B,EAAQp+D,CAAGD,EAAAA,KAAKq+D,EAAQp+D,CAAAA,EAAG8wB,SAAS;AAAA,IACnO;AAGD,WAFAhM,KAAO;AAAA,EAGR;AAGA,GZlfCw9E,gBavDc,SAASxlG,GAAAA;AAExBA,IAAUsE,YAAY,oBAAmB,WAAA;AAExC,aADI8G,IAAMwC,SAASmJ,KAAK+hB,qBAAqB,QACpC51B,IAAE,GAAGA,IAAIkI,EAAIjI,QAAQD,KAAK;AAClC,UAAIw3C,IAAKtvC,EAAIlI,CAAG4L,EAAAA,aAAW;AAE3B,WADA4rC,IAAKA,EAAG/2C,MAAM,GAAA,GACPR,UAAU,KAAKu3C,EAAG,MAAM,YAAW;AACzC,YAAI7+B,IAAO,cAAazQ,EAAIlI,CAAG4K,EAAAA,aAAW,IAAI+J,QAAQ,OAAO,MAAQA,EAAAA,QAAQ,MAAK,KAAQA,EAAAA,QAAQ,YAAW,EAAI,IAAA;AACjHgE,QAAAA,IAAOw9E,SAASx9E,CAAMhE,EAAAA,QAAQ,wBAAuB,SAASysE,GAAIj3D;AACjE,iBAAO,UAAQA,IAAK;AAAA,QACxB,CAAA,GACGrtB,EAAUya,UAAUigC,EAAG,CAAA,CAAA,IAAI98B,SAAS,SAAQ,OAAM,MAAK/B,CACvDzQ,GAAAA,EAAIlI,GAAGjC,MAAMkgB,UAAQ;AAAA,MACrB;AAAA,IACD;AAAA,EACF;AAEA,GbsCC2pD,ScpCc,SAAS9qE,GAyCtB;AAAA,WAASylG,EAASlhG,GACjB;AAAA,QAAImhG,IAAS,EACZC,eAAgB3lG,EAAUwqE,oBAAoByC,eAC9C24B,aAAc5lG,EAAUwqE,oBAAoB0C,aAC5CltE,WAAYA,EAAUwqE,oBAAoBq7B,eAC1CrgD,UAAYxlD,EAAUwqE,oBAAoBs7B,UAC1CC,UAAY/lG,EAAUwqE,oBAAoBgD,UAC1CptE,OAASJ,EAAUwqE,oBAAoB+C,MAAAA,GAGpCy4B,IAAY,CAAA;AAChB,aAAQ9iG,KAAKwiG;AACZM,MAAAA,EAAU9iG,EAAE8gB,YAAAA,CAAAA,IAAiB0hF,EAAOxiG,CAIrC;AAAA,WAAO8iG,EAFPzhG,KAAQA,IAAO,IAAIyf,kBAEO0hF,EAAO1lG;AAAAA,EACjC;AAzDDA,IAAUM,OAAOwqE,cACjB9qE,EAAUM,OAAO2lG,eAAe,IAChCjmG,EAAUkmG,cAAc,SAASC,GAAUzsF,GAAS0sF,GACnD;AAAA,QAAIC,IAAcZ,EAASW,CAAAA;AACxBC,IAAAA,KACFA,EAAYxoF,UAAU1E,KAAKgtF,GAAUzsF,CAEzC;AAAA,EAAA,GAEE1Z,EAAUsmG,qBAAqB,SAASH,GAAUC,GACjD;AAAA,QAAIC,IAAcZ,EAASW,CAC3B;AAAA,QAAGC,GAAY;AACd,UAAIE,IAAWvmG,EAAUwqE,oBAAoBg8B,UAAUrvF,MAAMgvF,CAAAA;AAC7D,UAAGI,EAASpjG;AACX,eAAOkjG,EAAYxoF,UAAU4oF,YAAYF,EAAS,CAEnD,CAAA;AAAA,IAAA;AAAA,EACJ,GAEEvmG,EAAU0mG,iBAAiB,SAASP,GAAUC,GAC7C;AAAA,QAAIC,IAAcZ,EAASW,CAAAA;AACxBC,IAAAA,KACFA,EAAYxoF,UAAU8oF,OAAOR,CAEjC;AAAA,EAAA,GAEEnmG,EAAUq5B,QAAQ,WACjB;AAAA,QAAIr5B,EAAUM,OAAOwqE,SAArB;AAGA,UAAI87B,IAAO5mG,EAAUwqE,oBAAoBc;AACzCs7B,QAAK/5B,OAAAA;AACL,UAAIE,IAAa65B,EAAKx6B,cAClBW;AAAAA,OAAAA,KAAcA,aAAsB/sE,EAAUwqE,oBAAoByC,iBAAiBF,aAAsB/sE,EAAUwqE,oBAAoB0C,cAC1I05B,EAAKC,eAAAA,IAELD,EAAK17E,UAAU07E,EAAKx6B;IAPpB;AAAA,EASJ,GAqBEpsE,EAAUwqE,sBAAsB,IAEhCxqE,EAAU8mG,WAAW,WAAA;AAGpB,aAFIv/B,IAAQ17D,MAAMgS,UAAU9R,MAAMwI,KAAKlC,WAAW,CAAA,GAC9CjL,IAAM,CAAA,GACFlE,IAAI,GAAGA,IAAIqkE,EAAMpkE,QAAQD,KAAI;AACpC,UAAIR,IAAM6kE,EAAMrkE,CAKhB;AAAA,eAAQwF,YAJEhG,KAAO,eAChBA,IAAM,IAAIA,MAGEA;AACZ0E,QAAAA,EAAIsB,CAAKhG,IAAAA,EAAIgG;IAEd;AACD,WAAOtB;AAAAA,EACV,GChGe,SAASpH;AAExBA,IAAAA,EAAUwqE,oBAAoBg8B,YAAY,EACzCO,eAAe,WACd;AAAA,aAAO,EACNC,WAAU,EACTr4E,OAAS,IACTs4E,SACAC,MAAAA,IACAC,MAAQ,GAAA,GAEThoE,SAAS,KAAA;AAAA,IAEV,GACDhoB,OAAO,SAASgvF,GAIf;AAAA,eAHII,IAAW,CAAA,GAEXa,IAAO99F,KAAK+9F,eAAe/9F,KAAK4c,KAAKigF,CACjCjjG,CAAAA,GAAAA,IAAI,GAAGA,IAAIkkG,EAAKjkG,QAAQD,KAAI;AAKnC,iBAJIokG,IAAQh+F,KAAKi+F,SAASH,EAAKlkG,CAAAA,CAAAA,GAE3BskG,IAAUl+F,KAAKy9F,cAAAA,GAEXlzE,IAAI,GAAGA,IAAIyzE,EAAMnkG,QAAQ0wB;AAC7BvqB,eAAKm+F,YAAYH,EAAMzzE,CAAAA,CAAAA,IACzB2zE,EAAQR,UAAUM,EAAMzzE,WAChBvqB,KAAKo+F,YAAYJ,EAAMzzE,CAAAA,CAAAA,IAC/B2zE,EAAQroE,UAAU71B,KAAKo+F,YAAYJ,EAAMzzE,CAEzC2zE,CAAAA,IAAAA,EAAQroE,UAAUmoE,EAAMzzE,CAAAA,EAAG8zE,WAAW,CAIxCpB;AAAAA,QAAAA,EAAS5jG,KAAK6kG,CAAAA;AAAAA,MACd;AACD,aAAOjB;AAAAA,IACP,GAEDqB,qBAAqB,SAASC,GAC7B;AAAA,UAAIL,IAAUl+F,KAAKy9F,cAAAA;AACnBS,MAAAA,EAAQR,UAAUr4E,QAAAA,CAAAA,CAAUk5E,EAASzoE,UACrCooE,EAAQR,UAAUC,MAAQY,CAAAA,CAAAA,EAASC,QACnCN,EAAQR,UAAUE,OAASW,CAAAA,CAAAA,EAAS77B,SACpCw7B,EAAQR,UAAUG,OAASU,CAAAA,CAAAA,EAAS57B,SACpCu7B,EAAQroE,UAAU0oE,EAASt7D,SAASs7D,EAAS1oE,SAE1CqoE,EAAQroE,WAAW,MAAMqoE,EAAQroE,WAAW,QAE9CqoE,EAAQroE,WAAW;AAGpB,UAAI4oE,IAAerkG,OAAOskG,aAAaR,EAAQroE,OAI/C;AAAA,aAHG4oE,MACFP,EAAQroE,UAAU4oE,EAAa/jF,YAAc2jF,EAAAA,WAAW,KAElDH;AAAAA,IACP,GAEDS,kBAAkB,SAASJ,GAC1B;AAAA,aAAOv+F,KAAK4+F,QAAQ5+F,KAAKs+F,oBAAoBC,CAC7C,CAAA;AAAA,IAAA,GAEDK,SAAS,SAASV,GAAAA;AACjB,UAAIjgC,IAAQ,CACZ;AAAA,eAAQrkE,KAAKskG,EAAQR;AACjBQ,QAAAA,EAAQR,UAAU9jG,MACpBqkE,EAAM5kE,KAAKO,CAKb;AAAA,aAFAqkE,EAAM5kE,KAAK6kG,EAAQroE,OAEZooC,GAAAA,EAAM95D,KAAKnE,KAAK6+F,YAAAA;AAAAA,IACvB,GAEDd,gBAAgB,SAASlB,GACxB;AAAA,aAAOA,EAASxiG,MAAM2F,KAAK6+F,YAC3B;AAAA,IAAA,GACDZ,UAAU,SAASa,GAAAA;AAClB,aAAOA,EAAKzkG,MAAM2F,KAAK++F,eACvB;AAAA,IAAA,GACDniF,MAAM,SAASigF,GAAAA;AACd,aAAOA,EAAStuF,QAAQ,OAAO,EAC/B;AAAA,IAAA,GACDswF,cAAa,KACbE,iBAAgB,KAChBZ,aAAY,EACX94E,OAAS,IACTs4E,KAAO,IACPC,MAAQ,IACRC,MAAAA,GAEDO,GAAAA,aAAY,EACXY,WAAa,GACb3+D,KAAO,GACP4+D,OAAS,IACTC,KAAO,IACPC,OAAS,IACTC,IAAM,IACNC,MAAQ,IACRxnG,MAAQ,IACR4lB,OAAS,IACT6hF,MAAQ,IACR17F,KAAO,IACP27F,QAAU,IACVC,UAAY,IACZv2D,QAAU,IACVw2D,QAAU,IACVC,MAAO,KACPC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,IAAM,KACNC,KAAO,KACPC,KAAO,KACPC,KAAO,IAAA,EAAA;AAAA,EAIT,EDzBqB5pG,CAAAA,GElGN,SAASA,GAExBA;AAAAA,IAAAA,EAAUwqE,oBAAoBq/B,eAAe,EAC5CC,WAAW,MACXrD,aAAa,SAASe;AACjBl+F,WAAKwgG,cAAWxgG,KAAKwgG,YAAY,CAAA;AACrC,UACIzwC,IADYr5D,EAAUwqE,oBAAoBg8B,UACzB0B,QAAQV;AAE7B,aAAOl+F,KAAKwgG,UAAUzwC,CACtB;AAAA,IAAA,GAED0wC,UAAU,SAASvC,GAAShjG,GAAAA;AAC3B,UAAIkV,IAAUpQ,KAAKm9F,YAAYe,CAC5B9tF;AAAAA,MAAAA,MACFA,EAAQnF,KAAKjL,MAAM9E,CAEfA,GAAAA,EAAE28B,iBAAgB38B,EAAE28B,mBACnB38B,EAAEwlG,cAAAA;AAAAA,IAGR,GACD7wF,MAAM,SAASgtF,GAAUzsF,GAAAA;AACpBpQ,WAAKwgG,cAAWxgG,KAAKwgG,YAAY,CAAA;AAKrC,eAHItD,IAAYxmG,EAAUwqE,oBAAoBg8B,WAE1CD,IAAWC,EAAUrvF,MAAMgvF,CACvBjjG,GAAAA,IAAI,GAAGA,IAAIqjG,EAASpjG,QAAQD;AACnCoG,aAAKwgG,UAAUtD,EAAU0B,QAAQ3B,EAASrjG,CAAAA,CAAAA,CAAAA,IAAOwW;AAAAA,IAElD,GACDitF,QAAQ,SAASR,GAAAA;AAIhB,eAHIK,IAAYxmG,EAAUwqE,oBAAoBg8B,WAE1CD,IAAWC,EAAUrvF,MAAMgvF,CAAAA,GACvBjjG,IAAI,GAAGA,IAAIqjG,EAASpjG,QAAQD;AAChCoG,aAAKwgG,UAAUtD,EAAU0B,QAAQ3B,EAASrjG,CACrCoG,CAAAA,CAAAA,KAAAA,OAAAA,KAAKwgG,UAAUtD,EAAU0B,QAAQ3B,EAASrjG,CAGnD,CAAA,CAAA;AAAA,IAAA,GAED+mG,SAAS,SAASpmG,GAAAA;AACjB,eAAQX,KAAKW;AACZyF,aAAK6P,KAAKjW,GAAGW,EAAIX,CAAAA,CAAAA;AAAAA,IAElB,GACDgnG,UAAU,WAAA;AACL5gG,WAAKwgG,cACRxgG,KAAKwgG,YAAY,KACfxgG,KAAK+1B,QACP/1B,KAAK2gG,QAAQ3gG,KAAK+1B,IAEnB;AAAA,IAAA,EAAA;AAAA,EAGF,EF0Cer/B,CGnGA,GAAA,SAASA;AAGvBA,IAAAA,EAAUwqE,oBAAoBhgD,oBAAoBxqB,EAAUq0D,oBAE5Dr0D,EAAUwqE,oBAAoBF,YAAY,SAAmB7nD,GAAMje,GAClE;AAAA,UAAGA,EAAE26B,WAAW;AAAG;AAKnB,eAOegrE,GAVXl8D,IAAYjuC,EAAUwqE,oBAAoBhgD,kBAAkB/H,CAAAA,GAC5D2nF,IAAex8F,SAASmd,eACxBs/E,QACInnG,IAAI,GAAGA,IAAI+qC,EAAU9qC,QAAQD;AACpC,YAAG+qC,EAAU/qC,MAAMknG,GAAa;AAC/BC,UAAAA,IAAennG;AACf;AAAA,QACA;AAIF,UAAGsB,EAAE46B;AAOJ,YADA+qE,IAAWl8D,EAFEo8D,KAAgB,IAAMp8D,EAAU9qC,SAAS,IAAMknG,IAAe;AAM1E,iBAFAF,EAAS9wE,MACT70B,GAAAA,EAAE28B,eACK,GAAA;AAAA,iBAORgpE,IAAWl8D,EADEo8D,KAAgBp8D,EAAU9qC,SAAS,IAAK,IAAKknG,IAAe,CAKxE;AAAA,eAFAF,EAAS9wE,MAAAA,GACT70B,EAAE28B,eACK,GAAA;AAKT;IACF;AAAA,EAGA,EHmDmBnhC,CAAAA,GIpGJ,SAASA,GAAAA;AAExBA,IAAAA,EAAUwqE,oBAAoBr3B,SAAS,EACtC3uB,OAAO;AAEN,eADI3U,IAAO7P,EAAU8C,WAAWC,iBAAiB,iBAAA,GACzCG,IAAI,GAAGA,IAAI2M,EAAK1M,QAAQD;AAC/B2M,QAAAA,EAAK3M,CAAAA,EAAGqI,WAAWC,YAAYqE,EAAK3M,CAErC,CAAA;AAAA,IAAA,GACD2K,eAAe,WAAA;AACd,UAAI/J,IAAU8J,SAASC,cAAc,KAGrC;AAAA,aAFA/J,EAAQib,aAAa,YAAA,EACrBjb,GAAAA,EAAQgL,YAAY,kBACbhL;AAAAA,IACP,GAEDwmG,gBAAgB,SAASr9F,GAAOC,GAAK4J;AAIpC,eAHIjH,IAAO,CAAA,GACP06F,IAAe,IAAI/nG,KAAKyK,CACxBu9F,GAAAA,IAAa,IAAIhoG,KAAK4M,KAAKE,IAAIpC,EAAIzK,QAAAA,GAAWzC,EAAUgC,KAAKC,IAAIjC,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKyK,CAAS,CAAA,GAAA,GAAG,OAAOxK,QACpH8nG,CAAAA,CAAAA,GAAAA,EAAa9nG,QAAYyK,IAAAA,EAAIzK,QAElCoN;AAAAA,QAAAA,IAAOA,EAAKpG,OAAOqN,EAAOvC,KAAKjL,MAAMihG,GAAc,IAAI/nG,KAAK4M,KAAKE,IAAIk7F,EAAW/nG,QAAAA,GAAWyK,EAAIzK,QAC/F8nG,CAAAA,CAAAA,CAAAA,CAAAA,GAAAA,IAAevqG,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAIsoG,GAAc,GAAG,KAE5EC,CAAAA,GAAAA,IAAaxqG,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAIsoG,GAAc,GAAG,KAAA,CAAA,GAC1EC,IAAa,IAAIhoG,KAAK4M,KAAKE,IAAIk7F,EAAW/nG,QAAAA,GAAWyK,EAAIzK,QAG1D,CAAA,CAAA;AAAA,aAAOoN;AAAAA,IACP,GAGD+F,QAAQ,SAAS3I,GAAOC,GAAKlI,GAAAA;AAC5BsE,WAAKkb,MACL;AAAA,UAAI3U,IAAO,CAEPusC,GAAAA,IAAQp8C,EAAUwqE,oBAAoBgD,SAAS3vD,UAAU4sF;AAE7D,cADWzqG,EAAUwqE,oBAAoBgD,SAAS3vD,UAAU6sF;QAE3D,KAAKtuD,EAAMtpC;AACVjD,UAAAA,IAAOvG,KAAKqhG,qBAAqB19F,GAAOC,GAAKlI,CAAAA;AAC7C;AAAA,QACD,KAAKo3C,EAAMlY;AACVr0B,UAAAA,IAAOvG,KAAKshG,qBAAqB39F,GAAOC,GAAKlI,CAC7C;AAAA;AAAA,QACD,KAAKo3C,EAAMvc;AACVhwB,UAAAA,IAAOA,EAAKpG,OAAOH,KAAKghG,eAAer9F,GAAOC,GAAK5D,KAAKuhG,gBACxD,CAAA;AAAA;AAAA,QACD,KAAKzuD,EAAMxc;AACV/vB,UAAAA,IAAOvG,KAAKwhG,kBAAkB79F,GAAOC,CAAAA;AACrC;AAAA,QACD,KAAKkvC,EAAM2uD;AACVl7F,UAAAA,IAAOA,EAAKpG,OAAOH,KAAKghG,eAAer9F,GAAOC,GAAK5D,KAAK0hG,sBAAAA,CAAAA;AACxD;AAAA,QACD,KAAK5uD,EAAMt3B;AACVjV,UAAAA,IAAOvG,KAAK2hG,mBAAmBh+F,GAAOC,CACtC;AAAA;AAAA,QACD,KAAKkvC,EAAM8uD;AACVr7F,UAAAA,IAAOA,EAAKpG,OAAOH,KAAKghG,eAAer9F,GAAOC,GAAK5D,KAAKqhG,oBAI1DrhG,CAAAA;AAAAA,MAAAA;AAAAA,WAAK6hG,gBAAgBt7F,GAAM5C,GAAOC,GAAKlI,CACvCsE,GAAAA,KAAK8hG,kBAAkBv7F,GAAM5C,GAAOC,GAAKlI;AAEzC,eAAQ9B,IAAI2M,EAAK1M,SAAS,GAAGD,KAAK,GAAGA;AACpC,YAAG2M,EAAK3M,CAAAA,EAAGqgB;AACV,iBAAO1T,EAAK3M;AAId,aAAO;AAAA,IACP,GAEDkoG,mBAAmB,SAASv7F,GAAM5C,GAAOC,GAAKlI,GAAAA;AAM7C,eALIqmG,IAAYrrG,EAAUgC,KAAK0tB,YAAY1vB,EAAUM,OAAOy2D,QAAAA,GAExDllC,IAAOw5E,EAAUp+F,CACpB8kB,GAAAA,IAAKs5E,EAAUn+F,CAERhK,GAAAA,IAAI,GAAGA,IAAI2M,EAAK1M,QAAQD;AAC/B2M,QAAAA,EAAK3M,CAAG6b,EAAAA,aAAa,mBAAmB8S,CAAAA,GACxChiB,EAAK3M,CAAG6b,EAAAA,aAAa,iBAAiBgT,CACnC/sB,GAAAA,KACF6K,EAAK3M,CAAG6b,EAAAA,aAAa,gBAAgB/Z,CAGvC;AAAA,IAAA,GAEDmmG,iBAAiB,SAASt7F,GAAM5C,GAAOC,GAAKlI,GAAAA;AAC3C,UAAIgvB,IAAQ,IAERzvB,IADQvE,EAAU4E,SACLL,EAAAA,MAEb+mG;AAiBJ,UAfAt3E,KAASh0B,EAAUya,UAAU+rB,SAASv5B,CAElCjN,GAAAA,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKyK,IAAQxK,QAAawK,KAAAA,EAAMxK,cAChEuxB,KAAS,MAAMh0B,EAAUya,UAAU4uB,WAAWp8B,CAC9Cq+F,GAAAA,IAAAA,KAGGtrG,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKyK,CAAQxK,CAAAA,EAAAA,QAAAA,KAAazC,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAK0K,CAAMzK,CAAAA,EAAAA,QAAAA,MAElGuxB,KAAS,QAAQh0B,EAAUya,UAAU+rB,SAASt5B,CAAAA,IAC3Co+F,KAAkBtrG,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAK0K,CAAAA,CAAAA,EAAMzK,aAAayK,EAAIzK,QAAAA,OAC7EuxB,KAAS,MAAMh0B,EAAUya,UAAU4uB,WAAWn8B,CAAAA,KAI7ClI;AACF,YAAGhF,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CAAAA,GAAM;AAC7C,gBAAM2/B,IAAWlkC,EAAUuG,OAAOhC,CAAAA,GAC5BgnG,IAAgBrnE,EAASm0D,OAAOn0D,EAASj1B,MAAMjK,CACrDgvB,CAAAA;AAAAA,UAAAA,KAAS,OAAOh0B,EAAUya,UAAUlW,IAAO,cAAgBgnG,EAAAA,EAAcl4F,KAAKk4F,EAAcv3E,OAAOu3E;QACvG,WAAYvrG,EAAUsG,UAAUtG,EAAUsG,OAAO/B,CAAM,GAAA;AACnD,gBAAMuO,IAAQ9S,EAAUsG,OAAO/B,IACzBgnG,IAAgBz4F,EAAMlN,QAAQkN,EAAM7D,MAAMjK;AAEhDgvB,UAAAA,KAAS,OAAOh0B,EAAUya,UAAUlW,IAAO,aAAA,EAAegnG,EAAcl4F,KAAKk4F,EAAcv3E,OAAOu3E,CAClG;AAAA,QAAA;AAAA;AAIF,eAAQroG,IAAI,GAAGA,IAAI2M,EAAK1M,QAAQD;AAC/BlD,QAAAA,EAAU66B,SAASi2B,cAAcjhD,EAAK3M,CAAAA,GAAI,EACzC,cAAc8wB,GACd,aAAa,SAAA,CAAA;AAAA,IAGf,GAEDg3E,wBAAwB,SAASzpG,GAAYC,GAAAA;AAO5C,eANIqO,IAAO7P,EAAU8C,WAAWC,iBAAiB,oCAE7CR,GAAAA,IAAWvC,EAAUgC,KAAKY,WAAW,IAAIJ,KAAKxC,EAAU4E,SAAWuJ,EAAAA,QAAAA,CAAAA,GAEnEvM,QACA4pG,IAAaxrG,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKjB,CAC3C2B,CAAAA,GAAAA,IAAI,GAAGA,IAAI2M,EAAK1M,WACvBvB,KACG5B,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKD,IAAWE,QAAa+oG,KAAAA,EAAW/oG,YAFzCS;AAK9BX,QAAAA,IAAWvC,EAAUgC,KAAKC,IAAIM,GAAU,GAAG,KAAA;AAG7C,aAAGX,UAAoB0H,KAAKmiG,SAAS57F,EAAKjO,MACnC,CACP;AAAA,IAAA,GAED6pG,UAAU,SAASn9C,GAClB;AAAA,UAAInb,IAAS7pC,KAAKuE,cAAAA;AAMlB,aALAslC,EAAOlyC,MAAMC,MAAMotD,EAAKzlC,YAAY,MACpCsqB,EAAOlyC,MAAME,OAAOmtD,EAAKxlC,aAAa,MACtCqqB,EAAOlyC,MAAM+N,QAAQs/C,EAAK/qC,cAAc,MACxC4vB,EAAOlyC,MAAM8N,SAASu/C,EAAKjrC,eAAe,MAC1CirC,EAAKvgD,YAAYolC,CACV,GAAA,CAACA;IACR,GACD03D,kBAAkB,SAAStpG,GAAYC,GACtC;AAAA,UAAI8sD,IAAOtuD,EAAU0rG,eAAenqG;AACpC+sD,QAAKrtD,MAAM8J,WAAW;AACtB,UAAIooC,IAAS7pC,KAAKuE,cAMlB;AAAA,aALAslC,EAAOlyC,MAAMC,MAAM,OACnBiyC,EAAOlyC,MAAME,OAAO,OACpBgyC,EAAOlyC,MAAM+N,QAAQ,QACrBmkC,EAAOlyC,MAAM8N,SAAS,QACtBu/C,EAAKvgD,YAAYolC,CAAAA,GACV,CAACA,CACR;AAAA,IAAA,GAED83D,oBAAoB,SAAS1pG,GAAYC,GAAAA;AACxC,UAAImM,IAAQrE,KAAKuE;AAOjB,aANAF,EAAM1M,MAAM8N,SAAS,OACrBpB,EAAM1M,MAAM+N,QAAQ,QACpBrB,EAAM1M,MAAM0qG,UAAU,GACtBh+F,EAAM1M,MAAMC,MAAM,OAClByM,EAAM1M,MAAME,OAAO,OACnBnB,EAAU8C,WAAW4d,cAAc,eAAA,EAAiB3S,YAAYJ,CACzD,GAAA,CAACA;IACR,GAEDi9F,sBAAsB,SAASrpG,GAAYC,GAAUwD,GAAAA;AACpD,UAAI4mG,IAAY5rG,EAAU0M,WAAW,CAAE,GAAE1M,EAAUuG,OAAOvG,EAAU0K,KAChE6D,CAAAA,GAAAA,IAAQq9F,EAAUn9F;AAEtBm9F,MAAAA,EAAUjqG,iBAAiB;AAC3B,UAAIuM,IAAS,CAAA,GAETC,IAAW5M,IAAa,IAAIiB,KAAKjB,CAAAA,IAAcvB,EAAUkK,WACzDkE,IAAW5M,IAAW,IAAIgB,KAAKhB,CAAYxB,IAAAA,EAAUiK;AAOzD,UALGkE,EAAS1L,QAAYzC,IAAAA,EAAUkK,UAAUzH,QAAAA,MAC3C0L,IAAW,IAAI3L,KAAKxC,EAAUkK,SAC5BkE,IAAAA,EAAS3L,YAAYzC,EAAUiK,UAAUxH,QAC3C2L,MAAAA,IAAW,IAAI5L,KAAKxC,EAAUiK,SAE3B2hG,IAAAA,CAAAA,EAAU7pG;AAAU,eAAOmM;AAE/B,eAAQhL,IAAI,GAAGA,IAAI0oG,EAAU7pG,SAASoB,WAClCnD,EAAU6rG,mBAAmBD,EAAU7pG,SAASmB,CAAAA,CAAAA,GADNA;;AAI9C,UAAGA,KAAK0oG,EAAU7pG,SAASoB;AAC1B,eAAO+K;AAER,UAAIF,IAAOO,EAAMvJ,CAAAA;AAEjB,YAAMmJ,IAAW3M,KAAY4M,IAAW7M;AACvC,eAAO2M;AAER,UAAIP,IAAQrE,KAAKuE;AAEjB,UAAIi+F,GACAC;AAEJ,eAASpQ,EAAcr+E,GAAQ5Y,GAAAA;AAE9BA,QAAAA,EAAOoqB,QAAQ,IAEfpqB,EAAOu4C,YAAY3/B,EAAOJ,YAC1BxY,CAAAA,GAAAA,EAAOsqB,SAAS1R,EAAOH,SAAAA,CAAAA,GACvBzY,EAAOoqB,QAAQxR,EAAOzV,QAAAA,CAAAA;AAAAA,MACtB;AAED,UAAI7H,EAAUY,UAAU8E,MAGnB;AAEJ,cAAMsmG,IAAY,IAAIxpG,KAAKjB,CAAAA;AAC3Bo6F,QAAAA,EAAc37F,EAAUkK,WAAW8hG,CACnC;AAAA,cAAMpkD,IAAU,IAAIplD,KAAKhB;AACzBm6F,QAAAA,EAAc37F,EAAUkK,WAAW09C,CAAAA,GACnCkkD,IAAY9rG,EAAUisG,eAAe,EAAC1qG,YAAYyqG,SAAmBJ,CAAAA,GACrEG,IAAU/rG,EAAUisG,eAAe,EAAC1qG,YAAYqmD,EAAU,GAAA,IAAOgkD;MACjE;AAVAE,QAAAA,IAAY9rG,EAAUisG,eAAe,EAAC1qG,YAAYA,EAAa,GAAA,IAAOqqG,CACtEG,GAAAA,IAAU/rG,EAAUisG,eAAe,EAAC1qG,YAAYC,EAAAA,GAAAA,IAAkBoqG,CAWnE;AAAA,UAAI78F,IAAW68F,EAAUM,gBAAgBlnG,CAAS,IAAA,KAAO4mG,EAAU91E,KAAK,GAEpE50B,IAAM;AACNlB,MAAAA,EAAUmsG,UAAU,MAAA,MACvBjrG,IAAM8M,EAAK6a,WACXijF,KAAaF,EAAUzlE,IACvB4lE,KAAWH,EAAUzlE,IACrBn4B,IAAOhO,EAAU8C,WAAW4d,cAAc;AAI3C,UAAI1R,IAAQI,KAAKC,IAAI,GAAG08F,IAAUD,IAAY,CAC9C;AAAA,UAAI/uD,IAAY;AAWhB,aAVG/8C,EAAUM,OAAOsgC,QACnBmc,IAAY,UAEbpvC,EAAM1M,MAAMgzC,UAAU,UAAUllC,CAAAA,OAAaguC,KAAa+uD,CAAsB98F,aAAAA,CAAAA,WAAgB9N,QAE7F8M,MACFA,EAAKD,YAAYJ,CAAAA,GACjBO,EAAOvL,KAAKgL,KAGNO;AAAAA,IACP,GAEDk+F,iBAAiB,SAASpqG,GAAAA;AAIzB,eAHIa,IAAQ7C,EAAU8C,WAAWC,iBAAiB,iBAAA,GAE9C8M,IAAO,CACH3M,GAAAA,IAAI,GAAGA,IAAIL,EAAMM,QAAQD;AAChC2M,UAAKlN,KAAKE,EAAMK,CAAGqI,EAAAA,UAAAA;AAGpB,UAEI3J,IAAS,IACTyqG,IAAa,GACbC,IAAAA,IACA/pG,IALYvC,EAAUgC,KAAKY,WAAW,IAAIJ,KAAKxC,EAAU4E,SAAWuJ,EAAAA,QAAAA,CAAAA,GAMpEq9F,IAAaxrG,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKR;AACnD,WAAQkB,IAAI,GAAGA,IAAI2M,EAAK1M,WACvBvB,KAEG0qG,KAAY,KACdD,KACAC,IAAW,KAEXA,KAGEtsG,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKD,IAAWE,QAAa+oG,KAAAA,EAAW/oG,YAVzCS;AAa9BX,QAAAA,IAAWvC,EAAUgC,KAAKC,IAAIM,GAAU,GAAG,KAI7C;AAAA,UAAGX,KAAH;AACC,eAAO;AAGR,UAAIT,IAAOnB,EAAUulD,OAAO+mD,CACxBprG,GAAAA,IAAMlB,EAAUulD,OAAOE,QAAQ4mD,IAE/BhhG,IAAM/B,KAAKuE;AACfxC,MAAAA,EAAIpK,MAAMC,MAAMA,IAAM,MACtBmK,EAAIpK,MAAME,OAAOA,IAAO,MACxBkK,EAAIpK,MAAM+N,QAAQhP,EAAU2O,MAAM29F,CAAY,IAAA,MAC9CjhG,EAAIpK,MAAM8N,UAAW/O,EAAUulD,OAAOE,QAAQ4mD,IAAa,CAAA,IAAKnrG,KAAQlB,EAAUulD,OAAOx2C,UAAU;AAGnG,UAAIvI,IAAYxG,EAAU8C,WAAW4d,cAAc,kBAE/C6rF,IAAY/lG,EAAUka,cAAc,sBAMxC;AAAA,aALG6rF,EAAUpiF,cACZ3jB,EAAU4jB,aAAa/e,GAAKkhG,EAAUpiF,WAAAA,IAEtC3jB,EAAUuH,YAAY1C,CAAAA,GAEhBA;AAAAA,IACP,GACDy/F,mBAAmB,SAASvpG,GAAYC,GAGvC;AAAA,eAFI4F,IAAM,CAAA,GACN82C,IAAc38C,GACZ28C,EAAYz7C,YAAYjB,EAASiB,QAAAA;AACtC2E,UAAIzE,KAAK2G,KAAK8iG,gBAAgBluD,KAC9BA,IAAcl+C,EAAUgC,KAAKC,IAAIi8C,GAAa,GAAG,KAElD;AAAA,aAAO92C;AAAAA,IACP,GAEDujG,sBAAsB,SAASppG,GAAYC,GAAUwD,GAAAA;AACpD,UAAIpD,IAAQ5B,EAAUsK,kBAAkB/I,CAEpCsO,GAAAA,IAAO,CACP7B,GAAAA,IAAO,MAEP9F,IAAIlI,EAAUM;AAClB,UAAGN,EAAU4O,SAAShN,CAAAA;AAAQ,eAAOiO;AAErC,UAAI7P,EAAUsG,UAAUtG,EAAUsG,OAAOtG,EAAU0K,KAAU1F,KAAAA,GAAS;AACrE,YAAI0B,IAAO1G,EAAUsG,OAAOtG,EAAU0K,KACtC9I;AAAAA,QAAAA,IAAQ8E,EAAKuI,MAAMjK;AAEnB,YAAIkK,IAAcxI,EAAKuI,MAAMjK,CAAAA;AACxB0B,QAAAA,EAAKhB,OAAO,IAQhB9D,IAAQ5B,EAAUsK,kBAAkB/I,CAAAA,IAAc2N,KAPlDtN,IAAQsN,GACJxI,EAAKoE,QAASlJ,IAAQ8E,EAAKqE,WAASrE,EAAKoE,SAC5ClJ,IAAQ;AAAA,MAQV;AAED,YADAoM,IAAOhO,EAAUmP,cAAcvN,CACnBoM,MAAAA,EAAK0S,cAAc,iBAE9B;AAAA,eAAO9S,SAASC,cAAc,KAAA;AAG/B,UAAIZ,IAAQmC,KAAKC,IAA2B,KAAtB9N,EAAW4I,aAAgB5I,EAAWkK,WAAAA,GAA4B,KAAbvD,EAAEkC,UAGzE8C,GAAAA,IAAMkC,KAAKE,IAAyB,KAApB9N,EAAS2I,SAAgB3I,IAAAA,EAASiK,cAA2B,KAAZvD,EAAEmC,SAKvE;AAAA,UAAA,CAJI6C,KAAQlN,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKhB,CAAWiB,CAAAA,EAAAA,QAAAA,IAAYzC,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKjB,CAAakB,CAAAA,EAAAA,QAAAA,MACnHyK,IAAkB,KAAZhF,EAAEmC,YAGL6C,KAAOD;AACV,eAAO,CAGR;AAAA,UAAIU,IAAQrE,KAAKuE,cAGb0B,GAAAA,IAAmBvP,EAAUM,OAAOkP,eAAatH,EAAEmC,YAAY,GAC/DoF,IAAU;AAMd,aALA9B,EAAM1M,MAAMC,MAAOkO,KAAKM,OAAa,KAANzC,IAAS,MAAKjN,EAAUM,OAAO8J,aAAWqF,KAASzP,EAAUM,OAAOkP,eAAaC,CAAWF,IAAAA,IAAoB,MAC/I5B,EAAM1M,MAAMurG,aAAa7+F,EAAM1M,MAAM8N,SAASK,KAAKC,IAAKD,KAAKM,MAAmB,MAAXxC,IAAID,KAAU,MAAMjN,EAAUM,OAAOkP,eAAaC,CAAAA,IAAYF,GAAkB,CAAG,IAAA,MACxJ5B,EAAM1M,MAAM+N,QAAQ,QACpBhB,EAAKD,YAAYJ,IACjBkC,EAAKlN,KAAKgL,IACHkC,EAAK,CAAA;AAAA,IAEZ,EAGF;AAAA,EAAA,EJnSS7P,CAAAA,GKrGM,SAASA,GAExBA;AAAAA,IAAAA,EAAUwqE,oBAAoBq7B,gBAAgB,WAAA;AAAA,OAE9C7lG,EAAUwqE,oBAAoBq7B,cAAchoF,YAAY7d,EAAU8mG,SACjE9mG,EAAUwqE,oBAAoBq/B,cAC9B,EACC4C,gBAAgB,WAAA;AACf,UAAInmF,IAAO,IAAItmB,EAAUwqE,oBAAoBgD;AAK7C,aAHIlnD,EAAK0mD,QACR1mD,MAAAA,IAAOA,EAAKsb,SAENtb,IAAAA;AAAAA,IACP,GAEDmkF,QAAO,EACN7qE,OAAO,SACPC,MAAM,QACNqrE,YAAY,cACZhnE,UAAS,YACTpxB,OAAM,SACNi4F,YAAY,cACZjmF,MAAM,OAEPmqE,GAAAA,SAAS,WACR;AAAA,UAEI1qF,IAFQvE,EAAU4E,SAAAA,EAELL;AACjB,aAAIvE,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CACjC+E,IAAAA,KAAKmhG,OAAOvmE,WACTlkC,EAAUsG,UAAUtG,EAAUsG,OAAO/B,CACxC+E,IAAAA,KAAKmhG,OAAO33F,QACXvO,KAAQ,UACT+E,KAAKmhG,OAAO7qE,QACXr7B,KAAQ,SACT+E,KAAKmhG,OAAO5qE,OACXt7B,KAAQ,gBACT+E,KAAKmhG,OAAOM,aACXxmG,KAAQ,SAASA,KAAQ,YAAavE,EAAU6hD,SAAS7hD,EAAU,UAAUuE,KAC9E+E,KAAKmhG,OAAO3lF,OAEZxb,KAAKmhG,OAAOS;AAAAA,IAEpB,GAED7xE,OAAO,WAAA;AACNr5B,MAAAA,EAAUq5B,MACV;AAAA,IAAA,GAEDqzE,MAAM,WAEL;AAAA,IAAA,GAED5O,SAAS,WAAA;AACR99F,MAAAA,EAAU8C,WAAWic,aAAa,YAAY,GAAA;AAAA,IAC9C,GACD8tD,QAAQ,WAAA;AACJ7sE,MAAAA,EAAU8C,cACZ9C,EAAU8C,WAAW6qE,gBAAgB,UACtC;AAAA,IAAA,GACDttE,WAAW,WACV;AAAA,aAAOL,EAAU8C,WAAWglB,aAAa;IACzC,GAGD6kF,gBAAgB,SAASxqF,GAAGC,GAC3B;AAAA,aAAID,EAAE5gB,WAAWkB,QAAAA,KAAa2f,EAAE7gB,WAAWkB,QAAAA,IACnC0f,EAAElf,KAAKmf,EAAEnf,KAAK,IAAA,KACfkf,EAAE5gB,WAAWkB,QAAY2f,IAAAA,EAAE7gB,WAAWkB,QAAY,IAAA,IAAA;AAAA,IACzD,GAEDmqG,YAAY,SAAS/6E,GAAME,GAAI86E,GAAS5iE;AACvC,UAAI9P,IAAQn6B,EAAU4E,SACtBitB;AAAAA,MAAAA,IAAO,IAAIrvB,KAAK4M,KAAKC,IAAI8qB,EAAMhsB,SAAS1L,QAAAA,GAAWovB,EAAKpvB,QACxDsvB,CAAAA,CAAAA,GAAAA,IAAK,IAAIvvB,KAAK4M,KAAKE,IAAI6qB,EAAM/rB,SAAS3L,QAAWsvB,GAAAA,EAAGtvB,QAEpD,CAAA,CAAA;AAAA,UAAI0F,IAAMnI,EAAUqkC,UAAUxS,GAAME,CACpC5pB;AAAAA,MAAAA,EAAIyiB,KAAKthB,KAAKqjG,cAAAA,GACX1iE,MACF9hC,IAAMA,EAAI8hC,QAAAA;AAIX,eADI/jB,IAAAA,CAAAA,CAAS2mF,GACL3pG,IAAG,GAAGA,IAAIiF,EAAIhF,UAAU+iB,GAAMhjB;AAClCiF,QAAAA,EAAIjF,CAAAA,EAAGD,MAAM4pG,MACf3mF,IAAAA,KAED/d,EAAIqJ,OAAOtO,GAAG,CACdA,GAAAA;AAGD,WAAQA,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAE9B,YADmB,IAAIlD,EAAUwqE,oBAAoB+C,MAAMplE,EAAIjF,CAAGD,EAAAA,EAAAA,EAClDgrE,QACf;AAAA,iBAAO9lE,EAAIjF,CAGb;AAAA,aAAO;AAAA,IACP,GAED4pG,kBAAkB,SAAS7pG,GAC1B;AAAA,UAAI8pE,IAAa/sE,EAAUwqE,oBAAoBc,WAAWyB,YAEtD8/B,IAAU5pG,KAAO8pE,KAAcA,EAAWhoD,SAE1CgoF,IAAY;AAChB,UAAGF,KAAW7sG,EAAUyE,SAASooG,CAAAA,GAAS;AACzC,YAAIG,IAAYhtG,EAAUyE,SAASooG,CAAAA;AAEnCE,QAAAA,IAAY/sG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAU+uF,WACjEI,EAAUzrG,YACVvB,EAAUgC,KAAKC,IAAI+qG,EAAUzrG,YAAY,GAAG,MAC5CyrG,GAAAA,EAAU/pG,MAIX;AAAA,MAAA;AACD,WAAI8pG,KAAc9pG,CAAAA,GAAG;AACpB,YAAIgqG,IAAejtG,EAAU4E,SAE7BmoG;AAAAA,QAAAA,IAAY/sG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAU+uF,WACjEK,EAAa9+F,UACbnO,EAAUgC,KAAKC,IAAIgrG,EAAa9+F,UAAU,GAAG,MAC7C,GAAA,MAAA,EAGD;AAAA,MAAA;AAED,UAAG4+F,GAAU;AAEZ,YAAIG,IAAS,IAAIltG,EAAUwqE,oBAAoB+C,MAAMw/B,EAAU9pG,EAAAA;AAC3DiqG,QAAAA,EAAOlgC,QAAAA,KAGPD,KAAYA,EAAW2/B,KAAAA,GAC1B1sG,EAAUwqE,oBAAoBc,WAAWoC,cAAcw/B,CAHvD5jG,KAAAA,KAAKwjG,iBAAiBC,EAAU9pG,EAKjC;AAAA,MAAA;AAAA,IACD,GAEDkqG,kBAAkB,SAASlqG;AAC1B,UAAI8pE,IAAa/sE,EAAUwqE,oBAAoBc,WAAWyB,YAEtD8/B,IAAU5pG,KAAO8pE,KAAcA,EAAWhoD,SAE1CgoF,IAAY;AAChB,UAAGF,KAAW7sG,EAAUyE,SAASooG,CAAAA,GAAS;AACzC,YAAIG,IAAYhtG,EAAUyE,SAASooG,CAEnCE;AAAAA,QAAAA,IAAY/sG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAU+uF,WACjE5sG,EAAUgC,KAAKC,IAAI+qG,EAAUxrG,UAAAA,IAAc,MAC3CwrG,GAAAA,EAAUxrG,UACVwrG,EAAU/pG,IAAAA;MAGX;AACD,UAAA,CAAI8pG,KAAc9pG,CAAAA,GAAG;AACpB,YAAIgqG,IAAejtG,EAAU4E,SAAAA;AAE7BmoG,QAAAA,IAAY/sG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAU+uF,WACjE5sG,EAAUgC,KAAKC,IAAIgrG,EAAa7+F,cAAc,MAAA,GAC9C6+F,EAAa7+F,UACb,MAAA;MAGD;AAED,UAAG2+F,GAAU;AACZ,YAAIG,IAAS,IAAIltG,EAAUwqE,oBAAoB+C,MAAMw/B,EAAU9pG,EAAAA;AAC3DiqG,QAAAA,EAAOlgC,QAGPD,KAAAA,KAAYA,EAAW2/B,KAAAA,GAC1B1sG,EAAUwqE,oBAAoBc,WAAWoC,cAAcw/B,CAAAA,KAHvD5jG,KAAK6jG,iBAAiBJ,EAAU9pG;MAKjC;AAAA,IACD,GAEDo8B,MAAM,EAEL,iEAAiE,SAAS76B;AACzE,UAAIolC,IAAO5pC,EAAUwqE,oBAAoB4iC,WAAWvvF,UAAUwvF,SAAS,+BAAA,GACnEh6F,IAAM7O,EAAE6O;AACD+zB,MAAR/zB,MAAQ+zB,WACV/zB,IAAM7O,EAAE26B,UAAU,KAEhByK,EAAS,IAAJv2B,IAAQ,CAAA,KACfu2B,EAAS,IAAJv2B,IAAQ,CAAA,EAAGgM;IAEjB,GAED,uBAAuB,SAAS7a,GAC/BxE;AAAAA,MAAAA,EAAU8kC,OAAOuB,oBACjB;AAAA,IAAA,GACD,yBAAyB,SAAS7hC,GACjCxE;AAAAA,MAAAA,EAAU8kC,OAAOsB,oBACjB;AAAA,IAAA,GACD,mBAAkB,SAAS5hC,GAAAA;AACXxE,MAAAA,EAAU8C,WAAW4d,cAAc,iBACzC+I,aAAa;AAAA,IACtB,GACD,uBAAuB,SAASjlB;AAChBxE,MAAAA,EAAU8C,WAAW4d,cAAc,eACzC+I,EAAAA,aAAa;AAAA,IACtB,GAGDjlB,GAAK,WAAA;AACJ8E,WAAKwjG,iBACL;AAAA,IAAA,GAEDlE,MAAQ,WACP5oG;AAAAA,MAAAA,EAAU6V,eAAe,oBAAIrT,MAAAA;AAAAA,IAC7B,GAED,WAAW,WACV8G;AAAAA,WAAK6jG;IACL,GAED,yBAAyB;AACxBntG,MAAAA,EAAU6T,YAAY,EAACtS,YAAY,IAAIiB,KAAKxC,EAAU4E,SAAW5C,EAAAA,IAAAA,EAAAA,CAAAA;AAAAA,IACjE,GAED,iBAAiB,SAASwC;AACzBxE,MAAAA,EAAUmsE,oBAAoB3nE;IAC9B,GACD,iBAAiB,SAASA,GAAAA;AACzBxE,MAAAA,EAAUmsE,oBAAoB3nE;IAC9B,GACD,iBAAiB,SAASA,GACzBxE;AAAAA,MAAAA,EAAUmsE,oBAAoB3nE,CAC9B;AAAA,IAAA,EAAA,EAAA,CAAA,GAMJxE,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUosF,QAAQjqG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUwhB,IAAAA;AAAAA,EAEpH,EL1IiBr/B,CAAAA,GMtGF,SAASA,GAAAA;AAExBA,IAAAA,EAAUwqE,oBAAoB8iC,aAAa;OAE3CttG,EAAUwqE,oBAAoB8iC,WAAWzvF,YAAY7d,EAAU8mG,SAC9D9mG,EAAUwqE,oBAAoBq/B,cAC9B,EACC78B,SAAS,WACR;AAAA,aAAA;AAAA,IACA,GACDprC,UAAU;AACT,aAAO;AAAA,IACP,GAED2rE,QAAQ,SAAUzpG,GAAAA;AACjB9D,MAAAA,EAAUwqE,oBAAoBc,WAAWoC,cAAc5pE,CACvD;AAAA,IAAA,GAED0pG,WAAW,SAASprF,GAAAA;AAEnB,UAAIA,CAAAA;AAAG,eAAO;AACd,eAAQlf,KAAKoG,MAAK;AACjB,YAAA,CAAA,CAAKA,KAAKpG,CAAQkf,KAAAA,CAAAA,CAAAA,EAAElf,CAAI;AAAA,iBAAA;AAExB,YAAIuqG,OAAsBnkG,KAAKpG,CAAAA,KAAAA,CAAMoG,KAAKpG,CAAGkW,EAAAA,WACzCs0F,OAAsBtrF,EAAElf,CAAAA,KAAAA,CAAMkf,EAAElf,CAAAA,EAAGkW;AACvC,YAAGs0F,KAAoBD;AAAkB,iBAAA;AACzC,YAAKC,KAAoBD;AAGxB,cAAGrrF,EAAElf,CAAGkW,EAAAA,SAAAA,KAAc9P,KAAKpG,CAAAA,EAAGkW;AAC7B,mBAAO;AAAA,mBAHLgJ,EAAElf,CAAAA,KAAMoG,KAAKpG,CAAI;AAAA,iBAAA;AAAA,MAKrB;AACD,aAAO;AAAA,IACP,GAED+qE,SAAS,WAAA;AAAA,IAAY,GACrB50C,OAAO,WAAA;AACN,UAAI/S,IAAOhd,KAAK2kE,QACb3nD;AAAAA,MAAAA,MACFA,EAAKvH,aAAa,YAAY,IAE3BuH,GAAAA,EAAK+S,SAAO/S,EAAK+S,MAAAA;AAAAA,IAGrB,GACDqzE,MAAM,WAAA;AACL,UAAIpmF,IAAOhd,KAAK2kE,QAAAA;AACb3nD,MAAAA,KACFA,EAAKvH,aAAa,YAAY,IAG/B;AAAA,IAAA,EAAA,CAAA;AAAA,EAKH,EN6CW/e,CAAAA,GOvGI,SAASA,GAExBA;AAAAA,IAAAA,EAAUwqE,oBAAoB4iC,aAAa,SAASxrG;AACnD0H,WAAK1H,QAAQA,KAAS;AAAA,IACvB,GAEA5B,EAAUwqE,oBAAoB4iC,WAAWvvF,YAAY7d,EAAU8mG,SAC9D9mG,EAAUwqE,oBAAoB8iC,YAC9B,EACCr/B,SAAS,SAASrsE,GAAAA;AACjBA,MAAAA,IAAQA,KAAS0H,KAAK1H,SAAS;AAC/B,UAAI6oB,IAAQnhB,KAAK+jG,SACjB;AAAA,UAAG5iF,EAAM7oB,CAAQ;AAAA,eAAO6oB,EAAM7oB,CAAAA;AAAAA,IAC9B,GAEDyrG,UAAU,SAAStjF,GAClBA;AAAAA,MAAAA,IAAWA,KAAY,CACrB,yCACA,yCACA,0CACA,+BAAA,EACCtc,KAAK,IAAA;AAER,UAAIgd,IAAQ5e,MAAMgS,UAAU9R,MAAMwI,KAAKvU,EAAU8C,WAAWC,iBAAiBgnB,CAI7E,CAAA;AAAA,aAHAU,EAAMG,KAAK,SAASzI,GAAGC;AACtB,eAAOD,EAAE2G,aAAa1G,EAAE0G;AAAAA,MAC5B,IACU2B;AAAAA,IACP,GAEDq/E,WAAU,MAEV98B,SAAS,WAAA;AACR,eAAS1jE,KAAK2kE,QAAQ3kE,KAAK1H,KAC3B;AAAA,IAAA,GACDggC,UAAS,WACR;AAAA,UAAI+rE,IAAcrkG,KAAK2kE,QAAQ,CAAA;AAI/B,aAHI0/B,MACHA,IAAc,IAAI3tG,EAAUwqE,oBAAoBgD,aAE1CmgC;AAAAA,IACP,GAEDtuE,MAAM,EACLl+B,MAAQ;AACP,UAAIi8C,IAAW9zC,KAAK1H,QAAQ;AACzBw7C,MAAAA,IAAW,MACbA,IAAW9zC,KAAK+jG,SAAAA,EAAWlqG,SAAS,IAGrCmG,KAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoB4iC,WAAWhwD;IAEzD,GACDr2B,OAAS,WACR;AAAA,UAAIq2B,IAAW9zC,KAAK1H,QAAQ;AACzBw7C,MAAAA,KAAY9zC,KAAK+jG,SAAWlqG,EAAAA,WAC9Bi6C,IAAW,IAGZ9zC,KAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoB4iC,WAAWhwD,CACzD,CAAA;AAAA,IAAA,GACDurD,MAAQ,WACPr/F;AAAAA,WAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoBgD,UAAAA;AAAAA,IAC9C,GAED+6B,OAAS;AACR,UAAIjiF,IAAOhd,KAAK2kE,QACb3nD;AAAAA,MAAAA,KACFA,EAAKjH,MAEN;AAAA,IAAA,EAAA,EAAA,CAAA,GAKJrf,EAAUwqE,oBAAoB4iC,WAAWvvF,UAAUosF,QAAQjqG,EAAUwqE,oBAAoB4iC,WAAWvvF,UAAUwhB,IAAAA;AAAAA,EAE9G,EP2Bcr/B,CAAAA,GQxGC,SAASA,GAAAA;AAExBA,IAAAA,EAAUwqE,oBAAoB+C,QAAQ,SAAStqE,GAAAA;AAE9C,UADAqG,KAAKyb,UAAU,MACZ/kB,EAAUyE,SAASxB,CAAI,GAAA;AACzB,YAAI8C,IAAK/F,EAAUyE,SAASxB,CAAAA;AAC5BqG,aAAK2D,QAAQ,IAAIzK,KAAKuD,EAAGxE,UAAAA,GACzB+H,KAAK4D,MAAM,IAAI1K,KAAKuD,EAAGvE,QAAAA,GAEvB8H,KAAKtE,UAAUsE,KAAKskG,YAAY7nG,CAChCuD,GAAAA,KAAKyb,UAAU9hB;AAAAA,MACf;AAAA,IACF,GAEAjD,EAAUwqE,oBAAoB+C,MAAM1vD,YAAY7d,EAAU8mG,SACzD9mG,EAAUwqE,oBAAoB8iC,YAC9B,EACCO,WAAW,WACV;AAAA,aAAOhiG,MAAMgS,UAAU9R,MAAMwI,KAAKvU,EAAU8C,WAAWC,iBAAiB,MAAI/C,EAAUM,OAAO0C,kBAAgB,GAC7G,CAAA;AAAA,IAAA,GAEDynG,QAAQzqG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAU4sF,QAE9Dxb,SAASjvF,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUoxE,SAE/D6a,WAAW,MACX98B,SAAS,WAAA;AACR,gBAAUhtE,EAAUyE,SAAS6E,KAAKyb,OAAYzb,KAAAA,CAAAA,KAAK2kE,QACnD;AAAA,IAAA,GACDrsC,UAAU,WAAA;AACT,UAAIzhC,IAAYmJ,KAAKukG,YAAY,CAC7BC,GAAAA,IAAiB;AACrB,UAAI3tG,KAAeH,EAAUolC,cAAcjlC,CAEtC,GAAA;AACJ,YAAI8C,IAAKjD,EAAUolC,cAAcjlC,CACjC2tG;AAAAA,QAAAA,IAAiB,IAAI9tG,EAAUwqE,oBAAoB+C,MAAMtqE,CAAAA;AAAAA,MACzD;AAJA6qG,QAAAA,IAAiB,IAAI9tG,EAAUwqE,oBAAoBgD;AAMpD,aAAOsgC;AAAAA,IACP,GAEDC,oBAAoB,SAAU7oF,GAC7B;AAAA,UAAI8oF,IAAW9oF,EAAGgE,yBACd+kF,IAAWjuG,EAAU8C,WAAW4d,cAAc,eAAA,EAAiBwI;AAEnE,aAAG8kF,EAAAA,EAAS5iF,SAAS6iF,EAAS/sG,OAAO8sG,EAAS9sG,MAAM+sG,EAAS7iF;AAAAA,IAI7D,GAED6iD,SAAS,WAAA;AAER,UAAIigC,IAAa,MAAIluG,EAAUM,OAAO0C,kBAAgB,OAAKsG,KAAKyb,UAAQ,MAEpEopF,IAAenuG,EAAUwqE,oBAAoBc,WAAW8iC,gBAAgB9kG,KAAKyb,OACjF;AAAA,UAAGopF;AACF,eAAOA;AAEP,UAAGnuG,EAAU0rE,uBAAuB1rE,EAAU0rE,oBAAoB1rE,EAAUyE,SAAS6E,KAAKyb,OAAU,CAAA,GAAA;AAEnG,iBADI0F,IAAQzqB,EAAU8C,WAAWC,iBAAiBmrG,CAC1ChrG,GAAAA,IAAI,GAAGA,IAAIunB,EAAMtnB,QAAQD;AAChC,cAAGoG,KAAKykG,mBAAmBtjF,EAAMvnB,CAAAA,CAAAA;AAChC,mBAAOunB,EAAMvnB,CAAAA;AAGf,eAAOunB,EAAM,CAAA;AAAA,MAClB;AACK,aAAOzqB,EAAU8C,WAAW4d,cAAcwtF,CAM5C;AAAA,IAAA,GAED70E,OAAO,WACN;AAAA,UAAIj5B,IAAQJ,EAAUyE,SAAS6E,KAAKyb,OAAAA,GAEhCpF,IAAW3f,EAAU4E;OACtBxE,EAAMmB,WAAWkB,YAAYkd,EAASvR,SAAS3L,aAAarC,EAAMoB,SAASiB,aAAakd,EAASxR,SAAS1L,cAC5GzC,EAAU6V,eAAezV,EAAMmB,UAGhC;AAAA,UAAI+kB,IAAOhd,KAAK2kE,QAAAA;AACZ3kE,WAAKykG,mBAAmBznF,CAC3BtmB,IAAAA,EAAUwqE,oBAAoBc,WAAWqB,oBAAmB;AAC3D3sE,QAAAA,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAUwb,MAAMntB,MAAM5C,IAAAA;AAAAA,MAC/D,GAAE6P,KAAK7P,SAERtJ,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAUwb,MAAMntB,MAAM5C,IAGhE;AAAA,IAAA,GACDojG,MAAM,WAAA;AACL1sG,MAAAA,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAU6uF,KAAKxgG,MAAM5C,IAC9D;AAAA,IAAA,GAGDskG,aAAa,SAAS7nG,GAAAA;AACrB,UAAIf,IAAU,MACVT,IAAOvE,EAAU4E,SAAWL,EAAAA;AAQhC,aAPGvE,EAAUuG,UAAUvG,EAAUuG,OAAOhC,CAAAA,IAEvCS,IAAUe,EADK/F,EAAUuG,OAAOvG,EAAU4E,SAAWL,EAAAA,IAAAA,EAC/BhB,cACdvD,EAAUsG,UAAUtG,EAAUsG,OAAO/B,CAAAA,MAE7CS,IAAUe,EADC/F,EAAUsG,OAAO/B,GACVf,MAEZwB,IAAAA;AAAAA,IACP,GACDqpG,aAAa,SAASr+C;AACrB,UAAIjqD,IAAK/F,EAAUyE,SAAS6E,KAAKyb,OAAAA;AACjC,UAAGhf,GAAG;AACL,YAAIf,IAASsE,KAAKskG,YAAY7nG,CAC1BuoG,GAAAA,IAAO,IAAItuG,EAAUwqE,oBAAoBgD,SAASznE,EAAGxE,YAAY,MAAMyD;AAC3EsE,aAAKikG,OAAOe,EAAK7gC,SAAS6gC,GAAMt+C,CACpC,CAAA;AAAA,MAAA;AACI1mD,aAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoBgD;IAE/C,GAEDnuC,MAAM,EACLl+B,MAAQ,WAAA;AACPmI,WAAK+kG,YAAY,MACjB;AAAA,IAAA,GAEDtnF,OAAS,WACRzd;AAAAA,WAAK+kG,YAAY,OACjB;AAAA,IAAA,GACD1F,MAAQ,WACJr/F;AAAAA,WAAK2lF,QAAa3lF,KAAAA,KAAKmhG,OAAO3lF,OAChC9kB,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUivF,iBAEtDxjG,IAAAA,KAAK+kG,YAAY,MAElB;AAAA,IAAA,GAED5F,OAAS,WAAA;AACR,UAAIniF,IAAOhd,KAAK2kE,QACb3nD;AAAAA,MAAAA,KAAQA,EAAKjH,QACfiH,EAAKjH,UAEL/V,KAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoBgD,UAAAA;AAAAA,IAG/C,GAEDk7B,IAAM,WAAA;AACFp/F,WAAK2lF,QAAa3lF,KAAAA,KAAKmhG,OAAO3lF,OAChC9kB,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUsvF,iBAAAA,IAEtD7jG,KAAK+kG,YAAY,IAAA;AAAA,IAElB,GAED97D,QAAU,WAAA;AACNvyC,MAAAA,EAAUyE,SAAS6E,KAAKyb,OAC1B/kB,IAAAA,EAAU8kC,OAAOhE,QAAgB,OAAEx3B,KAAKyb,OAAAA,IAExCzb,KAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoBgD,UAAAA;AAAAA,IAE/C,GAGD+6B,OAAS,WAAA;AACLvoG,MAAAA,EAAUyE,SAAS6E,KAAKyb,WAC1B/kB,EAAUu8B,aAAajzB,KAAKyb,OAE5Bzb,IAAAA,KAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoBgD;IAE/C,EAIJxtE,EAAAA,CAAAA,GAAAA,EAAUwqE,oBAAoB+C,MAAM1vD,UAAUosF,QAAQjqG,EAAUwqE,oBAAoB+C,MAAM1vD,UAAUwhB,IAEpG;AAAA,EAAA,ERzEQr/B,CSzGO,GAAA,SAASA;AAExBA,IAAAA,EAAUwqE,oBAAoBgD,WAAW,SAAS37C,GAAME,GAAI/sB,GAASupG,GACpE;AAAA,UAAIz+D,IAAQ9vC,EAAU4E,SAAAA,GAClBs/B,IAAWlkC,EAAUuG,UAAUvG,EAAUuG,OAAOupC,EAAMvrC,IAEtDstB;AAAAA,MAAAA,MACHA,IAAOvoB,KAAKklG,mBAGTz8E,MAGFA,IADEmS,IACGlkC,EAAUgC,KAAKC,IAAI4vB,GAAMqS,EAAS4hB,QAAQ5hB,EAAS6hB,MAEnD/lD,IAAAA,EAAUgC,KAAKC,IAAI4vB,GAAM7xB,EAAUM,OAAO2lG,cAAc,YAK/D38F,KAAKtE,UAAUA,KAAWsE,KAAKmlG,mBAC/BnlG,GAAAA,KAAK/H,aAAa,IAAIiB,KAAKqvB,IAC3BvoB,KAAK9H,WAAW,IAAIgB,KAAKuvB,CAAAA,GACzBzoB,KAAKilG,aAAaA,KAAc;AAAA,IACjC,GAEAvuG,EAAUwqE,oBAAoBgD,SAAS3vD,YAAY7d,EAAU8mG,SAC5D9mG,EAAUwqE,oBAAoB8iC,YAC9B,EACCxD,WAAU,MAEV0E,gBAAgB,WACf;AAAA,UAAI38E,GACAie,IAAQ9vC,EAAU4E,YAClB8pG,IAAc,IAAIlsG,KAAKstC,EAAM9tC,IACjC0sG;AAAAA,QAAYrgF,WAAW,CACvBqgF,GAAAA,EAAYpgF,gBAAgB,CAE5B;AAAA,UAAIqgF,IAAU,oBAAInsG;AAClBmsG,MAAAA,EAAQtgF,WAAW,CACnBsgF,GAAAA,EAAQrgF,gBAAgB,CAExB;AAAA,UAAI4V,IAAWlkC,EAAUuG,UAAUvG,EAAUuG,OAAOupC,EAAMvrC,IACtDqqG,GAAAA,IAAAA;AAKJ,UAJGF,EAAYjsG,QAAcksG,MAAAA,EAAQlsG,cACpCmsG,IAAc,KAGZ1qE;AACC0qE,QAAAA,KACC1qE,EAAS6hB,WAAW,SACtB4oD,EAAQ3lG,SAAS,IACjB2lG,EAAQ1lG,WAAW,MACXi7B,EAAS6hB,WAAW,UAC5B4oD,EAAQ1lG,WAAW,CAEpB4oB,GAAAA,IAAO88E,KAEP98E,IAAO7xB,EAAUgC,KAAKkiC,EAAS3rB,OAAO,QAAU,EAAA,IAAI/V,KAAKstC,EAAM9tC,IAAAA,CAAAA,GAGhE6vB,IAAOvoB,KAAKulG,kBAAkBh9E,CAAAA;AAAAA,eAE9BA,IAAO,IAAIrvB,KAAKxC,EAAU4E,SAAAA,EAAWuJ,WAClCygG,MACF/8E,IAAO88E,IAER98E,IAAOvoB,KAAKulG,kBAAkBh9E,IAC1B+8E,KACH/8E,EAAK7oB,SAAShJ,EAAUM,OAAO8J,cAG5BpK,EAAUyK,aAAY;AACzB,YAAIozC,IAAgB79C,EAAU8C,WAAW4d,cAAc;AACpDm9B,QAAAA,EAAcp0B,aAChBoI,EAAK7oB,SAAShJ,EAAUM,OAAO8J,aAAagF,KAAKg2C,KAAKvH,EAAcp0B,YAAYzpB,EAAUM,OAAOkP,YAElG,CAAA;AAAA,MAAA;AAGF,aAAOqiB;AAAAA,IACP,GAEDy2C,OAAO,SAASwmC,GACf;AAAA,aAAO,IAAI9uG,EAAUwqE,oBAAoBgD,SAASshC,EAASvtG,YAAYutG,EAASttG,UAAUstG,EAAS9pG,SAAS8pG,EAASP,UACrH;AAAA,IAAA,GACDQ,sBAAsB,WACrB;AAAA,UACIroG,GADAopC,IAAQ9vC,EAAU4E;AAOtB,aALG5E,EAAUsG,UAAUtG,EAAUsG,OAAOwpC,EAAMvrC,QAC7CmC,IAAO1G,EAAUsG,OAAOwpC,EAAMvrC,IAAAA,IACtBvE,EAAUuG,UAAUvG,EAAUuG,OAAOupC,EAAMvrC,IACnDmC,MAAAA,IAAO1G,EAAUuG,OAAOupC,EAAMvrC,QAExBmC;AAAAA,IACP,GAED+nG,oBAAoB,WACnB;AAAA,UAAIzpG,IAAU;AAKd,aAJWsE,KAAKylG,2BACJ/pG,MACXA,IAAUsE,KAAK0lG,gBAEThqG,IAAAA;AAAAA,IACP,GAEDgqG,iBAAiB,SAAShuG,GAAWgvD,GAAAA;AACpC,UAAItpD,IAAO4C,KAAKylG,qBACZ1E,GAAAA,IAAe3jG,EAAKuI,MAAMjO,CAAAA,GAC1BiuG,IAAY5E;AAEf4E,OAAAA,IADE5E,MACF4E,SAAa5E,IAAer6C,IAEftpD,EAAKoE,QAAQpE,EAAKqE,WAAYrE,EAAKqE,WAAW,KAG7C,MACdkkG,IAAY;AAEb,UAAIrpG,IAAUc,EAAKd,WAAWc,EAAK2xF;AAOnC,aALG4W,KAAarpG,EAAQzC,WACvB8rG,IAAYrpG,EAAQzC,SAAS,IAI3ByC,EAAQqpG,CAAAA,IACHrpG,EAAQqpG,CAAW57F,EAAAA,MAEnB;AAAA,IAER,GAGD25D,SAAS;AACR,UAAIl9B,IAAQ9vC,EAAU4E,SAAAA;AAMtB,UALkB0E,KAAK/H,WAAWkB,QAAYqtC,IAAAA,EAAM3hC,SAAS1L,QAAa6G,KAAAA,KAAK/H,WAAWkB,QAAaqtC,KAAAA,EAAM1hC,SAAS3L,QAAAA,MAKlH6G,KAAK0d,UAAU1d,KAAK/H,YAAY+H,KAAK9H;AAAW,eAAO;AAE3D,UAAIkF,IAAO4C,KAAKylG,qBAAAA;AAEhB,cAAGroG,KACMA,EAAKuI,MAAM3F,KAAKtE,aAAaoiC;AAAAA,IAKtC,GAEDxF,UAAS,WAER;AAAA,UAAIstE,IAAc,IAAIlvG,EAAUwqE,oBAAoBgD;AACpD,aAAI0hC,EAAYliC,QAAAA,IAGRkiC,IAFA,IAAIlvG,EAAUwqE,oBAAoBs7B;AAAAA,IAI1C,GAEDuH,UAAU;AACT,aAAOxhG,MAAMgS,UAAU9R,MAAMwI,KAAKvU,EAAU8C,WAAWC,iBAAiB;IACxE,GACDkrE,SAAS;AACR,aAAO3kE,KAAK+jG,WAAW,CACvB;AAAA,IAAA,GAEDh0E,OAAO,WACH/vB;AAAAA,WAAKtE,WAAWhF,EAAUY,QAAaZ,KAAAA,EAAUY,UAAUkhG,mBAAmB9hG,EAAUY,UAAUgiE,YAAa5iE,CAAAA,EAAU8C,WAAW4d,cAAc,qBAAqBpX,KAAKtE,OAAAA,IAAAA,KAC9KhF,EAAUY,QAAAA,EAAUgiE,SAAS,EAAC59D,SAASsE,KAAKtE,QAE7ChF,CAAAA,GAAAA,EAAUwqE,oBAAoBr3B,OAAOv9B,OAAOtM,KAAK/H,YAAY+H,KAAK9H,UAAU8H,KAAKtE,OACjFhF,GAAAA,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAUwb,MAAMntB,MAAM5C,IAAAA,GAC/DtJ,EAAUwqE,oBAAoBO,aAAazhE,KAAK/H,YAChDvB,EAAUwqE,oBAAoBQ,gBAAgB1hE,KAAKtE;AAAAA,IAEnD,GACD0nG,MAAM,WAAA;AACL1sG,MAAAA,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAU6uF,KAAKxgG,MAAM5C,IAAAA,GAC9DtJ,EAAUwqE,oBAAoBr3B,OAAO3uB;IACrC,GAEDimF,QAAQzqG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAU4sF,QAE9DC,UAAU1qG,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUoxE,SAEhEkgB,cAAc,SAASntG,GAAMguD,GAAKrxC,GACjC;AAAA,UAAIvX;AACJ,cAAQ4oD,GAAAA;AAAAA,QACP,KAAK;AACJ5oD,UAAAA,IAAMpH,EAAUgC,KAAKC,IAAID,GAAO,IAAG,MACnC;AAAA;AAAA,QACD,KAAK;AACJoF,UAAAA,IAAMpH,EAAUgC,KAAKC,IAAID,GAAM,GAAG,MAAA;AAClC;AAAA,QACD,KAAK;AACJoF,UAAAA,IAAMpH,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAID,OAAU,KAAA,CAAA,GAC5DoF,IAAMkC,KAAKulG,kBAAkBznG,GAAAA;AAC7B;AAAA,QACD,KAAK;AACJA,UAAAA,IAAMpH,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAID,GAAM,GAAG,SAC3DoF,IAAMkC,KAAKulG,kBAAkBznG,GAAK,CAAA;AAClC;AAAA,QACD;AACCA,UAAAA,IAAMpH,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAKR,CAI1C,CAAA;AAAA,MAAA;AAAA,UAAI8tC,IAAQ9vC,EAAU4E,SAAAA;AAKtB,cAJG5C,EAAKS,QAAAA,IAAYqtC,EAAM3hC,SAAS1L,QAAekc,KAAAA,CAAAA,KAAU3c,EAAKS,QAAaqtC,KAAAA,EAAM1hC,SAAS3L,QAC5F2E,OAAAA,IAAM,IAAI5E,KAAKstC,EAAM3hC,QAGf/G,IAAAA;AAAAA,IACP,GAEDgoG,eAAe,SAASd,GAAMt+C,GAAKrxC;AAElC,UAAI1R,GAAOC;AAMX,cALAD,IAAQ3D,KAAK6lG,aAAab,EAAK/sG,YAAYyuD,GAAKrxC,CAE1C3V,GAAAA,SAAShJ,EAAUM,OAAO8J,UAAAA,IAChC8C,IAAM,IAAI1K,KAAKyK,IACXjE,SAAShJ,EAAUM,OAAO+J,SACvB,GAAA,EAAC9I,YAAY0L,GAAOzL,UAAU0L;IACrC,GAEDmiG,gBAAgB,SAASrtG,GAAMkmD,GAASn1C,GAAMizB;AAE7C,eADIkY,IAAc,IAAI17C,KAAK0lD,IACrBhK,EAAYz7C,QAAAA,IAAYT,EAAKS,QAAAA;AAClCy7C,QAAAA,IAAcl+C,EAAUgC,KAAKC,IAAIi8C,GAAalY,GAAMjzB,CAOrD;AAAA,aAJGmrC,EAAYz7C,QAAYT,IAAAA,EAAKS,QAC/By7C,MAAAA,IAAcl+C,EAAUgC,KAAKC,IAAIi8C,GAAclY,CAAAA,GAAMjzB,KAG/CmrC;AAAAA,IACP,GAEDoxD,kBAAkB,SAAShB,GAAMt+C,GAAKrxC,GAAAA;AACrC,UAAImxB,IAAQ9vC,EAAU4E,SAClB8B,GAAAA,IAAO1G,EAAUuG,OAAOupC,EAAMvrC,OAE9Bi/C,IAAal6C,KAAK+lG,eAAef,EAAK/sG,YAAYvB,EAAUgC,KAAK0E,EAAK6R,OAAO,UAAU,IAAI/V,KAAK8rG,EAAK/sG,UAAcmF,CAAAA,GAAAA,EAAKq/C,QAAQr/C,EAAKo/C,MACrIrC,GAAAA,IAAUn6C,KAAK+lG,eAAef,EAAK9sG,UAAUxB,EAAUgC,KAAK0E,EAAK6R,OAAO,QAAA,EAAU,IAAI/V,KAAK8rG,EAAK9sG,QAAAA,CAAAA,GAAYkF,EAAKq/C,QAAQr/C,EAAKo/C;AAE/HrC,MAAAA,EAAQhhD,QAAAA,KAAa+gD,EAAU/gD,QACjCghD,MAAAA,IAAUzjD,EAAUgC,KAAKC,IAAIuhD,GAAW98C,EAAKo/C,QAAQp/C,EAAKq/C;AAE3D,UAAIwpD,IAASjmG,KAAKg/D,MAAMgmC,CAAAA;AAMxB,cALAiB,EAAOhuG,aAAaiiD,GACpB+rD,EAAO/tG,WAAWiiD,GAClB8rD,EAAOvqG,UAAUspG,EAAKtpG,WAAWsE,KAAK0lG,gBAAAA,GAG9Bh/C,GACP;AAAA,QAAA,KAAK;AACJu/C,UAAAA,EAAOvqG,UAAUsE,KAAK0lG,gBAAgBV,EAAKtpG,SAAU,EAAA;AACrD;AAAA,QACD,KAAK;AACJuqG,UAAAA,EAAOvqG,UAAUsE,KAAK0lG,gBAAgBV,EAAKtpG,SAAS,CAAA;AACpD;AAAA,QACD,KAAK;AACJuqG,UAAAA,EAAOhuG,aAAa+H,KAAKulG,kBAAkB7uG,EAAUgC,KAAKC,IAAIstG,EAAOhuG,YAAamF,CAAAA,EAAKo/C,QAAQp/C,EAAKq/C,MAAAA,GAAAA,KACpGwpD,EAAO/tG,WAAWxB,EAAUgC,KAAKC,IAAIstG,EAAOhuG,YAAYmF,EAAKo/C,QAAQp/C,EAAKq/C,MAC1E;AAAA;AAAA,QACD,KAAK;AACJwpD,UAAAA,EAAOhuG,aAAa+H,KAAKulG,kBAAkB7uG,EAAUgC,KAAKC,IAAIstG,EAAOhuG,YAAYmF,EAAKo/C,QAAQp/C,EAAKq/C,MAAS,GAAA,CAAA,GAC5GwpD,EAAO/tG,WAAWxB,EAAUgC,KAAKC,IAAIstG,EAAOhuG,YAAYmF,EAAKo/C,QAAQp/C,EAAKq/C;;AAiB5E,cATGwpD,EAAOhuG,WAAWkB,QAAYqtC,IAAAA,EAAM3hC,SAAS1L,QAAa8sG,KAAAA,EAAOhuG,WAAWkB,QAAaqtC,KAAAA,EAAM1hC,SAAS3L,QACvGkc,OAAAA,KAAU4wF,EAAOhuG,WAAWkB,QAAaqtC,KAAAA,EAAM1hC,SAAS3L,QAC1D8sG,IAAAA,EAAOhuG,aAAa,IAAIiB,KAAKstC,EAAM1hC,QAEnCmhG,KAAAA,EAAOhuG,aAAavB,EAAUgC,KAAK8tC,EAAMvrC,OAAO,QAAUvE,EAAAA,EAAUgC,KAAKC,IAAI6tC,EAAM9tC,MAAMguD,KAAO,SAAPA,KAAqB,GAAGlgB,EAAMvrC,IAAAA,CAAAA,GACvHgrG,EAAO/tG,WAAWxB,EAAUgC,KAAKC,IAAIstG,EAAOhuG,YAAYmF,EAAKo/C,QAAQp/C,EAAKq/C,MAAAA,KAIrEwpD;AAAAA,IACP,GAEDC,eAAe,SAASlB,GAAMt+C,GAAKrxC,GAClC;AAAA,UAAI4wF,IAASjmG,KAAKg/D,MAAMgmC,CACxBiB;AAAAA,MAAAA,EAAOvqG,UAAUspG,EAAKtpG,WAAWsE,KAAK0lG,gBAAAA;AAEtC,UAAIhqG,IAAUspG,EAAKtpG,WAAWsE,KAAK0lG,gBAAAA,GAC/Bl/D,IAAQ9vC,EAAU4E,SAClB8B,GAAAA,IAAO1G,EAAUsG,OAAOwpC,EAAMvrC;AAClC,cAAQyrD,GAAAA;AAAAA,QACP,KAAK;AACJhrD,UAAAA,IAAUsE,KAAK0lG,gBAAgBV,EAAKtpG,SAAAA;AACpC,cAAIyqG,IAAe/oG,EAAKoE,OAAQpE,EAAKoE,OAAO,IAAKpE,EAAKd,QAAQzC;AAE3DuD,UAAAA,EAAKhB,OAAO,KAAMgB,EAAKuI,MAAMjK,MAAYyqG,IAAe,KACvDzvG,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAAA,IAAgB,KAAA,EAAOkB,aAAaqtC,EAAM3hC,SAAS1L,cAC7E8sG,IAASjmG,KAAKomG,YAAYpB,GAAMt+C,GAAKrxC,CAGvC;AAAA;AAAA,QACD,KAAK;AACJ3Z,UAAAA,IAAUsE,KAAK0lG,gBAAgBV,EAAKtpG,SAAS,CAAA,GAC1C0B,EAAKhB,OAAO,KAAA,CAAMgB,EAAKuI,MAAMjK,CAC5BhF,KAAAA,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAY,GAAG,KAAA,EAAOkB,YAAYqtC,EAAM1hC,SAAS3L,QAC3E8sG,MAAAA,IAASjmG,KAAKomG,YAAYpB,GAAMt+C,GAAKrxC,CAAAA;AAIvC;AAAA,QACD;AACC4wF,UAAAA,IAASjmG,KAAKomG,YAAYpB,GAAMt+C,GAAKrxC,CAAAA,GACrC3Z,IAAUspG,EAAKtpG;AAAAA;AAIjB,aADAuqG,EAAOvqG,UAAUA,GACVuqG;AAAAA,IACP,GAEDI,WAAW,SAAS1rC,GAASjU,GAAAA;AAC5B,UAAIhT,IAAU1zC,KAAKulG,kBAAkB7uG,EAAUgC,KAAKC,IAAIgiE,GAASjU,GAAK,KAAQA,GAAAA,CAAAA;AAG9E,aAFAhT,EAAQh0C,SAASi7D,EAAQ95D,aACzB6yC,EAAQ/zC,WAAWg7D,EAAQx4D,WACpBuxC,CAAAA,GAAAA;AAAAA,IACP,GAED4yD,kBAAkB,SAAS5tG,GAAM6tG,GAChC;AAAA,UAAI9uB,IAAU/+E,EAAKyJ,WAAAA,GAClB6jB,IAAQttB,EAAKmI,SAAAA,GACbE,IAAYrK,EAAUM,OAAO+J;AAC9B,aAAQilB,IAAQjlB,KAAAA,CAAewlG,MAAiBxlG,KAAa,MAAMilB,KAASjlB,MAAe02E,CAAAA;AAAAA,IAC3F,GACD+uB,kBAAkB,SAAS9tG,GAAM6tG,GAAAA;AAChC,UAAI9uB,IAAU/+E,EAAKyJ,WAClB6jB,GAAAA,IAAQttB,EAAKmI,SACbC,GAAAA,IAAapK,EAAUM,OAAO8J,YAC9BC,IAAYrK,EAAUM,OAAO+J;AAC9B,aAAQilB,KAASllB,KAAAA,CAAgBylG,MAAiB9uB,MAAczxD,CAAAA,KAAUjlB,KAAa,MAAQilB,KAASjlB;AAAAA,IACxG,GACD0lG,oBAAoB,SAAS/tG,GAAM6tG,GAClC;AAAA,aAAQvmG,KAAKsmG,iBAAiB5tG,GAAM6tG,MAAgBvmG,KAAKwmG,iBAAiB9tG,GAAM6tG,CAAAA;AAAAA,IAChF,GAEDH,aAAa,SAASpB,GAAMt+C,GAAKrxC;AAChC,UAAI1R,GAAOC,GAEP+4F,IAAejmG,EAAUM,OAAO2lG,cAEhCjkG,IAAOsH,KAAK+lG,eAAef,EAAK/sG,YAAYvB,EAAUgC,KAAKitB,UAAU,IAAIzsB,KAAK8rG,EAAK/sG,UAAc,CAAA,GAAA,UAAU0kG,CAG3G+J,GAAAA,IAAW1B,EAAK/sG;AAEpB,cAAQyuD;QACP,KAAK;AAGJ,cAFA/iD,IAAQjN,EAAUgC,KAAKC,IAAID,GAAAA,CAAOikG,GAAc,QAE5C38F,GAAAA,CAAAA,KAAKymG,mBAAmB9iG,GAAO,EAAA,MAAA,CAC7B0R,KAAUrV,KAAKymG,mBAAmBC,GAAU,EAAA,IAAO;AAEvD,gBAAIC;AACDtxF,iBAAU3e,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKyK,CAAAA,CAAAA,EAAQxK,QAAazC,KAAAA,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKwtG,CAAAA,CAAAA,EAAWvtG,cAChHwtG,IAAY,KACVA,MACFhjG,IAAQ3D,KAAKulG,kBAAkB7uG,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAa,IAAG,UAExE0L,IAAAA,EAAMjE,SAAShJ,EAAUM,OAAO+J,SAChC4C,GAAAA,EAAMhE,WAAW,CAAA,GACjBgE,IAAQjN,EAAUgC,KAAKC,IAAIgL,GAAQg5F,CAAAA,GAAc;UACjD;AAEF/4F,UAAAA,IAAMlN,EAAUgC,KAAKC,IAAIgL,GAAOg5F,GAAc,QAC9C;AAAA;AAAA,QACD,KAAK;AACJh5F,UAAAA,IAAQjN,EAAUgC,KAAKC,IAAID,GAAMikG,GAAc,QAE/C;AAAA,cAAIiK,IAAUvxF,IAAS1R,IAAQjN,EAAUgC,KAAKC,IAAIgL,GAAOg5F,GAAc,QAAA;AACnE38F,eAAKymG,mBAAmBG,GAAS,EAAA,KAChCvxF,MAAUrV,KAAKymG,mBAAmBC,KAChCrxF,MAAAA,KAKAsxF,QACAjwG,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKwtG,CAAWvtG,CAAAA,EAAAA,QAAAA,KAAautG,EAASvtG,QACtEwtG,MAAAA,IAAAA,KAEGA,MACHhjG,IAAQ3D,KAAKulG,kBAAkB7uG,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAY,GAAG,KAAQ,GAAA,CAAA,IAE/E0L,EAAMjE,SAAShJ,EAAUM,OAAO8J,UAAAA,GAChC6C,EAAMhE,WAAW,IACjBgE,IAAQjN,EAAUgC,KAAKC,IAAIgL,GAAOg5F,GAAc,QAbhDh5F,OAAAA,IAAQ3D,KAAKulG,kBAAkB7uG,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAY,GAAG,KAAQ,GAAA,CAAA,GACxEyH,SAAShJ,EAAUM,OAAO8J,UAChC6C,GAAAA,EAAMhE,WAAW,CAAA,KAgBpBiE,IAAMlN,EAAUgC,KAAKC,IAAIgL,GAAOg5F,GAAc;AAC9C;AAAA,QACD,KAAK;AACJh5F,UAAAA,IAAQ3D,KAAKqmG,UAAUrB,EAAK/sG,YAAa,EAAA,GACzC2L,IAAM5D,KAAKqmG,UAAUrB,EAAK9sG,UAAW,EAAA;AACrC;AAAA,QACD,KAAK;AACJyL,UAAAA,IAAQ3D,KAAKqmG,UAAUrB,EAAK/sG,YAAY,CACxC2L,GAAAA,IAAM5D,KAAKqmG,UAAUrB,EAAK9sG,UAAU,CAAA;AACpC;AAAA,QACD;AACCyL,UAAAA,IAAQjL,GACRkL,IAAMlN,EAAUgC,KAAKC,IAAIgL,GAAOg5F,GAAc,QAAA;AAAA,MAAA;AAIhD,aAAO,EAAC1kG,YAAY0L,GAAOzL,UAAU0L,EACrC;AAAA,IAAA,GACDijG,oBAAoB,SAAS7B,GAAMt+C;AAClC,UAAI/iD,GAAOC,GACP4iC,IAAQ9vC,EAAU4E,SAAAA;AAEtB,cAAQorD,GACP;AAAA,QAAA,KAAK;AAAA,QACL,KAAK;AACJ/iD,cAAQjN,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAa,IAAG,SACzE0L,IAAQ3D,KAAKulG,kBAAkB5hG,GAAQ,EAAA;AACvC;AAAA,QACD,KAAK;AAAA,QACL,KAAK;AACJA,cAAQjN,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAIqsG,EAAK/sG,YAAY,GAAG,KACxE0L,CAAAA,GAAAA,IAAQ3D,KAAKulG,kBAAkB5hG,GAAO;AACtC;AAAA,QACD;AACCA,cAAQjN,EAAUgC,KAAKitB,UAAUq/E,EAAK/sG,UASxC;AAAA,MAAA;AAAA,cANG+sG,EAAK/sG,WAAWkB,QAAAA,IAAYqtC,EAAM3hC,SAAS1L,QAAAA,KAAa6rG,EAAK/sG,WAAWkB,QAAAA,KAAaqtC,EAAM1hC,SAAS3L,QACtGwK,OAAAA,IAAQ,IAAIzK,KAAKstC,EAAM3hC,aAGxBjB,IAAM,IAAI1K,KAAKyK,CACXjE,GAAAA,SAAShJ,EAAUM,OAAO+J,SACvB,GAAA,EAAC9I,YAAY0L,GAAOzL,UAAU0L;IACrC,GACDkjG,gBAAgB,SAAS9B,GAAMt+C,GAAAA;AAC9B,aAAO,EAACzuD,YAAY+sG,EAAK/sG,YAAYC,UAAU8sG,EAAK9sG,SACpD;AAAA,IAAA,GAGD6uG,eAAe,SAASruG,GAAAA;AACvB,UAAIhC,CAAAA,EAAU0lD;AACb,eAAA;AAED,UAEI9jD,GAFAsiC,IAAWlkC,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU4E,SAAWL,EAAAA,IAAAA;AASzE,aALC3C,IADEsiC,IACMlkC,EAAU6B,gBAAgBqiC,GAAUliC,CAEpChC,IAAAA,EAAUsK,kBAAkBtI,CAG7BhC,GAAAA,CAAAA,EAAU4O,SAAShN,CAAAA;AAAAA,IAC3B,GAEDitG,mBAAmB,SAAS5hG,GAAO+iD,GAAAA;AAClC,UAAIhuD,IAAOiL;AACX+iD,MAAAA,IAAMA,KAAO;AAGb,eAFI71B,IAAQn6B,EAAU4E,aAEf0E,KAAK+mG,cAAcruG,OAAWguD,IAAM,KAAKhuD,EAAKS,QAAa03B,KAAAA,EAAM/rB,SAAS3L,QAAAA,KAAeutD,IAAM,KAAKhuD,EAAKS,QAAa03B,KAAAA,EAAMhsB,SAAS1L,QAC3IT;AAAAA,YAAOsH,KAAKgnG,eAAetuG,GAAMguD,CAGlC;AAAA,aAAOhuD;AAAAA,IACP,GAEDsuG,gBAAgB,SAASrjG,GAAO+iD;AAC/BA,MAAAA,IAAMA,KAAO;AACb,UAAI9rB,IAAWlkC,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU4E,SAAWL,EAAAA,IAAAA;AASzE,aANG2/B,IACKlkC,EAAUgC,KAAKC,IAAIgL,GAAO+iD,IAAM9rB,EAAS4hB,QAAQ5hB,EAAS6hB,UAE1D/lD,EAAUgC,KAAKitB,UAAUjvB,EAAUgC,KAAKC,IAAIgL,GAAO+iD,GAAK,KAIhE,CAAA;AAAA,IAAA,GAEDhpC,WAAU,SAAS6K,GAAME,GACxB;AAAA,UAAA,CAAI/xB,EAAU0lD;AACb,eAAA;AAID,eAFI6qD,IAAU,IAAI/tG,KAAKqvB,CAAAA,GAEjB0+E,EAAQ9tG,QAAYsvB,IAAAA,EAAGtvB,aAAU;AACtC,YAAG6G,KAAK+mG,cAAcE,CAAAA;AAAU,iBAAO;AACvCA,YAAUjnG,KAAKgnG,eAAeC,CAC9B;AAAA,MAAA;AACD;IACA,GAED9iC,UAAU,SAAS6gC,GAAMt+C,GAAKtpD,GAAMiY,GACnC;AAAA,UAAI4B;AACJ7Z,UAAOA,KAAQ4C,KAAKohG,SAEpB;AAAA,UAAI8F,IAAWxwG,EAAUwqE,oBAAoBgD,SAAS3vD,UAAUyqD,MAAMgmC,CAAAA;AAEtE,cAAQ5nG,GACP;AAAA,QAAA,KAAK4C,KAAKmhG,OAAO33F;AAChByN,UAAAA,IAAOjX,KAAKkmG,cAAcgB,GAAUxgD,GAAKrxC,CACzC;AAAA;AAAA,QACD,KAAKrV,KAAKmhG,OAAOvmE;AAChB3jB,UAAAA,IAAOjX,KAAKgmG,iBAAiBkB,GAAUxgD,GAAKrxC,CAC5C;AAAA;AAAA,QACD,KAAKrV,KAAKmhG,OAAO5qE;AAAAA,QAGjB,KAAKv2B,KAAKmhG,OAAO7qE;AAChBrf,UAAAA,IAAOjX,KAAK8lG,cAAcoB,GAAUxgD,GAAKrxC,CAAAA;AACzC;AAAA,QACD,KAAKrV,KAAKmhG,OAAOM;AAChBxqF,UAAAA,IAAOjX,KAAK6mG,mBAAmBK,GAAUxgD,GAAKrxC,CAAAA;AAC9C;AAAA,QACD,KAAKrV,KAAKmhG,OAAO3lF;AAChBvE,UAAAA,IAAOjX,KAAK8mG,eAAeI,GAAUxgD,GAAKrxC,CAAAA;AAC1C;AAAA,QACD,KAAKrV,KAAKmhG,OAAOS;AAChB3qF,UAAAA,IAAOjX,KAAKomG,YAAYc,GAAUxgD,GAAKrxC;;AAQzC,aAJG4B,EAAKhf,WAAWkB,QAAAA,KAAa8d,EAAK/e,SAASiB,cAC7C8d,IAAOjX,KAAKmkE,SAASltD,GAAMyvC,GAAKtpD,KAG1B1G,EAAUwqE,oBAAoBgD,SAAS3vD,UAAUyqD,MAAM/nD,CAAAA;AAAAA,IAE9D,GAEDkwF,YAAY,SAASnC,GAAMt+C,GAC1B;AAAA,UACIzvC;AACJ,cAFWjX,KAAKohG,SAGf,GAAA;AAAA,QAAA,KAAKphG,KAAKmhG,OAAO33F;AAEfyN,cADEyvC,KAAO,UAAUA,KAAO,UACnB1mD,KAAKkmG,cAAclB,GAAMt+C,CAEzB1mD,IAAAA,KAAKonG,gBAAgBpC,GAAMt+C;AAEnC;AAAA,QACD,KAAK1mD,KAAKmhG,OAAOvmE;AAEf3jB,cADEyvC,KAAO,UAAUA,KAAO,OACnB1mD,KAAKgmG,iBAAiBhB,GAAMt+C,CAE5B1mD,IAAAA,KAAKqnG,mBAAmBrC,GAAMt+C,CAAAA;AAEtC;AAAA,QACD,KAAK1mD,KAAKmhG,OAAO5qE;AAAAA,QAGjB,KAAKv2B,KAAKmhG,OAAO7qE;AAChBrf,cAAOjX,KAAKsnG,gBAAgBtC,GAAMt+C;AAClC;AAAA,QACD,KAAK1mD,KAAKmhG,OAAOS;AAChB3qF,cAAOjX,KAAKunG,cAAcvC,GAAMt+C;AAChC;AAAA,QACD,KAAK1mD,KAAKmhG,OAAOM;AAChBxqF,cAAOjX,KAAKwnG,qBAAqBxC,GAAMt+C;AACvC;AAAA,QACD;AACCzvC,cAAO+tF;AAAAA,MAIT;AAAA,UAAIn0E,IAAQn6B,EAAU4E,SAAAA;AAYtB,aAXG2b,EAAKhf,WAAWkB,QAAAA,IAAY03B,EAAMhsB,SAAS1L,QAAAA,MAC7C8d,EAAKhf,aAAa+H,KAAKulG,kBAAkB10E,EAAMhsB,QAAAA,GAC/CoS,EAAKhf,WAAWyH,SAAShJ,EAAUM,OAAO8J,UAGxCmW,IAAAA,EAAK/e,SAASiB,QAAY03B,IAAAA,EAAM/rB,SAAS3L,QAE3C8d,MAAAA,EAAK/e,WAAW8H,KAAKulG,kBAAkB10E,EAAM/rB,YAIvCpO,IAAAA,EAAUwqE,oBAAoBgD,SAAS3vD,UAAUyqD,MAAM/nD,CAC9D;AAAA,IAAA,GAEDowF,oBAAoB,SAASrC,GAAMvxD,GAAAA;AAClC,aAAOzzC,KAAKynG,kBAAkB,EAC7B5vG,MAAO,cACP4lB,OAAQ,WAERunF,GAAAA,GACAvxD,GACA,UAAA;AAAA,IAED,GAED+zD,sBAAsB,SAASxC,GAAMvxD,GAAAA;AACpC,aAAOzzC,KAAKynG,kBAAkB,EAC5B5vG,MAAO,cACP4lB,OAAQ,WAETunF,GAAAA,GACAvxD,GACA,YAED;AAAA,IAAA,GAEDg0D,mBAAmB,SAASC,GAAmB1C,GAAMvxD,GAAWl3C,GAAAA;AAC/D,UAAI0a,GACA0wF,IAAW3C,EAAKC;AAMpB,UAJI0C,MACHA,IAAWD,EAAkBj0D,CAAAA,IAAAA,CAG1Bk0D,MAAaD,EAAkBj0D,CAAAA;AAClC,eAAOuxD;AAGR,UAAGvxD,CAAAA;AASF,eAAO/8C,EAAUwqE,oBAAoBgD,SAAS3vD,UAAUyqD,MAAMgmC;OAR9D/tF,IAAOjX,KAAKmkE,SAAS,EAAClsE,YAAY+sG,EAAK2C,IAAWjsG,SAASspG,EAAKtpG,WAAU+3C,GAAWl3C,GAAAA,KAE7EtE,WAAWkB,QAAAA,KAAa6rG,EAAK/sG,WAAWkB,QAC/C8d,MAAAA,IAAOjX,KAAKmkE,SAAS,EAAClsE,YAAYgf,EAAKhf,YAAYyD,SAAQub,EAAKvb,QAAAA,GAAU+3C,GAAWl3C,GAAAA,EAGtF0a,IAAAA,EAAKguF,aAAa0C;AAKnB,UAAIC,IAAW5nG,KAAK6nG,gBAAgB7C,GAAM/tF,GAAMA,EAAKguF,UASrD;AAAA,aAPG2C,EAAS1vG,SAASiB,aAAayuG,EAAS3vG,WAAWkB,cACrD8d,EAAKguF,aAAahuF,EAAKguF,cAAc,aAAa,eAAe,aAElE2C,IAAW5nG,KAAK6nG,gBAAgB7C,GAAM/tF,GAAMA,EAAKguF,UAEjDhuF,GAAAA,EAAKhf,aAAa2vG,EAAS3vG,YAC3Bgf,EAAK/e,WAAW0vG,EAAS1vG,UAClB+e;AAAAA,IACP,GAED4wF,iBAAiB,SAASC,GAASC,GAASC,GAC3C;AAAA,UAAIlqG,IAAM,EAAC7F,YAAW,MAAMC,UAAS,KASrC;AAAA,aAPG8vG,KAAiB,gBACnBlqG,EAAI7F,aAAa8vG,EAAQ9vG,YACzB6F,EAAI5F,WAAW4vG,EAAQ5vG,aAEvB4F,EAAI7F,aAAa6vG,EAAQ7vG,YACzB6F,EAAI5F,WAAW6vG,EAAQ9vG,aAEjB6F;AAAAA,IAEP,GAEDwpG,iBAAiB,SAAStC,GAAMvxD;AAe/B,cAdIuxD,IAAOhlG,KAAKynG,kBAAkB,EAChCrI,IAAK,cACLC,MAAO,YACPxnG,MAAO,cACP4lB,OAAQ,cAETunF,GACAvxD,GACA,UAGIx7C,WAAWyH,SAAShJ,EAAUM,OAAO8J,UAAAA,GAC1CkkG,EAAK9sG,WAAWxB,EAAUgC,KAAKC,IAAIqsG,EAAK9sG,UAAAA,IAAc,KACtD8sG,GAAAA,EAAK9sG,SAASwH,SAAShJ,EAAUM,OAAO+J,SAAAA,GACjCikG;AAAAA,IACP,GAEDoC,iBAAiB,SAASpC,GAAMvxD;AAC/B,UAAIx8B;AAEJ,cAAQw8B,GACP;AAAA,QAAA,KAAK;AAAA,QACL,KAAK;AACJx8B,UAAAA,IAAOjX,KAAKunG,cAAcvC,GAAMvxD;AAChC;AAAA,QACD;AACCx8B,UAAAA,IAAO+tF;AAAAA,MAIT;AAAA,aADA/tF,EAAKvb,UAAUspG,EAAKtpG,SACbub;AAAAA,IACP,GACDswF,eAAe,SAASvC,GAAMvxD;AAC7B,aAAOzzC,KAAKynG,kBAAkB,EAC5BrI,IAAK,cACLC,MAAO,YACPxnG,MAAO,cACP4lB,OAAQ,WAAA,GAETunF,GACAvxD,GACA,YAAA;AAAA,IAED,GAEDw0D,YAAY,SAASvhD,GAAAA;AACpB,UAAIlgB,IAAQ9vC,EAAU4E,YAElB0pG,IAAOhlG,KAAKmkE,SAASnkE,MAAM0mD,CAAAA;AAAAA,OAC5Bs+C,EAAK/sG,WAAWkB,QAAYqtC,IAAAA,EAAM3hC,SAAS1L,QAAa6rG,KAAAA,EAAK/sG,WAAWkB,QAAaqtC,KAAAA,EAAM1hC,SAAS3L,QACtGzC,MAAAA,EAAU6V,eAAe,IAAIrT,KAAK8rG,EAAK/sG,cAGxC+H,KAAKikG,OAAOe;IACZ,GAEDjvE,MAAM,EACLl+B,MAAQ,WAAA;AACPmI,WAAKioG,WAAW,MAChB;AAAA,IAAA,GACDxqF,OAAS,WACRzd;AAAAA,WAAKioG,WAAW,OAChB;AAAA,IAAA,GACD5I,MAAQ,WAEKr/F;AAAAA,WAAKohG,SACNphG,KAAAA,KAAKmhG,OAAO3lF,OACtB9kB,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUivF,iBAEtDxjG,IAAAA,KAAKioG,WAAW,MAGjB;AAAA,IAAA,GAED7I,IAAM,WAAA;AACOp/F,WAAKohG,SAAAA,KACNphG,KAAKmhG,OAAO3lF,OACtB9kB,EAAUwqE,oBAAoBq7B,cAAchoF,UAAUsvF,iBAEtD7jG,IAAAA,KAAKioG,WAAW,IAAA;AAAA,IAGjB,GAED,cAAa;AACZjoG,WAAKikG,OAAOjkG,KAAKmnG,WAAWnnG,MAAM;IAClC,GACD,YAAW,WACVA;AAAAA,WAAKikG,OAAOjkG,KAAKmnG,WAAWnnG,MAAM,IAAA,CAAA;AAAA,IAClC,GACD,eAAc,WAAA;AACbA,WAAKikG,OAAOjkG,KAAKmnG,WAAWnnG,MAAM,OAClC,CAAA;AAAA,IAAA,GACD,cAAa,WACZA;AAAAA,WAAKikG,OAAOjkG,KAAKmnG,WAAWnnG,MAAM,MAClC,CAAA;AAAA,IAAA,GAGDi/F,OAAS,WAAA;AACR,UAAI7lG,IAAM,EAACnB,YAAY,IAAIiB,KAAK8G,KAAK/H,UAAAA,GAAaC,UAAU,IAAIgB,KAAK8G,KAAK9H,QAAAA,EAAAA,GAEtE+C,IAAOvE,EAAU4E,WAAWL;AAC7BvE,MAAAA,EAAUuG,UAAUvG,EAAUuG,OAAOhC,KAGvC7B,EADe1C,EAAUuG,OAAOvG,EAAU4E,SAAWL,EAAAA,IAAAA,EACxChB,cAAc+F,KAAKtE,UACxBhF,EAAUsG,UAAUtG,EAAUsG,OAAO/B,CAE7C7B,MAAAA,EADW1C,EAAUsG,OAAO/B,CACnBf,EAAAA,MAAAA,IAAU8F,KAAKtE,UAGzBhF,EAAU6T,YAAYnR,CACtB;AAAA,IAAA,EAAA,EAAA,CAAA,GAKJ1C,EAAUwqE,oBAAoBgD,SAAS3vD,UAAUosF,QAAQjqG,EAAUwqE,oBAAoBgD,SAAS3vD,UAAUwhB,IAAAA;AAAAA,EAE1G,ET9qBYr/B,CAAAA,GU1GG,SAASA,GAExBA;AAAAA,IAAAA,EAAUwqE,oBAAoByC,gBAAgB,SAAS5hE,GAAKzJ,GAC3D0H;AAAAA,WAAK9C,YAAY6E,GACjB/B,KAAK1H,QAAQA,KAAS;AAAA,IACvB,GAEA5B,EAAUwqE,oBAAoByC,cAAcpvD,YAAY7d,EAAU8mG,SACjE9mG,EAAUwqE,oBAAoB8iC,YAC9B,EAECtgC,SAAS,WAAA;AAER,aADgB1jE,CAAAA,CAAAA,KAAK9C,UACF+c;AAAAA,IACnB,GAEDqe,UAAU,WAAA;AACT,UAAIstE,IAAc,IAAIlvG,EAAUwqE,oBAAoBgD;AACpD,aAAG0hC,EAAYliC,QACPkiC,IAAAA,IAEA,IAAIlvG,EAAUwqE,oBAAoBs7B;AAAAA,IAE1C,GACDzsE,OAAO;AACNr5B,MAAAA,EAAUwqE,oBAAoBc,WAAWkmC,WAAW1T,QACpDx0F,GAAAA,KAAK9C,UAAUmnE,gBAAgB,UAAA,GAC/B3tE,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAUwb,MAAMntB,MAAM5C,IAE/D;AAAA,IAAA,GACDojG,MAAM,WAAA;AACLpjG,WAAK9C,UAAUuY,aAAa,YAAY,GACxC/e,GAAAA,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAU6uF,KAAKxgG,MAAM5C,IAC9D;AAAA,IAAA,GACD2kE,SAAS,WACR;AAAA,aAAI3kE,KAAK1H,QAGD0H,KAAK9C,UAAUka,cAAc,sBAAA,IAF7BpX,KAAK9C,UAAUka,cAAc,sBAAA;AAAA,IAIrC,GAED2e,MAAM,EACLtY,OAAS,SAASviB,GAAAA;AACjB8E,WAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoByC,cAAc3jE,KAAK9C,WAAW8C,KAAK1H,QAAQ,IAAI,CAC7F,CAAA;AAAA,IAAA,GACDT,MAAQ,SAASqD,GAAAA;AAChB8E,WAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoByC,cAAc3jE,KAAK9C,WAAW8C,KAAK1H,QAAQ,IAAI,CAC7F,CAAA;AAAA,IAAA,GACD+mG,MAAQ,WAAA;AACP,UAAIpoF,IAAO,IAAIvgB,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAW,GAAG,CACzE+Z;AAAAA,MAAAA,KAAAA,CAASA,EAAKysD,QAAAA,MAChBzsD,IAAOA,EAAKqhB,aAGbt4B,KAAKikG,OAAOhtF;IACZ,GACDgoF,OAAS,SAAS/jG,GACjB8E;AAAAA,WAAK2kE,QAAU5uD,EAAAA,MAAAA;AAAAA,IACf,EAKJrf,EAAAA,CAAAA,GAAAA,EAAUwqE,oBAAoByC,cAAcpvD,UAAUosF,QAAQjqG,EAAUwqE,oBAAoByC,cAAcpvD,UAAUwhB,IAAAA;AAAAA,EAEpH,EVyCiBr/B,CW3GF,GAAA,SAASA;AAExBA,IAAAA,EAAUwqE,oBAAoB0C,cAAc,SAAS7hE,GAAKynC,GAAK3J,GAC9D7/B;AAAAA,WAAK9C,YAAY6E,GACjB/B,KAAKwpC,MAAMA,KAAO,GAClBxpC,KAAK6/B,MAAMA,KAAO;AAAA,IACnB,GAEAnpC,EAAUwqE,oBAAoB0C,YAAYrvD,YAAY7d,EAAU8mG,SAC/D9mG,EAAUwqE,oBAAoB8iC,YAC9B,EAECtgC,SAAS,WAAA;AACR,UAAIvsB,IAAOn3C,KAAKmoG;AAChB,aAAUhxD,EAAAA,CAAAA,EAAKn3C,KAAKwpC,GAAQ2N,KAAAA,CAAAA,EAAKn3C,KAAKwpC,GAAKxpC,EAAAA,KAAK6/B;IAChD,GACDvH,UAAU,WACT;AAAA,UAAIkR,IAAMxpC,KAAKwpC,KACX3J,IAAM7/B,KAAK6/B,KACXsX,IAAOn3C,KAAKmoG;AACZhxD,QAAK3N,CAAAA,MACRA,IAAM;AAEP,UAAIkd,IAAAA;AAKJ,UAJGld,IAAM2N,EAAKt9C,SAAS,MACtB6sD,SAGGvP,CAAAA,EAAK3N,CAAK,GAAA;AACb,YAAIo8D,IAAc,IAAIlvG,EAAUwqE,oBAAoBgD;AACpD,eAAG0hC,EAAYliC,YACPkiC,IAEA,IAAIlvG,EAAUwqE,oBAAoBs7B;AAAAA,MAE1C;AAED,UAAG91C;AACF,iBAAQ9nD,IAAIihC,GAAKsX,EAAK3N,CAAQ5qC,KAAAA,IAAIu4C,EAAK3N,CAAAA,EAAK3vC,QAAQ+E;AAKnD,cAJIu4C,EAAK3N,CAAAA,EAAK5qC,MAAMA,KAAKu4C,EAAK3N,GAAK3vC,SAAS,MAC3C2vC,KACA3J,IAAM,IAEJsX,EAAK3N,GAAK5qC,CACZ;AAAA,mBAAO,IAAIlI,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAWssC,GAAK5qC,CAAAA;AAAAA;AAI5E,aAAQA,IAAIihC,GAAKsX,EAAK3N,CAAAA,KAAQ5qC,IAAIu4C,EAAK3N,CAAAA,EAAK3vC,QAAQ+E;AAKnD,cAJIu4C,EAAK3N,CAAAA,EAAK5qC,CAAOA,KAAAA,MAEpBihC,IAAMsX,EADN3N,EAAAA,CAAAA,EACgB3vC,SAAS,IAEvBs9C,EAAK3N,GAAK5qC,CACZ;AAAA,mBAAO,IAAIlI,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAWssC,GAAK5qC;AAK7E,aAAO,IAAIlI,EAAUwqE,oBAAoByC,cAAc3jE,KAAK9C,WAAW,CACvE;AAAA,IAAA,GACD6yB,OAAO,WACNr5B;AAAAA,MAAAA,EAAUwqE,oBAAoBc,WAAWkmC,WAAW1T,WAEpDx0F,KAAK9C,UAAUmnE,gBAAgB,UAAA,GAC/B3tE,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAUwb,MAAMntB,MAAM5C,IAC/D;AAAA,IAAA,GACDojG,MAAM,WACLpjG;AAAAA,WAAK9C,UAAUuY,aAAa,YAAY,GAAA,GACxC/e,EAAUwqE,oBAAoB8iC,WAAWzvF,UAAU6uF,KAAKxgG,MAAM5C;IAC9D,GACDooG,UAAU,SAAS5+D,GAAK3J,GACvB;AAAA,aAAO7/B,KAAK9C,UAAUka,cAAc,kCAAgCoyB,IAAM,KAAK,qBAAmB3J,IAAM,KAAG,GAC3G;AAAA,IAAA,GACD8kC,SAAS,WAAA;AACR,aAAO3kE,KAAKooG,SAASpoG,KAAKwpC,KAAKxpC,KAAK6/B;IACpC,GAEDsoE,UAAU,WAGT;AAAA,eAFI3xF,IAAOxW,KAAK9C,UAAUzD,iBAAiB,sBACvC09C,IAAO,CAAA,GACHv9C,IAAI,GAAGA,IAAI4c,EAAK3c,QAAQD,KAAI;AACnCu9C,QAAAA,EAAKv9C,CAAAA,IAAK;AAGV,iBADIL,IADMid,EAAK5c,CAAAA,EACCH,iBAAiB,IAAA,GACzBmF,IAAI,GAAGA,IAAIrF,EAAMM,QAAQ+E,KAAI;AACpC,cAAIomD,IAAOzrD,EAAMqF,CAAAA,GACbypG,IAAU,IACVlwG,IAAMzB,EAAUkQ,cAAco+C,CAC/B7sD;AAAAA,WAAAA,EAAI0O,QAAQ,WAAgB,IAAA,MAAK1O,EAAI0O,QAAQ,YAAA,IAAA,MAAsB1O,EAAI0O,QAAQ,kBAAA,IAAA,QACjFwhG,IAAU,KAEXlxD,EAAKv9C,CAAGgF,EAAAA,CAAAA,IAAKypG;AAAAA,QACb;AAAA,MACD;AACD,aAAOlxD;AAAAA,IACP,GAGDphB,MAAM,EACLtY,OAAS,SAASviB;AACjB,UAAIi8C,IAAOn3C,KAAKmoG,SACZG,GAAAA,IAAStoG,KAAKwpC,KACd++D,IAASvoG,KAAK6/B,MAAM;AACpBsX,MAAAA,EAAKmxD,MAAYnxD,EAAKmxD,CAAAA,EAAQC,OAC9BpxD,EAAKmxD,IAAS,CAChBA,KAAAA,KAAkB,GAClBC,IAAS,KAETA,IAASvoG,KAAK6/B;AAIhB,UAAI5oB,IAAO,IAAIvgB,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAWorG,GAAQC;AAC7EtxF,MAAAA,EAAKysD,QAAAA,MACRzsD,IAAOA,EAAKqhB,SAAAA,IAGbt4B,KAAKikG,OAAOhtF,CAAAA;AAAAA,IACZ,GACDpf,MAAQ,SAASqD;AAChB,UAAIi8C,IAAOn3C,KAAKmoG,SACZG,GAAAA,IAAStoG,KAAKwpC,KACd++D,IAASvoG,KAAK6/B,MAAM;AACpBsX,MAAAA,EAAKmxD,MAAYnxD,EAAKmxD,CAAAA,EAAQC,OAGhCA,IAFEpxD,EAAKmxD,IAAS,CAEPnxD,IAAAA,EADTmxD,KAAkB,CAAA,EACIzuG,SAAS,IAEtBmG,KAAK6/B;AAIhB,UAAI5oB,IAAO,IAAIvgB,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAWorG,GAAQC,CAC7EtxF;AAAAA,MAAAA,EAAKysD,cACRzsD,IAAOA,EAAKqhB,aAGbt4B,KAAKikG,OAAOhtF;IACZ,GACDooF,MAAQ,WACP;AAAA,UAAIloD,IAAOn3C,KAAKmoG,YACZG,IAAStoG,KAAKwpC,MAAM,GACpB++D,IAASvoG,KAAK6/B;AAEdsX,MAAAA,EAAKmxD,CAAYnxD,KAAAA,EAAKmxD,CAAQC,EAAAA,CAAAA,MACjCD,IAAStoG,KAAKwpC;AAGf,UAAIvyB,IAAO,IAAIvgB,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAWorG,GAAQC,CAAAA;AAC7EtxF,MAAAA,EAAKysD,QACRzsD,MAAAA,IAAOA,EAAKqhB,SAGbt4B,IAAAA,KAAKikG,OAAOhtF,CACZ;AAAA,IAAA,GACDmoF,IAAM,WAAA;AACL,UAAIjoD,IAAOn3C,KAAKmoG,SACZG,GAAAA,IAAStoG,KAAKwpC,MAAM,GACpB++D,IAASvoG,KAAK6/B;AAElB,UAAIsX,EAAKmxD,CAAAA,KAAYnxD,EAAKmxD,CAAQC,EAAAA,CAAAA,GAM7B;AACJ,YAAItxF,IAAO,IAAIvgB,EAAUwqE,oBAAoB0C,YAAY5jE,KAAK9C,WAAWorG,GAAQC;AAC7EtxF,QAAAA,EAAKysD,QAAAA,MACRzsD,IAAOA,EAAKqhB,SAAAA,IAGbt4B,KAAKikG,OAAOhtF,CAAAA;AAAAA,MACZ,OAbyC;AACzC,YAAI3e,IAAQ;AACT0H,aAAK6/B,MAAMsX,EAAKn3C,KAAKwpC,GAAAA,EAAK3vC,SAAS,MACrCvB,IAAQ,IAET0H,KAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoByC,cAAc3jE,KAAK9C,WAAW5E,CAAAA,CAAAA;AAAAA,MACjF;AAAA,IASI,GACD2mG,OAAS,SAAS/jG,GAAAA;AACjB8E,WAAK2kE,QAAAA,EAAUvtD,cAAc,iBAAmBrB,EAAAA,MAAAA;AAAAA,IAChD,QAKJrf,EAAUwqE,oBAAoB0C,YAAYrvD,UAAUosF,QAAQjqG,EAAUwqE,oBAAoB0C,YAAYrvD,UAAUwhB;EAEhH,EX9Eer/B,IY5GA,SAASA,GAAAA;AAExBA,IAAAA,EAAUwqE,oBAAoBs7B,WAAW,SAASlkG,GAAAA;AACjD0H,WAAK1H,QAAQA,KAAS;AAAA,IACvB,GAEA5B,EAAUwqE,oBAAoBs7B,SAASjoF,YAAY7d,EAAU8mG,SAC5D9mG,EAAUwqE,oBAAoB8iC,YAC9B,EACCr/B,SAAS,SAASrsE,GAAAA;AACjB,aAAO5B,EAAU8C,WAAW4d,cAAc,eAC1C;AAAA,IAAA,GAEDopF,WAAU,MAEV98B,SAAS,WAAA;AACR;IACA,GACDprC,UAAS,WACR;AAAA,aAAOt4B;AAAAA,IACP,GAED+1B,MAAM,EACL,sBAAqB,WACpB/1B;AAAAA,WAAKikG,OAAO,IAAIvtG,EAAUwqE,oBAAoBgD,UAC9C;AAAA,IAAA,EAAA,EAAA,CAAA,GAKJxtE,EAAUwqE,oBAAoBs7B,SAASjoF,UAAUosF,QAAQjqG,EAAUwqE,oBAAoBs7B,SAASjoF,UAAUwhB,IAAAA;AAAAA,EAE1G,EZ6EYr/B,CAAAA,GACVkqE,GAAOlqE,Ca9GM,GAAA,SAASA,GAExBA;AAAAA,IAAAA,EAAUwqE,oBAAoBc,aAAa,EAC1Ct3D,UAAU,IACV+4D,YAAY,MACZykC,YAAY,IAAIxxG,EAAUwqE,oBAAoBq7B,iBAE9Cl5B,oBAAoB,SAAUj4D,GAAAA;AAC7B,UAAIxT,GAAKC,GAEL+kC,IAAalmC,EAAU8C,WAAW4d,cAAc,+BAChDwlB;AAAAA,MAAAA,MACHA,IAAalmC,EAAU8C,WAAW4d,cAAc,mBAG9CwlB,MACFhlC,IAAMglC,EAAWzc,WACjBtoB,IAAO+kC,EAAWvc,aAGnBjV,EAAAA,GAEGwxB,MACFA,EAAWzc,YAAYvoB,GACvBglC,EAAWvc,aAAaxoB;AAAAA,IAEzB,GACD0rE,QAAQ,WAAA;AACP,UAAI7sE,EAAU8C,YAAd;AAKAwG,aAAK0K,WAAW;AAChB,YAAIq9B,IAAO/nC;AACXA,aAAKqjE,mBAAmB,WAAA;AACvBt7B,UAAAA,EAAKmgE,WAAW3kC,OAAAA,GAChBx7B,EAAKq8B,cAAcr8B,EAAK+6B;QAC3B,CAPG;AAAA,MAAA;AAAA,IAQD,GAED0xB,SAAS,WAAA;AACRx0F,WAAK0K,WAAW,IAChB1K,KAAKkoG,WAAW1T,QAChB;AAAA,IAAA,GAEDz9F,WAAW,WACV;AAAA,aAAA,CAAA,CAASiJ,KAAK0K;AAAAA,IACd,GAEDy4F,gBAAgB,WACf;AAAA,aAAOnjG,KAAKkoG,WAAW/E,eACvB;AAAA,IAAA,GAED5F,gBAAgB,WACfv9F;AAAAA,WAAKokE,cAAcpkE,KAAKmjG,eAAAA,CAAAA;AAAAA,IACxB,GAEDrgC,eAAe,WAAA;AACd,UAAI9lD,IAAOhd,KAAKyjE;AAIhB,aAHGzmD,KAASA,CAAAA,EAAK0mD,cAChB1mD,IAAOA,EAAKsb,aAENtb;AAAAA,IACP,GAEDsmD,iBAAiB,WAAA;AAChBtjE,WAAKwoG,SAASxoG,KAAKkoG,UACnBloG,GAAAA,KAAK4hB,UAAU5hB,KAAKkoG,UAAAA;AAAAA,IACpB,GAED9jC,eAAe,SAASxoD,GACnBA;AAAAA,MAAAA,KAAOA,EAAG8nD,QAAAA,MAGX1jE,KAAKyjE,cACJzjE,KAAKyjE,WAAWygC,UAAUtoF,CAAAA,KAI3B5b,KAAKjJ,UACPiJ,MAAAA,KAAKwoG,SAASxoG,KAAKyjE,UACnBzjE,GAAAA,KAAKyjE,aAAa7nD,GAClB5b,KAAK4hB,UAAU5hB,KAAKyjE,UAAAA;AAAAA,IAErB,GAED7hD,WAAW,SAAShG,GAChBA;AAAAA,MAAAA,KAAMA,EAAGmU,UACXnU,EAAGmU,MACAnU,GAAAA,EAAG+oD,WAAWrgE,SAASmd,iBAAiB7F,EAAG+oD,QAC7C3kE,KAAAA,KAAKokE,cAAc,IAAI1tE,EAAUwqE,oBAAoBs7B;IAGvD,GACDgM,UAAU,SAAS5sF,GACfA;AAAAA,MAAAA,KAAMA,EAAGwnF,QACXxnF,EAAGwnF,KAEJ;AAAA,IAAA,GAED0B,iBAAiB,SAASnrG;AACzB,UAAI8uG,IAAS/xG,EAAU8C,WAAW4d,cAAc,qBAAmB1gB,EAAUM,OAAO0C,kBAAgB,OAAKC,IAAG,aAAA;AAC5G,aAAG8uG,KAAUA,EAAOxuF,cAEZwuF,IAED;AAAA,IACP,GAEDtlC,gBAAgB,SAAUjoE,GAEzB;AAAA,UAAA,CAAGA,EAAEwtG,kBAAL;AAIA,YAAIjnF,IAAgBzhB,KAAK8iE,cAEzB;AAAA,aAAA,CAAGpsE,EAAUwqE,oBAAoBJ,QAAAA,KAC9Br/C,KAAiBA,EAAcvkB,aAAaxG,EAAUod,MAAM62C,IAAIztC,UAAU,EAAC9hB,QAAOqmB,EAAcvkB,aAAY,qBAAqB,EAAA,OAAA,CAGjIxG,EAAU4E,SAAAA,EAAWk/C,aAAax6C,CAAAA,KAAK8kG,gBAAgBpuG,EAAU4E,SAAAA,EAAWk/C,eAG1Ex6C,KAAKjJ,UAAAA,GAAV;AAGAmE,UAAAA,IAAIA,KAAK3E,OAAOO;AAEhB,cAAI6xG,IAAgB3oG,KAAKkoG,YAErBhK,IAAUxnG,EAAUwqE,oBAAoBg8B,UAAUoB,oBAAoBpjG,CAEtEumB;AAAAA,UAAAA,IAEKA,EAAc07E,YAAYe,CAClCz8E,IAAAA,EAAcg/E,SAASvC,GAAShjG,CAAAA,IACxBytG,EAAcxL,YAAYe,CAAAA,KAClCyK,EAAclI,SAASvC,GAAShjG,KAJhC8E,KAAKu9F,eAAAA;AAAAA,QATE;AAAA,MAZP;AAAA,IA4BD,GAEDqL,UAAU,MACV9zF,OAAO,SAAS1J,GAAU0J,GAAAA;AAEzBK,mBAAanV,KAAK4oG,QAClB5oG,GAAAA,KAAK4oG,WAAWj6F,WAAWvD,GAAU0J,KAAS,CAE9C;AAAA,IAAA,EAAA;AAAA,EAGF,Eb1COpe,CAAAA,GACL4qE,GAAe5qE,CAAAA,GAEf,WACCssE;AAAAA,IAAAA,GAAmBtsE,IcnHP,SAASA,GAAAA;AAExBA,MAAAA,EAAUwqE,oBAAoB2nC,iBAAiB,IAE/CnyG,EAAUwqE,oBAAoB4nC,YAAY,SAAS9rF,GAElD;AAAA,iBADI+rF,IAAgBryG,EAAUwqE,oBAAoB2nC,gBAC1CjvG,IAAI,GAAGA,IAAImvG,EAAclvG,QAAQD;AACxC,cAAGoG,KAAKghB,UAAUhE,GAAM+rF,EAAcnvG;AACrC,mBAAO;AAET;MACD,GAEAlD,EAAUwqE,oBAAoBlgD,YAAY,SAASC,GAAOjf,GACzD;AAAA,eAAMif,KAASA,MAAUjf;AACxBif,UAAAA,IAAQA,EAAMhf;AAGf,eAAUgf,MAAUjf;AAAAA,MACrB,GAEAtL,EAAUwqE,oBAAoB8nC,oBAAoB;AACjD,YAAIhnC,IAAatrE,EAAUwqE,oBAAoBc;AAE/C,iBAASinC,EAAa/tG,GACrB;AAAA,cAAIE,IAASF,EAAEE;AAEf4mE,UAAAA,EAAWuB,OACXvB,GAAAA,EAAWoC,cAAc,IAAI1tE,EAAUwqE,oBAAoByC,cAAcvoE,GAAQ,CAAA,CAAA;AAAA,QACjF;AAED,iBAAS8tG,EAAahuG;AACrB,cAAIE,IAASF,EAAEE,UAAUF,EAAEoiB,YAEvB8wB,IAAO13C,EAAUod,MAAM62C,IAAIztC,UAAUhiB,GAAG,yBACxC+b,GAAAA,IAAOvgB,EAAUod,MAAM62C,IAAIztC,UAAUhiB,GAAG,uBAAuB,EAAA,GAC/D8pD,IAAOtuD,EAAUod,MAAM62C,IAAIztC,UAAUhiB,GAAG,mBAExCiuG,GAAAA,IAAW,GACXC,IAAY;AAChB,cAAGpkD,GAAK;AAIP,qBAHIrS,GACA02D,GACApC,IAAU7rG,GACR6rG,KAAWA,EAAQ7kF,QAAQ1H,YAAAA,KAAiB;AACjDusF,cAAAA,IAAUA,EAAQhlG;AAOnB,gBALGglG,MAEFt0D,KADA02D,IAAKpC,GACGhlG,aAGN0wC,KAAM02D,GAAG;AAEX,uBADI7yF,IAAOm8B,EAAG1wC,WAAWxI,iBAAiB,IAAA,GAClCG,IAAI,GAAGA,IAAI4c,EAAK3c,QAAQD;AAC/B,oBAAG4c,EAAK5c,CAAM+4C,KAAAA,GAAG;AAChBw2D,kBAAAA,IAAWvvG;AACX;AAAA,gBACA;AAEF,kBAAIL,IAAQo5C,EAAGl5C,iBAAiB,IAAA;AAChC,mBAAQG,IAAI,GAAGA,IAAIL,EAAMM,QAAQD;AAChC,oBAAGL,EAAMK,MAAMyvG,GAAG;AACjBD,kBAAAA,IAAYxvG;AACZ;AAAA,gBACA;AAAA,YAEF;AAAA,UACD;AACD,cAAIuf,IAAOje,EAAE+lE;AACbe,UAAAA,EAAWltD,MAAM,WAAA;AAGf,gBAAIta;AAFF4zC,aAAAA,KAAQn3B,KAAQ+tC,OAGf5W,KACF5zC,IAAU,IAAI9D,EAAUwqE,oBAAoByC,cAAcxqD,GAAM,CAAA,GAChE6oD,EAAWoC,cAAc,IAAI1tE,EAAUwqE,oBAAoByC,cAAcxqD,GAAM,CACvElC,CAAAA,KAAAA,IACRzc,IAAU,IAAI9D,EAAUwqE,oBAAoByC,cAAcxqD,GAAM,CAAA,IACxD6rC,MACRxqD,IAAU,IAAI9D,EAAUwqE,oBAAoB0C,YAAYzqD,GAAMgwF,GAAUC,CAItE5uG,IAAAA,MAEFwnE,EAAWuB,OACR/oE,GAAAA,EAAQkpE,cACV1B,EAAWyB,aAAa,MACxBzB,EAAWoC,cAAc5pE,CAM/B;AAAA,UAAA,CAAA;AAAA,QACE;AAED,YAAG9D,EAAUyf,gBAAe;AAC3B,cAAImzF,IAAgB5yG,EAAUyf;AAC9Bzf,UAAAA,EAAUyf,iBAAiB,WAC1B;AAAA,gBAAIozF,IAAMD,EAAc1mG,MAAM5C,MAAM+I,SAAAA,GAChCggG,IAAgBryG,EAAUwqE,oBAAoB2nC;AAElDnyG,YAAAA,EAAUolB,YAAYytF,GAAK,SAASL,CACpCxyG,GAAAA,EAAUI,MAAMyyG,GAAK,SAASL,IAE9BxyG,EAAUolB,YAAYytF,GAAK,SAASN,CAAAA,GACpCvyG,EAAUI,MAAMyyG,GAAK,SAASN,CAG9B;AAAA,qBADIO,IAAQ,IACJ5vG,IAAI,GAAGA,IAAImvG,EAAclvG,QAAQD;AACxC,kBAAGmvG,EAAcnvG,CAAM2vG,KAAAA,GAAI;AAC1BC,gBAAAA,IAAQ;AACR;AAAA,cACA;AAKF,gBAHIA,KACHT,EAAc1vG,KAAKkwG,CAAAA,GAEjBvnC,EAAWjrE,UAAY,GAAA;AACzB,kBAAIimB,IAAOglD,EAAWc;AACnB9lD,cAAAA,KAAQA,EAAK9f,aAAaqsG,IAC5BvnC,EAAWpgD,UAAU5E,KAErBusF,EAAI9zF,aAAa,YAAY,GAElC;AAAA,YAAA;AACI8zF,cAAAA,EAAI9zF,aAAa,YAAY,GAE9B;AAAA,mBAAO8zF;AAAAA,UACV;AAAA,QACE;AAED,YAAG7yG,EAAUwf,iBAAgB;AAC5B,cAAIuzF,IAAiB/yG,EAAUwf;AAC/Bxf,UAAAA,EAAUwf,kBAAkB,SAASqzF,GAAKt1F;AACzCs1F,YAAAA,IAAMA,MAAQ7yG,EAAUgzG,aAAahzG,EAAUgzG,WAAW/iG,aAAa;AACvE,gBAAI7I,IAAM2rG,EAAe7mG,MAAM5C,MAAM+I,SAErC;AAAA,gBAAA,CAAIwgG,MAAQA,EAAItnG;AAEf,uBADI8mG,IAAgBryG,EAAUwqE,oBAAoB2nC,gBAC1CjvG,IAAI,GAAGA,IAAImvG,EAAclvG,QAAQD;AACrCmvG,gBAAAA,EAAcnvG,MAAM2vG,MACtB7yG,EAAUolB,YAAYitF,EAAcnvG,CAAAA,GAAI,SAASqvG,CACjDF,GAAAA,EAAc7gG,OAAOtO,GAAG,CAAA,GACxBA;AAKH,mBAAOkE;AAAAA,UACV;AAAA,QACE;AAAA,MACF;AAAA,IAEA,EdxCoBpH,CAEjB;AAAA,QAAIsrE,IAAatrE,EAAUwqE,oBAAoBc;AAI/C,QAFAtrE,EAAUwqE,oBAAoB+B,wBAAAA,GAE3BvsE,EAAUyf;AAEZzf,QAAUwqE,oBAAoB8nC,kBAAAA;AAAAA;AAG9B,UAAIW,IAAajzG,EAAUsE,YAAY,oBAAoB,WAAA;AAC1DtE,UAAU6kB,YAAYouF,CACtBjzG,GAAAA,EAAUwqE,oBAAoB8nC,kBACnC;AAAA,MAAA,CAAA;AAKG,aAASY,IACR;AAAA,UAAIlzG,EAAUM,OAAOwqE,SAArB;AAEA,YACIJ,IAAe98D,SAASmd;AAQ5B,eANI2/C,EAAAA,CAAAA,KAAgB1qE,EAAUod,MAAM62C,IAAIztC,UAAUkkD,GAAc,sBAAA,EAGtD1qE,OAAAA,EAAUwqE,oBAAoBlgD,UAAUogD,GAAc1qE,EAAU8C,UAAAA,KAAe9C,EAAUwqE,oBAAoB4nC,UAAU1nC;MAR5F;AAAA,IAYrC;AAID,aAASyoC,EAAYtmC,GACjBA;AAAAA,MAAAA,KAAAA,CAAWvB,EAAWjrE,UACxBirE,IAAAA,EAAWuB,YACFA,KAAUvB,EAAWjrE,eAC9BirE,EAAWwyB,QAAAA;AAAAA,IAEZ;AAED,UAAM1oD,IAAalN,YAAY;AAC9B,UAAIloC,EAAU8C,cAAe9C,EAAUwqE,oBAAoBlgD,UAAUtqB,EAAU8C,YAAY8K,SAASmJ,IAAAA,GAApG;AAIA,YAAI81D,IAASqmC,EAEVrmC;AAAAA,QAAAA,IACFsmC,EAAYtmC,CACHA,IAAAA,CAAAA,KAAUvB,EAAWjrE,UAC9B4X,KAAAA,WAAW,WACPjY;AAAAA,YAAUkiB,eAIVliB,EAAUM,OAAOwqE,UACnBqoC,EAAYD,OAEZlzG,EAAU8C,WAAW6qE,gBAAgB,UAGtC;AAAA,QAAA,GAAE,GAlBH;AAAA,MAAA;AAAA,IAoBD,GAAE,GAAA;AACH3tE,MAAUsE,YAAY,aAAa;AAClC0jC,oBAAcoN,CAAAA;AAAAA,IAClB;EACG,EAzED;AA0EF,GdnICg+D,O6BzDc,SAASpzG,GAAAA;AAExBA,IAAUsE,YAAY,oBAAmB;AAExCgF,SAAK+pG,OAAOzoF,KAAK,SAASzI,GAAGC,GAC5B;AAAA,aAAOD,EAAE29C,SAAS19C,EAAE09C;AAAAA,IACtB,CAAA,GAEC9/D,EAAU8zC,WAAS,SAAS3J;AAC3BA,QAAGkG,WAAS,CAAC,yBAAwB,IAAG,iBAAgB,gBAExD/mC,KAAKhF,YAAY,gBAAe,SAASrB,GAAAA;AAAAA,SACnCqG,KAAKgtB,YAAYhtB,KAAKgqG,QAAQrwG,CAAAA,KAAOqG,KAAK7E,SAASxB,MAAOqG,KAAK7E,SAASxB,GAAImwG,SAASjpE,EAAGipE,SAC5FjpE,EAAGK,WAAWvnC,GAAG,IAAK,UAC1B;AAAA,MAAA,CAAA,GACEqG,KAAKhF,YAAY,uBAAsB,SAASrB,GAC/C;AAAA,YAAGqG,KAAK7E,SAASxB,CAAAA,KAAOqG,KAAK7E,SAASxB,CAAAA,EAAImwG,SAASjpE,EAAGipE,OAAO;AAC5D,cAAK9pG,CAAAA,KAAKgqG,QAAQrwG,CAAK;AAAA;AACvB,cAAIwnC,IAAEN,EAAGvlC,SAAS3B;AAElB,iBAAIwnC,KAAG,cAAcnhC,KAAKmS,cAAe0uB,EAAGK,WAAWvnC,GAAAA,EAAmB,GAAA,MACtEwnC,KAAG,cACHA,KAAG,mBAEPN,EAAGK,WAAWvnC,GAAG,IAAK;QAEtB;AACI,eAAO;AAAA,MACf,CACEqG,GAAAA,KAAKhF,YAAY,kBAAiB,SAASrB;SACrCqG,KAAKgtB,YAAYhtB,KAAKgqG,QAAQrwG,CAAAA,KAAOqG,KAAK7E,SAASxB,CAAOqG,KAAAA,KAAK7E,SAASxB,CAAImwG,EAAAA,SAASjpE,EAAGipE,SAC5FjpE,EAAGK,WAAWvnC,GAAG,IAAK,SAC1B;AAAA,MAAA,CAAA,GAEEknC,EAAGyG,cAAY,SAAS3tC,GAAGguC,GAAAA;AAC1B,YAAIlrC,IAAGuD,KAAK5G,IAAI+B,SAASxB,CAAAA,GACrB2M,IAAO,CAAA;AAEX,iBAASuS,KAAKpc;AACQ,UAAjBoc,EAAEhS,QAAQ,SAAO,MACjBpK,EAAGoc,CAAAA,KAAMpc,EAAGoc,CAAAA,EAAG0N,iBAClBjgB,EAAKuS,KAAK7Y,KAAK5G,IAAIk0B,SAASsf,WAAWnwC,EAAGoc,MAE1CvS,EAAKuS,CAAAA,IAAKpc,EAAGoc,CAAAA;AAEf,eAAOvS;AAAAA,MACV,GACEu6B,EAAGopE,mBAAiB;SAEpBppE,EAAG7lC,YAAY,kBAAkBtE,EAAU6qC,gBAC3CV,GAAAA,EAAG7lC,YAAY,kBAAkBtE,EAAU6qC,gBAC3CV,GAAAA,EAAG7lC,YAAY,kBAAkB,SAASwmC,GAAK7nC,GAC9CqG;AAAAA,aAAK5G,IAAIqoC,YAAY9nC,GAAIqG,KAAK0hC,cAAc,cAC5C1hC,GAAAA,KAAK5G,IAAI6Y,YAAYtY,CAAAA;AAAAA,MACxB;IACA,GAEC,WAAA;AACO,UAAIuwG,IAAY,SAAS9wG,GAAAA;AACrB,YAAGA,MAAQ,eAAe8B,KAAQ;AAC9B,iBAAO9B;AACX,YAAI+qB,IAAO,IAAI/qB,EAAIob;AACnB,iBAAQzK,KAAO3Q;AACX+qB,UAAAA,EAAKpa,CAAOmgG,IAAAA,EAAU9wG,EAAI2Q,CAC9B,CAAA;AAAA,eAAOoa;AAAAA,MACnB;AAEEztB,QAAUyzG,kBAAkB,IAC5BzzG,EAAU0zG,iBAAiB;AAC3B,eAAQxwG,IAAE,GAAGA,IAAElD,EAAUqzG,OAAOlwG,QAAQD,KAAK;AAI5C,YAHAlD,EAAUM,OAAO,cAAYN,EAAUqzG,OAAOnwG,CAAAA,EAAGqV,IAAQ,IAAA,IAChDvY,EAAUM,OAAO,cAAYN,EAAUqzG,OAAOnwG,CAAGqV,EAAAA,IAAAA,EAAMlX,WAAWmyG,EAAUxzG,EAAUM,OAAO63B,SAAS92B,QAAAA,GAC/GrB,EAAU0zG,eAAe1zG,EAAUqzG,OAAOnwG,CAAGqV,EAAAA,IAAAA,IAAQvY,EAAUM,OAAOqzG,wBAAsB,IAAM,IAAFzwG,GAC7FlD,EAAUqzG,OAAOnwG,CAAGiT,EAAAA,KAAK;AAC3B,cAAIg0B,IAAKnqC,EAAUskE,oBAAoB,EACtCnuD,KAAKnW,EAAUqzG,OAAOnwG,CAAAA,EAAGiT;AAE1Bg0B,UAAAA,EAAGipE,QAAQpzG,EAAUqzG,OAAOnwG,CAAAA,EAAGqV,MAC/BvY,EAAUyzG,gBAAgB9wG,KAAKwnC,CAAAA,GAC/BnqC,EAAUyzG,gBAAgBvwG,GAAG+qB,KAAKjuB,CAAAA;AAAAA,QAClC;AACEA,UAAUqzG,OAAOnwG,GAAG0wG,cACtB5zG,EAAU6zG,eAAe7zG,EAAUqzG,OAAOnwG,CAAAA,EAAGqV;AAAAA,MAC9C;AAAA,IACD,KAGDvY,EAAU8zG,YAAY,SAASC,GAC9BzqG;AAAAA,WAAK0qG,YAAYD,GAAAA,EACnB;AAAA,IAAA,GAEC/zG,EAAUi0G,YAAY,SAASF;AAC9BzqG,WAAK0qG,YAAYD,KACnB;AAAA,IAAA,GAEC/zG,EAAUg0G,cAAc,SAASD,GAAQG;AACxC,UAAId,IAAQ9pG,KAAK6qG,SAASJ,CAAAA;AAGzBX,MAAAA,EAAMc,UADGA,MAAW,SACFA,CAAAA,CAAAA,IAAAA,CAEDd,EAAMc,SAExB5qG,KAAKuM,eAAevM,KAAK8J,OAAO9J,KAAKoB,KAAAA;AAAAA,IACvC,GAEC1K,EAAUm0G,WAAW,SAASJ,GAAAA;AAC7B,UAAIX,GACHgB;AACmB,MAAVL,OAAAA,KAAU,aACnBK,IAAaL,IACM,OAAVA,KAAU,aACnBK,IAAaL,EAAOX;AACrB,eAASlwG,IAAE,GAAGA,IAAElD,EAAUqzG,OAAOlwG,QAAQD;AACrClD,UAAUqzG,OAAOnwG,CAAAA,EAAGqV,QAAQ67F,MAC9BhB,IAAQpzG,EAAUqzG,OAAOnwG,CAE3B;AAAA,aAAOkwG;AAAAA,IACT,GAECpzG,EAAUsE,YAAY,oBAAoB,SAAUgjE,GACnD;AAAA,UAAIvhE,IAAKuD,KAAK7E,SAAS6iE,CAGvB;AAAA,aAFMh+D,KAAKhJ,OAAO63B,SAAS92B,WAAWiI,KAAKhJ,OAAO,cAAYyF,EAAGqtG,KAAO/xG,EAAAA,UAClErB,EAAUk+B,cACT,GAAA;AAAA,IACT,IAECl+B,EAAUsE,YAAY,WAAW,SAAUgjE,GAAU+sC,GACpD;AAAA,UAAItuG,IAAK/F,EAAUyE,SAAS6iE,CACtB;AAAA,aAAA,CAAQtnE,EAAUm0G,SAASpuG,EAAGqtG,OAAOkB;AAAAA,IAC7C,CAAA,GAECt0G,EAAUsE,YAAY,oBAAoB,SAASyB,GAAIoC,GACtD;AAAA,UAAIirG,IAAQ9pG,KAAK6qG,SAASpuG;AAC1B,UAAIqtG,CAAAA,EAAMhd;AACT,eAAA;AAED,eADIlrC,IAAQ,GACJhoD,IAAI,GAAGA,IAAEiF,EAAIhF,QAAQD;AACzBiF,UAAIjF,CAAGkwG,EAAAA,SAASA,EAAM76F,QAAQpQ,EAAIjF,GAAGD,MAAM8C,EAAG9C,MAChDioD;AAEF,aAAQA,KAASlrD,EAAUM,OAAO61F;AAAAA,IACpC,IAECn2F,EAAU6a,WAAS,SAAStZ,GAAWC,GAASgb,GAAKvZ,GAAGk2D,GAAAA;AACvD,UAAIpzD,IAAGxE;AACe,MAAlB8Q,UAAUlP,UAAQ,OACrB4C,IAAGozD,KAAY,IACZ53D,aAAWA,GACdwE,EAAGvE,WAASA,GACZuE,EAAGyW,OAAKA,GACRzW,EAAG9C,KAAGA,GACN8C,EAAGqtG,QAAQ9pG,KAAKuqG,eAEjB9tG,EAAG9C,KAAK8C,EAAG9C,MAAIjD,EAAUqM,OACzBtG,EAAGyW,OAAOzW,EAAGyW,QAAM,WAGRzW,EAAGxE,cAAc,aAAWwE,EAAGxE,aAAW+H,KAAKmR,UAAUs8C,SAAShxD,EAAGxE,UAAAA,WACrEwE,EAAGvE,YAAY,aAAWuE,EAAGvE,WAAS8H,KAAKmR,UAAUs8C,SAAShxD,EAAGvE,QAAAA,IAC5EuE,EAAG4C,SAAOW,KAAKV,cAAc7C,CAE7B;AAAA,UAAIyjD,KAAQlgD,KAAKoN,QAAQ3Q,EAAG9C,EAAAA;AAC5BqG,WAAKoN,QAAQ3Q,EAAG9C,EAAI8C,IAAAA,GACpBuD,KAAK4qC,cAAcnuC,CAAAA,GACduD,KAAKgtB,YACThtB,KAAKH,UAAUqgD,IAAO,iBAAe,kBAAiB,CAACzjD,EAAG9C,IAAG8C,CAChE,CAAA;AAAA,IAAA,GAECuD,KAAKirG,aAAa;AAClB,aAASrxG,IAAI,GAAGA,IAAIoG,KAAK+pG,OAAOlwG,QAAQD;AACvCoG,WAAKirG,WAAWjrG,KAAK+pG,OAAOnwG,CAAAA,EAAGqV,IAAQ,IAAA,CAAA;AAGxCvY,MAAU6T,cAAY,SAAS5G,GAAMC,GAAI1I,GAAAA;AACxC,UAAIkgD,IAAO,CAAA;AACS,MAAA,OAATz3C,KAAS,aACnBy3C,IAAOz3C,GACPA,IAAQ;AAGT,UAAI0E,IAAwD,OAAnDrI,KAAKhJ,OAAOm7B,kBAAgBnyB,KAAKhJ,OAAOq6B;AAC5C1tB,YAAOA,IAAQmC,KAAKM,MAAO1P,EAAU+J,aAAgBtH,EAAAA,QAAAA,IAAUkP,KAAGA;AACvE,UAAIpQ,IAAa,IAAIiB,KAAKyK,CAAAA;AAC1B,WAAKC,GAAI;AACR,YAAIy3C,IAAar7C,KAAKhJ,OAAO8J;AACzBu6C,QAAAA,IAAapjD,EAAW4I,SAAAA,MAC3B5I,EAAWyH,SAAS27C,IACpB13C,IAAQ1L,EAAWkB,YAEpByK,IAAMD,IAAM0E;AAAAA,MACZ;AAGD+yC,MAAAA,EAAKnjD,aAAamjD,EAAKnjD,cAAYA,GACnCmjD,EAAKljD,WAAYkjD,EAAKljD,YAAU,IAAIgB,KAAK0K,IACzCw3C,EAAKloC,OAAOkoC,EAAKloC,QAAMlT,KAAKokB,OAAOwN,OAAO3e,WAC1CmoC,EAAKzhD,KAAKqG,KAAKR,WAAWQ,KAAK+C,IAAAA,GAC/Bq4C,EAAK0uD,QAAQ9pG,KAAKuqG,cAClBvqG,KAAKP,aAAW,YAEhBO,KAAKgtB,WAAS,IACdhtB,KAAKuR,SAAS6pC,CAAAA,GACdp7C,KAAKH,UAAU,kBAAiB,CAACG,KAAKR,UAAStE,CAAAA,CAAAA,GAC/C8E,KAAKgtB,WAAS,IAEdhtB,KAAKs7C,cAAY,IACjBt7C,KAAKs6B,aAAap/B,CAAAA;AAAAA,IACpB,GAECxE,EAAUw0G,sBAAsB,SAAS14F,GACxC;AAAA,UAAIxS,KAAKhJ,OAAO4sD,aAAAA,CAAc5jD,KAAKmB,aAAa;AAG/C,iBAFI4vD,IAAM,CAAA,GACNC,IAAM,CACD3tD,GAAAA,IAAI,GAAGA,IAAImP,EAAO3Y,QAAQwJ;AAC9BmP,UAAAA,EAAOnP,CAAAA,EAAGhE,SACb0xD,EAAI13D,KAAKmZ,EAAOnP,CAEhB2tD,CAAAA,IAAAA,EAAI33D,KAAKmZ,EAAOnP,CAAAA,CAAAA;AAElBrD,aAAKmB,cAAAA,IACLnB,KAAKyM,YAAYukD,CACjBhxD,GAAAA,KAAKmB,kBACLnB,KAAKyM,YAAYskD,CACjB;AAAA,MAAA;AAEA/wD,aAAKyM,YAAY+F,CACpB;AAAA,IAAA,GAEC9b,EAAUgW,mBAAmB,WAAA;AAC5B,UAAI1M,KAAKitB;AACRjtB,aAAKktB,eAAe;AAAA,WADrB;AAIAltB,aAAKktB,eAAe,IAEpBltB,KAAK4vD,WAEL5vD,GAAAA,KAAKirG,aAAa;AAClB,iBAASrxG,IAAI,GAAGA,IAAIoG,KAAK+pG,OAAOlwG,QAAQD;AACvCoG,eAAKirG,WAAWjrG,KAAK+pG,OAAOnwG,GAAGqV,IAAQ,IAAA,CAAA;AAGxC,YAAIpQ,IAAMmB,KAAKwwD,mBAAAA;AACf,aAAS52D,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC5BoG,eAAKirG,WAAWpsG,EAAIjF,CAAAA,EAAGkwG,KACzB9pG,KAAAA,KAAKirG,WAAWpsG,EAAIjF,CAAAA,EAAGkwG,OAAOzwG,KAAKwF,EAAIjF;AAGzC,YAAGoG,KAAKoB,SAAS,SAAS;AACzB,cAAIgsF,IAAO,CACX;AAAA,eAASxzF,IAAI,GAAGA,IAAIoG,KAAK+pG,OAAOlwG,QAAQD;AACnCoG,iBAAK+pG,OAAOnwG,CAAAA,EAAGgxG,YAClBxd,IAAOA,EAAKjtF,OAAOH,KAAKirG,WAAWjrG,KAAK+pG,OAAOnwG,CAAAA,EAAGqV,IAEpDjP,CAAAA;AAAAA,eAAKkrG,oBAAoB9d,CAAAA;AAAAA,QACzB;AAEA,eAASxzF,IAAI,GAAGA,IAAIoG,KAAK+pG,OAAOlwG,QAAQD;AACvC,gBAAIoG,KAAK+pG,OAAOnwG,CAAAA,EAAGgxG,SAAS;AAC3B,kBAAIO,IAAYnrG,KAAKirG,WAAWjrG,KAAK+pG,OAAOnwG,CAAAA,EAAGqV;AAC/CjP,mBAAKkrG,oBAAoBC;YACzB;AAAA,MA7BF;AAAA,IAgCH,GAECz0G,EAAU4/D,gBAAc,SAAS75D,GAAGulB,GAAED,GAAE7J,GAAEI,GAAE3gB,GAAMu/D,GAASC,GAASr1C,GAAAA;AACnE,UAAInoB,IAAK8C,EAAG9C;MAETu9D,EAASrwD,QAAQ,aAAA,YACnBqwD,IAAYxgE,EAAUya,UAAU,kBAAgB1U,EAAGqtG,SAAQpzG,EAAUya,UAAU,kBAAgB1U,EAAGqtG,KAAAA,EAAOrtG,EAAGxE,YAAWwE,EAAGvE,UAASuE,KAAIy6D,IACrIC,EAAStwD,QAAQ,aAAA,KAAmB,OACvCswD,IAAYzgE,EAAUya,UAAU,gBAAc1U,EAAGqtG,KAAQpzG,IAAAA,EAAUya,UAAU,gBAAc1U,EAAGqtG,OAAOrtG,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAAA,IAAI06D;AAEnI,UAAI9uD,IAAE/D,SAASC,cAAc,KACzB6sC,GAAAA,IAAK,iBACLgmB,IAAO1gE,EAAUya,UAAU,iBAAe1U,EAAGqtG,KAAQpzG,IAAAA,EAAUya,UAAU,iBAAe1U,EAAGqtG,KAAOrtG,EAAAA,EAAGxE,YAAWwE,EAAGvE,UAASuE,KAAI/F,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAC1L26D;AAAAA,MAAAA,MAAKhmB,IAAGA,IAAG,MAAIgmB;AAEnB,UAAIg0C,IAAY10G,EAAUknC,mBAAAA,GAEtBytE,IAAiBnzF,IAAI,GACrBm/C,IAAW+zC,IAAYC,IAAkBnzF,IAAE,GAC/CozF,IAAcF,IAAYC,IAAkBnzF,IAAE,GAC9CqzF,IAAYH,IAAYC,IAAkBnzF,IAAE,IAC5CszF,IAAcJ,IAAaC,IAAiB,IAAMnzF,IAAE,GAEhDuzF,IAAaL,IAAa9yF,IAAItY,KAAKyX,GAAG4hC,sBAAwB/gC,IAAE,KAAK,GAErElgB,IAAK,oBAAkBuB,IAAG,OAAKjD,EAAUM,OAAO0C,kBAAgB,OAAKC,IAAG,cAAYy3C,IAAG,qCAAmCrvB,IAAE,cAAYC,IAAE,eAAaq1C,IAAS,gBAAc/+C,IAAE,SAAO3gB,KAAO,MAAI;AAQtM,aAPAS,KAAM,2CAAyCkzG,IAAY,sBAC3DlzG,KAAM,4BAA0B8+D,IAAS,UACzC9+D,KAAM,yCAAuCmzG,IAAU,gBAAcE,IAAW,UAAQt0C,IAAS,UACjG/+D,KAAM,2CAAyCozG,IAAY,SAAO1pF,IAAO,sBAAoB,MAAI,mBAEjGzZ,EAAE7D,YAAUpM,GACZiQ,EAAE1Q,MAAM6+D,SAAS,KACVnuD,EAAE1B;AAAAA,IACX,GAECjQ,EAAUq7D,mBAAiB,SAASt1D,GACnC;AAAA,UAAIuF,IAAOhC,KAAKO,KAAmB,aAAE,CAEjCyhB,GAAAA,IAAEhiB,KAAKi8C,OAAOx/C,EAAG80D,QACjBM,IAAG7xD,KAAKi8C,OAAOx/C,EAAG+0D,KAAAA;AAClBK,MAAAA,KAAI7vC,MAAG6vC,IAAG7xD,KAAKi8C,OAAOx/C,EAAG+0D,QAAM;AACnC,UAAIa,IAAKryD,KAAKyX,GAAG+mB,YAEbzc,IAAE/hB,KAAKi8C,OAAOE,QAAQ1/C,EAAGi1D,MAAS1xD,KAAAA,KAAKi8C,OAAOx2C,SAAQzF,KAAKyX,GAAGshC,qBAAmB,IAAG,KAAGt8C,EAAGu+B,UAAQq3B,GAElGhqD,IAAE/D,SAASC,cAAc,QACzB6sC,IAAK30C,EAAG4C,SAAO,wBAAsB,sBACrC+3D,IAAO1gE,EAAUya,UAAU,iBAAe1U,EAAGqtG,KAAQpzG,IAAAA,EAAUya,UAAU,iBAAe1U,EAAGqtG,OAAOrtG,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAAA,IAAI/F,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAWwE,EAAGvE,UAASuE;AAC1L26D,MAAAA,MAAKhmB,IAAGA,IAAG,MAAIgmB;AAEnB,UAAIh/D,IAAK,oBAAkBqE,EAAG9C,KAAG,OAAKqG,KAAKhJ,OAAO0C,kBAAgB,OAAK+C,EAAG9C,KAAG,cAAYy3C,IAAG,qCAAmCrvB,IAAE,cAAYC,IAAE,gBAAc6vC,IAAG7vC,IAAE,MAAI,SAAOvlB,EAAG85D,eAAa,MAAI;AAE7L95D,QAAG4C,WACNjH,KAAO1B,EAAUya,UAAU,oBAAkB1U,EAAGqtG,KAAQpzG,IAAAA,EAAUya,UAAU,oBAAkB1U,EAAGqtG,KAAOrtG,EAAAA,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAI/F,IAAAA,EAAUya,UAAU+9C,eAAezyD,EAAGxE,YAAWwE,EAAGvE,UAASuE,CACpMrE,IAAAA,KAAS1B,EAAUya,UAAU,oBAAkB1U,EAAGqtG,KAAAA,IAAQpzG,EAAUya,UAAU,oBAAkB1U,EAAGqtG,KAAOrtG,EAAAA,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAAA,IAAI/F,EAAUya,UAAUuiB,eAAej3B,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAM,IAAA,WAC3MrE,KAAM,UAENiQ,EAAE7D,YAAUpM,GAEZ4H,KAAKo8B,UAAU/iC,KAAKgP,EAAE1B,UAAAA,GACtB3E,EAAOyC,YAAY4D,EAAE1B,UACvB;AAAA,IAAA,GAECjQ,EAAUy7D,eAAa,SAAS11D,GAC/B;AAAA,UAAIs5D,IAAOr/D,EAAU+gB,GAAGuhC;AAIxB,UAHGtiD,EAAUm0G,SAASpuG,EAAGqtG,KAAOkB,EAAAA,WAC/Bj1C,IAAO,IAEJt5D,EAAAA,EAAG80D,QAAM,IAAb;AACA,YAAIvvD,IAAOtL,EAAUmP,cAAcpJ,EAAG80D,KACtC;AAAA,YAAKvvD,GAAL;AACA,cAAI0zD,IAA8B,KAAzBj5D,EAAGxE,WAAW4I,SAAcpE,IAAAA,EAAGxE,WAAWkK,WAC/C0zD,GAAAA,IAA6B,KAAvBp5D,EAAGvE,SAAS2I,aAAcpE,EAAGvE,SAASiK,gBAA2C,KAA3BzL,EAAUM,OAAO+J,WAE7EnJ,IAAOkO,KAAKM,OAAU,KAAHsvD,IAAM,MAA4B,KAAvB11D,KAAKhJ,OAAO8J,aAAc,KAAG,OAAMd,KAAKhJ,OAAOkP,wBAAsD,KAAzBlG,KAAKhJ,OAAOkP,gBAAiB,GACvIT,IAASK,KAAKC,IAAIrP,EAAU+gB,GAAGmhC,mBAAkBid,IAAGH,KAAI11D,KAAKhJ,OAAOkP,eAAa,EAAI,IAAA,GAErFR,IAAMI,KAAK+D,OAAO7H,EAAOqW,cAAY09C,KAAMt5D,EAAGw+B,SAC9CpjC,IAAK4E,EAAGu+B,UAAQt1B,IAAM;AACrBjJ,YAAGs3D,WAAQruD,KAAajJ,EAAGw+B,SAAOx+B,EAAGu+B;AAI1C,cAAI3yB,IAAErI,KAAKs2D,cAAc75D,EAAG9C,IAAGo8D,IAAKl+D,GAAKD,GAAI8N,GAAMD,GAAOhJ,EAAG85D,aAAY7/D,EAAUya,UAAUqiB,aAAa/2B,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAI/F,GAAAA,EAAUya,UAAU02C,WAAWprD,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAAA,CAAAA;AAUjM,cARAuD,KAAKo8B,UAAU/iC,KAAKgP,CACpBrG,GAAAA,EAAOyC,YAAY4D,CAEnBxQ,GAAAA,IAAKA,IAAKynB,SAAStd,EAAOrK,MAAME,MAAK,EAAA,IAAIk+D,GAEzCn+D,KAAKoI,KAAKohD,WACV/4C,EAAE1Q,MAAM6+D,SAASx2D,KAAKoqG,eAAe3tG,EAAGqtG,QAEpC9pG,KAAKy6C,YAAUh+C,EAAG9C,IAAG;AACxB0O,YAAAA,EAAE1Q,MAAM6+D,SAASl3C,SAASjX,EAAE1Q,MAAM6+D,MAAAA,IAAQ;AAC1C,gBAAIk1C,IAAarjG,EAAE1Q,MAAM6+D;AACzB9wD,YAAAA,IAAMI,KAAKC,IAAIL,IAAM,GAAEhP,EAAU+gB,GAAG0hC,gBAChC9wC,IAAE/D,SAASC,cAAc,KAC3BkR,GAAAA,aAAa,YAAWhZ,EAAG9C,EAC7B0O,GAAAA,EAAEoN,aAAazV,KAAKhJ,OAAO0C,iBAAgB+C,EAAG9C,EAAAA,GAC9CqG,KAAKy5C,OAAOpxC,GAAE3C,GAAMD,IAAO,IAAG5N,GAAKD,IAAI,EACvCyQ,GAAAA,EAAE7C,YAAU,kBACZ6C,EAAE1Q,MAAM6+D,SAASk1C;AACjB,gBAAI98C,IAAGtqD,SAASC,cAAc;AAC9BvE,iBAAKy5C,OAAOmV,GAAGlpD,IAAM,GAAED,IAAO,EAC9BmpD,GAAAA,EAAGj3D,MAAMgzC,WAAS,4CAGlBikB,EAAGj3D,MAAM6+D,SAASk1C,GAClBrjG,EAAE5D,YAAYmqD,CAAAA,GACd5uD,KAAKO,KAAmB,aAAE,GAAGkE,YAAY4D,CAAAA,GACzCrI,KAAKo8B,UAAU/iC,KAAKgP,IAEpBumD,EAAGpqD,YAAU,sCAAoC/H,EAAGyW,OAAK,eAEzDlT,KAAK22D,UAAQ/H,EAAGjoD,YAChB3G,KAAK22D,QAAQ96C,iBAAiB,YAAY,SAAS3gB;AAClD,kBAAIA,EAAE46B;AAAU,uBAAA;AAChB,kBAAIvjB,IAAMrX,EAAE26B;AACRtjB,cAAAA,KAAM7b,EAAUq/B,KAAKC,aAAWt/B,EAAUywC,SAAAA,EAC1C50B,GAAAA,KAAM7b,EAAUq/B,KAAKE,eAAav/B,EAAUywC,SAAAA;YACpD,CACGnnC,GAAAA,KAAK22D,QAAQ96C,iBAAiB,eAAe,SAAS3gB,GAAAA;AAAyB,qBAArBA,EAAEigC,mBAA0B;AAAA,YAAO,IAC7FyzB,EAAGjoD,WAAWopB,SAEd/vB,KAAKO,KAAmB,aAAE,CAAA,EAAG8f,aAAW,GACxCuuC,EAAGjoD,WAAW0X,OAAAA;AAAAA,UACd;AACD,cAAIre,KAAKq6C,cAAY59C,EAAG9C,IAAG;AAC1B0O,YAAAA,EAAE1Q,MAAM6+D,SAASl3C,SAASjX,EAAE1Q,MAAM6+D,UAAQ;AAG1C,qBAFIK,IAAM72D,KAAKhJ,OAAO,YAAWgJ,KAAKy6C,YAAUh+C,EAAG9C,KAAI,SAAO,YAC1Dm9D,IAAU,IACLl9D,IAAE,GAAGA,IAAEi9D,EAAMh9D,QAAQD;AAC7Bk9D,cAAAA,KAAW,+BAA6BD,EAAMj9D,CAAAA,IAAG,cAAYoG,KAAKokB,OAAOwN,OAAOilC,EAAMj9D,CAAAA,CAAAA,IAAI;AAC3F,gBAAIR,IAAM4G,KAAKs2D,cAAc75D,EAAG9C,IAAG9B,IAAKk+D,IAAK,GAAEn+D,GAAIm+D,GAAkB,KAAbc,EAAMh9D,SAAU,IAAG,IAAG,qCAAoCi9D,GAAU,EAAA;AAC5H19D,YAAAA,EAAIzB,MAAME,OAAKA,IAAKk+D,IAAK,GACzB38D,EAAIzB,MAAM6+D,SAASnuD,EAAE1Q,MAAM6+D,QAC3Bx2D,KAAKO,KAAmB,aAAE,CAAA,EAAGkE,YAAYrL,CACzC4G,GAAAA,KAAKo8B,UAAU/iC,KAAKD,CACpB;AAAA,UAAA;AAAA,QArEmB;AAAA,MAFG;AAAA,IAyEzB,GAEI1C,EAAUi1G,gBAAgB,SAAShyG,GAAI7C,GACnC;AAAA,UAAIgzG,IAAQpzG,EAAUm0G,SAAS/zG,EAAMgzG;AACrC,aAAQA,KAASA,EAAMc;AAAAA,IAC/B;AAAA,EACA;AAGA,G7BtWCluC,Q8BvDc,SAAShmE,GAAAA;AAAAA,GCDT,WAIVF;AAAAA,IAAAA,EAAOwzB,WACXxzB,EAAOwzB,SAAS,SAAU5wB,GACzB;AAAA,eAASyf,KAAKzf;AAAK4wB,QAAAA,EAAOnR,CAAAA,IAAKzf,EAAIyf,CAAAA;AACnC,aAAOmR;AAAAA,IACT;AAEA,QAAIA,IAASxzB,EAAOwzB;AAiEpB,aAAS4hF,EAAoBC,GAAYC,GAAaxgD,GAAOygD;AAY5D,aAXA/rG,KAAK0pB,SAAS,IAGb1pB,KAAKsrD,QADFzyC,gBACUyyC,GAIdtrD,KAAKgsG,eAAeH,KAAc,MAClC7rG,KAAKisG,aAAaH,KAAe,MACjC9rG,KAAKkjE,WAAW,MAChBljE,KAAK+rG,QAAQA,KAAAA,IACN/rG;AAAAA,IACR;AA0LA,aAASksG,IAAAA;AACR,aAAI11G,EAAO21G,mBACH31G,EAAO21G,oBAEfnsG,KAAKosG,cAAc,GACnBpsG,KAAKqsG,WAAW,GAChBrsG,KAAKssG,gBAAgB,GACrBtsG,KAAKusG,kBAAkB,GACvBvsG,KAAKwsG,WAAW,MAChBxsG,KAAKysG,WAAW,MAChBzsG,KAAK0sG,WAAW,GAChBl2G,EAAO21G,mBAAmBnsG,MAEnBA;AAAAA,IACR;AApRAgqB,IAAAA,EAAO2iF,aAAa,SAAU19F,GAAM1U,GAAKgZ;AACxC,UAAItK,IAAIzS,EAAOyY,CACVhG;AAAAA,MAAAA,MACLzS,EAAOyY,CAAQ,IAAA,SAAU7V,GACxB;AAAA,YAAIgxC;AAEJ,YAAIhxC,KAAcA,OAAAA,KAAO,YAAPA,CAAoBA,EAAIgpB,SAAS;AAGlD,mBAASvJ,KAFTuxB,IAAOnhC,EAAErG,MAAM5C,MAAOzF,EAAIqyG,QAAQryG,EAAIqyG,MAAMxzG,CAAO2P,IAAAA,SAAAA,GAErCihB;AACTzvB,YAAAA,EAAIse,CAAAA,KAAI7Y,KAAKzF,EAAIse,CAAImR,CAAAA,EAAAA,EAAOnR;AAEjC,mBAASA,KAAKzf;AACTmB,YAAAA,EAAIse,KAAI7Y,KAAKzF,EAAIse,CAAIzf,CAAAA,EAAAA,EAAIyf,CACA,CAAA,IAApBA,EAAEhS,QAAQ,IAAA,MAAU,KAC5B7G,KAAKhF,YAAY6d,GAAGzf,EAAIyf,CAG1B,CAAA;AAAA,QAAA;AACAuxB,UAAAA,IAAOnhC,EAAErG,MAAM5C,MAAM+I;AAEtB,eADIxO,EAAIsyG,UAAQtyG,EAAIsyG,OAAO7sG,OACpBoqC,KAAQpqC;AAAAA,MACjB,GACCxJ,EAAOyY,CAAMsF,EAAAA,YAAYtL,EAAEsL,WACvBhB,KAkqBL,SAAoBsF,GAAGC,GAAAA;AACtB,iBAASla,KAAKka;AACQ,UAAA,OAATA,EAAEla,CAAAA,KAAO,eACpBia,EAAEja,CAAKka,IAAAA,EAAEla;MAEZ,EAtqBapI,EAAOyY,CAAMsF,EAAAA,WAAWhB,CACrC;AAAA,IAAA,GAGA/c,EAAOggG,aAAa,EACnBvtE,KAAK,SAAUpc,GAAKzB,GACnB;AAAA,UAAInC,IAAI,IAAI2iG,EAAAA,EAIZ;AAAA,aAHA3iG,EAAEqiD,QAASviD,UAAUlP,SAAS,GAC9BoP,EAAEi6D,WAAW93D,GACbnC,EAAEyiD,QAAQ7+C,CAAAA,GACH5D;AAAAA,IACP,GACD0jD,MAAM,SAAU9/C,GAAK8/C,GAAMvhD,GAAAA;AAC1B,UAAInC,IAAI,IAAI2iG,IAIZ;AAAA,aAHA3iG,EAAEqiD,QAASviD,UAAUlP,SAAS,GAC9BoP,EAAEi6D,WAAW93D,GACbnC,EAAEyiD,QAAQ7+C,GAAK,IAAM8/C,CACd1jD,GAAAA;AAAAA,IACP,GACDsjD,SAAS,SAAU1/C,GAClB;AAAA,aAAO7M,KAAKipB,IAAIpc,GAAK,QACrB;AAAA,IAAA,GACD+/C,UAAU,SAAU//C,GAAK8/C,GAAAA;AACxB,aAAO3sD,KAAK2sD,KAAK9/C,GAAK8/C,GAAM,MAAA;IAC5B,EA6BFn2D,GAAAA,EAAOo1G,sBAAsBA,GAE7BA,EAAoBhqD,QAAQ,GAQ5BgqD,EAAoBr3F,UAAUu4F,mBAAmB,SAAUhB,GAAAA;AAC1D,UAAIn5F,IAAO;AAmBX,aAlBA3S,KAAKimD,QAAQ,WAAA;AACZ,YAAI/qD,KAAkB4wG,EAAwB,kBACvCA,EAAYpiF,OAAOqjC,cAAgB++C,EAAYpiF,OAAOqjC,cAAc,IAAI;AAC7E,cAAA,CAAKp6C;AACJ;AAEDA,UAAAA,IAAAA,IACAi5F,EAAoBhqD,gBACTkqD,EAAYE,gBAAgB,cACtCF,EAAYE,aAAaF,EAAYG,YAAY,MAAM,MAAM,MAAMH,IAEhEA,EAAY5oC,aACf4oC,EAAY5oC,SAASj4D,KAAKjL,MAAM8rG,CAAAA,GAChCA,EAAY5oC,WAAW;AAAA,QAExB;AAAA,MAEJ,GACQljE,KAAKimD;AAAAA,IACb,GASA2lD,EAAoBr3F,UAAUw4F,gBAAgB,SAAU3qF,GAAS4qF,GAChE;AAAA,UAAI7rE;AAEJ,UAAInhC,KAAK0pB,OAAOD,aAAa;AAE5B,aADItF,IAAOnkB,KAAK0pB,OAAOD,YAAY+F,qBAAqBpN,IAC/CvoB,WAAW,KAAKuoB,EAAQvb,QAAQ,GAAA,KAAS;AACjD,cAAIsd,IAAOnkB,KAAK0pB,OAAOD,YAAY+F,qBAAsBpN,EAAQ/nB,MAAM,GAAM,EAAA,CAAA,CAAA;AAC9E8mC,QAAAA,IAAIhd,EAAK,CAAA;AAAA,MACT;AACAgd,QAAAA,IAAInhC,KAAK0pB,OAAOtR;AAEjB,aAAI+oB,KACHnhC,KAAKitG,SAAS,IACP9rE,MAGHnhC,KAAKitG,UAAUC,KACnBltG,KAAKitG,SAAAA,IACDD,IAAShtG,KAAK0pB,QAClB1pB,KAAKmtG,cAAcntG,KAAK0pB,OAAOC,aAAapb,QAAQ,UAAU,EAAK,GAAA,EAAA,GAC5DvO,KAAK+sG,cAAc3qF,GAAS4qF,CAAAA,MAGpC9xC,YAAY4J,WAAW,WAAW,iBAAiB,CACjDkoC,KAAUhtG,KAAK0pB,QAChB1pB,KAAKisG,UAGC3nG,CAAAA,GAAAA,SAASC,cAAc,KAAA;AAAA,IAC/B,GAQAqnG,EAAoBr3F,UAAU44F,gBAAgB,SAAUC,GAAWt9C;AAElE,UAAKo9C;AAIJltG,aAAK0pB,SAAS,IAAI+hC,cAAc,qBAChCzrD,KAAK0pB,OAAO4hC,QAAQtrD,KAAKsrD,OACzBtrD,KAAK0pB,OAAO2jF,qBAAqB;WACjCrtG,KAAK0pB,OAAqB,QAAE0jF,CAAAA;AAAAA,WAPjB;AACX,YAAIvgF,IAAS,IAAI2+B;AACjBxrD,aAAK0pB,SAASmD,EAAO8+B,gBAAgByhD,GAAW;MAClD;AAOKt9C,MAAAA,MAGA9vD,KAAKgsG,gBACRhsG,KAAKgsG,aAAahsG,KAAKisG,YAAY,MAAM,MAAM,MAAMjsG,IAAAA,GAElDA,KAAKkjE,aACRljE,KAAKkjE,YACLljE,KAAKkjE,WAAW;AAAA,IAElB,GASA0oC,EAAoBr3F,UAAUm3C,UAAU,SAAUsB,GAAUsgD,GAAUC,GAAUC,GAAAA;AAC3ExtG,WAAK+rG,UACR/+C,MAAcA,EAASnmD,QAAQ,GAAc,KAA7CmmD,KAA6C,MAAM,OAAO,kBAAiB,oBAAK9zD,QAAQC,QAAAA,IACzF6G,KAAKgtD,WAAWA,GAAAA,CAEVkgD,KAAW12G,EAAqB,iBACrCwJ,KAAK0pB,SAAS,IAAImjC,mBAElB7sD,KAAK0pB,SAAS,IAAI+hC,cAAc,mBAG7BzrD,GAAAA,KAAKsrD,UACRtrD,KAAK0pB,OAAO2jF,qBAAqB,IAAIrtG,KAAK8sG,iBAAiB9sG,QACjDstG,OAAAA,KAAY,WACtBttG,KAAK0pB,OAAOujC,KAAKqgD,GAAUtgD,GAAUhtD,KAAKsrD,KAE1CtrD,IAAAA,KAAK0pB,OAAOujC,KAAKqgD,IAAW,SAAS,OAAOtgD,GAAUhtD,KAAKsrD,KAAAA,GAExDkiD,KACHxtG,KAAK0pB,OAAOif,iBAAiB,cAAc,qBAAqB7oB,UAAUC,YAAY,GAAA,GACtF/f,KAAK0pB,OAAOif,iBAAiB,gBAAgB,UAGrC2kE,KAAAA,KACRttG,KAAK0pB,OAAOif,iBAAiB,gBAAgB,sCAE9C3oC,KAAK0pB,OAAOif,iBAAiB,oBAAoB,gBAAA,GACjD3oC,KAAK0pB,OAAOxZ,KAAaq9F,CAEpBvtG,GAAAA,KAAKsrD,SACT,IAAKtrD,KAAK8sG,iBAAiB9sG,IAAAA;IAC7B,GAMA4rG,EAAoBr3F,UAAU83B,aAAa,WAAA;AAqB1C,aApBArsC,KAAKytG,eAAe,MACpBztG,KAAK0tG,qBAAqB,MAC1B1tG,KAAKitG,SAAS,MACdjtG,KAAKsrD,QAAQ,MACbtrD,KAAK+rG,QAAQ,MACb/rG,KAAKgtD,WAAW,MAChBhtD,KAAKgsG,eAAe,MACpBhsG,KAAKisG,aAAa,MAClBjsG,KAAK0pB,SAAS,MACd1pB,KAAK2tG,UAAU,MACf3tG,KAAK4tG,eAAe,MACpB5tG,KAAK6tG,qBAAqB,MAC1B7tG,KAAK8tG,qBAAqB,MAC1B9tG,KAAK0rD,UAAU,MACf1rD,KAAKmtG,gBAAgB,MAErBntG,KAAK+tG,kBAAkB,MACvB/tG,KAAKguG,gBAAgB,MACrBhuG,KAAK+sG,gBAAgB,MACrB/sG,KAAKiuG,mBAAmB,MACjB;AAAA,IACR,GAEArC,EAAoBr3F,UAAUy5F,gBAAgB,SAAUhxF,GAAAA;AAEvD,eADI/T,IAAI,CAAA,GACCrP,IAAI,GAAGA,IAAIojB,EAAKyN,WAAW5wB,QAAQD;AAC3CqP,QAAAA,EAAE+T,EAAKyN,WAAW7wB,CAAAA,EAAGqV,QAAQ+N,EAAKyN,WAAW7wB,GAAGsV;AAEjD,WADAjG,EAAa,YAAI+T,EAAKrW,aAAaqW,EAAKrW,WAAWikB,YAAY,IACtDhxB,IAAI,GAAGA,IAAIojB,EAAKtW,WAAW7M,QAAQD,KAAK;AAChD,YAAIqV,IAAO+N,EAAKtW,WAAW9M,GAAGwoB;AAC1BnT,QAAAA,MACEhG,EAAEgG,CAAOhG,MAAAA,EAAEgG,KAAQ,CACxBhG,IAAAA,EAAEgG,CAAM5V,EAAAA,KAAK2G,KAAKguG,cAAchxF,EAAKtW,WAAW9M,CAAAA,CAAAA,CAAAA;AAAAA,MAEjD;AACD,aAAOqP;AAAAA,IACR,GAkBAzS,EAAO01G,yBAAyBA,GAEhCA,EAAuB33F,UAAU25F,sBAAsB,SAAUC,GAChEA;AAAAA,MAAAA,EAASC,cAAc,MACvBD,EAASE,cAAc,MACvBF,EAASG,cAAc;AAAA,IACxB,GAEApC,EAAuB33F,UAAUg6F,mBAAmB,SAAUJ,GAAUrC,GACvEqC;AAAAA,MAAAA,EAASC,cAAcpuG,KAAKwuG,mBAC5BL,EAASE,cAAcvC,GACvB9rG,KAAKyuG,eAAeN,GAAUrC,CAAAA;AAAAA,IAC/B,GAEAI,EAAuB33F,UAAUk6F,iBAAiB,SAAUN,GAAUrC,GACrEqC;AAAAA,MAAAA,EAASG,cAAcxC;AAAAA,IACxB,GAEAI,EAAuB33F,UAAUi6F,oBAAoB,SAAUtzG,GAAAA;AAC9D,WAAKA,KAAK1E,CAAAA,EAAOM,UAAWoE,KAAKpE,OAAOynB,UAAU;AAGlD,eAAI/nB,EAAO21G,iBAAiBO,YAC3Bl2G,EAAO21G,iBAAiBO,WAAW,GACnCpoG,SAASmJ,KAAKihG,YAAYl4G,EAAO21G,iBAAiBK,UAClDloG,SAASmJ,KAAKq6E,cAActxF,EAAO21G,iBAAiBM,UAC7C,OAGJj2G,EAAO21G,iBAAiBE,YAC3B71G,EAAO21G,iBAAiBwC,SAASzzG,CAAAA,GAElC1E,EAAO21G,iBAAiBO,WAAW,GACnCl2G,EAAO21G,iBAAiBK,WAAWloG,SAASmJ,KAAKihG,WACjDl4G,EAAO21G,iBAAiBM,WAAWnoG,SAASmJ,KAAKq6E,aACjDtxF,EAAO21G,iBAAiBG,gBAAgBtsG,MACxCxJ,EAAO21G,iBAAiBI,kBAAkBvsG,KAAKquG,aAC/C/pG,SAASmJ,KAAKihG,YAAYl4G,EAAO21G,iBAAiBqC,mBAClDlqG,SAASmJ,KAAKq6E,cAActxF,EAAO21G,iBAAiByC,UACpDp4G,EAAO21G,iBAAiB0C,YAAW,oBAAI31G,QAAOC,cAG1C8P,KAAQ/N,CAAAA,EAAgB,mBAC3BA,EAAE28B,eACK,GAAA;AAAA,IAGT,GAEAq0E,EAAuB33F,UAAUq6F,WAAW,SAAU1zG,GAAAA;AAChDA,MAAAA,MACJA,IAAI1E,EAAOM;AACZ,UAAIg4G,IAAUt4G,EAAO21G;AACrB,UAAA,GAAI,oBAAKjzG,QAAQC,QAAAA,IAAY21G,EAAQD,WAAW,MAAhD;AAKA,YAAA,CAAKC,EAAQzC,UAAU;AACtB,cAAIyC,CAAAA,EAAQpC;AAcP,mBAAOoC,EAAQH,SAASzzG,GAAG,EAAA;AAX/B,cAFA4zG,EAAQzC,WAAWyC,EAAQvC,gBAAgBwC,gBAAgBD,EAAQxC,eAAepxG,CAE7E4zG,GAAAA,CAAAA,EAAQzC;AACZ,mBAAOyC,EAAQH,SAEhBG;AAAAA,UAAAA,EAAQzC,SAAS2C,gBAAgB;AAAc,mBAAO;AAAA,UAAM,GAC5DF,EAAQG,aAAaH,EAAQzC,UAC7B/nG,SAASmJ,KAAKhJ,YAAYqqG,EAAQzC,QAAAA,GAClC/nG,SAASmJ,KAAKihG,YAAYI,EAAQH,UAClCG,EAAQpC,WAAW,GACnBoC,EAAQzC,SAAS6C,UAAU14G,GAC3Bs4G,EAAQK;QAGT;AAED,YAAIL,EAAQzC,SAASpqG,cAAczL,EAAO8N,SAASmJ,QAAQqhG,EAAQG,YAAY;AAC9E,cAAIG,IAAMN,EAAQG;AAEdH,UAAAA,EAAQG,WAAWnqF,QACtBsqF,IAAMN,EAAQG,WAAWnqF,MAG1BsqF,EAAIntG,WAAWC,YAAYktG;AAC3B,cAAIC,IAAUP,EAAQzC,SAAS6C;AAM/B,cAJIE,EAAIF,WAAWE,EAAIF,QAAQ/C,iBAAiBC,eAC/CgD,EAAIF,QAAQ/C,iBAAiBC,YAAYkC,YAAYgB,SAASF,EAAIF,QAAQ/C,iBAAiBC,WAGxFc,GAAAA,GAAO;AACV,gBAAInrG,IAAMuC,SAASC,cAAc;AACjCxC,YAAAA,EAAIyC,YAAYsqG,EAAQzC,SAASkD,WACjCT,EAAQzC,WAAWtqG,EAAI2E,WAAW;UAClC;AACAooG,YAAAA,EAAQzC,WAAWyC,EAAQzC,SAASvyG,YAErCg1G;AAAAA,UAAAA,EAAQzC,SAAS6C,UAAU14G,GAG3Bs4G,EAAQG,WAAWnqF,MAAMgqF,EAAQzC,UACjC/nG,SAASmJ,KAAKhJ,YAAYqqG,EAAQzC,QAAAA,GAClCgD,EAAQlD,iBAAiBE,WAAWyC,EAAQzC;AAAAA,QAC5C;AASD,YAAIlrE;AAPJ2tE,QAAAA,EAAQzC,SAAS10G,MAAME,OAAOqD,EAAE+mB,UAAU,MACxC6sF,EAAQU,KAAAA,KAAKV,EAAQU,KAAY,MACjClrG,SAASmJ,KAAK4S,cAAc/b,SAAS8T,gBAAgBiI,cAAc,MACrEyuF,EAAQzC,SAAS10G,MAAMC,MAAMsD,EAAEgnB,UAAU,KACvC4sF,EAAQW,UAAKX,EAAQW,KAAY,MACjCnrG,SAASmJ,KAAK0S,aAAa7b,SAAS8T,gBAAgB+H,aAAa,MAMlEghB,IAHIjmC,EAAEoiB,aAGFpiB,EAAEoiB,aAFFpiB,EAAEE,QAGP0zG,EAAQY,aAAavuE,GAAGjmC;MAhEoC;AAAA,IAiE7D,GAEAgxG,EAAuB33F,UAAUo7F,yBAAyB,SAAUh0G,GAAAA;AAEnE,UAAInF,EAAOyY,MAAM;AAKhB,iBAJI2M,IAAK5Z,OAAO4tG,OAAOp5G,EAAOyY,IAAAA,EAAM4gG,aAAapwF,cAC7C+vF,IAAK,GACLC,IAAK,GAEF7zF;AACN4zF,UAAAA,KAAM5zF,EAAG4D,YACTiwF,KAAM7zF,EAAG2D,WACT3D,IAAKA,EAAG6D;AAGT,YAAKzd,OAAuB,kBAAG;AAC9B,cAAI8tG,IAAK9tG,OAAOmqG,iBAAiBwD,uBAAuB,CAAA;AACxDH,UAAAA,KAAyB,IAAnBM,EAAGz1G,MAAM,KAAK,CACpBo1G,GAAAA,KAAyB,IAAnBK,EAAGz1G,MAAM,KAAK,CACpB;AAAA,QAAA;AAED,YAAIsB;AACH,iBAAO6zG,IAAK,MAAMC;AAElBzvG,aAAKwvG,KAAKA,GACXxvG,KAAKyvG,KAAKA;AAAAA,MACV;AACD,aAAO;AAAA,IACR,GAEAvD,EAAuB33F,UAAUm7F,eAAe,SAAUzwF,GAAY/jB,GACjE;AAAA,MAAAA,KAAiB+jB,EAAsB,eACtCjf,KAAKosG,eACRpsG,KAAKosG,YAAYkC,YAAYgB,SAAStvG,KAAKosG,WAAAA,GAC5CpsG,KAAKosG,cAAcntF,GACnBjf,KAAKosG,cAAcpsG,KAAKosG,YAAYkC,YAAYyB,QAAQ/vG,KAAKosG,aAAapsG,KAAKssG,eAAepxG,EAAE+mB,SAC/F/mB,EAAEgnB,SAAShnB,CACZ8E,GAAAA,KAAKgwG,kBAAmB9C,IAAQhyG,EAAEoiB,aAAapiB,EAAEE,UAE7CF,KAAiB+jB,EAAWmD,WAAW,SAC1CpiB,KAAK0vG,aAAazwF,EAAWhd,YAAY/G,CAAAA,KAErC8E,KAAKosG,eACRpsG,KAAKosG,YAAYkC,YAAYgB,SAAStvG,KAAKosG,aAAalxG,EAAE+mB,SAAS/mB,EAAEgnB,SAAShnB,CAAAA,GAC/E8E,KAAKosG,cAAc,GAEfpsG,KAAKiwG,eACRjwG,KAAKiwG,YAGT;AAAA,IAAA,GAEA/D,EAAuB33F,UAAUo6F,WAAW,SAAUzzG,GAAGD,GACxD;AAAA,UAAI6zG,IAAUt4G,EAAO21G;AAErB,WAAKlxG,GAAM;AACV6zG,QAAAA,EAAQoB,eACR;AAAA,YAAI/rF,IAAO2qF,EAAQ1C;AACnB0C,QAAAA,EAAQ1C,cAAc,MAElBjoF,KACHA,EAAKmqF,YAAY6B,MAAMrB,EAAQxC,eAAewC,EAAQvC,iBAAiBpoF,GACrE+oF,IAAQp2G,MAAMwmB,aAAapiB,EAAEE,MAAAA;AAAAA,MAChC;AACD0zG,MAAAA,EAAQ1C,cAAc,MAEjB0C,EAAgB,YAAMA,EAAQzC,SAASpqG,cAAcqC,SAASmJ,QAClEqhG,EAAQzC,SAASpqG,WAAWC,YAAY4sG,EAAQzC,WACjDyC,EAAQzC,WAAW,GACnByC,EAAQG,aAAa,GACrBH,EAAQU,KAAK,GACbV,EAAQW,KAAK,GACbX,EAAQxC,gBAAgB,GACxBwC,EAAQvC,kBAAkB,GAC1BjoG,SAASmJ,KAAKihG,YAAYI,EAAQtC,UAClCloG,SAASmJ,KAAKq6E,cAAcgnB,EAAQrC,UACpCqC,EAAQtC,WAAW,MACnBsC,EAAQrC,WAAW,MACnBqC,EAAQpC,WAAW;AAAA,IACpB,GAEAR,EAAuB33F,UAAU27F,iBAAiB,SAAUE,GACvDA;AAAAA,MAAAA,KACH55G,EAAO21G,iBAAiBwC,SAAS,GAAG,CAErC;AAAA,eAAS/0G,IAAI,GAAGA,IAAIpD,EAAOo5G,OAAO/1G,QAAQD;AACzC,YACMpD;AAAAA,UAAAA,EAAOo5G,OAAOh2G,CAAMw2G,KAAAA,KAAS55G,EAAOo5G,OAAOh2G,CAAAA,EAAmB,oBAClEpD,EAAOo5G,OAAOh2G,CAAAA,EAAGuyG,iBAAiB+D,eAAe15G,CAAAA;AAAAA,QACrD,QAAW0E;AAAAA,QAAM;AAGhB,UACM8G;AAAAA,eAAuB,oBAAMA,UAAUxL,KAAYwL,UAAUouG,KACjEpuG,OAAOmqG,iBAAiB+D,eAAe15G,CAC1C;AAAA,MAAA,QAAgB;AAAA,MAAA;AAAA,IAChB,GAEA01G,EAAuB33F,UAAU46F,iBAAiB,SAAUiB,GAAKn1G,GAAAA;AAC5Dm1G,MAAAA,MACH55G,EAAO21G,iBAAiBqC,qBACxBh4G,EAAO21G,iBAAiBG,gBAAgB8D,EAAIjE,iBAAiBG,eAC7D91G,EAAO21G,iBAAiBI,kBAAkB6D,EAAIjE,iBAAiBI,iBAC/D/1G,EAAO21G,iBAAiBE,WAAW+D,EAAIjE,iBAAiBE,UACxD71G,EAAO21G,iBAAiB8C,aAAamB,EAAIjE,iBAAiBE,UAC1D71G,EAAO8N,SAASmJ,KAAKihG,YAAYl4G,EAAO21G,iBAAiBwC,UACzDn4G,EAAOk2G,WAAW,GAEXQ,CAAAA,YAAwBmD,KAAWC,IAAQ,QACjD95G,EAAO21G,iBAAiBwD,uBAE1B;AAAA,UAAA;AACM3tG,eAAuB,oBAAMA,UAAUxL,KAAYwL,UAAUouG,KACjEpuG,OAAOmqG,iBAAiBgD,eAAe34G,CAC1C;AAAA,MAAA,QAAU0E;AAAAA,MAAM;AAEf,eAAStB,IAAI,GAAGA,IAAIpD,EAAOo5G,OAAO/1G,QAAQD;AACzC,YAAA;AACMpD,UAAAA,EAAOo5G,OAAOh2G,CAAMw2G,KAAAA,KAAS55G,EAAOo5G,OAAOh2G,CAAAA,EAAmB,oBAClEpD,EAAOo5G,OAAOh2G,GAAGuyG,iBAAiBgD,eAAe34G,GAAW45G,CAAAA,KAAOn1G,IAAQ,IAAI;QACnF;QAAiB;AAAA,IAEjB;AAEA,QAAIo1G,IAAQ,IACRnD,IAAQ,IAERqD,IAAW,IAGXD;AAIAxwF,cAAUC,UAAUlZ,QAAQ,WAAA,GAI5BiZ,UAAUC,UAAUrF,YAAAA,EAAc7T,QAAQ,QAGC,GAA1CiZ,UAAUC,UAAUlZ,QAAQ,aAAc,MAAOiZ,UAAUC,UAAUlZ,QAAQ,WAAA,UACtEwxF,WAAWv4E,UAAUC,UAAUqM,OAAOtM,UAAUC,UAAUlZ,QAAQ,YAAY,GAAG,CAAA,CAAA,IAE7E,OACdwpG,IAAQ,IACRC,IAAQ,OAERC,IAAW,KACFzwF,UAAUC,UAAUlZ,QAAQ,OAE3BwxF,KAHC,KAGDA,WAAWv4E,UAAUC,UAAUqM,OAAOtM,UAAUC,UAAUlZ,QAAQ,OAAA,IAAW,GAAG,CAIxC,CAAA,IAA3CiZ,UAAU0wF,QAAQ3pG,QAAQ,gBAAiB,MACnDqmG,IAAQ,IACHptF,UAAU2wF,WAAW5pG,QAAQ,eAD1B,MAC+CiZ,UAAU2wF,WAAW5pG,QAAQ,UAAA,WAAqBiZ,UAAU2wF,WAAW5pG,QAAQ,WAAA,KAAlD,MAAyEvC,SAASosG,cAAc,iBACnLxD,IAAQ,MAECptF,UAAU0wF,WAAW,cAAc1wF,UAAUC,UAAUlZ,QAAQ,SAAA,KAArD2pG,KAEpBtD,IAAQ,KAERmD,QACAC,IAAQjY,WAAWv4E,UAAUC,UAAU1lB,MAAM,KAAO,EAAA,CAAA,CAAA,IAKrDuxG,EAAoBr3F,UAAUo5F,UAAU,SAAU9hD,GAAUC,GAAQ6kD,GAAWC;AAC9E,UAAIL,KAAAA,CAAcrD,MAAU12G,EAAO01D;AAClC,eAAOlsD,KAAK4tG,aAAa/hD,GAAUC;AAEpC,UAAIohD;AAgBH,eAfKphD,MAIHA,IAHI9rD,KAAK0pB,OAAOxL,WAGPle,KAAK0pB,SAFL1pB,KAAK0pB,OAAOD,cAIlBqiC,KACJoP,YAAY4J,WAAW,WAAW,iBAAiB,CACjDhZ,KAAU9rD,KAAK0pB,QAChB1pB,KAAKisG,UAGH0E,CAAAA,GAAAA,KACH7kD,EAAOpW,YAAY,uBAAuB,gBAAgBi7D,IAAY,GAAA,GAEnEC,KAAe,WACX9kD,EAAO+kD,iBAAiBhlD,CAAAA,IAGxBC,EAAOC,YAAYF,MAAa,IAAItpD,MAAM;AAGlD,UAAIuuG,IAAUhlD;AAETA,MAAAA,MAKHA,IAJI9rD,KAAK0pB,OAAOxL,WAIPle,KAAK0pB,SAHL1pB,KAAK0pB,OAAOD,cAOlBqiC,KACJoP,YAAY4J,WAAW,WAAW,iBAAiB,CACjDhZ,KAAU9rD,KAAK0pB,QAChB1pB,KAAKisG,UAGqC,CAAA,GAAxCngD,EAAO5tC,SAASrX,QAAQ,eAAgB,KAC3CiqG,IAAUhlD,KAGVglD,IAAUhlD,GACVA,IAASA,EAAOE;AAEjB,UAAI+kD,IAAU7kD,YAAYC;AAEP,MAAfykD,KAAe,aAClBG,IAAU7kD,YAAY8kD;AACvB,UAAIC,IAAU,CAAA,GACVpxE,IAAMisB,EAAOG,SAASJ,GAAUilD,GAAS,SAAUnpE;AACtD,eAAOgpE;AAAAA,MACV,GAAKI,GAAS,IAAA;AAEZ,UAAIA,KAAW7kD,YAAY8kD;AAC1B,eAAOnxE,EAAIqxE;AAIZ,eAFIC,IAActxE,EAAIusB,YAEf+kD,GAAAA;AACNF,QAAAA,EAAQA,EAAQp3G,MAAAA,IAAUs3G,GAC1BA,IAActxE,EAAIusB;AAEnB,aAAO6kD;AAAAA,IAET,GAGAz6G,EAAO0kE,cAAc,IAAIk2C,MAKzBxF,EAAoBr3F,UAAUq5F,eAAe,SAAU/hD,GAAUC;AAEhE,UAAI3qB,IAAI0qB,EAASt9C,QAAQ,WAAW,GAAA,EAAKlU,MAAM,GAC3CjB,GAAAA,IAAM,MACNQ,IAAI;AAER,WAAKunC,EAAEtnC;AACN,eAAO,CAAA;AAER,UAAIsnC,EAAE,CACL/nC,KADW;AACXA,QAAAA,IAAM,CAAC0yD,CAAc;AAAA,WAAA;AAAA,YAAI3qB,EAAE,CAAA,MAAO;AAIlC,iBAAO,CAAA;AAHN/nC,QAAAA,KAAO4G,KAAK0pB,OAAOD,eAAezpB,KAAK0pB,QAAQ8F,qBAAqB2R,EAAEvnC,GAAG2U,QAAQ,eAAe,EAChG3U,CAAAA,GAAAA;AAAAA,MAEQ;AAEV,aAAQA,IAAIunC,EAAEtnC,QAAQD;AAAIR,QAAAA,IAAM4G,KAAK0tG,mBAAmBt0G,GAAK+nC,EAAEvnC,CAI/D,CAAA;AAAA,aAFIunC,EAAEvnC,IAAI,CAAGiN,EAAAA,QAAQ,QAErB,OADCzN,IAAM4G,KAAKytG,aAAar0G,GAAK+nC,EAAEvnC,IAAI,CAAA,CAAA,IAC7BR;AAAAA,IACR,GAEAwyG,EAAoBr3F,UAAUk5F,eAAe,SAAU50F,GAAGC,GAAAA;AAIzD,eAHIla,IAAI,CAGChF,GAAAA,KAFLkf,IAAIA,EAAEvK,QAAQ,eAAe,EAAA,EAAIA,QAAQ,cAAc,EAAA,GAE9C,IAAG3U,IAAIif,EAAEhf,QAAQD;AACzBif,QAAAA,EAAEjf,CAAAA,EAAGiB,aAAaie,CACrBla,MAAAA,EAAEA,EAAE/E,MAAUgf,IAAAA,EAAEjf;AAElB,aAAOgF;AAAAA,IACR,GAEAgtG,EAAoBr3F,UAAUm5F,qBAAqB,SAAU70F,GAAGC,GAAAA;AAC/D,UAAIla,IAAI,CAAA;AAEJ2xG,MAAAA,MACHz3F,IAAIA,EAAEo0C,YAEP;AAAA,eAAStzD,IAAI,GAAGA,IAAIif,EAAEhf,QAAQD;AAAI,iBAAS2wB,IAAI,GAAGA,IAAI1R,EAAEjf,CAAG8M,EAAAA,WAAW7M,QAAQ0wB;AACzEgmF,UAAAA,IACC13F,EAAEjf,CAAG8M,EAAAA,WAAW6jB,GAAGnI,WAAWvJ,EAAEjf,CAAG8M,EAAAA,WAAW6jB,CAAGnI,EAAAA,QAAQ8qC,iBAAiBp0C,MAC7Ela,EAAEA,EAAE/E,MAAUgf,IAAAA,EAAEjf,GAAG8M,WAAW6jB,CAAAA,KAGvB1R,EAAEjf,CAAAA,EAAG8M,WAAW6jB,CAAAA,EAAGnI,WAAWtJ,MACtCla,EAAEA,EAAE/E,MAAUgf,IAAAA,EAAEjf,GAAG8M,WAAW6jB,CAAAA;AAGhC,aAAO3rB;AAAAA,IACR,GASYpI,EAAkB,gBAT9B,WAUCA,EAAO66G,cAAc,SAAqBz1F,GAAI9kB,GAAOsZ,GAAAA;AAChDwL,MAAAA,EAAGC,mBACND,EAAGC,iBAAiB/kB,GAAOsZ,GAAS,EAAA,IAE5BwL,EAAG5gB,eACX4gB,EAAG5gB,YAAY,OAAOlE,GAAOsZ,CAChC;AAAA,IAAA,IAKAw7F,EAAoBr3F,UAAU+8F,SAAS,MACvC1F,EAAoBr3F,UAAU05F,mBAAmB,SAAUsD,GAAWC,GAAYF,GAAAA;AAC5EA,MAAAA,MACJA,IAAStxG,KAAKsxG,SAEXA,EAAO7nF,gBACV6nF,IAASA,EAAO7nF;AACjB,UAAIgjB,IACHzsC,KAAK2tG,QAAQ,yCAAyC4D,IAAY,MAAMD,GACvE,wCAAyC,QAEvC7kE;AAAAA,MAAAA,MACHA,EAAK9lC,WAAWikB,YAAY4mF;AAAAA,IAC9B,GAEA5F,EAAoBr3F,UAAUs5F,qBAAqB,SAAUyD,GAAQ5nF;AAcpE,UAAI3a;AAEJ,UAfKuiG,MACJA,IAAStxG,KAAKsxG,SAEXA,EAAO7nF,gBACV6nF,IAASA,EAAO7nF,cAEZC,MACJA,IAAS1pB,KAAK0pB,SAEXA,EAAOD,gBACVC,IAASA,EAAOD,cAKZyjF,GAME;AACNn+F,QAAAA,IAAS,IAAI08C,cAAc,wBAC3B;AAAA,YAAA;AACC/hC,UAAAA,EAAO+nF,sBAAsBH,GAAQviG;QACrC,QACAA;AAAAA,UAAAA,IAAS2a,EAAOgoF,cAAcJ;QAC9B;AAAA,MACD;AAZKtxG,aAAK2xG,iBACT3xG,KAAK2xG,eAAe,IAAIC,iBACxB5xG,KAAK2xG,aAAaE,iBAAiBP,CAAAA,IAEpCviG,IAAS/O,KAAK2xG,aAAaG,oBAAoBpoF,CAShD;AAAA,aAAO3a;AAAAA,IACR,GAEA68F,EAAoBr3F,UAAUu5F,qBAAqB,SAAUwD,GAAQ5nF;AACpE,UAAI5rB,IAAMkC,KAAK6tG,mBAAmByD,GAAQ5nF;AAC1C,aAAoB,OAAhB7Q,KAAgB,WACZ/a,IACDkC,KAAK+tG,gBAAgBjwG;IAC7B,GAEA8tG,EAAoBr3F,UAAUw5F,kBAAkB,SAAUrkF;AAKzD,aAJKA,MACJA,IAAS1pB,KAAK0pB,SACXA,EAAOD,gBACVC,IAASA,EAAOD,cACZyjF,IAIGxjF,EAAOJ,MAHM,IAAIyoF,gBACHC,kBAAkBtoF,CAAAA;AAAAA,IAGzC,GAMAlzB,EAAOy7G,kBAAkB,SAAU74G,GAAAA;AAClCA,MAAAA,EAAI4B,cAAc,SAAUiU,GAAMijG,GAASC,GAAAA;AAK1C,eAHKnyG,KADLiP,IAAO,QAAQA,EAAKyL,YAEnB1a,CAAAA,MAAAA,KAAKiP,KAAQ,IAAIjP,KAAKoyG,aAAaD,KAAWnyG,IAAAA,IAEvCiP,IAAO,MAAMjP,KAAKiP,CAAAA,EAAMsC,SAAS2gG,CAC3C;AAAA,MAAA,GACC94G,EAAIyG,YAAY,SAAUoP,GAAMojG,GAE/B;AAAA,eAAA,CAAIryG,KADJiP,IAAO,QAAQA,EAAKyL,YAEZ1a,CAAAA,KAAAA,KAAKiP,GAAMrM,MAAM5C,MAAMqyG;MAEjC,GACCj5G,EAAIwG,aAAa,SAAUqP,GAC1B;AAAA,eAAA,CAAA,CAAUjP,KAAK,QAAQiP,EAAKyL;MAC9B,GACCthB,EAAIg5G,eAAe,SAAUh5G,GAAAA;AAC5B,YAAIk5G,IAAY,CACZnxE,GAAAA,IAAI;AAEP,mBADIrjC,QACKlE,IAAI,GAAGA,IAAI04G,EAAUz4G,QAAQD;AACrC,gBAAI04G,EAAU14G,IAAI;AACjB,kBAAI24G,IAAKD,EAAU14G,CAAAA,EAAGgJ,MAAMxJ,GAAK2P,SAAAA;AACjCjL,cAAAA,IAAMA,KAAOy0G;AAAAA,YACb;AAEF,iBAAOz0G;AAAAA,QACV;AAWE,eAVAqjC,EAAE5vB,WAAW,SAAU9U,GACtB;AAAA,cAAI,OAAAvB,KAAe;AAClB,kBAAM,IAAI6L,MAAM,6BAA6BtK,CAAAA,GAAAA;AAC9C,mBAAIA,KACI61G,EAAUj5G,KAAKoD,CAAM,IAAA;AAAA,QAEhC,GACE0kC,EAAElmB,cAAc,SAAUthB;AACzB24G,UAAAA,EAAU34G,CAAAA,IAAM;AAAA,QACnB,GACSwnC;AAAAA,MACT,GACC/nC,EAAImiB,cAAc,SAAU5hB,GAAAA;AAC3B,YAAIA,GAAI;AACP,cAAI6hB,IAAO7hB,EAAGU,MAAM,GAAA;AACpB2F,eAAKwb,EAAK,CAAA,CAAA,EAAIP,YAAYO,EAAK,CAAA,CAAA;AAAA,QAC/B;AAAA,MACH,GACCpiB,EAAIsiB,kBAAkB,WACrB;AAAA,iBAASzM,KAAQjP;AACY,UAAxBiP,EAAKpI,QAAQ,KAAA,MAAW,MAC3B7G,KAAKub,YAAYtM,CAAAA,GACjBjP,KAAKiP,CAAQ,IAAA;AAAA,MAGjB,GACC7V,IAAM;AAAA,IACP;AAAA,EAEA,GDv1BA;AAAA,G9BsDCia,OgC3Dc,SAAS3c,GAAAA;AAExBA,IAAUM,OAAOiI,cAAc,MAC/BvI,EAAUM,OAAOkI,YAAc,MAC/BxI,EAAUM,OAAOw7G,iBACjB97G,EAAUM,OAAO2H,eAAe,IAEhCjI,EAAU+7G,oBAAoB,WAAA;AAC7B,QAAIlkC,IAAS;AAGb73E,MAAUsE,YAAY,sBAAqB,SAAS03G,GAAGC,GAAGC,GAAGC;AAE5D,eAASC,EAAUp6G,GAAMuC,GAAAA;AACxB,YAAIgE,IAAcvI,EAAUM,OAAOiI,aAClCC,IAAYxI,EAAUM,OAAOkI,WAC7B6zG,IAAYr8G,EAAUgC,KAAKC,IAAID,GAAK,GAAEuC;AAEvC,eAAQvC,EAAKS,YAAY+F,EAAU/F,QAAAA,KAAa45G,KAAY9zG,EAAY9F,QAAAA;AAAAA,MACxE;AAED,aAAA,CAAIzC,EAAUM,OAAOw7G,eAEhBM,EADJD,IAAKA,KAAIF,GAAIC,IAAKA,KAAIF,CACKC,KAAAA,EAAGx5G,aAAa05G,EAAG15G,QAAAA,MAC7CwV,WAAW,WACV;AAAA,YAAGjY,EAAUkiB;AACZ,iBAAA;AAED,YAAIo6F,IAAaF,EAAUH,GAAIC,CAAWl8G,IAAAA,EAAUM,OAAOiI,cAAtB0zG;AAErCj8G,UAAU6V,eAAgBumG,EAAUE,GAAWJ,CAAkB,IAAA,OAAZI,GAAkBJ,CAAAA;AAAAA,MACvE,GAAC,CAAA,GAAA;AAAA,IAKN,CACCl8G,GAAAA,EAAUsE,YAAY,eAAe,SAASmiB;AAC7C,aAASA,KA7BW;AAAA,IA8BtB,CAAA,GACCzmB,EAAUsE,YAAY,gBAAe,SAASrB,GAAAA;AAC7C,cAAKA,KACEjD,EAAUgI,oBAAoBhI,EAAUyE,SAASxB,CAC1D,CAAA;AAAA,IAAA,CAAA,GACCjD,EAAUsE,YAAY,WAAW,SAAUgjE,GAAU+sC;AACpD,aAAOr0G,EAAUgI,oBAAoBhI,EAAUyE,SAAS6iE,CAC1D,CAAA;AAAA,IAAA,CAAA,GACCtnE,EAAUsE,YAAY,oBAAmB,SAASrB,GAAAA;AAEjD,UAAI8C,IAAK/F,EAAUyE,SAASxB,CAE5B;AAAA,aADA40E,IAAS,CAAC9xE,EAAGxE,YAAYwE,EAAGvE,QACrBxB,GAAAA,EAAUgI,oBAAoBjC,CACvC;AAAA,IAAA,CAAA,GACC/F,EAAUsE,YAAY,eAAe,SAASrB,GAAI2M,GAAM2sG,GAAAA;AAGvD,WAAK3sG,EAAKrO,cAAAA,CAAcqO,EAAKpO,UAAU;AACtC,YAAIuE,IAAK/F,EAAUyE,SAASxB,CAAAA;AAC5B2M,UAAKrO,aAAa,IAAIiB,KAAKuD,EAAGxE,aAC9BqO,EAAKpO,WAAW,IAAIgB,KAAKuD,EAAGvE,QAC5B;AAAA,MAAA;AAED,UAAGoO,EAAKxH,UAAS;AAGhB,YAAIo0G,IAAYx8G,EAAUiM,YAAY2D;AAEtC,eADA5P,EAAUmb,iBAAiBqhG,CAAAA,GACpBx8G,EAAUgI,oBAAoBw0G;MACrC;AACD,aAAOx8G,EAAUgI,oBAAoB4H,CAAAA;AAAAA,IACvC,IACC5P,EAAUsE,YAAY,gBAAe,SAASrB,GAC7C;AAAA,UAAA,CAAKA;AAAI,eAAO;AAChB,UAAI8C,IAAK/F,EAAUyE,SAASxB,CAoB5B;AAAA,aAAA,CAnBKjD,EAAUgI,oBAAoBjC,CAAO/F,KAAAA,EAAUM,OAAOiI,eAAevI,EAAUM,OAAOkI,cAEtFzC,EAAGxE,aAAavB,EAAUM,OAAOiI,gBACpCxC,EAAGxE,aAAa,IAAIiB,KAAKxC,EAAUM,OAAOiI,eAEvCxC,EAAGxE,WAAWkB,aAAazC,EAAUM,OAAOkI,UAAU/F,QAAAA,MACzDsD,EAAGxE,aAAa+H,KAAKtH,KAAKC,IAAIjC,EAAUM,OAAOkI,WAAAA,IAAe,KAE3DzC,IAAAA,EAAGvE,WAAWxB,EAAUM,OAAOiI,gBAClCxC,EAAGvE,WAAW,IAAIgB,KAAKxC,EAAUM,OAAOiI,eAErCxC,EAAGvE,SAASiB,aAAazC,EAAUM,OAAOkI,UAAU/F,QACvDsD,MAAAA,EAAGvE,WAAW8H,KAAKtH,KAAKC,IAAIjC,EAAUM,OAAOkI,WAAY,IAAG,KAEzDzC,IAAAA,EAAGxE,WAAWkB,QAAasD,KAAAA,EAAGvE,SAASiB,QAC1CsD,MAAAA,EAAGvE,WAAW8H,KAAKtH,KAAKC,IAAI8D,EAAGxE,YAAa+H,KAAKhJ,OAAOm7B,kBAAgBnyB,KAAKhJ,OAAOq6B,WAAY,QAAA,IAEjG50B,EAAG4C,SAAOW,KAAKV,cAAc7C,CAAAA,IAAAA;AAAAA,IAGhC,CAAA,GACC/F,EAAUsE,YAAY,kBAAiB,SAASrB,GAC/C;AAAA,UAAA,CAAKA;AAAI,eAAO;AAChB,UAAI8C,IAAK/F,EAAUyE,SAASxB;AAC5B,UAAKjD,CAAAA,EAAUgI,oBAAoBjC,CAAI,GAAA;AACtC,aAAK8xE;AAAQ,iBAAA;AACb9xE,QAAAA,EAAGxE,aAAas2E,EAAO,IACvB9xE,EAAGvE,WAAWq2E,EAAO,CACrB9xE,GAAAA,EAAG4C,SAAOW,KAAKV,cAAc7C,CAC7B;AAAA,MAAA;AACD,aAAO;AAAA,IACT,IACC/F,EAAUsE,YAAY,wBAAuB,SAASyB,GAAI02G,GAAejzD,GACxE;AAAA,aAAOxpD,EAAUgI,oBAAoBjC,CACvC;AAAA,IAAA,CAAA,GACC/F,EAAUsE,YAAY,wBAAwB,SAASyB,GACtD;AAAA,UAAIxE,IAAavB,EAAU+E,cAAcgB,CAAI/D,EAAAA,MACzC5B,IAAQ,EACXuI,YACApH,YAAYA,GACZC,UAAUxB,EAAUgC,KAAKC,IAAIV,GAAYvB,EAAUM,OAAOq6B,WAAW,QAAA,EAAA;AAEtE,aAAO36B,EAAUgI,oBAAoB5H;IACvC,CAECJ,GAAAA,EAAUsE,YAAY,gBAAgB,WAAA;AACrCtE,QAAU0J,UAAAA;AAAAA,IACZ,CAEC1J,GAAAA,EAAUsE,YAAY,0BAA0B,WAAA;AAO/C,aANAzE,OAAOoY,WAAW;AACjB,YAAGjY,EAAUkiB;AACZ,iBAAA;AAEDliB,UAAU0J;MACV,GAAE,CAAA,GAAA;AAAA,IAEL,CAEC1J,GAAAA,EAAUsE,YAAY,oBAAoB,WAAA;AACzCtE,QAAU08G,kBAAkB78G,OAAOqoC,YAAY;AAC1CloC,UAAUswD,gBAAAA,KAEdtwD,EAAU0J,UACV;AAAA,MAAA,GAAE;IACL,CAEC1J,GAAAA,EAAUsE,YAAY,aAAa,WAClC0jC;AAAAA,oBAAchoC,EAAU08G,eAC1B;AAAA,IAAA,CAAA;AAAA,EAEA,GACA18G,EAAU+7G,kBAAAA;AAGV,GhCzFCY,UiCrDD,SAAwB38G,GAExB;AAAA,MAAI48G,IAAiC,MACjCC,IAA4B,CAChC;AAAA,QAAMC,IAA2C,EAChDC,WAAW,IAAI1uC,GAAiBruE,CAAAA,GAChCg9G,gBAAgB,IAAI/qC,GAAqBjyE,CAAAA,GACzCi9G,QAAQ,IAAItpC,GAAc3zE;AAiF3B,WAASk9G,EAAal9G;AAERA,IAAAA,IAAAA,EAAU6c,IAAIg0D,QAAQssC,cAAAA,GAqClBN,EAAAl6G,KACjB3C,EAAUsE,YAAY,eAAc,SAASrB,GAAG8C,GAAGyjD,GAAAA;AAC9C,UAAA4zD,IAAkBp9G,EAAUyE,SAASxB;AAIlC,aAHHm6G,KAAmBA,EAAgB7sC,kBAAkBxqE,EAAGwqE,mBAC3DvwE,EAAUq9G,wBAAAA,KAEJ;AAAA,IAAA,CAELr9G,GAAAA,EAAUsE,YAAY,kBAAkB,CAACrB,GAAI7C,MACzC;AAAA,YAAA,EAAAmB,YAACA,GAAYC,UAAAA,EAAYpB,IAAAA,GAAAA,EACzB+N,UAACA,GAAAC,UAAUA,EAAYpO,IAAAA,EAAU4E;AAWhC,aAVJrD,EAAWkB,YAAY2L,EAAS3L,QAAAA,KAAajB,EAASiB,QAAAA,IAAY0L,EAAS1L,QAAAA,KACzEm6G,MACC58G,EAAUM,OAAOg9G,aAAaC,0BAA0Bn9G,EAAMmwE,mBAAmBvwE,EAAUw9G,gBAC7FC,EAAqBr9G,GAAOw8G,CAE7BA,IAAAA,EAAWc,kBAAkBt9G,CAIhCJ,IAAAA,EAAUw9G,oBACH;AAAA,IAAA,IAERx9G,EAAUsE,YAAY,mBAAmB,SAASw9B,GAAOC,GAAAA;AACpD,UAAA47E,IAAa39G,EAAUyE,SAASs9B,CACpC66E;AAAAA,MAAAA,KAAAA,QAAAA,EAAYgB,kBAAkB97E,IAC9B86E,KAAAA,QAAAA,EAAYlsC,eAAeitC;AAAAA,IAAU,CAEnC39G,GAAAA,EAAUsE,YAAY,gBAAgB,CAACrB,GAAI7C,MACvC;AAAA,YAAA,EAAAmB,YAACA,GAAYC,UAAAA,EAAYpB,IAAAA,GAAAA,EACzB+N,UAACA,GAAAC,UAAUA,EAAYpO,IAAAA,EAAU4E;AACpCrD,MAAAA,EAAWkB,QAAAA,IAAY2L,EAAS3L,QAAajB,KAAAA,EAASiB,QAAY0L,IAAAA,EAAS1L,QACpEm6G,KAAAA,MACJ58G,EAAUM,OAAOg9G,aAAaC,0BAA0Bn9G,EAAMmwE,kBAAkBvwE,EAAUq9G,yBAC7FI,EAAqBr9G,GAAOw8G,CAAAA,GAC5B58G,EAAUq9G,wBAAAA,OAEVT,EAAWlsC,eAAetwE,IAC1Bw8G,EAAWiB,aAAaz9G;IAG3B,CAEEJ,GAAAA,EAAUsE,YAAY,WAAW,SAAUrB,GAAIuB;AAC3C,YAAApE,IAAQJ,EAAUyE,SAASxB,CAAAA;AAE1B,aADH25G,KAAcx8G,KAAOw8G,EAAWiB,aAAaz9G,CAC1C,GAAA;AAAA,IAAA,IAELJ,EAAUsE,YAAY,uBAAuB,CAACrB,GAAI7C,OAChDw8G,KACHA,EAAWgB,kBAAkB36G,CAAAA,GAAAA,GArFhC,CAAA;AAAA,EAAA;AACe2xD,iBAAA6oD,EAAqBr9G,GAAuBw8G;AAC1D,QAAIkB,IAAAA,MAAoBlB,EAAW9qC,eAAe1xE,EAAMmwE,cAKjD;AAAA,WAJPnwE,EAAMsuE,MAAMovC,EAAYpvC,KACxBtuE,EAAMuuE,MAAMmvC,EAAYnvC,KACxBiuC,EAAWgB,kBAAkBl6G,OAAOtD,EAAM6C,EAAAA,CAAAA,GAC1C25G,EAAWlsC,eAAetwE,IACnBA;AAAAA,EACR;AA1FIJ,IAAU6c,QACb7c,EAAU6c,MAAM,KAEjB7c,EAAU6c,IAAIg0D,UAAU,EACvBssC,eAAe,WAAA;AACP,WAAAL,EAAS98G,EAAUM,OAAOy9G,iBAClC;AAAA,EAAA,GACAjtC,cAAc,SAASxwE,GACtB;AAAA,WAAO,IAAIyuE,OAAOC,KAAKwF,OAAOl0E,CAC/B;AAAA,EAAA,GACA09G,gBAAgB,MAChBlB,UAAAA,EAAAA,GAED98G,EAAUw9G,gBAAAA,IACVx9G,EAAUq9G,4BACVr9G,EAAUM,OAAOy9G,oBAAoB,aACrC/9G,EAAUM,OAAOg9G,eAAe,EAC/BluC,kBAAkB,EACfV,KAAK,QACLC,KAAK,MAAA,GAERG,gBAAgB,EACbJ,KAAK,IACLC,KAAK,GAAA,GAERF,cAAc,GACdD,oBAAoB,IACpB2C,uBAAuB,KACvB8sC,uBAAAA,IACAV,wBAAwB,IACxBW,eAAe,YAEZl+G,GAAAA,EAAUM,OAAO69G,yBACVn+G,EAAAM,OAAOg9G,aAAaluC,mBAAmB,EAChDV,KAAK1uE,EAAUM,OAAO69G,qBAAqBzvC,IAC3CC,GAAAA,KAAK3uE,EAAUM,OAAO69G,qBAAqBxvC,IAAAA,EAAAA,IAIzC3uE,EAAUM,OAAO89G,uBACVp+G,EAAAM,OAAOg9G,aAAaxuC,iBAAiB,EAC9CJ,KAAK1uE,EAAUM,OAAO89G,mBAAmB1vC,IAAAA,GACzCC,KAAK3uE,EAAUM,OAAO89G,mBAAmBzvC,IAI3C3uE,EAAAA,IAAAA,EAAU+gB,GAAGs9F,iBAAiB,KAC9Br+G,EAAU+gB,GAAGu9F,iBAAiB,IAC9Bt+G,EAAU+gB,GAAGw9F,wBAAwB,KACrCv+G,EAAUgC,KAAKw8G,UAAU,SAASx8G,GAAMmtB,GAAK5qB,GAC5C;AAAA,WAAQ,IAAI/B,KAAKR,EAAKS;EAAS,GAEhCzC,EAAUya,UAAUgkG,WAAW,SAASzoF,GAAIs1B,GAAI/mD,GACxC;AAAA,WAAA;AAAA,EAAA,GAERvE,EAAUya,UAAUikG,WAAW,SAASzxG,GAAOC,GAAKnH,GAAAA;AACnD,WAAI/F,EAAUM,OAAOsgC,OAAAA,CAAQ76B,EAAG4C,SACxB3I,EAAUya,UAAU+rB,SAASt5B,CAAAA,IAAO,cAAclN,EAAUya,UAAU+rB,SAASv5B,CAAAA,IAC5ElH,EAAG4C,SACNW,KAAKk9B,SAASzgC,EAAGxE,YAAYwE,EAAGvE,UAAUuE,KAAM,MAAMuD,KAAKgvD,WAAWrrD,CAAAA,IAEtEjN,EAAUya,UAAU+rB,SAASv5B,CAAS,IAAA,cAAcjN,EAAUya,UAAU+rB,SAASt5B;EACzF,GAEDlN,EAAUya,UAAUkkG,WAAW,SAAS1xG,GAAOC,GAAKnH,GACnD;AAAA,WAAOA,EAAGyW;AAAAA,EAAA,GAEDxc,EAAAya,UAAU42D,mBAAmB,SAASjxE,GAAAA;AACrC,WAAA,6BAA6BA,EAAMoc,IAClBpc;AAAAA,4BAAAA,EAAMmwE;0BACRvwE,EAAUya,UAAUm+C,oBAAoBx4D,EAAMmB,UAAAA,CAAAA;AAAAA,wBAChDvB,EAAUya,UAAUm+C,oBAAoBx4D,EAAMoB,QAAS,CAAA;AAAA;AAAA,EAAA,GAGrExB,EAAAgC,KAAK48G,YAAY,SAASjtG,GAC5B;AAAA,WAAAA;AAAAA,EAAA,GA2BE3R,EAAA6+G,wBAAwB,SAASr6G,GACtC;AAAA,QAAArE,IAAYqE,EAAEE,OAAOC,QAAQ,IAAI3E,EAAUM,OAAO0C,eAAAA,GAAAA;AACtD,QAAI7C,GAAU;AACb,UAAI4kB,IAAU5kB,EAAUgE,aAAa,GAAGnE,EAAUM,OAAO0C,eAAAA,EAAAA;AACzDhD,QAAUu8B,aAAaxX,CACxB;AAAA,IAAA;AACKzb,SAAKhJ,OAAOy6B,YAAAA,CAAYzxB,KAAKhJ,OAAOsT,mBAAoBzT,KAC5DmJ,KAAKuK,YAAY,EAChBtS,YAAavB,EAAUM,OAAOs+G,WAC9Bp9G,UAAUxB,EAAUgC,KAAKC,IAAKjC,EAAUM,OAAOs+G,WAAW5+G,EAAUM,OAAOq6B,WAAW,QAExF,EAAA,CAAA;AAAA,EAAA,GAiES36B,EAAAsE,YAAY,oBAAoB;IAEtCtE,EAAUM,OAAOw+G,gCACnB9+G,EAAUM,OAAOg9G,aAAa7uC,eAAezuE,EAAUM,OAAOw+G,mBAE5D9+G,EAAUM,OAAOy+G,2BAA4B,WAC/C/+G,EAAUM,OAAOg9G,aAAa9uC,qBAAqBxuE,EAAUM,OAAOy+G,yBAElE/+G,EAAUM,OAAO0+G,6BAFiDD,WAGpE/+G,EAAUM,OAAOg9G,aAAansC,wBAAwBnxE,EAAUM,OAAO0+G,2BAErEh/G,EAAUM,OAAO2+G,8BAFoDD,WAGvEh/G,EAAUM,OAAOg9G,aAAaW,wBAAwBj+G,EAAUM,OAAO2+G,4BAErEj/G,EAAUM,OAAOy9G,sBAFoDkB,WAGvEj/G,EAAUM,OAAOg9G,aAAaY,gBAAgBl+G,EAAUM,OAAOy9G,oBAE7D/9G,EAAUM,OAAO4+G,wBACnBl/G,EAAUM,OAAOg9G,aAAaz3G,OAAO7F,EAAUM,OAAO4+G,WAEpDl/G,EAAUM,OAAO6+G,+BAA+B,WAClDn/G,EAAUM,OAAOg9G,aAAaC,yBAAyBv9G,EAAUM,OAAO6+G,6BAEzEn/G,EAAU6c,IAAIg0D,QAAQmtC,iBAAiBh+G,EAAUM,OAAOy9G;AAEpD,QAAAl6G,IAAM+J,SAASC,cAAc,KACjChK;AAAAA,IAAAA,EAAIiL,YAAY,gBAChBjL,EAAIZ,KAAK,gBACTY,EAAI5C,MAAMkgB,UAAU,QACpBtd,EAAI5C,MAAM6+D,SAAS,KACT9/D,EAAA63B,KAAK9pB,YAAYlK;AAE3B,UAAMuqB,IAAMpuB,EAAU+V;AA0EtB,aAASqpG,IAAAA;AAEJ,UAAAtjG,IAAS9b,EAAU85D;AAChBh+C,MAAAA,EAAA8O,KAAK,SAASzI,GAAGC,GAAAA;AACvB,eAAGD,EAAE5gB,WAAWkB,QAAAA,KAAW2f,EAAE7gB,WAAWkB,QAAAA,IAChC0f,EAAElf,KAAGmf,EAAEnf,KAAG,IAAE,KACbkf,EAAE5gB,aAAW6gB,EAAE7gB,aAAW,IAAE;AAAA,MAAA;AAIhC,UAEAG,IAAO,UAFI1B,EAAU66B,SAASs3B,cAEN,IAAA;AAC5B,eAASjvD,IAAI,GAAGA,IAAI4Y,EAAO3Y,QAAQD,KAAK;AACnC,YAAA6C,IAAK+V,EAAO5Y,CAAAA,GACZq1D,IAAexyD,EAAG9C,MAAMjD,EAAUq/G,qBAAsB,2BAA2B,gBACnFt9C,IAAYh8D,EAAGg6D,QAAS,sCAAsCh6D,EAAGg6D,QAAQ,MAAO,IAChFA,IAASh6D,EAAGu6D,YAAa,iCAAiCv6D,EAAGu6D,YAAY,MAAO,IAEhFJ,IAAWlgE,EAAU66B,SAASu3B,iBAAiBrsD,CAAAA,GAC/Cu5G,IAAiBt/G,EAAU66B,SAASw3B;AAExC3wD,QAAAA,KAAQ,UAAQw+D,IAAS,aAAa3H,IAAc,iBAAiBxyD,EAAG9C,KAAK,OAAKjD,EAAUM,OAAO0C,kBAAgB,OAAK+C,EAAG9C,KAAG,cAAc8+D,IAAgBhC,KAAch6D,EAAG85D,eAAe,MAAM,cAAc7/D,EAAU+gB,GAAGs9F,iBAAiBr+G,EAAU+gB,GAAGw9F,wBAAwB,KAAK,wDAAwDv+G,EAAU+gB,GAAGs9F,iBAAiB,WAAWr+G,EAAUya,UAAUikG,SAAS34G,EAAGxE,YAAYwE,EAAGvE,UAAUuE,KAAM,UACxbrE,KAAQ,QAAQ49G,CAAAA;AAAAA;AAAAA,kBAGhB59G,KAAQ,iDAAiD1B,EAAU+gB,GAAGw9F,wBAAwBv+G,EAAU+gB,GAAGu9F,kBAAkB,UAAUt+G,EAAUya,UAAUkkG,SAAS54G,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAM,IAAA;AAAA,MACvM;AACQrE,MAAAA,KAAA,sCAAoC1B,EAAUM,OAAOsgC,MAAM,aAAa,cAAc5gC,EAAU+gB,GAAGs9F,iBAAiB,KAAK,iEAGjIr+G,EAAU6J,KAAmB,aAAE,GAAG4f,YAAY,GAC9CzpB,EAAU6J,KAAmB,aAAE,CAAA,EAAGiE,YAAYpM;AAG9C,UAAI6Q,IAAIvS,EAAU6J,KAAmB,aAAE,CAAGoG,EAAAA,WAAWD,YAEjDqjF,IAAcrzF,EAAU0sD,mBAAAA;AACzB2mC,MAAAA,MACFA,EAAYvlF,YAAU9N,EAAUya,UAAUza,EAAU0K,QAAQ,OAAS1K,EAAAA,EAAUkK,WAAWlK,EAAUiK,WAAWjK,EAAU0K,SAG1H1K,EAAU0lC,YAAY;AACtB,eAASxiC,IAAI,GAAGA,IAAIqP,EAAEpP,SAAS,GAAGD;AACjClD,UAAU0lC,UAAUxiC,CAAAA,IAAKqP,EAAErP,CAE7B;AAAA,IAAA;AAvHUlD,MAAA+V,cAAc,SAAS5N,GAAK+xD,GAAAA;AACjC,UAAA5wD,KAAKoB,SAAS;AAQV,eAAA0jB,EAAIliB,MAAM5C,MAAM+I;AARC;AACX+sG,QAAAA,EAAAA;AACT,YAAAtjG,IAAS9b,EAAU85D;AACnB8iD,QAAAA,MACHA,EAAW2C,qBACXzjG,EAAO1X,QAAShE,CAAAA,MAAUw8G,KAAAA,gBAAAA,EAAYlsC,eAAetwE,EAEvD;AAAA,MAAA;AAAA,IACiC,GAGxBJ,EAAA28G,WAAW,SAASp4G,GAAAA;AAC7BvE,QAAU6J,KAAKk7B,aAAa,GAAG9jC,MAAM+N,QAAShP,EAAU+gB,GAAGs9F,iBAAiBr+G,EAAU+gB,GAAGw9F,wBAAwB,IAAK,MACtHv+G,EAAUkK,YAAYlK,EAAUM,OAAOs+G,aAAc5+G,EAAU+J,aAAAA,GACrD/J,EAAAiK,YAAYjK,EAAUM,OAAOk/G,WAAWx/G,EAAUgC,KAAKC,IAAIjC,EAAU+J,aAAgB,GAAA,GAAG,MAClG/J,GAAAA,EAAUyK,cAAc,IAwGzB,SAAuBlG,GACtB;AAAA,YAAIA,GAAM;AACH,gBAAAq0E,IAAI54E,EAAU0tB,OAAOwN;AACjBl7B,YAAA6J,KAAqB,eAAE,GAAGiE,YAAY,8CAClC9N,EAAU+gB,GAAGs9F,iBAAiBr+G,EAAU+gB,GAAGw9F,wBAAwB,KACpE,oDACAv+G,EAAU+gB,GAAGs9F,iBAAiB,UAAUzlC,EAAE52E,OAC1C,2DACAhC,EAAU+gB,GAAGw9F,wBAAwB,UAAU3lC,EAAEv+B,cAAc,gBAC5Er6C,EAAUyK,kBACVzK,EAAUiiD;QACX;AAAA,MACD,EAnHe19C,CACV;AAAA,UAAAk7G,IAAe7xG,SAAS8/B,eAAe,cAAA;AA1IpC,UAAgB9nC,GAAuB85G;AAAAA,OA2K/C,SAAqBC,GAChB97G;AAAAA,YAAAA,IAAM+J,SAAS8/B,eAAeiyE,CAClC;AAAA,YAAI97G,GAAK;AACR,gBAAMmd,IAAahhB,EAAU8C,WAAW4d,cAAc,kBAAA,EAAoB2C;AACtE,cAAAtU,IAAS/O,EAAU8C,WAAW4d,cAAc,eAAA,EAAiB2C,eAAerjB,EAAU8C,WAAW4d,cAAc,iBAAmB2C,EAAAA;AAClItU,UAAAA,IAAS,MACHA,IAAA;AACN,cAAAC,IAAQhP,EAAU23B,KAAK33B,EAAU+gB,GAAGs9F,iBAAiBr+G,EAAU+gB,GAAGw9F,wBAAwB;AAC1FvvG,UAAAA,IAAQ,MACHA,IAAA,IACTnL,EAAI5C,MAAM8N,SAASA,IAAS,MAC5BlL,EAAI5C,MAAM+N,QAAQA,IAAQ,MAC1BnL,EAAI5C,MAAM8J,WAAW,YACrBlH,EAAI5C,MAAMC,MAAM8f,IAAa,MACzBhhB,EAAUM,OAAOsgC,MACpB/8B,EAAI5C,MAAM0+D,cAAe3/D,EAAU+gB,GAAGs9F,iBAAiBr+G,EAAU+gB,GAAGw9F,wBAAwB,IAAK,OAEjG16G,EAAI5C,MAAMG,aAAcpB,EAAU+gB,GAAGs9F,iBAAiBr+G,EAAU+gB,GAAGw9F,wBAAwB,IAAK,MAEjG16G,EAAI5C,MAAM2+G,YAAa5/G,EAAU+gB,GAAGC,aAAa,IAAK;AAAA,QACvD;AAAA,MACD,GArDa,iBAGRzc,KAAQk7G,KACX57G,EAAI5C,MAAMkgB,UAAU,SACPi+F,EAAAA,GAETp/G,EAAUM,OAAOy9G,qBAAqB/9G,EAAU6c,IAAIg0D,QAAQmtC,kBAC/DpB,KAAAA,QAAAA,EAAYiD,QAAQJ,IACpBvC,EAAal9G,CACb48G,GAAAA,KAAAA,QAAAA,EAAYkD,WAAWL,GAAcz/G,EAAUM,OAAOg9G,kBAEtDV,KAAAA,QAAAA,EAAYiD,QAAQJ,IACpBvC,EAAal9G,CACb48G,GAAAA,KAAAA,QAAAA,EAAYkD,WAAWL,GAAcz/G,EAAUM,OAAOg9G,eACrDt9G,EAAU6c,IAAIg0D,QAAQmtC,iBAAiBh+G,EAAUM,OAAOy9G,oBAEvDnB,MA5JmBh3G,IA6JL5F,EAAUM,OAAOg9G,cA7JWoC,IA6JG9C,GA5J9Ch3G,EAAQq4G,wBACP70F,UAAU22F,eACH32F,UAAA22F,YAAYC,mBAAmB,SAASj1G,GAAAA;AACzC20G,QAAAA,EAAAttC,QAAQrnE,EAASk1G,OAAOruC,UAAU7mE,EAASk1G,OAAOpuC,WAAWjsE,EAAQ4oE,sBAAuB5oE,EAAQ6oE,YAAY;AAAA,MAAA,CAAA,IAIlHixC,EAAAttC,QAAQxsE,EAAQwpE,iBAAiBV,KAAK9oE,EAAQwpE,iBAAiBT,KAAK/oE,EAAQ6oE,YAwJnF5qE,OAAAA,EAAI5C,MAAMkgB,UAAU,QACpBnhB,EAAU6J,KAAKk7B,aAAa,CAAA,EAAG9jC,MAAM+N,QAAQ,QACxC4tG,KAAc6C,MAClB7C,EAAWiD,QAAQJ,CACN7C,GAAAA,IAAA,MACb58G,EAAU6c,IAAIg0D,QAAQmtC,iBAAiBh+G,EAAUM,OAAOy9G,oBAlF3DlB,EAAgBz4G,QAAQnB,CAAAA,MAAMjD,EAAU6kB,YAAY5hB,KACpD45G,IAAkB,CAAA;AAAA,IAoFjB,GAsFS78G,EAAAsE,YAAY,mBAAmB,SAAUrB,GAAAA;AAElD,aADAurC,MAAM,yBACCugC,GAAAA,OAAOC,KAAK2C,OAAO,UAAA;IAAoB,CAG3C;AAAA,QAAAuuC,IAAuBtrD,eAAex0D,GAAAA;AACzC,UAAIw8G,GAAW;AACd,cAAMkB,UAAoBlB,EAAW9qC,eAAe1xE,EAAMmwE,cACtDutC;AAAAA,QAAAA,EAAYpvC,OAAOovC,EAAYnvC,OAC5BvuE,EAAAsuE,MAAAA,CAAOovC,EAAYpvC,KACnBtuE,EAAAuuE,MAAOmvC,CAAAA,EAAYnvC,QAEzB3uE,EAAUmJ,UAAU,mBAAmB,CAAC/I,EAAM6C,EAC9C7C,CAAAA,GAAAA,EAAMuuE,MAAM3uE,EAAUM,OAAOg9G,aAAaxuC,eAAeH,KACzDvuE,EAAMsuE,MAAM1uE,EAAUM,OAAOg9G,aAAaxuC,eAAeJ,MAE1D1uE,EAAUw9G,gBAAAA,IACVx9G,EAAUmJ,UAAU,kBAAkB,CAAC/I,EAAM6C,IAAI7C,CAClD,CAAA;AAAA,MAAA;AAAA,IAAA;AAYDJ,MAAUmgH,uBAAuB,MACvBngH,EAAAsE,YAAY,kBAAkB,SAASlE,GASzC;AAAA,aARHA,EAAMsuE,OAAOtuE,EAAMuuE,QAChBvuE,EAAAsuE,MAAAA,CAAOtuE,EAAMsuE,KACbtuE,EAAAuuE,OAAOvuE,EAAMuuE,MAEhB3uE,EAAUM,OAAOg9G,aAAaC,0BAA0Bn9G,EAAMmwE,kBAAmBnwE,CAAAA,EAAMsuE,QAAQtuE,EAAMuuE,QACxG3uE,EAAUmgH,wBAAwB,MAjBvB,SAASrpG,GAAQ2G,GAAQuwB,GAAQ5vB,GAAAA;AAC7CnG,mBAAW,WAAA;AACV,cAAGjY,EAAUkiB;AACL;AAER,cAAIk+F,IAAMtpG,EAAO5K,MAAMuR,GAAQuwB,CAAAA;AAExB,iBADPl3B,IAAS2G,IAASuwB,IAAS,MACpBoyE;AAAAA,QAAA,GACLhiG,KAAS;MAAC,EAUL8hG,GAAsB52G,MAAM,CAAClJ,CAAAA,GAAQJ,EAAUmgH,oBAEhD,IAAA;AAAA,IAAA;EACP,CAGF;AAAA,GjCzVCE,SkC7Dc,SAASrgH,GAAAA;AAExB,QAAMsgH,IAAmBtgH,EAAU+lB,qBAAAA;AAGnC/lB,IAAUM,OAAOigH,eAAe,EAC/BC,aAAa,GAAA,GAEdxgH,EAAUygH,wBAAwB,CAAA,GAClCzgH,EAAUyf,iBAAiB,SAAS/c,GAAKg+G,GAAOC,GAC/C;AAAA,QAAI9N,IAAM,MACN7wG,IAAOU,EAAIV,QAAShC,EAAU+J,aAIlC;AAAA,QAHW/H,OAAAA,KAAQ,aAClBA,IAAOsH,KAAKmR,UAAUs8C,SAAS/0D,CAE3B0+G,IAAAA;AA8DJ7N,MAAAA,IAAMvpG,KAAKs3G,iBAAiBF,EAAMn1G,YAAYvJ,GAAMU,GAAKg+G,IACzD1gH,EAAU6gH,eAAehO;SA/Dd;AACX,UAAIiO,IAAOp+G,EAAI8D,WACX2+C,IAAMziD,EAAIqI;AAOd,iBALW+1G,KAAQ,aAClBA,IAAOlzG,SAAS8/B,eAAeozE,CAAAA,WAErB37D,KAAO,aACjBA,IAAMv3C,SAAS8/B,eAAeyX,CAC3BA,IAAAA,KAAeA,EAAIhkD,SAAnBgkD,UAAiDA,EAAIp+B,UAAlC5lB,QAAyD;AAC/E,YAAI4/G,IAAO/gH,EAAUu+B,YAAY/V,UAAU28B,CAAAA;AAC3CA,QAAAA,IAAM,EACLjkD,KAAK6/G,EAAK7/G,MAAMikD,EAAI9hC,cACpBliB,MAAM4/G,EAAK5/G,KAEZ;AAAA,MAAA;AACI2/G,MAAAA,MACJA,IAAO9gH,EAAUghH,cAAc77D,CAAAA,KAEhC0tD,IAAMvpG,KAAKs3G,iBAAiBE,GAAM9+G,GAAMU,CAAAA,GAE/B4c,oBACRuzF,EAAIvzF,kBAAkB,IACtBghG,EAAiB96F,OAAOqtF,GAAK,UAAS,SAAUruG,GAAAA;AAC/C,YAAImP,IAAMnP,EAAEE,UAAUF,EAAEoiB,YAEpBq6F,IAAOjhH,EAAUu+B;AACrB,YAAI0iF,EAAKt8G,QAAQgP,GAAK,uBAChBstG,EAAKt8G,QAAQgP,GAAK,YAAA,KAAA,CAAkBstG,EAAKt8G,QAAQgP,GAAK,aAAgB,GAAA;AAE1E,cACIutG,IADWD,EAAKt8G,QAAQgP,GAAK,kBAAA,EACJxP,aAAa,gBACtC64C,GAAAA,IAAUh9C,EAAUya,UAAUC,WAAWwmG;AAE7ClhH,YAAU6gH,eAAev3G,OACzBtJ,EAAUmhH,aAAa73G,MAAM0zC,GAAS,oBACtC1zC,GAAAA,KAAK83G,aAAapkE,GAEf1zC,KAAK+3G,KAAKvlG,UAAUxS,KAAK+3G,KAAKvlG,OAAOwlG,eACvCh4G,KAAK+3G,KAAKvlG,OAAOwlG,YAAY/sG,KAAKjL,MAAM0zC,GAASx4C,IAG9C8E,KAAK+3G,KAAK3nG,WAASpQ,KAAK+3G,KAAK3nG,QAAQnF,KAAKvU,GAAWg9C,GAAS1zC;QAClE;AAAA,MAEF,GAAE6P,KAAK05F,CAERyN,CAAAA,GAAAA,EAAiB96F,OAAOqtF,GAAK,cAAa,SAAUruG,GAAAA;AACnD,cAAME,IAASF,EAAEE;AAEjB,YAAIA,EAAOma,UAAUyC,SAAS,uBAAuB;AACpD,cAAI4/F,IAAgBx8G,EAAOP,aAAa,gBAAA,GACpC64C,IAAUh9C,EAAUya,UAAUC,WAAWwmG,CAE1C53G;AAAAA,eAAK+3G,KAAKvlG,UAAUxS,KAAK+3G,KAAKvlG,OAAOylG,mBACvCj4G,KAAK+3G,KAAKvlG,OAAOylG,gBAAgBhtG,KAAKjL,MAAM0zC,GAASx4C;QAEtD;AAAA,MACD,GAAE2U,KAAK05F,CAAAA,CAAAA;AAAAA,IAGX;AAKC,QAAI7yG,EAAUM,OAAOigH,aAAaC;AAMjC,eALIvzG,IAAQjN,EAAUgC,KAAK6sB,YAAY7sB,CAAAA,GACnCkL,IAAMlN,EAAUgC,KAAKC,IAAIgL,GAAO,GAAG,OACnC9E,GAAAA,IAAMmB,KAAK+6B,UAAUp3B,GAAOC,CAC5BmM,GAAAA,IAAS/P,KAAK,YAAYA,KAAKoB,KAC/B82G,GAAAA,IAAc,CAAA,GACTt+G,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,YAAI6C,IAAKoC,EAAIjF,CAAAA;AACb,aAAImW,KAAWA,EAAOtT,EAAG9C,IAAI8C,CAAAA,GAA7B;AAEA,cAAI4L,IAAI5L,EAAGxE;AAIX,eAHIoQ,EAAElP,YAAYwK,EAAMxK,QAAAA,MACvBkP,IAAI1E,IACL0E,IAAI3R,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKmP,EAAElP,QAAAA,CAAAA,CAAAA,GACjCkP,IAAI5L,EAAGvE,aACTggH,GAAa7vG,CAChB6vG,MAAAA,EAAAA,CAAa7vG,CAAK,IAAA,IAClBrI,KAAK63G,aAAatO,GAAKlhG,GAAG,gBAAA,IAAA,GAE3BA,IAAIrI,KAAKtH,KAAKC,IAAI0P,GAAG,GAAG,KAClBlP,GAAAA,QAAAA,KAAayK,EAAIzK,QAAAA;AAAAA;AAAAA,QAXd;AAAA,MAcV;AAmBF,WAhBA6G,KAAKm4G,yBAAyB5O,CAAAA,GAE9BA,EAAIwO,OAAO3+G,GACPA,EAAIg/G,QAAAA,CAASf,KAChBr3G,KAAKm3G,sBAAsB99G,KAAKkwG,CAAAA,GAE7BA,EAAIwO,KAAKM,oBACZ9O,EAAIwO,KAAKM,kBAAkB3hH,EAAUsE,YAAY,SAAS;AACzDtE,QAAU4hH,eAAe/O,GAAKA,EAAIwO,KAAKr/G;IAC1C,CAGIsH,IAAAA,KAAKhJ,OAAO8iB,uBAAuB9Z,KAAKhJ,OAAOqhD,6BACjDkxD,EAAI9zF,aAAa,QAAQ,aAGnB8zF,GAAAA;AAAAA,EACR,GACA7yG,EAAUghH,gBAAgB,SAAS77D,GAAAA;AAuBlC,WAtBK77C,KAAK0pG,eACT1pG,KAAK0pG,aAAaplG,SAASC,cAAc,KAAA,GACzCvE,KAAK0pG,WAAWlkG,YAAY,qBAC5B9O,EAAUI,MAAMkJ,KAAK0pG,YAAY,SAAS,SAASxuG;AAAKA,MAAAA,EAAEigC,eAAAA;AAAAA,IAAsB,CAChF72B,GAAAA,SAASmJ,KAAKhJ,YAAYzE,KAAK0pG,UAAAA,IAG7B7tD,EAAIhkD,SACNmI,KAAK0pG,WAAW/xG,MAAME,OAAOgkD,EAAIhkD,OAAO,OAEtCgkD,EAAIp+B,UACNzd,KAAK0pG,WAAW/xG,MAAM8lB,QAAQo+B,EAAIp+B,QAAQ,OAExCo+B,EAAIjkD,QACNoI,KAAK0pG,WAAW/xG,MAAMC,MAAMikD,EAAIjkD,MAAM,OAEpCikD,EAAI/5B,WACN9hB,KAAK0pG,WAAW/xG,MAAMmqB,SAAS+5B,EAAI/5B,SAAS,OAG7C9hB,KAAK0pG,WAAW6O,WAAW,oBAAIr/G,QAExB8G,KAAK0pG;AAAAA,EACb,GACAhzG,EAAU8hH,kBAAkB,SAASjP,GAAK7wG,GAIzC;AAAA,QAHWA,OAAAA,KAAQ,aAClBA,IAAOhC,EAAUya,UAAUs8C,SAAS/0D,CAEjCA,IAAAA,CAAAA,IAAAA,CAAQ6wG,EAAI5oG,aAAcjI,CAAAA,IAAAA,CAAQ6wG,EAAI3oG;AACzC,aAAO;AAMR,aAJImkD,IAAQwkD,EAAInyF,cAAc,gBAAA,EAAkB1Q,WAAW,CAEvD+xG,GAAAA,IAAU,GACVhnB,IAAM,IAAIv4F,KAAKqwG,EAAI3oG,SAChBZ,GAAAA,CAAAA,KAAKtH,KAAKC,IAAI84F,GAAK,GAAG,MAAY/4F,KAAAA,CAAAA;AACxC+4F,MAAAA,IAAMzxF,KAAKtH,KAAKC,IAAI84F,GAAK,GAAG,MAAA,GAC5BgnB;AAGD,QAAI/iD,IAAKh/D,EAAUM,OAAOsuB,iBACtB3gB,KAAOjM,EAAKyF,OAAau3D,MAAAA,IAAK,IAAI,OAAOA,IAAK,IAAI;AAEtD,UAAMgjD,IAAU3zD,EAAM3tC,cAAc,gCAAgCqhG,IAAU,CAAoC9zG,mCAAAA,IAAM;AACxH,WAAG+zG,IACKA,EAAQ/xG,aAER;AAAA,EAET,GACAjQ,EAAUmhH,eAAe,SAAStO,GAAK7wG,GAAMP,GAAAA;AAC5C,QAAI4J,IAAM/B,KAAKw4G,gBAAgBjP,GAAK7wG,CAAAA;AAChCqJ,UAGJA,EAAIyD,aAAa,MAAMrN;AAAAA,EACxB,GACAzB,EAAU6gH,iBAAiB,SAAShO,GAAK7wG,GAAMP,GAG9C;AAAA,QADAA,IAAMA,KAAO,sBADbO,IAAOA,KAAQ6wG,EAAIuO,YAEnB;AACA,UAAIl8F,IAAK5b,KAAKw4G,gBAAgBjP,GAAK7wG,CAC/BkjB;AAAAA,YAEJA,EAAGpW,aAAaoW,EAAGpW,aAAa,IAAI+I,QAAQkd,OAAOtzB,GAAK,GAJtC,CAAA;AAAA,IAAA;AAAA,EAKnB,GACAzB,EAAUiiH,iBAAiB,SAASjzG,GAAAA;AAMnC,aALIw8C,IAAQx8C,KAAS,KACjB7N,IAAO,GAEP+gH,IAAgBt0G,SAASC,cAAc,KAAA,GACvCs0G,IAAa74G,KAAKtH,KAAKY,WAAW5C,EAAU+J,aACvC7G,CAAAA,GAAAA,IAAI,GAAGA,IAAI,GAAGA;AACtBoG,WAAKqF,MAAMzL,CAAKkM,IAAAA,KAAK+D,MAAMq4C,KAAQ,IAAItoD,EACvCoG,GAAAA,KAAKshD,iBAAiB1nD,GAAG/B,GAAMghH,GAAYD,CAC3CC,GAAAA,IAAa74G,KAAKtH,KAAKC,IAAIkgH,GAAY,GAAG,KAC1C32D,GAAAA,KAAQliD,KAAKqF,MAAMzL,CAAAA,GACnB/B,KAAQmI,KAAKqF,MAAMzL,CAGpB;AAAA,WADAg/G,EAAcl/C,UAAUl0D,aAAa,uBAC9BozG;AAAAA,EACR,GACAliH,EAAU4hH,iBAAiB,SAASl/G,GAAKopD,GAAAA;AACxC,QAAGppD,EAAI2+G,KAAKr/G,QAAQU,EAAI2+G,KAAKvlG,UACzBpZ,EAAI2+G,KAAKvlG,OAAOsmG,uBACN1/G,EAAI2+G,KAAKvlG,OAAOsmG,oBAAoB7tG,KAAK7R,GAAKA,EAAI2+G,KAAKr/G,MAAM8pD,GAAIppD,CAAAA,MAC7E;AACC;AAIH,UAAMuhE,IAAUvhE,EAAI2+G,KAAKr/G;AAEzBU,IAAAA,EAAI2+G,KAAKr/G,OAAO8pD,GAChBxiD,KAAKmW,eAAe/c,EAAI2+G,MAAM3+G,GAAK,EAAA,GAChCA,EAAI2+G,KAAKvlG,UACRpZ,EAAI2+G,KAAKvlG,OAAOumG,iBAClB3/G,EAAI2+G,KAAKvlG,OAAOumG,cAAc9tG,KAAK7R,GAAKuhE,GAASnY,CAGpD;AAAA,EAAA,GACA9rD,EAAUsiH,mBAAmB,CAAC,UAAU,QACxCtiH,GAAAA,EAAU4gH,mBAAmB,SAASl+G,GAAKopD,GAAIu1D,GAAMkB,GAEpD;AAAA,QAAIC,IAAKxiH,EAAUya,WACfgT,IAAOnkB,KAAKqF;AAChBrF,SAAKqF,QAAQ,CACb;AAAA,QAAI8zG,IAAQn5G,KAAKoB;AACjBpB,SAAKoB,QAAQ;AACb,QAAIg4G,IAAQp5G,KAAKi8C;AACjBj8C,SAAKi8C,SAAS,EAACx2C,QAAQ,EACvB;AAAA,QAAI4zG,IAAQ,IAAIngH,KAAK8G,KAAKY,SACtB04G,GAAAA,IAAQ,IAAIpgH,KAAK8G,KAAKW,SAAAA,GACtB44G,IAAQ,IAAIrgH,KAAKxC,EAAUoT,KAC3B0vG,GAAAA,IAAQN,EAAGh5E,WACXu5E,IAAQz5G,KAAKo8C;AAAmBp8C,SAAKo8C,oBAAoB,GAC7D88D,EAAGh5E,YAAYg5E,EAAGxpD,eAElBlN,IAAKxiD,KAAKtH,KAAK6sB,YAAYi9B,CAAAA;AAC3B,QAEIn6C,GAFAuwG,IAAgB54G,KAAK24G,eAAev/G,EAAI6gB,cAAc,IAAIja,KAAKhJ,OAAOigH,aAAayC,OAGnFT;AAAAA,IAAAA,IACH5wG,IAAI4wG,MAEJ5wG,IAAI/D,SAASC,cAAc,QACzBiB,YAAY,uCACVxF,KAAKhJ,OAAOsgC,QAAKjvB,EAAE7C,aAAa,4BAErC6C,EAAEoN,aAAa,QAAQzV,KAAKstB,SAASsf,WAAW4V,CAAAA,CAAAA,GAChDn6C,EAAE7D,YAAY,iEAEX9N,EAAUM,OAAOsgC,MAAM,oBAAoB,QAC5C,iCAA+BshF,IAAgBA,EAAcp0G,YAAY,MAH7D;AAMd,QAAIuqB,IAAS1mB,EAAE+O,cAAc,iBACzBuiG,GAAAA,IAAatxG,EAAE+O,cAAc,gBAAA,GAC7B3J,IAAOpF,EAAE+O,cAAc;AAG3B,QADA2X,EAAOvqB,YAAYxE,KAAKmR,UAAUq+C,eAAehN,IAC7Cu1D,EAAK3hG;AA4BR,eA3BIwjG,IAAyB,SAASvjG,GAAU6mC,GAAAA;AAC/C,YAAIxkD,IAAOhC,EAAUgC,KAAKC,IAAI0d,EAASvM,OAAOozC,GAAM,OACpDxmD;AAAAA,UAAU4hH,eAAejiG,GAAU3d,CAAAA,GAC/BhC,EAAUoT,MAAM+J,SAAcwC,KAAAA,EAASvM,MAAM+J,SAAcnd,KAAAA,EAAUoT,MAAM8J,YAAiByC,KAAAA,EAASvM,MAAM8J,YAC9Gld,KAAAA,EAAUyhH,yBAAyB9hG,CAAAA;AAAAA,MAEvC,GAEMwjG,IAAiB,CAAC,uBAAuB,qBAAA,GACzCC,IAAY,CAAC,uCAAuC,oDACpDC,IAAQ,CAAA,IAAK,CAAA,GACb3pG,IAAU,SAAS8sC;AACtB,eAAO,WAAA;AACN,cAAI66D,EAAKK;AAER,qBADI4B,IAAYtjH,EAAUygH,uBACjB9zG,IAAI,GAAGA,IAAI22G,EAAUngH,QAAQwJ;AACrCu2G,cAAAA,EAAuBI,EAAU32G,IAAI65C,CAGlCxmD;AAAAA;AAAAA,cAAUM,OAAOsgC,QACpB4lB,IAAQA,CAAAA,IAET08D,EAAuBvxG,GAAG60C,CAAAA;AAAAA,QAE/B;AAAA,MACA,GACMtrB,IAAS,CAACl7B,EAAU0tB,OAAOwN,OAAOwc,MAAM13C,EAAU0tB,OAAOwN,OAAO3a,IAC3DsT,GAAAA,IAAI,GAAGA,IAAI,GAAGA,KAAK;AAC3B,YAAI0vF,IAAQ31G,SAASC,cAAc,KAAA;AAEnC01G,UAAMz0G,YAAYq0G,EAAetvF,IAEjC7zB,EAAU66B,SAASqvB,wBAAwBq5D,GAAOroF,EAAOrH,CAEzD0vF,CAAAA,GAAAA,EAAMtiH,MAAMgzC,UAAUmvE,EAAUvvF,CAChC0vF,GAAAA,EAAMz1G,YAAYxE,KAAKg5G,iBAAiBzuF,IACxCwE,EAAOtqB,YAAYw1G,IACnBjD,EAAiB96F,OAAO+9F,GAAO,SAAS7pG,EAAQ2pG,EAAMxvF,CACtD,CAAA,CAAA;AAAA,MAAA;AAEFliB,IAAAA,EAAEyB,QAAQ,IAAI5Q,KAAKspD,CAAAA,GAEnBn6C,EAAE/O,cAAckpD,EAAGrkD,OAAY6B,KAAAA,KAAKhJ,OAAOsuB,kBAAkB,IAAI,KAAK,KAAK;AAE3E,QAAIoH,IAAKrkB,EAAEzH,YAAYZ,KAAKtH,KAAKY,WAAWkpD;AAC5Cn6C,IAAAA,EAAE1H,YAAYX,KAAKtH,KAAKC,IAAI0P,EAAEzH,WAAW,GAAG,MAAA,GAE5CZ,KAAK0jD,mBAAmBj2C,GAAM+0C,GAAI91B,GAAI,CAAA,GAEjCusF,KACJ7/G,EAAIqL,YAAY4D,CAEjBsxG,GAAAA,EAAWhiH,MAAM8N,SAAUk0G,EAAWjzG,WAAW,CAAA,EAAGqT,eAAe,IAAK;AAExE,QAAIkvC,IAAWvyD,EAAUqM,IACzBrM;AAAAA,MAAU66B,SAASy3B,cAAcj6B,GAAQk6B,CACzCvyD,GAAAA,EAAU66B,SAAS23B,YAAY7gD,EAAE+O,cAAc,gBAAmB6xC,GAAAA,CAAAA,GAClEvyD,EAAU66B,SAAS43B,WAAWwwD,CAAAA;AAG9B,aADIO,IAAaP,EAAWlgH,iBAAiB,gBAAA,GACrCG,IAAI,GAAGA,IAAIsgH,EAAWrgH,QAAQD;AACrClD,QAAU66B,SAAS+3B,gBAAgB4wD,EAAWtgH;AAE/C,QAAIugH,IAAW1sG,EAAKhU,iBAAiB,qBAAA,GACjCk8C,IAAY,IAAIz8C,KAAKwzB,CAAAA;AACzB,SAAQ9yB,IAAI,GAAGA,IAAIugH,EAAStgH,QAAQD;AAEnClD,QAAU66B,SAAS63B,eAAe+wD,EAASvgH,CAAI,GAAA,IAAIV,KAAKy8C,CACxDA,CAAAA,GAAAA,IAAYj/C,EAAUgC,KAAKC,IAAIg9C,GAAW,GAAG,KAAA;AAc9C,WAXAj/C,EAAU66B,SAASy3B,cAAcj6B,GAAQk6B,CAGzCjpD,GAAAA,KAAKqF,QAAQ8e,GACbnkB,KAAKoB,QAAQ+3G,GACbn5G,KAAKi8C,SAASm9D,GACdp5G,KAAKY,YAAYy4G,GACjBr5G,KAAKW,YAAY24G,GACjB5iH,EAAUoT,QAAQyvG,GAClBL,EAAGh5E,YAAYs5E,GACfx5G,KAAKo8C,oBAAoBq9D,GAClBpxG;AAAAA,EACR,GACA3R,EAAUwf,kBAAkB,SAASqzF,GAAKt1F;KACpCs1F,KAAOvpG,KAAK0pG,cAAc1pG,KAAK0pG,WAAW/iG,eAC1CsN,MAAS,oBAAK/a,QAAQC,YAAY6G,KAAK0pG,WAAW6O,SAASp/G,QAAY,IAAA,SAC1EowG,IAAMvpG,KAAK0pG,WAAW/iG,aAEnB4iG,MACLyN,EAAiB36F,UAAAA,GAEjBktF,EAAI/kG,YAAY,IACZ+kG,EAAItnG,cACPsnG,EAAItnG,WAAWC,YAAYqnG,CACxBvpG,GAAAA,KAAK0pG,eACR1pG,KAAK0pG,WAAW/xG,MAAMC,MAAM,YAE1B2xG,EAAIwO,QAAQxO,EAAIwO,KAAKM,mBACvB3hH,EAAU6kB,YAAYguF,EAAIwO,KAAKM;EACjC,GACA3hH,EAAUuf,oBAAoB,WAC7B;AAAA,WAAA,CAAA,EAAIjW,KAAK0pG,cAAcpqF,SAAStf,KAAK0pG,WAAW/xG,MAAMC,KAAK,MAAM,MACzDoI,KAAK0pG;AAAAA,EAEd,GAEAhzG,EAAUsE,YAAY,oBAAoB,WACzCtE;AAAAA,MAAUI,MAAMwN,SAASmJ,MAAM,SAAS,WAAa/W;AAAAA,QAAUwf;IAAkB,CAClF;AAAA,EAAA,GAAG,EAACvD,MAAAA,GAIJjc,CAAAA,GAAAA,EAAUu4B,YAAY0gC,gBAAgB,EACrCrjD,QAAQ,SAASwjB,GAAAA;AAChB,QAAI13B,IAAO,6HAEP2C,IAAMrE,EAAUM,QAChBu5B,IAAKvwB,KAAKtH,KAAKwF,UAAUxH,EAAU+J,aAEnC+vB,CAAAA,GAAAA,IAAO,MAASC,IAAQ;AACxB11B,IAAAA,EAAI21B,sBACPD,IAAQ,KAAK11B,EAAI+F,YACjB0vB,IAAO,KAAKz1B,EAAIgG,YAAY,IAE7BwvB,EAAG7wB,SAAS+wB,IAAQ,EAAA,GAEpBX,EAAIqB,eAAe,IACnB/4B,KAAQ;AACR,aAASwB,IAAI62B,GAAO72B,IAAI42B,GAAM52B,KAA6B,IAAxBoG,KAAKhJ,OAAOq6B;AAE9Cj5B,WAAQ,oBAAoBwB,IAAI,OADrBoG,KAAKmR,UAAUigB,YAAYb,CACQ,IAAA,aAC9CT,EAAIqB,aAAa93B,KAAKO,CACtB22B,GAAAA,IAAKvwB,KAAKtH,KAAKC,IAAI43B,GAAIvwB,KAAKhJ,OAAOq6B,WAAW,QAAA;AAM/C,WAAO,yDAJPj5B,KAAQ,eAI8D,2EAA2EA,IAAO;AAAA,EACxJ,GACDg3B,WAAW,SAASpS,GAAM9N,GAAOzS,GAAIzF,GAAAA;AAEpC,QAEIiB,GACHC,GAHGkiH,IAASp9F,EAAKwS,qBAAqB,UACnC6qF,IAAUr9F,EAAKwS,qBAAqB,QAAA,GAIpC0oB,IAAa,SAASoiE,GAAK5hH,GAAMu3E,GAAAA;AACpCv5E,QAAUI,MAAMwjH,GAAK,SAAS,WAC7B5jH;AAAAA,UAAUwf,gBAAgB,MAAA,EAC1Bxf,GAAAA,EAAUyf,eAAe,EACxB1U,UAAU64G,GACV5hH,MAAM,IAAIQ,KAAK8G,KAAK8J,KAAAA,GACpBsM,YAAY,IACZhG,SAAS,SAASmqG;AACjBD,UAAAA,EAAIprG,QAAQxY,EAAUya,UAAUw+C,cAAc4qD,IAC9CD,EAAIxwG,QAAQ,IAAI5Q,KAAKqhH,CACrB7jH,GAAAA,EAAUwf,mBACNxf,EAAUM,OAAOm7B,kBAAkBz7B,EAAUM,OAAOk7B,iBAAiB+9C,MAAW,KACnFuqC,EAED;AAAA,QAAA,EAAA,CAAA;AAAA,MAEN,CACA;AAAA,IAAA;AAEE,QAAI9jH,EAAUM,OAAO06B,UAAU;AAC9B,UAAA,CAAK1U,EAAK2U,WAAW;AACpB,YAAIv5B,IAAO,qFAAqF1B,EAAU0tB,OAAOwN,OAAOF,WAAW;AAC9Hh7B,UAAUM,OAAO66B,cACrBz5B,IAAO4kB,EAAK8U,gBAAgBttB,YAAYpM,IACzC4kB,EAAK8U,gBAAgBttB,YAAYpM,GACjC4kB,EAAK2U,YAAAA;AAAAA,MACL;AACD,UAAIvT,IAAQpB,EAAK8U,gBAAgBtC,qBAAqB,SAAS,CAE3DirF,GAAAA,IAAkB/jH,EAAUgC,KAAKysB,UAAU1oB,EAAGxE,UAAAA,MAAgB,KAAKvB,EAAUgC,KAAKysB,UAAU1oB,EAAGvE,QACnGkmB,MADiH;AACjHA,MAAAA,EAAM2T,UAAU0oF,GAEhBJ,EAAQ,GAAGroF,WAAW5T,EAAM2T,SAC5BsoF,EAAQ,CAAGroF,EAAAA,WAAW5T,EAAM2T,SAEvB3T,EAAMpI,oBACVoI,EAAMpI,kBAAAA,IACNtf,EAAUI,MAAMsnB,GAAO,SAAS,WAC/B;AAAA,YAAIA,EAAM2T,YAAV,IAA4B;AAC3B,cAAI34B,IAAM,CAAA;AACV1C,YAAUu4B,YAAY0gC,cAAczgC,UAAUlS,GAAM5jB,IAEpDnB,IAAavB,EAAUgC,KAAKwF,UAAU9E,EAAInB,gBAC1CC,IAAWxB,EAAUgC,KAAKwF,UAAU9E,EAAIlB,QAAAA,MAAAA,CAEtBD,MAAgBC,KAAaD,CAAAA,MAAewE,EAAGvE,SAAS2I,eAAe,KAAKpE,EAAGvE,SAASiK,WACzGjK,MAD0H,QAC1HA,IAAWxB,EAAUgC,KAAKC,IAAIT,GAAU,GAAG,KAAA;AAAA,QAClD;AACMD,UAAAA,IAAa,MACbC,IAAW;AAGZ,YAAIyL,IAAQ1L,KAAcwE,EAAGxE,YACzB2L,IAAM1L,KAAYuE,EAAGvE;AACzBwiH,QAAAA,EAAeN,EAAO,CAAIz2G,GAAAA,CAAAA,GAC1B+2G,EAAeN,EAAO,IAAIx2G,CAC1By2G,GAAAA,EAAQ,GAAGnrG,QAA2B,KAAnBvL,EAAM9C,SAAkB8C,IAAAA,EAAMxB,WACjDk4G,GAAAA,EAAQ,CAAGnrG,EAAAA,QAAyB,KAAjBtL,EAAI/C,SAAAA,IAAkB+C,EAAIzB,WAE7Ck4G,GAAAA,EAAQ,GAAGroF,WAAW5T,EAAM2T,SAC5BsoF,EAAQ,CAAGroF,EAAAA,WAAW5T,EAAM2T;AAAAA,MAEjC,CAAA;AAAA,IAEG;AACD,QAAIr7B,EAAUM,OAAOm7B,kBAAkBz7B,EAAUM,OAAOk7B,eAAe;AAEtE,UAAIsoF,IAAyB,WACtB9jH;AAAAA,UAAUM,OAAOk7B,iBAAiBx7B,EAAUM,OAAOm7B,mBAIzDl6B,IAAavB,EAAUgC,KAAKC,IAAIyhH,EAAO,GAAGtwG,OAAOuwG,EAAQ,GAAGnrG,OAAO,QAAA,GACnEhX,IAAW,IAAIgB,KAAKjB,EAAWitB,QAAAA,IAA+C,KAAlCxuB,EAAUM,OAAOm7B,iBAAsB,GAAA,GAEnFioF,EAAO,CAAGlrG,EAAAA,QAAQxY,EAAUya,UAAUw+C,cAAcz3D,IACpDkiH,EAAO,CAAA,EAAGtwG,QAAQpT,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKhB,KAEpDmiH,EAAQ,CAAA,EAAGnrG,QAA8B,KAAtBhX,EAAS2I,SAAAA,IAAkB3I,EAASiK,WAC3D;AAAA,MAAA;AAEOk4G,MAAAA,EAAQ,CAAGrkG,EAAAA,mBACdqkG,EAAQ,CAAGx+F,EAAAA,iBAAiB,UAAU2+F,CAAAA;AAAAA,IAEvC;AAED,aAASE,EAAeJ,GAAK5hH,GAAMu3E;AAClC/3B,MAAAA,EAAWoiE,GAAK5hH,GAAMu3E,CACtBqqC,GAAAA,EAAIprG,QAAQxY,EAAUya,UAAUw+C,cAAcj3D,IAC9C4hH,EAAIxwG,QAAQpT,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKR,CAAAA,CAAAA;AAAAA,IAC9C;AAMD,aAASiiH,EAAejiH,GAAAA;AAMvB,eALI25B,IAAcr7B,EAAOm6B,cACrBmB,IAAiC,KAAlB55B,EAAKmI,SAAAA,IAAkBnI,EAAKyJ,WAAAA,GAC3CowB,IAAcD,GACdE,QAEKnvB,IAAI,GAAGA,IAAIgvB,EAAYx4B,QAAQwJ,KAAK;AAC5C,YAAIovB,IAAMJ,EAAYhvB,CAAAA;AACtB,YAAIovB,MAAQH,GAAc;AACzBE,UAAAA,IAAc;AACd;AAAA,QACA;AACGC,QAAAA,IAAMH,MACTC,IAAcE;AAAAA,MACf;AAED,aAAKD,KAAeD,IAGb34B,IAAgB04B,IAAeC,IAAAA;AAAAA,IACtC;AAxBDmoF,IAAAA,EAAeN,EAAO,CAAA,GAAI39G,EAAGxE,YAAY,IACzCyiH,EAAeN,EAAO,IAAI39G,EAAGvE,UAAU,IACvCggD,IAAa,WAAA;AAAA,IAAW,GAwBxBmiE,EAAQ,CAAGnrG,EAAAA,QAAQyrG,EAAel+G,EAAGxE,UAAAA,GACrCoiH,EAAQ,CAAGnrG,EAAAA,QAAQyrG,EAAel+G,EAAGvE,QAAAA;AAAAA,EAErC,GACDg3B,WAAW,SAASlS,GAAMvgB;AACzB,QAAI29G,IAASp9F,EAAKwS,qBAAqB,OAAA,GACnC6qF,IAAUr9F,EAAKwS,qBAAqB,QAOxC;AAAA,WALA/yB,EAAGxE,aAAavB,EAAUgC,KAAKC,IAAIyhH,EAAO,CAAGtwG,EAAAA,OAAOuwG,EAAQ,CAAGnrG,EAAAA,OAAO,QACtEzS,GAAAA,EAAGvE,WAAWxB,EAAUgC,KAAKC,IAAIyhH,EAAO,GAAGtwG,OAAOuwG,EAAQ,GAAGnrG,OAAO,QAAA,GAEhEzS,EAAGvE,YAAYuE,EAAGxE,eACrBwE,EAAGvE,WAAWxB,EAAUgC,KAAKC,IAAI8D,EAAGxE,YAAYvB,EAAUM,OAAOq6B,WAAW,QAAA,IACtE,EACNp5B,YAAY,IAAIiB,KAAKuD,EAAGxE,aACxBC,UAAU,IAAIgB,KAAKuD,EAAGvE,QAAAA,EAAAA;AAAAA,EAEvB,GACD63B,OAAO,SAAS/S,GAAAA;AAAAA,EACf,KAEFtmB,EAAUkkH,eAAe,SAASvkG,GAAUwkG,GAAAA;AAC3C,QAAI/rG,IAAS,WAAA;AACZ,UAAIpW,IAAOhC,EAAUoT,OACjBgxG,IAAU,IAAI5hH,KAAKR,EAAKS,QAAAA,CAAAA;AAI5B,aAHI0hH,MAAUC,IAAUD,EAASC,CAAAA,IACjCA,EAAQt1F,QAAQ,IAChB9uB,EAAU4hH,eAAejiG,GAAUykG,CAC5B,GAAA;AAAA,IACT;AAECpkH,MAAUsE,YAAY,gBAAgB8T,CAAAA,GACtCpY,EAAUsE,YAAY,SAAS8T,CAC/BpY,GAAAA,EAAUsE,YAAY,gBAAgB8T,CAAAA,GACtCpY,EAAUsE,YAAY,kBAAkB8T,CACxCpY,GAAAA,EAAUsE,YAAY,kBAAkB8T,IACxCA,EACD;AAAA,EAAA,GAEApY,EAAUyhH,2BAA2B,SAAS9hG;AAC7C,QAAImwB,IAAQ9vC,EAAU4E,SAAAA,GAClBitB,IAAOie,EAAM3hC,UACb4jB,IAAK+d,EAAM1hC,UACX7J,IAAOurC,EAAMvrC,MAEbsqB,IAAc7uB,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKmd,EAASvM,KAC3DixG,CAAAA,GAAAA,IAAYrkH,EAAUgC,KAAKC,IAAI4sB,GAAa,GAAG,OAAA;AASnD,QAPkB,EAAA,EACjB+Q,OAAQ,IACRC,UACA2gB,QAAAA,IACAC,MAAO,GAAA,EAGOl8C,MAAUstB,EAAKpvB,QAAAA,KAAaosB,EAAYpsB,QAAAA,KAAasvB,EAAGtvB,QAAAA,KAAa4hH,EAAU5hH,QAK9F;AAAA,eADI8tG,IAAU1+E,GACR0+E,EAAQ9tG,QAAYsvB,IAAAA,EAAGtvB,QACxBosB;AAAAA,QAAAA,EAAYpsB,QAAa8tG,KAAAA,EAAQ9tG,aAAa4hH,IAAY9T,KAC7DvwG,EAAUmhH,aAAaxhG,GAAU4wF,GAAS,oBAE3CA,GAAAA,IAAUvwG,EAAUgC,KAAKC,IAAIsuG,GAAS,GAAG,KAE3C;AAAA,EAAA,GAEAvwG,EAAUsE,YAAY,iBAAiB;AACtCtE,MAAUwf,gBAAgB,MAAM,EAAA;AAAA,EACjC,CAEAxf,GAAAA,EAAUsE,YAAY,aAAa,WAAA;AAClCtE,MAAUwf,gBACX;AAAA,EAAA,CAAA;AAEA,GlCpiBC8kG,amC9Dc,SAAStkH,GAExBA;AAAAA,IAAUsE,YAAY,oBAAmB;AACxCtE,MAAU+gB,GAAGshB,eAAe;AAE5B,QAAIjU,IAAMpuB,EAAUgW;AACpBhW,MAAUgW,mBAAiB,WAC1B;AAAA,UAAIpG,IAAOtG,KAAKO,KAAmB,aAAE,CACrC+F;AAAAA,QAAKK,WAAWunF,SAAS,IAEzBppE,EAAIliB,MAAMlM,GAAUqS,SAAAA;AAIpB,UAAItD,IAAS6Z,SAAShZ,EAAK3O,MAAM8N,MAAAA;AACjCa,QAAK3O,MAAM8N,SAAO,OAClBa,EAAK3O,MAAM8N,SAAOa,EAAKusD,eAAa,MAEpC7yD,KAAKuuB,KAAK52B,MAAM8N,SAASzF,KAAKuuB,KAAK/V,eAAelS,EAAKusD,eAAeptD,IAAS;AAAA,IACjF;AAEC,QAAIw1G,IAAMvkH,EAAUgtD;AACpBhtD,MAAUgtD,qBAAmB,SAAS7qC,GAAEC,GAAEla,GAAEyJ;AAC3C,UAAI2X,IAAQ,EAACxH,cAAa,IAAA;AAC1ByiG,MAAAA,EAAMr4G,MAAMlM,GAAU,CAACspB,GAAMlH,GAAEla,GAAEyJ,KACjCwQ,EAAErU,YAAYwb,EAAMxb;AAAAA,IACtB;AAAA,EAEA;AAEA,GnCiCC29D,coC7Dc,SAASzrE,GAAAA;AAExBA,IAAUM,OAAOmrE,mBACjBzrE,EAAUM,OAAOkkH,yBAAyB,IAC1CxkH,EAAUM,OAAOsD,oBAAoB,KACrC5D,EAAUsE,YAAY,oBAAoB;AACzCm1F,IAAAA,GAAuBz5F,CAAAA;AAGvB,QAAIykH,IAAWzkH,EAAU0kH;AACzB1kH,MAAU0kH,uBAAuB,SAAStsG,GAAAA;AACzC,aAAOpY,EAAU2kH,iBAAiBvsG,GAAQqsG,CAAAA;AAAAA,IAC5C;AACC,QAAI/qB,IAAe15F,EAAUq7F;AAC7Br7F,MAAUq7F,2BAA0B,SAASjjF,GAC5C;AAAA,aAAOpY,EAAU2kH,iBAAiBvsG,GAAQshF;IAC5C,GAGC15F,EAAU0rE,sBAAsB,SAAS3lE,GAAAA;AACxC,aAAGA,EAAAA,CAAAA,KAAAA,CAAMuD,KAAKs7G,uBAAAA,MACDt7G,KAAKu7G,oBAAoB9+G,CAAAA,EACvB5C,SAAS;AAAA,IAG1B,GAECnD,EAAU6kH,sBAAsB,SAASzkH,GACxC;AAAA,UACI0S,IAAQ1S,EADEkJ,KAAK+mD,sBACW,CAAA,KAAA;AAC9B,aAAO/mD,KAAKw7G,sBAAsBhyG;IACpC,GACC9S,EAAU8kH,wBAAwB,SAAStsG,GAC1C;AAAA,aAAGA,aAAiB3M,QACZ2M,IAEAA,EAAMY,SAAWzV,EAAAA,MAAM3D,EAAUM,OAAOsD,iBAAAA;AAAAA,IAElD,GAEC5D,EAAU2nE,qBAEV3nE,GAAAA,EAAU+kH,gBAAgB,SAAS58G,GAAAA;AAClC,UAAI6oC,IAAQ,CAAA,GACRg0E,IAAK17G,KAAKs7G,uBAAAA;AAEd,UAAGI;AACF,iBAAS9hH,IAAE,GAAGA,IAAEiF,EAAIhF,QAAQD;AAC3BlD,YAAUilH,iBAAiB98G,EAAIjF,CAAI8hH,GAAAA,GAAIh0E,CAGxCA;AAAAA;AAAAA,QAAAA,IAAQ7oC;AAET,aAAO6oC;AAAAA,IACT,GAEChxC,EAAUilH,mBAAmB,SAAS7kH,GAAOsG,GAAMsqC,GAClD;AAAA,YAAMl+B,IAAQxJ,KAAKu7G,oBAAoBzkH,CACjC8kH,GAAAA,IAAU57G,KAAK+mD,sBAErB;AAAA,UAAGv9C,EAAM3P,SAAS;AACjB,iBAAS0wB,IAAE,GAAGA,IAAE/gB,EAAM3P,QAAQ0wB,KAAK;AAClC,cAAUntB,EAAKuI,MAAM6D,EAAM+gB,CAAAA,CAAAA,MAA3B;AACC;AAED,gBAAM9tB,IAAK/F,EAAU49D,YAAYx9D;AACjC2F,UAAAA,EAAGm/G,CAAAA,IAAWpyG,EAAM+gB,CACpBmd,GAAAA,EAAMruC,KAAKoD,CAAAA;AAAAA,QACX;AAAA;AAEDirC,QAAAA,EAAMruC,KAAKvC,CAEd;AAAA,IAAA,GAGCJ,EAAU4kH,yBAAyB,WAAA;AAClC,eAAIt7G,KAAKhJ,OAAOmrE,gBAGRzrE,EAAUwoD,kBAAAA;AAAAA,IAEpB;AAEC,QAAI28D,IAAUnlH,EAAU85D;AACxB95D,MAAU85D,qBAAqB,SAASC,GAAAA;AACvCzwD,WAAKq+D,qBAAAA;AACL,UAAIx/D,IAAMg9G,EAAQj5G,MAAM5C,MAAK+I;AAE7B,UAAI/I,KAAKs7G,0BAAyB;AACjCz8G,QAAAA,IAAMmB,KAAKy7G,cAAc58G,CAEzB;AAAA,iBAAQjF,IAAE,GAAGA,IAAGiF,EAAIhF,QAAQD;AACvBoG,eAAKkwD,kBAAkBrxD,EAAIjF,CAAAA,CAAAA,MAC9BiF,EAAIqJ,OAAOtO,GAAG,CACdA,GAAAA;AAIFoG,aAAK69D,uBAAuBh/D,CAAAA;AAAAA,MAC5B;AAED,aAAOA;AAAAA,IACT,GAECnI,EAAUolH,mBAAmB;AAC7B,QAAIC,IAAgBrlH,EAAUgW;AAC9BhW,MAAUgW,mBAAmB,SAAS7N,GAAK+xD,GAO1C;AAAA,aANI5wD,KAAKs7G,uBAAAA,KAA4Bz8G,MAEpCA,IAAMmB,KAAKy7G,cAAc58G,CACzBmB,GAAAA,KAAKs+D,sBAAsBz/D,CAGrBk9G,IAAAA,EAAcn5G,MAAM5C,MAAK,CAACnB,GAAK+xD;IACxC,GAECl6D,EAAU2kH,mBAAmB,SAASvsG,GAAQktG;AAC7C,UAAI5+G,IAAO0R,EAAO1R,MACjBtG,IAAQgY,EAAOhY,OACf+kD,IAAM/sC,EAAO+sC;AAMd,UAAInlD,EAAU0rE,oBAAoBtrE,CAOjC;AAAA,YAJIJ,EAAU4kD,YAAY4iB,kBACzBxnE,EAAU4kD,YAAY4iB,gBAAgBriB,EAAIngD,UAGxChF,EAAU4kD,YAAY4iB,iBAAiBriB,EAAIngD,SAAQ;AACrD,cAAI2pB,IAASjoB,EAAKuI,MAAMk2C,EAAIngD,WAAW0B,EAAKuI,MAAMjP,EAAU4kD,YAAY4iB,aAAAA;AACxE,cAAG74C,GAAM;AACR,gBAAIttB,IAAWiI,KAAKu7G,oBAAoBzkH,IACpCmlH,IAAe,CAAA,GACfC;AACJ,gBAAGxlH,EAAUM,OAAOkkH;AACnB,uBAAQthH,IAAE,GAAGA,IAAE7B,EAAS8B,QAAQD,KAAI;AAEnC,qBADIuiH,IAAczlH,EAAU0lH,gBAAgBh/G,GAAMrF,EAAS6B,CAAAA,GAAIyrB,QAC5C,MAEd;AACJ42F,kBAAAA,IAAelkH,GACfmkH,IAAU;AACV;AAAA,gBACA;AALAD,gBAAAA,EAAariH,CAAAA,IAAKuiH;AAAAA,cAMnB;AAAA;AAED,mBAAQviH,IAAE,GAAGA,IAAE7B,EAAS8B,QAAQD,KAAI;AAEnC,oBAAG7B,EAAS6B,CAAAA,KAAMiiD,EAAIngD,SAAQ;AAC7BugH,kBAAAA,IAAelkH,GACfmkH,IAAAA;AACA;AAAA,gBACA;AAGD,oBAAGnkH,EAAS6B,CAAMlD,KAAAA,EAAU4kD,YAAY4iB,eAAc;AACrD,sBAAIi+C;AACJ,uBADIA,IAAczlH,EAAU0lH,gBAAgBh/G,GAAMrF,EAAS6B,IAAIyrB,CAG1D,OAFc,MAEd;AACJ42F,oBAAAA,IAAelkH,GACfmkH,IAAAA;AACA;AAAA,kBACA;AALAD,kBAAAA,EAAariH,CAAAA,IAAKuiH;AAAAA,gBAM3B;AACQF,kBAAAA,EAAariH,CAAK7B,IAAAA,EAAS6B;cAE5B;AAGCsiH,YAAAA,MACFxlH,EAAU4kD,YAAY4iB,gBAAgBriB,EAAIngD,UAE3C5E,EAAMJ,EAAUqwD,2BAA2Bk1D,EAAa93G,KAAKzN,EAAUM,OAAOsD,iBAAAA;AAAAA,UAC9E;AAAA,QAED;AAAA;AAtDD0hH,QAAAA,EAAYp5G,MAAMlM,GAAW,CAACoY,CAAAA,CAAAA;AAAAA,IAwDjC,GAECpY,EAAU0lH,kBAAkB,SAASn/G,GAAQo/G,GAAch3F;AAG1D,eAFIi3F,IAAa,MACb9yG,IAAQvM,EAAO8xF,UAAU9xF,EAAOX,SAC5B1C,IAAE,GAAGA,IAAI4P,EAAM3P,QAAQD;AAC9B,YAAG4P,EAAM5P,CAAGmQ,EAAAA,OAAOsyG,GAAa;AAC/BC,UAAAA,IAAa1iH;AACb;AAAA,QACA;AAGF,UAAI2iH,IAAW/yG,EAAM8yG,IAAaj3F,CAAAA;AAClC,aAAIk3F,IAIGA,EAASxyG,MAHR;AAAA,IAIV;AAKC,QAAIyyG,IAAwB9lH,EAAU6G;AACtC7G,MAAU6G,qBAAqB,SAASb,GAAWS,GAAUR,GAAWC,GAAWC,GAAAA;AAClF,UAAGM,KAAY6C,KAAKhJ,OAAOmrE,cAAa;AACvChlE,QAAAA,IAAW6C,KAAKw7G,sBAAsBr+G,CAAAA;AAEtC,iBADId,IAAQ,IACJzC,IAAG,GAAGA,IAAIuD,EAAStD,QAAQD;AAClCyC,UAAAA,IAAQA,EAAM8D,OAAOq8G,EAAsB55G,MAAM5C,MAAM,CAACtD,GAAWS,EAASvD,IAAI+C,GAAWC,GAAWC,CAEvG,CAAA,CAAA;AAAA,eAAOR;AAAAA,MACV;AACG,aAAOmgH,EAAsB55G,MAAM5C,MAAM+I,SAE5C;AAAA,IAAA;AAIC,QAAI0zG,IAA8B/lH,EAAUu2F;AAE5Cv2F,MAAUu2F,4BAA4B,SAASp0E,GAAGC,GACjD;AAAA,UAAG9Y,KAAKhJ,OAAOmrE,gBAAgBniE,KAAKk/C,kBAAoB,GAAA;AACvDrmC,QAAAA,IAAI7Y,KAAKy7G,cAAc,CAAC5iG,KACxBC,IAAI9Y,KAAKy7G,cAAc,CAAC3iG,CAAAA,CAAAA;AAGxB,iBADI4zE,IAAAA,IACIgwB,IAAQ,GAAGC,IAAQ9jG,EAAEhf,QAAQ6iH,IAAQC,MACzCjwB,GADgDgwB;AAInD,mBAAQE,IAAQ,GAAGC,IAAQ/jG,EAAEjf,QAAQ+iH,IAAQC,GAAOD;AACnD,gBAAGH,EAA4B75G,MAAM5C,MAAM,CAAC6Y,EAAE6jG,CAAQ5jG,GAAAA,EAAE8jG,CAAS,CAAA,CAAA,GAAA;AAChElwB,cAAAA;AACA;AAAA,YACA;AAGH,eAAOA;AAAAA,MACV;AACG,aAAO+vB,EAA4B75G,MAAM5C,MAAM+I,SAAAA;AAAAA,IAElD;AAAA,EACA,CAEA;AAAA,GpCzLC+zG,aqChEc,SAASpmH,GAAAA;AA2BxBA,IAAUu4B,YAAyB,cAAE,EACpC3iB,QAAO,SAASwjB,GAAAA;AACf,QAAI33B,IAAM,+CAA6C23B,EAAI7gB;AACtD6gB,IAAAA,EAAIklE,aACR78F,KAAO;AAIR,aADIm2E,IAAU,iBAAen2E,IAAI,sCAAoC23B,EAAIrqB,SAAO,8BACvE7L,IAAE,GAAGA,IAAEk2B,EAAIxzB,QAAQzC,QAAQD;AACnC00E,WAAW,0CAAwCx+C,EAAIxzB,QAAQ1C,GAAGmQ,MAAI,QAAM+lB,EAAIxzB,QAAQ1C,CAAAA,EAAG8wB,QAAM;AAGlG,WADA4jD,KAAW;AAAA,EAEX,GACDl/C,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAGhC;AAAA,aADI+lH,IAAY//F,EAAKwS,qBAAqB,UAClC51B,IAAE,GAAEA,IAAEmjH,EAAUljH,QAAOD;AAC9BmjH,MAAAA,EAAUnjH,CAAAA,EAAGm4B,UAAU;AAGxB,aAASirF,EAAa95G;AAErB,eADI65G,IAAY//F,EAAKwS,qBAAqB,UAClC51B,IAAE,GAAEA,IAAEmjH,EAAUljH,QAAQD;AAC/BmjH,QAAAA,EAAUnjH,CAAGm4B,EAAAA,UAAAA,CAAAA,CAAa7uB,EAAI65G,EAAUnjH,CAAAA,EAAGsV;IAE5C;AAED,QAAI+tG,IAAO,CAAA;AACX,QAAIxgH,EAAGzF,EAAOkD,MAAAA,GAAS;AACtB,UAAI2sE,KAAWpqE,EAAGzF,EAAOkD,MAAAA,IAAU,IAAIG,MAAMrD,EAAOu9E,aAAa79E,EAAUM,OAAOsD,qBAAqB;AACvG,WAASV,IAAI,GAAGA,IAAIitE,EAAQhtE,QAAQD;AACnCqjH,QAAAA,EAAKp2C,EAAQjtE;AAEdojH,MAAAA,EAAaC;IAChB,OAAS;AACN,UAAIvmH,EAAUyb,cAAAA,CAAenb,EAAOkmH;AACnC;AACD,UAAIC,IAAa74G,SAASC,cAAc;AACxC44G,MAAAA,EAAW33G,YAAY,eACvB23G,EAAWxlH,MAAMgzC,UAAU,4CAC3B3tB,EAAKvY,YAAY04G;AAEjB,UAAItwG,IAAM,CACT7V,EAAOkmH,YACNlmH,EAAOkmH,WAAWr2G,QAAQ,GAAA,KADpBq2G,KACiC,MAAM,KAC9C,mBAAmBlmH,EAAOkD,SAAS,MAAMuC,EAAG9C,KAAK,UAAUjD,EAAUqM,IAAAA,CAAAA,EACpEoB,KAAK,EAAA;AAEPzN,QAAUsyB,KAAKC,IAAIpc,GAAK,SAASid;AAChC,YAAIxtB,IAjER,SAA0BwtB,GACzB;AAAA,cAAA;AAGC,qBAFIhT,IAAQjI,KAAKhB,MAAMic,EAAOJ,OAAOC,eACjCzmB,IAAM,CAAA,GACDtJ,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD,KAAK;AACtC,kBAAI0xB,IAASxU,EAAMld,CAAAA;AAEnBsJ,cAAAA,EAAIooB,EAAOpc,SAASoc,EAAOvhB,OAAOuhB,EAAO3xB,EAAAA,IAAAA;AAAAA,YACzC;AACD,mBAAOuJ;AAAAA,UACP;AACA,mBAAO;AAAA,UACP;AAAA,QACF,EAoDmC4mB,CAAAA;AAC3BxtB,QAAAA,MACHA,IA5EL,SAAyBwtB,GAAQ9yB,GAGhC;AAAA,mBAFI8f,IAAQpgB,EAAUsyB,KAAKmB,MAAM,eAAeL,EAAOJ,SACnDxmB,IAAM,CAAA,GACDtJ,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD;AACjCsJ,YAAAA,EAAI4T,EAAMld,CAAAA,EAAGiB,aAAa7D,EAAOkD,MAAAA,CAAAA,IAAAA;AAElC,iBAAOgJ;AAAAA,QACR,EAqE+B4mB,GAAQ9yB,CAEnCgmH,IAAAA,EAAa1gH,CACb0gB,GAAAA,EAAK9a,YAAYi7G,CACrB;AAAA,MAAA,CAAA;AAAA,IACG;AAAA,EACD,GACDjuF,WAAU,SAASlS,GAAKvgB,GAAGzF,GAG1B;AAAA,aAFIs3E,IAAU,IACVyuC,IAAY//F,EAAKwS,qBAAqB,OAClC51B,GAAAA,IAAE,GAAEA,IAAEmjH,EAAUljH,QAAOD;AAC3BmjH,MAAAA,EAAUnjH,CAAAA,EAAGm4B,WACfu8C,EAAQj1E,KAAK0jH,EAAUnjH,CAAGsV,EAAAA,KAAAA;AAE5B,WAAOo/D,EAAQnqE,KAAKnN,EAAOu9E,aAAa79E,EAAUM,OAAOsD,qBAAqB,GAC9E;AAAA,EAAA,GAEDy1B,OAAM,SAAS/S,GAAAA;AAAAA,EACd;AAGF,GrCnCCogG,asCjEc,SAAS1mH,GAAAA;AASvB,MAAIouB,IAAMpuB,EAAU4xB;AACpB5xB,IAAU4xB,QAAM,SAASzb,GAAI0b;AAE5B,QAAkB,QADlB1b,IAAIA,KAAK7M,KAAKwoB,cACI;AAEjB,eADIvf,IAVN,SAAgB7P,GACf;AAAA,YAAI6P,IAAI;;AAER,eADAA,EAAEsL,YAAYnb,GACP6P;AAAAA,MACP,EAMgBjJ,KAAKqoB,OACXzuB,GAAAA,IAAE,GAAGA,IAAIiT,EAAIhT,QAAQD;AAC7BoG,aAAKqoB,UAAQ,IAAIpf,KACjB6b,EAAI7Z,KAAKjL,MAAK6M,EAAIjT,IAAG2uB,CAGtBzD;AAAAA;AAAAA,MAAAA,EAAIliB,MAAM5C,MAAK+I,SAClB;AAAA,EAAA;AAEA,GtC4CCs0G,KuClEc,SAAS3mH;AAEvB,MAiBI4mH,GAjBAviH,IAAM,EACTwiH,QAAAA,GAID;AAAA,WAASC,EAAS/gH,GAAAA;AACjB,QAAIrD,IAAM,CAAA;AACV,aAAS2Q,KAAOtN;AACU,MAArBsN,EAAIlD,QAAQ,GACfzN,MADwB,MACxBA,EAAI2Q,KAAOtN,EAAGsN,CAAAA;AAKhB,WAHKhP,EAAIwiH,UAAAA,OACDnkH,EAAIO,IAELP;AAAAA,EACP;AAmBD,WAASqkH,EAAiBlU;AACzBA,IAAAA,EAAIt8E,cAAAA,IACAs8E,EAAIr8E,gBACPq8E,EAAI78F,iBACL68F,GAAAA,EAAIv8E,WAAW,IAEfu8E,EAAI1pG,UAAU,SAAS,CACvB,CAAA;AAAA,EAAA;AAGD,WAAS69G,EAAQC,GAAAA;AAChB,WAAO5iH,EAAIwiH,SAASI,EAAMhkH,KAAKgkH,EAAMC;AAAAA,EACrC;AAEFlnH,IAAUmnH,WAAW,SAASrrG,GAAQxb,GAAAA;AACjCA,IAAAA,MAAQ+D,IAAM/D,IAElBwb,EAAO3C,KAAK,UAAU,SAAS8tG,GAAOtmB,GACrC;AAAA,UAAIumB,IAAMF,EAAQC,CAAAA,GACdlhH,IAAK/F,EAAU0W,QAAQwwG,CAAOD,IAAAA,EAAMG,OACxCrhH;AAAAA,MAAAA,EAAG9C,KAAKikH,GAERlnH,EAAUu0B,YAAYxuB,CArCtB0Y,GAAAA,aAAamoG,IACbA,IAAe3uG,WAAW,WACzB;AAAA,YAAGjY,EAAUkiB;AACZ;AAEDliB,UAAU8V;MACV,GAAC,CAAA;AAAA,IAiCJ,IACCgG,EAAO3C,KAAK,UAAU,SAAS8tG,GAAOI,GAAAA;AACrC,UAAIH,IAAMF,EAAQC;AACdjnH,QAAU0W,QAAQwwG,MACrBlnH,EAAUub,YAAY2rG,CACzB;AAAA,IAAA,CAAA;AAEC,QAAII,IAAQ;AACZ,aAASC,IAAAA;AACR,UAAGvnH,EAAUkiB;AACZ;AAEGolG,MAAAA,EAAMnkH,WACTnD,EAAUmX,MAAMmwG,GAAO,MACvBA,GAAAA,IAAQ;IAET;AAEDxrG,IAAAA,EAAO3C,KAAK,OAAO,SAAS8tG,GAAOI,GAAAA;AAClC,UAAIH,IAAMF,EAAQC,CAClB;AAAA,UAAA,CAAKjnH,EAAU0W,QAAQwwG,CAAAA,GAAK;AAC3B,YAAInhH,IAAMkhH,EAAMG,OAAAA;AAChBrhH,QAAAA,EAAG9C,KAAKikH,GACRlnH,EAAUu0B,YAAYxuB,IAEtBuhH,EAAM3kH,KAAKoD,IACPuhH,EAAMnkH,UAAU,KACnB8U,WAAWsvG,GAAe,CAAA;AAAA,MAC3B;AAAA,IACH,CAECzrG,GAAAA,EAAO3C,KAAK,WAAW,SAASzW;AA7DhC,UAAyBmwG;AA8DpBnwG,MAAAA,aAAe8kH,SAASC,gBA9DJ5U,IA+DP7yG,GA9Dbs2B,WAAW,IACfu8E,EAAIt8E,cAAc,IAElBs8E,EAAI1pG,UAAU,SAAS,CA4DzB,CAAA;AAAA,IAAA,CAAA,GACC2S,EAAO3C,KAAK,QAAQ,SAASzW,GAAAA;AACxBA,MAAAA,aAAe8kH,SAASC,cAC3BV,EAAiB/mH,CACpB;AAAA,IAAA,CAAA,GACC8b,EAAO3C,KAAK,SAAS,SAASzW;AACzBA,MAAAA,aAAe8kH,SAASC,cAC3BV,EAAiB/mH,CAAAA;AAAAA,IACpB,IAGCA,EAAUsE,YAAY,kBAAkB,SAASrB,GAChD;AAAA,UAAI8C,IAAK,IAAI+V,EAAOmrG,MAAMjnH,EAAUyE,SAASxB;AAI7C,aAHAjD,EAAU0W,QAAQzT,CAAM8C,IAAAA,EAAGqhH,UAC3BpnH,EAAU0W,QAAQzT,GAAIA,KAAKA,GAAAA;AAAAA,IAG7B,CAECjD,GAAAA,EAAUsE,YAAY,gBAAgB,SAASrB,GAAAA;AAC9C,WAAK6Y,EAAOyW,IAAItvB,IAAI;AACnB,YAAI2M,IAAOk3G,EAAS9mH,EAAUyE,SAASxB,CAAAA,CAAAA,GACnCgkH,IAAQ,IAAInrG,EAAOmrG,MAAMr3G,CAAAA,GAEzBs3G,IAAMF,EAAQC,CAAAA;AACdC,QAAAA,KAAOjkH,KACVqG,KAAK0R,cAAc/X,GAAIikH,CACxBprG,GAAAA,EAAO7Z,IAAIglH,CACXnrG,GAAAA,EAAOmzD,QAAQ,iBAAiBg4C,CAAAA;AAAAA,MAChC;AACD,aAAO;AAAA,IACT,CACCjnH,GAAAA,EAAUsE,YAAY,kBAAkB,SAASrB,GAChD;AAAA,UAAI8C,IAAK+V,EAAOyW,IAAItvB,IAChB6nC,IAAMg8E,EAAS9mH,EAAUyE,SAASxB,CAKtC,CAAA;AAAA,aAHA8C,EAAGynB,IAAIsd,CAAAA,GACPhvB,EAAOmzD,QAAQ,oBAAoBlpE;IAGrC,CAAA,GACC/F,EAAUsE,YAAY,kBAAkB,SAASrB;AAChD,UAAIgkH,IAAQnrG,EAAOyW,IAAItvB,CAAAA;AAKvB,aAJIgkH,MACHnrG,EAAOmzD,QAAQ,oBAAoBg4C,CACnCnrG,GAAAA,EAAOuO,OAAOpnB,CAER,IAAA;AAAA,IACT;EACA;AAEA,GvC9EC8iE,WwCnEc,SAAS/lE,GAAAA;AAIvBA,IAAUsE,YAAY,oBAAoB,WAAA;AACzC,QAEIojH,GAFAtP,IAAO,IAAQ5C,0BACfpnF,IAAMgqF,EAAQH;AAOlB,aAAS0P,EAAQC,GAAkBxS,GAAayS,GAAkBC;AAEjE,UAAI9nH,CAAAA,EAAUkJ,WAAW,wBAA8BlJ,KAAAA,EAAUmJ,UAAU,0BAA0B,CAACy+G,GAAkBxS,GAAayS,GAAkBC,GAAYJ,KAAnK;AAGA,YAAIj6F,IAAOztB,EAAUsE,YAAY,kBAAkB,SAAUrB,GAAAA;AACvDjD,YAAUmJ,UAAU,oBAAoB,CAAClG,GAAI2kH,GAAkBF,CAAAA,CAAAA,MACnEp+G,KAAKP,aAAaO,KAAKR,WAAW,MAClCQ,KAAKiS,YAAYtY,CAAAA;AAAAA,QAEtB,CAEO8kH,GAAAA,IAAc/nH,EAAU+E,cAAc2iH,CAAAA,GACtCM,IAAa,EAChBzmH,YAAY,IAAIiB,KAAKulH,EAAY/lH,IAIlC,EAAA;AAAA,YAAIhC,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,QAAQ;AAC1D,cAAIu9G,IAAejoH,EAAUuG,OAAOvG,EAAU0K,KAAAA;AAC9Cs9G,UAAAA,EAAWC,EAAa1kH,cAAcwkH,EAAY/iH;AAElD,cAAImgD,IAAMnlD,EAAUkoH,sBAAsBR,CAC1CM;AAAAA,UAAAA,EAAWzmH,aAAa0mH,EAAalmH,SAASojD,EAAI75B,IAClD08F,EAAWxmH,WAAWxB,EAAUgC,KAAKC,IAAI+lH,EAAWzmH,YAAY0mH,EAAaniE,QAAQmiE,EAAaliE,MAAAA;AAAAA,QAClG;AACG/lD,UAAUsG,UAAUtG,EAAUsG,OAAOtG,EAAU0K,WAClDs9G,EAAWhoH,EAAUsG,OAAOtG,EAAU0K,KAAOlH,EAAAA,MAAAA,IAAUukH,EAAY/iH,UAGpEhF,EAAU6T,YAAYm0G,CAEtBhoH,GAAAA,EAAU6kB,YAAY4I,CA7Bd;AAAA,MAAA;AAAA,IA8BR;AAtCD2qF,IAAAA,EAAQH,WAAW,SAASzzG;AAE3B,aADAkjH,IAAaljH,GACN4pB,EAAIliB,MAAM5C,MAAM+I,SAC1B;AAAA,IAAA,GAqCE+lG,EAAQL,eAAe/3G,EAAU6J,KAAmB,aAAE,CAAI,GAAA,EACzD4vG,OAAO,SAASmO,GAAkBxS,GAAayS,GAAkBC,GAAAA;AAChEH,MAAAA,EAAQC,GAAkBxS,GAAayS,GAAkBC;IACzD,GACDzO,SAAS,SAAS9wF,GAAY4/F,GAAAA;AAC7B,aAAO5/F;AAAAA,IACP,GACDqwF,UAAU,SAASrwF,GAClB;AAAA,aAAOjf;AAAAA,IACP,EAGCgqB,CAAAA,GAAAA,OAAO80F,eACT90F,OAAO80F,YAAYC,QAAQroH,EAAU6J,KAAmB,aAAE,CAAA,GAAI,EAC7Dy+G,QAAQ,SAAUhrG,GAAQ5Y,GAAQiN,GAAGnN,GACpC;AAAA,UAAI+jH,IAAej1F,OAAO80F,YAAYI,UAAUlrG,CAAAA;AAChDoqG,MAAAA,IAAaljH,GACbmjH,EAAQrqG,GAAQirG,GAAc7jH,GAAQF,EAAEE,UAAUF,EAAEoiB,UACpD;AAAA,IAAA,GAED6hG,UAAU,SAAUnrG,GAAQ5Y,GAAQF;AACnC,aAAOE;AAAAA,IACP,OAGL;AAAA,EAAA,CAAA;AAEA,GxCPCgkH,KyCpEc,SAAS1oH,GAEvB;AAAA,MAAImmC,GAAIrQ,GACP6yF,IAAc,IAAI5zF,OAAO,WAAW,GACpC6zF,GAAAA,IAAiB,IAAI7zF,OAAO,aAAa,GAE1C;AAAA,WAAS8zF,EAAWv5E,GAAAA;AACnB,WAAOA,EAAIz3B,QAAQ+wG,GAAgB;AAAA,CAAM/wG,EAAAA,QAAQ8wG,GAAa,EAC9D;AAAA,EAAA;AAED,WAASG,EAAOx9F,GAAG/Z,GAAAA;AAClB+Z,IAAAA,IAAIq2E,WAAWr2E,CAAAA,GACf/Z,IAASowF,WAAWpwF,CAAAA,GACf+V,MAAM/V,CAAS+Z,MAAAA,KAAK/Z;AAEzB,QAAIiQ,IAAIunG,EAAUz9F;AAElB,WADAA,IAAIA,IAAI9J,EAAExS,QAAQwS,EAAEzB,OAAKomB,GAClB7e,MAAMgE,CAAAA,IAAG,SAAQ,MAAIA,IAAC/Y;AAAA,EAC7B;AAED,WAASy2G,EAAa19F,GAAG/Z,GAAQ03G,GAChC39F;AAAAA,IAAAA,IAAIq2E,WAAWr2E,CAAAA,GACf/Z,IAASowF,WAAWpwF,KACf+V,MAAM/V,CAAAA,KAAW03G,MAAS39F,KAAK/Z;AAEpC,QAAIiQ,IAAIunG,EAAUz9F,CAElB;AAAA,WADAA,IAAIA,IAAI9J,EAAExS,QAAQwS,EAAEzB,OAAKomB,GAClB7e,MAAMgE,KAAG,SAAQ,MAAIA,KAAG6a,KAAK7e,MAAM/V,KAAe,IAAPA;AAAAA,EAClD;AACD,WAASw3G,EAAU/5G;AAIlB,aAHI+I,IAAI,GACJsgB,IAASr4B,EAAU6J,KAAK65F,eAAe,CAAA,EAAG1zF,YAC1C5E,IAAMitB,EAAO,KAAKA,EAAO,CAAA,EAAGroB,aAAaqoB,EAAO,CAAGroB,EAAAA,YAC9C9M,IAAI,GAAGA,IAAIkI,EAAIjI,QAAQD,KAAK;AACpC,UAAIgiB,IAAK9Z,EAAIlI,CAAAA,EAAGjC,QAAQmK,EAAIlI,KAAKkI,EAAIlI,CAAAA,EAAGqI,YACpCiW,IAAImgF,WAAWz8E,EAAGjkB,MAAM+N,KAAAA;AAC5B,UAAIA,EAAAA,IAAQwS;AAKX;AAJAxS,MAAAA,KAAUwS,IAAE,GACZzJ,KAAIyJ,IAAE;AAAA,IAIP;AACD,WAAO,EAAExS,OAAO+I,GAAGgI,MAAM7c,EAAAA;AAAAA,EACzB;AAED,WAASgmH,EAAO79F;AAEf,WADAA,IAAIs2E,WAAWt2E,CACX/D,GAAAA,MAAM+D,CAAW,IAAA,SACd,MAAMA,IAAIyK;AAAAA,EACjB;AAED,WAASqzF,EAAU7iG,GAAMrlB,GAAAA;AACxB,YAAQpB,OAAO6iB,mBAAkB7iB,OAAO6iB,iBAAiB4D,GAAM,IAAA,EAAMrlB,KAASqlB,EAAKY,eAAaZ,EAAKY,aAAajmB,CAAAA,IAAO,SAAQ;AAAA,EACjI;AAED,WAASmoH,EAAO9iG,GAAMrhB,GAAAA;AAGrB,aAFIqmB,IAAI1C,SAAStC,EAAKrlB,MAAME,MAAM,EAEzBglC,GAAAA,IAAK,GAAGA,IAAKnmC,EAAU2O,MAAMxL,QAAQgjC;AAE7C,WADA7a,KAAKtrB,EAAU2O,MAAMw3B,MACb;AAAG,eAAOA;AAEnB,WAAOlhC;AAAAA,EACP;AAED,WAASokH,EAAQ/iG,GAAMrhB;AAEtB,aADIomB,IAAIzC,SAAStC,EAAKrlB,MAAMC,KAAK,EACxB40B,GAAAA,IAAK,GAAGA,IAAK91B,EAAUulD,OAAOE,QAAQtiD,QAAQ2yB;AACtD,UAAI91B,EAAUulD,OAAOE,QAAQ3vB,CAAMzK,IAAAA;AAAG,eAAOyK;AAC9C,WAAO7wB;AAAAA,EACP;AAKD,WAASqkH,EAAQv3E,GAChB;AAAA,WAAOA,IAAM,OAAKA,IAAI,MAAM;AAAA,EAC5B;AAED,WAASw3E,EAAQx3E,GAAKy3E,GAASnxF,GAAQ6oE,GACtC;AAAA,QAAItuE,IAAM,MAAImf,IAAI,eAAey3E,IAAU;AAM3C,WALInxF,MACHzF,KAAO,cAAcyF,IAAS,MAC3B6oE,MACHtuE,KAAO,cAAcsuE,IAAS,MAC/BtuE,KAAO;AAAA,EAEP;AAED,WAAS62F,IACR;AAAA,QAAI72F,IAAM,IAENruB,IAAOvE,EAAU0K;AAKrB,QAJI1K,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAAAA,MAClDnG,IAAQvE,EAAUuG,OAAOvG,EAAU0K,KAAOkL,EAAAA,UAAU,SAAU,WAAW,aAC1Egd,KAAO,kBAAkBruB,IAAO,cAAcvE,EAAU6J,KAAK6/G,aAAa,CAAG57G,EAAAA,YAAY,MAErF9N,EAAU0K,SAAS;AAEtB,eADIi/G,IAAK3pH,EAAU6J,KAAKk7B,aAAa,CAAA,EAAGjM,qBAAqB,KAAA,GACpD51B,IAAI,GAAGA,IAAIymH,EAAGxmH,QAAQD;AACP,QAAnBymH,EAAGzmH,GAAG4L,aAAa,uBACtB8jB,KAAO,aAAai2F,EAAWc,EAAGzmH,CAAAA,EAAG4K,aAAa;AAAA,aAC1C9N,EAAU0K,SAAS,YAAY1K,EAAU0K,SAAS;AAG5DkoB,MAAAA,KAAO,aAAai2F,GAFhBc,IAAK3pH,EAAU6J,KAAK65F,eAAe,CAAG1zF,EAAAA,WAAW,GAAGA,YAEtB,CAAA,EAAGlC,SAAa,IAAA,sBAAsB+6G,EAAWc,EAAG,GAAG77G,SAAa,IAAA;AAAA,aAC5F9N,EAAU0K,SAAS;AAE7B,WADIi/G,IAAK3pH,EAAU6J,KAAKk7B,aAAa,GAAG/0B,YAC/B9M,IAAI,GAAGA,IAAIymH,EAAGxmH,QAAQD;AAC9B0vB,QAAAA,KAAO,mBAAmBi2F,EAAWc,EAAGzmH,CAAAA,EAAGwd,cAAc,iBAAmB5S,EAAAA,SAAAA,IAAa,MACzF8kB,KAAOg3F,EAAgBD,EAAGzmH,CAAGwd,EAAAA,cAAc,gBAAkB1Q,EAAAA,UAAAA,GAC7D4iB,KAAOi3F,EAAUF,EAAGzmH,CAAGwd,EAAAA,cAAc,oBACrCkS,KAAO;AAAA,SAEF;AACNA,MAAAA,KAAO,OAEPA,KAAOg3F,EADHD,IAAK3pH,EAAU6J,KAAK65F,eAAe,CAAA,EAAG1zF,aAE1C4iB,KAAO;AAEP,UAAIk3F,IAAK9pH,EAAU6J,KAAKk7B,aAAa,CACrC;AAAA,UAAI/kC,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAAAA,GAAQ;AAE1D,aADAkoB,KAAO,OACE1vB,IAAI,GAAGA,IAAI4mH,EAAG75G,WAAW6P,KAAK3c,QAAQD;AAE9C0vB,UAAAA,KAAO,mBAAmBi2F,EADjBiB,EAAG75G,WAAW6P,KAAK5c,CAAAA,EACYL,MAAM,CAAGiL,EAAAA,SAAAA,IAAa;AAE/D8kB,QAAAA,KAAO,QACPkD,IAAKg0F,EAAG75G,WAAW6P,KAAK,CAAGjd,EAAAA,MAAM,GAAGwgB;AAAAA,MACpC,WAAUymG,EAAG75G,WAAWyb,WAAW;AACnCkH,QAAAA,KAAOi3F,EAAUC,CAAAA;AAAAA,WACX;AAEN,aADAA,IAAKA,EAAG95G,WAAW85G,EAAG95G,WAAW7M,SAAS,IACnC2mH,EAAGh7G,UAAUqB,QAAQ,kBAAA;AAC3B25G,UAAAA,IAAKA,EAAG1uF;AAIT,aAHA0uF,IAAKA,EAAG95G,YAER4iB,KAAO,OACE1vB,IAAI,GAAGA,IAAI4mH,EAAG3mH,QAAQD;AAC9B0vB,UAAAA,KAAO;AAAA,kBAAqBi2F,EAAWiB,EAAG5mH,GAAG4K,SAAa,IAAA;AAC3D8kB,QAAAA,KAAO,QACPkD,IAAKg0F,EAAG,GAAGzmG;AAAAA,MACX;AAAA,IACD;AAED,WADAuP,KAAO;AAAA,EAEP;AAED,WAASi3F,EAAUC,GAAAA;AAGlB,aAFIl3F,IAAM,IACN7a,IAAI+xG,EAAG/mH,iBAAiB,IAAA,GACnBG,IAAI,GAAGA,IAAI6U,EAAE5U,QAAQD,KAAK;AAIlC,eAHIwC,IAAO,IACP7C,IAAQkV,EAAE7U,GAAGH,iBAAiB,IAAA,GAEzB8wB,IAAI,GAAGA,IAAIhxB,EAAMM,QAAQ0wB;AACjCnuB,QAAAA,EAAK/C,KAAKE,EAAMgxB,CAAAA,EAAGnT,cAAc,iBAAmB5S,EAAAA,SAAAA;AAErD8kB,MAAAA,KAAO;AAAA,iBAAoB/vB,EAAM,CAAA,EAAGwgB,eAAe,gBAAgBwlG,EAAWnjH,EAAK+H,KAAK,GAAA,CAAA,IAAQ,aAChGqoB,IAAKjzB,EAAM,CAAGwgB,EAAAA;AAAAA,IACd;AACD,WAAOuP;AAAAA,EACP;AAED,WAASg3F,EAAgBD,GACxB;AAAA,QAAII,GACHn3F,IAAM;AACH5yB,MAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAC9C1K,MAAAA,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOs/G,iBACrCD,IAAMJ,EAAG,CAAG35G,EAAAA,aAEb25G,IAAKA,EAAG,GAAG35G;AAGZ,aAAS9M,IAAI,GAAGA,IAAIymH,EAAGxmH,QAAQD;AAC9B0vB,MAAAA,KAAO;AAAA,qBAAwBi2F,EAAWc,EAAGzmH,CAAG4K,EAAAA,SAAAA,IAAa;AAG9D,QAFAq4B,IAAKwjF,EAAG,CAAGpmG,EAAAA,aAEPwmG,GACH;AAAA,UAAI/6G,IAAQ,GACRi7G,IAAYN,EAAG,CAAA,EAAGpmG,aAClB2mG,IAAU;AACd,WAAShnH,IAAI,GAAGA,IAAI6mH,EAAI5mH,QAAQD;AAC/B0vB,QAAAA,KAAO;AAAA,0BAA6Bs3F,IAAU,gBAAgBrB,EAAWkB,EAAI7mH,GAAG4K,SAAa,IAAA,iBAC7FkB,KAAS+6G,EAAI7mH,CAAGqgB,EAAAA,gBACH0mG,MACZA,KAAcN,EAAGO,KAAWP,EAAGO,CAAAA,EAAS3mG,cAAc,GACtD2mG,MAED/jF,IAAK4jF,EAAI,CAAGxmG,EAAAA;AAAAA,IAVA;AAad,WAAOqP;AAAAA,EACP;AAED,WAASu3F,EAASC;AACjB,QAAIx3F,IAAM,IACNzqB,IAAMnI,EAAU0lC,WAChBn/B,IAASvG,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K;AAE5D,QAAI1K,EAAU0K,SAAS,YAAY1K,EAAU0K,SAAS;AAErD,eAASxH,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AACnB0vB,QAAAA,KAAO,2BAA2Bi2F,EAAW1gH,EAAIjF,CAAG8M,EAAAA,WAAW,GAAGlC,SAAa,IAAA,8BAA8B+6G,EAAW1gH,EAAIjF,CAAAA,EAAG8M,WAAW,CAAA,EAAGlC,SAAa,IAAA;AAAA,aAE7J9N,EAAU0K,SAAS;AAE7B,WAASxH,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC/B0vB,QAAAA,KAAO,iBAAiBzqB,EAAIjF,CAAGqI,EAAAA,WAAWpH,aAAa,KAAS,IAAA,aAAa0kH,EAAW1gH,EAAIjF,CAAAA,EAAG4K,SAAa,IAAA;AAAA,aAEnG9N,EAAU0K,SAAS;AAG7B,WADIvC,IAAMnI,EAAU85D,mBAAAA,GACX52D,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,YAAIyO,IAAIxJ,EAAIjF,GAAG3B;AAIf,aAHIoQ,EAAElP,QAAYzC,IAAAA,EAAUkK,UAAUzH,QAAAA,MACrCkP,IAAI3R,EAAUkK,YAERyH,IAAIxJ,EAAIjF,GAAG1B,YAAU;AAC3B,cAAIshE,IAAInxD,EAAEwL,SAAa,IAAA,MAAMxL,EAAEuL,YAAAA,IAAgBld,EAAUkK,UAAUgT,YAAAA,KAAiBld,EAAUqqH,YAAYC,QACtGr8G,IAAMjO,EAAUqqH,YAAYvnD,CAAKnxD,IAAAA,EAAE9J,QAAY,IAAA,GAC/C0iH,IAAaH,IAASjB,EAAUnpH,EAAU0rG,eAAe/5F,CAAAA,GAAI,WAAW,IACxEowD,IAAWqoD,IAASjB,EAAUnpH,EAAU0rG,eAAe/5F,IAAI,iBAAqB,IAAA;AAIpF,cAFAihB,KAAO,iBAAkB3kB,IAAM,IAAK,aAAamB,KAAK+D,MAAMlF,IAAM,CAAA,IAAK,cAAc60D,IAAI,wBAAwBf,IAAW,cAAcwoD,IAAa,eACvJ54G,IAAI3R,EAAUgC,KAAKC,IAAI0P,GAAG,GAAG,QACvBlP,QAAazC,KAAAA,EAAUiK,UAAUxH,QACtC;AAAA;AAAA,QACD;AAAA,MACD;AAAA,aACS8D,KAAUA,EAAOqP,UAAU;AAErC,WADIzN,IAAMnI,EAAU6J,KAAKk7B,aAAa,CAAA,EAAGjM,qBAAqB,IACrD51B,GAAAA,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC3BqnH,QAAAA,IAAaH,IAASjB,EAAUhhH,EAAIjF,IAAI,OAAW,IAAA,IAEvD0vB,KAAO;AAAA,mCADHmvC,IAAWqoD,IAASjB,EAAUhhH,EAAIjF,CAAAA,GAAI,qBAAqB,MACR,cAAcqnH,IAAa,gBAAgB1B,EAAW1gH,EAAIjF,CAAAA,EAAG4K,SAAa,IAAA;AAAA;AAGlI,WAAS5K,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,YAAIsnH,GAAIC;AACR,YAAIzqH,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K;AAElD8/G,UAAAA,IAAK1B,EAAO3gH,EAAIjF,CAAAA,EAAGjC,MAAME,IAAAA,GACzBspH,IAAM3B,EAAO3gH,EAAIjF,GAAGqgB,WAAa,IAAA;AAAA,aAC3B;AAEN,cAAImnG,IAAY1qH,EAAUM,OAAOmnC,wBAAwB,IAAI;AAC7D+iF,UAAAA,IAAKxB,EAAa7gH,EAAIjF,CAAGjC,EAAAA,MAAME,MAAMupH,GAAW,EAAA,GAChDD,IAAMzB,EAAa7gH,EAAIjF,CAAAA,EAAGjC,MAAM+N,OAAO07G,CAAAA,IAAW;AAAA,QAClD;AACD,YAAA,CAAIpjG,MAAY,IAANmjG,CAAAA,GAAV;AACA,cAAIE,IAAKzB,EAAO/gH,EAAIjF,CAAGjC,EAAAA,MAAMC,MACzB0pH,IAAM1B,EAAO/gH,EAAIjF,CAAGjC,EAAAA,MAAM8N,MAE1B87G,GAAAA,IAAS1iH,EAAIjF,CAAAA,EAAG4L,UAAUnL,MAAM,GAAA,EAAK,GAAGkU,QAAQ,YAAY;AAChE,cAAIgzG,MAAW,oBAAf;AAEA,gBAAIC,IAAO9qH,EAAUyE,SAAS0D,EAAIjF,GAAGiB,aAAanE,EAAUM,OAAO0C,eACvD,CAAA;AAAA,gBAAK8nH,GAAL;AACR78G,cAAAA,IAAM68G,EAAKjwD;AAAf,kBACIkwD,IAAOD,EAAK9vD,QACZ73D,IAAS2nH,EAAKpsD,WAAW;AAE7B,kBAAI1+D,EAAU0K,SAAS;AACtBkgH,gBAAAA,IAAMhiG,SAASzgB,EAAIjF,GAAGmgB,cAAc,EAAA,GACpCsnG,IAAK/hG,SAASzgB,EAAIjF,CAAGjC,EAAAA,MAAMC,KAAK,EAAA,IAAMlB,EAAU+gB,GAAG2hC,mBAEnDz0C,IAAMm7G,EAAOjhH,EAAIjF,IAAI+K,CACrB88G,GAAAA,IAAO1B,EAAQlhH,EAAIjF,CAAI6nH,GAAAA,CAAAA;AAAAA,uBACb/qH,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,QAAQ;AACjEuD,gBAAAA,IAAM,GAEN88G,IADS5iH,EAAIjF,CAAAA,EAAGqI,WAAWA,WAAWA,WAC5BknG;AACV,oBAAIuY,IAAUl1F;AACdA,gBAAAA,IAAK3tB,EAAIjF,CAAGqI,EAAAA,WAAW8X,cACvBsnG,IAAKzB,EAAO/gH,EAAIjF,CAAAA,EAAGjC,MAAMC,GACzBypH,GAAAA,KAAW,MAALA,GACN70F,IAAKk1F;AAAAA,cACV,OAAW;AACN,oBAAI7iH,EAAIjF,CAAGqI,EAAAA,cAAcvL,EAAU6J,KAAKk7B,aAAa;AAAI;AACzD,oBAAIz5B,IAAStL,EAAU6J,KAAmB,aAAE,GAAGmG,WAAW,CAAA,GACtDuB,IAASowF,WAAWr2F,EAAOwD,UAAUqB,QAAQ,kBAA4B7E,KAAJ,KAAIA,EAAOrK,MAAME,OAAO;AACjGqpH,gBAAAA,KAAM1B,EAAO3gH,EAAIjF,CAAGqI,EAAAA,WAAWtK,MAAME,MAAMoQ,CAAAA;AAAAA,cAC3C;AAID,cAFAqhB,KAAO;AAAA,iBAAoBm4F,IAAO,YAAY98G,IAAM,aAAa48G,IAAS,UAAUL,IAAK,UAAUG,IAAK,cAAcF,IAAM,eAAeG,IAAM,YAAYznH,IAAS,MAElK0nH,KAAU,WACbj4F,KAAO,sBAAsBi2F,EAAW1gH,EAAIjF,CAAG8M,EAAAA,WAAW,GAAGlC,SAAa,IAAA,gBACtEy8G,IAAaH,IAASjB,EAAUhhH,EAAIjF,CAAG8M,EAAAA,WAAW,CAAI,GAAA,OAAA,IAAW,IAErE4iB,KAAO,6BADHmvC,IAAWqoD,IAASjB,EAAUhhH,EAAIjF,CAAAA,EAAG8M,WAAW,CAAI,GAAA,iBAAA,IAAqB,MAC/B,cAAcu6G,IAAa,gBAAgB1B,EAAW1gH,EAAIjF,CAAAA,EAAG8M,WAAW,CAAGlC,EAAAA,SAAAA,IAAa,iBAElIy8G,IAAaH,IAASjB,EAAUhhH,EAAIjF,IAAI,OAAW,IAAA,IAEvD0vB,KAAO,6BADHmvC,IAAWqoD,IAASjB,EAAUhhH,EAAIjF,CAAI,GAAA,iBAAA,IAAqB,MACjB,cAAcqnH,IAAa,gBAAgB1B,EAAW1gH,EAAIjF,CAAG4K,EAAAA,SAAAA,IAAa,eAEzH8kB,KAAO;AAAA,YAvCyB;AAAA,UAHY;AAAA,QALf;AAAA,MAgD7B;AAGF,WAAOA;AAAAA,EACP;AAED,WAASq4F,EAAMh+G,GAAOC,GAAKxG,GAAMnC,GAAM8zB,GAAQ6oE,GAAAA;AAC9C,QAAIkpB,IAAS;AACD,IAAR7lH,KAAQ,gBACX6lH,IAAAA,IACA7lH,IAAO,UAGRA,IAAOA,KAAQ;AAEf,QAjPkBwtC,GAiPdnf,IAAM;AACV,QAAI3lB,GAAO;AAEV,UAAIi+G,IAAgBlrH,EAAUoT,OAC1B+3G,IAAgBnrH,EAAU0K;AAC9BwC,MAAAA,IAAMlN,EAAUgC,KAAK0E,IAAK,QAAUwG,EAAAA,CAAAA,GACpCA,IAAMlN,EAAUgC,KAAK,SAAO0E,IAAK,MAAU1G,IAAAA,EAAUgC,KAAK,SAAO0E,IAAK,QAAQwG,CAAOlN,IAAAA,EAAUgC,KAAKC,IAAIiL,GAAK,GAAGxG,CAAAA,GAEhHksB,IAAM22F,EAAQ,SAAShlH,GAAM8zB,GAAQ6oE;AACrC,eAASkqB,IAAY,IAAI5oH,KAAKyK,CAASm+G,GAAAA,CAAAA,IAAAA,CAAal+G,GAAKk+G,IAAY9hH,KAAKtH,KAAKC,IAAImpH,GAAW,GAAG1kH,CAAAA;AAChG4C,aAAKuM,eAAeu1G,GAAW1kH,CAC/BksB,GAAAA,OA5PgBmf,IA4PC,UA3PN,MAAIA,IAAI,MAAM,MA2PE03E,EAAkB5xG,EAAAA,QAAQ,KAAU,GAAOsyG,IAAAA,EAASC,CAAUd,IAAAA,EAAQ,MAElG12F;AAAAA,MAAAA,KAAO02F,EAAQ,OAEfhgH,GAAAA,KAAKuM,eAAeq1G,GAAeC,CAAAA;AAAAA,IACtC;AACGv4F,MAAAA,IAAM22F,EAAQ,QAAQhlH,GAAM8zB,GAAQ6oE,KAAUuoB,EAAkB5xG,EAAAA,QAAQ,KAAU,GAAOsyG,IAAAA,EAASC,KAAUd,EAAQ,MAAA;AAErH,WAAO12F;AAAAA,EACP;AAcD,WAASy4F,EAAOp+G,GAAOC,GAAKxG,GAAMyP,GAAK5R,GAAM8zB,GAAQ6oE,GAZrD;AAAA,KAAA,SAAkBtuE,GAAKzc,GAAAA;AACtB,UAAI9J,IAAMrM,EAAUqM,IAChBsF,GAAAA,IAAI/D,SAASC,cAAc,KAAA;AAC/B8D,MAAAA,EAAE1Q,MAAMkgB,UAAU,QAClBvT,SAASmJ,KAAKhJ,YAAY4D,IAE1BA,EAAE7D,YAAY,eAAezB,IAAM,6CAA6C8J,IAAM,4HACtFvI,SAAS8/B,eAAerhC,CAAAA,EAAK4D,WAAWuI,QAAQwU,mBAAmB4F,CACnEhlB,GAAAA,SAAS8/B,eAAerhC,CAAK00F,EAAAA,OAAAA,GAC7BpvF,EAAEpG,WAAWC,YAAYmG,CACzB;AAAA,IAAA,GAIkB,OAARpN,KAAQ,WASnB,SAAyB+mH,GAAAA;AAExB,eADI14F,IAAM,UACF1vB,IAAE,GAAGA,IAAIooH,EAAQnoH,QAAQD;AAChC0vB,QAAAA,KAAO04F,EAAQpoH,CAAAA,EAAGoa,OAAOiuG,WAAWD,EAAQpoH,GAAG+J,OAAOq+G,EAAQpoH,CAAGgK,EAAAA,KAAKo+G,EAAQpoH,CAAAA,EAAGwD,MAAM4kH,EAAQpoH,CAAAA,EAAGqB,MAAM+mH,EAAQpoH,CAAAA,EAAGm1B,QAAQizF,EAAQpoH,CAAAA,EAAGg+F,MAGvI;AAAA,aADAtuE,KAAO,WACAA;AAAAA,IACP,EAfuBruB,KAEhB0mH,EAAM/+G,MAAM5C,MAAM,CAAC2D,GAAOC,GAAKxG,GAAMnC,GAAM8zB,GAAQ6oE,KAG5C/qF,CACd;AAAA,EAAA;AAtBDnW,IAAUurH,aAAaN,GA4CvBjrH,EAAUwrH,QAAQ,SAASr1G,GAAK5R,GAAM8zB,GAAQ6oE,GAAAA;AAC7C,WAAOmqB,EAAOn/G,MAAM5C,MAAM,CAAC,MAAM,MAAM,MAAM6M,GAAK5R,GAAM8zB,GAAQ6oE,CAClE,CAAA;AAAA,EAAA,GACClhG,EAAUyrH,aAAa,SAASx+G,GAAOC,GAAKxG,GAAMyP,GAAK5R,GAAM8zB,GAAQ6oE,GAMpE;AAAA,WALWj0F,OAAAA,KAAS,aACnBA,IAAQjN,EAAUya,UAAUs8C,SAAS9pD,CACrCC,GAAAA,IAAMlN,EAAUya,UAAUs8C,SAAS7pD,CAG7Bm+G,IAAAA,EAAOn/G,MAAM5C,MAAM+I;EAC5B;AAEA,GzClUCq5G,Y0CrEc,SAAS1rH,GAAAA;AAExBA,IAAUM,OAAOo3D,eAAe,CAAC,aAAa,aAC9C13D,GAAAA,EAAUM,OAAOopD,oBAAoB,IACrC1pD,EAAUM,OAAOqrH,kBAAAA,IACjB3rH,EAAU+gB,GAAGuhC,aAAa;AAI1B,MAAIspE,IAAyB;AAsN7B,WAASC,EAAkBC;AAC1B,UAAMC,IAAYD,EAAe5iG,sBAI3B8iG,GAAAA,IAHgBhsH,EAAU8C,WAAWomB,sBAAAA,EAGRkC,SAAS2gG,EAAU3gG;AAGlD4gG,IAAAA,IAAe,MAClBF,EAAe7qH,MAAMC,MAAM,GAAGygG,WAAWmqB,EAAe7qH,MAAMC,GAAAA,IAAO8qH;EAEvE;AAiFA,WAASC,EAA2BnoH,GACnC;AAAA,QAAI3C,IAAO,GACPD,IAAM,GAENolB,IAAOxiB;AACX,WAAOwiB,KAAQA,KAAQtmB,EAAU63B;AAChC12B,MAAAA,KAAQmlB,EAAKwC,YACb5nB,KAAOolB,EAAKuC,YAAUvC,EAAKmD,WAC3BnD,IAAOA,EAAKyC;AAEb,WAAGzC,IAIK,EAAEnlB,MAAKA,GAAMD,KAAIA,GAAKilC,IAHnBhlC,IAAO2C,EAAQyf,cAAY,IAAMvjB,EAAU23B,KAAG,IAAK,IAAI,GAG7B7B,IAF1B50B,IAAM4C,EAAQuf,eAAa,IAAMrjB,EAAU43B,KAAG,IAAK,IAAI,GAGhE5oB,OAAMlL,EAAQyf,aAAaxU,QAAOjL,EAAQuf,aAAAA,IAErC;AAAA,EACR;AAnUArjB,IAAUsE,YAAY,oBAAoB,WAAA;AACzC,UAAMkC,IAAYxG,EAAU8C;AACzB0D,IAAAA,EAAU0lH,uBAGZ1lH,EAAU0lH,yBAGVlsH,EAAUI,MAAMoG,GAAW,aAAa,SAAShC,GAChD;AAAA,YAAM2nH,IAAe3nH,EAAEE,OAAOC,QAAQ,IAAI3E,EAAUM,OAAO0C;AACvDmpH,MAAAA,MACHP,IAAyB,EACxB3oH,IAAIkpH,EAAahoH,aAAanE,EAAUM,OAAO0C,eAAAA,GAC/C+H,UAAUkhH,EAA2BE,CAAAA,EAAAA;AAAAA,IAG1C,IACEnsH,EAAUsE,YAAY,aAAa,MAC3BkC;AAAAA,aAAAA,EAAU0lH;AAAAA,IAAkB,CAAA;AAAA,EAGtC,CAEAlsH,GAAAA,EAAUsE,YAAY,WAAW,SAASrB;AACzC,QAAIjD,EAAUM,OAAOqrH;AAIrB,aADA3rH,EAAUosH,cAAcnpH,CACjB,GAAA;AAAA,EACR,IAEA,WAQC;AAAA,aALI6Y,IAAS,CAAC,gBAAgB,gBAAgB,cAAc,uBAAuB,cAAA,GAC/EuwG,IAAkB,WAAA;AAErB,aADArsH,EAAUssH,cAAAA;IAEZ,GACUppH,IAAE,GAAGA,IAAE4Y,EAAO3Y,QAAQD;AAC9BlD,QAAUsE,YAAYwX,EAAO5Y,CAAAA,GAAImpH;EAElC,EAXD,GAaArsH,EAAUya,UAAU8xG,mBAAmB,SAASt/G,GAAOC,GAAKnH,GAAAA;AAAK,WAAOA,EAAGyW,KAAKkZ,OAAO,GAAE,EAAA;AAAA,EAAI,GAC7F11B,EAAUya,UAAU+xG,qBAAqB,SAASv/G,GAAOC,GAAKnH;AAAK,WAAOA,EAAGuqC,WAAW;AAAA,EAAG,GAC3FtwC,EAAUya,UAAUgyG,kBAAkB,SAASx/G,GAAOC,GAAKnH;AAC1D,WAAI/F,EAAU4I,cAAc7C,CAAO/F,KAAAA,EAAUM,OAAOsgC,MAC5C5gC,EAAUya,UAAU+rB,SAASv5B,GAAOC,GAAKnH,KAAM,MAAK/F,EAAUya,UAAUqiB,aAAa5vB,GAAKD,GAAOlH,CAC9F/F,IAAAA,EAAU4I,cAAc7C,CAAAA,IAC3B/F,EAAUya,UAAU+rB,SAASv5B,GAAOC,GAAKnH,KAAM,MAAK/F,EAAUya,UAAUqiB,aAAa7vB,GAAOC,GAAKnH,CAAAA,IAC9F/F,EAAUM,OAAOsgC,MACpB5gC,EAAUya,UAAUo8C,UAAU3pD,GAAKD,GAAOlH,KAE1C/F,EAAUya,UAAUo8C,UAAU5pD,GAAOC,GAAKnH,CAAAA;AAAAA,EAEnD,GAEA/F,EAAUosH,gBAAgB,SAASnpH,GAClC;AAEA,QAFIA,KAAMqG,KAAKojH,uBACfpjH,KAAKgjH,cAAAA,KACFhjH,KAAKH,UAAU,qBAAqB,CAAClG;AACvC;AAGD,QAAIkiD;AAEHA,IAAAA,IADEymE,KAA0BA,EAAuB3oH,MAAMA,IACnD2oH,EAAuB7gH,WAEvBzB,KAAKqjH,wBAAwB1pH,IAIhCkiD,MACH77C,KAAKsjH,kBAAkBtjH,KAAKujH,iBAAiB1nE,CAAAA,GAC7C77C,KAAKwjH,iBAAiB7pH,CAAAA,GACtBqG,KAAKyjH,iBAAiB5nE,CAAAA,GAEtB77C,KAAKH,UAAU,eAAe,CAAClG,CAAAA,CAAAA;AAAAA,EAEjC,GAEA,WAAA;AAEA,aAAS+pH,EAAY7zF,GAAAA;AACpBA,MAAAA,IAAOA,KAAQ;AAEf,UAEC8zF,GAFGx9F,IAAMkyE,WAAWxoE,CAAAA,GACpBpmB,IAAOomB,EAAK7L,MAAM,KAOnB;AAAA,cAJIva,MACHA,IAAOA,EAAK,KAGLA,GACP;AAAA,QAAA,KAAK;AACJk6G,UAAAA,IAAqB,MAANx9F;AACf;AAAA,QACD,KAAK;AACJw9F,UAAAA,IAAex9F;AACf;AAAA,QACD;AACCw9F,UAAAA,IAAe;AAAA,MAAA;AAIjB,aAAOA;AAAAA,IACR;AAEAjtH,MAAUssH,gBAAgB,SAASY,GAAAA;AAClC,UAAIC,IAAK7jH,KAAKsjH,iBACV7nG,IAAUzb,KAAKojH;AAGnB,UAFApjH,KAAKojH,qBAAqB,GAEtBS,KAAMA,EAAG5hH,YAAW;AACvB,YAAIyD,IAAQm+G,EAAG5pG;AACf,YAAIvjB,EAAUM,OAAOk3D;AAEpB,iBADAluD,KAAKH,UAAU,oBAAoB,CAAC4b,CAAAA,CAAAA,GAC7BooG,EAAG5hH,WAAWC,YAAY2hH,CAQlC;AAAA,YALIA,EAAGlsH,MAAM8lB,SAAS,SACrBomG,EAAGlsH,MAAME,OAAQ6N,CAAAA,IAAQ,OAEzBm+G,EAAGlsH,MAAM8lB,QAAS/X,CAAAA,IAAQ,MAEvBk+G;AACHC,UAAAA,EAAG5hH,WAAWC,YAAY2hH;aACtB;AAEJ,cAAIlsH;AACDpB,iBAAO6iB,mBACTzhB,IAAQpB,OAAO6iB,iBAAiByqG,GAAI,IAC5BA,IAAAA,EAAGjmG,iBACXjmB,IAAQksH,EAAGjmG;AAEZ,cAAI9I,IAAQ4uG,EAAY/rH,EAAM,kBAAuB+rH,CAAAA,IAAAA,EAAY/rH,EAAM,qBACvEgX,CAAAA;AAAAA,qBAAW;AACPk1G,YAAAA,EAAG5hH,cACL4hH,EAAG5hH,WAAWC,YAAY2hH,CAE3B;AAAA,UAAA,GAAE/uG,CACH;AAAA,QAAA;AAED9U,aAAKH,UAAU,oBAAoB,CAAC4b,CACpC,CAAA;AAAA,MAAA;AAAA,IACF;AAAA,EAEC,EAnED,GAqEA/kB,EAAUI,MAAMP,QAAQ,WAAW,SAAS2E,GAC1B;AAAA,IAAbA,EAAE26B,WAAW,MAChBn/B,EAAUssH;EACZ,CAEAtsH,GAAAA,EAAU+sH,mBAAmB,SAAS5nE,GACrC;AAAA,QAAIgoE,IAAKntH,EAAU4sH;AACnB5sH,MAAU63B,KAAK9pB,YAAYo/G;AAC3B,QAAIn+G,IAAQm+G,EAAG5pG,aACXxU,IAASo+G,EAAG9pG;AAEhB,QAAIrjB,EAAUM,OAAOk3D,qBAAoB;AACxC,UAAIr2D,IAAOgkD,EAAIhkD,OAAOgkD,EAAIhf,MAAIn3B,IAAQm2C,EAAIn2C;AACvChP,QAAUY,aAAaZ,EAAUY,QAAAA,EAAU45F,cAE1Cx6F,EAAUM,OAAOsgC,MACnBz/B,KAAQnB,EAAUY,QAAAA,EAAU45F,YAE5Br5F,KAAQnB,EAAUY,UAAU45F,YAKlBr5F,IAAO6N,IACRnP,OAAO4hB,eACjBtgB,IAAOtB,OAAO4hB,aAAazS,IAE5B7N,IAAOiO,KAAKC,IAAI,GAAGlO,CAAAA,GAEnBgsH,EAAGlsH,MAAME,OAAOA,IAAO,MACvBgsH,EAAGlsH,MAAMC,MAAMikD,EAAIjkD,OAAOikD,EAAIrvB,KAAG/mB,IAAAA,CAAQo2C,EAAIp2C,UAAU;AAAA,IACzD,OAAQ;AAEN,YAAMq+G,IAAUptH,EAAU8C,WAAW4d,cAAc,iBAAiBmI;AACpEskG,QAAGlsH,MAAMC,MAAMksH,IAAU,KAAK,MAC1BjoE,EAAIhf,MAAM,KACbgnF,EAAGlsH,MAAM8lB,QAAQ,QACjBomG,EAAGlsH,MAAME,OAAQ6N,CAAAA,IAAQ,MAEzBiJ,WAAW,WACVk1G;AAAAA,UAAGlsH,MAAME,OAAO;AAAA,MAChB,GAAC,CAEFgsH,MAAAA,EAAGlsH,MAAME,OAAO,QAChBgsH,EAAGlsH,MAAM8lB,QAAS/X,CAAAA,IAAQ,MAE1BiJ,WAAW,WAAA;AACVk1G,UAAGlsH,MAAM8lB,QAAQ;AAAA,MACjB,GAAC,CAAA,IAEHomG,EAAGr+G,YAAYq+G,EAAGr+G,UAAU+I,QAAQ,gBAAe,EAAA,EAAIA,QAAQ,iBAAgB,EAAA,IAAI,cAAYstC,EAAIhf,MAAI,IAAE,SAAO;AAAA,IAChH;AAEDgnF,MAAGE,kBAAkB,MAAA;AACpBxB,MAAAA,EAAkBsB,CAClBA,GAAAA,EAAGE,kBAAkB;AAAA,IAAI,GAE1Bp1G,WAAW,MACV4zG;AAAAA,MAAAA,EAAkBsB;IAAG,GACnB,CAAA;AAAA,EACJ,GAeAntH,EAAUsE,YAAY,oBAAoB,WAEzC;AAAA,QADAtE,EAAUssH,cAAAA,GACPhjH,KAAKsjH,iBAAgB;AACvB,UAAI3jG,IAAM3f,KAAKsjH;AACZ3jG,MAAAA,EAAI1d,cACN0d,EAAI1d,WAAWC,YAAYyd,CAAAA,GAE5B3f,KAAKsjH,kBAAkB;AAAA,IACvB;AAAA,EACF,CAAA,GACA5sH,EAAUstH,+BAA+B,SAAS9oH;AACjDxE,MAAUssH,cAAAA;AAAAA,EACX,GACAtsH,EAAU6sH,mBAAmB,WAAA;AAC5B,SAAKvjH,KAAKsjH,iBAAgB;AAGzB,UAAIO,IAAK7jH,KAAKsjH,kBAAkBh/G,SAASC,cAAc,KAAA;AAEvDvE,WAAKuxB,SAAS64B,cAAcy5D,CAE5BA,GAAAA,EAAGr+G,YAAY,sBACX9O,EAAUutH,cACbJ,EAAGr+G,aAAa,oBACb9O,EAAUM,OAAOsgC,QAAKusF,EAAGr+G,aAAa;AAE1C,UACIpN,IAAO;AAAA;AAAA;AAAA;AAAA,kCADI4H,KAAKuxB,SAAS84B,0BAAAA,CAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAa7BjyD,MAAAA,KAAQ;AAEP,eADGo/B,IAAU9gC,EAAUM,OAAOo3D,cACrBx0D,IAAI,GAAGA,IAAI49B,EAAQ39B,QAAQD;AAEnCxB,QAAAA,KAAQ,QADO4H,KAAKuxB,SAASg5B,0BAA0BvqD,KAAKokB,OAAOwN,OAAO4F,EAAQ59B,CAC/B49B,CAAAA,CAAAA,CAAAA,2BAAAA,EAAQ59B,CAAclD,CAAAA,YAAAA,EAAU0tB,OAAOwN,OAAO4F,EAAQ59B,CAC7E49B,CAAAA,CAAAA;AAAAA,gCAAAA,EAAQ59B,kBAAkBlD,EAAU0tB,OAAOwN,OAAO4F,EAAQ59B,CAAAA,CAAAA,CAAAA;AAGxFxB,MAAAA,KAAQ,UAERyrH,EAAGr/G,YAAYpM,GACf1B,EAAUI,MAAM+sH,GAAI,SAAS,SAASpnH,GACrC/F;AAAAA,UAAUwtH,iBAAiBznH,EAAGrB,UAAUqB,EAAG6gB;MAC9C,CACM5mB,GAAAA,EAAUM,OAAOk3D,wBACpBx3D,EAAUuhD,gBAAgBvhD,EAAU6J,KAAmB,aAAE,CAAA,GAAI,UAAU7J,EAAUstH,+BACjFttH,EAAUI,MAAMJ,EAAU6J,KAAmB,aAAE,IAAI,UAAU7J,EAAUstH,4BAExE;AAAA,IAAA;AAED,WAAOhkH,KAAKsjH;AAAAA,EACb,GAEA5sH,EAAUwtH,mBAAmB,SAASlnG,GAAAA;AACrC,QAAI2C,IAAMjpB,EAAU4sH;AACpB,QAAKtmG,KAAQA,KAAQ2C;AAErB,UAAG3C,EAAK3hB,QAAQ,uBACf3E;AAAAA,UAAUssH;WADX;AAKA,YAAIj/F,IAAOrtB,EAAUkQ,cAAcoW,CAAAA;AACnC,YAAI+G,EAAKld,QAAQ,OAAa,SAAA;AAC7B,cAAIlN,IAAKjD,EAAU0sH;AACnB1sH,YAAU8kC,OAAOhE,QAAQzT,EAAK1pB,MAAM,GAAA,EAAK,GAAGkU,QAAQ,SAAQ,KAAK5U,CACjE;AAAA,QAAA;AACAjD,YAAUwtH,iBAAiBlnG,EAAK/a;MAPhC;AAAA,EAQF,GAsBAvL,EAAU2sH,0BAA0B,SAAS1pH;AAE5C,WAAOgpH,EADKjsH,EAAUkiE,iBAAiBj/D,CAExC,CAAA;AAAA,EAAA,GAEAjD,EAAU8sH,mBAAoB,SAAS7pH;AACtC,QAAI8C,IAAK/F,EAAUyE,SAASxB,CAAAA,GACxBkqH,IAAKntH,EAAU4sH;AAEnB5sH,MAAU0sH,qBAAqBzpH;AAI/B,QAAIo1B,IAAS,EACZiV,SAASttC,EAAUya,UAAU8xG,iBAAiBxmH,EAAGxE,YAAYwE,EAAGvE,UAAUuE,IAC1E/D,MAAMhC,EAAUya,UAAUgyG,gBAAgB1mH,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAEpDonH,EAAAA;AAAAA,IAAAA,EAAGzsG,cAAc,sBAAA,EACvB5S,YAAY,SAASuqB,EAAOiV,kBACzB6/E,EAAGzsG,cAAc,qBACvB5S,YAAYuqB,EAAOr2B,MAE7BhC,EAAU66B,SAAS+4B,gBAAgBu5D,GAAI,CAAC90F,EAAOiV,SAASjV,EAAOr2B,IAAAA,EAAMyL,KAAK,GAG1E,CAAA;AAAA,QAAIggH,IAAON,EAAGzsG,cAAc,qBAAA;AAC5B,UAAMgtG,IAAc1tH,EAAUya,UAAU+xG,mBAAmBzmH,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CACpF2nH;AAAAA,SACFD,EAAK5uG,UAAUwL,OAAO,YACtBojG,GAAAA,EAAK3/G,YAAY4/G,KAEjBD,EAAK5uG,UAAU5c,IAAI,YAAA;AAAA,EAErB;AAGA,G1C7SC84B,U2CtEc,SAAS/6B;AAExBA,IAAUsE,YAAY,oBAAoB,WACzC;AAAA,QAAIqpH;AACA3tH,MAAUu4B,YAAYoI,cACzBgtF,IAA4B3tH,EAAUu4B,YAAYoI,UAAUjI;AAE7D,QAAIk1F,IAAwB5tH,EAAUM,OAAO2gC,aAAal1B,MACtD8hH,GAAAA,IAAyB7tH,EAAUM,OAAOygC,cAAch1B,MAAAA;AA2C5D,aAAS+hH,EAAY/7E,GAAKpgC,GAAG1M,GAAGuX,GAAAA;AAG/B,eAFIuxG,IAAOp8G,EAAEmnB,qBAAqBiZ,CAC9Bi8E,GAAAA,IAAO/oH,EAAE6zB,qBAAqBiZ,CAAAA,GACzB7uC,IAAI8qH,EAAK7qH,SAAS,GAAGD,KAAK,GAAGA;AAErC,YADI+B,IAAI+oH,EAAK9qH,IACRsZ,GAKC;AACL,cAAIjK,IAAI3E,SAASC,cAAc,MAAA;AAC/B0E,UAAAA,EAAEzD,YAAY,qBACdyD,EAAEzE,YAAY0O,EAAKuxG,EAAK7qH,KACxB+B,EAAEsG,WAAW6e,aAAa7X,GAAGtN,CAAAA,GAC7BA,EAAEsG,WAAWC,YAAYvG,CAAAA;AAAAA,QACzB;AAVAA,UAAAA,EAAEq2B,WAAAA,IAEC3pB,EAAE0pB,YACJp2B,EAAEo2B,UAAU;AAAA,IASf;AA3DDr7B,MAAUsE,YAAY,oBAAoB,SAASrB,GAAAA;AAelD,UAdIqG,KAAKhJ,OAAO2tH,iBAAiB3kH,KAAK7E,SAASxB,GAAI83B,WAClDzxB,KAAKhJ,OAAOo+B,kBAAkB,MAG9Bp1B,KAAKhJ,OAAOo+B,kBAAAA,IACZ1+B,EAAUM,OAAO2gC,eAAe2sF,EAAsB7hH,MACtD/L,GAAAA,EAAUM,OAAOygC,gBAAgB8sF,EAAuB9hH,SAGrD/L,EAAUu4B,YAAYoI,cACxB3gC,EAAUu4B,YAAYoI,UAAUjI,YAAYi1F,KAI1CrkH,KAAKhJ,OAAOo+B;AAGf,iBAFIwvF,IAAoB,CAAC,kBAAkB,cACvCC,GAAAA,IAAgB,CAACnuH,EAAUM,OAAO2gC,cAAcjhC,EAAUM,OAAOygC,aAAAA,GAC5D79B,IAAI,GAAGA,IAAIgrH,EAAkB/qH,QAAQD;AAE7C,mBADIkrH,IAAmBF,EAAkBhrH,IAChCyJ,IAAI,GAAGA,IAAIwhH,EAAchrH,QAAQwJ,KAAK;AAG9C,qBAFI0hH,IAAeF,EAAcxhH,CAAAA,GAC7B/K,QACK8G,IAAI,GAAGA,IAAI2lH,EAAalrH,QAAQuF;AACxC,kBAAI2lH,EAAa3lH,CAAAA,KAAM0lH,GAAkB;AACxCxsH,gBAAAA,IAAQ8G;AACR;AAAA,cACA;YAEE9G,WACHysH,EAAa78G,OAAO5P,GAAO,CAE5B;AAAA,UAAA;AAMH,aAFA0H,KAAK40B;IAGP,CAAA;AAsBC,QAAI9P,IAAMpuB,EAAUw8B;AACpBx8B,MAAUw8B,iBAAiB,WAE1B;AAAA,UAAI8D,IAAKh3B,KAAK8uB;AACV9uB,WAAKhJ,OAAOo+B,oBACf4B,EAAGr/B,MAAMgmB,aAAa,UAGtBqZ,EAAGr/B,MAAMkgB,UAAU;AAEpB,UAAI/Z,IAAMgnB,EAAIliB,MAAM5C,MAAM+I,SAO1B;AAAA,UANI/I,KAAKhJ,OAAOo+B,oBAEf4B,EAAGr/B,MAAMgmB,aAAa,IACtBqZ,EAAGr/B,MAAMkgB,UAAU,SAGhB7X,KAAKhJ,OAAOo+B,iBAAiB;AAEhC,YAAI4vF,IAAehlH,KAAK8uB,YACpBm2F,GAAAA,IAAejlH,KAAKklH,cAAcF,EAAalrH,YACnDmrH;AAAAA,QAAAA,EAAatrH,KAAKjD,EAAUqM,IAAAA,GAC5BkiH,EAAaz/G,aAAa,2BAC1Bg/G,EAAY,YAAYQ,GAAcC,GAAc,SAASpsG,GAC5D;AAAA,iBAAOA,EAAE3J;AAAAA,QACb,CAAA,GACGs1G,EAAY,SAASQ,GAAcC,GAAAA,KACnCT,EAAY,UAAUQ,GAAcC,GAAc,SAASpsG;AAC1D,iBAAIA,EAAEvc,QAAQzC,SACPgf,EAAEvc,QAAQwJ,KAAKC,IAAK8S,EAAE6Z,iBAAiB,GAAI,CAAA,CAAA,EAAIxf,OADzB;AAAA,QAEjC,CAAA,GAEG8xG,EAAa/iH,WAAW6e,aAAamkG,GAAcD,IAEnDhlH,KAAK6yB,UAAUoyF,IACXvuH,EAAU4b,aACb5b,EAAU4b,UAAUrQ,WAAWC,YAAYxL,EAAU4b,SAAAA,GACtDtS,KAAKsS,YAAY2yG,GAEbvuH,EAAUM,OAAO4gC,iBACpBlhC,EAAUI,MAAMmuH,EAAat+G,YAAY,aAAajQ,EAAU0gC,aAAAA,GAEjE1gC,EAAUq+B,sBACV/0B,GAAAA,KAAK42B;MACL;AACD,aAAO94B;AAAAA,IACT;AAEC,QAAI8yD,IAAOl6D,EAAUw9B;AACrBx9B,MAAUw9B,gBAAgB,WAMzB;AAAA,aALIl0B,KAAKklH,gBACRllH,KAAKklH,YAAYjjH,WAAWC,YAAYlC,KAAKklH,WAAAA,GAC7CllH,KAAKklH,cAAcllH,KAAKsS,YAAY,OAG9Bs+C,EAAKhuD,MAAM5C,MAAM+I;IAC1B;AAAA,EACA,CAAA;AAGA,G3C5DCsuB,W4CrEc,SAAU3gC,GAAAA;AAExB,WAASyuH,EAAkBzsH,GAAAA;AAC1B,WAAO,IAAIQ,KACVR,EAAKkb,YACLlb,GAAAA,EAAKmb,SACLnb,GAAAA,EAAK6F,QACL7F,GAAAA,EAAKmI,YACLnI,EAAKyJ,WAAAA,GACLzJ,EAAKouB,WACL,GAAA,CAAA;AAAA,EAED;AAMD,WAASs+F,EAAStuH,GACjB;AAAA,WAAA,CAAA,CAASA,EAAM8a,SAAAA,CAAU9a,EAAMk2F;AAAAA,EAC/B;AA4BD,WAASq4B,EAAU3sH,GAAAA;AAClB,WAAO,IAAIQ,KAAKA,KAAKqrB,IAAI7rB,EAAKkb,YAAAA,GAAelb,EAAKmb,SAAYnb,GAAAA,EAAK6F,WAAW7F,EAAKmI,SAAAA,GAAYnI,EAAKyJ,WAAazJ,GAAAA,EAAKouB;EACtH;AAaD,WAASw+F,EAA2B7oH,GAChCA;AAAAA,IAAAA,EAAGmV,MAAMo6D,SAAS,SAAA,MACpBvvE,EAAGmV,QAAQnV,EAAGmV,MAAMvX,MAAM,SAAW,EAAA,CAAA;AAEtC,QAAIkrH,IAAczjC,GAAS,SAASrlF,EAAGmV,KAAAA,UAAe4zG,EAAa/oH,EAAGsC,aAAatC,EAAGvE,QAAAA,CAAAA,IAAa,EAAEygF,SAASl8E,EAAGxE,WAC7GwtH,CAAAA,GAAAA,IAAW,IAAI1yC,EAAMwyC,EAAYpzC,aAAariE,SAAWvB,EAAAA,QAAQ,UAAU,EAAA;AAC/Ek3G,IAAAA,IAAWA,EAASprH,MAAM;AAAA,CAAM,EAAA,CAAA,GAChCoC,EAAGmV,QAAQ6zG;AAAAA,EACX;AAED,WAASC,EAA0B/rH,GAAI8C,GAAAA;AAClCA,IAAAA,MACHA,IAAK/F,EAAUyE,SAASxB,CAAAA;AAEzB,QAAIgsH,IAAmBlpH,EAAGmV,MAAMvX,MAAM,GAAA,GAClCurH,IAAe,CAAA;AACnB,aAAShsH,IAAI,GAAGA,IAAI+rH,EAAiB9rH,QAAQD,KAAK;AACjD,UAAIisH,IAAUF,EAAiB/rH,CAAAA,EAAGS,MAAM,GAAA,GACpCkY,IAAOszG,EAAQ,CAAA,GACf52G,IAAO42G,EAAQ,CAAA;AAAA,OACftzG,MAAS,WAEP9V,EAAGmV,MAAMo6D,SAAS,QAAa/8D,KAAAA,EAAKpV,SAAS,OAInD+rH,EAAavsH,KAAKkZ,CAClBqzG,GAAAA,EAAavsH,KAAK,GAClBusH,GAAAA,EAAavsH,KAAK4V,CAClB22G,GAAAA,EAAavsH,KAAK,GAClB;AAAA,IAAA;AACDusH,IAAAA,EAAavxG,IACb5X,GAAAA,EAAGmV,QAAQg0G,EAAazhH,KAAK,EAC7B;AAAA,EAAA;AA2CD,MACK2hH;AAsEL,WAASC,EAA2BtpH,GAAIupH;AACvCvpH,IAAAA,EAAGsC,YAAYtC,EAAGvE,UACdxB,EAAUuvH,4BAA4BD,CAAAA,KACzCvpH,EAAGxE,aAAa+tH,EAAW/tH,YAC3BwE,EAAGvE,WAAW,IAAIgB,KAAK8sH,EAAW/tH,WAAWkB,QAAAA,IAA0B,MAAdsD,EAAG2W,QAC5D3W,GAAAA,EAAGypH,cAAcF,EAAW30G,gBAC5B5U,EAAG0pH,YAAY,OAEf1pH,EAAGvE,WAAW,IAAIgB,KAAK8sH,EAAW/tH,WAAWkB,QAAAA,IAA0B,MAAdsD,EAAG2W,QAAAA,GAC5D3W,EAAGxE,aAAa+tH,EAAW/tH,YAC3BwE,EAAG2pH,mBAAAA,KAEJ3pH,EAAGg5B,oBAAoBuwF,EAAWrsH;AAAAA,EAClC;AAED,WAAS0sH,EAAwB/tH,GAAOgO,GAAM7J,GAAI6pH,GAEjD;AAAA,UAAMC,IAAc9pH,EAAG0pH,YAAYG,EAAU3sH,KAAKrB;AAElD5B,MAAU0W,QAAQm5G,CAAe,IAAA,EAAA,GAC7BD,GACHpzG,MAAM5M,EAAK4M,MACXE,UAAU9M,EAAK8M,UACfnb,YAAYqO,EAAKrO,YACjB2Z,OAAOtL,EAAKsL,OACZ1Z,UAAUouH,EAAUvnH,WACpBmnH,aAAaI,EAAUruH,YACvBw9B,mBAAmB,MACnB12B,WAAW,KAAA,GAIRtC,EAAG0pH,aACCzvH,OAAAA,EAAU0W,QAAQ9U,CAG1B5B,GAAAA,EAAUmJ,UAAU,kBAAkB,CAACnJ,EAAU0W,QAAQm5G,CAAa5sH,EAAAA,IAAIjD,EAAU0W,QAAQm5G,CAAAA,CAAAA,CAAAA;AAAAA,EAC5F;AAED,WAASC,EAA2BC,GACnC;AAAA,eAAW7sH,KAAKlD,EAAU0W;AACf1W,QAAU0W,QAAQxT,CAAAA,EACrBD,MAAM8sH,EAAU9sH,MAAAA,OACfjD,EAAU0W,QAAQxT,CAE1B;AAAA,EACD;AAED,WAAS8sH,EAAiB/sH,GAAI2M,GAC7B;AAAA,aAAS1M,KAAKlD,EAAU0W,SAAS;AAChC,UAAIu5G,IAAMjwH,EAAU0W,QAAQxT,CAAAA;AAAAA,OACxB+sH,EAAI35B,sBAAsBrzF,KAAOjD,EAAU+zC,kBAAkBk8E,EAAIhtH,EAAOgtH,KAAAA,EAAIhtH,GAAGU,MAAM,KAAK,CAAMV,KAAAA,OACnGgtH,EAAIzzG,OAAO5M,EAAK4M,MAChBxc,EAAUiW,YAAYg6G,EAAIhtH,EAAAA;AAAAA,IAE3B;AAAA,EACD;AAED,WAASitH,EAAsBC,GAAapqH;AAC3C,QAAI9C,IAAKktH,GACLC,IAAyB,IAAI5tH,KAAKuD,EAAG4U,cAAgBlY,EAAAA,QAAAA;AACzD0tH,IAAAA,IAAczsH,OAAOT,CAAAA,EAAIU,MAAM,GAAQoC,KAAAA,EAAG6wF,aAAaw5B;AACvD,QAAIC,IAAMrwH,EAAUqM,IAAAA,GAChB6lC,IAAOi+E,EAAY,CAAA,IAAMA,EAAY,CAAMpqH,IAAAA,EAAG6wF,aAAaw5B,GAC3DE,IAAMtwH,EAAU49D,YAAY73D,CAChCuqH;AAAAA,IAAAA,EAAIrtH,KAAKotH,GACTC,EAAIh6B,qBAAqBvwF,EAAGuwF,sBAAsB65B,EAAY,CAC9DG,GAAAA,EAAI31G,iBAAiB,IAAInY,KAAKub,OAAOm0B,KACrCo+E,EAAIzkF,UAAAA,IACJ7rC,EAAU6a,SAASy1G;EACnB;AAgCD,WAASC,IACR;AAAA,eAAWrtH,KAAKlD,EAAU0W;AAChB,MAANxT,MAAM,uCACDlD,EAAU0W,QAAQxT;AAG3BlD,MAAU4V,OAAAA;AAAAA,EACV;AAgVD,WAAS46G,EAAa5qH,GAAS8O;AAC9B,UAAMgZ,IAAS1tB,EAAU0tB;AACL9nB,IAAAA,EAAQmkC,KAAKjyB,CAAAA,MAAKA,EAAEujB,OAEvCz1B,MAAAA,EAAQ,CAAGy1B,EAAAA,UAAAA;AAEZ,UAAMo1F,IAAY7qH,EAAQg5C,OAAO,CAACvmC,GAAQP,OACzCO,EAAOP,EAAEU,KAAAA,IAASV,EAAEpD,UACb2D,IACL,CAAE,CAAA;AACLrY,MAAU0uC,SAAS,EAClBlyB,MAAM;AAAA,MACH5W,EAAQ/B,IAAK+wB,CAAAA,MAAW;AAAA,kCACIA,EAAOpc,wBAAwBoc,EAAOyG,UAAU,YAAY,EACvFzG;AAAAA,OAAAA,EAAOZ;eACCvmB,KAAK,EAAA,CAAA;AAAA,YAEjB5H,MAAM,kBACNg5B,OAAOnR,EAAOwN,OAAOgc,mBACrBloC,OAAO,QACPjE,UAAU,UACV+1B,SAAS,CACR,EAAC9M,OAAOtG,EAAOwN,OAAOqS,YAAY/0B,OAAM,MAAM/W,KAAI,YAClD,EAACuyB,OAAOtG,EAAOwN,OAAOsS,gBAAgBh1B,OAAO,SAAA,CAAA,GAE9C9D,UAAU,SAAU8D,GAAOhU,GAI1B;AAAA,UAHGkQ,KACFA,EAAS8D,GAAOhU,IAEdgU,MAAU;AACZ;AAED,YACM6iB,IADM72B,EAAEE,OAAOC,QAAQ,sBAAA,EACT+b,cAAc,6BAClC;AAAA,UAAIgwG;AACDr1F,MAAAA,MACFq1F,IAAiBr1F,EAAQ7iB,QAEvBk4G,KACFD,EAAUC;IAGX,EAEF,CAAA;AAAA,EAAA;AAgKD,WAASC,IACR;AAAA,UAAMC,IAAa,CAAA;AACnB,eAAW1tH,KAAKlD,EAAU0W,SAAS;AAClC,YAAM3Q,IAAK/F,EAAU0W,QAAQxT;AACzB6C,MAAAA,EAAGuwF,sBAAsBvwF,EAAG4U,mBAC1Bi2G,EAAW7qH,EAAGuwF,wBAClBs6B,EAAW7qH,EAAGuwF,sBAAsB,KAErCs6B,EAAW7qH,EAAGuwF,kBAAAA,EAAoBvwF,EAAG4U,eAAelY,QAAasD,CAAAA,IAAAA;AAAAA,IAElE;AACD,WAAO6qH;AAAAA,EACP;AArwBD5wH,IAAU6wH,eAAe,SAAS5tH,GACjC;AAAA,QAAI8C,IAAK/F,EAAUyE,SAASxB;AAC5B,WAAU8C,EAAAA,CAAAA,KAAAA,CAAMA,EAAGg5B;AAAAA,EACrB,GAEC/+B,EAAU8wH,qBAAqB,SAAS/qH,GAEvC;AAAA,QAAG/F,EAAU+zC,kBAAkBhuC,EAAG9C,EAAI,GAAA;AACrC,UAAI8tH,IAAMhrH,EAAG9C,GAAGU,MAAM,GAAA,EAAK,CAE3B;AAAA,aADe3D,EAAUyE,SAASssH,GACfxvH,WAAWkB,QAAAA,MAAcsD,EAAGxE,WAAWkB,QAAAA;AAAAA,IAC1D;AAAA,EACH,GAECzC,EAAUuvH,8BAA8B,SAASxpH,GAEhD;AAAA,QAAG/F,EAAUgxH,wBAAwBjrH,CAAAA,GAAI;AACxC,UAAIgrH,IAAMhrH,EAAGuwF,oBACT26B,IAAWjxH,EAAUyE,SAASssH,CAClC;AAAA,aAAA,EAAA,CAAUhrH,EAAG4U,kBAAkB5U,CAAAA,EAAG4U,eAAelY,QAAasD,KAAAA,EAAG4U,eAAelY,QAAcwuH,MAAAA,EAAS1vH,WAAWkB,QAAAA;AAAAA,IAClH;AAAA,EACH,GAECzC,EAAUkxH,YAAY,CAAA,GACtBlxH,EAAUmxH,oBAAoB,IAC9BnxH,EAAUoxH,eAAe,IACzBpxH,EAAUirC,kBAAkB,SAAUllC,GAAIozB,GAAAA;AACzCpzB,IAAAA,EAAG6wF,YAAYz9D,GACf7vB,KAAK8nH,aAAarrH,EAAG9C,EAAM8C,IAAAA,GACtBuD,KAAK6nH,kBAAkBprH,EAAGkV,SAAY3R,MAAAA,KAAK6nH,kBAAkBprH,EAAGkV,SAAAA,IAAa,CAAA,IAClF3R,KAAK6nH,kBAAkBprH,EAAGkV,SAAWke,EAAAA,CAAAA,IAAQpzB;AAAAA,EAC/C,GACC/F,EAAUqxH,kBAAkB,SAAUl4F,GAAMl2B;AAC3C,QAAIquH,IAAKhoH,KAAK6nH,kBAAkBluH,CAChC;AAAA,WAAIquH,IAAWA,EAAGn4F,CAAAA,IACX;AAAA,EACT,GACCn5B,EAAUqb,mBAAmB,SAAUpY,GAAAA;AACtC,WAAQqG,KAAK6nH,kBAAkBluH,CAAAA,KAAO;EACxC,GAGMmsH,IAAgBpvH,EAAU6a,UAC9B7a,EAAU6a,WAAW,SAAUtZ,GAAYC,GAAUgb,GAAMvZ,GAAIk2D,GAAAA;AAC9D,QAAIo4D,IAAQnC,EAAcljH,MAAM5C,MAAM+I,SAAAA;AAEtC,QAAIk/G,KAASvxH,EAAUyE,SAAS8sH,CAAAA,GAAQ;AACvC,UAAIxrH,IAAK/F,EAAUyE,SAAS8sH;AAExBxrH,MAAAA,EAAGxE,eACNwE,EAAGxE,aAAaktH,EAAkB1oH,EAAGxE,UAAAA,IAElCwE,EAAGvE,aACNuE,EAAGvE,WAAWitH,EAAkB1oH,EAAGvE,QAEpC;AAAA,IAAA;AACD,WAAO+vH;AAAAA,EACV,GAGCvxH,EAAUsE,YAAY,kBAAkB,SAAUlE;AAKjD,WAHIA,EAAMua,mBAAmBva,EAAMua,eAAeuC,gBACjD9c,EAAMua,iBAAiB3a,EAAUya,UAAUC,WAAWta,EAAMua;EAG/D,CAAA,GAEC3a,EAAUsE,YAAY,mBAAmB,SAAUrB,GAAI8+B,GAAAA;AACtD,SAAIz4B,KAAKkoH,cAAT;AACAloH,WAAKkoH,eAAAA,IAEDxxH,EAAUoxH,aAAanuH,OAE1BjD,EAAUoxH,aAAarvF,CAAU/hC,IAAAA,EAAUoxH,aAAanuH,CAAAA,GAAAA,OACjDjD,EAAUoxH,aAAanuH,CAAAA,IAG3BjD,EAAUmxH,kBAAkBluH,CAAAA,MAC/BjD,EAAUmxH,kBAAkBpvF,CAAAA,IAAU/hC,EAAUmxH,kBAAkBluH,CAC3DjD,GAAAA,OAAAA,EAAUmxH,kBAAkBluH,CAGpC;AAAA,eAASC,IAAI,GAAGA,IAAIoG,KAAK4nH,UAAU/tH,QAAQD,KAAK;AAC/C,YAAI+sH,IAAM3mH,KAAK4nH,UAAUhuH;AACrBoG,aAAKyqC,kBAAkBk8E,EAAIhtH,EAAOgtH,KAAAA,EAAIhtH,GAAGU,MAAM,GAAK,EAAA,CAAA,KAAMV,MAC7DgtH,EAAI35B,qBAAqBv0D,GACzBz4B,KAAK0R,cAAci1G,EAAIhtH,IAAI8+B,IAAS,MAAMkuF,EAAIhtH,GAAGU,MAAM,KAAK,CAE7D,CAAA;AAAA,MAAA;AAED,eAAST,KAAKoG,KAAK8nH;AAAc,SAC5BnB,IAAM3mH,KAAK8nH,aAAaluH,CAAAA,GACpBozF,sBAAsBrzF,MAC7BgtH,EAAI35B,qBAAqBv0D,GACzBkuF,EAAIwB;AAIN,UAAIvsG,IAAKllB,EAAUoxH,aAAarvF;AAC5B7c,MAAAA,KAAMA,EAAGusG,wBACLvsG,EAAGusG,cACVx5G,WAAW,WACV;AAAA,YAAIjY,EAAUkiB;AACb,iBAAA;AAEDliB,UAAUmJ,UAAU,kBAAkB,CAAC44B,GAAQ/hC,EAAUyE,SAASs9B,CAAAA,CAAAA,CAAAA;AAAAA,MAClE,GAAE,CAAA,IAAA,OAGGz4B,KAAKkoH;AAAAA,IAzCkB;AAAA,EA0ChC,CAyECxxH,GAAAA,EAAUsE,YAAY,gCAAgC,SAAUrB;AAC/D,QAAI8C,IAAKuD,KAAK7E,SAASxB,CACvB;AAAA,QAAIqG,KAAKyqC,kBAAkB9wC,CAAAA,KAAQqG,KAAK0nH,wBAAwBjrH,CAAAA,KAAAA,CA9QjE,SAA6B3F,GAC5B;AAAA,aAAA,CAAA,CAASA,EAAMyrC;AAAAA,IACf,EA4Q4F9lC;AAC3FmqH,MAAAA,EAAsBjtH,GAAI8C;SACpB;AACF2oH,MAAAA,EAAS3oH,MAAOuD,KAAKoS,gBACxBpS,KAAK6R,iBAAiBpV,CAEvB;AAAA,UAAI2rH,IAAMpoH,KAAK+R,iBAAiBpY;AAChC,eAASC,KAAKwuH;AACTA,QAAAA,EAAInlH,eAAerJ,CAAAA,MACtBD,IAAKyuH,EAAIxuH,GAAGD,IACRqG,KAAK7E,SAASxB,CACjBqG,KAAAA,KAAKiS,YAAYtY,GAAI,EAAA;AAAA,IAGxB;AACD,WAAA;AAAA,EACF,CAAA,GAECjD,EAAUsE,YAAY,kBAAkB,SAAUrB,GAAI8C,GAAAA;AAAAA,KAChDuD,KAAKyqC,kBAAkB9wC,CAAAA,KAAOqG,KAAK0nH,wBAAwBjrH,CAC1D/F,MAAAA,EAAU0W,QAAQzT,CACtB8C,MAAAA,EAAG8lC,cACHviC,KAAKg0B,SAASr6B,GAAI8C,CAAAA,GAClB/F,EAAU4V,OAGd;AAAA,EAAA,CAAA,GAWC5V,EAAUsE,YAAY,wBAAwB,SAASyB,GAAIvB,GAAGglD,GAAQvtB,GACrE;AAAA,WAAA,EAAA,CAAIutB,KAAUzjD,MAAO/F,EAAU+zC,kBAAkBhuC,EAAG9C,EAAOjD,KAAAA,EAAUgxH,wBAAwBjrH,CACxFk2B,OAAAA,EAAS16B,WAAWsG,QAAc9B,MAAAA,EAAGxE,WAAWsG,QAAAA,IACnD9B,EAAGk8D,0BAA0B,SAE7Bl8D,EAAGk8D,0BAA0B,QAGzBjiE,EAAUM,OAAO61F,mBAAmBn2F,EAAUo2F,eAAerwF,CACjE/F,QAAAA,EAAU0W,QAAoC,6BAAI1W,EAAUiM,YAAYlG,CAAAA,GACxE/F,EAAU2xH,sBAAsB5rH,EAAG9C,IAAI8C,EAAGk8D,uBAAAA,GAAAA;AAAAA,EAK9C,CAAA,GAECjiE,EAAUsE,YAAY,kBAAkB,SAAUrB,GAAI7C;AACrD,QAAIkJ,KAAKgtB;AAAU,aAAO;AAE1B,QAAIvwB,IAAKuD,KAAK7E,SAASxB;AACvB,QAAIqG,KAAKyqC,kBAAkB9wC,CAxT5B;AAAA,OAAA,SAAyB8C;AACxB,YAAI9C,IAAK8C,EAAG9C,GAAGU,MAAM,GAAA,GAEjB0sH,IAAMrwH,EAAUqM,IAAAA;AACpBrM,UAAUu2B,cAAc;AACxB,YAAI+5F,IAAMtwH,EAAU49D,YAAY73D,CAAAA;AAChCuqH,QAAAA,EAAIrtH,KAAKotH,GACTC,EAAIh6B,qBAAqBrzF,EAAG,CAE5B;AAAA,YAAI+iD,IAAY/iD,EAAG,CAAA;AAEnBqtH,QAAAA,EAAI31G,iBAAiB,IAAInY,KAAKub,OAAOioC,CAErChmD,CAAAA,GAAAA,EAAUirC,gBAAgBqlF,GAAKtqE,CAAAA,GAC/BhmD,EAAU6a,SAASy1G,CAAAA,GACnBtwH,EAAUu2B,cAAAA;AAAAA,MACV,GAySiBxwB,CAEV;AAAA,SAAA;AACFA,MAAAA,EAAGxE,eACNwE,EAAGxE,aAAaktH,EAAkB1oH,EAAGxE,UAElCwE,IAAAA,EAAGvE,aACNuE,EAAGvE,WAAWitH,EAAkB1oH,EAAGvE,YAGhCktH,EAAS3oH,CAAAA,KAAOuD,KAAKoS,iBACrB3V,EAAGi5B,oBAAoB11B,KAAKunH,aAAa5tH,CAAAA,IAC3C8C,EAAGi5B,mBAAmB,OAEtB11B,KAAK6R,iBAAiBpV,CAAAA;AAIxB,UAAI2rH,IAAMpoH,KAAK+R,iBAAiBpY,CAAAA;AAChC,eAASC,KAAKwuH;AACTA,QAAAA,EAAInlH,eAAerJ,CACfoG,MAAAA,OAAAA,KAAK8nH,aAAaM,EAAIxuH,CAAAA,EAAGD,EAChCqG,GAAAA,KAAKiS,YAAYm2G,EAAIxuH,GAAGD,IAAI,EAAA;AAAA,aAGvBqG,KAAK6nH,kBAAkBluH,CAAAA;AAI9B,eADI2uH,IAAAA,IACKjlH,IAAI,GAAGA,IAAIrD,KAAKo8B,UAAUviC,QAAQwJ;AACtCrD,aAAKo8B,UAAU/4B,GAAGxI,aAAamF,KAAKhJ,OAAO0C,eAAAA,KAAoBC,MAClE2uH,IAAAA;AAEGA,MAAAA,MACJtoH,KAAKq6C,aAAa;AAAA,IACnB;AAED,WADA4sE,EACO,GAAA;AAAA,EACT,IACCvwH,EAAUsE,YAAY,gBAAgB,SAAUrB,GAAAA;AAC/C,SAAKqG,KAAKgtB,UAAU;AACnB,UAAIvwB,IAAKuD,KAAK7E,SAASxB,CACnByrH;AAAAA,MAAAA,EAAS3oH,MACZuD,KAAK6R,iBAAiBpV;IAEvB;AACD,WAAA;AAAA,EACF,CACC/F,GAAAA,EAAUsE,YAAY,eAAe,SAAUrB,GAAI2M,GAAM2sG,GACxD;AAAA,QAAIx2G,IAAKuD,KAAK7E,SAASxB,IACnB2sH,IAAY5vH,EAAUiM,YAAYlG,CAAAA,GAClC8rH,IAAgBjiH,EAAKsL;AACzB,QAAInV,KAAM2oH,EAAS3oH,CAEdw2G,KAAAA,CAAAA,KAAiBjzG,KAAKunH,aAAa5tH,CAAAA,GAAK;AAE3C,UAAI8C,EAAGi5B,kBAAkB;AAExB,YADiBh/B,EAAUyE,SAASsB,EAAGg5B,iBAAAA,MACpBh5B,EAAG2pH,oBAAoB3pH,EAAG0pH;AAG5C,iBAFAzvH,EAAUo+B,aAAAA,GACVp+B,EAAUub,YAAYxV,EAAG9C;AAYzB,YARA8C,EAAGvE,WAAW,IAAIgB,KAAKuD,EAAGxE,WAAWkB,QAAAA,IAAY,MACjDsD,EAAGsC,YAAYtC,EAAG+rH,mBAClB/rH,EAAGxE,aAAawE,EAAGypH,aACnBzpH,EAAGgsH,WAAAA,IACHnD,EAA2B7oH,IAC3B/F,EAAUmJ,UAAU,kBAAkB,CAACpD,EAAG9C,IAAI8C,CAE7B/F,CAAAA,GAAAA,EAAUyE,SAASsB,EAAGg5B,iBAEtC;AAAA,qBAAW77B,KAAKlD,EAAU0W,SAAS;AAClC,gBAAIu5G,IAAMjwH,EAAU0W,QAAQxT,CACxB+sH;AAAAA,YAAAA,EAAI35B,uBAAuBrzF,KAC1BgtH,EAAI1uH,WAAWkB,QAAAA,IAAYmtH,EAAUruH,WAAWkB,QAAAA,KACnDytH,EAAsBD,EAAIhtH,IAAIgtH,CAGhC;AAAA,UAAA;AAIH,eADAjwH,EAAUo+B;MAEf;AAAW;AACN,YAAIkxF,IAAatvH,EAAUyE,SAASsB,EAAGg5B,iBAEvC;AAAA,YAAGuwF,KAAcvpH,EAAG2pH;AACnB,qBAAWxsH,KAAKlD,EAAU0W;AACf1W,cAAU0W,QAAQxT,CACpBD,EAAAA,MAAM8C,EAAG9C,MAChB0sH,EAAwBzsH,GAAG0M,GAAM7J,GAAI6pH,CAEtC;AAAA,iBAESN,KAAcvpH,EAAG0pH;AAC3B,qBAAWvsH,KAAKlD,EAAU0W,SAAS;AAClC,gBAAIu5G,IAAMjwH,EAAU0W,QAAQxT,CACzB+sH;AAAAA,YAAAA,EAAI35B,sBAAsBrzF,KAAMgtH,EAAIhtH,MAAM2sH,EAAU7wF,qBACtD4wF,EAAwBzsH,GAAG0M,GAAM7J,GAAI6pH;UAEtC;AAAA,aACK;AAEF5vH,YAAUgxH,wBAAwB1B,CACrCQ,KAAAA,EAA2BR,IAG5BvpH,EAAGvE,WAAWuE,EAAG+rH,mBACjB/rH,EAAGsC,YAAYtC,EAAG+rH,mBAClB/rH,EAAGxE,aAAawE,EAAGypH,aACnBzpH,EAAGgsH,WAAAA,IACHnD,EAA2B7oH,CAAAA,GAC3B/F,EAAUmJ,UAAU,kBAAkB,CAACpD,EAAG9C,IAAI8C,CAAAA,CAAAA;AAE9C,cAAIisH,IAAc,EAAA,GAAIpC;AACtBoC,UAAAA,EAAYx1G,OAAO5M,EAAK4M,MACxBw1G,EAAYt1G,WAAW9M,EAAK8M,UAC5Bs1G,EAAY92G,QAAQ22G,GACpBG,EAAYxC,cAAc,MAC1BwC,EAAY/uH,KAAKjD,EAAUqM,IAAAA,GAC3BrM,EAAU6a,SAASm3G,EAAYzwH,YAAYywH,EAAYxwH,UAAUwwH,EAAYx1G,MAAMw1G,EAAY/uH,IAAI+uH;QACnG;AAMD,eAJKzV,KACJyT,EAAiB/sH,GAAI2M,CAAAA,GAEtB5P,EAAUo+B,aACH,GAAA;AAAA,MACP;AAAA,IACD;AAOF,WAJKm+E,KACJyT,EAAiB/sH,GAAI2M,CAGlBggH,GAAAA,EAAUqC,QAAQrC,EAAU3tD,2BAC/Bl8D,EAAGxE,aAAaquH,EAAUruH,YAC1BwE,EAAGvE,WAAWouH,EAAUpuH,UACxBuE,EAAGypH,cAAcI,EAAUJ,aAC3BzpH,EAAGsC,YAAYunH,EAAUvnH,WACzBrI,EAAUiW,YAAYlQ,EAAG9C,EAClB,GAAA,OAEPqG,KAAKq6C,aAAa,MAClB4sE,EAAAA,GAAAA;AAAAA,EAEH,CACCvwH,GAAAA,EAAUsE,YAAY,kBAAkB,SAAUrB;AACjD,QAAI8C,IAAKuD,KAAK7E,SAASxB,CAIvB;AAAA,WAHKyrH,EAAS3oH,CAzdf,KAAA,SAAkC3F;AACjCA,MAAAA,EAAM8a,QAAQ,IACd9a,EAAMua,iBAAiB,MACvBva,EAAMk2F,qBAAqB,MAC3Bl2F,EAAMsc,WAAW,MACjBtc,EAAMyrC,UAAU;AAAA,IAChB,EAod0B9lC,CAAAA,GAAAA;AAAAA,EAG5B,CAAA,GACC/F,EAAUsE,YAAY,iBAAiB,SAAUrB,GAAAA;AAChD,QAAI8C,IAAKuD,KAAK7E,SAASxB,CACnByrH;AAAAA,IAAAA,EAAS3oH,CACZuD,MAAAA,KAAK6R,iBAAiBpV,CAAAA,GAEtBuD,KAAK0M,iBAEAu6G,IAAAA,EAAAA;AAAAA,EACR,IACCvwH,EAAUmb,mBAAmB,SAAUpV,GAElCA;AAAAA,IAAAA,EAAGxE,eACNwE,EAAGxE,aAAaktH,EAAkB1oH,EAAGxE,UAElCwE,IAAAA,EAAGvE,aACNuE,EAAGvE,WAAWitH,EAAkB1oH,EAAGvE,QAAAA,IAEhCuE,EAAGsC,cACDtC,EAAGgsH,aACPhsH,EAAG2W,WAAWtN,KAAKM,OAAO3J,EAAGvE,SAASiB,YAAYsD,EAAGxE,WAAWkB,QAAa,KAAA,GAAA,IAE9EsD,EAAGvE,WAAWuE,EAAGsC,YAEdtC,EAAGypH,gBACNzpH,EAAGxE,WAAWytB,SAAS,CACvBjpB,GAAAA,EAAGxE,WAAWutB,QAAQ/oB,EAAGypH,YAAY3nH,YACrC9B,EAAGxE,WAAWytB,SAASjpB,EAAGypH,YAAYryG,aACtCpX,EAAGxE,WAAW07C,YAAYl3C,EAAGypH,YAAYtyG,gBACrC5T,KAAKunH,aAAa9qH,EAAG9C,EACxB8C,MAAAA,EAAGxE,WAAWyH,SAASjD,EAAGypH,YAAYrlH,SAAAA,CAAAA,GACtCpE,EAAGxE,WAAW0H,WAAWlD,EAAGypH,YAAY/jH,eACxC1F,EAAGxE,WAAW8sB,WAAWtoB,EAAGypH,YAAYp/F,WAG1CrqB,CAAAA,KAAAA,EAAGg5B,oBAAoB,MACpBh5B,EAAG+rH,sBACL/rH,EAAG+rH,oBAAoB,OACrB/rH,EAAGi5B,qBACLj5B,EAAGi5B,mBAAmB,OACpBj5B,EAAG2pH,qBACL3pH,EAAG2pH,mBAAmB,OACpB3pH,EAAG0pH,cACL1pH,EAAG0pH,YAAY;AAAA,EAClB,GAECzvH,EAAU+zC,oBAAoB,SAAU9wC,GACvC;AAAA,WAAOA,EAAGmW,SAAAA,EAAWjJ,QAAQ,GAC/B,KADE;AAAA,EACF,GACCnQ,EAAUgxH,0BAA0B,SAAUjrH,GAC7C;AAAA,WAAQA,EAAGuwF,sBAAsBvwF,EAAGuwF,sBAAsB;AAAA,EAC5D,GAECt2F,EAAUkyH,mBAAmBlyH,EAAUu8B,cACvCv8B,EAAUu8B,eAAe,SAAUt5B,GAClC;AAAA,UAAMyqB,IAASpkB,KAAKokB;AACpB,QAAIykG,IAAcnyH,EAAUM,OAAO8xH,oBAC/BrsH,IAAKuD,KAAK7E,SAASxB,CACnB8tH,GAAAA,IAAMhrH,EAAGuwF,oBACT+7B,IAAY/oH,KAAKyqC,kBAAkB9wC,CAAAA;AACnCovH,IAAAA,MACHtB,IAAM9tH,EAAGU,MAAM,GAAK,EAAA,CAAA;AAGrB,UAAM2uH,IAAuB,SAAUrvH,GAAI4C,GAC1C;AAAA,YAAMypH,IAAatvH,EAAUyE,SAASxB,CAChC7C,GAAAA,IAAQJ,EAAUyE,SAASssH,IAC3BrqH,IAAO1G,EAAUY;AASvB,UAPI8F,KAAQ4oH,EAAW5oH,EAAKnD,UAAAA,MAC3BnD,EAAMsG,EAAKnD,UAAc+rH,IAAAA,EAAW5oH,EAAKnD,UAEtCmD,IAAAA,KAAQ4oH,EAAW5oH,EAAKD,QAAAA,MAC3BrG,EAAMsG,EAAKD,QAAAA,IAAY6oH,EAAW5oH,EAAKD,QAG3B,IAATZ,MAAS;AACZ,eAAO7F,EAAUkyH,iBAAiBjvH,CAGnC;AAAA,UAAI4C,MAAS,aAAY;AAOxB,YALG7F,EAAUuvH,4BAA4BD,CAAAA,KAKrCtvH,EAAU8wH,mBAAmBxB,CAAAA;AAEhC,iBADAD,EAA2BjvH,GAAOkvH,CAC3BtvH,GAAAA,EAAUkyH,iBAAiBnB,CAC5B;AAAA;AAEN3wH,UAAAA,EAAMiI,YAAYjI,EAAMoB;AACxB,gBAAM+wH,IAAgBjD,EAAW30G,kBAAkB20G,EAAW/tH;AAa9D,iBAZAnB,EAAM0xH,oBAAoB,IAAItvH,KAAK+vH,EAAc9vH,QAAY,IAAA,GAAA,GAC7DrC,EAAMoB,WAAW,IAAIgB,KAAK8sH,EAAW/tH,WAAWkB,QAA6B,IAAA,MAAjBrC,EAAMsc,QAClEtc,GAAAA,EAAMovH,cAAcpvH,EAAMmB,YAC1BnB,EAAMmB,aAAa+tH,EAAW/tH,YAC9BnB,EAAM2+B,oBAAoBuwF,EAAWrsH,IAGlC8C,EAAGk8D,4BACL7hE,EAAM6hE,0BAA0Bl8D,EAAGk8D,yBACnC7hE,EAAM0xH,oBAAoB,IAAItvH,KAAK+vH,EAAc9vH,YAAY,GAGvDzC,IAAAA,EAAUkyH,iBAAiBnB,CAAAA;AAAAA,QAClC;AAAA,MACD;AAED,UAAIlrH,MAAS,aAAY;AAOxB,YALG7F,EAAUuvH,4BAA4BD,CAExC,KAGGtvH,EAAU8wH,mBAAmBxB,CAAAA;AAEhC,iBADAD,EAA2BjvH,GAAOkvH,CAC3BtvH,GAAAA,EAAUkyH,iBAAiBnB,CAAAA;AAGnC,cAAM/kB,IAAY,IAAIxpG,KAAKpC,EAAMmB,UAAAA;AAQjC,eAPAnB,EAAMiI,YAAYjI,EAAMoB,UACxBpB,EAAMovH,cAAcxjB,GACpB5rG,EAAMmB,WAAWyH,SAASsmH,EAAW/tH,WAAW4I,aAChD/J,EAAMmB,WAAW0H,WAAWqmH,EAAW/tH,WAAWkK,WAAAA,CAAAA,GAClDrL,EAAMmB,WAAW8sB,WAAWihG,EAAW/tH,WAAW6uB,WAAAA,CAAAA,GAClDhwB,EAAMoB,WAAW,IAAIgB,KAAKpC,EAAMmB,WAAWkB,QAAAA,IAA6B,MAAjBrC,EAAMsc,QAAAA,GAC7Dtc,EAAM2+B,oBAAoB,MACnB/+B,EAAUkyH,iBAAiBnB,CAAAA;AAAAA,MAClC;AAAA,IACJ;AACE,SAAKA,KAAa,IAANA,KAAY,MAAMrC,EAAS3oH,CAEtC;AAAA,aAAOusH,EAAqBrvH,GAAI,WAAA;AAGjC,QAAK8tH,CAAAA,KAAOA,MAAQ,OAARA,CAAkBrjG,EAAOwN,OAAOgc,qBAAqBi7E,KAAe,cAAgBA,KAAe,aAAaE;AAE3H,aAAO/oH,KAAK4oH,iBAAiBjvH,CAG9B;AAAA,QAAIkvH,MAAgB,OAAO;AAC1B,YAAMzkG,IAAS1tB,EAAU0tB;AACzB8iG,MAAAA,EAAa,CACZ,EAACh4G,OAAO,cAAcwb,OAAOtG,EAAOwN,OAAOqc,wBAAwBlc,aAClE3mB,UAAU,MAAM49G,EAAqBrvH,GAAI,YAC1C,EAAA,GAAA,EAACuV,OAAO,aAAawb,OAAOtG,EAAOwN,OAAOsc,sCACzC9iC,UAAU,MAAM49G,EAAqBrvH,GAAI,WAAA,EAAA,GAC1C,EAACuV,OAAO,aAAawb,OAAOtG,EAAOwN,OAAOoc,oBACzC5iC,UAAU,MAAM49G,EAAqBrvH,GAAI,WAE3C,EAAA,CAAA,CAAA;AAAA,IAAA;AAAA,EACH,GA+CCjD,EAAU2xH,wBAAwB,SAAS1uH,GAAI4C,GAC9C;AAAA,QAAIi7B;AAEJ,UAAMpT,IAAS1tB,EAAU0tB;AACzB,QAAI4hG,IAAatvH,EAAUyE,SAASxB,CAAAA,GAChC8tH,IAAMzB,EAAWh5B;AAELt2F,MAAU+zC,kBAAkBu7E,EAAWrsH,QAEtD8tH,IAAMzB,EAAWrsH,GAAGU,MAAM,GAAA,EAAK;AAEhC,QAAIvD,IAAQJ,EAAUyE,SAASssH,CAAAA;AAC/B,UAAMrqH,IAAO1G,EAAUY,QACvB;AAAA,QASI4xH,GACAC,GAVA7C,IAAY5vH,EAAUiM,YAAY7L;AAElCsG,IAAAA,KAAQ4oH,EAAW5oH,EAAKnD,UAC3BqsH,MAAAA,EAAUlpH,EAAKnD,UAAAA,IAAc+rH,EAAW5oH,EAAKnD,cAE1CmD,KAAQ4oH,EAAW5oH,EAAKD,QAC3BmpH,MAAAA,EAAUlpH,EAAKD,QAAY6oH,IAAAA,EAAW5oH,EAAKD,QAAAA,IAKxC6oH,KAAcA,EAAWrtD,4BAC5BuwD,IAAgBlD,EAAW/tH,YAC3BkxH,IAAcnD,EAAW9tH;AAE1B,UA4GMkxH,IAAS,EAACl6G,OAAO,aAAawb,OAAOtG,EAAOwN,OAAOoc,oBAAoB5iC,UAAU,MAzB/D,SAAS46G;AAChC,UAAIqD,IAAoB3yH,EAAUiM,YAAYqjH,CAa9C;AAAA,UAZGtvH,EAAUuvH,4BAA4BoD,CAAAA,KACxC7C,EAA2B6C,CAExBF,GAAAA,KAAeD,MAClB5C,EAAUruH,WAAWyH,SAASwpH,EAAcroH,SAC5CylH,CAAAA,GAAAA,EAAUruH,WAAW0H,WAAWupH,EAAc/mH,eAC9CmkH,EAAUruH,WAAW8sB,WAAWmkG,EAAcpiG,WAAAA,CAAAA,GAC9Cw/F,EAAUlzG,YAAAA,CAAa+1G,IAAeD,CAAAA,KAAiB,MAExD5C,EAAU3tD,0BAA0BqtD,EAAWrtD,yBAC/C2tD,EAAU7wF,oBAAoB,MAEzB/+B,CAAAA,EAAUM,OAAO61F,mBAAmBn2F,EAAUo2F,eAAew5B;AACjE,mBAAW1sH,KAAKlD,EAAU0W;AACf1W,YAAU0W,QAAQxT,CAAAA,EACrBD,MAAM2sH,EAAU3sH,OACtBjD,EAAU0W,QAAQxT,CAAK,IAAA,EAAA,GAAI0sH,KAC3B5vH,EAAUmJ,UAAU,kBAAkB,CAACnJ,EAAU0W,QAAQxT,CAAAA,EAAGD,IAAIjD,EAAU0W,QAAQxT,CAIxF,CAAA,CAAA;AAAA,IAAA,EAE+GosH,CACvGsD,EAAAA,GAAAA,IAAe,EAACp6G,OAAO,aAAawb,OAAOtG,EAAOwN,OAAOsc,sCAAsC9iC,UAAU,MAtFvF,SAAS46G;AAChC,UAAIqD,IAAoB3yH,EAAUiM,YAAYqjH,CAAAA;AAO9C,UANImD,KAAeD,MAClBlD,EAAWE,cAAcF,EAAW/tH,YACpC+tH,EAAW/tH,aAAaixH,GACxBlD,EAAW9tH,WAAWixH,IAGnBzyH,EAAU8wH,mBAAmB6B,CAAsB3yH,KAAAA,EAAUuvH,4BAA4BoD,CAa5F;AAAA,YAZG3yH,EAAUuvH,4BAA4BoD,CAAAA,KACxC7C,EAA2B6C,CAE5B/C,GAAAA,EAAUJ,cAAcpvH,EAAMmB,YAC9BquH,EAAUruH,aAAa+tH,EAAW/tH,YAClCquH,EAAUlzG,YAAa4yG,CAAAA,EAAW9tH,YAAY8tH,EAAW/tH,cAAc,KACvEquH,EAAU3tD,0BAA0BqtD,EAAWrtD,yBAE3C2tD,EAAU10G,SACb8zG,EAA0BY,EAAU3sH,IAAI2sH,KAGpC5vH,EAAUM,OAAO61F,mBAAmBn2F,EAAUo2F,eAAew5B;AACjE,qBAAW1sH,KAAKlD,EAAU0W;AACf1W,cAAU0W,QAAQxT,CAAAA,EACrBD,MAAM2sH,EAAU3sH,OACtBjD,EAAU0W,QAAQxT,CAAK,IAAA,EAAA,GAAI0sH,KAC3B5vH,EAAUmJ,UAAU,kBAAkB,CAACnJ,EAAU0W,QAAQxT,CAAAA,EAAGD,IAAIjD,EAAU0W,QAAQxT,CAI/E,CAAA,CAAA;AAAA,aAAA;AAEN0sH,QAAAA,EAAUvnH,YAAYjI,EAAMoB;AAC5B,cAAM+wH,IAAgBjD,EAAW30G,kBAAkB3a,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAK8sH,EAAWE,WAChGI,CAAAA;AAAAA,QAAAA,EAAUkC,oBAAoB,IAAItvH,KAAK+vH,EAAc9vH,QAAAA,IAAY,GACjEmtH,GAAAA,EAAUpuH,WAAW8tH,EAAW9tH,UAChCouH,EAAUJ,cAAcpvH,EAAMmB,YAC9BquH,EAAUruH,aAAa+tH,EAAW/tH,YAClCquH,EAAU7wF,oBAAoBuwF,EAAWrsH,IAErC2sH,EAAU10G,SACb8zG,EAA0BY,EAAU3sH,IAAI2sH,CAIzC;AAAA,YAAIhoE,IAAUgoE,EAAUpuH;AAExB,YADAouH,EAAUpuH,WAAWouH,EAAUvnH,YAC1BrI,EAAUM,OAAO61F,mBAAmBn2F,EAAUo2F,eAAew5B,CAAY,GAAA;AAC7EA,UAAAA,EAAUpuH,WAAWomD;AACrB,qBAAW1kD,KAAKlD,EAAU0W;AACf1W,cAAU0W,QAAQxT,CAAAA,EACrBD,MAAM2sH,EAAU3sH,OACtBjD,EAAU0W,QAAQxT,CAAK,IAAA,EAAA,GAAI0sH,KAC3B5vH,EAAUmJ,UAAU,eAAe,CAACnJ,EAAU0W,QAAQxT,CAAAA,EAAGD,IAAIjD,EAAU0W,QAAQxT,CAAIlD,GAAAA,EAAUyb,cAC7Fzb,EAAUmJ,UAAU,kBAAkB,CAACnJ,EAAU0W,QAAQxT,CAAAA,EAAGD,IAAIjD,EAAU0W,QAAQxT,CAGpF,CAAA,CAAA;AAAA,QAAA;AAAA,MACD;AAAA,IACJ,EA2BuIosH,MAC/HuD,IAAgB,EAACr6G,OAAO,cAAcwb,OAAOtG,EAAOwN,OAAOqc,wBAAwB7iC,UAAU,MA9G1E,SAAS46G,GAAAA;AACjC,UAAIM,IAAY,EAAA,GAAIxvH,GAAUJ,GAAAA,EAAUyE,SAAS,4BAAA,EAAA;AAQjD,UAPIguH,KAAeD,MAClB5C,EAAUruH,aAAaixH,GACvB5C,EAAUpuH,WAAWixH,GACrB7C,EAAU3tD,0BAA0BqtD,EAAWrtD,yBAC/C2tD,EAAUqC,OAAO,KAAA,CAGbjyH,EAAUM,OAAO61F,mBAAmBn2F,EAAUo2F,eAAew5B,CAAAA;AACjE,mBAAW1sH,KAAKlD,EAAU0W,SAAS;AAClC,cAAIu5G,IAAMjwH,EAAU0W,QAAQxT;AACnB,UAANA,MAAM,gCAGN+sH,EAAIhtH,MAAM2sH,EAAU3sH,OACtBjD,EAAU0W,QAAQxT,CAAAA,IAAK,KAAI0sH,EAC3B5vH,GAAAA,EAAUmJ,UAAU,kBAAkB,CAACnJ,EAAU0W,QAAQxT,CAAAA,EAAGD,IAAIjD,EAAU0W,QAAQxT;QAEnF;AAAA,IAEL,EAyF4HosH,CAAaj0F,GAAAA,SAAAA,GAEtIyF;AAAAA,IAAAA,IADGj7B,MAAS,QACF,CACTgtH,GACAD,GACAF,KAGS,CACTG,GACAD,IAIFpC,EAAa1vF,GAAUzoB,CAAAA,MACR;AAAA,MAAXA,MAAW,YACbk4G,EAAAA;AAAAA,IACA;EAEJ,GA0BCvwH,EAAU8yH,yBAAyB9yH,EAAU85D,oBAC7C95D,EAAU85D,qBAAqB,SAAUC,GACxC;AAAA,aAAS72D,IAAI,GAAGA,IAAIoG,KAAK4nH,UAAU/tH,QAAQD;AAAAA,aACnCoG,KAAKoN,QAAQpN,KAAK4nH,UAAUhuH,CAAAA,EAAGD,EACvCqG;AAAAA,SAAK4nH,YAAY,CAEjB;AAAA,UAAMN,IAAaD,EACnB;AAAA,QAAI3/E,IAAQ1nC,KAAKwpH,uBAAuB/4D,CACpCnnB,GAAAA,IAAM,CACV;AAAA,SAAS1vC,IAAI,GAAGA,IAAI8tC,EAAM7tC,QAAQD;AAC7B8tC,MAAAA,EAAM9tC,CAAG2oC,EAAAA,WAAWmF,EAAM9tC,CAAAA,EAAGozF,uBAI7Bo4B,EAAS19E,EAAM9tC,CAClBoG,CAAAA,IAAAA,KAAKypH,YAAY/hF,EAAM9tC,CAAAA,GAAI0vC,WAAgBxL,QAAAA,QAAsBA,QAAWwpF,CAE5Eh+E,IAAAA,EAAIjwC,KAAKquC,EAAM9tC,CAAAA,CAAAA;AAIjB,WAhCD,SAA6Cu0B,GAAAA;AAC5C,YAAMpf,IAAS,CAAA;AAQf,aAPAof,EAAMrzB,QAAQ2xC,CAAAA,MACb;AAAA,cAAMi9E,IAAe36G,EAAO09B,EAAK9yC;UAE5B+vH,KAAiBA,EAAa/wD,2BAA2BlsB,EAAKksB,6BAClE5pD,EAAO09B,EAAK9yC,EAAM8yC,IAAAA;AAAAA,MAClB,IAEK73B,OAAO8qB,OAAO3wB;IACrB,EAqBiDu6B,CAEnD;AAAA,EAAA,GAEC,WACC;AAAA,QAAIxkB,IAAMpuB,EAAU4I;AACpB5I,MAAU4I,gBAAgB,SAAU7C;AACnC,aAAI2oH,CAAAA,CAAAA,EAAS3oH,CACNqoB,KAAAA,EAAI7Z,KAAKjL,MAAMvD;IACzB;AACE,QAAIktH,IAAmBjzH,EAAUiW;AACjCjW,MAAUiW,cAAc,SAAUhT,GACjC;AAAA,UAAI8C,IAAK/F,EAAUyE,SAASxB,CAExB8C;AAAAA,MAAAA,KAAM2oH,EAAS3oH,CAAQuD,KAAAA,CAAAA,KAAKyqC,kBAAkB9wC,CACjDjD,IAAAA,EAAU8oD,YAEVmqE,IAAAA,EAAiB1+G,KAAKjL,MAAMrG;IAEhC;AAAA,EACE;AAED,QAAM6rH,IAAe9uH,EAAUgC,KAAK0tB,YAAY,eAyNhD;AAAA,WAASwjG,EAAkBlxH,GAAAA;AAC1B,UAAMmxH,IAAYnxH,EAAKyF,UACjB2rH,IAAapxH,EAAK6F;AAExB,WAAO,EAAEsrH,WAAWE,GAAAA,WADFjkH,KAAKg2C,KAAKguE,IAAa,CAEzC,EAAA;AAAA,EAAA;AA5NDpzH,IAAU+yH,cAAc,SAAUhtH,GAAIirC,GAAOsiF,GAAYzhG,GAAME,GAAIwhG,GAAU3C;AAC5E,QAAK7qH,CAAAA,EAAGmV;AACP;AAGD,QAAIs4G,IAAmB5C,IAAaA,EAAW7qH,EAAG9C,EAAAA,IAAM0tH,EAAkB5qH,EAAAA,EAAG9C;AACxEuwH,IAAAA,MACJA,IAAmB,CAAA,IAKpB3hG,IAAO88F,EAAU98F,KAAQ,IAAIrvB,KAAKxC,EAAUkK,UAAUzH,QAAAA,IAAY,UAClEsvB,IAAK48F,EAAU58F,KAAK,IAAIvvB,KAAKxC,EAAUiK,UAAUxH,QAAAA,IAAY,GAE7D,CAAA;AAAA,UAAMgxH,IAAW9E,EAAU5oH,EAAGxE,UAC9B;AAAA,QAAIstH;AAGHA,IAAAA,IAAczjC,GAFXmoC,IAEoB,SAASxtH,EAAGmV,KAAe4zG,UAAAA,EAAa/oH,EAAGvE,QAAAA,CAAAA,UAAmB+xH,MAE9D,SAASxtH,EAAGmV,eAAe4zG,EAAa/oH,EAAGvE,aAF+B,EAAEygF,SAASwxC,EAK7G,CAAA;AAAA,UAAMC,IAAgB7E,EAAYtqC,QAAQ1yD,GAAME,GAAAA,IAAUluB,IAAI7B,CAAAA,MAAAA;AAC7D,YAAM2xH,KAp4BmBhiH,IAo4Bc3P,GAn4BjC,IAAIQ,KACVmP,EAAEke,kBACFle,EAAEie,YAAAA,GACFje,EAAEge,WACFhe,GAAAA,EAAEse,eACFte,EAAEue,cAAAA,GACFve,EAAEwe,cAAAA,CAAAA;AAPJ,UAA2Bxe;AAw4BzB,aAHAgiH,EAAa3qH,SAASjD,EAAGxE,WAAW4I,SAAAA,CAAAA,GACpCwpH,EAAa1qH,WAAWlD,EAAGxE,WAAWkK,WAAAA,CAAAA,GACtCkoH,EAAatlG,WAAWtoB,EAAGxE,WAAW6uB,WAAAA,CAAAA,GAC/BujG;AAAAA,IAAY,CAEpB;AAAA,QAAIC,IAAe;AAEnB,UAAMC,IAAgB9tH,EAAG2W;AAEzB,aAASxZ,IAAI,GAAGA,IAAIwwH,EAAcvwH,UAAAA,EAC7BowH,KAAYK,KAAgBL,IADSrwH,KAAK;AAI9C,YAAMlB,IAAO0xH,EAAcxwH,CAE3B;AAAA,UAAI6sH,IAAYyD,EAAiBxxH,EAAKS;AACtC,UAAIstH,GAAW;AAGd,YAAIA,EAAUlkF,WAAWkkF,EAAUvuH,SAASiB,QAAAA,IAAYzC,EAAUkK,UAAUzH,QAAAA,KAAAA,CAAczC,EAAUg6D,aAAa+1D,EAAU9sH,IAAI8sH,CAAAA;AAC9H;AAEA6D,QAAAA,KACA5iF,EAAMruC,KAAKotH,CAAAA;AAAAA,MAEhB,OAAU;AACN,cAAM1zG,IAAOrc,EAAU49D,YAAY73D,CAMnC;AAMA,YAVAsW,EAAKG,OAAOzW,EAAGyW,MACfH,EAAK9a,aAAaS,GAClBqa,EAAKpZ,KAAK8C,EAAG9C,KAAK,MAAMmM,KAAKg2C,KAAKpjD,EAAKS,YACvC4Z,EAAK7a,WAAW,IAAIgB,KAAKR,EAAKS,YAA4B,MAAhBoxH,CAAAA,GACvCx3G,EAAK7a,SAASiB,QAAYzC,IAAAA,EAAUkK,UAAUzH,QAChD,MAED4Z,EAAK7a,WAAWxB,EAAU8zH,0BAA0Bz3G,EAAK9a,YAAY8a,EAAK7a,UAAUuE,GAAI/D,GAAMqa,EAAK7a,WACnG6a,EAAK1T,SAAS3I,EAAU4I,cAAcyT,CAAAA,GAAAA,CAEjCA,EAAK1T,UAAAA,CAAW3I,EAAUyK,eAAAA,CAAgBzK,EAAUM,OAAO4sD;AAAW;AAC3Elc,QAAAA,EAAMruC,KAAK0Z,IAENi3G,MACJtzH,EAAU0W,QAAQ2F,EAAKpZ,EAAMoZ,IAAAA,GAC7Brc,EAAUkxH,UAAUvuH,KAAK0Z,KAE1Bu3G;AAAAA,MACA;AAAA,IACD;AAED,QAAIJ,KAAoBE,EAAcvwH,UAAU;AAC/C,eAASgf,KAAKqxG,GAAiB;AAC9B,YAAIzD,IAAYyD,EAAiBrxG,CACjC;AAAA,YAAI4tG,GAAW;AAGd,cAAIA,EAAUlkF,WAAWkkF,EAAUvuH,SAASiB,YAAYzC,EAAUkK,UAAUzH,cAAczC,EAAUg6D,aAAa+1D,EAAU9sH,IAAI8sH,CAC9H;AAAA;AACUl+F,UAAAA,KAAQE,KAAMg+F,EAAUxuH,aAAawwB,KAAMg+F,EAAUvuH,WAAWqwB,KAC1Emf,EAAMruC,KAAKotH,CAAAA;AAAAA,QAEZ;AAAA,MACD;AAAA,EAEJ,GAEC/vH,EAAU8zH,4BAA4B,SAAUvyH,GAAYC,GAAUuE,GAAI0uD,GAASiC,GAAAA;AAClF,QAAI/nC,IAAQptB,EAAWmtB,kBAAAA,IAAsBltB,EAASktB,kBACtD;AAAA,WAAIC,IACCA,IAAQ,IAEJ,IAAInsB,KAAKiyD,EAAQhyD,QAA0B,IAAA,MAAdsD,EAAG2W,WAA0B,KAARiS,IAAa,GAAA,IAI/D,IAAInsB,KAAKhB,EAASiB,YAAoB,KAARksB,IAAa,GAG7C,IAAA,IAAInsB,KAAKk0D,EAAaj0D;EAC/B,GACCzC,EAAUy2F,cAAc,SAAUxzF,GAAIoM;AACrC,QAAItJ,IAAY9C,OAAAA,KAAM,WAAWA,IAAKjD,EAAUyE,SAASxB,CACrD8wH,GAAAA,IAAa;AAGjB,QAFA1kH,IAAMA,KAAO,KAERq/G,CAAAA,EAAS3oH,CACb;AAAA,aAAO,CACN,EAAExE,YAAYwE,EAAGxE,YAAYC,UAAUuE,EAAGvE,SAAAA,CAAAA;AAG5C,QAAIuE,EAAG8lC;AACN,aAAO,CAAA;AAGR7rC,MAAU+yH,YAAYhtH,GAAIguH,GAAY,IAAMhuH,EAAGxE,YAAYwE,EAAGvE,UAAU6N,CAGxE;AAAA,aADIgJ,IAAS,CACJnV,GAAAA,IAAI,GAAGA,IAAI6wH,EAAW5wH,QAAQD;AACjC6wH,MAAAA,EAAW7wH,GAAG2oC,WAClBxzB,EAAO1V,KAAK,EAAEpB,YAAYwyH,EAAW7wH,GAAG3B,YAAYC,UAAUuyH,EAAW7wH,CAAG1B,EAAAA,SAAAA,CAAAA;AAI9E,WAAO6W;AAAAA,EACT,GACCrY,EAAUqkC,YAAY,SAAUxS,GAAME;AACrC,QAAI1Z,IAAS;AACb,UAAMu4G,IAAaD;AACnB,aAASxuG,KAAK7Y,KAAKoN,SAAS;AAC3B,UAAI3Q,IAAKuD,KAAKoN,QAAQyL,CAAAA;AACtB,WAAIpc,EAAGuwF;AAIP,YAAIzkE,KAAQE,KAAMhsB,EAAGxE,aAAawwB,KAAMhsB,EAAGvE,WAAWqwB;AACrD,cAAI68F,EAAS3oH,CAAK,GAAA;AACjB,gBAAIiuH,IAAM,CACV1qH;AAAAA,iBAAKypH,YAAYhtH,GAAIiuH,GAAAA,IAAWniG,GAAME,GAAAA,QAAe6+F,CACrDoD,GAAAA,EAAI5vH,QAAQ,SAASkrH,GAChBA;AAAAA,cAAAA,EAAW/tH,aAAawwB,KAAMu9F,EAAW9tH,WAAWqwB,KACvDxZ,EAAO1V,KAAK2sH,CAEnB;AAAA,YAAA,CAAA;AAAA,UAEK;AAAWhmH,iBAAKyqC,kBAAkBhuC,EAAG9C,OACrCoV,EAAO1V,KAAKoD;;AAEF8rB,UAAAA,KAASE,KAAOzoB,KAAKyqC,kBAAkBhuC,EAAG9C,EACrDoV,KAAAA,EAAO1V,KAAKoD,CAAAA;AAAAA,IAEb;AACD,WAAOsS;AAAAA,EACT,GAGCrY,EAAU8+D,cAAc,SAAU/4D,GACjC;AAAA,QAAIxE,IAAa,IAAIiB,KAAK8G,KAAK/H,aAC3BC,IAAW,IAAIgB,KAAK8G,KAAK9H,QAAAA;AAC7B8H,SAAK/H,aAAaA,GAClB+H,KAAK9H,WAAWA,GAChB8H,KAAKoT,WAAWpT,KAAK4R,QAAQ;AAAA,EAC/B,GAEClb,EAAUM,OAAO2zH,iBAAiB,IAClCj0H,EAAUM,OAAO8xH,qBAAqB,OACtCpyH,EAAUM,OAAO4zH,qBAAqB,CAAC73C,EAAMyC,GAAGjK,SAAQwH,EAAM0C,GAAGlK,SAAQwH,EAAM2C,GAAGnK,SAAQwH,EAAM4C,GAAGpK,SAAQwH,EAAM6C,GAAGrK,OAAAA,GACpH70E,EAAUM,OAAOyyH,cAAc,YAC/B/yH,EAAUM,OAAO63B,SAAS92B,WAAW,CACpC,EAAEkX,MAAM,eAAe/U,QAAQ,QAAQqC,MAAM,YAAYwzB,OAAO,GAAA,GAChE,EAAE9gB,MAAM,aAAa1S,MAAM,aAAarC,QAAQ,QAChD,GAAA,EAAE+U,MAAM,QAAQxJ,QAAQ,IAAIlJ,MAAM,QAAQrC,QAAQ,WAGnDxD,EAAUsE,YAAY,cAAc,WACnCtE;AAAAA,MAAUoxH,eAAe,IACzBpxH,EAAUmxH,oBAAoB,IAC9BnxH,EAAUkxH,YAAY,CAAA;AAAA,EACxB;AAyCC,QAAMiD,IAAoB,EACzB,GAAG,MACH,GAAG,MACH,GAAG,MACH,GAAG,MACH,GAAG,MACH,GAAG,MACH,GAAG,KAEEC,GAAAA,IAAmB,EACxB,GAAG,GACH,GAAG,GACH,GAAG,GACH,GAAG,GACH,GAAG,GACH,GAAG,GACH,GAAG,EAGJ;AAAA,WAASC,EAAkB/tG,GAAM4mE,GAAAA;AAChC,UAAMonC,IAAgBhuG,EAAK5F,cAAc,gCACrC4zG;AAAAA,IAAAA,MACHA,EAAc97G,SAAS00E,IAAOA,EAAKr4C,WAAW,MAAM;AAAA,EAErD;AA6CD,WAAS0/E,EAAgBvyH;AACxB,YAAQA,GAAAA;AAAAA,MACP,KAAK;AAAA,MACL,KAAK;AACJ,eAAO,GAAGA,CAAAA;AAAAA,MACX,KAAK;AACJ,eAAO,GAAGA,CACX;AAAA,MAAA,KAAK;AACJ,eAAO,GAAGA,CAAAA;AAAAA,MACX;AACC,eAAO,GAAGA;;EAEZ;AAEDhC,IAAUya,UAAU+5G,sBAAsB,SAAShxE,GAAWpjD,GAAAA;AAE7D,WAAO,SAASm0H,EADH/wE,EAAU37C,QAAAA,CAAAA,CAAAA;AAAAA,EAEzB,GACC7H,EAAUya,UAAUg6G,yBAAyB,SAASjxE,GAAWpjD,GAChE;AAAA,UAAMs0H,IAAgBxB,EAAkB1vE;AACxC,WAAO,SAAS+wE,EAAgBG,EAAcrB,SAAAA,CAAAA,IAAcrzH,EAAU0tB,OAAO1rB,KAAKguB,SAAS0kG,EAAcvB,SAC3G,CAAA;AAAA,EAAA,GAECnzH,EAAUya,UAAUk6G,2BAA2B,SAASnxE,GAAWpjD,GAAAA;AAClE,UAAM4B,IAAOwhD,EAAU37C,QACjBy1C,GAAAA,IAAat9C,EAAU0tB,OAAO1rB,KAAKmsB,WAAWq1B,EAAUrmC;AAC9D,WAAO,SAASo3G,EAAgBvyH,CAAgBs7C,CAAAA,WAAAA,CAAAA;AAAAA,EAClD,GACCt9C,EAAUya,UAAUm6G,8BAA8B,SAASpxE,GAAWpjD;AACrE,UAAMs0H,IAAgBxB,EAAkB1vE,CAClClG,GAAAA,IAAat9C,EAAU0tB,OAAO1rB,KAAKmsB,WAAWq1B,EAAUrmC,SAC9D,CAAA;AAAA,WAAO,SAASo3G,EAAgBG,EAAcrB,cAAcrzH,EAAU0tB,OAAO1rB,KAAKguB,SAAS0kG,EAAcvB,SAAAA,CAAAA,OAAiB71E;EAC5H;AA4CC,QAAMu3E,IAAc,EACnB33C,SAAS,SAAU/vE,GAOlB;AAAA,WAAO,EAAC+N,OANM,EACbihE,MAAME,EAAMa,SACZroC,UAAU,GACV6mC,YAAYvuE,EAAMF,MAAMpF,QAGV0vE,EAAAA,GAAAA,OADD,IAAI/0E,KAAK,MAAM,GAAG;EAEhC,GACDy6E,QAAQ,SAAU9vE,GACjB;AAAA,QAAIc,IAAMd,EAAMF,MAAMxF,OAAW,IAAA;AAAA,WAC7BwG,KAD6B,OAClBA,IAAM,IAOd,EAACiN,OANM,EACbihE,MAAME,EAAMY,QACZpoC,UAAU,GACV+mC,WAAW,CAAC3tE,MAGEspE,OADD,IAAI/0E,KAAK,MAAM,GAAG;EAEhC,GACDk6E,OAAO,SAAUvvE,GAAAA;AAMhB,WAAO,EAAC+N,OALM,EACbihE,MAAME,EAAMK,OACZ7nC,UAAU,KAGI0iC,OADD,IAAI/0E,KAAK,MAAM,GAAG;EAEhC,GACD26E,QAAQ,SAAUhwE,GAQjB;AAAA,WAAO,EAAC+N,OAPM,EACbihE,MAAME,EAAMc,QACZR,SAASxvE,EAAMF,MAAMkQ,SAAAA,IAAa,GAClC03B,UAAU,GACV6mC,YAAYvuE,EAAMF,MAAMpF,QAGV0vE,EAAAA,GAAAA,OADD,IAAI/0E,KAAK,MAAM,GAAG,CAAA,EAAA;AAAA,EAEhC,GACDsyH,UAAU,SAAU3nH;AAOnB,WAAO,EAAC+N,OANM,EACbihE,MAAME,EAAMY,QACZpoC,UAAU,GACV+mC,WAAW57E,EAAUM,OAAO4zH,sBAGd38C,OADD,IAAI/0E,KAAK,MAAM,GAAG,CAAA,EAAA;AAAA,EAEhC,GACDuyH,QAAQ,SAAU5nH,GAAOmZ,GACxB;AAAA,UAAMpL,IAAQ,CAAA,GACRihE,IAAO71D,EAAK5F,cAAc,+BAAA,EAAiClI,OAC3Dq8B,IAAWzlC,KAAKC,IAAI,GAAGiX,EAAK5F,cAAc,gCAAkClI,EAAAA,KAAAA,GAC5Ew8G,IAAc1uG,EAAK5F,cAAc,kCAAA,IAAsC4F,EAAK5F,cAAc,kCAAA,EAAoClI,QAAQ,MACtIy8G,IAAa3uG,EAAK5F,cAAc,iCAAA,IAAqC4F,EAAK5F,cAAc,iCAAmClI,EAAAA,QAAQ;AAEzI,QAAI9S,GACAuI;AAEJ,YAJAiN,EAAM25B,WAAWA,GAITsnC,GAAAA;AAAAA,MACP,KAAK;AACJjhE,QAAAA,EAAMihE,OAAOE,EAAMK;AACnB;AAAA,MACD,KAAK;AACJxhE,QAAAA,EAAMihE,OAAOE,EAAMY,QACnBv3E,IAAO,CAAA,GACP4gB,EAAKvjB,iBAAiB,kDAAkDqB,QAASktH,CAAAA,MAAAA;AAC7EA,UAAAA,EAAGj2F,WACL31B,EAAK/C,KAAK2uH,EAAG94G,KAAAA;AAAAA,QACb,CAGF0C,GAAAA,EAAM0gE,YAAYl2E,EAAK7B,IAAKoK,CAAAA,MAC3B;AAAA,kBAAQA;YACP,KAAK;AACJ,qBAAOouE,EAAMyC,GAAGjK;AAAAA,YACjB,KAAK;AACJ,qBAAOwH,EAAM0C,GAAGlK;AAAAA,YACjB,KAAK;AACJ,qBAAOwH,EAAM2C,GAAGnK;AAAAA,YACjB,KAAK;AACJ,qBAAOwH,EAAM4C,GAAGpK;AAAAA,YACjB,KAAK;AACJ,qBAAOwH,EAAM6C,GAAGrK;AAAAA,YACjB,KAAK;AACJ,qBAAOwH,EAAMuN,GAAG/U;AAAAA,YACjB,KAAK;AACJ,qBAAOwH,EAAMwN,GAAGhV;AAAAA;QAGjB,CAEF;AAAA;AAAA,MACD,KAAK;AACJ35D,QAAAA,EAAMihE,OAAOE,EAAMa,SAEf83C,MAAgB,eACnB95G,EAAMwgE,aAAavuE,EAAMF,MAAMpF,QAAAA,KAE/BoG,IAAMd,EAAMF,MAAMxF,OAAAA,IAAW,GACzBwG,YAAWA,IAAM,IACrBiN,EAAM0gE,YAAY,CAAC3tE,CAAAA,GACnBiN,EAAMgnE,WAAWgxC,EAAkB/lH,EAAMF,KAAOomH,EAAAA;AAEjD;AAAA,MACD,KAAK;AACJn4G,QAAAA,EAAMihE,OAAOE,EAAMc,QACnBjiE,EAAMyhE,UAAUxvE,EAAMF,MAAMkQ,SAAa,IAAA,GAErC83G,KAAc,eACjB/5G,EAAMwgE,aAAavuE,EAAMF,MAAMpF,QAE/BoG,KAAAA,IAAMd,EAAMF,MAAMxF,WAAW,GACzBwG,KAAQ,OAAGA,IAAM,IACrBiN,EAAM0gE,YAAY,CAAC3tE,CACnBiN,GAAAA,EAAMgnE,WAAWgxC,EAAkB/lH,EAAMF,KAAOomH,EAAAA;AAAAA,IAAAA;AAInD,UAAM6B,IAAal1H,EAAUgC,KAAKuuB,YAAY,UAAA;AAC9C,QAAIgnD,IAAQ,IAAI/0E,KAAK,MAAM,GAAG,CAAA;AAC9B,UAAM2yH,IAAU7uG,EAAK5F,cAAc,iCAQnC;AAAA,WAPGy0G,KAAWA,EAAQ38G,UAAU,QAC/B++D,IAAQ29C,EAAW5uG,EAAK5F,cAAc,sCAAwClI,EAAAA,KAAAA,GAC9E0C,EAAMq8D,QAAQ,IAAI/0E,KAAK+0E,CAAAA,KACd49C,KAAWA,EAAQ38G,UAAU,YACtC0C,EAAMgwC,QAAQ97C,KAAKC,IAAI,GAAGiX,EAAK5F,cAAc,qCAAuClI,EAAAA,KAAAA,IAG9E,EAAC0C,OAAAA,GAAOq8D;EACf,GACD69C,OAAO;EACN,EAGF;AAAA,WAASC,EAAe/uG,GAAM4mE,GAAM9sF,GA7PpC;AAAA,KAAA,SAAyBkmB,GAAM4mE,GAAAA;AAC9BmnC,MAAAA,EAAkB/tG,GAAM4mE,CAAAA;AAAAA,IACxB,GA4PgB5mE,GAAM4mE,IA1PvB,SAA0B5mE,GAAM4mE,GAAM9sF,GAAAA;AAKrC,UAJAi0H,EAAkB/tG,GAAM4mE,CAEF5mE,GAAAA,EAAKvjB,iBAAiB,oCAC9BqB,EAAAA,QAASktH,CAAAA,MAAOA,EAAGj2F,UAAAA,EAC7B6xD,GAAAA,KAAQA,EAAKtR;AAChBsR,QAAAA,EAAKtR,UAAUx3E,QAAS6J,CAAAA;AACvB,gBAAMqnH,IAASlB,EAAiBnmH,EAAI4mE,OAAAA,GAC9B0gD,IAAWpB,EAAkBmB,CAC7B12B,GAAAA,IAAWt4E,EAAK5F,cAAc,6CAA6C60G;AAC9E32B,UAAAA,MACFA,EAASvjE;QACT,CAAA;AAAA,WAEI;AACN,cAAMk6F,IAAWpB,EAAkB/zH,EAAMmB,WAAWkG,OAAAA,CAAAA,GAC9Cm3F,IAAWt4E,EAAK5F,cAAc,6CAA6C60G,CAC9E32B,IAAAA;AAAAA,QAAAA,MACFA,EAASvjE,UAAAA;AAAAA,MAEV;AAAA,IACD,EAsOiB/U,GAAM4mE,GAAM9sF,CApO9B,GAAA,SAA2BkmB,GAAM4mE,GAAM9sF,GAAAA;AACtCi0H,MAAAA,EAAkB/tG,GAAM4mE,CAExB;AAAA,YAAMsoC,IAAclvG,EAAK5F,cAAc,uDACjC+0G,IAAoBnvG,EAAK5F,cAAc,2DAC7C;AAAA,UAAG80G,KAAeC,GAAkB;AACnCD,QAAAA,EAAYj4E,YAAYv9C,EAAUya,UAAU+5G,oBAAoBp0H,EAAMmB,YAAYnB,IAClFq1H,EAAkBl4E,YAAYv9C,EAAUya,UAAUg6G,uBAAuBr0H,EAAMmB,YAAYnB,CAAAA;AAE3F,cAAMw0B,IAAStO,EAAK5F,cAAc,kCAC9BkU;AAAAA,QAAAA,MACHA,EAAOpc,QAAAA,CAAS00E,KAAQA,CAAAA,EAAKhL,YAAcgL,EAAKtR,aAAasR,EAAKtR,UAAUz4E,SAA0B,sBAAf;AAAA,MAExF;AAAA,IACD,EAuNkBmjB,GAAM4mE,GAAM9sF,IAnL/B,SAA0BkmB,GAAM4mE,GAAM9sF,GACrC;AAAA,YAAMs1H,IAAapvG,EAAK5F,cAAc,mDAChCi1G,GAAAA,IAAmBrvG,EAAK5F,cAAc;AACzCg1G,MAAAA,KAAcC,MAChBD,EAAWn4E,YAAYv9C,EAAUya,UAAUk6G,yBAAyBv0H,EAAMmB,YAAYnB,CAAAA,GACtFu1H,EAAiBp4E,YAAYv9C,EAAUya,UAAUm6G,4BAA4Bx0H,EAAMmB,YAAYnB,CAAAA,GAE1F8sF,OAASA,EAAKhL,YAAcgL,EAAKtR,aAAasR,EAAKtR,UAAUz4E,UAGjEmjB,EAAK5F,cAAc,mCAAmClI,QAAQ,sBAF9D8N,EAAK5F,cAAc,iCAAA,EAAmClI,QAAQ;AAAA,IAKhE,EAuKiB8N,GAAM4mE,GAAM9sF,CAAAA,GArK9B,SAAqBkmB,GAAM4mE,GAAM9sF;AAChC,YAAMw1H,IAAatvG,EAAK5F,cAAc,iEAChCm1G,GAAAA,IAAcvvG,EAAK5F,cAAc,kEAAA,GACjCo1G,IAAkBxvG,EAAK5F,cAAc;AAE3C,UAAGk1G,KAAcC,KAAeC,GAAgB;AAC/CF,QAAAA,EAAWp9G,QAAQ;AAEnB,YAAIu9G,IAAY/1H,EAAUgC,KAAK0tB,YAAY,UACtC1vB;AAAAA,UAAUM,OAAO01H,uBACrBh2H,EAAUM,OAAO01H,qBAAqBD,EAAU/1H,EAAUgC,KAAKC,IAAIjC,EAAU+J,gBAAgB,IAAI,KAAA,CAAA,IAElG8rH,EAAYr9G,QAAQxY,EAAUM,OAAO01H,oBAEjC9oC,KAAQA,EAAKhiC,SAChB4qE,EAAgBt9G,QAAQ,SACxBo9G,EAAWp9G,QAAQ00E,EAAKhiC,SACd9qD,EAAMiI,aAAajI,EAAMiI,UAAU6U,kBAAkB,QAC/D44G,EAAgBt9G,QAAQ,MACxBq9G,EAAYr9G,QAAQu9G,EAAU31H,EAAMiI,SAEpCytH,KAAAA,EAAgBt9G,QAAQ,SAEzBs9G,EAAgBG,cAAc,IAAI1oD,MAAM;MACxC;AAAA,IACD,EA6IYjnD,GAAM4mE,GAAM9sF,CAAAA;AAAAA,EACxB;AAgUD,WAAS81H,EAAsBrwH;AAC9B,aAAS3C,IAAI,GAAGA,IAAIlD,EAAUM,OAAO63B,SAAS92B,SAAS8B,QAAQD,KAAK;AACnE,UAAI8B,IAAUhF,EAAUM,OAAO63B,SAAS92B,SAAS6B,CACjD;AAAA,UAAI8B,EAAQa,SAASA;AACpB,eAAO7F,EAAUk4B,YAAYlzB,EAAQuT,IAAAA;AAAAA,IAEtC;AACD,WAAO;AAAA,EACP;AAvUDvY,IAAUu4B,YAAuB,YAAI,EACpC49F,WAAY,SAAS7vG,GACpB;AAAA,eAAWA,KAAQ,UAAS;AAC3B,UAAIxiB,IAAU9D,EAAU4b,UAAU8E,cAAc,IAAI4F,CAAAA,EAAAA;AAChDxiB,MAAAA,MAGHA,IAAU8J,SAAS8/B,eAAepnB,CAEnCA,IAAAA,IAAOxiB;AAAAA,IACP;AAGD,WAFIwiB,EAAKrlB,MAAMkgB,WAAW,WACzBmF,EAAKrlB,MAAMkgB,UAAU,KACfmF;AAAAA,EACP,GACD8vG,aAAa,SAAS9vG,GACrB;AAAA,WAAOA,EAAKuyF,cAGU5zG,IAHgBqhB,IAIjCjb,IAAMuC,SAASC,cAAc,KAC7BE,GAAAA,YAAa9I,EAAE7B,UAAAA,EACnBwe,CAAAA,GAAAA,IAAIvW,EAAIyC,WACRzC,IAAM,MACCuW;AALR,QAAsB3c,GACoB2c,GAArCvW;AAAAA,EAML,GACDuK,QAAQ,SAAUwjB,GAAAA;AACjB,QAAIA,EAAIqrB,MAAM;AACb,UAAI4xE,IAAMr2H,EAAUu4B,YAAuB,WACvCksB,IAAO4xE,EAAIF,UAAU/8F,EAAIqrB,OACzB/iD,IAAO20H,EAAID,YAAY3xE,CAE3B;AAAA,aADAA,EAAKxjD,MAAMkgB,UAAU,QACdzf;AAAAA,IACP;AACD,QAAI40H,IAAMt2H,EAAU0tB,OAAOwN;AAE3B,WAAO;AAAA;AAAA;AAAA,4BAGkBo7F,EAAIl9E,YACJk9E;AAAAA,4BAAAA,EAAIj9E;6BACHi9E,EAAI/8E,aAAAA;AAAAA,8BACH+8E,EAAI98E,cACL88E;AAAAA,6BAAAA,EAAI78E;+BACF68E,EAAIh9E,eAAAA;AAAAA,6BACNg9E,EAAI58E,aAOJ48E;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,6BAAAA,EAAI38E,eACH28E;AAAAA,8BAAAA,EAAI18E,gBACH08E;AAAAA,+BAAAA,EAAIz8E;8BACLy8E,EAAIx8E,gBAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,8FAM4Dw8E,EAAIp8E,kBAAkB,CAAA,CAAA;AAAA,8FACtBo8E,EAAIp8E,kBAAkB,CAAA,CAAA;AAAA,8FACtBo8E,EAAIp8E,kBAAkB,CACtBo8E,CAAAA;AAAAA,8FAAAA,EAAIp8E,kBAAkB,CACtBo8E,CAAAA;AAAAA,8FAAAA,EAAIp8E,kBAAkB,CACtBo8E,CAAAA;AAAAA,8FAAAA,EAAIp8E,kBAAkB,CACtBo8E,CAAAA;AAAAA,8FAAAA,EAAIp8E,kBAAkB,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAmBzGo8E,EAAIt8E,WAAAA;AAAAA;AAAAA;AAAAA,8BAGes8E,EAAIl9E,YACJk9E;AAAAA,8BAAAA,EAAIp9E;2BACPo9E,EAAIv8E,cAAAA;AAAAA;AAAAA;AAAAA;AAAAA,+EAIgDu8E,EAAIr9E,6BAWhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAA,GAGDs9E,iBAAiB,SAAUjwG,GAAM9N,GAAOpY;AAEvC,aAASuJ,EAAK2c;AACVA,MAAAA,KAAMA,EAAKzH,UAAU5c,IAAI,YAAA;AAAA,IAC5B;AACD,aAASwvF,EAAKnrE,GAAAA;AACVA,MAAAA,KAAMA,EAAKzH,UAAUwL,OAAO,YAC/B;AAAA,IAAA;AANDrqB,MAAUu4B,YAAuB,UAAEi+F,MAAM,EAAEvpH,OAAO7M,EAAMmB,YAAY2L,KAAK9M,EAAMoB;AAqE/E,UAAMi1H,IAAenwG,EAAK5F,cAAc,iCAAA;AACrC+1G,IAAAA,KACFA,EAAatxG,iBAAiB,UAAU;OAhEzC,SAA8B3M,GAAAA;AAC7B,cAAMg9D,IAASlvD,EAAK5F,cAAc,yBACpB;AAAA,QAAVlI,MAAU,WACbi5E,EAAKjc,CAAAA,IAEL7rE,EAAK6rE,CAEN;AAAA,MAAA,GA0DsBlsE,KAAKkP,KAAAA;AAAAA,IAC/B;AAIG,UAAMk+G,IAAwBpwG,EAAK5F,cAAc,gEAC9Cg2G;AAAAA,IAAAA,KACFA,EAAsBvxG,iBAAiB,UAAU;OA/DlD,SAAsC3M,GAAAA;AACrC,cAAMiS,IAAQ,EACbksG,QAAQrwG,EAAK5F,cAAc,8BAAA,GAC3Bk2G,SAAStwG,EAAK5F,cAAc,kCAC5Bm2G,QAAQvwG,EAAK5F,cAAc,8BAE5B,EAAA;AAAA,gBAAQlI,GACP;AAAA,UAAA,KAAK;AACJ7O,YAAAA,EAAK8gB,EAAMksG,MACXhtH,GAAAA,EAAK8gB,EAAMmsG,OACXjtH,GAAAA,EAAK8gB,EAAMosG,MACX;AAAA;AAAA,UACD,KAAK;AACJplC,YAAAA,EAAKhnE,EAAMksG,SACXhtH,EAAK8gB,EAAMmsG,UACXjtH,EAAK8gB,EAAMosG;AACX;AAAA,UACD,KAAK;AACJltH,YAAAA,EAAK8gB,EAAMksG,MAAAA,GACXllC,EAAKhnE,EAAMmsG,OAAAA,GACXjtH,EAAK8gB,EAAMosG,MAAAA;AACX;AAAA,UACD,KAAK;AACJltH,YAAAA,EAAK8gB,EAAMksG,MACXhtH,GAAAA,EAAK8gB,EAAMmsG,OACXnlC,GAAAA,EAAKhnE,EAAMosG,MAIb;AAAA,QAAA;AAAA,MAAA,GAmC8BvtH,KAAKkP,KAAAA;AAAAA,IACvC,CAIG;AAAA,UAAMs+G,IAAuBxwG,EAAK5F,cAAc,uDAC7Co2G;AAAAA,IAAAA,KACFA,EAAqB3xG,iBAAiB,UAAU;OAxCjD,SAA+B3M,GAAAA;AAC9B,cAAMiS,IAAQ,EACbqtD,OAAOxxD,EAAK5F,cAAc,yDAAA,GAC1BtG,IAAIkM,EAAK5F,cAAc;AAExB,gBAAQlI,GAAAA;AAAAA,UACP,KAAK;AACJ7O,YAAAA,EAAK8gB,EAAMqtD,QACXnuE,EAAK8gB,EAAMrQ;AACX;AAAA,UACD,KAAK;AACJq3E,YAAAA,EAAKhnE,EAAMqtD,KACXnuE,GAAAA,EAAK8gB,EAAMrQ,EAAAA;AACX;AAAA,UACD,KAAK;AACJzQ,YAAAA,EAAK8gB,EAAMqtD,KAAAA,GACX2Z,EAAKhnE,EAAMrQ,EAAAA;AAAAA,QAAAA;AAAAA,MAGb,GAsBuB9Q,KAAKkP,KAAAA;AAAAA,IAChC,IAGGxY,EAAU4b,UAAUm7G;EACpB,GACDt4F,cAAc,WAAY;AAAA,EAAA,GAC1B/F,WAAW,SAAUpS,GAAM9N,GAAOzS;AACjC,QAAIixH,IAAKh3H,EAAUu4B,YAAuB;AACrCv4B,MAAU4b,UAAUm7G,kBACxBC,EAAGT,gBAAgBjwG,GAAM9N,GAAOzS,IACjCugB,EAAKiwC,OAAAA,CAAQxwD,EAAGmV,OAEhBoL,EAAK2wG,UAAU3tH,KAAK0nH,wBAAwBjrH,CAE5C;AAAA,QAAIy7B,IAAKw1F,EAAGR;AAIZ,QAHAh1F,EAAGv0B,QAAQlH,EAAGxE,YACdigC,EAAGt0B,MAAMnH,EAAGsC,WAERtC,EAAGmV,OAAO;AACb,YAAMg8G,IAAW9rC,GAASrlF,EAAGmV,KAC7Bm6G;AAAAA,MAAAA,EAAe/uG,GAAM4wG,EAASz7C,aAAa11E;AAC3C,YAAMoxH,IAjiBT,SAA2BC,GAAUC,GAAAA;AACpC,cAAMzxH,IAAUwxH,EAASxxH,SACnB2xE,IAAQ3xE,EAAQ2xE,SAAS8/C;AAI/B,eAFwBzxH,EAAQslD,SAAUqsB,KAASA,EAAMr6D,YAGjD,MAHmE,OAGnE,WAGJtX,EAAQu2E,SAASE,EAAMK,SAAS92E,EAAQivC,aAAa,KAAMjvC,EAAQg2E,YAE5Dh2E,EAAQu2E,SAASE,EAAMY,UAAUr3E,EAAQivC,aAAa,KAAMjvC,EAAQg2E,YAEpEh2E,EAAQu2E,SAASE,EAAMa,WAAWt3E,EAAQivC,aAAa,KAAMjvC,EAAQs8E,WAErEt8E,EAAQu2E,SAASE,EAAMc,UAAUv3E,EAAQivC,aAAa,KAAMjvC,EAAQs8E,WAEpEt8E,EAAQu2E,SAASE,EAAMK,SAAS92E,EAAQg2E,aAAah2E,EAAQg2E,UAAUz4E,WAAWnD,EAAUM,OAAO4zH,mBAAmB/wH,UAChIyC,EAAQg2E,UAAUtG,SAAS+G,EAAMyC,EACjCl5E,KAAAA,EAAQg2E,UAAUtG,SAAS+G,EAAM0C,EAAAA,KACjCn5E,EAAQg2E,UAAUtG,SAAS+G,EAAM2C,EACjCp5E,KAAAA,EAAQg2E,UAAUtG,SAAS+G,EAAM4C,EACjCr5E,KAAAA,EAAQg2E,UAAUtG,SAAS+G,EAAM6C,EAC1B,IAAA,aAEA,WATA,WAFA,YAFA,WAFA;AAAA,MAiBR,EAqgBsCg4C,GAAUnxH,EAAGsC,SAAAA;AAEjD,UADAie,EAAK5F,cAAc,mCAAmClI,QAAQ2+G,GAC3DA,MAAc,UAAS;AACzB,YAAIG;AACJ,gBAAQJ,EAASz7C,YAAYU,MAC5B;AAAA,UAAA,KAAKE,EAAMK;AACV46C,YAAAA,IAAa;AACb;AAAA,UACD,KAAKj7C,EAAMY;AACVq6C,YAAAA,IAAa;AACb;AAAA,UACD,KAAKj7C,EAAMa;AACVo6C,YAAAA,IAAa;AACb;AAAA,UACD,KAAKj7C,EAAMc;AACVm6C,YAAAA,IAAa;AAAA,QAGZA;AAAAA,QAAAA,MACFhxG,EAAK5F,cAAc,+BAAA,EAAiClI,QAAQ8+G,GAC5DhxG,EAAK5F,cAAc,+BAAiCu1G,EAAAA,cAAc,IAAI1oD,MAAM,QAG7E,CAAA;AAAA,MAAA;AAAA,IAEL,OAAQ;AACJ8nD,MAAAA,EAAe/uG,GAAM,MAAMvgB,CAAAA;AAC3B,YAAM0wH,IAAenwG,EAAK5F,cAAc,iCAAA;AACrC+1G,MAAAA,MACFA,EAAaj+G,QAAQ;AAAA,IAEtB;AACD,UAAMi+G,IAAenwG,EAAK5F,cAAc,iCACrC+1G;AAAAA,IAAAA,KACFA,EAAaR,cAAc,IAAI1oD,MAAM;EAGtC,GACD/0C,WAAW,SAAUlS,GAAMvgB,GAAAA;AAC1B,UAAM0wH,IAAenwG,EAAK5F,cAAc,iCAAA;AACxC,QAAI4F,EAAK2wG,WAAaR,KAAgBA,EAAaj+G,UAAU;AAwB5DzS,MAAAA,EAAGmV,QAAQnV,EAAGmV,QAAQ,IACtBnV,EAAGsC,YAAYtC,EAAGvE;AAAAA,SAzBqD;AACvE,UAAIggC,IAAKxhC,EAAUu4B,YAAuB,UAAEi+F,KACxCe,IAAe,CAAA;AAiCtB,OAAA,WAAA;AACC,YAAIC,IAAcx3H,EAAUk4B,YAAY,MACnCs/F;AAQL,YARKA,MACJA,IAActB,EAAsB,MAAA,IAEhCsB,MACJA,IAActB,EAAsB,eAAA,KAIhCsB;AACJ,gBAAM,IAAInnH,MAAM,CAAC,iLAChB,yLACA,8DACA,IACA,0CACA,gEACC5C,EAAAA,KAAK;AAAA;AAGR,eAAO+pH;AAAAA,MACP,GAlDcl/F,EAAAA,SAASi/F,IACrB/1F,EAAGv0B,QAAQsqH,EAAah2H;AACxB,YAAMwxC,IAAU0jF,IAAeA,EAAaj+G,QAAQ,UAC9Ci/G,IAAa5C,EAAY9hF,GAASvR,GAAIlb,CAAAA;AAC5CvgB,MAAAA,EAAGmV,QAAQ,IAAImhE,EAAMo7C,EAAWv8G,KAAO9B,EAAAA,SAAAA,EAAWvB,QAAQ,UAAU,EAAA,GACpE2pB,EAAGt0B,MAAMuqH,EAAWlgD,OAEpBxxE,EAAG2W,WAAWtN,KAAK+D,OAAOokH,EAAa/1H,WAAW+1H,EAAah2H,cAAc,GAAA,GAEzEigC,EAAGk2F,UACN3xH,EAAGxE,aAAa,IAAIiB,KAAKg/B,EAAGv0B,QAC5BlH,EAAGypH,cAAc,IAAIhtH,KAAKg/B,EAAGv0B,QAC7Bu0B,EAAGk2F,SAAAA,MAEH3xH,EAAGypH,cAAc,MAElBzpH,EAAGsC,YAAYm5B,EAAGt0B;AAAAA,IACtB;AAKG,WAAOnH,EAAGmV;AAAAA,EACV,GAEDme,OAAO,SAAU/S,GAChB;AAAA,EAAA,EAAA;AAoCH,G5C/pDCqxG,kB6CxEc,SAAS33H;AAwqBxB,WAAS43H,IAAAA;AACR,QAAIxwG,IAAmBpnB,EAAUk4B,YAAY,WAAA;AAK7C,QAJI9Q,MACHA,IAAmB8uG,EAAsB,WAAA,IAAA,CAGrC9uG;AACJ,YAAM,IAAI/W,MAAM,CAAC,4CACjB,0JACA,wDACF,IACA,0CACA,6BACA,IAAM5C,EAAAA,KAAK;AAAA;AAIV,WAAO2Z;AAAAA,EACR;AAEA,WAAS8uG,EAAsBrwH,GAC9B;AAAA,aAAQ3C,IAAI,GAAGA,IAAIlD,EAAUM,OAAO63B,SAAS92B,SAAS8B,QAAQD,KAAI;AACjE,UAAI8B,IAAUhF,EAAUM,OAAO63B,SAAS92B,SAAS6B,CAAAA;AACjD,UAAG8B,EAAQa,SAASA;AACnB,eAAO7F,EAAUk4B,YAAYlzB,EAAQuT,IAEtC;AAAA,IAAA;AACD,WAAO;AAAA,EACR;AAoBA,WAASk2G,EAAkBzsH,GAAAA;AAE1B,WAAO,IAAIQ,KACVR,EAAKkb,YAAAA,GACLlb,EAAKmb,SAAAA,GACLnb,EAAK6F,QACL7F,GAAAA,EAAKmI,YACLnI,EAAKyJ,WAAAA,GACLzJ,EAAKouB,WACL,GAAA,CAAA;AAAA,EAEF;AAGA,MACKg/F;AAruBLpvH,IAAUM,OAAOu3H,8BAAAA,IACjB73H,EAAUM,OAAO4zH,qBAAqB,CAAC,GAAE,GAAE,GAAE,GAAE,CAAA,GAC/Cl0H,EAAUu4B,YAAuB,YAAI,EACpC49F,WAAY,SAAS7vG;AACpB,QAAmB,OAARA,KAAQ,UAAS;AAC3B,UAAIxiB,IAAU9D,EAAU4b,UAAU8E,cAAc,IAAI4F,CAChDxiB,EAAAA;AAAAA,MAAAA,MAGHA,IAAU8J,SAAS8/B,eAAepnB,CAEnCA,IAAAA,IAAOxiB;AAAAA,IACP;AAGD,WAFIwiB,EAAKrlB,MAAMkgB,WAAW,WACzBmF,EAAKrlB,MAAMkgB,UAAU,KACfmF;AAAAA,EACP,GACD8vG,aAAa,SAAS9vG;AACrB,WAAOA,EAAKuyF,cAGU5zG,IAHgBqhB,IAIjCjb,IAAMuC,SAASC,cAAc,KAC7BE,GAAAA,YAAa9I,EAAE7B,UAAAA,MACnBwe,IAAIvW,EAAIyC,WACRzC,IAAM,MACCuW;AALR,QAAsB3c,GACoB2c,GAArCvW;AAAAA,EAML,GACDuK,QAAO,SAASwjB,GACf;AAAA,QAAGA,EAAIqrB,MAAK;AACX,UAAI4xE,IAAMr2H,EAAUu4B,YAAuB,WACvCksB,IAAO4xE,EAAIF,UAAU/8F,EAAIqrB,IAAAA,GACzB/iD,IAAO20H,EAAID,YAAY3xE;AAE3B,aADAA,EAAKxjD,MAAMkgB,UAAU,QACdzf;AAAAA,IACP;AACD,QAAI40H,IAAMt2H,EAAU0tB,OAAOwN;AAC3B,WAAO,6JAGsFo7F,EAAIz+E,mBAH1F,yGAIsFy+E,EAAIx+E,oBAJ1F,mHAKgGw+E,EAAIv+E,qBALpG,0GAMuFu+E,EAAIt+E,oBAN3F,sOAYsFs+E,EAAIr+E,wBAZ1F,4FAaiFq+E,EAAIp+E,wBAbrF,gHAc8Fo+E,EAAIn+E,yBAdlG,uFAiBcm+E,EAAIl+E,cAjBlB,4FAkBQk+E,EAAIj+E,yBAlBZ,wJAqBmGi+E,EAAIp8E,kBAAkB,CAAA,IArBzH,+GAsB+Fo8E,EAAIp8E,kBAAkB,KAtBrH,wHAuBmGo8E,EAAIp8E,kBAAkB,CAvBzH,IAAA,+GAwB+Fo8E,EAAIp8E,kBAAkB,CAxBrH,IAAA,wHAyBmGo8E,EAAIp8E,kBAAkB,CAAA,IAzBzH,+GA0B+Fo8E,EAAIp8E,kBAAkB,KA1BrH,wHA2BmGo8E,EAAIp8E,kBAAkB,CAAA,IA3BzH,mMAgCyHo8E,EAAIh+E,0BAhC7H,4FAiCkFg+E,EAAI99E,wBAjCtF,8FAkCoF89E,EAAI79E,0BAlCxF,mJAmCkI69E,EAAI/9E,2BAnCtI,qJAuCiCv4C,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CAAA,IAC9D,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CAAA,IACpD,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CACpD,IAAA,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CACpD,IAAA,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CACpD,IAAA,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CACpD,IAAA,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,KACrD,cACAsmG,EAAI59E,kCA/CL,+FAiDqF49E,EAAI39E,iCAjDzF,iMAoDuH29E,EAAIr+E,wBApD3H,2FAqDgFq+E,EAAIx9E,uBArDpF,0EAwDgCw9E,EAAIr8E,oBAAoB,KACvD,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,KAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,KAC7C,wBAAsBq8E,EAAIr8E,oBAAoB,EAC9C,IAAA,wBAAsBq8E,EAAIr8E,oBAAoB,EAAA,IAC/C,cACAq8E,EAAIv9E,oBArEJ,iJAuE+Hu9E,EAAI19E,oBAvEnI,2IA0E+B54C,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CAC9D,IAAA,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,KACpD,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,KACpD,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CAAA,IACpD,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CAAA,IACpD,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CACpD,IAAA,uBAAqBhwB,EAAU0tB,OAAO1rB,KAAKguB,SAAS,CACrD,IAAA,cACAsmG,EAAIz9E,mBAlFH,4DAoF+By9E,EAAIr8E,oBAAoB,CACvD,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,KAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,KAC7C,uBAAqBq8E,EAAIr8E,oBAAoB,CAC7C,IAAA,uBAAqBq8E,EAAIr8E,oBAAoB,CAAA,IAC7C,wBAAsBq8E,EAAIr8E,oBAAoB,EAAA,IAC9C,wBAAsBq8E,EAAIr8E,oBAAoB,MA/F9C,sLAsG8Eq8E,EAAIt9E,mBAtGlF,0FAuGuEs9E,EAAIp9E,oBAvG3E,4FAwGgFo9E,EAAIwB,+BAxGpF,kFAyGuExB,EAAIn9E,oBAzG3E,kFA0GsEn5C,EAAUM,OAAO01H,qBA1GvF;AAAA,EA+GP,GACDQ,KAAK,CAAE,GACPuB,gBAAgB,SAAS3sH,GAAKmN,GAAMC;AACnC,QAAI2wB,IAAM/9B,EAAImN,CACd;AAAA,QAAA,CAAI4wB;AAAK,aAAO;AAChB,QAAGA,EAAI3hB;AAAU,aAAO2hB;AAExB,QAAGA,EAAIhmC;AACN,eAAQD,IAAE,GAAGA,IAAIimC,EAAIhmC,QAAQD;AAC5B,YAAGimC,EAAIjmC,CAAAA,EAAGsV,SAASA;AAClB,iBAAO2wB,EAAIjmC,CAAAA;AAAAA;AAAAA,EAGd,GACD80H,iBAAiB,SAAS5sH,GAAKmN,GAAM6tG;AACpC,QAAIj9E,IAAM/9B,EAAImN,CACd;AAAA,QAAA,CAAI4wB;AAAK,aAAO;AAChB,QAAGA,EAAIhmC,QAAO;AACb,UAAGijH,GAAY;AAEd,iBADIh/G,IAAM,CACDlE,GAAAA,IAAI,GAAGA,IAAIimC,EAAIhmC,QAAQD;AAC3BimC,UAAAA,EAAIjmC,CAAGm4B,EAAAA,WAASj0B,EAAIzE,KAAKwmC,EAAIjmC,CAAGsV,EAAAA,KAAAA;AAErC,eAAOpR;AAAAA,MACX;AACI,WAASlE,IAAI,GAAGA,IAAIimC,EAAIhmC,QAAQD;AAC/B,YAAIimC,EAAIjmC,CAAAA,EAAGm4B;AAAS,iBAAO8N,EAAIjmC,CAAGsV,EAAAA;AAAAA,IAEpC;AAED,WAAG2wB,EAAI3wB,QACE4tG,IAA0B,CAACj9E,EAAI3wB,KAAAA,IAAjB2wB,EAAI3wB,QAAAA;AAAAA,EAC3B,GAEDy/G,yBAAyB,SAAS7sH,GAAKmN,GAAAA;AAEtC,WAAiB,IADLvY,EAAUu4B,YAAuB,UAAEy/F,gBAAgB5sH,GAAKmN,MAC7C;AAAA,EACvB,GAED2/G,iBAAiB,SAAS9sH,GAAKmN,GAAMC,GACpC;AAAA,QAAI2wB,IAAM/9B,EAAImN,CACd;AAAA,QAAI4wB;AAEJ,UAAGA,EAAI5wB,QAAQA;AACd4wB,QAAAA,EAAI3wB,QAAQA;AAAAA,eACJ2wB,EAAIhmC;AAEZ,iBADIg1H,IAAoB3/G,OAAAA,KAAS,UACxBtV,IAAI,GAAGA,IAAIimC,EAAIhmC,QAAQD;AAAAA,WAC3Bi1H,KAAchvF,EAAIjmC,CAAGsV,EAAAA,SAASA,OACjC2wB,EAAIjmC,CAAAA,EAAGm4B,UAAU88F,IAAe3/G,CAAAA,CAAAA,EAAM2wB,EAAIjmC,CAAGsV,EAAAA,KAAAA,IAAAA,CAAAA,CAAWA;AAAAA;AAAAA,EAG3D,GAED+9G,iBAAgB,SAASjwG,GAAM9N,GAAOzS,GAAAA;AACrC,QAAI4H,IAAQ3N,EAAUu4B,YAAuB,WACzCC,IAAY7qB,EAAMqqH,iBAClBt/F,IAAY/qB,EAAMuqH;AACtBl4H,MAAUu4B,YAAuB,UAAEi+F,MAAM,EAACvpH,OAAMlH,EAAGxE,YAAY2L,KAAInH,EAAGsC,UAEtE;AAAA,QAAI+vH,IAAkBp4H,EAAUgC,KAAKuuB,YAAYvwB,EAAUM,OAAOyyH,iBAAoB,EAAA,GAQlFsF,IAAWr4H,EAAUgC,KAAK0tB,YAAY1vB,EAAUM,OAAOyyH,WAAAA,GAEvD7xH,IAAMolB,EAAKwS,qBAAqB,QAAQ,CACxC1tB,GAAAA,IAAM,CAAA;AAEV,aAASktH,EAAaC,GACrB;AAAA,eAASr1H,IAAI,GAAGA,IAAIq1H,EAAKp1H,QAAQD,KAAK;AACrC,YAAI0gH,IAAM2U,EAAKr1H,CAEf;AAAA,YAAG0gH,EAAIrrG;AACN,cAAInN,EAAIw4G,EAAIrrG,IAAAA;AAEN,gBAAGnN,EAAIw4G,EAAIrrG,IAAAA,EAAM2T,UAAS;AAC/B,kBAAI5F,IAAOlb,EAAIw4G,EAAIrrG;AACnBnN,cAAAA,EAAIw4G,EAAIrrG,IAAQ,IAAA,CAAC+N,GAAMs9F,CAAAA;AAAAA,YAE7B;AACMx4G,cAAAA,EAAIw4G,EAAIrrG,MAAM5V,KAAKihH,CAAAA;AAAAA;AANnBx4G,YAAAA,EAAIw4G,EAAIrrG,IAAAA,IAAQqrG;AAAAA,MAUlB;AAAA,IACD;AAKD,QAHA0U,EAAap3H,EAAI43B,qBAAqB,WACtCw/F,EAAap3H,EAAI43B,qBAAqB,QAEjC94B,CAAAA,GAAAA,CAAAA,EAAUM,OAAO01H,oBAAoB;AACzC,UAAID,IAAY/1H,EAAUgC,KAAK0tB,YAAY1vB,EAAUM,OAAOyyH;AAC5D/yH,QAAUM,OAAO01H,qBAAqBD,EAAU/1H,EAAUgC,KAAKC,IAAIjC,EAAU+J,aAAAA,GAAgB,IAAI,KACjG,CAAA;AAAA,IAAA;AACD2uB,IAAAA,EAAUttB,GAAK,eAAepL,EAAUM,OAAO01H,kBAE/C;AAAA,QAAIxhE,IAAI,SAASryC,GAAAA;AAChB,aAAOniB,EAAU4b,UAAU8E,cAAc,IAAIyB,CAAAA,EAAAA,KAAQ,EAAElhB,OAAM,CAAA,EAAA;AAAA,IAChE;AAEE,aAASu3H,IAAAA;AACRhkE,MAAAA,EAAE,gBAAkBvzD,EAAAA,MAAMkgB,UAAU,QACpCqzC,EAAE,iBAAmBvzD,EAAAA,MAAMkgB,UAAU,QACrCqzC,EAAE,kBAAoBvzD,EAAAA,MAAMkgB,UAAU,QACtCqzC,EAAE,mBAAmBvzD,MAAMkgB,UAAU,QACrCqzC,EAAE,gBAAgBlrD,KAAKkP,OAAOvX,MAAMkgB,UAAU,IAC9CnhB,EAAUkgC,gBAAAA;AAAAA,IACV;AAsED,aAASu4F,EAAartH,GAAKoN,GAAAA;AAC1B,UAAItL,IAAM9B,EAAS;AAEnB,UAAG8B,EAAI/J;AAEN,YADmB+J,EAAI,CAAGsL,EAAAA,SAAStL,EAAI,CAAGsL,EAAAA,SAAS;AAElD,mBAAQtV,IAAG,GAAGA,IAAIgK,EAAI/J,QAAQD;AAC1BgK,YAAAA,EAAIhK,CAAGsV,EAAAA,SAASA,MAClBtL,EAAIhK,GAAGm4B,UAAU;AAAA,aAEf;AACJ,cAAIxU,IAAM;AACV,kBAAOrO,GAAAA;AAAAA,YACN,KAAK;AACJqO,cAAAA,IAAM;AACN;AAAA,YACD,KAAK;AACJA,cAAAA,IAAM;AACN;AAAA,YACD;AACCA,cAAAA,IAAM;AAAA,UAAA;AAGR3Z,UAAAA,EAAI2Z,CAAAA,EAAKwU,UAAU;AAAA,QACnB;AAAA;AAEDnuB,QAAAA,EAAIsL,QAAQA;AAAAA,IAEb;AAGDxY,MAAUu4B,YAAuB,UAAEmgG,mBAnGnC,SAAyBvrH,GACxB;AAAA,UAAI0O,IAAO,CAAC2c,EAAUptB,GAAK,QAG3B,CAAA;AAAA,WAFAutH,EAAU98G,EAAK,CAAA,CAAA,EAAIA,GAAM1O,CAAAA,GAElB0O,EAAK1Y,SAAS;AAAG0Y,QAAAA,EAAKlZ,KAAK;AAClC,UAAI6yE,IAAS,IAETtoE,IAqCL,SAAsB9B,GACrB;AAAA,YAAI8B,IAAM9B,EAAS;AACnB,YAAG8B,EAAI/J;AACN,mBAAQD,IAAG,GAAGA,IAAIgK,EAAI/J,QAAQD;AAC7B,gBAAGgK,EAAIhK,CAAGm4B,EAAAA;AACT,qBAAGnuB,EAAIhK,CAAAA,EAAGsV,SAAStL,EAAIhK,CAAGsV,EAAAA,SAAS,OAC3BtL,EAAIhK,CAAAA,EAAGsV,QAEVtV,IAEKA,KAAK,IACN,gBAEA,qBAJA;AAAA,mBAURgK,EAAIsL;AACN,iBAAOtL,EAAIsL;AAEb,eAAO;AAAA,MACP,EA5DuBpN,CAEvB;AAAA,aAAI8B,KAAO,QACVC,EAAMD,MAAM,IAAI1K,KAAK,MAAM,GAAG,CAC9BgzE,GAAAA,IAAS,QAEDtoE,KAAO,gBACfC,EAAMD,MAnEO,SAAS0rH,GAAAA;AACvB,YAAI52H,IAAOo2H,EAAgBQ,CAG3B;AAAA,eAFI54H,EAAUM,OAAO2zH,mBACpBjyH,IAAOhC,EAAUgC,KAAKC,IAAID,GAAM,GAAG,SAC7BA;AAAAA,MACV,EA8DyBw2B,EAAUptB,GAAK,mBAGpCpL,EAAU64H,eAAeh9G,EAAKpO,KAAK,GAAA,CAAA,GACnC+nE,IAASpmE,KAAKC,IAAI,GAAGmpB,EAAUptB,GAAK,sBAqBpC+B,EAAMD,MAAMlN,EAAUgC,KAAK,SAAS6Z,EAAKpO,KAAK,GAAM,CAAA,EAAA,IAAIjL,KAAK2K,EAAMF,KAAAA,GAAQuoE,IAnB9D,GAmB+E,EAACj0E,YAAY4L,EAAMF,MAAWE,CAAAA,KAAAA,EAAMF,QAG1H4O,EAAKpO,KAAK,GAAA,IAAO,MAAM+nE;AAAAA,IAC9B;AAyDD,QAAImjD,IAAY,EACf/4F,OAAM,SAAS/jB,GAAM1O,GAAAA;AACpB,UAAIqrB,IAAYx4B,EAAUu4B,YAAuB,UAAEy/F,iBAC/Cc,IAAoB94H,EAAUu4B,YAAuB,UAAE0/F;AAEvB,MAAhCz/F,EAAUptB,GAAK,YAClByQ,KADmC,OACnCA,EAAKlZ,KAAKyM,KAAKC,IAAI,GAAGypH,EAAkB1tH,GAAK,aAAA,CAAA,CAAA,GAC7C+B,EAAMF,MAAM6hB,QAAQ0J,EAAUptB,GAAK,WAAA,CAAA,MAEnCyQ,EAAKlZ,KAAKyM,KAAKC,IAAI,GAAGypH,EAAkB1tH,GAAK,mBAC7CyQ,EAAKlZ,KAAM61B,EAAUptB,GAAK,YAAA,CAAA,GAC1ByQ,EAAKlZ,KAAKyM,KAAKC,IAAI,GAAGypH,EAAkB1tH,GAAK,aACxCpL,CAAAA,CAAAA,GAAAA,EAAUM,OAAOy4H,kBACrB5rH,EAAMF,MAAM6hB,QAAQ,CAAA,IAGtB3hB,EAAMuqH,SAAAA;AAAAA,IACN,GACD3M,MAAK,SAASlvG,GAAM1O;AACnB,UAAIqrB,IAAYx4B,EAAUu4B,YAAuB,UAAEy/F,iBAC/Cc,IAAoB94H,EAAUu4B,YAAuB,UAAE0/F;AAE3Dp8G,MAAAA,EAAKlZ,KAAKyM,KAAKC,IAAI,GAAGypH,EAAkB1tH,GAAK,YAC7CyQ,CAAAA,CAAAA,GAAAA,EAAKlZ,KAAK,EAAA,GACVkZ,EAAKlZ,KAAK,EAAA;AAQV,eAPI4P,IAAI,IAEJ42B,IAAM3Q,EAAUptB,GAAK,YAAA,EAErB6C,GAAAA,IAAMd,EAAMF,MAAMxF,OAAAA,GAClBuxH,QAEK91H,IAAI,GAAGA,IAAIimC,EAAIhmC,QAAQD;AAC/BqP,QAAAA,EAAE5P,KAAKwmC,EAAIjmC,CACX81H,CAAAA,GAAAA,IAAeA,KAAgB7vF,EAAIjmC,CAAAA,KAAM+K;AAErCsE,MAAAA,EAAEpP,WACNoP,EAAE5P,KAAKsL,CACP+qH,GAAAA,IAAAA,KAEDzmH,EAAEqY,KAAAA,GAGG5qB,EAAUM,OAAOy4H,iBAGVC,MACXh5H,EAAUi5H,mBAAmB9rH,EAAMF,OAAOsF,GAAG,GAAG,IAChDpF,EAAMuqH,SAAAA,OAJNvqH,EAAMF,QAAQjN,EAAUgC,KAAKY,WAAWuK,EAAMF,KAAAA,GAC9CE,EAAMuqH,SAAAA,KAMP77G,EAAKlZ,KAAK4P,EAAE9E,KAAK,GAAA,CAAA;AAAA,IACjB,GACDQ,KAAI,SAAS4N,GACZ;AAAA,UAAI2c,IAAYx4B,EAAUu4B,YAAuB,UAAEy/F,iBAC/Cc,IAAoB94H,EAAUu4B,YAAuB,UAAE0/F;AAEzB,MAA9Bz/F,EAAUptB,GAAK,UAClByQ,KADiC,MACjCA,EAAKlZ,KAAKyM,KAAKC,IAAI,GAAGypH,EAAkB1tH,GAAK,kBAG7CyQ,EAAKlZ,KAAK,MACVkZ,GAAAA,EAAKlZ,KAAK,CAAA,GACVkZ,EAAKlZ,KAAK,EAAA,GACVkZ,EAAKlZ,KAAK,EAAA,GACVkZ,EAAKlZ,KAAK3C,EAAUM,OAAO4zH,mBAAmBzmH,KAAK,GAAA,CAAA,GACnDoO,EAAKrK,OAAO,GAAG;IAEhB,GACDquB,MAAK,SAAShkB,GAAM1O,GAAAA;AACnB,UAAIqrB,IAAYx4B,EAAUu4B,YAAuB,UAAEy/F;AAEhB,MAA/Bx/F,EAAUptB,GAAK,WAAA,KAAgB,OAClCyQ,EAAKlZ,KAAK,GAAA,GACVwK,EAAMF,MAAM+hB,SAAS,CAAA,GACrB7hB,EAAMF,MAAM6hB,QAAQ0J,EAAUptB,GAAK,UAAA,CAAA,GACnC+B,EAAMF,MAAM+hB,SAASwJ,EAAUptB,GAAK,YAGpCyQ,CAAAA,MAAAA,EAAKlZ,KAAK,GACVkZ,GAAAA,EAAKlZ,KAAK61B,EAAUptB,GAAK,eACzByQ,EAAKlZ,KAAK61B,EAAUptB,GAAK,YAAA,CAAA,GACzB+B,EAAMF,MAAM6hB,QAAQ,IACpB3hB,EAAMF,MAAM+hB,SAASwJ,EAAUptB,GAAK,aAErC+B,CAAAA,IAAAA,EAAMuqH,SAAS;AAAA,IACf,KAEEwB,IAAY,EACfnO,MAAK,SAASlvG,GAAM1O;AACnB,UAAIurB,IAAY14B,EAAUu4B,YAAuB,UAAE2/F;AACnDx/F,MAAAA,EAAUttB,GAAK,cAAcyQ,EAAK,CAIlC,CAAA;AAAA,eAFItJ,IAAIsJ,EAAK,CAAGlY,EAAAA,MAAM,GAClBgO,GAAAA,IAAI,CAAA,GACCzO,IAAI,GAAGA,IAAIqP,EAAEpP,QAAQD;AAAKyO,QAAAA,EAAEY,EAAErP,CAAAA,CAAAA,IAAAA;AAEvCw1B,MAAAA,EAAUttB,GAAK,YAAYuG,CAAAA;AAAAA,IAI3B,GACDiuB,OAAM,SAAS/jB,GAAM1O,GACpB;AAAA,UAAIurB,IAAY14B,EAAUu4B,YAAuB,UAAE2/F;AAEnC,MAAZr8G,EAAK,OAAO,MACf6c,EAAUttB,GAAK,cAAc,GAC7BstB,GAAAA,EAAUttB,GAAK,eAAeyQ,EAAK,CAAA,CAAA,GACnC6c,EAAUttB,GAAK,aAAa+B,EAAMF,MAAMpF,QAAAA,CAAAA,MAExC6wB,EAAUttB,GAAK,cAAc,GAC7BstB,GAAAA,EAAUttB,GAAK,gBAAgByQ,EAAK,CACpC6c,CAAAA,GAAAA,EAAUttB,GAAK,eAAgByQ,EAAK,KACpC6c,EAAUttB,GAAK,cAAcyQ,EAAK,CAEnC,CAAA;AAAA,IAAA,GACD5N,KAAI,SAAS4N,GAAM1O;AAClB,UAAIurB,IAAY14B,EAAUu4B,YAAuB,UAAE2/F;AACnDx/F,MAAAA,EAAUttB,GAAK,YAAY,MAC3BstB,EAAUttB,GAAK,aAAayQ,EAAK,CAAA,CAAA;AAAA,IACjC,GACDgkB,MAAK,SAAShkB,GAAM1O,GAAAA;AACnB,UAAIurB,IAAY14B,EAAUu4B,YAAuB,UAAE2/F;AAEnC,MAAZr8G,EAAK,OAAO,MACf6c,EAAUttB,GAAK,aAAa,GAAA,GAC5BstB,EAAUttB,GAAK,YAAY+B,EAAMF,MAAMpF,YACvC6wB,EAAUttB,GAAK,cAAc+B,EAAMF,MAAMkQ,SAGzCub,CAAAA,MAAAA,EAAUttB,GAAK,aAAa,MAC5BstB,EAAUttB,GAAK,cAAcyQ,EAAK,CAAA,CAAA,GAClC6c,EAAUttB,GAAK,aAAayQ,EAAK,CAAA,CAAA,GACjC6c,EAAUttB,GAAK,eAAe+B,EAAMF,MAAMkQ;IAE3C,EA2CFnd;AAAAA,MAAUu4B,YAAuB,UAAE4gG,mBAxCnC,SAAyBt9G,GAAM1O,GAC9B;AAAA,UAAIurB,IAAY14B,EAAUu4B,YAAuB,UAAE2/F,iBAC/CtoH,IAAOiM,EAAKlY,MAAM,GAAA;AAItB,cAHAkY,IAAOjM,EAAK,CAAA,EAAGjM,MAAM,GACrBu1H,GAAAA,EAAUr9G,EAAK,CAAIA,CAAAA,EAAAA,GAAM1O,IAEjByC,EAAK,CAAA,GAAA;AAAA,QACZ,KAAK;AACJ6oH,UAAAA,EAAartH,GAAK,IAClB;AAAA;AAAA,QACD,KAAK;AACJqtH,UAAAA,EAAartH,GAAK,aAElB;AAAA,cAAI5J,IAAW2L,EAAMD;AACjBlN,YAAUM,OAAO2zH,mBACpBzyH,IAAWxB,EAAUgC,KAAKC,IAAIT,OAAc,KAAA,IAE7Ck3B,EAAUttB,GAAK,eAAeitH,EAAS72H;AAEvC;AAAA,QACD;AACCi3H,UAAAA,EAAartH,GAAK,kBAAA,GAClBstB,EAAUttB,GAAK,oBAAoBwE,EAAK,CAAA,CAAA;AAAA,MAAA;AAK1C8oB,MAAAA,EAAUttB,GAAK,UAAUyQ,EAAK,CAAA,CAAA;AAG9B,UAAIyK,IAAOtmB,EAAUu4B,YAAuB,UAAEw/F,eAAe3sH,GAAK,UAAUyQ,EAAK,CAAA,CAAA;AAC7D,MAAjByK,EAAKkB,YAAY,YAEnBlB,EAAK2vG,cAAc,IAAI1oD,MAAM,QAC7BjnD,CAAAA,GAAAA,EAAK2vG,cAAc,IAAImD,WAAW,OAAA,CAAA,KAElC9yG,EAAK2vG,cAAc,IAAImD,WAAW,OAEnC,CAAA;AAAA,IAAA;AAID,aAASl2H,IAAI,GAAGA,IAAIhC,EAAIm4H,SAASl2H,QAAQD,KAAK;AAC7C,UAAIgiB,IAAKhkB,EAAIm4H,SAASn2H,CACtB;AAAA,MAAQgiB,EAAG3M,SACL,aACA2M,EAAGsC,YAAY,YAAatC,EAAG5F,kBAGxB4F,EAAG5F,oBACb4F,EAAG5F,kBAAkB,IACrB4F,EAAGC,iBAAiB,SAASqzG,CAAAA,MAJ7BtzG,EAAG5F,kBAAkB,IACrB4F,EAAGC,iBAAiB,UAAUqzG;IAOjC;AACDx4H,MAAU4b,UAAUm7G,iBAAAA;AAAAA,EACpB,GACDr+F,WAAU,SAASpS,GAAM9N,GAAOzS,GAC/B;AAAA,QAAIixH,IAAKh3H,EAAUu4B,YAAuB;AACrCv4B,MAAU4b,UAAUm7G,kBACxBC,EAAGT,gBAAgBjwG,GAAM9N,GAAOzS,CACjCugB,GAAAA,EAAKiwC,QAAQxwD,EAAGqC,UAEhBke,EAAK2wG,UAAU3tH,KAAKgwH,uBAAuBvzH;AAE3C,QAAIy7B,IAAKw1F,EAAGR;AACZh1F,IAAAA,EAAGv0B,QAAQlH,EAAGxE,YACdigC,EAAGt0B,MAAMnH,EAAGsC,WAEZ2uH,EAAGuC,cAEC/gH,GAAAA,KACHw+G,EAAGmC,iBAAiB3gH,GAAOgpB;EAC5B,GACDhJ,WAAU,SAASlS,GAAMvgB,GACxB;AAAA,QAAIugB,EAAKiwC,MAAM;AACd,UAAI/0B,IAAKxhC,EAAUu4B,YAAuB,UAAEi+F,KACxCe,IAAe,CAAA;AA4EtB,OAAA,WAAA;AACC,YAAIC,IAAcx3H,EAAUk4B,YAAY,MACpCs/F;AAQJ,YARIA,MACHA,IAActB,EAAsB,MAAA,IAEjCsB,MACHA,IAActB,EAAsB,eAAA,KAIhCsB;AACJ,gBAAM,IAAInnH,MAAM,CAAC,iLACnB,yLACA,8DACA,IACA,0CACA,gEAAA,EACC5C,KAAK;AAAA,CAGL,CAAA;AAAA,eAAO+pH;AAAAA,MACR,GA/FqBgC,EAENlhG,SAASi/F,CACrB/1F,GAAAA,EAAGv0B,QAAQsqH,EAAah2H,YACxBwE,EAAGqC,WAAWpI,EAAUu4B,YAAuB,UAAEmgG,iBAAiBl3F,CAAAA,GAC9DA,EAAGk2F,UACN3xH,EAAGxE,aAAa,IAAIiB,KAAKg/B,EAAGv0B,QAC5BlH,EAAGypH,cAAc,IAAIhtH,KAAKg/B,EAAGv0B,QAC7Bu0B,EAAGk2F,SAAAA,MAEH3xH,EAAGypH,cAAc,MAElBzpH,EAAGsC,YAAYm5B,EAAGt0B,KAClBnH,EAAGouC,cAAcpuC,EAAGqC,SAASzE,MAAM,GAAK,EAAA,CAAA;AAAA,IAC3C;AACGoC,MAAAA,EAAGqC,WAAWrC,EAAGouC,cAAc,IAC/BpuC,EAAGsC,YAAYtC,EAAGvE;AAEnB,WAAOuE,EAAGqC;AAAAA,EACV,GACDqxH,aAAa;AAEZ,WADW7B,EAAAA,EAAsBv/F,OACrBpoB,WAAWA;AAAAA,EACvB,GACDypH,WAAW,WAAA;AACV,WAAO9B,EAAAA,EAAsBtxG;AAAAA,EAC7B,GACDiwC,MAAK,WACJ;AAAA,QAAI5oD,IAAQ3N,EAAUu4B,YAAYoI;AAEvBhzB,IAAAA,EAAM+rH,UAAAA,EACRnjE,QACR5oD,EAAM4rH,cACP;AAAA,EAAA,GACD9hH,OAAO,WACN;AAAA,QAAI9J,IAAQ3N,EAAUu4B,YAAYoI;AAEvBhzB,IAAAA,EAAM+rH,UAAAA,EAETnjE,QACP5oD,EAAM4rH,cAAAA;AAAAA,EACP,GACDA,eAAe,WAAA;AACd,QAAI5rH,IAAQ3N,EAAUu4B,YAAYoI,WAE9BmgF,IAAOnzG,EAAM+rH,UAAAA,GAChBx0G,IAAKvX,EAAM8rH;AACP3Y,IAAAA,EAAKvqD,QAASuqD,EAAKmW,WAOvBnW,EAAK7/G,MAAM8N,SAAS,OACjBmW,MACFA,EAAGjkB,MAAM04H,qBAAqB,aAC9Bz0G,EAAGiF,YAAYrc,YAAY9N,EAAU0tB,OAAOwN,OAAOkc,sBATpD0pE,EAAK7/G,MAAM8N,SAAS,QACjBmW,MACFA,EAAGjkB,MAAM04H,qBAAqB,YAC9Bz0G,EAAGiF,YAAYrc,YAAY9N,EAAU0tB,OAAOwN,OAAOmc,yBASrDypE,EAAKvqD,OAAAA,CAAQuqD,EAAKvqD,MAElBv2D,EAAUkgC;EACV,GACD7G,OAAM,SAAS/S,GACd;AAAA,EAAA,GACDmY,cAAa,SAASnY,GAAMuB,GAAQznB;AACvBJ,MAAUu4B,YAAYoI,UACjB+4F,UACPzC,EAAAA,WACTj3H,EAAUu4B,YAAYoI,UAAU44F,cACjC;AAAA,EAAA,EAAA,GAyDFv5H,EAAUoxH,eAAe,CAAA,GACzBpxH,EAAUmxH,oBAAoB,CAAA,GAC9BnxH,EAAUirC,kBAAkB,SAASllC,GAAIozB,GAAAA;AACxCpzB,IAAAA,EAAG6wF,YAAYz9D,GACf7vB,KAAK8nH,aAAarrH,EAAG9C,EAAM8C,IAAAA,GACtBuD,KAAK6nH,kBAAkBprH,EAAGkV,eAAY3R,KAAK6nH,kBAAkBprH,EAAGkV,SAAa,IAAA,CAAA,IAClF3R,KAAK6nH,kBAAkBprH,EAAGkV,SAAWke,EAAAA,CAAAA,IAAQpzB;AAAAA,EAC9C,GACA/F,EAAUqxH,kBAAkB,SAASl4F,GAAMl2B,GAAAA;AAC1C,QAAIquH,IAAKhoH,KAAK6nH,kBAAkBluH,CAChC;AAAA,WAAIquH,IAAWA,EAAGn4F,CACX,IAAA;AAAA,EACR,GACAn5B,EAAUqb,mBAAmB,SAASpY,GACrC;AAAA,WAAQqG,KAAK6nH,kBAAkBluH,CAAAA,KAAO,CACvC;AAAA,EAAA,GAeAjD,EAAUkxH,YAAY,IAEjB9B,IAAgBpvH,EAAU6a,UAC9B7a,EAAU6a,WAAW,SAAStZ,GAAYC,GAAUgb,GAAMvZ,GAAIk2D,GAC7D;AAAA,QAAIo4D,IAAQnC,EAAcljH,MAAM5C,MAAM+I,SAEtC;AAAA,QAAIk/G,KAASvxH,EAAUyE,SAAS8sH,CAAQ,GAAA;AACvC,UAAIxrH,IAAK/F,EAAUyE,SAAS8sH,CAAAA;AAEzBxrH,MAAAA,EAAGxE,eACLwE,EAAGxE,aAAaktH,EAAkB1oH,EAAGxE,UAEnCwE,IAAAA,EAAGvE,aACLuE,EAAGvE,WAAWitH,EAAkB1oH,EAAGvE,YAEhC8H,KAAKgwH,uBAAuBvzH,MAC/B/F,EAAUirC,gBAAgBllC,GAAsB,MAAlBA,EAAGgjE,YAAAA,GAC9BhjE,EAAGqC,aACNrC,EAAGouC,cAAcpuC,EAAGqC,SAASzE,MAAM,GAAK,EAAA,CAAA;AAAA,IACzC;AACD,WAAO4tH;AAAAA,EACT,GAGAvxH,EAAUsE,YAAY,mBAAmB,SAASrB,GAAI8+B,GAAAA;AACrD,SAAIz4B,KAAKkoH,cAAT;AACAloH,WAAKkoH,eAAe,IAEjBxxH,EAAUoxH,aAAanuH,CAAAA,MAEzBjD,EAAUoxH,aAAarvF,CAAAA,IAAU/hC,EAAUoxH,aAAanuH,CAAAA,GAAAA,OACjDjD,EAAUoxH,aAAanuH,CAG5BjD,IAAAA,EAAUmxH,kBAAkBluH,CAC9BjD,MAAAA,EAAUmxH,kBAAkBpvF,CAAU/hC,IAAAA,EAAUmxH,kBAAkBluH,CAC3DjD,GAAAA,OAAAA,EAAUmxH,kBAAkBluH,CAAAA;AAGpC,eAASC,IAAI,GAAGA,IAAIoG,KAAK4nH,UAAU/tH,QAAQD;AACtC+sH,SAAAA,IAAM3mH,KAAK4nH,UAAUhuH,CACjB+X,GAAAA,aAAahY,MACpBgtH,EAAIh1G,YAAY8mB,GAChBz4B,KAAK0R,cAAci1G,EAAIhtH,IAAI8+B,IAAS,MAAMkuF,EAAIhtH,GAAGU,MAAM,KAAK,CAE7D,CAAA;AAED,eAAQT,KAAKoG,KAAK8nH,cAAa;AAC9B,YAAInB;AAAAA,SAAAA,IAAM3mH,KAAK8nH,aAAaluH,IACrB+X,aAAahY,MACnBgtH,EAAIh1G,YAAY8mB,GAChBkuF,EAAIwB,eAAe;AAAA,MAEpB;AAED,UAAIvsG,IAAKllB,EAAUoxH,aAAarvF,CAC7B7c;AAAAA,MAAAA,KAAMA,EAAGusG,iBACJvsG,OAAAA,EAAGusG,cACVx5G,WAAW,WAAA;AACV,YAAGjY,EAAUkiB;AACZ;AAEDliB,UAAUmJ,UAAU,kBAAkB,CAAC44B,GAAQ/hC,EAAUyE,SAASs9B,CAClE,CAAA,CAAA;AAAA,MAAA,GAAE,CAGGz4B,IAAAA,OAAAA,KAAKkoH;AAAAA,IAzCkB;AAAA,EA0C/B,CAAA,GACAxxH,EAAUsE,YAAY,gCAAgC,SAASrB,GAC9D;AAAA,QAAI8C,IAAKuD,KAAK7E,SAASxB,CAAAA;AACvB,QAAIqG,KAAKyqC,kBAAkB9wC,MAAQqG,KAAKgwH,uBAAuBvzH,MAAOA,EAAGqC,YAAYrC,EAAGqC,YAAY,QAAS;AAC5GnF,MAAAA,IAAKA,EAAGU,MAAM;AACd,UAAI0sH,IAAM/mH,KAAK+C,IACX6lC,GAAAA,IAAOjvC,EAAG,CAAA,IAAMA,EAAG,CAAA,IAAKmM,KAAKM,MAAM3J,EAAG6wF,YAAY,GAElD05B,GAAAA,IAAMhnH,KAAKs0D,YAAY73D,CAAAA;AAC3BuqH,MAAAA,EAAIrtH,KAAKotH,GACTC,EAAIr1G,YAAYlV,EAAGkV,aAAahY,EAAG,CACnC;AAAA,UAAI+iD,IAAY9T;AAChBo+E,MAAAA,EAAIvnD,eAAe/iB,GACnBsqE,EAAIloH,WAAWkoH,EAAIn8E,cAAc,QACjC7qC,KAAKuR,SAASy1G,CAAAA,GAEdhnH,KAAK2hC,gBAAgBqlF,GAAiB,MAAZtqE,CAAAA;AAAAA,IAC5B,OAAQ;AACFjgD,MAAAA,EAAGqC,YAAYkB,KAAKoS,gBACvBpS,KAAK6R,iBAAiBpV;AACvB,UAAI2rH,IAAMpoH,KAAK+R,iBAAiBpY,CAChC;AAAA,eAASC,KAAKwuH;AACTA,QAAAA,EAAInlH,eAAerJ,CAAAA,MACtBD,IAAKyuH,EAAIxuH,CAAAA,EAAGD,IACRqG,KAAK7E,SAASxB,CAAAA,KACjBqG,KAAKiS,YAAYtY,GAAAA;IAGpB;AACD,WAAA;AAAA,EACD,CACAjD,GAAAA,EAAUsE,YAAY,kBAAkB,SAASrB,GAAI8C;KAChDuD,KAAKyqC,kBAAkB9wC,MAAOqG,KAAKgwH,uBAAuBvzH,OACzD/F,EAAU0W,QAAQzT,CACrB8C,MAAAA,EAAGqC,WAAWrC,EAAGouC,cAAc,QAC/B7qC,KAAKg0B,SAASr6B,GAAI8C,CAAAA;AAAAA,EAGrB,IACA/F,EAAUsE,YAAY,kBAAkB,SAASrB,GAAI7C,GAAAA;AACpD,QAAIkJ,KAAKgtB;AAAU;AAEnB,QAAIvwB,IAAKuD,KAAK7E,SAASxB,CAEvB;AAAA,QAAIqG,KAAKyqC,kBAAkB9wC,IAAK;AAC3BA,MAAAA,IAAKA,EAAGU,MAAM,GAAA;AAAlB,UACI0sH,IAAM/mH,KAAK+C,IACf/C;AAAAA,WAAKitB,cAAc;AAEnB,UAAI+5F,IAAMhnH,KAAKs0D,YAAYx9D,CAC3BkwH;AAAAA,MAAAA,EAAIrtH,KAAKotH,GACTC,EAAIr1G,YAAYhY,EAAG,CACnB;AAAA,UAAI+iD,IAAY/iD,EAAG,CAAA;AACnBqtH,MAAAA,EAAIvnD,eAAe/iB,GACnBsqE,EAAIloH,WAAWkoH,EAAIn8E,cAAc,IAEjC7qC,KAAK2hC,gBAAgBqlF,GAAiB,MAAZtqE,IAC1B18C,KAAKuR,SAASy1G,IAEdhnH,KAAKitB,cAAAA;AAAAA,IAEP,OAAQ;AACHxwB,MAAAA,EAAGxE,eACLwE,EAAGxE,aAAaktH,EAAkB1oH,EAAGxE,UAAAA,IAEnCwE,EAAGvE,aACLuE,EAAGvE,WAAWitH,EAAkB1oH,EAAGvE,QAAAA,IAGhCuE,EAAGqC,YAAYkB,KAAKoS,gBACvBpS,KAAK6R,iBAAiBpV;AAEvB,UAAI2rH,IAAMpoH,KAAK+R,iBAAiBpY,CAChC;AAAA,eAASC,KAAKwuH;AACTA,QAAAA,EAAInlH,eAAerJ,CAAAA,MAAAA,OACfoG,KAAK8nH,aAAaM,EAAIxuH,CAAGD,EAAAA,EAAAA,GAChCqG,KAAKiS,YAAYm2G,EAAIxuH,CAAGD,EAAAA,IAAAA;aAGnBqG,KAAK6nH,kBAAkBluH;AAI9B,eADI2uH,IAAe,IACVjlH,IAAI,GAAGA,IAAIrD,KAAKo8B,UAAUviC,QAAQwJ;AACtCrD,aAAKo8B,UAAU/4B,CAAGxI,EAAAA,aAAamF,KAAKhJ,OAAO0C,eAAoBC,KAAAA,MAClE2uH;AAEGA,MAAAA,MACJtoH,KAAKq6C,aAAa;AAAA,IACnB;AACD,WAAO;AAAA,EACR,CACA3jD,GAAAA,EAAUsE,YAAY,gBAAgB,SAASrB,GAC9C;AAAA,QAAA,CAAKqG,KAAKgtB,UAAU;AACnB,UAAIvwB,IAAKuD,KAAK7E,SAASxB,CAAAA;AACnB8C,MAAAA,EAAGqC,YAAAA,CAAarC,EAAGgjE,gBACtBz/D,KAAK6R,iBAAiBpV,CAEvB;AAAA,IAAA;AACD;EACD,CAAA,GACA/F,EAAUsE,YAAY,eAAe,SAASrB,GAAI2M,GAAM2sG,GAAAA;AAIvD,WAHSjzG,KAAK7E,SAASxB,GACfmF,YAAYwH,CAAAA,EAAKxH,YAAakB,KAAKyqC,kBAAkB9wC,CAAAA,MAC5DqG,KAAKq6C,aAAa,OAAA;AAAA,EAEpB,CACA3jD,GAAAA,EAAUsE,YAAY,kBAAkB,SAASrB,GAChD;AAAA,QAAI8C,IAAKuD,KAAK7E,SAASxB,CAGvB;AAAA,WAFK8C,EAAGqC,aACPrC,EAAGqC,WAAWrC,EAAGouC,cAAcpuC,EAAGgjE,eAAehjE,EAAGkV,YAAY;EAElE,CAAA,GACAjb,EAAUsE,YAAY,iBAAiB,SAASrB,GAC/C;AAAA,QAAI8C,IAAKuD,KAAK7E,SAASxB,CAAAA;AACnB8C,IAAAA,EAAGqC,aACNkB,KAAK6R,iBAAiBpV,CAEtBuD,GAAAA,KAAK0M;EAEP,CACAhW,GAAAA,EAAUmb,mBAAmB,SAASpV,GAClCA;AAAAA,IAAAA,EAAGxE,eACLwE,EAAGxE,aAAaktH,EAAkB1oH,EAAGxE,UAAAA,IAEnCwE,EAAGvE,aACLuE,EAAGvE,WAAWitH,EAAkB1oH,EAAGvE,QAAAA,IAEpCuE,EAAGgjE,eAAe35D,KAAKM,OAAO3J,EAAGvE,SAASiB,YAAYsD,EAAGxE,WAAWkB,aAAa,GACjFsD,GAAAA,EAAGvE,WAAWuE,EAAGsC,WACbtC,EAAGypH,gBACNzpH,EAAGxE,WAAWytB,SAAS,CAAA,GACvBjpB,EAAGxE,WAAWutB,QAAQ/oB,EAAGypH,YAAY3nH,QACrC9B,CAAAA,GAAAA,EAAGxE,WAAWytB,SAASjpB,EAAGypH,YAAYryG,SACtCpX,CAAAA,GAAAA,EAAGxE,WAAW07C,YAAYl3C,EAAGypH,YAAYtyG;EAG3C,GAEAld,EAAU+zC,oBAAoB,SAAS9wC,GAAAA;AACtC,WAAOA,EAAGmW,SAAWjJ,EAAAA,QAAQ,GAC9B;EAAA,GACAnQ,EAAUs5H,yBAAyB,SAASvzH;AAC3C,WAAQA,EAAGkV,aAAalV,EAAGkV,aAAa;AAAA,EACzC,GAEAjb,EAAUkyH,mBAAmBlyH,EAAUu8B,cACvCv8B,EAAUu8B,eAAe,SAASt5B,GAAAA;AACjC,QAAIyqB,IAASpkB,KAAKokB,QACdxlB,IAAIlI,EAAUM,OAAO8xH,oBACrBrsH,IAAKuD,KAAK7E,SAASxB,CACnB8tH,GAAAA,IAAMhrH,EAAGkV,WACTo3G,IAAY/oH,KAAKyqC,kBAAkB9wC,CACnCovH;AAAAA,IAAAA,MACHtB,IAAM9tH,EAAGU,MAAM,KAAK,CAGrB;AAAA,QAAIi2H,IAAa,SAAS32H,GAAAA;AACzB,UAAI7C,IAAQJ,EAAUyE,SAASxB;AAG/B,aAFA7C,EAAMiI,YAAYjI,EAAMoB,UACxBpB,EAAMoB,WAAW,IAAIgB,KAAKpC,EAAMmB,WAAWkB,YAAiC,MAArBrC,EAAM2oE,eACtD/oE,EAAUkyH,iBAAiBjvH;IACpC;AAEC,SAAM8tH,KAAW,IAAJA,KAAU,MAAMhrH,EAAGqC;AAE/B,aAAOwxH,EAAW32H,CAEnB;AAAA,QAAA,CAAM8tH,KAAOA,MAAQ,OAARA,CAAmBrjG,EAAOwN,OAAOgc,qBAAqBhvC,KAAK,cAAgBA,KAAK,YAALA,CAAkBmqH;AAEzG,aAAO/oH,KAAK4oH,iBAAiBjvH,CAE9B;AAAA,QAAIiF,KAAK,OAAO;AACf,UAAIwrC,IAAOpqC;AACXtJ,QAAU0uC,SAAS,EAClBlyB,MAAMkR,EAAOwN,OAAOgc,mBACpBrY,OAAOnR,EAAOwN,OAAO2+F,yBACrB7qH,OAAO,SACPjE,UAAU,UACV+1B,SAAQ,CAACpT,EAAOwN,OAAOoc,oBAAoB5pB,EAAOwN,OAAOqc,wBAAwB7pB,EAAOwN,OAAO0b,WAC/FliC,GAAAA,UAAU,SAAS9S,GAClB;AAAA,gBAAA,CAAQA;UACP,KAAK;AACJ,mBAAOg4H,EAAW7I,CACnB;AAAA,UAAA,KAAK;AACJ,mBAAOr9E,EAAKw+E,iBAAiBjvH,CAC9B;AAAA,UAAA,KAAK;AACJ;AAAA,QAEF;AAAA,MAAA,EAAA,CAAA;AAAA,IAEJ;AACE22H,MAAAA,EAAW7I,CAEb;AAAA,EAAA,GAGA/wH,EAAU8yH,yBAAyB9yH,EAAU85D,oBAC7C95D,EAAU85D,qBAAqB,SAASC,GACvC;AAAA,aAAS72D,IAAI,GAAGA,IAAIoG,KAAK4nH,UAAU/tH,QAAQD;AACnCoG,aAAAA,KAAKoN,QAAQpN,KAAK4nH,UAAUhuH,CAAGD,EAAAA,EAAAA;AACvCqG,SAAK4nH,YAAY;AAEjB,QAAIlgF,IAAQ1nC,KAAKwpH,uBAAuB/4D,CAAAA,GACpCnnB,IAAM,CACV;AAAA,SAAS1vC,IAAI,GAAGA,IAAI8tC,EAAM7tC,QAAQD;AAC7B8tC,MAAAA,EAAM9tC,GAAGkF,WAER4oC,EAAM9tC,CAAGixC,EAAAA,eAAe,UAC3B7qC,KAAKypH,YAAY/hF,EAAM9tC,CAAAA,GAAI0vC,KAExBA,EAAIjwC,KAAKquC,EAAM9tC,CAErB,CAAA;AAAA,WAAO0vC;AAAAA,EACR,GAGA,WAAA;AACC,QAAIxkB,IAAMpuB,EAAU4I;AACpB5I,MAAU4I,gBAAgB,SAAS7C;AAClC,aAAIA,CAAAA,CAAAA,EAAGqC,YACAgmB,EAAI7Z,KAAKjL,MAAMvD,CAAAA;AAAAA,IACxB;AACC,QAAIktH,IAAmBjzH,EAAUiW;AACjCjW,MAAUiW,cAAc,SAAShT;AAChC,UAAI8C,IAAK/F,EAAUyE,SAASxB,CACzB8C;AAAAA,MAAAA,KAAMA,EAAGqC,aAGXrC,EAAGouC,eAAepuC,EAAGqC,YAAY,IAAIzE,MAAM,GAAA,EAAK,CAE7CoC,IAAAA,KAAMA,EAAGqC,YAAAA,CAAakB,KAAKyqC,kBAAkB9wC,CAAAA,IAChDjD,EAAU8oD,YAEVmqE,IAAAA,EAAiB1+G,KAAKjL,MAAMrG,CAAAA;AAAAA,IAE/B;AAAA,EACC,EAEDjD,GAAAA,EAAU85H,kBAAkB,EAC3B7rH,KAAI,GAAG88G,MAAK,GAAGnrF,OAAM,GAAGC,MAAK,GAE9B7/B,GAAAA,EAAUgC,KAAK+3H,WAAW,SAASjuE,GAAI79C,GAAK88G;AAC3Cj/D,IAAAA,EAAGh9B,QAAQ;AACX,QAAIkrG,IAAgBh6H,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKspD,CAGpDz6B,CAAAA,GAAAA,IAAa,IAANpjB,KAFX88G,IAAoB,KAAZA,IAAO,MACJj/D,EAAGrkD,OAAAA,IACqB;AACnCqkD,IAAAA,EAAGh9B,QAAQuC,KAAQ05F,IAAQ15F,IAAO,IAAKA,CAAAA;AACvC,QAAI4oG,IAAWj6H,EAAUgC,KAAK6sB,YAAY,IAAIrsB,KAAKspD;AACnD,WAAGkuE,EAAcv3H,cAAcw3H,EAASx3H,QAAAA;AAAAA,EAIzC,GACAzC,EAAUi5H,qBAAqB,SAASntE,GAAIhnC,GAAMo1G,GAAKpvH,GAAMqvH,GAE5D;AAAA,aADIC,KAAQtuE,EAAGrkD,aAAazH,EAAUM,OAAOsuB,kBAAkB,IAAI,MAAMsrG,GAChEh3H,IAAI,GAAGA,IAAI4hB,EAAK3hB,QAAQD;AAChC,UAAI4hB,EAAK5hB,CAAAA,IAAKk3H;AACb,eAAOtuE,EAAGh9B,QAAQg9B,EAAGjkD,QAAsB,IAAA,IAAVid,EAAK5hB,CAASk3H,IAAAA,KAAQtvH,IAAOovH,IAAMC,EAAAA;AAEtE7wH,SAAK2vH,mBAAmBntE,GAAIhnC,GAAMo1G,IAAMpvH,GAAM,MAAMovH,CACrD;AAAA,EAAA,GACAl6H,EAAU64H,iBAAiB,SAAShzH,GACnC;AAAA,QAAIw0H,IAAqB,eAAex0H;AACxC,QAAKyD,CAAAA,KAAKtH,KAAKq4H,CAAqB,GAAA;AACnC,UAAIC,IAAiBz0H,EAAKlC,MAAM,GAAA,GAE5B42H,IAAe,SAAS10H,GACxB20H,IAAoBlxH,KAAKwwH,gBAAgBQ,EAAe,CAAA,CAAA,IAAMA,EAAe,CAEjF;AAAA,UAAIA,EAAe,CAAoC,KAA9B,SAASA,EAAe,CAAc,KAAR,QAAQ;AAC9D,YAAIG,IAAW;AACf,YAAIH,EAAe,CAAA,MAClBG,IAAWH,EAAe,CAAG32H,EAAAA,MAAM,MAC/B3D,EAAUM,OAAOsuB,kBAAiB;AACrC,mBAAS1rB,IAAI,GAAGA,IAAIu3H,EAASt3H,QAAQD;AACpCu3H,YAAAA,EAASv3H,CAAoB,IAAA,IAAdu3H,EAASv3H,CAAW,KAAA;AACpCu3H,UAAAA,EAAS7vG,KACT;AAAA,QAAA;AAGFthB,aAAKtH,KAAKq4H,CAAsB,IAAA,SAASle,GAAIxJ,GAC5C;AAAA,cAAItlG,IAAQ+B,KAAK+D,OAAOw/F,EAAGlwG,QAAY05G,IAAAA,EAAG15G,QAhBxB,MAAA,QAgBsD+3H,EAMxE;AAAA,iBALIntH,IAAQ,KACX8uG,EAAGrtF,QAAQqtF,EAAGt0G,QAAAA,IAAYwF,IAAQmtH,CAC/BC,GAAAA,KACHz6H,EAAUi5H,mBAAmB9c,GAAIse,GAAU,GAAGD,CAExCre,GAAAA;AAAAA,QACX,GACG7yG,KAAKtH,KAAKu4H,KAAgB,SAASzuE,GAAI38B,GACtC;AAAA,cAAIgtF,IAAK,IAAI35G,KAAKspD,EAAGrpD,QAAAA,CAAAA;AACrB,cAAIg4H;AACH,qBAASvvE,IAAQ,GAAGA,IAAQ/7B,GAAK+7B;AAChClrD,gBAAUi5H,mBAAmB9c,GAAIse,GAAU,GAAGD,CAE/Cre;AAAAA;AAAAA,YAAAA,EAAGrtF,QAAQqtF,EAAGt0G,QAAAA,IAAYsnB,IAAMqrG,CAAAA;AAEjC,iBAAOre;AAAAA,QACX;AAAA,MACG;AAC6B,QAArBme,EAAe,CAAsC,KAAhC,WAAWA,EAAe,CACvDhxH,KAD6D,WAC7DA,KAAKtH,KAAKq4H,CAAAA,IAAsB,SAASle,GAAIxJ,GAAI+nB,GAChD;AAAA,cAAIrtH,IAAQ+B,KAAKg2C,MAA0B,KAAnButD,EAAGz1F,YAAAA,IAAqC,IAAhBy1F,EAAGx1F,SAAiB,IAAA,KAAyB,KAAnBg/F,EAAGj/F,YAAAA,IAAqC,IAAhBi/F,EAAGh/F,SAAAA,IAAiB,MAAEja,IAA0B,CAAA;AAOlJ,iBALImK,KAAS,MACZ8uG,EAAGrtF,QAAQ,CACXqtF,GAAAA,EAAGntF,SAASmtF,EAAGh/F,SAAAA,IAAa9P,IAAQmtH,CAG9Bx6H,IAAAA,EAAUgC,KAAKu4H,CAAAA,EAAcpe,GAAI,GAAGue;QAI/C,GACGpxH,KAAKtH,KAAKu4H,CAAgB,IAAA,SAASzuE,GAAI38B,GAAKurG,GAAgBC;AAO3D,cANIA,IAGHA,MAFAA,IAAe,GAKbA,IADY;AAEd,mBAAO;AAGR,cAAIxe,IAAK,IAAI35G,KAAKspD,EAAGrpD,QAAAA,CAAAA;AACrB05G,UAAAA,EAAGrtF,QAAQ,CAAA,GAGXqtF,EAAGntF,SAASmtF,EAAGh/F,aAAagS,IAAMqrG,CAAAA;AAClC,cAAII,IAAYze,EAAGh/F,SAAAA,GACf09G,IAAW1e,EAAGj/F,YAAAA;AAClBi/F,UAAAA,EAAGrtF,QAAQ4rG,EAAen5H,WAAWsG,QACjCyyH,CAAAA,GAAAA,EAAe,CAClBt6H,KAAAA,EAAUgC,KAAK+3H,SAAS5d,GAAIme,EAAe,CAAA,GAAIA,EAAe,CAG/D,CAAA;AAAA,cAAIQ,IAA2B96H,EAAUM,OAAOy6H;AAYhD,iBAXG5e,EAAGh/F,SAAAA,KAAcy9G,KAAaE,KAA4B,WAI3D3e,IAFE2e,MAA6B,YAE1B,IAAIt4H,KAAKq4H,GAAUD,IAAY,GAAG,GAAGze,EAAGhyG,YAAYgyG,EAAG1wG,WAAAA,GAAc0wG,EAAG/rF,WAAc+rF,GAAAA,EAAGjlC,qBAGzFl3E,EAAUgC,KAAKu4H,CAAc,EAAA,IAAI/3H,KAAKq4H,GAAUD,IAAY,GAAG,CAAA,GAAIzrG,KAAK,GAAGurG,GAAgBC,KAI3Fxe;AAAAA,QACX;AAAA,IAEE;AAAA,EACF,GACAn8G,EAAU+yH,cAAc,SAAShtH,GAAIirC,GAAOsiF,GAAYzhG,GAAME,GAAIwhG;AAEjE1hG,QAAOA,KAAQvoB,KAAKY,WACpB6nB,IAAKA,KAAMzoB,KAAKW;AAChB,QAAIoF,IAAMkkH,KAAa,IACnB5gB,IAAK,IAAInwG,KAAKuD,EAAGxE,WAAWkB,QAE5Bu4H,CAAAA,GAAAA,IAAYroB,EAAGxoG,SAEfypH,GAAAA,IAAe;AAOnB,SALK7tH,CAAAA,EAAGouC,eAAepuC,EAAGqC,aACzBrC,EAAGouC,cAAcpuC,EAAGqC,SAASzE,MAAM,GAAK,EAAA,CAAA,IAEzC2F,KAAKuvH,eAAe9yH,EAAGouC,cACvBw+D,IAAK3yG,EAAUgC,KAAK,eAAe+D,EAAGouC,WAAAA,EAAaw+D,GAAI9gF,GAAM9rB,CAAAA,GACrD4sG,MACPA,IAAK5sG,EAAGxE,cACRvB,EAAU8zH,0BAA0BnhB,GAAG9gF,GAAK9rB,GAAG4sG,GAAG,IAAInwG,KAAKmwG,EAAGlwG,YAA8B,MAAlBsD,EAAGgjE,eAAsBtmE,QAAaovB,KAAAA,EAAKpvB,QACrHkwG,KAAAA,EAAGlwG,QAA8B,IAAA,MAAlBsD,EAAGgjE,gBAAuBl3C,EAAKpvB;AAC7CkwG,MAAAA,IAAKrpG,KAAKtH,KAAK,SAAS+D,EAAGouC,WAAaw+D,EAAAA,GAAI,GAAG5sG,CAAAA;AAGjD,WAAO4sG,KAAOA,IAAK5gF,KAAM4gF,IAAK5sG,EAAGvE,aAAa6N,IAAM,KAAKukH,IAAevkH,MAAO;AAC9EsjG,MAAAA,EAAG3pG,SAASgyH,CAEZ;AAAA,UAAIh1E,IAAahmD,EAAUM,OAAkC,8BAAIkC,KAAKqrB,IAAI8kF,EAAGz1F,YAAey1F,GAAAA,EAAGx1F,YAAYw1F,EAAG9qG,QAAAA,GAAW8qG,EAAGxoG,SAAYwoG,GAAAA,EAAGlnG,cAAcknG,EAAGviF,WAAAA,CAAAA,IAAgBuiF,EAAGlwG,QAAAA,GAC3K6uH,IAAKhoH,KAAK+nH,gBAAgBrrE,GAAWjgD,EAAG9C;AAC5C,UAAKquH;AAyBDgC,QAAAA,MACAhC,EAAGlpH,YAAY,UACjBwrH,KAED5iF,EAAMruC,KAAK2uH;WA7BH;AACR,YAAI2J,IAAM,IAAIz4H,KAAKmwG,EAAGlwG,QAA8B,IAAA,MAAlBsD,EAAGgjE,YAAAA,GACjC1sD,IAAO/S,KAAKs0D,YAAY73D,CAY5B;AAAA,YAVAsW,EAAKG,OAAOzW,EAAGyW,MACfH,EAAK9a,aAAaoxG,GAClBt2F,EAAKpB,YAAYlV,EAAG9C,IACpBoZ,EAAKpZ,KAAK8C,EAAG9C,KAAK,MAAMmM,KAAKM,MAAMs2C,IAAY,GAC/C3pC,GAAAA,EAAK7a,WAAWy5H,GAEhB5+G,EAAK7a,WAAWxB,EAAU8zH,0BAA0Bz3G,EAAK9a,YAAY8a,EAAK7a,UAAUuE,GAAI4sG,GAAIt2F,EAAK7a,QAEjG6a,GAAAA,EAAK1T,SAASW,KAAKV,cAAcyT,KAE5BA,EAAK1T,UAAAA,CAAWW,KAAKmB,eAAgBnB,CAAAA,KAAKhJ,OAAO4sD;AAAW;AACjElc,QAAAA,EAAMruC,KAAK0Z,CAENi3G,GAAAA,MACJhqH,KAAKoN,QAAQ2F,EAAKpZ,MAAMoZ,GACxB/S,KAAK4nH,UAAUvuH,KAAK0Z,CAAAA,IAGrBu3G;AAAAA,MAEA;AAQDjhB,MAAAA,IAAKrpG,KAAKtH,KAAK,SAAS+D,EAAGouC,WAAaw+D,EAAAA,GAAI,GAAG5sG,CAAAA;AAAAA,IAI/C;AAAA,EACF,GACA/F,EAAU8zH,4BAA4B,SAASvyH,GAAYC,GAAUuE,GAAI0uD,GAASiC,GACjF;AAAA,QAAI/nC,IAAQptB,EAAWmtB,kBAAsBltB,IAAAA,EAASktB;AACtD,WAAIC,IACCA,IAAQ,IAEJ,IAAInsB,KAAKiyD,EAAQhyD,QAAAA,IAA8B,MAAlBsD,EAAGgjE,eAA8B,KAARp6C,IAAa,GAInE,IAAA,IAAInsB,KAAKhB,EAASiB,QAAAA,IAAoB,KAARksB,IAAa,GAAA,IAG7C,IAAInsB,KAAKk0D,EAAaj0D,QAAAA,CAAAA;AAAAA,EAC9B,GACAzC,EAAUy2F,cAAc,SAASxzF,GAAIoM,GAAAA;AACpC,QAAItJ,IAAkB,OAAN9C,KAAM,WAAWA,IAAKjD,EAAUyE,SAASxB,IACrD8wH,IAAa,CAAA;AAGjB,QAFA1kH,IAAMA,KAAO,MAERtJ,EAAGqC;AACP,aAAO,CACN,EAAE7G,YAAYwE,EAAGxE,YAAYC,UAAUuE,EAAGvE,SAG5C,CAAA;AAAA,QAAIuE,EAAGqC,YAAY;AAClB,aAAO,CAAA;AAGRpI,MAAU+yH,YAAYhtH,GAAIguH,GAAY,IAAMhuH,EAAGxE,YAAYwE,EAAGvE,UAAU6N,CAGxE;AAAA,aADIgJ,IAAS,CAAA,GACLnV,IAAI,GAAGA,IAAI6wH,EAAW5wH,QAAQD;AACR,MAA1B6wH,EAAW7wH,CAAAA,EAAGkF,YAAY,UAC5BiQ,EAAO1V,KAAK,EAACpB,YAAYwyH,EAAW7wH,CAAAA,EAAG3B,YAAYC,UAAUuyH,EAAW7wH,GAAG1B,SAI7E,CAAA;AAAA,WAAO6W;AAAAA,EACR,GACArY,EAAUqkC,YAAY,SAASxS,GAAME,GAAAA;AACpC,QAAI1Z,IAAS,CAAA;AACb,aAAS8J,KAAK7Y,KAAKoN,SAAS;AAC3B,UAAI3Q,IAAKuD,KAAKoN,QAAQyL;AACtB,UAAIpc,KAAMA,EAAGxE,aAAawwB,KAAMhsB,EAAGvE,WAAWqwB;AAC7C,YAAI9rB,EAAGouC,aAAa;AACnB,cAAIpuC,EAAGouC,eAAe;AAAQ;AAC9B,cAAI6/E,IAAM,CAAA;AACV1qH,eAAKypH,YAAYhtH,GAAIiuH,GAAK,IAAMniG,GAAME,CACtC;AAAA,mBAAS7uB,IAAI,GAAGA,IAAI8wH,EAAI7wH,QAAQD;AAAAA,aAE1B8wH,EAAI9wH,CAAGixC,EAAAA,eAAe6/E,EAAI9wH,CAAG3B,EAAAA,aAAawwB,KAAMiiG,EAAI9wH,CAAAA,EAAG1B,WAAWqwB,KAAAA,CAASvoB,KAAK8nH,aAAa4C,EAAI9wH,CAAGD,EAAAA,EAAAA,KACxGoV,EAAO1V,KAAKqxH,EAAI9wH;QAGlB;AAAWoG,eAAKyqC,kBAAkBhuC,EAAG9C,EACrCoV,KAAAA,EAAO1V,KAAKoD,CAGd;AAAA,IAAA;AACD,WAAOsS;AAAAA,EACR,GAEArY,EAAUM,OAAOyyH,cAAc,YAC/B/yH,EAAUM,OAAO63B,SAAS92B,WAAW,CACpC,EAACkX,MAAK,eAAe/U,QAAO,QAAQqC,MAAK,YAAawzB,OAAM,GAAA,GAC5D,EAAC9gB,MAAK,aAAa1S,MAAK,aAAarC,QAAO,YAAYqkB,QAAO,eAC/D,EAACtP,MAAK,QAAQxJ,QAAO,IAAIlJ,MAAK,QAAQrC,QAAO,OAAA,CAAA,GAK9CxD,EAAU8+D,cAAc,SAAS/4D;AAChC,QAAIxE,IAAa,IAAIiB,KAAK8G,KAAK/H,UAAAA,GAC3BC,IAAW,IAAIgB,KAAK8G,KAAK9H,QAC7B8H;AAAAA,SAAK/H,aAAaA,GAClB+H,KAAK9H,WAAWA,GAChB8H,KAAKy/D,eAAez/D,KAAK2R,YAAY3R,KAAK6qC,cAAc7qC,KAAKlB,WAAW;AAAA,EACzE,GAEApI,EAAUM,OAAO2zH,iBAAAA,IACjBj0H,EAAUM,OAAO8xH,qBAAqB,OAEtCpyH,EAAUsE,YAAY,cAAc;AACnCtE,MAAUoxH,eAAe,IACzBpxH,EAAUmxH,oBAAoB,IAC9BnxH,EAAUkxH,YAAY,CACvB;AAAA,EAAA,CAAA;AAEA,G7C7tCCl6F,W8CxEc,SAASh3B;AAGxB,QAAM82B,IAAsBpF,GAAgB1xB,CAG5CA;AAAAA,IAAUk7H,kBAAgB,WACzB;AAAA,QAAIpnG,IAAQ,CACR5G,GAAAA,IAASltB,EAAU42B,SAASsf,YAC5BilF,IAAarkG;AACjB,aAAS3U,KAAKg5G,GAAW;AACxB,UAAIp1H,IAAKo1H,EAAWh5G,CACpB;AAAA,eAAS5J,KAAQxS;AACO,QAAnBwS,EAAKmd,OAAO,GAAE,CAAA,KAAK,OACtB5B,EAAMnxB,KAAK,CAAC4V,GAAOA,KAAQ,gBAAgBA,KAAQ,aAAY2U,IAAO,IAAA,CAAA;AACxE;AAAA,IACA;AACD,WAAO4G;AAAAA,EACR,GAEA9zB,EAAUirH,QAAQ,SAAS5yF,GAC1B;AAAA,QAAIzF,IAAM,CACNkB,GAAAA,IAAQxqB,KAAK4xH,gBACbC,GAAAA,IAAarkG;AACjB,aAAS3U,KAAKg5G,GAAW;AACxB,UAAIp1H,IAAKo1H,EAAWh5G,CAAAA;AAEpByQ,QAAIjwB,KAAK,SAAA;AACT,eAASO,IAAE,GAAGA,IAAI4wB,EAAM3wB,QAAQD;AAC/B0vB,UAAIjwB,KAAK,MAAImxB,EAAM5wB,CAAAA,EAAG,KAAG,gBAAc4wB,EAAM5wB,CAAG,EAAA,CAAA,IAAG4wB,EAAM5wB,CAAAA,EAAG,GAAG6C,EAAG+tB,EAAM5wB,GAAG,CAAK6C,CAAAA,CAAAA,IAAAA,EAAG+tB,EAAM5wB,CAAG,EAAA,CAAA,CAAA,KAAK,UAAQ4wB,EAAM5wB,CAAG,EAAA,CAAA,IAAG;AAEtH0vB,QAAIjwB,KAAK;IACT;AACD,YAAQ01B,KAAQ,MAAI,WAASzF,EAAInlB,KAAK;AAAA,CAAM,IAAA;AAAA,EAC7C,GAEAzN,EAAUo7H,wBAAwB,SAAS5iH,GAY1C;AAAA,WAXGA,MAAU,QAAyB,OAAVA,KAAU,YACrCA,IAAQ,KAAKA,KAETA,KAASA,MAAU,MACtBA,IAAQ,KAETA,IAAQ,MAAMA,EAAMY,SAAAA,EACnBvB,QAAQ,OAAM,EACdA,EAAAA,QAAQ,OAAM,MACdA,EAAAA,QAAQ,MAAM,KAAS,IAAA,MAElBW;AAAAA,EACR,GAIAxY,EAAUonH,SAAS,WAAA;AAClB,WAAOjvG,KAAKmB,UAAUhQ,KAAK0tB,UAAAA,CAAAA;AAAAA,EAC5B,GAGAh3B,EAAUq7H,SAAS,SAAShjG,GAC3B;AAAA,QAEInL,IAASltB,EAAUgC,KAAK0tB,YAAY,kBACpC4rG,IAAkBt7H,EAAUgC,KAAK0tB,YAAY,QAAA,GAE7CoF,IAAO,CACPqmG,GAAAA,IAAarkG,EACjB;AAAA,aAAS3U,KAAKg5G,GAAW;AACxB,UAAIp1H,IAAKo1H,EAAWh5G,CAAAA;AAGpB2S,MAAAA,EAAKnyB,KAAK,cAAA,GACLoD,EAAG4C,WAAY5C,EAAGxE,WAAW4I,cAAepE,EAAGxE,WAAWkK,gBAG9DqpB,EAAKnyB,KAAK,aAAWuqB,EAAOnnB,EAAGxE,eAF/BuzB,EAAKnyB,KAAK,aAAW24H,EAAgBv1H,EAAGxE,cAGpCwE,EAAG4C,WAAY5C,EAAGvE,SAAS2I,SAAAA,KAAepE,EAAGvE,SAASiK,WAG1DqpB,KAAAA,EAAKnyB,KAAK,WAASuqB,EAAOnnB,EAAGvE,QAF7BszB,CAAAA,IAAAA,EAAKnyB,KAAK,WAAS24H,EAAgBv1H,EAAGvE,QAAAA,CAAAA,GAGvCszB,EAAKnyB,KAAK,aAAWoD,EAAGyW,IAAAA,GACxBsY,EAAKnyB,KAAK,YAAA;AAAA,IACV;AACD,WAvBY;AAAA;AAAA;AAAA,iBAuBE01B,KAAQ,MAAI;AAAA,IAAKvD,EAAKrnB,KAAK;AAAA,CAAlCR,IAAAA;AAAAA;AAAAA,EACR;AAEA,G9CZCi3B,U+CpEc,SAASlkC,GAGxB;AAAA,WAASu7H,IACR;AAAA,QAAIluF,IAAQz/B,SAASC,cAAc,GACnCw/B;AAAAA,IAAAA,EAAMpsC,MAAM+N,QAAQ,QACpBq+B,EAAMpsC,MAAM8N,SAAS;AAErB,QAAIysH,IAAQ5tH,SAASC,cAAc,KACnC2tH;AAAAA,IAAAA,EAAMv6H,MAAM8J,WAAW,YACvBywH,EAAMv6H,MAAMC,MAAM,OAClBs6H,EAAMv6H,MAAME,OAAO,OACnBq6H,EAAMv6H,MAAMgmB,aAAa,UACzBu0G,EAAMv6H,MAAM+N,QAAQ,SACpBwsH,EAAMv6H,MAAM8N,SAAS,SACrBysH,EAAMv6H,MAAMo+F,WAAW,UACvBm8B,EAAMztH,YAAYs/B,IAElBz/B,SAASmJ,KAAKhJ,YAAYytH,CAAAA;AAC1B,QAAIC,IAAKpuF,EAAM9pB;AACfi4G,IAAAA,EAAMv6H,MAAMo+F,WAAW;AACvB,QAAIq8B,IAAKruF,EAAM9pB;AAQf,WANIk4G,KAAMC,MACTA,IAAKF,EAAM75G,cAGZ/T,SAASmJ,KAAKvL,YAAYgwH,IAElBC,IAAKC;AAAAA,EACd;AAGA17H,IAAU6c,IAAIqnB,WAAW,EACxBy3F,aAAa,SAASr6D,GAASs6D,GAAiBC,GAAAA;AAC/C,SAAIv6D,KAAYA,CAAAA,EAAQn+D;AACvB;AAED,UAAMzB,IAAO;AACb,aAAQwB,IAAI,GAAGA,IAAIo+D,EAAQn+D,QAAQD,KAAI;AACtC,YAAM+hD,IAASqc,EAAQp+D;AACvB,UAAIjC,IAAQ;AACTgkD,MAAAA,EAAO62E,WACT76H,IAAQ,WAAWgkD,EAAO62E,SAAS;AAGpC,UAAIhtH,IAAY+sH;AACb52E,MAAAA,EAAOxjD,QACTqN,KAAa,MAAMm2C,EAAOxjD,MAGxByB,MAAM,MACR4L,KAAa,MAAM+sH,IAAY,WAE5B34H,MAAMo+D,EAAQn+D,SAAS,MAC1B2L,KAAa,MAAM+sH,IAAY;AAGhC,YAAMvuF,IAAUsuF,EAAgB32E,CAAW,KAAA;AAE3CvjD,QAAKiB,KAAK,eAAemM,aAAqB7N,CAA0DqsC,qDAAAA,CAAAA,cAAAA;AAAAA,IACxG;AAED,WAAO5rC,EAAK+L,KAAK,EACjB;AAAA,EAAA,GACDsuH,eAAe,WACd;AAAA,WAAOzyH,KAAKqyH,YACXryH,KAAKg4D,SACL,SAAUrc,GAAAA;AACT,aAAOA,EAAOjxB;AAAAA,IACd,GACD;EAED,GACDgoG,eAAe,SAAuBh3H,GACrC;AAAA,WAAOsE,KAAKqyH,YACXryH,KAAKg4D,SACL,SAAUrc,GACT;AAAA,aAAGA,EAAO/rB,YACF+rB,EAAO/rB,SAAS3kB,KAAK88B,MAAMrsC,MAE5B;AAAA,IACP,GACD,2BAED;AAAA,EAAA,GAED49D,UAAU,SAASq5D;AAClB,QAAIA,GAAJ;AAIA,UAAIC;AAEHA,MAAAA,IADED,EAAej6H,OACJi6H,EAAej6H,OACpBi6H,EAAe96H,OACV86H,EAAe96H,OAEf86H;AAGd,UAOIE,GAPA1yG,IAAAA;AAaJ,UAZGwyG,EAAej3H,UACjBykB,IAAYngB,KAAKk5D,cAAcy5D,EAAej3H,OACtCi3H,IAAAA,EAAe/6H,QACvBuoB,IAAYwyG,EAAe/6H,MAK3Bi7H,IADuB,OAAdD,KAAc,WACbA,IAEA5yH,KAAKm5D,YAAYy5D,IAExBl8H,EAAUM,OAAOsgC,KAAI;AACxB,YAAIw7F,KAAsBp8H,EAAU8C,WAAW4d,cAAc,6BAAA,EAA+Bzf,MAAM8N,OAAO8I,QAAQ,MAAM,EAAA,GACnHwkH,IAAe/yH,KAAK4iG,gBAAgB5iG,KAAK+uF,OAAOl1F,MAAAA,IAAUmG,KAAKgzH,YAAYhzH,KAAKgzH,YAAYn5H,SAAS,CAAA,EAAGjC;AAExGoI,aAAKizH,aAAattC,aAAa3lF,KAAKizH,aAAangF,MAAMsyC,WAAW2tC,IAAeD,KAAsB9yH,KAAKsM,UAAU,YACzHumH,KAAWZ,EAEZ;AAAA,MAAA;AAED,UAAIiB,IAAiBx8H,EAAU8C,WAAW4d,cAAc,4BACnDpX;AAAAA,WAAK48B,eACTs2F,IAAiBx8H,EAAU8C,WAAW4d,cAAc,eAAA,IAGlDpX,KAAK48B,cACP58B,KAAKizH,aAAantC,eAAeotC,GAAgBL,CAAAA,GAG/C1yG,KAAa,MACf+yG,EAAe/yG,YAAYA;AAAAA,IA3C3B;AAAA,EA6CD,GAEDgzG,mBAAmB,WAAA;AAClB,WAAO,EACNt7H,MAAMmI,KAAKkxF,aAAa,GACxBt5F,KAAKoI,KAAKmxF,aAAa,EAAA;AAAA,EAExB,GAEDh4B,aAAa,SAASzgE,GACrB;AAAA,WAAOhC,EAAUisG,eAAe,EAAC1qG,YAAYS,EAAAA,GAAAA,IAAcsH,IAAQ,IAAA;AAAA,EACnE,GAEDozH,aAAa,SAAUpxG,GACtB;AAAA,WAAOtrB,EAAU66F,oBAAoBvxF,MAAMgiB,CAC3C;AAAA,EAAA,GAEDqxG,gBAAgB,SAASz7H,GAAAA;AACxB,QAAIikD,IAAM,EAAC95B,GAAGnqB,EAAAA;AAEd,WADAlB,EAAU26F,0BAA0BrxF,MAAM67C,CAAAA,GACnCA,EAAIngD;AAAAA,EACX,GAED43H,iBAAiB,SAASz3E,GAAAA;AACzB,QAAI9sC,IAAS,EACZrW,MAAM,MACNgD,SAAS;AAQV,WANGmgD,EAAIhkD,SACNkX,EAAOrW,OAAOsH,KAAKozH,YAAYv3E,EAAIhkD,IAAAA,IAEjCgkD,EAAIjkD,QACNmX,EAAOrT,UAAUsE,KAAKqzH,eAAex3E,EAAIjkD,GAEnCmX,IAAAA;AAAAA,EACP,GAEDigF,kBAAkB,SAASt3F,GAAAA;AAC1B,WAAOsI,KAAK4iG,gBAAgBlrG;EAC5B,GAEDwhE,eAAe,SAASxhE,GACvB;AAAA,WAAOsI,KAAKuzH,UAAU77H,CAAWE,EAAAA;AAAAA,EACjC,GAED47H,aAAa,SAAS18H;AACrB,QAAI28H,IAAczzH,KAAK0zH,eAAe58H,CAAAA,GAClC68H,IAAS78H,EAAMkkC,WAAW,GAC1BjZ,IAAI,IAAE4xG,KAAQF,IAAc,MAAIE,IAAe,IAAPA,IAAU;AAItD,WAHIj9H,EAAUM,OAAOuE,0BACpBwmB,IAAG,IAAE4xG,IAAOj9H,EAAUM,OAAOg3D,wBAAsB2lE,IAAe,IAAPA,IAAU,KAE/D5xG;AAAAA,EACP,GAED2xG,gBAAgB,SAAS58H,GACxB;AAAA,QAAI8jC,IAAW56B,MACXtE,IAAU5E,EAAM8jC,EAAS3gC,UAAAA,GACzBw5H,IAAc74F,EAASg5F;AAC3B,UAAMC,IAAej5F,EAASj1B,MAAMjK;AAcpC,WAbIk/B,EAASg5F,YAAY,WACpBh5F,EAAS60D,sBAEZ/4F,EAAUo9H,4BAA4B9zH,MAAM6zH,IAC5CJ,IAAc74F,EAASo0D,iBAAiBtzF,CAAW,IAAA,KAEnD+3H,IAAc74F,EAASpO,KAAK,IAI1BoO,EAASm5F,kBACZN,IAAc3tH,KAAKC,IAAID,KAAK+D,MAAM4pH,KAAe38H,EAAMmkC,UAAQ,EAAKL,GAAAA,EAASo5F,YAEvEP,IAAAA;AAAAA,EACP,EAIF/8H,GAAAA,EAAUu9H,qBAAqB,WAqrB/B;AAAA,aAASC,EAAe/6G,GAAMpK,GAAAA;AAE7B,UADAA,IAASA,KAAU,CAChBoK,GAAAA,EAAKs8B;AACP,iBAAQ77C,IAAI,GAAGA,IAAIuf,EAAKs8B,SAAS57C,QAAQD;AACxCmV,UAAAA,EAAO1V,KAAK8f,EAAKs8B,SAAS77C,CAAAA,EAAGmQ,MAC7BmqH,EAAe/6G,EAAKs8B,SAAS77C,CAAImV,GAAAA,CAAAA;AAGnC,aAAOA;AAAAA,IACR;AAEA,aAASolH,EAAgBz8H,GAAWkjC,GAAAA;AACnC,UAAIi5F,IAAej5F,EAASj1B,MAAMjO,CAKlC;AAAA,aAJGm8H,MAIH,WAFCA,IAAe,OAAOn8H,IAEhBm8H;AAAAA,IACR;AAEA,aAASO,EAAoBj7G,GAAMpK;AAElC,UADAA,EAAOoK,EAAKpP,GAAOoP,IAAAA,GAChBA,EAAKs8B;AACP,iBAAQ77C,IAAI,GAAGA,IAAIuf,EAAKs8B,SAAS57C,QAAQD;AACxCw6H,UAAAA,EAAoBj7G,EAAKs8B,SAAS77C,CAAImV,GAAAA,CAAAA;AAAAA,IAGzC;AAaA,aAASslH,EAAkB7hH,GAAQooB,GAElC;AAAA,eAMIi5F,GAPA52H,IAAQ,CACHrD,GAAAA,IAAE,GAAGA,IAAIghC,EAASm0D,OAAOl1F,QAAQD;AACzCqD,QAAAA,EAAOrD,CAAAA,IAAG;AAMNqD,MAAAA,EAAO42H,CAAAA,MACX52H,EAAO42H,CAAAA,IAAc,CAGtB;AAAA,UAAIS,IAxBL,SAA2B15F,GAAAA;AAG1B,iBAFI7rB,IAAS,CAAA,GACTvF,IAAQoxB,EAAS25F,mBAAmB35F,EAASm0D,QACzCn1F,IAAI,GAAGA,IAAI4P,EAAM3P,QAAQD;AAChCw6H,UAAAA,EAAoB5qH,EAAM5P,CAAAA,GAAImV,CAG/B;AAAA,eAAOA;AAAAA,MAER,EAewC6rB,CAEnC45F,GAAAA,IAAc55F,EAAStuB,UAAU;AAKrC,eAASmoH,EAAWx3H,GAAQ42H,GAAca,GAAOC,GAC5C13H;AAAAA,QAAAA,EAAO42H,OACV52H,EAAO42H,CAAAA,IAAc;AAEtB,iBAAQ7xG,IAAI0yG,GAAO1yG,KAAK2yG,GAAK3yG;AACvB/kB,UAAAA,EAAO42H,CAAAA,EAAc7xG,OAAI/kB,EAAO42H,CAAAA,EAAc7xG,KAAG,CACtD/kB,IAAAA,EAAO42H,GAAc7xG,CAAG3oB,EAAAA,KAAKvC,CAE9B;AAAA,MAAA;AAZE09H,MAAAA,MACFv3H,EAAO23H,QAAQ;AAahB,UAAIC,IAAkBj6F,EAAS3gC;AAC/B,WAASL,IAAE,GAAGA,IAAI4Y,EAAO3Y,QAAQD,KAAK;AACrC,YAAI9C,IAAQ0b,EAAO5Y,CAAAA,GACfk7H,IAAah+H,EAAM+9H,CAAAA;AACvBhB,QAAAA,IAAeM,EAAgBW,GAAYl6F,CAAAA;AAC3C,YAAIm6F,IAAkBr+H,EAAU6B,gBAAgBqiC,GAAU9jC,EAAMmB,aAC5D+8H,IAAgBt+H,EAAU6B,gBAAgBqiC,GAAU9jC,EAAMoB,QAAAA;AAC3DpB,QAAAA,EAAMoB,SAASiB,QAAAA,KAAayhC,EAASniC,SAASu8H,CAAAA,EAAe77H,cAC/D67H,KAAiB,IAGd/3H,EAAO42H,CAAAA,MACV52H,EAAO42H,CAAAA,IAAc,KAGtBY,EAAWx3H,GAAQ42H,GAAckB,GAAiBC,CAAAA;AAElD,YAAI/tB,IAAUqtB,EAAeQ,CAC7B;AAAA,YAAGN,KAAevtB,KAAWA,EAAQguB;AAGpC,mBAFIC,IAAY,CAAA,GAEVjuB,EAAQguB,WAAQ;AACrB,gBAAGC,EAAUjuB,EAAQl9F;AACpB,oBAAM,IAAIhD,MAAM,2CAA2CkgG,EAAQl9F,MAAM,eAAak9F,EAAQv8E,QAA9E,qFAAA;AAGjBwqG,YAAAA,EAAUjuB,EAAQl9F;AAElB,gBAAI/H,IAASsyH,EAAertB,EAAQguB;AACpCR,YAAAA,EAAWx3H,EAAO23H,OAAO5yH,EAAO+H,KAAKgrH,GAAiBC,IACtD/tB,IAAUjlG;AAAAA,UACV;AAAA,MAEF;AAED,aAAO/E;AAAAA,IACR;AA5xBAvG,MAAUuG,SAAS,CAAA,GACnBvG,EAAU6tF,SAAO,SAAS1rE,GAAEC,GAC3B;AAAA,eAASla,KAAKka;AAAAA,QACFD,EAAEja,CACZia,MAFYC,WAEZD,EAAEja,KAAGka,EAAEla,CAAAA;AAAAA,IACV,GACAlI,EAAUihD,qBAAmB,SAASv+C,GAErC1C;AAAAA,QAAU6tF,OAAOnrF,GAAI,EAEpB65H,cAAc/tC,MACd+W,cAAc,KACdpY,YAAY,EACXW,SAAS,KACTC,SAAS,KACTC,SAAS,IACTC,SAAS,GAAA,GAGVwwC,kBACAC,oBAAAA,IACAlkC,WAAW,GACXC,WAAW,GACXkkC,SAAS,CAAE,GACXrC,aAAa,CAAA,GAEbvjC,wBACAl4F,QAAQ,YACR0X,MAAK,UACL+S,GAAE,QACFD,GAAE,QACFy6B,QAAO,GACPC,QAAO,QACPsyC,QAAO,OACPumC,QAAO,GACP9kC,SAAQ,GACR+kC,QAAO,IACPC,SAAQ,GACRC,QAAQ,GACRC,QAAQh/H,EAAUM,OAAOgpC,WACzB1zB,QAAO,QACPuwB,IAAG,KACHrQ,IAAG,IACHonG,UAAUl9H,EAAU+gB,GAAG+mB,YACvBw1F,cAAct9H,EAAU+gB,GAAG+mB,YAC3Bu1F,eAAAA,IACA4B,YAAY,IACZC,mBAAmB,GACnBC,iBAAiB,IACjBnV,kBACAroH,gBAAAA,IACAy9H,QAAQ,SAASC,GAAahnC,GAAQn0D,GAAAA;AACrC,YAAI98B,IAAM,CAAA;AAIV,eAHGpH,EAAUkJ,WAAW,6BACvB9B,IAAMpH,EAAUmJ,UAAU,yBAAyB,CAACk2H,GAAahnC,GAAQn0D,CAEnE98B,CAAAA,IAAAA;AAAAA,MACP,MAEF1E,EAAI48H,oBAAoB58H,EAAIo3F,SAGxBp3F,EAAIqjD,UAAU,UAAOrjD,EAAI0H,aAAa1H,EAAI2H,YAAY,IAE1D3H,EAAImkD,oBAAoBnkD,EAAI0H,aAA0B,KAAf1H,EAAI0H,aAAc,KAAG,MAAK,GACjE1H,EAAIokD,kBAAkBpkD,EAAI2H,YAA6B,MAAlB,KAAG3H,EAAI2H,aAAc,KAAG,MAAK,GAE9DrK,EAAUkJ,WAAW,mBAAA,KACxBlJ,EAAUmJ,UAAU,qBAAqB,CAACzG,CAAAA,CAAAA,GAG3CupC,GAAUvpC,CACV1C,GAAAA,EAAUsE,YAAY,aAAa,WAAA;AAClC5B,QAAAA,EAAIsiB,gBAAAA;AAAAA,MACN,CAEC;AAAA,UAAIoJ,IAAMpuB,EAAU+V;AACpB/V,QAAU+V,cAAc,SAAS5N,GAAK5D,GACrC;AAAA,YAAI+E,KAAKoB,SAAShI,EAAI6V;AAWrB,iBAAO6V,EAAIliB,MAAM5C,MAAM+I,SATvB;AAAA,YAAA,CAAI9N,KAAU7B,EAAIy8H,mBAAAA,CAAmBn/H,EAAU4E,SAAWw/B,EAAAA,WAAY1hC,EAAIkT,UAAU;AAMnF5V,YAAUg6F,cAAczlF,KAAK7R,OAAW,EAAA;AAAA;AALxC,mBAASQ,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC/BoG,iBAAKmwD,YAAYtxD,EAAIjF,CACrBoG,CAAAA,GAAAA,KAAKi2H,sBAAsBhrH,KAAKjL,KAAK/C,OAAO+C,KAAKoB,KAAQvC,GAAAA,EAAIjF,MAOlE;AAAA,MAAA,GAEClD,EAAUuG,OAAO7D,EAAI6V,IAAM7V,IAAAA,GAC3B1C,EAAUya,UAAU/X,EAAI6V,OAAK,aAAA,IAAiB,SAASg+B,GAAK;AAAA,eAAOA,IAAGA,EAAGpzC,SAAO;AAAA,MAAG,GACnFnD,EAAUya,UAAU/X,EAAI6V,OAAK,aAAA,IAAiB,SAASmb,GAAM;AAAA,eAAO;AAAA,SAEpE1zB,EAAUya,UAAU/X,EAAI6V,OAAK,sBAAA,IAA0B,SAASvW,GAAO;AAAA,eAAO;AAAA,SAC9EhC,EAAUya,UAAU/X,EAAI6V,OAAK,YAAgB,IAAA,SAASvT,GAASk/B,GAAAA;AAC9D,eAAGA,EAASs7F,2BAA2Bx6H,EAAQ+5C,WAIvC,WAED;AAAA,MACT,GAEC/+C,EAAUya,UAAU/X,EAAI6V,OAAK,eAAA,IAAmB,SAASohF,GAAYC,GAAeC;AAAkB,eAAO;AAAA,MAAG,GA0ChHn3F,EAAI4B,YAAY,kBAAkB,WAIjC;AAAA,eAHG5B,EAAI4+D,WAAW5+D,EAAI4+D,QAAQn+D,UAvC/B,SAA0Bm+D,GAASp9B,GAClC;AAAA,cAAIkpB,IAAalpB,EAASiC,IAEtBs5F,IAAiB,GAEjBC,IAAkB,CAAA;AAGtBp+D,UAAAA,EAAQl9D,QAAQ,SAAS6gD;AACrBA,YAAAA,EAAOj2C,SACTywH,KAAkBx6E,EAAOj2C,OACzBi2C,EAAO62E,SAAS72E,EAAOj2C,SAGvB0wH,EAAgB/8H,KAAKsiD,CAAAA;AAAAA,UAEzB;AAEE,cAAI06E,IAAAA,IAEAC,IAAYxyE,IAAaqyE;AAAAA,WAE1BG,IAAY,KAAKF,EAAgBv8H,WAAW,OAC9Cw8H,IAAAA;AAED,cAAIE,IAAcH,EAAgBv8H;AAClCu8H,UAAAA,EAAgBt7H,QAAQ,SAAS6gD,GAChCA;AAAAA,YAAAA,EAAO62E,SAAS1sH,KAAKC,IAAID,KAAK+D,MAAMysH,IAAYC,CA5BzB,GAAA,EAAA,GA6BvBD,KAAa36E,EAAO62E,QACpB2D,KAAkBx6E,EAAO62E,QACzB+D;AAAAA,UACH,CAAA,GAEKF,MACFz7F,EAASiC,KAAKs5F;AAAAA,QAEf,EAIkB/8H,EAAI4+D,SAAS5+D,CAExB,GAAA;AAAA,MACT,IAICA,EAAIs5H,gBAAgBt5H,EAAIs5H,iBAAiBh8H,EAAU6c,IAAIqnB,SAAS83F,cAAc7iH,KAAKzW,IACnFA,EAAIq5H,gBAAgBr5H,EAAIq5H,iBAAiB/7H,EAAU6c,IAAIqnB,SAAS63F,cAAc5iH,KAAKzW,CACnFA,GAAAA,EAAIi5H,cAAcj5H,EAAIi5H,eAAe37H,EAAU6c,IAAIqnB,SAASy3F,YAAYxiH,KAAKzW,CAAAA,GAE7E1C,EAAUya,UAAU/X,EAAI6V,OAAK,kBAAkB,SAASohF,GAAYC,GAAeC,GAClF;AAAA,eAAGn3F,EAAI4+D,WAAW5+D,EAAI4+D,QAAQn+D,SACtBT,EAAIs5H,cAAcniC,KAElBD;AAAAA,MAEV,GAEC55F,EAAUya,UAAU/X,EAAI6V,OAAO,eAAmB,IAAA,SAAS2rB,GAC1D;AAAA,eAAGxhC,EAAI4+D,UACCp9B,EAAS63F,cAAc73F,CAAAA,IAEvBlkC,EAAU0tB,OAAOwN,OAAOx4B,EAAI6V,OAAO,eAAA,KAAoB;AAAA,MAEjE,GAECvY,EAAUya,UAAU/X,EAAI6V,OAAK,UAAA,IAAc,SAAS4J,GAAEC,GAAE5d;AAAI,eAAOA,EAAEgY;AAAAA,MAAK,GAC1Exc,EAAUya,UAAU/X,EAAI6V,OAAK,OAAA,IAAW,SAASunH,GAAOC,GAAAA;AACvD,eAAMD,EAAMr4H,OAAAA,KAAUs4H,EAAMt4H,OAAAA,KAAYs4H,IAAMD,IAAK,UACjDA,KAAU9/H,CAAAA,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKu9H,CAC3C//H,CAAAA,KAAAA,CAAAA,EAAUgC,KAAKC,IAAI69H,GAAO,GAAG,WAAWC,KAASA,EAAM51H,SAA2C,MAA5B,KAAK41H,EAAMt0H,WAC5EzL,MAD6F,IAC7FA,EAAUya,UAAU+rB,SAASs5F,CAC/BA,IAAAA,EAAMr4H,YAAYs4H,EAAMt4H,OAAAA,KAAYs4H,IAAMD,IAAS,QACjD9/H,EAAUya,UAAU+rB,SAASs5F,CAAO,IAAA,cAAY9/H,EAAUya,UAAU+rB,SAASu5F,CAE9E//H,IAAAA,EAAUya,UAAUo8C,UAAUipE,GAAOC;MAC9C;AAEC,UAAIC,IAAmBt9H,EAAIs8H,UAAUh/H,EAAUM,OAAOgpC,WAClD22F,IAAmB;AACvBjgI,QAAUya,UAAU/X,EAAI6V,OAAO,aAAA,IAAiB,SAASvW,GAAAA;AAKxD,eAJIg+H,OAAsBt9H,EAAIs8H,UAAUh/H,EAAUM,OAAOgpC,cAAe22F,MACvED,IAAmBt9H,EAAIs8H,UAAUh/H,EAAUM,OAAOgpC,WAClD22F,IAAmBjgI,EAAUgC,KAAK0tB,YAAYswG,KAExCC,EAAiBj+H,CAAAA;AAAAA,MAC1B;AACC,UAAIk+H,IAAwBx9H,EAAIsnH,gBAAgBtnH,EAAIsnH,aAAagV,SAASt8H,EAAIsnH,aAAagV,SAASh/H,EAAUM,OAAOgpC,WACjH62F,IAA6B;AACjCngI,QAAUya,UAAU/X,EAAI6V,OAAO,wBAAwB,SAASvW,GAAAA;AAK/D,eAJIk+H,OAA2Bx9H,EAAIsnH,aAAagV,UAAUh/H,EAAUM,OAAOgpC,cAAe62F,MACzFD,IAAyBx9H,EAAIsnH,gBAAgBtnH,EAAIsnH,aAAagV,SAAQt8H,EAAIsnH,aAAagV,SAAOh/H,EAAUM,OAAOgpC,WAC/G62F,IAA6BngI,EAAUgC,KAAK0tB,YAAYwwG,KAElDC,EAA2Bn+H,CAAAA;AAAAA,MACpC,GAEChC,EAAUgC,KAAK,SAASU,EAAI6V,OAAO,UAAA,IAAa,SAASvW,GAAMgkC,GAAAA;AAC9D,YAAIrX,IAAQqX,GACRjzB,IAAOrQ,EAAIqjD;AAEf,YAAGrjD,EAAIqjD,UAAU,YAAYrjD,EAAIqjD,UAAU,QAAO;AAEjD,cAAIq6E,IAAczxG;AACD,UAAdjsB,EAAIqjD,UAAU,WAChBq6E,KAAe,KAEXA,IAAW,SAEfzxG,IAAQyxG,IAAW,MACnBrtH,IAAO;AAAA,QAER;AAED,eAAO/S,EAAUgC,KAAKC,IAAID,GAAM2sB,GAAO5b;MACzC,GAEC/S,EAAUgC,KAAK,SAASU,EAAI6V,QAAQ,SAASvW,GAAMgkC,GAAM99B,GAAAA;AACxD,YAAIm4H,IAAiBrgI,EAAUgC,KAAK,SAASU,EAAI6V,OAAO,UAAA,EAAYvW,IAAOU,EAAI49H,YAAY59H,EAAIm8H,UAAUn8H,EAAIojD,SAAS9f;AAEtH,YAAItjC,EAAIqjD,UAAU,YAAYrjD,EAAIqjD,UAAU,QAAQ;AACnD,cAAIj7C,IAAQpI,EAAI49H,YAAY59H,EAAIm8H,QAC5B0B,IAAkB79H,EAAIqjD,UAAU,SAAqB,KAAXrjD,EAAIojD,SAAYpjD,EAAIojD;AAClE,cAAIy6E,IAAiBz1H;AAEpB,gBAAA,CAAM9K,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKR,CAAAA,CAAAA,KAAAA,CAAWhC,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAK69H,CACpF39H,CAAAA;AAAAA,cAAAA,EAAIo3F,WAAW9zD,IAAKl7B;AAAAA,iBACd;AAEN,kBAAI01H,IAAgB,QAAa11H,IAAOy1H,KAAoB,GACxDE,IAAerxH,KAAKM,MAAM8wH,IAAc11H,CAG3CpI;AAAAA,cAAAA,EAAIo3F,UADD9zD,IAAO,IACItjC,EAAIo3F,UAAU2mC,IAEdA,IAAe/9H,EAAIo3F;AAAAA,YAElC;AAAA,QAEF;AACD,eAAOumC;AAAAA,MACT,GACCrgI,EAAUgC,KAAKU,EAAI6V,OAAK,QAAY,IAAA,SAASvW;AAC5C,YACIT,KADOvB,EAAUgC,KAAKU,EAAIqjD,SAAO,QAAa/lD,KAAAA,EAAUgC,KAAKitB,WAC3C1a,KAAKvU,EAAUgC,MAAMA,CACvC0+H,GAAAA,IAAen/H,EAAWmtB,kBAE1BiyG,GAAAA,KADJp/H,IAAavB,EAAUgC,KAAKC,IAAIV,GAAYmB,EAAIojD,SAAOpjD,EAAIo3F,SAASp3F,EAAIqjD,SAC5Cr3B,kBAK5B;AAAA,eAJGgyG,KAAgBC,KAClBp/H,EAAWgtB,QAAQhtB,EAAWitB,QAA0C,IAAA,OAA7BmyG,IAAaD,EAGlDn/H,GAAAA;AAAAA,MACT,GAECmB,EAAIggE,yBAAyB;AAC5B,YAAIurC,IAAW;SACZ3kG,KAAK48B,cAAc58B,KAAKw4F,qBAC1BmM,IAAWjuG,EAAU4gI,uBAAuBC,YAAYv3H,KAAKizH,cAAcjzH,KAAKw3H,WAGjF;AAAA,YAAIC,IAA4B9yB,CAAAA,CAAAA;AAehC,kBAZI3kG,KAAK48B,aAKL58B,KAAKw4F,oBALA57D,MAQS66F,IANDz3H,KAAKw4F,mBAAmBi/B;AAAAA,MAW3C,GAECr+H,EAAIkgE,WAAWlgE,EAAIkgE,YAAY5iE,EAAU6c,IAAIqnB,SAAS0+B,SAASzpD,KAAKzW,CAEpEA,GAAAA,EAAI+5H,oBAAoB/5H,EAAI+5H,qBAAqBz8H,EAAU6c,IAAIqnB,SAASu4F,kBAAkBtjH,KAAKzW,CAE/FA,GAAAA,EAAI+/D,cAAc//D,EAAI+/D,eAAeziE,EAAU6c,IAAIqnB,SAASu+B,YAAYtpD,KAAKzW,CAE7EA,GAAAA,EAAIg6H,cAAch6H,EAAIg6H,eAAe18H,EAAU6c,IAAIqnB,SAASw4F,YAAYvjH,KAAKzW,CAE7EA,GAAAA,EAAIi6H,iBAAiBj6H,EAAIi6H,kBAAkB38H,EAAU6c,IAAIqnB,SAASy4F,eAAexjH,KAAKzW,CAAAA,GAEtFA,EAAIk6H,kBAAkBl6H,EAAIk6H,mBAAmB58H,EAAU6c,IAAIqnB,SAAS04F,gBAAgBzjH,KAAKzW,CAAAA,GAEzFA,EAAI41F,mBAAmB51F,EAAI41F,oBAAoBt4F,EAAU6c,IAAIqnB,SAASo0D,iBAAiBn/E,KAAKzW,CAAAA,GAE5FA,EAAI8/D,gBAAgB9/D,EAAI8/D,iBAAiBxiE,EAAU6c,IAAIqnB,SAASs+B,cAAcrpD,KAAKzW,CAAAA,GAEnFA,EAAIo6H,cAAcp6H,EAAIo6H,eAAe98H,EAAU6c,IAAIqnB,SAAS44F,YAAY3jH,KAAKzW,CAE7EA,GAAAA,EAAIs6H,iBAAiBt6H,EAAIs6H,kBAAkBh9H,EAAU6c,IAAIqnB,SAAS84F,eAAe7jH,KAAKzW,IAEtFA,EAAIs+H,eAAehhI,EAAUmZ,KAAK,SAAU7Y,GAAAA;AAC3C,YAAIU,IAAYV,EAAO0E,SACtBhD,IAAO1B,EAAO0B,MACdi/H,IAAoB3gI,EAAO4gI;AAE5B,eAAIl/H,IAsCL,SAAsBhB,GAAWgB,GAAMi/H,GAAmB/8F;AACzD,cAAI/7B,IAAMnI,EAAU4gI,uBAAuBO,kBAAkBj9F,CAEzDk9F,GAAAA,IAAe,CACfC,GAAAA,IAAe,IAEflE,IAAej5F,EAASj1B,MAAMjO,CAC9BgE,GAAAA,IAAUk/B,EAASm0D,OAAO8kC,CAAAA;AAC9B,cAAKn4H,CAAAA;AACJ,mBAAO,CAAA;AAER,cAAI0tG,IAAY1yG,EAAU6B,gBAAgBqiC,GAAUliC,CAAAA;AACpD,iBAAGmG,EAAIm5H,WACNF,IAAej5H,EAAIm5H,QAAQnE,CAAAA,EAAczqB,MAAa,CACnDuuB,GAAAA,KAAqB94H,EAAIm5H,QAAQpD,SAAS/1H,EAAIm5H,QAAQpD,MAAMl5H,EAAQqO,GAAAA,MACtEguH,IAAel5H,EAAIm5H,QAAQpD,MAAMl5H,EAAQqO,KAAKq/F,CAAc,KAAA,CAAA,IAEtD0uB,EAAa33H,OAAO43H,CAAAA,KAEpBl5H,EAAIg1H,CAAiB,KAAA,CAAA;AAAA,QAE7B,EA1DqBn8H,GAAWgB,GAAMi/H,GAAmB33H,IAAAA,IAC/CtI,IAKX,SAAyBA,GAAWigI,GAAmB/8F,GAAAA;AACtD,cAAI/7B,IAAMnI,EAAU4gI,uBAAuBO,kBAAkBj9F,IACzDi5F,IAAej5F,EAASj1B,MAAMjO,CAC9BgE,GAAAA,IAAUk/B,EAASm0D,OAAO8kC,CAC9B;AAAA,cAAA,CAAKn4H;AACJ,mBAAO,CAAA;AAER,cAAIu8H,IAAc,CAACvgI;AAEfigI,UAAAA,KACHzD,EAAex4H,GAASu8H,CAAAA;AAIzB,mBADIC,IAAgB,CACXt+H,GAAAA,IAAI,GAAGA,IAAIq+H,EAAYp+H,QAAQD;AAEvC,iBADIi6H,IAAej5F,EAASj1B,MAAMsyH,EAAYr+H,CAAAA,CAAAA,OACzBkkC,UAAaj/B,EAAIg1H,CACrCqE;AAAAA,cAAAA,IAAgBA,EAAc/3H,OAAOtB,EAAIg1H,CACnC,CAAA;AAAA,qBAAIh1H,EAAIi/B;AACd,uBAASvT,IAAI,GAAGA,IAAI1rB,EAAIi/B,UAAUjkC,QAAQ0wB,KAAI;AAC7C,oBAAIzzB,IAAQ+H,EAAIi/B,UAAUvT,CACtBzzB;AAAAA,gBAAAA,EAAM8jC,EAAS3gC,UAAeg+H,KAAAA,EAAYr+H,MAC7Cs+H,EAAc7+H,KAAKvC,CAEpB;AAAA,cAAA;AAIH,iBAAOohI;AAAAA,QACP,EAjCwBxgI,GAAWigI,GAAmB33H,IAAAA,IAAAA;AAAAA,MAEtD,GAAE5G,CAAAA,GAyEHA,EAAI++H,WAAWzhI,EAAUmZ,KAAK,SAAS0Y,GAAME,GAAAA;AAE5C,YAAI2vG,IAAiB1hI,EAAUgC,KAAKsH,KAAKiP,OAAO,QAAU,EAAA,IAAI/V,KAAKqvB,CAAAA,CAAAA,GAE/D/e,IApBL,SAAwB+e,GAAME,GAAImS,GAQjC;AAAA,mBAJIpxB,IAAQ,GACRorC,IAJiBl+C,EAAUgC,KAAKkiC,EAAS3rB,OAAO,QAAU,EAAA,IAAI/V,KAAKqvB,CAKnEi0B,CAAAA,GAAAA,IAAS5hB,EAAS4hB,QAClBC,IAAS7hB,EAAS6hB,QAChB7H,IAAcnsB;AACnBjf,YAAAA,KACAorC,IAAcl+C,EAAUgC,KAAKC,IAAIi8C,GAAa4H,GAAQC,CAGvD;AAAA,iBAAOjzC;AAAAA,QACP,EAM2B+e,GAAME,GAAIzoB,IAGrCA;AAAAA,aAAKu1H,SAAS/rH,GAId9S,EAAU6V,eAAe6rH,GAAgBp4H,KAAKiP,IAC9C;AAAA,MAAA,GAAE7V,CAEH1C,GAAAA,EAAUmJ,UAAU,iBAAgB,CAACzG,KAGrC1C,EAAU0C,EAAI6V,OAAK,OAAS,IAAA,SAASs0D,GACjCA;AAAAA,QAAAA,IACF7sE,EAAU2hI,oBAAoBj/H,KAG9B1C,EAAUg6F,cAAc9tF,MAAMxJ,GAAK2P,SAAAA;AAAAA,MAEtC,GAKCrS,EAAU,WAAS0C,EAAI6V,IAAAA,IAAM,SAAS4sC,GAAAA;AAErC,YAAIp/C,IAAKuD,KAAKs7C;AAId,YAHIt7C,KAAKR,aACR/C,IAAKuD,KAAK7E,SAAS6E,KAAKR,QAAAA,IAErBpG,EAAIwjC,cAAgBif,CAAAA,EAAIo1C,WAAW;AAGtC,cAFAp1C,EAAIo1C,YAAY,GAChBp1C,EAAI75B,KAAAA,CAAM5oB,EAAIyjC,KAAKzjC,EAAI83F,WACnBx6F,EAAUM,OAAOsgC,KAAK;AACzB,gBAAIw7F,IAAsBp8H,CAAAA,EAAU8C,WAAW4d,cAAc,6BAA+Bzf,EAAAA,MAAM8N,OAAO8I,QAAQ,MAAM,KACnHwkH,IAAe35H,EAAIwpG,gBAAgBxpG,EAAI21F,OAAOl1F,MAAUT,IAAAA,EAAI45H,YAAY55H,EAAI45H,YAAYn5H,SAAS,CAAA,EAAGjC;AACxGikD,YAAAA,EAAI75B,KAAKtrB,EAAU+gB,GAAGohC,aAClBz/C,EAAI65H,aAAattC,QAAavsF,KAAAA,EAAI65H,aAAangF,MAAMsyC,WAAW2tC,IAAeD,KAAsB15H,EAAIkT,UAAU,YAASuvC,EAAI75B,KAAKiwG,EAAAA;AAAAA,UACzI;AACDp2E,UAAAA,EAAI95B,KAAK3oB,EAAI+3F;AAAAA,QACb;AAAWz6F,YAAUM,OAAOsgC,MAG5BukB,EAAI75B,KAAM5oB,EAAIyjC,KAAGnmC,EAAU+gB,GAAGohC,cAF9BgD,EAAI75B,KAAK5oB,EAAIyjC;AAId,YAAI3kC,IAAWxB,EAAU66F,oBAAoBn4F,GAAKyiD,EAAI75B,CAOtD;AAAA,YALA65B,EAAI75B,IAAK,GACT65B,EAAIy8E,eAAe,IACnBz8E,EAAImC,SAAS,IAGTh+C,KAAKP,cAAc,UAAUO,KAAKR,YAAYQ,KAAKs7C,aAAa;AAC/D7+C,UAAAA,IAAKuD,KAAK7E,SAAS6E,KAAKR,QAAAA;AAA5B,cACIgyF,IAAaxxF,KAAKs7C;AAatB,cAXAO,EAAIv2C,WAAYtF,KAAKo8C,qBAAqBhjD,EAAImkD,qBAAqBnkD,EAAIokD,iBACnEg0C,EAAWR,gBADwDxzC,WAEtEg0C,EAAWR,eAAev0F,EAAGxE,aAAWC,KAAU,KAC9C8H,KAAKhJ,OAAOqlD,mBAAmBR,EAAIv2C,aACtCksF,EAAWR,cAAchxF,KAAKu8C,uBAAuB9/C,EAAGxE,YAAWC,GAAUkB,CAC7Eo4F,GAAAA,EAAWl1C,gBAAgBt8C,KAAKu8C,uBAAuB9/C,EAAGxE,YAAWwE,EAAGvE,UAAUkB,MAMhF4G,KAAKhJ,OAAOqlD,mBAAmBR,EAAIv2C,UAAS;AAE/C,gBAAIizH,IAAqBv4H,KAAKy9C,4BAA4BvlD,GAAUs5F,EAAWR,aAAa53F,GAAK,EAAA;AACjGlB,YAAAA,IAAW,IAAIgB,KAAKhB,IAAWqgI,CACnC;AAAA,UAAA;AAEIrgI,YAAAA,IAAWxB,EAAUgC,KAAKC,IAAIT,GAAUs5F,EAAWR,aAAa;QAEjE;AAkBD,YAhBIhxF,KAAKP,cAAc,YAAYhD,MAC/BuD,KAAKhJ,OAAOw3D,wBAAwBxuD,KAAKR,aACxCQ,KAAKo+C,qBAAqBlmD,IAAWuE,CAAAA,EAAGvE,WAC1C8H,KAAKo+C,mBAAAA,MACIp+C,KAAKo+C,oBAAAA,CAAqBlmD,KAAYuE,EAAGxE,eAClD+H,KAAKo+C,mBAAmB,MAG1BvC,EAAIwC,oBAAoBr+C,KAAKo+C,kBACzBp+C,CAAAA,KAAKhJ,OAAOw3D,wBAAwBxuD,KAAKR,YACzCQ,KAAKo+C,qBAAqBlmD,KAAaxB,CAAAA,EAAUgC,KAAKC,IAAI8D,EAAGvE,UAAWxB,CAAAA,EAAUM,OAAOq6B,WAAW,cACtGn5B,IAAWxB,EAAUgC,KAAKC,IAAI8D,EAAGvE,WAAWxB,EAAUM,OAAOq6B,WAAW,QAAA,KAKvEj4B,EAAIf;AACP,kBAAO2H,KAAKP,YAAAA;AAAAA,YACX,KAAK;AACCO,mBAAKhJ,OAAOqlD,oBAChBnkD,IAAWxB,EAAU8hI,2BAA2BvtH,KAAK7R,GAAKlB,KAEzC,GAAdkB,EAAIqjD,UAAU,UAChBZ,EAAImC;AAEN;AAAA,YACD,KAAK;AACDh+C,mBAAKs7C,gBAEHt7C,KAAKs7C,YAAYm9E,uBAAuB,QAAQz4H,KAAKs7C,YAAYm9E,kCACpEz4H,KAAKs7C,YAAYm9E,qBAAqB58E,EAAIwC,oBAE3CxC,EAAIwC,oBAAoBr+C,KAAKs7C,YAAYm9E,oBACzCvgI,IAAWxB,EAAU8hI,2BAA2BvtH,KAAK7R,GAAKlB,GAAAA,CAAW8H,KAAKs7C,YAAYm9E;;AAM1Fz4H,aAAKqxF,0BAA0Bj4F,GAAKyiD,CACjCA,GAAAA,EAAIngD,WAENsE,KAAK+xF,yBAAyB,EAACl2C,KAAIA,GAAK/kD,OAAMkJ,KAAK7E,SAAS6E,KAAKR,WAAWpC,MAAKhE,EAAAA,CAAAA,GAElFyiD,EAAI95B,IAAIjc,KAAKM,OAAOpG,KAAK88C,eAAe5kD,GAAS,KAAG8H,KAAKY,cAAY,MAAQZ,KAAKhJ,OAAOq6B,aACzFwqB,EAAIx2B,QAAQrlB,KAAKhJ,OAAOq6B,WAEpBj4B,EAAIf,kBAAkB2H,KAAKP,cAAc,cACzCvH,KAAY8H,KAAK69C,gBACnBhC,EAAIx2B,QAAQ3uB,EAAUgC,KAAKC,IAAIqH,KAAK69C,aAAazkD,EAAIojD,QAAQpjD,EAAIqjD,MAAUz8C,IAAAA,KAAK69C;AAIlF,YAAI66E,IAAc14H,KAAK+8C,gBAAgB/8C,KAAKw6B,WAAWqhB;AAOvD,eANG77C,KAAKw6B,aAAak+F,MACpB14H,KAAKs7C,YAAY2E,eAAe,KAE7By4E,KAAgB14H,KAAKw6B,UAAU6iB,cAClCxB,EAAIy8E,eAAe,KAEbz8E;AAAAA,MACT;AAAA,IACA,GAEAnlD,EAAUiiI,2BAA2B,SAAS/9F,GAC7C;AAAA,UAAI/7B,IAAM,CAAA;AACV,UAAI+7B,EAAStuB,UAAU;AACtBzN,QAAAA,IAAMnI,EAAUkiI,uBAAuB3tH,KAAK2vB,CAAAA;AAAAA,WACtC;AAKN,iBAHIwyD,IAAO12F,EAAU85D,mBACjB7qD,GAAAA,IAAQi1B,EAASj1B,OAEZ4kB,IAAI,GAAGA,IAAI6iE,EAAKvzF,QAAQ0wB,KAAK;AACrC,cAAIo8F,IAAMv5B,EAAK7iE,IACXsuG,IAAclS,EAAI/rF,EAAS3gC,UAC3B3B,GAAAA,IAAQsiC,EAASj1B,MAAOkzH,CAG5B;AAAA,cAAIj+F,EAASi7F,mBAAoBgD,CAAAA;AAChC,qBAAS9uH,KAAOpE;AACf,kBAAIA,EAAM1C,eAAe8G,CAAAA,GAAM;AAEzBlL,gBAAAA,EADLvG,IAAQqN,EAAMoE,CAAAA,CAAAA,MACGlL,EAAIvG,CAAS,IAAA,CAAA;AAC9B,oBAAI0mE,IAAQtoE,EAAU0M,WAAW,CAAE,GAAEujH,CAAAA;AACrC3nD,gBAAAA,EAAMpkC,EAAS3gC,UAAAA,IAAc8P,GAC7BlL,EAAIvG,CAAAA,EAAOe,KAAK2lE,CAChB;AAAA;AAAA,cACA;AAAA;AAIGngE,YAAAA,EAAIvG,CAAQuG,MAAAA,EAAIvG,KAAS,CAC9BuG,IAAAA,EAAIvG,GAAOe,KAAKstH,CAAAA;AAAAA,QAEjB;AAGD9nH,QAAAA,EAAIm5H,UAAUthI,EAAUkiI,uBAAuB3tH,KAAK2vB,CAAAA;AAAAA,MAIpD;AACD,aAAO/7B;AAAAA,IACR,GAEAnI,EAAUoiI,8BAA8B,SAAS57H,GAChDxG;AAAAA,QAAU0lC,YAAY,CAAA;AACtB,YAAMmY,IAAgBr3C,EAAUka,cAAc,wBAAA,GACxCZ,IAAOjU,MAAMgS,UAAU9R,MAAMwI,KAAKspC,EAAckB,QAElD/+C;AAAAA,QAAU4gI,0BAA0B5gI,EAAU4gI,uBAAuByB,2BACxEriI,EAAU4gI,uBAAuByB,yBAAyB,CAAA,IAE3DviH,EAAK1b,QAAQ,SAAS0uC,GACrB;AAAA,cAAM2/D,IAAW10F,OAAO+0B,EAAI3uC,aAAa,oBAAA,CAAA;AACrB0H,cAAMgS,UAAU9R,MAAMwI,KAAKu+B,EAAIiM,QAAAA,EACvC36C,QAAQ,SAASmmB,GAC5B;AAAA,gBAAMxF,IAAUwF,EAAMpmB,aAAanE,EAAUM,OAAO0C,eAAAA;AACpD,cAAG+hB,MACF/kB,EAAU0lC,UAAU/iC,KAAK4nB,CACrBvqB,GAAAA,EAAU4gI,0BAA0B5gI,EAAU4gI,uBAAuByB,yBAAwB;AAEhG,kBAAMC,IAAmBtiI,EAAU4gI,uBAAuByB;AACrDC,YAAAA,EAAiB7vB,CACrB6vB,MAAAA,EAAiB7vB,KAAY,CAC9B6vB,IAAAA,EAAiB7vB,GAAU9vG,KAAKoiB,CAAAA;AAAAA,UAChC;AAAA,QAEL,CACA;AAAA,MAAA,CAAA;AAAA,IAEA,GAEA/kB,EAAUu/H,wBAAwB,SAASx5H,GAAIyf,GAC9C;AAAA,UAAIxgB,IAAUe,EAAGuD,KAAK/F;AACtB,UAAKyB,CAAAA;AACJ,eAAO;AAER,UAAIi4H,IAASl3H,EAAGu+B,SAEZw1D,IAAU95F,EAAUisG,eAAelmG,GAAAA,IAAWuD,IAC9Ci5H,GAAAA,IAAQviI,EAAUisG,eAAelmG,GAAI,IAAMuD,OAI3Ck5H,IAAexiI,EAAUyiI,6BAA6BziI,EAAUyiI,2BAA2B18H,GAAIuD,IAAQA,IAAAA,KAAK0zH,eAAej3H,CAAAA,GAC3H41D,IAAK6mE,IAAe;AACxB,UAAKz8H,CAAAA,EAAGs3D,UAAU/zD,KAAK4zH,YAAY,QAAQ;AAC1C,YAAIwF,IAAc38H,EAAGw+B,SAAS04F;AACX,QAAfyF,KAAe,MAClBA,IAAc,IAEf/mE,KAAIA,IAAG,KAAChqD,IAAkB;AAAA,MAC1B;AAID,UAAI0Z,IAAIrrB,EAAU2iI,wBAAwB3iI,EAAU2iI,sBAAsB58H,EAAGu+B,SAASk+F,KAAgBl5H,KAAKwzH,YAAY/2H,CAEnH68H,GAAAA,IAAiBJ,IAAan3G,IAAE;QAChC/hB,KAAKu5H,eAAe79H,MAAasE,KAAKu5H,eAAe79H,KAAW49H,OACnEt5H,KAAKu5H,eAAe79H,CAAAA,IAAW49H;AAGhC,UAAIloF,IAAK16C,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAAA;AACnE20C,MAAAA,IAAK,yBAAuBA,KAAI,KAE7B16C,EAAU4E,SAAWo/C,EAAAA,aAAaj+C,EAAG9C,OACvCy3C,KAAM,4BAGJ30C,EAAG+8H,kBACLpoF,KAAM;AAGP,UAAIqnB,IAAYh8D,EAAGg6D,QAAO,sCAAoCh6D,EAAGg6D,QAAM,MAAK,IACxEA,IAASh6D,EAAGu6D,YAAW,iCAA+Bv6D,EAAGu6D,YAAU,MAAK,IACxE9jD,IAAOxc,EAAUya,UAAUuiB,eAAej3B,EAAGxE,YAAWwE,EAAGvE,UAASuE,CAAAA;AAExE,YAAMiJ,IAAQI,KAAKC,IAAI,GAAEkzH,IAAMzoC,CAC5B9qF;AAAAA,MAAAA,IAAQ,OACV0rC,KAAM,0BAEJ1rC,IAAQ,OACV0rC,KAAM;AAGP,UAAIh5C,IAAK,UAAQ1B,EAAU66B,SAAS42B,mBAAmB1rD,CAAI,IAAA,gBAAcA,EAAG9C,KAAG,OAAKjD,EAAUM,OAAO0C,kBAAgB,OAAK+C,EAAG9C,KAAG,cAAYy3C,IAAG,cAAYqnB,IAAShC,IAAM,4BAA0B10C,IAAE,iBAAeswC,IAAG,UAAQ37D,EAAUM,OAAOsgC,MAAM,WAAS,WAASk5D,IAAQ,eAAa9qF,IAAM,SAAOjJ,EAAG85D,eAAa,MAAI;AAC/T,UAAI7/D,EAAUM,OAAOqsD,eAAAA,CAAgB3sD,EAAUM,OAAOy6B,UAAU;AAC/D,YAAIgoG,IAAmB,oBAEnBC,IAAWrnE,IAAK,GAChBsnE,IAAe,iBAAeF,IAAiB,MAAIA,IAAiB,4BAA0BC,IAAS,eACvGE,IAAa,iBAAeH,IAAiB,MAAIA,IAAiB,0BAAwBC,IAAS;AACvGthI,QAAAA,MAAUqE,EAAGu2F,mBAAkC,KAAf2mC,MAAuBl9H,EAAGw2F,iBAA8B,KAAb2mC;AAAAA,MAC3E;AAGD,UAFAxhI,KAAS8a,IAAK,WAETgJ;AACJ,eAAO9jB;AAGP,UAAIiQ,IAAI/D,SAASC,cAAc,KAC/B8D;AAAAA,MAAAA,EAAE7D,YAAYpM;AAEd,UAAIyhI,IAAgB75H,KAAKmF,QAAQzJ;AAC7Bm+H,MAAAA,MACHnjI,EAAU0lC,UAAU/iC,KAAKgP,EAAE1B,aAC3BkzH,EAAcp1H,YAAY4D,EAAE1B,UAG/B;AAAA,IAAA;AA8GA,QAAImzH,IAAqB,SAAS/rG,GAAAA;AAEjC,aADY3zB,OAAO2zB,CAAAA,EACNxf,QAAQ,MAAM,QAAA,EAAUA,QAAQ,MAAM,QAAA;AAAA,IACpD;AA4SA,aAASwrH,EAAuBr+H,GAAAA;AAC/B,aAAQA,EAAQ+J,UAAAA,CAAWuY,MAAMvJ,OAAO/Y,EAAQ+J;IACjD;AAkLA,aAASu0H,EAA2BC,GAAAA;AACnC,aAAOvjI,EAAU42B,SAASsf,WAAWqtF,CAAAA;AAAAA,IACtC;AA8DA,aAASC,EAAuB/gH,GAAM/b,GACrC;AAAA,UAAI81H,IAAiB/5G,EAAK/B,cAAc,4BAAA;AAIxC,aAHKha,EAAKw/B,eACTs2F,IAAiBx8H,EAAU8C,WAAW4d,cAAc,eAE9C87G,IAAAA;AAAAA,IACR;AAMA,aAASiH,IACR;AAAA,aAAOzjI,EAAU8C,WAAW4d,cAAc;IAC3C;AA5iBA1gB,MAAUkiI,yBAAyB,WAOlC;AAAA,aAJavE,EADH39H,EAAU85D,mBACgBxwD,GAAAA,IAAAA;AAAAA,IAKrC,GAGAtJ,EAAUisG,iBAAiB,SAAelmG,GAAI29H,GAAYpjI;AACzD,UAAIgrB,IAAI,GACJ0a,IAAO1lC,EAAOqjI,OACdhiI,IAAiBrB,EAAOqB,gBAExBiiI,IAAgB,GAChB5hI,IAAOmgB,IAAepc,EAAGvE,WAAWuE,EAAGxE;AAE3C,MAAGjB,EAAOylD,UAAU,YAEnB/f,IAAsB,KADF,IAAIxjC,KAAK,IAAIA,KAAKR,CAAMkb,EAAAA,YAAAA,GAAe,IAAI1a,KAAKR,GAAMmb,SAAW,IAAA,GAAG,GAAGtV,QAClE,IAAA,KAAG,KAAG,MAAM7H,EAAU2O,MAAM,CAAA,IAEnD3M,EAAKS,YAAUzC,EAAUiK,UAAUxH,cACrCT,IAAOhC,EAAUiK;AAClB,UAAIoD,IAAQrL,IAAOhC,EAAU6jI;AAE7B,UAAIx2H,IAAQ,GAAE;AACb,YAAIzL,IAAQ5B,EAAU6B,gBAAgBvB,GAAQ0B,CAAAA;AAC1ChC,UAAU4O,SAAShN,CACtBD,MAAAA,IAAAA;AAED,iBAASuB,IAAI,GAAGA,IAAItB,GAAOsB;AAC1BooB,UAAAA,KAAKtrB,EAAU2O,MAAMzL,CAGtB;AAAA,YAAI4gI,IAAc9jI,EAAU8hI,2BAA2B51H,MAAM5L,GAAQ,CAAC0B,KAEjEL,CAAAA;AAAAA,QAAAA,IAAAA,CAYCK,IAAQ8hI,CAAAA,KAAeJ,MAC3BE,IAAgB5jI,EAAU2O,MAAM/M,CAAAA,MAZjCyL,IAAQrL,IAAO8hI,GACXxjI,EAAO8J,cAAc9J,EAAO+J,cAC/BgD,KAAgB/M,EAAOumD,qBACX,MAAGx5C,IAAQ,KACvBu2H,IAAgBx0H,KAAKM,MAAMrC,IAAM24B,CACbhmC,KAAAA,EAAU2O,MAAM/M,CACnCgiI,MAAAA,IAAgB5jI,EAAU2O,MAAM/M,CAAAA,MAEjCgiI,IAAgBx0H,KAAKM,MAAMrC,IAAM24B,CAOnC;AAAA,MAAA;AAcD,aALE1a,KALEo4G,MAECr2H,MAAU,KAAM1L,KAGdiiI,IAAgB,IAGjBA;AAAAA,IAGP,GAEA5jI,EAAU8hI,6BAA6B,SAA0B9/H,GAAM+hI,GAAAA;AACtE,UAAIniI,IAAQ5B,EAAU6B,gBAAgByH,MAAMtH,IACxCF,IAAewH,KAAKvH,SAASH,CAIjC;AAAA,aAHImiI,KAAe/hI,CAAAA,KAAAA,CAASsH,KAAKvH,SAASH,OACzCE,IAAgBwH,KAAKvH,SAASH,IAAM,CAAA,IAAM0H,KAAKvH,SAASH,IAAM,CAAK5B,IAAAA,EAAUgC,KAAKC,IAAIqH,KAAKvH,SAASH,CAAAA,GAAQ0H,KAAKw8C,QAAQx8C,KAAKy8C,UAExH,IAAIvjD,KAAKV,CACjB;AAAA,IAAA,GAEA9B,EAAUgkI,yBAAyB,SAAsB77H,GAExD;AAAA,UAAGnI,EAAU0lD;AAMZ,iBALI7zB,GACHE,GACAmiF,GACAnuG,GAEO7C,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAI;AAMlC,eALA6C,IAAKoC,EAAIjF,CAAAA,GACTgxG,IAAU,IACVriF,IAAO7xB,EAAU6B,gBAAgByH,MAAMvD,EAAGxE,aAC1CwwB,IAAK/xB,EAAU6B,gBAAgByH,MAAMvD,EAAGvE,QAElCqwB,GAAAA,IAAOE,KAAG;AACf,iBAAI/xB,EAAU4O,SAASijB,IAAM;AAC5BqiF,cAAAA,IAAAA;AACA;AAAA,YACA;AACDriF,YAAAA;AAAAA,UACA;AACGqiF,UAAAA,KAAWriF,KAAQE,KAAO/xB,EAAU4O,SAASmjB,OAC5ChsB,EAAGvE,WAAAA,CAAY8H,KAAKvH,SAASgwB,CAAAA,MAChCmiF,IAAU,KAGRA,MACH/rG,EAAIqJ,OAAOtO,GAAG,CAAA,GACdA;AAAAA,QAED;AAAA,IAEH,GAGAlD,EAAUikI,sCAAsC,SAAS97H,GACxD;AAAA,UAAIA,KAAOmB,KAAKsM,UAAU,QAAO;AAEhC5V,UAAUgkI,uBAAuBzvH,KAAKjL,MAAMnB,CAE5CA,GAAAA,EAAIyiB,KAAKthB,KAAKshB,QAAQ,SAASzI,GAAEC,GAChC;AAAA,iBAAID,EAAE5gB,WAAWkB,QAAAA,KAAa2f,EAAE7gB,WAAWkB,QAAAA,IACnC0f,EAAE3gB,SAASiB,QAAY2f,IAAAA,EAAE5gB,SAASiB,QAAa,IAAA,KAAI,IACpD0f,EAAE5gB,aAAa6gB,EAAE7gB,aAAa,IAAA;AAAA,QACxC,CAAA;AAME,iBALIyvC,IAAM,CACNkzF,GAAAA,IAAa/7H,EAAIhF,QACjBghI,IAAAA,IAAeC,IAAgB,MAG1BvwG,IAAE,GAAGA,IAAEqwG,GAAYrwG,KAAI;AAC/B,cAAI9tB,IAAKoC,EAAI0rB,CAAAA;AACb9tB,UAAAA,EAAGs3D,SAAS;AAMZ,mBAJIgnE,IAAiB/6H,KAAmB,iBAAItJ,EAAU8hI,2BAA2B51H,MAAM5C,MAAM,CAACvD,EAAGxE,YAAAA,EAAsBwE,CAAAA,IAAAA,EAAGxE,YAInHyvC,EAAM7tC,UACG6tC,EAAMA,EAAM7tC,SAAO,GACrB3B,SAASiB,QAAAA,KAAa4hI,EAAc5hI,QAAAA;AAChDuuC,YAAAA,EAAMx/B,OAAOw/B,EAAM7tC,SAAO,GAAE,CAI7B;AAID,mBADIq6D,IAAAA,IACI90D,IAAE,GAAGA,IAAEsoC,EAAM7tC,QAAQuF,KAAI;AAChC,gBAAI40D,IAAOtsB,EAAMtoC,CACjB;AAAA,gBAAG40D,EAAK97D,SAASiB,QAAa4hI,KAAAA,EAAc5hI,WAAU;AACrD+6D,cAAAA,IAAAA,IACAz3D,EAAGu+B,UAAQg5B,EAAKh5B,SAChB0M,EAAMx/B,OAAO9I,GAAE,CACf3C,GAAAA,EAAGs3D;AACH;AAAA,YACA;AAAA,UACD;AAOD,cAJIrsB,EAAM7tC,WACT6tC,EAAMA,EAAM7tC,SAAO,CAAGk6D,EAAAA,SAAAA,MAGlBG;AACJ,gBAAIxsB,EAAM7tC;AACT,kBAAI6tC,EAAM7tC,UAAU6tC,EAAMA,EAAM7tC,SAAS,CAAGmhC,EAAAA,SAAS;AACpD,oBAAK0M,EAAMA,EAAM7tC,SAAS,CAAA,EAAGmhC;AAG5B,2BAAS1iB,IAAI,GAAGA,IAAIovB,EAAM7tC,QAAQye,KAAK;AAEtC,6BADI67C,IAAAA,IACKlrD,IAAI,GAAGA,IAAIy+B,EAAM7tC,QAAQoP;AACjC,0BAAIy+B,EAAMz+B,CAAAA,EAAG+xB,WAAW1iB,GAAG;AAC1B67C,wBAAAA;AACA;AAAA,sBACA;AAEF,wBAAA,CAAKA,GAAY;AAChB13D,sBAAAA,EAAGu+B,UAAU1iB;AACb;AAAA,oBACA;AAAA,kBACD;AAAA;AAdD7b,kBAAAA,EAAGu+B,UAAU;AAedv+B,gBAAAA,EAAGs3D,SAAAA;AAAAA,cACH,OACI;AAEJ,yBADIK,IAAc1sB,EAAM,CAAA,EAAG1M,SAClB9iB,IAAI,GAAGA,IAAIwvB,EAAM7tC,QAAQqe;AAC7BwvB,kBAAAA,EAAMxvB,CAAG8iB,EAAAA,UAAUo5B,MACtBA,IAAc1sB,EAAMxvB,GAAG8iB;AACzBv+B,gBAAAA,EAAGu+B,UAAUo5B,IAAc,GACxBymE,IAAWp+H,EAAGu+B,YAChB6/F,IAAWp+H,EAAGu+B,SACd8/F,IAAgBr+H,IAEjBA,EAAGs3D,SAAAA;AAAAA,cACH;AAAA;AAGDt3D,cAAAA,EAAGu+B,UAAU;AAGf0M,UAAAA,EAAMruC,KAAKoD,IAEPirC,EAAM7tC,UAAQ6tC,EAAM2sB,aAAW,MAClC3sB,EAAM2sB,YAAU3sB,EAAM7tC,QACtB4C,EAAGw+B,SAAOyM,EAAM7tC,UAGhB4C,EAAGw+B,SAAQx+B,EAAS,SAAEA,EAAGw+B,SAAO;AAAA,QAEjC;AAED,iBAASu+B,IAAE,GAAGA,IAAI36D,EAAIhF,QAAQ2/D;AAC7B36D,UAAAA,EAAI26D,CAAGv+B,EAAAA,SAASyM,EAAM2sB,WAEnB39D,EAAUonE,kBACZpnE,EAAUonE,eAAej/D,EAAI26D,CAAAA,CAAAA;AAAAA,SAI5BshE,KAAiBj8H,EAAI,CAAA,MACvBnI,EAAUu/H,sBAAsBhrH,KAAKjL,MAAM86H,KAAiBj8H,EAAI,CAAA,GAAA;MAEjE;AAAA,IACF,GAEAnI,EAAUskI,4BAA4B,SAAyBn8H,GAC9D;AAAA,UAAIzG,IAAO;AACX,UAAIyG,KAAOmB,KAAKsM,UAAU;AAEzB,iBAAS2kB,IAAE,GAAGA,IAAEpyB,EAAIhF,QAAQo3B;AAC3B74B,UAAAA,KAAM1B,EAAUu/H,sBAAsBhrH,KAAKjL,MAAMnB,EAAIoyB,MAGvD;AAAA,aAAO74B;AAAAA,IACR,GAEA1B,EAAUukI,+BAA+B,SAAyBp8H,GACjE;AAAA,UAAIzG,IAAO;AACX,UAAIyG,KAAOmB,KAAKsM,UAAU,QAAO;AAEhC,YAAIlP,IAAO1G,EAAUY,QAEjB4L,GAAAA,IAAM,CAAA;AAIVrE,QAAAA,EAAI/D,QAAQ,SAAShE,GAAAA;AAHH,cAAS2kB,GAASo5G;AAInC3xH,UAAAA,EAJ0BuY,IAIV3kB,EAAM6C,IAJak7H,IAIT/9H,EAAMsG,EAAKnD,aAH9BwhB,IAAU,MAAMo5G;QAI1B,CAAA;AAWE,iBAAS5jG,IAAE,GAAGA,IAAEpyB,EAAIhF,QAAQo3B;AAC3B74B,UAAAA,KAAM1B,EAAUu/H,sBAAsBhrH,KAAKjL,MAAMnB,EAAIoyB,CAAI,GAAA,EAAA;AAAA,MAE1D;AACD,aAAO74B;AAAAA,IACR,GAIA1B,EAAUwkI,4BAA4B,SAAU7yH,GAAGjL,GAClD;AAAA,UAAI+9H,IAAQ,CAAA;AAuBZ,aArBA/9H,EAAKo6H,cAAcnvH,EAAE0R,cAGrBohH,EAAMC,sBAAsB1kI,EAAUM,OAAOsgC,MAAM,mBAAkB,mBAAmBl6B,EAAKy/B,KAAK,OAClGs+F,EAAME,sBAAsB,YAAYj+H,EAAKy/B,KAAK,OAC9Cz/B,EAAKw/B,cAERu+F,EAAMC,sBAAsB,aAAah+H,EAAKo6H,cAAc,KAAK,OAC7Dp6H,EAAKk+H,iCACRl+H,EAAKk+H,oBAAoBrJ,EAAAA,IACvB70H,EAAKg4H,qBACPh4H,EAAKm+H,sBAAsB,IAE3Bn+H,EAAKm+H,sBAAsBn+H,EAAKk+H,mBAGjCH,EAAME,uBAAwB,aAAaj+H,EAAKo6H,cAAc,IAAIp6H,EAAKm+H,uBAAuB,UAE9FJ,EAAMC,sBAAsB,aAAah+H,EAAKo6H,cAAc,KAAK,OACjE2D,EAAME,uBAAwB,aAAaj+H,EAAKo6H,cAAc,KAAK,yBAE7D2D;AAAAA,IACR,GAsBAzkI,EAAUo9H,8BAA8B,SAAS12H,GAAMxD;AACtD,UAAI8B,IAAU0B,EAAK2xF,OAAOn1F,CAAAA,GACtBuhI,IAAQ/9H,EAAK04H,OAAO14H,EAAKkP,QAAQ5Q,GAAS0B,CAAAA;AAO9C,UALA1G,EAAU6tF,OAAO42C,GAAO,EACvB11H,QAAQrI,EAAKovB,GAIVpvB,CAAAA,GAAAA,EAAKqyF,sBAAuBsqC,CAAAA,EAAuBr+H,CAAU,GAAA;AAChE,YAAI8/H,IA1BN,SAA2Bp+H,GAAMq+H,GAChC;AAAA,cAAIC,IAAc,GACdC,IAAwBv+H,EAAK2xF,OAAOl1F,QACpC+hI,IAAoB;AASxB,iBARAx+H,EAAK2xF,OAAOj0F,QAAQ,SAASY;AACzBq+H,YAAAA,EAAuBr+H,CAAAA,MACzBggI,KAAejnH,OAAO/Y,EAAQ+J,MAAAA,GAC9Bm2H,KAAqBnnH,OAAO/Y,EAAQ+J,SACpCk2H;AAAAA,UAEH,CAAA,GAEQ,EAAED,aADTA,KAAeC,IAAwBF,GACjBE,uBAAuBC,GAAAA,mBAAAA,EAAAA;AAAAA,QAC9C,EAauCx+H,GAAM+9H,EAAM11H,MAE7Co2H,GAAAA,IAAsBz+H,EAAKw/B,aAAax/B,EAAKo6H,cAAc9gI,EAAU+gB,GAAGshB,eAAe37B,EAAKo6H;AAC5FgE,QAAAA,EAAaE,cAAcG,KAAuBL,EAAaG,wBAAwB,MAC1FR,EAAM11H,SAASK,KAAKC,IAAIo1H,EAAM11H,QAAQK,KAAK+D,OAAOgyH,IAAsB,IAAIL,EAAaI,qBAAqBJ,EAAaG,qBAAAA,CAAAA;AAAAA,MAE5H;AAQD,UANG5B,EAAuBr+H,CAAAA,MACzBy/H,EAAM11H,SAASgP,OAAO/Y,EAAQ+J,MAG/BrI,IAAAA,EAAKwlG,gBAAgBlnG,EAAQqO,GAAAA,IAAOoxH,EAAM11H,QAAAA,CAEtC01H,EAAMW,cAAa;AACtBX,QAAAA,EAAMW,eAAe;AAErB,YAAIC,IAAcrlI,EAAUya,UAAU/T,EAAK6R,OAAK,eAAA,EAAiB7R,EAAK2xF,OAAOn1F,GAAGmQ,KAAK3M,EAAK2xF,OAAOn1F,CAAG8wB,EAAAA,OAAOttB,EAAK2xF,OAAOn1F,CAAAA,CAAAA;AACpHmiI,QAAAA,MACFZ,EAAMW,gBAAgB,MAAMC,IAG1B3+H,EAAK46D,YACPmjE,EAAMW,gBAAgB;AAAA,MAEvB;AAeD,aAdIX,EAAMa,eACTb,EAAMa,aAAatlI,EAAUya,UAAU/T,EAAK6R,OAAK,gBAAgB7R,EAAK2xF,OAAOn1F,GAAGmQ,KAAK3M,EAAK2xF,OAAOn1F,CAAAA,EAAG8wB,OAAOttB,EAAK2xF,OAAOn1F,CAExHlD,CAAAA,IAAAA,EAAU6tF,OAAO42C,GAAO,EAEvBc,cAAc,IACdvjC,cAAc,YAAUyiC,EAAM11H,SAAO,OACrCgzF,aAAa,WAAUr7F,EAAO,KAAE,OAEhC8+H,YAAY,WAAS9+H,EAAK++H,QAAM,OAEhCC,iBAAiB,GAGXjB,CAAAA,GAAAA;AAAAA,IACR,GA2BAzkI,EAAU2lI,iCAAiC,SAASj/H,GAAMxD,GAAGuhI;AAC5D,UAAG/9H,EAAKu4H,YAAW;AAClB,YAAI2G,IAAkBl/H,EAAKm8H,eAAen8H,EAAK2xF,OAAOn1F,CAAAA,EAAGmQ,QAAM;AAC5D3M,QAAAA,EAAKw4H,sBACP0G,KAAmBl/H,EAAKw4H,oBAEzBuF,EAAM11H,SAAU62H,IAAgBnB,EAAM11H,SAAQ62H,IAAgBnB,EAAM11H,QACpE01H,EAAMziC,eAAe,YAAUyiC,EAAM11H,SAAO,OAC5C01H,EAAMoB,oBAAoB,kBAAkBpB,EAAM11H,SAAS,KAAK,OAChErI,EAAKwlG,gBAAgBxlG,EAAK2xF,OAAOn1F,CAAAA,EAAGmQ,OAAOoxH,EAAM11H;AAAAA,MACjD;AAKD,aAJA01H,EAAMziC,eAAe,YAAUyiC,EAAM11H,SAAO,OAC5C01H,EAAMoB,oBAAoB,kBAAkBpB,EAAM11H,SAAS,KAAK,OAChErI,EAAKwlG,gBAAgBxlG,EAAK2xF,OAAOn1F,CAAGmQ,EAAAA,GAAAA,IAAOoxH,EAAM11H,QAE1C01H;AAAAA,IACR,GAIAzkI,EAAU8lI,2BAA2B,SAASn0H,GAAGjL;AAChD,UAAI81H,IAAiB7qH,EAAE+O,cAAc,4BACrC87G;AAAAA,MAAAA,EAAe/yG,YAAY/iB,EAAK+zF,aAAa,GAC7C/zF,EAAK61H,aAAantC,eAAeotC,GAAgB91H,EAAK8zF,aAAa,CAAA,GAC/D9zF,EAAK61H,aAAattC,aAAavoF,EAAK61H,aAAangF,MAAMuyC,UAAU6tC,EAAe7yG,cAAcjjB,EAAK++H,QAAQjJ,EAAej5G,cAAc7c,EAAKy/B,OAAIq2F,EAAe7yG,cAAc4xG,EAAAA;AAAAA,IACnL,GAGAv7H,EAAU+lI,4BAA4B,SAASr/H,GAAM+iB,GAAWE,GAAYqlE,GAAAA;AAC3EtoF,MAAAA,EAAK+zF,YAAYhxE,KAAa,GAC9B/iB,EAAK8zF,YAAY7wE,KAAc;AAAA,IAChC,GAMA3pB,EAAUgmI,uCAAuC,SAAS9iI,GAAGuhI,GAAOwB,GAASp2F,GAAOq2F,GACnF;AAAA,UAAIzkI,IAAM;AAKV,aAJGykI,EAAehtG,aACjBz3B,KAAO,OAAOykI,EAAehtG,SAASgtG,EAAelhI,SAASkhI,EAAex/H,IAAAA,KAAO,MAG9E,sCAAoCjF,IAAI,wBAAsB2hI,EAAmBvzF,CAAAA,IAAO,2BAA2B3sC,IAAI,cAC7HuhI,EAAMe,aAAaf,EAAMziC,eAAe,6BAA8B7/E,IAAW;AAAA,IACnF,GAEAniB,EAAUmmI,sCAAsC,SAAS1B,GAAAA;AACxD,aAAO,gEAAgEA,EAAMziC,eAAeyiC,EAAMoB,oBAAoB;AAAA,IACvH,GAEA7lI,EAAUomI,8BAA8B,SAASC,GAAOC,GAAO5/H,GAAMX,GAAI0+H,GAAO8B,GAC/E;AAAA,UAAIhD,IAAW78H,EAAK3E,SAASskI,IACzBG,IAAc9/H,EAAK2xF,OAAOiuC,CAAAA,GAC1BG,IAAYzmI,EAAU2O,MAAM03H,CAE5BK,GAAAA,IAAiBpD,EAA0BC,CAE3Cj2F,GAAAA,IAAUttC,EAAUya,UAAU/T,EAAK6R,OAAO,aAAexS,EAAAA,GAAIw9H,GAAUiD,CAC3E;AAAA,aAAO,uBAAqBH,IAAM,sBAAoBK,IAAe,qDACpE1mI,EAAUya,UAAU/T,EAAK6R,OAAO,aAAA,EAAexS,GAAIw9H,GAAUiD,CAAAA,IAC7D,oBAAiB5tD,IAAiB,QAAS6rD,EAAkB,eAAIA,EAAMoB,qBAAqB7lI,EAAUM,OAAOsgC,MAAM,YAAY,aAAU9oB,IAFnI,kCAGuBw1B,IAAU;AAAA,IACzC,GAGAttC,EAAU2mI,yCAAyC,SAASzjI,GAAGuhI,GAAOwB,GAASp2F;AAC9E,aAAO,iBAAiB40F,EAAMe,aAAa,MAAMf,EAAMziC,eAAe,6BAA2BikC,IAAQ,2BAAyB7C,EAAmBvzF,CAAAA,IAAO,2BAAyB3sC,IAAE;AAAA,IACxL,GAEAlD,EAAU4mI,sCAAsC,SAASnC,GAAOyB,GAAAA;AAC/D,UAAIzkI,IAAMgjI,EAAMiB;AAIhB,aAHGQ,EAAehtG,aACjBz3B,KAAO,OAAOykI,EAAehtG,SAASgtG,EAAelhI,SAASkhI,EAAex/H,IAAAA,KAAO,MAE9E,uCAAuCjF,IAAM,cAAcgjI,EAAMe,aAAa,MAAMf,EAAMziC,eAAe;AAAA,IACjH,GAEAhiG,EAAU6mI,qCAAqC,WAC9C;AAAA,aAAO;AAAA,IACR,GAMA7mI,EAAU8mI,6BAA6B,SAAST,GAAOC,GAAO5/H,GAAMX,GAAIwgI,GAAalF,GAAAA;AAEpF,UAAIkC,IAAWD,EAA0B58H,EAAK3E,SAASskI,KACnDG,IAAc9/H,EAAK2xF,OAAOiuC,CAE1Bh5F,GAAAA,IAAU;AACX5mC,MAAAA,EAAKqgI,kBACPz5F,IAAUttC,EAAUya,UAAU/T,EAAK6R,OAAO,aAAexS,EAAAA,GAAIW,EAAK3E,SAASskI,CAAAA,GAAQG,GAAanF,CAAAA;AAGjG,UAAI70B,IAAa,iBAAiB9lG,EAAKwlG,gBAAgBs6B,EAAYnzH,GAAO,IAAA;AAE1E,UAAI2zH,IAAY;AAKhB,aAJG15F,MACF05F,IAAY,2DAAyDx6B,IAAW,OAAOl/D,IAAU,WAG3F,wDACNttC,EAAUya,UAAU/T,EAAK6R,OAAO,aAAexS,EAAAA,GAAIW,EAAK3E,SAASskI,IAAQG,GAAanF,CAAAA,IACtF,oBAAqBrhI,EAAU2O,MAAM03H,KAAU,UAAUrmI,EAAUM,OAAOsgC,MAAM,WAAW,WAAQ19B,IAAmB,wBAAuBmjI,IAAO,sBAAoB9C,IAAS,QACjLyD,IAAY;AAAA,IACd,GAKAhnI,EAAUinI,gCAAgC,SAASvgI,GAAM+qF;AACxD,UAAI3tF,IAAU9D,EAAU8C,WAAW4d,cAAc;AAIjD,UAHG5c,KACFA,EAAQumB,OAAAA,GAAAA,CAELonE;AACH;AAGD3tF,MAAAA,IAAU8J,SAASC,cAAc;AACjC,UAAIq5H,IAAkB;AACnBxgI,MAAAA,EAAKsjH,iBACPkd,KAAmB;AAGpB,UAAIxvC,IAAe13F,EAAU+gB,GAAGqhC;AAChCt+C,MAAAA,EAAQgL,YAAYo4H,GACpBpjI,EAAQ7C,MAAMgzC,UAAU,CACvB,WAAavtC,EAAO,KAAI,MACxB,YAASxD,IAAoB,MAC7B,iBAAcA,IAAoB,MAClC,WACClD,EAAUM,OAAOsgC,MAAM,cAAc,YACrCnzB,KAAK,GAAA,GAEP3J,EAAQgK,YAAY9N,EAAUya,UAAU/T,EAAK6R,OAAO,eAAiB7R,EAAAA,CAAAA;AAErE,YAAM2xB,IAASr4B,EAAU8C,WAAW4d,cAAc;AAClD5c,MAAAA,EAAQ7C,MAAMC,MAAM,GAAGm3B,EAAOxP,SAC9B/kB,MAAAA,EAAQ7C,MAAM8N,SAAS,GAAGspB,EAAOhV,YAAAA,MACjCrjB,EAAU8C,WAAWiL,YAAYjK;IAElC,GAoTA9D,EAAUmnI,oBAAoB,SAAiBx1H,GAE9C;AAAA,UAAIy1H,IAAcpnI,EAAUwkI,0BAA0B7yH,GAAGrI,IAGrD+9H,GAAAA,IAAkB/9H,KAAK48B,aAAkB,kCAAL,IAEpCxkC,IAAO,4CACP4lI,IAAgB,oDAAkDF,EAAYzC,sBAA9D,0CAEhB4C,IAAc,0CAA0CF,IAAiB,cAAYD,EAAY1C,qBAAnF;AAGf1kI,QAAUiyB,cACZjyB,EAAU4xB,MAEX5xB,GAAAA,EAAU4gI,uBAAuB4G,yBAAyBr/H,CAAAA;AAC1D,UAAIA,IAAMnI,EAAU4gI,uBAAuBO,kBAAkB73H,IAAAA;AAC7DtJ,QAAU4gI,uBAAuB6G,oBAAoBt/H;AAGrD,eADIqjD,IAAO,GACFtoD,IAAE,GAAGA,IAAIlD,EAAU2O,MAAMxL,QAAQD;AACzCsoD,QAAAA,KAAMxrD,EAAU2O,MAAMzL,CAAAA;AAEvB,UAAI8iC,IAAO,oBAAIxjC,QACXkpD,IAAY1rD,EAAU2O,MAAMxL,SAAOnD,EAAU0lD;AACjD1f,MAAAA,KAAShmC,EAAUgC,KAAKC,IAAI+jC,GAAM18B,KAAKw8C,SAAO4F,GAAWpiD,KAAKy8C,MAAAA,IAAQ/f,KAAO18B,KAAKu9C,oBAAoBv9C,KAAKw9C,mBAAiB4E,KAAWF,GACvIliD,KAAKq6H,QAAQ39F,GACb18B,KAAKm8H,QAAQj6E;AAEb,UAAI/F,IAAUzlD,EAAUulD,OAAOE,UAAQ,CAAA,GACnCiiF,IAAe,CAEnBp+H;AAAAA,WAAKq+H,gBAAgBD,GACrBp+H,KAAKu5H,iBAAiB,IACtBv5H,KAAK4iG,kBAAkB,IACvB5iG,KAAKgzH,cAAc,CAAA;AAEnB,UAAIsL,IAAAA,IAEA35B,IAAW;AACZ3kG,WAAKo5D,uBAAAA,MACPurC,IAAWjuG,EAAU4gI,uBAAuBC,YAAYv3H,KAAKizH,cAAcjzH,KAAKw3H,WAAAA,IAGjF9gI,EAAU4gI,uBAAuBiH,yBAAyB,CAC1D7nI,GAAAA,EAAU4gI,uBAAuByB,yBAAyB,CAAA;AAE1D,UAAItB,IAA4B9yB,CAAAA,CAAAA,GAE5B65B,IAAcx+H,KAAKo5D,uBAAAA,GAEnBqlE,IAjhBL,SAAqB7jG,IAAU8jG;AAI9B,iBAHIC,KAAW,CACXC,GAAAA,IAAgB,CAAA,GAChBC,KAAkB,GACb11B,KAAS,GAAGA,KAASvuE,GAASm0D,OAAOl1F,QAAQsvG,MAAW;AAChEzyG,YAAUikI,oCAAoC1vH,KAAK2vB,IAAU8jG,EAAiBv1B;AAC9E,cAAIgyB,KAAQzkI,EAAUo9H,4BAA4Bl5F,IAAUuuE;WAE5DgyB,KAAQzkI,EAAU2lI,+BAA+BzhG,IAAUuuE,IAAUgyB,EAAAA,GAC/DvjI,MAAMinI,IACZF,GAAStlI,KAAK8hI,EACdyD,GAAAA,EAAchkG,GAASm0D,OAAOoa,EAAAA,EAAUp/F,GAAOoxH,IAAAA,IAE/C0D,MAAmB1D,GAAM11H;AAAAA,QAEzB;AAED,eAAO,EACNi2H,aAAamD,IACbF,cACAC,eAEFnwH,EAAA;AAAA,MAAA,EA2fgCzO,MAAMnB,CAGlC8lG;AAAAA,MAAAA,KAAY85B,EAAa/C,cAAc/2B,EAASxkF,cAClDwkF,EAASxkF,YAAYra,KAAKC,IAAI,GAAG04H,EAAa/C,cAAc/2B,EAASl/F,MAAAA,IAGtEzF,KAAKuzH,YAAYkL,EAAaG;AAE9B,eAASz1B,IAAS,GAAGA,IAASnpG,KAAK+uF,OAAOl1F,QAAQsvG,KAAW;AAC5D,YAAIgyB,IAAQsD,EAAaE,SAASx1B,CAAAA,GAC9B3/D,IAAMxpC,KAAK+uF,OAAOoa,CAClB21B,GAAAA,IAAa3D,EAAMvjI,KAKnBmnI,IAAW,wCAAsC5D,EAAMc,eAAa,kBAAgB6C,IAAW,QAAM3D,EAAMziC,eAAeyiC,EAAMoB,oBAArH,sBAA8JpzB,IAA9J,oBACG2wB,EAAmBtwF,EAAIz/B,OAD1B,mBAECoxH,EAAMW,eAAa,cAAYX,EAAM1iC,cAAY,aAAW0iC,EAAM11H,SAAO,UAAQ/O,EAAU66B,SAAS7G,MAAMywG,EAAMa,UAAAA,IAAY,MAAIb,EAAMa,aAAW;AAajK,YAXIwC,KACHx+H,KAAKgzH,YAAY35H,KAAK,EAAC0I,KAAKg9H,GAAUnnI,KAAKknI,GAAYpjI,SAAS8tC,EAAAA,CAAAA,GAG7Dg1F,MACE9nI,EAAU4gI,uBAAuB0H,cAAc,EAACpnI,KAAKknI,GAAYh9G,QAAQg9G,IAAa3D,EAAM11H,UAASk/F,CACzG25B,MAAAA,IAAAA,MAKEA;AACHA,UAAAA,IAAkB;AAAA,aACZ;AAENN,UAAAA,KAAgBe,GAGZP,KACH9nI,EAAU4gI,uBAAuBiH,uBAAuBllI,KAAK8vG,CAAAA;AAG9D,cACIyzB,IAAiB,EAAEx/H,MAAM4C,MAAMtE,SAAS8tC,GAAK5Z,UADlCl5B,EAAUya,UAAUnR,KAAKiP,OAAO,YAAA,EAAA,GAI3CguH,IAAc;AAClB,cAAIj9H,KAAKsM,UAAU,QAAQ;AAC1B2xH,YAAAA,KAAcvnI,EAAUgmI,qCAAqCvzB,GAAUgyB,GAAOA,EAAMvjI,KAAK4xC,EAAIz/B,KAAK6yH;AAClG,qBAASqC,IAAW,GAAGA,IAAWvoI,EAAU2O,MAAMxL,QAAQolI;AACrDvoI,gBAAU4O,SAAS25H,CAAAA,KAAAA,CAAcT,IACpCP,KAAevnI,EAAUmmI,oCAAoC1B,CAEzDqD,IAAAA,KAAe/G,IACd/gI,EAAU4gI,uBAAuB4H,cAAc,EAACrnI,MAAMolI,GAAax/G,OAAOw/G,IAAcvmI,EAAU2O,MAAM45H,CAAYt6B,EAAAA,GAAAA,CAAAA,MACvHs5B,KAAevnI,EAAUomI,4BAA4BmC,GAAU91B,GAAUnpG,MAAMnB,EAAIsqG,GAAU81B,CAAW9D,GAAAA,GAAO8B,MAGhHgB,KAAevnI,EAAUomI,4BAA4BmC,GAAU91B,GAAUnpG,MAAMnB,EAAIsqG,CAAU81B,EAAAA,CAAAA,GAAW9D,GAAO8B,CAIjHA,GAAAA,KAAevmI,EAAU2O,MAAM45H,CAAAA;AAGhChB,YAAAA,KAAe;AAAA,UACnB,OAAU;AAENA,YAAAA,KAAevnI,EAAU2mI,uCAAuCl0B,GAAUgyB,GAAOA,EAAMvjI,KAAK4xC,EAAIz/B,GAAAA;AAEhG,gBAAIo1H,KAAkBtgI,EAAIsqG,CAEtBq1B;AAaJ,iBAbIA,KAAe/G,MAClB0H,KAAkBzoI,EAAU4gI,uBAAuB8H,uBAAuBp/H,MAAM2kG,GAAU9lG,GAAKsqG,KAOhG80B,KAJkBvnI,EAAUskI,0BAA0B/vH,KAAKjL,MAAMm/H,EAAAA,GAOjElB,KAAevnI,EAAU4mI,oCAAoCnC,GAAOyB,CAEpE,GAASqC,IAAW,GAAGA,IAAWvoI,EAAU2O,MAAMxL,QAAQolI;AACrDvoI,gBAAU4O,SAAS25H,CAAAA,IACtBhB,KAAevnI,EAAU6mI,mCAAAA,IAErBiB,KAAe/G,IACd/gI,EAAU4gI,uBAAuB4H,cAAc,EAACrnI,MAAMolI,GAAax/G,OAAOw/G,IAAcvmI,EAAU2O,MAAM45H,CAAAA,EAAAA,GAAYt6B,OACvHs5B,KAAevnI,EAAU8mI,2BAA2ByB,GAAU91B,GAAUnpG,MAAMnB,EAAIsqG,CAAW8zB,GAAAA,CAAAA,KAG9FgB,KAAevnI,EAAU8mI,2BAA2ByB,GAAU91B,GAAUnpG,MAAMnB,EAAIsqG,CAAAA,GAAW8zB,CAG/FA,GAAAA,KAAevmI,EAAU2O,MAAM45H,CAAAA;AAEhChB,YAAAA,KAAe;AAAA,UACf;AAAA,QACD;AACD9C,QAAAA,EAAMrG,aAAatrF,EAAIz/B,KACvBq0H,EAAa/kI,KAAK8hI;MAClB;AAED/iI,MAAAA,KAAQ4lI,IAAgB,gBACxB5lI,KAAQ6lI,IAAc,gBACtB7lI,KAAQ,UAER4H,KAAKq/H,UAAUxgI,GAGfwJ,EAAE7D,YAAYpM,GACVomI,KACC9nI,EAAU4gI,2BACb5gI,EAAU4gI,uBAAuByB,yBAAyB,CAG5DriI,IAAAA,EAAUoiI,4BAA4BzwH,CAAAA;AAGtC,YAAMi3H,KAAcj3H,EAAE5O,iBAAiB,mBACjC8lI,GAAAA,KAAiB,CAAA;AACvBD,MAAAA,GAAYxkI,QAAQ,SAAS0uC,IAC5B+1F;AAAAA,QAAAA,GAAe/1F,GAAI3uC,aAAa,iBAAA,CAAA,IAAsB2uC;AAAAA,MACxD,CACCxpC,GAAAA,KAAKw/H,kBAAkBD,IACnBf,MACU9nI,EAAU8C,WAAW4d,cAAc,0BACzCzf,MAAM8N,SAASg5H,EAAa/C,cAAc,OAGlD17H,KAAKmF,UAAU,IAENvL,IAAG;AAAZ,eAAe6M,KAAM23H,EAAavkI,QAAQD,IAAI6M,IAAK7M,KAAK;AACvDuiD,QAAAA,EAAQ9iD,KAAK+kI,EAAaxkI,CAAG6L,EAAAA,MAAAA;AAE7B,YAAIg6H,KAAWrB,EAAaxkI,GAAGk7H;AAC/Bp+H,UAAUgpI,+BAA+B1/H,MAAMy/H,IAAUz/H,KAAKw/H,gBAAgBC,EAC9E,CAAA;AAAA,MAAA;AAAA,OAGGjB,KAAex+H,KAAK48B,eApezB,SAAoBv0B,IAAGjL,GAAM++C;AAE5BzlD,UAAUsE,YAAY,iBAAiB,WAAA;AACnCtE,YAAU4E,SAAAA,EAAWL,SAASmC,EAAK6R,SACrCktC,KAAUzlD,EAAUulD,OAAOE;AAAAA,QAE9B,CACCzlD,GAAAA,EAAUsE,YAAY,gBAAgB,WAClCtE;AAAAA,YAAU4E,WAAWL,SAASmC,EAAK6R,SACrCktC,KAAUzlD,EAAUulD,OAAOE;AAAAA,QAE9B,CAAA,GAEC/+C,EAAKuiI,kBAAAA;AAEL,YAAIzM,IAAiBgH,EAAuB7xH,IAAGjL,IAG3C2xB,KAASr4B,EAAU6J,KAAqB,eAAE,CAAA,GAG1Cq/H,KAAoCv3H,GA9B5B+O,cAAc,6BAAA;AA+B1B,YAAGwoH,MAEGA,CAAAA,GAAgBC,iBAAiB;AACrCD,UAAAA,GAAgBC;AAChB,cAAIC,KAAkB,EAAE7oG,OAAO,GAAGC,OAAO,EACzCxgC;AAAAA,YAAUI,MAAM8oI,IAAiB,cAAc,SAAU1kI,IACxD;AAAA,gBAAIy9B,KAAQz9B;AACRA,YAAAA,GAAEk+B,YACLT,KAAQz9B,GAAEk+B,QAAQ,KAEnB0mG,KAAkB,EAAE7oG,OAAO0B,GAAM1B,OAAOC,OAAOyB,GAAMzB,MACzD;AAAA,UAAA,GAAM,EAACiD,SAAS,GAAA,CAAA,GACbzjC,EAAUI,MAAM8oI,IAAiB,aAAa,SAAU1kI,IAAAA;AACvD,gBAAIy9B,KAAQz9B;AACRA,YAAAA,GAAEk+B,YACLT,KAAQz9B,GAAEk+B,QAAQ,CAEnB;AAAA,gBAAI5M,KAAKszG,GAAgB5oG,QAAQyB,GAAMzB;AACvC4oG,YAAAA,KAAkB,EAAE7oG,OAAO0B,GAAM1B,OAAOC,OAAOyB,GAAMzB,MAAAA,GACjD1K,OACH0mG,EAAe/yG,aAAaqM,KAEzBtxB,MAAKA,GAAE28B,kBACV38B,GAAE28B,eACP;AAAA,UAAA,GAAM,EAACsC,SAAS,GAAA,CAAA;AAAA,QACb;AAOF,YAAK+4F,CAAAA,EAAe2M,mBAAoB3M,CAAAA,EAAe2M,gBAAgBziI,EAAK6R,OAAO;AASlF,cAAS8wH,KAAT,SAAsB7kI,GACrB;AAAA,gBAAI8kI,KAAwB;AAC5B,gBAAIC,KAAKvpI,EAAUosB,IAAIK,MACnB+8G,KAASD,KAAM/kI,EAAQ,SAAIA,EAAEilI,aAC7BC,KAASH,KAAM/kI,EAAQ,SAAIA,EAAEmlI,YAE7BC;AACAL,YAAAA,OAEFK,KADGplI,EAAEqlI,cAAc,IACL,MAAA;AAKhB,gBAAIC,KAAiB,GAAjBA,KAAuB,GACvBC,KAAKR,KAAMC,KAASI,KAAaE,KAAyB,IAATN,KAAaM,IAC9DE,KAAKT,KAAMG,KAASE,KAAaE,KAAgBJ,KAASI;AAE9D,gBAAIC,MAAM36H,KAAKu1B,IAAIolG,EAAAA,IAAM36H,KAAKu1B,IAAIqlG,KAAI;AAErC,kBAAIh6E,KAAO+5E,KAAI;AACfvN,cAAAA,EAAe7yG,cAAkB,KAAJqmC,IAC1BwsE,EAAe7yG,eAAesgH,OAChCX;YAEL;AAEQt5E,cAAAA,KAAOg6E,KAAI,KACJA,OADI,WAEdh6E,KAAMxrD,EAAE0lI,SAET1N,EAAe/yG,aAAiB,KAAJumC,IACzBwsE,EAAe/yG,cAAc0gH,OAC/Bb,KAAAA;AAIF,gBAAGA;AAGF,qBAFA9kI,EAAE28B,eACF38B,GAAAA,EAAEigC,mBACK;AAAA,UAGR,GA/CGwlG,IACAE;AALJ3N,UAAAA,EAAe2M,kBAAkB3M,EAAe2M,mBAAmB,CAAA,GACnE3M,EAAe2M,gBAAgBziI,EAAK6R,YAoDpCvY,EAAUI,MAAMo8H,GAAgB,cAAc6M,IAAc,EAAC5lG,SAAAA,OAC7DzjC,EAAUI,MAAM8oI,IAAiB,cAAcG,IAAc,EAAC5lG,SAAS,GAAA,CAAA;AAGvE,gBAAM2mG,KAAyB,SAAU5lI,GACxC;AAAA,gBAAGxE,EAAU4E,SAAAA,EAAWL,SAASmC,EAAK6R,MAAtC;AAGAktC,cAAAA,KAAUzlD,EAAUulD,OAAOE;AAC3B,kBAAI3hD,KAAU0/H,EAAuB7xH,IAAGjL,CAAAA;AACxClC,cAAAA,EAAE28B,eACF;AAAA,kBAAI1X,KAAY3lB,GAAQ2lB,WACpBE,KAAajjB,EAAK61H,aAAartC,eAAeprF,EAAAA;AAClDmmI,cAAAA,KAAiBtgH,IACjBwgH,KAAgB1gH;AAChB,kBAAIulE,KAActoF,EAAK++H,QAAQzlI,EAAU8C,WAAW4d,cAAc,eAAiB6C,EAAAA,cAAc7c,EAAKy/B,KAAKz/B,EAAKm+H,qBAC5G52B,KAAWjuG,EAAU4gI,uBAAuBC,YAAYn6H,EAAK61H,cAAc,GAAG5yG,IAAYF,EAAAA,GAC1F4gH,KAAc5G,EAAAA;AAClB,kBAAG/8H,EAAKw/B;AAIP,oBAHAmkG,GAAYppI,MAAMC,OAAQuoB,KAAa,MAGnCzpB,EAAUM,OAAOsgC,KAAI;AACxB,sBAAIw7F,KAAsBp8H,CAAAA,EAAU8C,WAAW4d,cAAc,6BAAA,EAA+Bzf,MAAM8N,OAAO8I,QAAQ,MAAM,EAAA,GACnHwkH,KAAe31H,EAAKwlG,gBAAgBxlG,EAAK2xF,OAAOl1F,UAAUuD,EAAK41H,YAAY51H,EAAK41H,YAAYn5H,SAAS,GAAGjC;AAExGwF,kBAAAA,EAAK61H,aAAattC,QAAavoF,KAAAA,EAAK61H,aAAangF,MAAMsyC,WAAW2tC,KAAeD,MAAsB11H,EAAKkP,UAAU,UACzHyiB,GAAOp3B,MAAM8lB,aAAgB4C,KAAa4xG,MAAuB,OAE7DljG,GAAOp3B,MAAM8lB,QAAY,KAAI4C,KAAc,MAEhD0O,GAAOp3B,MAAME,OAAS;AAAA,gBAC3B;AACKk3B,kBAAAA,GAAOp3B,MAAME,OAAAA,KAAewoB,KAAc;AAI5C,kBAAGjjB,EAAKg8D,uBAAyB,GAAA;AAAA,iBAC5B/4C,OAAejjB,EAAK8zF,aAAa9zF,EAAKuiI,qBACrCviI,EAAKsjH,eACRhqH,EAAU4gI,uBAAuB0J,aAAa5jI,GAAMunG,IAAU51E,GAAO0mB,SAAS,CAE9E/+C,CAAAA,IAAAA,EAAU4gI,uBAAuB0J,aAAa5jI,GAAMunG,IAAU51E,GAAO0mB,SAAS,CAG5Er4C,CAAAA,KAAAA,EAAK6jI,oBAAoB9gH,OAAc/iB,EAAK+zF,aAAc/zF,EAAKuiI,oBAClEjpI,EAAU4gI,uBAAuB4J,aAAa9jI,GAAMunG,IAAUo8B,EAG/D3jI,GAAAA,EAAKuiI,kBAAkB,IAEvBjpI,EAAU4gI,uBAAuB6J,eAAe/jI,GAAMunG,EACtDjuG,GAAAA,EAAU4gI,uBAAuB8J,eAAehkI,GAAMunG,EAGtD;AAAA,oBAAI08B,KAAc;AAClB,oBAAIjkI,EAAKkP,UAAU,QAAQ;AAOzB,sBAJAg1H,2BAIGlkI,GAAAA,EAAK6R,SAASvY,EAAU4E,SAAWL,EAAAA;AACrC;AAEDvE,oBAAU4gI,uBAAuBiK,aAAankI,GAAMunG,EAAAA;AAAAA,gBAIrD;AAED,oBAEInuF,IAFAgrH,KAAgB;AACpBpkI,gBAAAA,EAAK+H,UAAU,IAIdqR,KADGpZ,EAAKkP,WAAW,SACZ9R,GAAQf,iBAAiB,+CAAA,IAEzBe,GAAQf,iBAAiB,yCAGjC;AAAA,yBADI2kI,KAAehhI,EAAKihI,eACfzkI,KAAG,GAAG6M,KAAM+P,GAAK3c,QAAQD,KAAI6M,IAAK7M,MAAK;AAC/C,sBAAI6lI,KAAWjpH,GAAK5c,IAAGiB,aAAa,iBAAA,GAChCsuG,KAAW/rG,EAAKuI,MAAM85H,EAE1BtjF;AAAAA,kBAAAA,GAAQgtD,EAAYi1B,IAAAA,GAAaj1B,IAAU1jG,QAC3CrI,EAAK+H,QAAQs6H,EAAYjpH,IAAAA,GAAK5c;gBAC9B;AAED,qBAASA,KAAG,GAAG6M,KAAM01C,GAAQtiD,QAAQD,KAAI6M,IAAK7M;AAC7C4nI,kBAAAA,MAAgBrlF,GAAQviD;AAGZlD,kBAAU8C,WAAW4d,cAAc,wBAAA,EACzCzf,MAAM8N,SAAS+7H,KAAgB;AAAA,cACtC;AAKD,kBAAIC,KAASthH,IACTuhH,KAAUrhH;AAGd3pB,gBAAU+lI,0BAA0Br/H,GAAMqkI,IAAQC,IAASh8C,KACtD27C,MACJjkI,EAAKyC,UAAU,YAAY,CAAC6hI,IAASD,EAMtCrkI,CAAAA,GAAAA,EAAK+3H;YA1GJ;AAAA,UA2GJ;AAEEz+H,YAAUI,MAAMo8H,GAAgB,UAAU4N,IAAwB,EAAC3mG,SAAS,GAAA,CAAA;AAE5E,cAAIwnG,KAAa,EAAE1qG,OAAO,GAAGC,OAAO,EAAA;AACpCxgC,YAAUI,MAAMo8H,GAAgB,cAAc,SAAUh4H,GAAAA;AACvD,gBAAIy9B,KAAQz9B;AACRA,YAAAA,EAAEk+B,YACLT,KAAQz9B,EAAEk+B,QAAQ,CAEnBuoG,IAAAA,KAAa,EAAE1qG,OAAO0B,GAAM1B,OAAOC,OAAOyB,GAAMzB,MAAAA;AAAAA,UACnD,GAAK,EAACiD,SAAAA,OACJzjC,EAAUI,MAAMo8H,GAAgB,aAAa,SAAUh4H,GACtD;AAAA,gBAAIy9B,KAAQz9B;AACRA,YAAAA,EAAEk+B,YACLT,KAAQz9B,EAAEk+B,QAAQ,CAAA;AAEnB,gBAAI2nG,KAAc5G,EAAAA,GACdt9F,KAAK8kG,GAAW1qG,QAAQ0B,GAAM1B,OAC9BzK,KAAKm1G,GAAWzqG,QAAQyB,GAAMzB;AAGlC,gBAFAyqG,KAAa,EAAE1qG,OAAO0B,GAAM1B,OAAOC,OAAOyB,GAAMzB,MAE3C2F,IAAAA,MAAMrQ,QAAQ91B,EAAU4E,SAAAA,EAAWw/B,SAAS;AAEhD,kBAAI8mG,KAAa97H,KAAKu1B,IAAIwB,EAAAA,GACtBglG,KAAa/7H,KAAKu1B,IAAI7O,KACtBs1G,KAAgBh8H,KAAKi8H,KAAKllG,KAAGA,KAAKrQ,KAAGA,EAAAA;AACfo1G,cAAAA,KAAaE,KAEb,OACzBjlG,KAAK,IAFkBglG,KAAaC,KAGN,SAC9Bt1G,KAAK,IAIF91B,EAAUM,OAAOsgC,QACpBuF,KAAMA,CAAAA,KAGPz/B,EAAK61H,aAAantC,eAAgBotC,GAAgB91H,EAAK61H,aAAartC,eAAestC,CAAkBr2F,IAAAA,EAAAA,GAErGq2F,EAAe/yG,aAAaqM,IAExBpvB,EAAKw/B,cAAcpQ,OACtBu0G,GAAYppI,MAAMC,MAAQs7H,CAAAA,EAAe/yG,YAAa;AAAA,YAEvD;AAGD,mBAFIjlB,KAAKA,EAAE28B,kBACV38B,EAAE28B,eACI,GAAA;AAAA,UACV,GAAK,EAACsC,SAAAA;QACJ;AAEG/8B,QAAAA,EAAK4kI,mBAAmB5kI,EAAK+3H,eAEhC/3H,EAAKk8D,SAASl8D,EAAK4kI,eAAAA,IAEnBtrI,EAAU8lI,yBAAyBn0H,IAAGjL,IAGvCA,EAAKuiI,kBAAAA;AAAAA,MACN,EAyMat3H,GAAGrI,MAAMm8C,CAEtB;AAAA,IAAA,GAEAzlD,EAAUgpI,iCAAiC,SAAS9kG,GAAUk6F,GAAYmN,GAAAA;AACtEA,MAAAA,MACFrnG,EAASz1B,QAAQ2vH,CAAAA,IAAcmN,GAC/BvrI,EAAUmJ,UAAU,cAAc,CAACoiI,GAAYnN;IAEjD,GAEAp+H,EAAUsE,YAAY,sBAAsB,SAAUsxF,GAASC,GAAStxF,GAAKvC,GAAAA;AAE5E,UAAIhC,EAAUuG,OAAOhC,IAAO;AAC3B,YAAImC,IAAO1G,EAAUuG,OAAOhC;AAE5B,YAAImC,EAAKw/B,cAAcx/B,EAAKo7F,iBAAiB;AAC5C,cAAIp7F,EAAKkP,UAAU,UACdggF,MAAarxF,KAAQsxF,MAAa7zF;AAErC,mBAAA;AAIG4zF,UAAAA,MAAarxF,KAAAA,CAASsxF,MAAc7zF,KAAShC,CAAAA,EAAU8C,WAAW4d,cAAc,+BACpFha,MAAAA,EAAK8zF,YAAY9zF,EAAK+zF,YAAY,GAE9Bz6F,EAAU8C,WAAW4d,cAAc,+BACtC1gB,KAAAA,EAAU8lI,yBAAyB9lI,EAAU6J,KAAmB,aAAE,IAAInD,CAKxE;AAAA,QAAA;AAAA,MACD;AAED,aAAO;AAAA,IACR,IAEA1G,EAAUwrI,oBAAoB,SAAiB59E,GAAAA;AAC9C,UAAI3gD,IAAQjN,EAAUkK,WAClBgD,IAAMlN,EAAUiK;AAEpBjK,QAAUyrD,iBAAiBx+C,GAAO3D,KAAKu1H,QAAQv1H,KAAKy8C,QAAQz8C,KAAKw8C,QAAQ8H,CAGtE5tD,GAAAA,EAAUgC,KAAKsH,KAAKy8C,SAAS,cAC/B94C,IAAQjN,EAAUgC,KAAKsH,KAAKy8C,SAAS,QAAA,EAAU94C;AAIhD,eAFIw+H,IAAgB,GACnBC,IAAc,IACRz+H,IAASC,CAAAA;AAgBf,YAbA5D,KAAKvH,SAAS2pI,CAAAA,IAAa,IAAIlpI,KAAKyK,CAAAA,GACjC3D,KAAKy8C,UAAU,WAAW/lD,EAAUgC,KAAKsH,KAAKy8C,SAAS,QAAA,MACzD94C,IAAQjN,EAAUgC,KAAKsH,KAAKy8C,SAAS,UAAU,IAAIvjD,KAAKyK,MAEzDA,IAAQjN,EAAUgC,KAAKC,IAAIgL,GAAO3D,KAAKw8C,QAAQx8C,KAAKy8C,MAAAA,GACjD/lD,EAAUgC,KAAKsH,KAAKy8C,SAAS,QAC/B94C,MAAAA,IAAQjN,EAAUgC,KAAKsH,KAAKy8C,SAAS,UAAU94C,CAG5CjN,IAAAA,EAAU4O,SAAS88H,CACtBD,KAAAA,KACDC,KAEG99E;AACF,cAAG69E,IAAiBniI,KAAKu1H,UAAa5xH,EAAAA,CAAAA,IAAAA,CAASC;AAC9CA,YAAAA,IAAMlN,EAAUgC,KAAK,SAASsH,KAAKiP,OAAO,UAAYrL,EAAAA,IAAM5D,KAAKg3H,YAAYh3H,KAAKu1H,UAAQv1H,KAAKw8C,MAC1F;AAAA,mBAAG2lF,KAAkBniI,KAAKu1H,QAAO;AACtC7+H,cAAUiK,YAAYgD;AACtB;AAAA,UACA;AAAA;AAGH,aAAO,EAAC2hC,OAAO88F,GAAaC,WAAWF,EACxC;AAAA,IAAA,GAEAzrI,EAAU4rI,oBAAoB,SAAiBhqH,GAC9C;AAAA,UAAIiqH,IAAyB7rI,EAAU23B,KAAKruB,KAAK68B,KAAKnmC,EAAU+gB,GAAGshB,cAC/Dp1B,IAAQjN,EAAUkK,WAGlB4hI,IAAa9rI,EAAU+gB,GAAGqhC,cAC1B2pF,IAAcziI,KAAK0iI,mBAAiBhsI,EAAU+gB,GAAGqhC;AACrDpiD,QAAU2O,QAAM,CAAA,GAChB3O,EAAUulD,SAAO,EAACx2C,QAAO,EACzBzF,GAAAA,KAAKvH,WAAU,CAGf;AAAA,UAAI6rD,IAAW5tD,EAAUM,OAAO2rI,uBAC5B9+H,IAAQnN,EAAUwrI,kBAAkBj3H,KAAKjL,MAAMskD,CAAAA;AAInD,UAAItkD,KAAK48B,cAAc58B,KAAKi8F,eAAe,GAAG;AAE7C,YAAI2mC,IAAa5iI,KAAKi8F,eAAep4F,EAAMw+H;AAEvCO,QAAAA,IAAaL,MAChBA,IAAyBK,GACzB5iI,KAAKo1H,qBAAAA;AAAAA,MAEN;AAED,UAAIv9H,IAAO,CAACmI,KAAK68B,EAAAA;AACJnmC,QAAU6J,KAAqB,eAAE,GACvC5I,MAAM+N,QAAS7N,EAAK,CAAA,IAAG0qI,IAAyB,IAAG,MAEtD5+H,IAAQjN,EAAU6jI,qBAAqB7jI,EAAUkK;AAQrD,eALIwhD,IAAYv+C,EAAMw+H,WAClB7gI,IAAOqC,EAAMyhC,OAIRjiC,IAAE,GAAGA,IAAE7B,GAAM6B;AAEjB3M,UAAU4O,SAASjC,CAAAA,KACtB3M,EAAU2O,MAAMhC,CAAG,IAAA,GACnB++C,OAEA1rD,EAAU2O,MAAMhC,KAAGyC,KAAK+D,MAAM04H,KAAwBngF,IAAU/+C,EAAAA,GAGjEk/H,KAA0B7rI,EAAU2O,MAAMhC,CAAAA,GAC1CxL,EAAKwL,IAAE,CAAA,IAAKxL,EAAKwL,CAAK3M,IAAAA,EAAU2O,MAAMhC,CAIvC;AAAA,UAFAiV,EAAE9T,YAAY,eAEXxE,KAAK0gH,cAAa;AAOpB,iBALIzlH,IAAO+E,KAAK0gH,aAAajkE,QACzBomF,IAAgB,CAAC7iI,KAAKvH,SAAS,KAC/BqqI,IAAc,CAAA,GACdC,IAAc,CAAC/iI,KAAK68B,IAAI78B,KAAK68B,EAAAA,GAC7BmmG,IAAU,GACL1zD,IAAI,GAAGA,IAAItvE,KAAKvH,SAASoB,QAAQy1E,KAAK;AAC9C,cAAI52E,IAAOsH,KAAKvH,SAAS62E,CAAAA;AACf54E,YAAUusI,0BAA0BhoI,GAAMvC,GAAMmqI,EAAcG,QAIvEH,EADEG,EAAAA,CAAAA,IACuBtqI,GACzBqqI,EAAYC,IAAQ,CAAKD,IAAAA,EAAYC,CAEtC;AAAA,cAAI/5H,IAAI+5H,IAAQ;AAChBF,UAAAA,EAAYE,CAAWtsI,IAAAA,EAAU2O,MAAMiqE,CAAMwzD,KAAAA,EAAYE,CAAU,KAAA,IACnED,EAAY95H,CAAAA,KAAMvS,EAAU2O,MAAMiqE,CAAAA;AAAAA,QAClC;AAEDh3D,QAAAA,EAAE9T,YAAY;AACd,YAAI5M,IAAM0gB,EAAE3R;AACZ/O,QAAAA,EAAID,MAAM8N,SAAS7L,IAAc;AACjC,YAAIkoB,IAASxJ,EAAEohD;AACf53C,QAAAA,EAAOnqB,MAAM8J,WAAW,YACxBqgB,EAAOtc,YAAY;AACnB,iBAASg0D,IAAI,GAAGA,IAAIqpE,EAAchpI,QAAQ2/D,KAAK;AAC9C,cAAItoC,IAAQ2xG,EAAcrpE,CACtB0pE,GAAAA,IAAMxsI,EAAUya,UAAUnR,KAAKiP,OAAK,sBAAwBiiB,EAAAA,CAAAA,GAC5DxS,IAAOpa,SAASC,cAAc,KAAA;AAClCma,UAAAA,EAAKlZ,YAAU,wCAAsC0wE,IAAO,MAAIgtD,IAAK,KACrExsI,EAAU+iD,OAAO/6B,GAAMokH,EAAYtpE,CAAIipE,GAAAA,GAAaM,EAAYvpE,CAAI,GAAA,CAAA,GACpE96C,EAAKla,YAAY9N,EAAUya,UAAUnR,KAAKiP,OAAK,oBAAsBiiB,EAAAA,CAAAA,GACrEt5B,EAAI6M,YAAYia;QAChB;AAAA,MACD;AAEDhoB,QAAU+gB,GAAGqhC,eAAe2pF,GAC5BnqH,IAAIA,EAAEohD,WAEN15D,KAAKq1H,UAAU;AAEf,eAASz7H,KAAE,GAAGA,KAAEoG,KAAKvH,SAASoB,QAAQD;AACrC,YAAA,CAAIlD,EAAU4O,SAAS1L,KAAvB;AAGA+J,UAAAA,IAAQ3D,KAAKvH,SAASmB,EAAAA,GACtBlD,EAAU4qD,iBAAiB1nD,IAAG/B,EAAK+B,EAAAA,GAAI+J,GAAO2U,CAAAA,GAE9CA,EAAEohD,UAAUjkD,aAAa,eAAe7b,EACxC0e,GAAAA,EAAEohD,UAAUjkD,aAAa,iBAAiBukH,EAA0Br2H,CAAAA,CAAAA;AAGpE,cAAIw/H,KAAe7qH,EAAEohD,UAAU5/D,UAAAA;AAG/BkG,eAAKq1H,QAAQz7H,MAAK,EAACmI,KAAKohI,IAActrI,MAAMA,EAAK+B,EAAAA,EAAAA;AAAAA,QAZvC;AAeXlD,QAAU+gB,GAAGqhC,eAAe0pF;AAE5B,UAAIY,KAAQpjI,KAAKvH;AACd6f,MAAAA,EAAE+qH,0BAIL/qH,EAAE+qH,wBAAAA,IACF3sI,EAAUI,MAAMwhB,GAAG,SAAS,SAASpd;AACpC,YAAI2gD,KAAMnlD,EAAU4sI,uBAAuBpoI,EACvC2gD;AAAAA,QAAAA,MACHnlD,EAAUmJ,UAAU,iBAAgB,CAACg8C,GAAI75B,GAAGohH,GAAMvnF,GAAI75B,CAAAA,GAAI9mB,EAC7D,CAAA;AAAA,MAAA,CAAA,GACCxE,EAAUI,MAAMwhB,GAAG,YAAY,SAASpd;AACvC,YAAI2gD,KAAMnlD,EAAU4sI,uBAAuBpoI,EAAAA;AACvC2gD,QAAAA,MACHnlD,EAAUmJ,UAAU,oBAAmB,CAACg8C,GAAI75B,GAAGohH,GAAMvnF,GAAI75B,CAAAA,GAAI9mB;MAChE,CACA;AAAA,IAAA,GAEAxE,EAAUusI,4BAA4B,SAAyBhoI,GAAMvC,GAAM6qI,GAC1E;AAAA,cAAOtoI;QACN,KAAK;AACJ,iBAASvC,EAAKmI,SAAAA,KAAc0iI,EAAa1iI,SAAAA,KAAenK,EAAUusI,0BAA0B,OAAOvqI,GAAM6qI,CAAAA;AAAAA,QAC1G,KAAK;AACJ,iBAAA,EAAS7qI,EAAK6F,QAAaglI,KAAAA,EAAahlI,QAAa7F,KAAAA,EAAKmb,SAAc0vH,KAAAA,EAAa1vH,cAAcnb,EAAKkb,YAAAA,KAAiB2vH,EAAa3vH,YACvI;AAAA,QAAA,KAAK;AACJ,iBAASld,EAAUgC,KAAKY,WAAW,IAAIJ,KAAKR,CAAOS,CAAAA,EAAAA,QAAAA,KAAazC,EAAUgC,KAAKY,WAAW,IAAIJ,KAAKqqI,CAAAA,CAAAA,EAAepqI,QAEnH;AAAA,QAAA,KAAK;AACJ,iBAAA,EAAST,EAAKmb,SAAc0vH,KAAAA,EAAa1vH,cAAcnb,EAAKkb,YAAAA,KAAiB2vH,EAAa3vH,YAC3F;AAAA,QAAA,KAAK;AACJ,iBAASlb,EAAKkb,YAAAA,KAAiB2vH,EAAa3vH,YAC7C;AAAA,QAAA;AACC;MAEH;AAAA,IAAA,GAEAld,EAAU8sI,+BAA+B,SAA4BvoI,GACpE;AAAA,UAAI+E,KAAK0iI,oBAAAA,CAAqBznI,KAAQ+E,KAAK0gH,eAAe;AACzDhqH,UAAU+gB,GAAGqhC,gBAAgB,GAC7B94C,KAAK0iI,kBAAkB;AACvB,YAAI3zG,IAASr4B,EAAU6J,KAAqB,eAAE;AAC9CwuB,QAAAA,EAAOvpB,YAAYupB,EAAOvpB,UAAU+I,QAAQ,4BAA2B,EAAA;AAAA,MACvE;AAAA,IACF,GAEA7X,EAAU+sI,0BAA0B,SAAuBxoI;AAG1D,UAFAvE,EAAU8sI,6BAA6Bv4H,KAAKjL,MAAM/E,CAE9CA,GAAAA,GAAK;AACJ+E,aAAK0gH,iBAAiB1gH,KAAK0iI,oBAC9B1iI,KAAK0iI,kBAAkBhsI,EAAU+gB,GAAGqhC,cACpCpiD,EAAU+gB,GAAGqhC,gBAAgB,GAC7BpiD,EAAU6J,KAAqB,eAAE,CAAA,EAAGiF,aAAa,2BAGlD9O,EAAUiiD,aACVjiD,EAAUgtI,qBAAAA;AAIV,YAAIv/G,IAAOztB,EAAUkK;AAIrB,YAHAlK,EAAU4rI,kBAAkBr3H,KAAKjL,MAAKtJ,EAAU6J,KAAqB,eAAE,CAAA,CAAA,GAGnE7J,EAAU8C,WAAW4d,cAAc,+BAAA,KAAoCpX,KAAKo5D,uBAA0B,GAAA;AACzG,cAAIurC,IAAYjuG,EAAU4gI,uBAAuBC,YAAYv3H,KAAKizH,YAC9D0Q,GAAAA,IAAYjtI,EAAU4gI,uBAAuBsM,iBAAiB5jI,MAAM2kG,CAAAA;AACpEg/B,UAAAA,MACC3jI,KAAK0gH,eACRhqH,EAAU6J,KAAK65F,eAAe,CAAG3kD,EAAAA,SAAS,CAAGjxC,EAAAA,YAAYm/H,IAEzDjtI,EAAU6J,KAAK65F,eAAe,CAAG3kD,EAAAA,SAAS,GAAGjxC,YAAYm/H;AAAAA,QAE3D;AAEDjtI,UAAUmnI,kBAAkB5yH,KAAKjL,MAAKtJ,EAAU6J,KAAmB,aAAE,CAErE7J,CAAAA,GAAAA,EAAUkK,YAAYujB;AAEtB,YAAI4lE,IAAcrzF,EAAU0sD,mBACzB2mC;AAAAA,QAAAA,MACFA,EAAYvlF,YAAU9N,EAAUya,UAAUnR,KAAKiP,OAAK,SAASvY,EAAUkK,WAAWlK,EAAUiK,SAAAA,IAGzFjK,EAAU0J,aACb1J,EAAU0J,UAEX1J,GAAAA,EAAU8sI,6BAA6Bv4H,KAAKjL,MAAM/E;MAElD;AACDvE,QAAUinI,8BAA8B39H,MAAM/E,CAE9CvE,GAAAA,EAAUmtI;IACX,GAGAntI,EAAUmtI,wBAAwB,WAC7BntI;AAAAA,QAAUotI,aACbptI,EAAUotI,SAASnsI,MAAMkgB,UAAU,QACnCnhB,EAAUotI,SAASprI,OAAO;AAAA,IAE5B,GAEAhC,EAAUqtI,wBAAwB,SAAqB3qI,GAAIyiD,GAAI5zC,GAAAA;AAC9D,UAAI7O,EAAIkT,UAAU,QAAlB;AACA,YAAI03H,IAAOnoF,EAAI75B,IAAE,MAAI65B,EAAI95B,GACrBljB,IAAMzF,EAAIimI,QAAQxjF,EAAI95B,CAAG85B,EAAAA,EAAI75B;AAEjC,YAAKnjB,CAAAA;AAAK,iBAAOnI,EAAUmtI,sBAAAA;AAI3B,YAFAhlI,EAAIyiB,KAAK,SAASzI,GAAEC,GAAI;AAAA,iBAAOD,EAAE5gB,aAAW6gB,EAAE7gB,aAAW,IAAG;AAAA,QAAI,CAE5DvB,GAAAA,EAAUotI,UAAS;AACtB,cAAIptI,EAAUotI,SAASprI,QAAQsrI;AAAM;AACrCttI,YAAUotI,SAASt/H,YAAU;AAAA,QAC/B,OAAQ;AACN,cAAIyE,IAAIvS,EAAUotI,WAAWx/H,SAASC,cAAc,KAAA;AACpD0E,UAAAA,EAAEzD,YAAY,oBACV9O,EAAUM,OAAOsgC,QAAKruB,EAAEzD,aAAa,qBACzClB,SAASmJ,KAAKhJ,YAAYwE,CAAAA,GAC1BvS,EAAUI,MAAMmS,GAAG,SAASvS,EAAU8kC,OAAOC,YAAAA;AAAAA,QAC7C;AAID,iBAFIrjC,IAAO,IAEFwB,IAAE,GAAGA,IAAEiF,EAAIhF,QAAQD,KAAI;AAC/B,cAAI6+D,IAAY55D,EAAIjF,CAAAA,EAAG68D,QAAO,iCAA+B53D,EAAIjF,GAAG68D,QAAM,MAAK,IAC3EA,IAAS53D,EAAIjF,CAAAA,EAAGo9D,YAAW,sCAAoCn4D,EAAIjF,GAAGo9D,YAAU,MAAK;AACzF5+D,UAAAA,KAAM,6CAA2CyG,EAAIjF,CAAAA,EAAGD,KAAG,OAAKjD,EAAUM,OAAO0C,kBAAgB,OAAKmF,EAAIjF,CAAAA,EAAGD,KAAG,cAAY8+D,IAAYhC,IAAM,MAC9Ir+D,KAAM,oCAAkCyG,EAAIjF,CAAGyF,EAAAA,SAAO3I,EAAUya,UAAU69C,WAAWnwD,EAAIjF,CAAG3B,EAAAA,UAAAA,IAAY,MAAI,UAC5GG,KAAM,yDACNA,KAAM1B,EAAUya,UAAU/X,EAAI6V,OAAK,UAAA,EAAYpQ,EAAIjF,CAAG3B,EAAAA,YAAY4G,EAAIjF,CAAAA,EAAG1B,UAAS2G,EAAIjF,MAAI;AAAA,QAC1F;AAEDlD,UAAUotI,SAASnsI,MAAMkgB,UAAQ,IACjCnhB,EAAUotI,SAASnsI,MAAMC,MAAM,OAE1BlB,EAAUM,OAAOsgC,OAAOrvB,EAAOpQ,OAAKnB,EAAUotI,SAAS7pH,eAAe,KAAM3V,SAASmJ,KAAKwM,cAAY4hC,EAAIxxC,IAAI4P,cAAYhS,EAAOpQ,OAAKnB,EAAUotI,SAAS7pH,cAAc,IAC3KvjB,EAAUotI,SAASnsI,MAAME,OAAOoQ,EAAOpQ,OAAKnB,EAAUotI,SAAS7pH,cAAY,OAG3EvjB,EAAUotI,SAASnsI,MAAME,OAAOoQ,EAAOpQ,OAAKgkD,EAAIxxC,IAAI4P,cAAY,MAGjEvjB,EAAUotI,SAASprI,OAAOsrI,GAC1BttI,EAAUotI,SAASt/H,YAAYpM,GAE3BkM,SAASmJ,KAAKsM,eAAa9R,EAAOrQ,MAAIlB,EAAUotI,SAAS/pH,eAAe,IAC3ErjB,EAAUotI,SAASnsI,MAAMC,MAAKqQ,EAAOrQ,MAAIlB,EAAUotI,SAAS/pH,eAAa8hC,EAAIxxC,IAAI0P,eAAa,OAE9FrjB,EAAUotI,SAASnsI,MAAMC,MAAKqQ,EAAOrQ,MAAI;AAAA,MA9CT;AAAA,IA+ClC,GAEAlB,EAAUutI,0BAA0B,SAAS/oI;AAC5C,UAAI9B,IAAM1C,EAAUuG,OAAOvG,EAAU0K,KAAAA;AACrC,UAAKhI,KAAOA,EAAIkT,UAAU,QAA1B;AAEA,YAAIlT,GAAI;AACP,cAAIyiD,IAAMnlD,EAAUkoH,sBAAsB1jH;AAC1C,cAAI2gD;AACH,mBAAOnlD,EAAUqtI,sBAAsB3qI,GAAIyiD,GAAInlD,EAAUu+B,YAAY/V,UAAU28B,EAAIxxC,GAAAA,CAAAA;AAAAA,QACpF;AACD3T,UAAUmtI,sBAAAA;AAAAA,MANF;AAAA,IAOT,GACAntI,EAAUgtI,uBAAuB,WAChChtI;AAAAA,QAAUuhD,gBAAgBvhD,EAAU6J,KAAmB,aAAE,CAAI,GAAA,aAAa7J,EAAUutI,uBACpFvtI,GAAAA,EAAUI,MAAMJ,EAAU6J,KAAmB,aAAE,CAAA,GAAI,aAAa7J,EAAUutI;IAC3E,GAEAvtI,EAAU2hI,sBAAsB,SAASj7H,GAAAA;AACxC1G,QAAUkK,YAAYlK,EAAUgC,KAAK0E,EAAK6R,OAAK,QAAA,EAAU,IAAI/V,KAAKxC,EAAUoT,SAC5EpT,EAAUiK,YAAYjK,EAAUgC,KAAK,SAAS0E,EAAK6R,OAAO,UAAYvY,EAAAA,EAAUkK,WAAWxD,EAAKm4H,SAAOn4H,EAAKo/C,MAEzG9lD,GAAAA,EAAUgC,KAAK0E,EAAKq/C,SAAO,QAC7B/lD,MAAAA,EAAUiK,YAAYjK,EAAUgC,KAAK0E,EAAKq/C,SAAO,UAAU/lD,EAAUiK,SAAAA,IAEtEjK,EAAUyK,cAAc;AAAA,IACzB,GAGAzK,EAAUg6F,gBAAgB,SAASz1F,GAAM01F,GACxC3wF;AAAAA,WAAKH,UAAU,kBAAkB,CAAA,CAAA,GAE5B8wF,MACJj6F,EAAU6J,KAAmB,aAAE,CAAA,EAAG4f,YAAU,IAI7CzpB,EAAU2hI,oBAAoBr4H,IAAAA,GAE9BtJ,EAAU+sI,wBAAwBx4H,KAAKjL,MAAK/E,CAC7C;AAAA,IAAA,GAEAvE,EAAUwtI,uBAAuB,SAAoBtoH,GAAAA;AAIpD,eAHIxc,IAAIwc,EAAG3Z,WAAWyE,YAElBy9H,QACKvqI,IAAE,GAAGA,IAAIwF,EAAEvF,QAAQD;AAC3B,YAAIwF,EAAExF,CAAMgiB,KAAAA,GAAG;AACduoH,UAAAA,IAAYvqI;AACZ;AAAA,QACA;AAGF,UAAIwqI,IAAWD;AACf,UAAGztI,EAAU0lD;AACZ,iBAAQ6iF,KAAYvoI,EAAU4O;AAC1B5O,YAAU4O,SAAS25H,CAAsB,KAAA,IAATA,KAAcmF,KAChDA;AAIH,aAAOA;AAAAA,IACR,GAEA1tI,EAAU4sI,yBAAyB,SAAsBpoI,GAExD;AAAA,eADImiB,IAAMniB,EAAEE,SAAOF,EAAEE,SAAOF,EAAEoiB,YACvBD,KAAOA,EAAI+E,WAAW;AAC5B/E,QAAAA,IAAIA,EAAIpb;AACT,UAAIob,KAAOA,EAAI+E,WAAW,SAChB1rB,EAAUkQ,cAAcyW,CAAAA,EAAKhjB,MAAM,GAAA,EAAK,CAEhD,KADS;AACT,eAAO,EAAE2nB,GAAEtrB,EAAUwtI,qBAAqB7mH,CAAM0E,GAAAA,GAAAA,IAAM1X,KAAIgT,GAAKo8C,OAAM,GAAA;AAAA,IAExE,GAOA/iE,EAAUkoH,wBAAwB,SAAS1jH,GAAAA;AAS1C,eARImiB,IAAMniB,EAAEE,SAAOF,EAAEE,SAAOF,EAAEoiB,YAE1Bxf,IAAM,CAAA,GACNV,IAAO1G,EAAUuG,OAAOvG,EAAU0K,QAClCy6C,IAAMnlD,EAAU+E,cAAcP,CAAAA,GAC9BmpI,IAAM3tI,EAAU4O,UAEhBg/H,IAAiB,GACZC,IAAO,GAAGA,IAAOnnI,EAAK3E,SAASoB,SAAO,KAGzCgiD,EAAAA,CAAAA,EAAInjD,OAAO0E,EAAK3E,SAAS8rI,IAAK,CAAA,IAHcA;AAM7CF,QAAAA,EAAIE,CAAAA,KACPD;AAIFxmI,MAAAA,EAAIkkB,IAAIsiH,MAAmB,IAAI,IAAIC,GACnCzmI,EAAIikB,IAAI3kB,EAAKuI,MAAMk2C,EAAIngD,OAAAA;AAMvB,UAAI8oI,IAAgB;AACpB,UAAIpnI,EAAKw/B,cAAcx/B,EAAKkP,WAAW,QAAQ;AAE9C,aAAKlP,EAAK+H,QAAQ02C,EAAIngD,OAAa0B,KAAAA,CAAAA,EAAK+H,QAAQ02C,EAAIngD,OAAS0b,EAAAA,cAAc;AAAqB;AAChG,YAAIqtH,IAAYrnI,EAAK+H,QAAQ02C,EAAIngD,OAAS0b,EAAAA,cAAc,kBACvD;AAAA,YAAA,CAAKqtH;AAAW;AACjB,YAAIC,IAAWD,EAAUjlH;AACzB,YAAIklH,IAAW,GAAG;AAGjB,mBAFIxsI,IAAWxB,EAAU66F,oBAAoBn0F,GAAMsnI,CAE1C9qI,GAAAA,IAAI,GAAGA,IAAIwD,EAAK3E,SAASoB,SAAO,KAAA,EAAA,CACnC3B,IAAWkF,EAAK3E,SAASmB,IAAE,KADWA;AAI5C4qI;AAAAA,UAAAA,IAAgB5qI;AAAAA,QAChB;AAAA,MACD;AACDkE,MAAAA,EAAIuM,MAAMjN,EAAK+H,QAAQ02C,EAAIngD,OAAAA,IAAW0B,EAAK+H,QAAQ02C,EAAIngD,SAASjC,iBAAiB,kBAAA,EAAoB8qI,IAAOC,CAAiB,IAAA;AAE7H,UAnDgBhqI,GAASimB,GAmDrBkkH,IAAAA,IAEAC,KArDYpqI,IAqDU6iB,GArDDoD,IAqDM,qBApDxB/pB,EAAUu+B,YAAY55B,QAAQb,GAASimB,CAAAA;AAmE9C,aAdGmkH,MACFvnH,IAAMunH,GACND,IAAAA,KAGGA,KACH7mI,EAAIkkB,QACJlkB,EAAIuM,MAAMgT,GACVvf,EAAI27D,QAAAA,MAGJ37D,EAAIkkB,IAAIuiH,GAGFzmI;AAAAA,IACR;AAEA,QAAI+mI,IAAYnuI,EAAU8kC,OAAOC;AACjC/kC,MAAU8kC,OAAOspG,sBAAsBpuI,EAAU8kC,OAAOC,eAAe,SAASvgC,GAAAA;AAC/E,UAAI47G,IAAM+tB,EAAUjiI,MAAM5C,MAAK+I,SAC3B3P,GAAAA,IAAM1C,EAAUuG,OAAOvG,EAAU0K;AACrC,UAAIhI,GAAI;AACP,YAAIyiD,IAAMnlD,EAAUkoH,sBAAsB1jH,CACtC2gD;AAAAA,QAAAA,MACCA,EAAI4d,QACP/iE,EAAUmJ,UAAU,iBAAgB,CAACg8C,EAAI95B,GAAG3oB,EAAI21F,OAAOlzC,EAAI95B,CAAI7mB,GAAAA,CAAAA,CAAAA,KAE/DxE,EAAUmJ,UAAU,eAAe,CAACg8C,EAAI75B,GAAG65B,EAAI95B,GAAG3oB,EAAIX,SAASojD,EAAI75B,CAAO5oB,IAAAA,EAAIimI,QAAQxjF,EAAI95B,CAAAA,KAAM,CAAA,GAAI85B,EAAI75B,MAAO,CAAK9mB,GAAAA,CAAAA,CAAAA,GACpHxE,EAAU8lI,yBAAyB9lI,EAAU6J,KAAmB,aAAE,CAAInH,GAAAA,CAAAA;AAAAA,MAGxE;AACD,aAAO09G;AAAAA,IACR,GAEApgH,EAAUquI,2BAA2B,SAAS7pI,GAAAA;AAC7C,UAAI9B,IAAM1C,EAAUuG,OAAOvG,EAAU0K;AACrC,UAAIhI,GAAI;AACP,YAAIyiD,IAAMnlD,EAAUkoH,sBAAsB1jH,CACtC2gD;AAAAA,QAAAA,MACCA,EAAI4d,QACP/iE,EAAUmJ,UAAU,oBAAmB,CAACg8C,EAAI95B,GAAG3oB,EAAI21F,OAAOlzC,EAAI95B,CAAI7mB,GAAAA,CAAAA,CAAAA,IAElExE,EAAUmJ,UAAU,kBAAiB,CAACg8C,EAAI75B,GAAG65B,EAAI95B,GAAG3oB,EAAIX,SAASojD,EAAI75B,CAAO5oB,IAAAA,EAAIimI,QAAQxjF,EAAI95B,CAAAA,KAAI,CAAA,GAAI85B,EAAI75B,MAAK,CAAK9mB,GAAAA,CAAAA,CAAAA;AAAAA,MAEpH;AAAA,IACF;AAEA,QAAI8pI,IAA+BtuI,EAAU0T,gCAAgC,WAAA;AAAA;AAC7E1T,MAAU0T,+BAA+B,SAASlP,GAEjD;AAAA,aADUxE,EAAUuG,OAAOvG,EAAU0K,KAAAA,IAE7B1K,EAAUquI,yBAAyB7pI,CAAAA,IAEnC8pI,EAA6BpiI,MAAM5C,MAAK+I;IACjD,GAEArS,EAAUuuI,4BAA4B,SAAS/pI,GAAAA;AAC9C,aAAOxE,EAAUquI,yBAAyB7pI;IAC3C,GAEAxE,EAAUmsG,YAAY,SAAS5nG,GAAAA;AAC9B,aAAQvE,EAAUuG,OAAOvG,EAAU0K,UAAU1K,EAAUuG,OAAOvG,EAAU0K,KAAOkL,EAAAA,UAAUrR;AAAAA,IAC1F,GAEAvE,EAAUsE,YAAY,kBAAkB,SAAUgnB,GAAGD,GAAGlJ,GAAGC,GAAGhiB;AAC7D,UAAIkJ,CAAAA,KAAKhJ,OAAOy6B,aAAY36B,EAAMyF,QAAQ,cAAeyD,KAAKhJ,OAAOsT,kBAArE;AAEA,YAAIlR,IAAM1C,EAAUuG,OAAOvG,EAAU0K,KACjC8jI,GAAAA,IAAgB,CAAA;AACpBA,QAAAA,EAAcjtI,aAAamB,EAAIX,SAASupB,CAAAA,GACxCkjH,EAAchtI,WAAYkB,EAAIX,SAASupB,IAAE,CAAA,IAAM5oB,EAAIX,SAASupB,IAAE,CAAA,IAAKtrB,EAAUgC,KAAKC,IAAIS,EAAIX,SAASupB,CAAAA,GAAI5oB,EAAIojD,QAAQpjD,EAAIqjD,MAEnHrjD,GAAAA,EAAImkD,sBACP2nF,EAAcjtI,aAAa,IAAIiB,KAA8B,IAAzBgsI,EAAcjtI,aAAemB,EAAImkD,iBAClEnkD,IAAAA,EAAIokD,oBACP0nF,EAAchtI,WAAW,IAAIgB,KAAKgsI,EAAchtI,WAAWkB,EAAIokD,eAEhE0nF,IAAAA,EAAc9rI,EAAIa,UAAcb,IAAAA,EAAI21F,OAAOhtE,CAAAA,EAAGhY,KAC9CrT,EAAU6T,YAAY26H,GAAe,MAAMpuI;MAbmD;AAAA,IAc/F,CAAA,GAEAJ,EAAUsE,YAAY,gBAAgB,SAAUgjE,GAAU/iE,GAAM8vG,GAAAA;AAC/D,cAAQr0G,EAAUmsG,UAAU;IAC7B,CACAnsG,GAAAA,EAAUsE,YAAY,kBAAkB,SAASrB,GAAI8C,GAAAA;AACpDA,MAAAA,EAAG4C,SAASW,KAAKV,cAAc7C,CAAAA;AAAAA,IAChC,IACA/F,EAAUsE,YAAY,wBAAwB,SAAUyB,GAAIvB,GAAG02F,GAAMC,GAOpE;AAAA,aANGp1F,MACFA,EAAGu0F,cAAAA,SAEDa,MACFA,EAAOb,uBAED;AAAA,IACR,CAEAt6F,GAAAA,EAAU6rG,qBAAqB,SAAS7pG;AACvC,UAAIuC,IAAOvE,EAAUuG,OAAOvG,EAAU0K,QAClC+jI,IAAYzuI,EAAU6B,gBAAgB0C,GAAMvC,CAChD;AAAA,aAAA,CAAQhC,EAAU4O,SAAS6/H,CAAAA;AAAAA,IAC5B;AACA,QAAI7yC,IAA6B57F,EAAUmL;AAC3CnL,MAAUmL,0BAA0B,SAASvF,GAASoI,GAAM6C,GAAS1C,GAAUC,GAAAA;AAC9E,WAAKpO,EAAUM,OAAO+E;AACrB,eAAO,CAAA;AAER,UAAIrF,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAAAA,GAAQ;AAC1D,YAAI1K,EAAUmsG,UAAU,MACvB;AAAA;AAED,YAAIP,IAAY5rG,EAAU0M,WAAW,CAAE,GAAE1M,EAAUuG,OAAOvG,EAAU0K;AAEpEkhG,QAAAA,EAAUjqG,iBAAAA;AACV,YAAIuM,IAAS,CAAA,GAET4E,IAAQ,CACRvE,GAAAA,IAAQ,IACRvJ,IAAUY,EAAQvE,WAAYuE,EAAQvE,SAASyR,SAASlN,EAAQvE,SAAS6iC,WAAY;AACzF,YAAKrzB;AAkBJtC,UAAAA,IAAQ,CAACP,CAAAA,GACT8E,IAAQ,CAACjC,CAAAA;AAAAA,aAnBI;AACb,cAAI5B,IAAQ28F,EAAU38F;AACtB,cAAIjK;AACCiK,YAAAA,EAAM1C,eAAevH,CAAAA,MACxB8N,EAAMnQ,KAAKqC,CAAAA,GACXuJ,EAAM5L,KAAKipG,EAAUn9F,QAAQzJ;mBAG3B4mG,EAAUn9F;AACZ,qBAAS4E,KAAOpE;AACXA,cAAAA,EAAM1C,eAAe8G,CAAAA,KAAQu4F,EAAUn9F,QAAQ4E,OAClDP,EAAMnQ,KAAK0Q,IACX9E,EAAM5L,KAAKipG,EAAUn9F,QAAQ4E,CAAAA,CAAAA;AAAAA,QAKpC;AAaE,YARIlF,IAAWA,IAAW,IAAI3L,KAAK2L,CAAYnO,IAAAA,EAAUkK,WACrDkE,IAAWA,IAAW,IAAI5L,KAAK4L,CAAAA,IAAYpO,EAAUiK,WAEtDkE,EAAS1L,YAAYzC,EAAUkK,UAAUzH,cAC3C0L,IAAW,IAAI3L,KAAKxC,EAAUkK,SAAAA,IAC5BkE,EAAS3L,QAAYzC,IAAAA,EAAUiK,UAAUxH,QAC3C2L,MAAAA,IAAW,IAAI5L,KAAKxC,EAAUiK,cAE3B2hG,EAAU7pG;AAAU;AAExB,iBAAQmB,IAAI,GAAGA,IAAI0oG,EAAU7pG,SAASoB,UAClCnD,CAAAA,EAAU6rG,mBAAmBD,EAAU7pG,SAASmB,CADNA,CAAAA,GAAAA;AAAAA;AAI9C,YAAGA,KAAK0oG,EAAU7pG,SAASoB;AAC1B;AAED,YAAIgK,IAAQ;AAEZ,YAAIvH,EAAQF,OAAO,GAAG;AACrB,cAAIgpI,IAAgB,IAAIlsI,KAAKoD,EAAQF,IACjC1F;AAAAA,YAAUgC,KAAKwF,UAAU,IAAIhF,KAAK2L,CAAAA,CAAAA,KAAAA,CAAeugI,KAAkBtgI,CAAAA,KAAAA,CAAasgI,KACnFvhI,EAAMxK,KAAK+rI;QACf;AACGvhI,UAAAA,EAAMxK,KAAKuJ,MAAMiB,GAAOnN,EAAUgN,oBAAoBpH,EAAQF,IAAAA,CAAAA;AAM/D,iBAHIC,IAAQC,EAAQD,OAChB6H,IAAcxN,EAAUuN,2BAA2B3H,CAAAA,GAE9CiuB,IAAE,GAAGA,IAAE/gB,EAAM3P,QAAQ0wB;AAI7B,eAHA7lB,IAAOO,EAAMslB,CAAAA,GACbhjB,IAAUiC,EAAM+gB,CAAAA,GAEP3wB,IAAE,GAAGA,IAAEiK,EAAMhK,QAAQD;AAE7B,qBADIlB,IAAOmL,EAAMjK,CACRyJ,GAAAA,IAAE,GAAGA,IAAEhH,EAAMxC,QAAQwJ,KAAK,GAAG;AACrC,kBAAInC,IAAa7E,EAAMgH,CACnBI,GAAAA,IAAWpH,EAAMgH,IAAE,CACnBpL,GAAAA,IAAa,IAAIiB,KAAMR,CAAAA,IAAkB,KAAXwI,IAAc,GAAA,GAC5ChJ,IAAW,IAAIgB,KAAAA,CAAMR,IAAgB,KAAT+K,IAAY,GAAA;AAM5C,kBAJAxL,IAAa,IAAIiB,KAAKjB,EAAWkB,QAAAA,IAAwE,OAA3DlB,EAAWmtB,kBAAAA,IAAsB1sB,EAAK0sB,kBAAAA,KAA0B,EAIxGvgB,GAAAA,KAFN3M,IAAW,IAAIgB,KAAKhB,EAASiB,QAAsE,IAAA,OAAzDjB,EAASktB,kBAAsB1sB,IAAAA,EAAK0sB,kBAA0B,KAAA,EAAA,MAE3EtgB,IAAW7M,GAAxC;AAGA,oBAAIoM,IAAQ3N,EAAU0N,qBAAqB9H,CAAAA;AAC3C+H,gBAAAA,EAAMmB,YAAYtB;AAElB,oBAAIs+F,IAAY9rG,EAAUisG,eAAe,EAAC1qG,YAAYA,EAAAA,GAAAA,IAAoBqqG,CAAW,IAAA,GACjFG,KAAU/rG,EAAUisG,eAAe,EAAC1qG,YAAYC,EAAW,GAAA,IAAOoqG,KAAW,GAC7E58F,KAAQI,KAAKC,IAAI,GAAG08F,KAAUD,IAAY,CAAA,GAC1C/8F,KAAW68F,EAAUM,gBAAgBr7F,CAAAA,IAAS,KAAO+6F,EAAU91E,KAAK;AAExEnoB,gBAAAA,EAAM1M,MAAMgzC,UAAU,aAAWllC,KAAO,UAAU/O,EAAUM,OAAOsgC,MAAM,YAAW,YAAUkrE,IAAU,gBAAc98F,KAAM,eAE5HhB,EAAKoc,aAAazc,GAAOK,EAAKiC,UAAAA,GAC9B/B,EAAOvL,KAAKgL;cAbF;AAAA,YAcV;AAIH,eAAOO;AAAAA,MAET;AACG,aAAO0tF,EAA2B1vF,MAAMlM,GAAW,CAAC4F,GAASoI,GAAM6C,CAEtE,CAAA;AAAA,IAAA;AAEA,QAAI89H,IAAsB3uI,EAAUuK;AACpCvK,MAAUuK,mBAAmB,SAAStE,GAAW6D,GAChD;AAAA,UAAI9J,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAAAA,GAAQ;AAC1D,YAAIkkI,IAAS5uI,EAAU+J,aAAAA,GACnBS,IAAaxK,EAAU2H,kBAAkBinI,CACzChpI,GAAAA,IAAU,EACbF,MAAO1F,CAAAA,EAAUgC,KAAKwF,UAAUonI,CAAAA,GAChCjpI,OAAO,CAAC6E,GAAYA,IAAW,IAC/B/I,KAAK,uBACLoE,MAAM,eAEP;AAAA,eAAO7F,EAAUmL,wBAAwBvF,CAAAA;AAAAA,MAC3C;AACE,aAAO+oI,EAAoBziI,MAAMlM,GAAW,CAACiG,GAAW6D;IAE1D;AAEA,QAAI+kI,IAAe7uI,EAAU2P;AAC7B3P,MAAU2P,kBAAkB,WAC3B;AAAA,UAAG3P,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU4E,SAAAA,EAAWL,OAAM;AAKlE,iBAJIsL,IAAO,CAAA,GAEPnJ,IAAO1G,EAAUuG,OAAOvG,EAAU4E,SAAWL,EAAAA,IAAAA,GAC7CqB,IAAUc,EAAK2xF,QACXn1F,IAAI,GAAGA,IAAI0C,EAAQzC,QAAQD,KAAI;AACtC,cAAI6lI,IAAWnjI,EAAQ1C,GAAGmQ,KACtB0vD,IAAQr8D,EAAK+H,QAAQs6H,CAErBhxH,GAAAA,IAAI/X,EAAU8P,qBAAqBizD,GAAOgmE;AAC9Cl5H,UAAAA,EAAKlN,KAAKuJ,MAAM2D,GAAMkI,CAAAA;AAAAA,QACtB;AAED,eAAOlI;AAAAA,MACT;AACE,aAAOg/H,EAAa3iI,MAAM5C,MAAM+I,SAElC;AAAA,IAAA;AAEA,QAAIy8H,IAAsB9uI,EAAU8P;AACpC9P,MAAU8P,uBAAuB,SAASizD,GAAOgmE,GAEhD;AAAA,UAAI/oI,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAAAA,GAAQ;AAC1D,YAAImF,IAAO,CAAA,GACP7J,IAAYhG,EAAUuH;AAE1B,YAAIvB,KAAahG,EAAUuG,UAAUvG,EAAUuG,OAAOvG,EAAU0K,KAAAA;AAO/D,mBANInG,IAAOvE,EAAU0K,OAEjByD,IAAWnO,EAAUkK,WACrBkE,IAAWpO,EAAUiK,WACrBuJ,IAAcxN,EAAkB,QAE3BsH,IAAStN,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAK2L,CAAAA,CAAAA,GAAYb,IAASc,GAAUd,IAAStN,EAAUgC,KAAKC,IAAIqL,GAAQ,GAAG,KAAQ,GAAA;AACjI,gBAAIpH,IAAaoH,CAAAA,GACbrH,IAAYqH,EAAO7F,OAAAA,GACnBkE,IAAY,CAAA;AAEhB,gBAAG3L,EAAUM,OAAOgF,4BAA2B;AAC9C,kBAAImO,IAAYD,EAAYtN,MAAYsN,EAAYvN,CAAAA;AACpD0F,cAAAA,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBY,CAAAA,CAAAA;AAAAA,YACtE;AACQD,cAAAA,EAAYtN,CAAAA,KACdyF,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBW,EAAYtN,MAE3EsN,EAAYvN,CAAAA,KACd0F,EAAUhJ,KAAKuJ,MAAMP,GAAW3L,EAAU6S,uBAAuBW,EAAYvN,CAAAA,CAAAA,CAAAA;AAI/E,gBAAID,EAAUzB,MAASyB,EAAUzB,CAAAA,EAAMwkI,IAAW;AACjD,kBAAIgG,IAAW,CACXx7H,GAAAA,IAAavT,EAAUyS,qBAAqBzM,EAAUzB,CAAAA,EAAMwkI,GAAU9iI,CAAYD,GAAAA,EAAUzB,GAAMwkI,CAAU7iI,EAAAA,CAAAA,CAAAA;AAChH6oI,cAAAA,EAASpsI,KAAKuJ,MAAM6iI,GAAU/uI,EAAU6S,uBAAuBU,CAAAA,CAAAA,GAC5DvT,EAAUM,OAAOgF,6BAChBypI,EAAS5rI,WACXwI,IAAYojI,KAGbpjI,IAAYA,EAAUlC,OAAOslI,CAAAA;AAAAA,YAE9B;AAED,qBAAS7rI,IAAE,GAAGA,IAAEyI,EAAUxI,QAAQD,KAAK;AACtC,kBAAI5C,IAASqL,EAAUzI,CAAAA,GACnB+K,IAAM3N,EAAOoF;AACbuI,cAAAA,IAAM,KACTA,IAAM/H,GAEN2J,EAAKlN,KAAKuJ,MAAM2D,GAAM7P,EAAUmL,wBAAwB7K,GAAQyiE,GAAOgmE,GAAUz7H,GAAQtN,EAAUgC,KAAKC,IAAIqL,GAAQ,GAAG,KACvHW,CAAAA,CAAAA,GAAAA,IAAMhI,KAEN4J,EAAKlN,KAAKuJ,MAAM2D,GAAM7P,EAAUmL,wBAAwB7K,GAAQyiE,GAAOgmE,GAAUz7H,GAAQtN,EAAUgC,KAAKC,IAAIqL,GAAQ,GAAG,KAExH,CAAA,CAAA;AAAA,YAAA;AAAA,UACD;AAEF,eAAOuC;AAAAA,MACT;AACE,aAAOi/H,EAAoB5iI,MAAM5C,MAAM+I,SAEzC;AAAA,IAAA,GAEArS,EAAU26F,4BAA4B,SAASj0F,GAAMy+C,GAGpD;AAAA,eAFI6pF,IAAO,GACPxjF,IAAO,GACAwjF,IAAO1lI,KAAKi8C,OAAOE,QAAQtiD,UAAAA,GACrCqoD,KAAQliD,KAAKi8C,OAAOE,QAAQupF,CACjB7pF,KAAAA,EAAI95B,IAF8B2jH;AAAAA;AAM1CtoI,MAAAA,EAAK2xF,OAAO22C,OACfA,IAAKtoI,EAAK2xF,OAAOl1F,SAAO,IAEtBmG,KAAKs7C,eAAgBt7C,CAAAA,KAAKs7C,YAAY4iB,kBACxCl+D,KAAKs7C,YAAY4iB,gBAAgB9gE,EAAK2xF,OAAO22C,GAAM37H,MAGpD8xC,EAAIiC,SAAS,IACT4nF,KAAQ,KAAKtoI,EAAK2xF,OAAO22C,OAC5B7pF,EAAIngD,UAAUmgD,EAAIiC,OAAO1gD,EAAKnD,cAAcmD,EAAK2xF,OAAO22C,CAAM37H,EAAAA;AAAAA,IAEhE,GACArT,EAAUq7F,2BAA2B,SAASjjF,GAAAA;AAC7C,UAAI1R,IAAO0R,EAAO1R,MACjBtG,IAAQgY,EAAOhY,OACf+kD,IAAM/sC,EAAO+sC;AAEd,UAAI/kD,GAAO;AACV,YAAGA,EAAMsG,EAAKnD,eAAe4hD,EAAIngD,SAAQ;AACxC,cAAIiqI,IAAc3lI,KAAKm5H,6BAA6Bn5H,KAAKm5H,2BAA2BriI,GAAOsG,CAAQA,IAAAA,EAAKs2H,eAAe58H,CACvHA;AAAAA,UAAAA,EAAMkkC,UAAUh7B,KAAK23D,eAAe7gE,EAAMkkC,SAAS2qG,GAAavoI,EAAK4xF,iBAAiBnzC,EAAIngD,OAAAA,CAAAA;AAAAA,QAC1F;AACD5E,QAAAA,EAAMsG,EAAKnD,UAAc4hD,IAAAA,EAAIngD;AAAAA,MAC7B;AAAA,IACF,GACAhF,EAAU6B,kBAAgB,SAASvB,GAAQ0B,GAAAA;AAQ1C,eAPIktI,IAAU5uI,EAAOyB,UAEjBotI,IAAa,GAChBC,IAAWF,EAAQ/rI,SAAS,GAGzBksI,IAAYrtI,EAAKS,WACf2sI,IAAWD,IAAa,KAAE;AAC/B,YAAIG,IAASH,IAAa//H,KAAK+D,OAAOi8H,IAAWD,KAAY,CAAA;AAC1DD,QAAAA,EAAQI,CAAQ7sI,EAAAA,QAAAA,IAAY4sI,IAC9BD,IAAWE,IAEXH,IAAaG;AAAAA,MAEd;AAGD,eADI1tI,IAAQutI,GACLvtI,KAASwtI,KAAAA,CAAaptI,KAASktI,CAAAA,EAAQttI,IAAM,CAAA;AACnDA,QAAAA;AAED,aAAOA;AAAAA,IACR,GAEA5B,EAAU66F,sBAAsB,SAAS32D,GAAUqrG,GAAAA;AAClD,UAAI7sI,IAAMwhC,GACTihB,IAAUoqF;AAEX,UAAI7sI,CAAAA,EAAIX,SAASoB;AAChB,eAAO,IAAIX,KAAKxC,EAAU4E,SAAW5C,EAAAA,IAAAA;AAMtC,eAFIwtI,GACHjqC,GAsCG/jG,GAxCAgqD,IAAO,GAAGqiF,IAAO,GAGVA,KAAQvkI,KAAKqF,MAAMxL,SAAO,GAAG0qI;AAIvC,aADAriF,KADA+5C,IAAej8F,KAAKqF,MAAMk/H,CAAAA,KAEjB1oF,GAAM;AAEdqqF,UAAAA,KADAA,KAASrqF,KAAOqG,IAAK+5C,MAAeA,KACnB,IAAK,IAAIiqC;AAC1B;AAAA,QACA;AAGF,UAAG9sI,EAAIf,gBAAe;AAKrB,YAAI8tI,IAAO,GACPlrI,IAAOvE,EAAU4E,SAAAA,EAAWu+B;AAC7B5+B,QAAAA,KAAQA,KAAQ,UAAUA,KAAQ,aACpCkrI,IAAO,MAELD,KAASC,KACX5B,KAED2B,IAAQ;AAAA,MACR;AAGD,UAAI3B,MAAS,KAAKvkI,KAAKsF,SAAS,CAE/B;AAAA,aADAi/H,IAAO,GAAG2B,IAAQ,GACXlmI,KAAKsF,SAASi/H,CAAOA;AAAAA,UAAAA;AAAAA,eACjBA,KAAQvkI,KAAKqF,MAAMxL,UAAUmG,KAAKsF,SAASi/H,IAAK,CAAI,GAAA;AAE/D,aADAA,IAAOvkI,KAAKqF,MAAMxL,SAAO,GAAGqsI,IAAQ,GAC7BlmI,KAAKsF,SAASi/H;AAAOA,UAAAA;AAC5BA,QAAAA;AAAAA,MACA;AAID,UAAGA,KAAQnrI,EAAIX,SAASoB;AACvB3B,QAAAA,IAAWxB,EAAUgC,KAAKC,IAAIS,EAAIX,SAASW,EAAIX,SAASoB,SAAO,CAAA,GAAIT,EAAIojD,QAAQpjD,EAAIqjD,MAC/ErjD,GAAAA,EAAIokD,oBACPtlD,IAAW,IAAIgB,KAAKhB,IAASkB,EAAIokD,eAC5B;AAAA,WAAA;AACN,YAAI4oF;AAEJ,QAAGhtI,EAAIqjD,UAAU,UAGhB2pF,IAAiBF,IAAQjqC,KADQ,KADb,IAAI/iG,MAAK,oBAAIA,KAAME,CAAAA,EAAIX,SAAS8rI,CAAAA,CAAAA,GAAO3wH,YAAe,IAAA,oBAAI1a,MAAME,EAAIX,SAAS8rI,KAAO1wH,SAAW,IAAA,GAAG,GAAGtV,QACrF,IAAA,KAAG,KAAG,MAAM7H,EAAU2O,MAAM,MACZjM,EAAImkD,oBAExD6oF,IAAiBF,IAAQjqC,IAAe7iG,EAAIihI,QAAQjhI,EAAImkD,mBAEzDrlD,IAAW,IAAIgB,KAAME,CAAAA,EAAIX,SAAS8rI,CAAM6B,IAAAA,CAAAA;AAAAA,MACxC;AACD,aAAOluI;AAAAA,IACR,GAEAxB,EAAUsE,YAAY,0BAA0B;AAC/C,eAAQpB,KAAKlD,EAAUuG,QAAO;AAC7B,YAAI7D,IAAM1C,EAAUuG,OAAOrD,CAC3BR;AAAAA,QAAAA,EAAIo3F,UAAUp3F,EAAI48H;AAAAA,MAClB;AACD,aAAO;AAAA,IACR,IAEAt/H,EAAUsE,YAAY,iBAAgB,WAAA;AACrC,eAAQpB,KAAKlD,EAAUuG,QAAO;AAC7B,YAAI7D,IAAM1C,EAAUuG,OAAOrD,CAAAA;AAI3B,aAFAR,EAAIuM,QAAQ,IACZjP,EAAUmJ,UAAU,sBAAsB,KAClCjG,IAAE,GAAGA,IAAER,EAAI21F,OAAOl1F,QAAOD;AAChCR,UAAAA,EAAIuM,MAAMvM,EAAI21F,OAAOn1F,GAAGmQ,GAAKnQ,IAAAA;AAC9BlD,UAAUmJ,UAAU,sBAAsB,CACtCnJ,CAAAA,GAAAA,EAAUoT,SAAS1Q,EAAI6V,QAAQvY,EAAU0K,UAC5ChI,EAAI6nI,mBAAmB,IACvBvqI,EAAU6V,eAAe7V,EAAUoT,OAAOpT,EAAU0K,KACpDuN,GAAAA,WAAW;AACVvV,UAAAA,EAAI6nI,mBAAAA;AAAAA,QACR,CAEE;AAAA,MAAA;AAAA,IACF,IAEAvqI,EAAUsE,YAAY,mBAAmB,WAAA;AACxC,UAAIoC,IAAO1G,EAAUY,QAClB8F;AAAAA,MAAAA,KAAQ1G,EAAUuG,OAAOG,EAAK6R,SAC7BvY,EAAU4gI,2BAEZ5gI,EAAU4gI,uBAAuB4G,yBACjCxnI,GAAAA,EAAU4gI,uBAAuBO,kBAAkBz6H,CAAAA;AAAAA,IAItD,IAEA1G,EAAUsE,YAAY,gBAAe,SAASrB,GAAIkgC,GAAW3+B,GAAAA;AAC5D,UAAG2+B,KAAa,UAAS;AACxB,YAAIxc,IAAMniB,EAAEE,UAAUF,EAAEoiB;AACR5mB,UAAUkQ,cAAcyW,CAAAA,EAC3BxW,QAAQ,sBAAA,IAA0B,IAC9CnQ,EAAU0nD,mBAAAA,KAEV1nD,EAAU0nD,mBAAAA;AAAAA,MAEX;AAED,aAAA;AAAA,IACD,CAAA,GAEAylC,GAAWntF,CAAAA,GC39FI,SAASA,GAExB;AAAA,eAASshB,EAAStc,GAAS+f,GAAAA;AAC1B,iBAAQ7hB,IAAI,GAAGA,IAAI8B,EAAQ7B,QAAQD;AAClC,cAAG8B,EAAQ9B,GAAGD,MAAM8hB;AACnB;AAGF,eAAA;AAAA,MACD;AAEA/kB,MAAAA,EAAU4gI,yBAAyB,EAClC+O,wBAAwB,MACxBtN,wBAAwB,CACxBuN,GAAAA,wBAAwB,IACxB/H,wBAAwB,CAAA,GACxBgI,iBAAiB,CAAA,GACjBC,cAAc,CAAA,GACdC,iBAAiB,CACjBC,GAAAA,cAAc,IAEdnP,aAAa,SAAStE,GAAc0T,GAActmH,GAAYF;AAE7D,YAAIymH,IAAclwI,EAAU8C,WAAW4d,cAAc,kBACjDu/F,IAASiwB,EAAYhnH,yBAErBinH,IAAsBnwI,EAAU8C,WAAW4d,cAAc,+BAC1DyvH;AAAAA,QAAAA,KAAuBxmH,MAAvBwmH,WACFxmH,IAAa4yG,EAAartC,eAAeihD,CAAAA,IAEvC1mH,MAFuC0mH,WAIxC1mH,IADE0mH,IACUA,EAAoB1mH,YAEpBymH,EAAYzmH;AAI1B,YAAIpN,IAAO,CAAA;AACX,iBAAQnZ,KAAK+8G;AACZ5jG,UAAAA,EAAKnZ,CAAAA,IAAK+8G,EAAO/8G,CAAAA;AAQlB,eALAmZ,EAAKsN,aAAaA,KAAc,GAChCtN,EAAKoN,YAAYA,KAAa,GAC1BwmH,MACHhwB,EAAOlxG,SAASkhI,IAEV5zH;AAAAA,MACP,GACDmsH,eAAe,SAAUzyF,GAAMk4D,GAAAA;AAC9B,YAAImiC,IAAgBniC,EAAStkF,YACzB0mH,IAAgBpiC,EAASj/F,QAAQi/F,EAAStkF;AAG9C,eAAQosB,EAAK50C,OAAOkvI,IAAgB,OAAOt6F,EAAKhvB,QAAQqpH,IAAe;AAAA,MACvE,GACD9H,eAAe,SAAUvyF,GAAMk4D,GAAAA;AAC9B,YAAIqiC,IAAeriC,EAASxkF,WACxB8mH,IAAiBtiC,EAASl/F,SAASk/F,EAASxkF;AAGhD,eAAQssB,EAAK70C,MAAOqvI,IAAiB,MAAOx6F,EAAK3qB,SAASklH,IAAc;AAAA,MACxE,GAEDpD,kBAAkB,SAASxmI,GAAMunG,GAAAA;AAChC,YAAIg/B,IAAY;AAGhB,iBAAS/pI,KAFToG,KAAKsmI,yBAAyB,CAAA,GAEhBlpI,EAAKi4H,SAAS;AAC3B,cAAIx1F,IAAMziC,EAAKi4H,QAAQz7H;AACnBoG,eAAKk/H,cAAc,EAACrnI,MAAMgoC,EAAIhoC,MAAM4lB,OAAOoiB,EAAIhoC,OAAOnB,EAAU2O,MAAMzL,CAAAA,EAAAA,GAAK+qG,OAE9Eg/B,KADW9jG,EAAI99B,IAAIwtG,WAGnBvvG,KAAKsmI,uBAAuBjtI,KAAKwmC,EAAI99B,IAAIlH,aAAa,aAEvD,CAAA;AAAA,QAAA;AAED,eAAO8oI;AAAAA,MACP,GAED3C,cAAc,SAAS5jI,GAAMunG,GAAU3iG,GAAAA;AACtChC,aAAKymI,kBAAkB,IACvBzmI,KAAK0mI,eAAe;AAMpB,iBAJIn5H,IAAU7W,EAAU8C,WAAWC,iBAAiB,uBAAA,GAChDF,IAAQgU,EAAQA,EAAQ1T,SAAS,CAAA,EAAGJ,iBAAiB,gBAErDytI,GAAAA,IAAe,IACXttI,IAAI,GAAGA,IAAIL,EAAMM,QAAQD;AAChCstI,UAAAA,EAAa7tI,KAAKE,EAAMK,GAAGiB,aAAa,aAAA,CAAA;AAKzC,YADUmF,KAAK4jI,iBAAiBxmI,GAAMunG,CAAAA,GACtC;AAMA,mBAHIwiC,IAAYnnI,KAAKsmI,uBAAuB7jI,MACxC2kI,GAAAA,IAAa,IAED3gI,KAAP7M,IAAI,GAASstI,EAAartI,SAAQD,IAAI6M,GAAK7M,KAAK;AACxD,gBAAIiiD,IAAMsrF,EAAUtgI,QAAQqgI,EAAattI,CACpCiiD,CAAAA;AAAAA,YAAAA,IAAAA,KACJsrF,EAAUj/H,OAAO2zC,GAAK,CAAA,IAEtBurF,EAAW/tI,KAAK6tI,EAAattI;UAE9B;AAEGwtI,UAAAA,EAAWvtI,WACdmG,KAAKymI,kBAAkBW,EAAW3kI,SAClCzC,KAAKqnI,mBAAmBD,GAAYhqI,GAAM4E,CAAAA,IAEvCmlI,EAAUttI,WACbmG,KAAK0mI,eAAeS,EAAU1kI,MAC9BzC,GAAAA,KAAKsnI,gBAAgBH,GAAW/pI,GAAM4E;QApB/B;AAAA,MAsBR,GAEDqlI,oBAAoB,SAASvwH,GAAO1Z,GAAM4E,GAAAA;AACzC,iBAASpI,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD,KAAK;AACtC,cAAI6yC,IAAOzqC,EAAOoV,cAAc,mBAAiBN,EAAMld,KAAG,IACvD6yC;AAAAA,UAAAA,KACFzqC,EAAOE,YAAYuqC,CAAAA;AAAAA,QAEpB;AAAA,MACD,GAED66F,iBAAiB,SAASxwH,GAAO1Z,GAAM4E,GAAAA;AAEtC,iBADI5J,IAAO,IACFwB,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD;AACjCxB,UAAAA,KAAQgF,EAAKi4H,QAAQv+G,EAAMld,CAAImI,CAAAA,EAAAA,IAAIwtG;AAGpC,cAAMr+C,IAAS5sD,SAASC,cAAc,UAAA;AACtC2sD,QAAAA,EAAO1sD,YAAYpM,GACnB4J,EAAOyC,YAAYysD,EAAOltB,OAAAA;AAAAA,MAE1B,GAEDujG,kBAAkB,SAASnqI,GAAMunG,GAChC;AAAA,YAAKvnG,EAAK41H,YAAYn5H,QAAtB;AAEA,cAAI2tI,IAAc;AAElBxnI,eAAKu+H,yBAAyB,CAAA;AAC9B,mBAAS3kI,IAAI,GAAGA,IAAIwD,EAAK41H,YAAYn5H,QAAQD;AACxCoG,iBAAKg/H,cAAc,EAACpnI,KAAKwF,EAAK41H,YAAYp5H,CAAAA,EAAGhC,KAAKkqB,QAAQ1kB,EAAK41H,YAAYp5H,GAAGhC,MAAMwF,EAAKwlG,gBAAgBxlG,EAAK2xF,OAAOn1F,GAAGmQ,GAAO46F,EAAAA,GAAAA,CAAAA,MAElI6iC,KADWpqI,EAAK41H,YAAYp5H,CAAAA,EAAGmI,KAG/B/B,KAAKu+H,uBAAuBllI,KAAKO,CAInC;AAAA,iBAAO4tI;AAAAA,QAd8B;AAAA,MAerC,GAEDtG,cAAc,SAAS9jI,GAAMunG,GAAU3iG;AACtChC,aAAKumI,kBAAkB,IACvBvmI,KAAKwmI,eAAe;AAEpB,YAAIU,IAAe,CAcnB;AAAA,YAbiBxwI,EAAU8C,WAAWC,iBAAiB,yBAC9CqB,EAAAA,QAAS0uC,CAAAA;AACjB09F,UAAAA,EAAa7tI,KAAKob,OAAO+0B,EAAI3uC,aAAa,gBAAmB,CAAA,CAAA;AAAA,QAAA,CAAA,GAIzDqsI,EAAartI,WACjBmG,KAAKunI,iBAAiBnqI,GAAMunG,IAC5BuiC,IAAelnI,KAAKu+H,uBAAuB97H,MAIlCzC,IAAAA,KAAKunI,iBAAiBnqI,GAAMunG,CAAAA,GACtC;AAOA,mBAJIwiC,IAAYnnI,KAAKu+H,uBAAuB97H,SAExC2kI,IAAa,CAAA,GAERxtI,IAAI,GAAG6M,IAAMygI,EAAartI,QAAQD,IAAI6M,GAAK7M,KAAK;AACxD,gBAAIiiD,IAAMsrF,EAAUtgI,QAAQqgI,EAAattI,CAAAA,CAAAA;AACpCiiD,YAAAA,IAAO,KACXsrF,EAAUj/H,OAAO2zC,GAAK,KAEtBurF,EAAW/tI,KAAK6tI,EAAattI,CAE9B,CAAA;AAAA,UAAA;AAEGwtI,UAAAA,EAAWvtI,WACdmG,KAAKumI,kBAAkBa,EAAW3kI,MAClCzC,GAAAA,KAAKynI,kBAAkBL,GAAYhqI,GAAM4E,KAEtCmlI,EAAUttI,WACbmG,KAAKwmI,eAAeW,EAAU1kI,MAAAA,GAC9BzC,KAAK0nI,eAAeP,GAAW/pI,GAAM4E,CArB9B;AAAA,QAAA;AAAA,MAuBR,GAEDylI,mBAAmB,SAAS3wH,GAAO1Z,GAAM4E,GACxC;AAAA,iBAASpI,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD,KAAK;AACtC,cAAI6yC,IAAOzqC,EAAOoV,cAAc,sBAAoBN,EAAMld,CAAG,IAAA,IAAA;AAC1D6yC,UAAAA,KACFzqC,EAAOE,YAAYuqC;QAEpB;AAAA,MACD,GAEDi7F,gBAAgB,SAAS5wH,GAAO1Z,GAAM4E;AAErC,iBADI5J,IAAO,IACFwB,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD;AACjCxB,UAAAA,KAAQgF,EAAK41H,YAAYl8G,EAAMld,IAAImI;AAEpC,cAAMmvD,IAAS5sD,SAASC,cAAc,UACtC2sD;AAAAA,QAAAA,EAAO1sD,YAAYpM,GACnB4J,EAAOyC,YAAYysD,EAAOltB;MAC1B,GAEDk6F,0BAA0B;AACzBl+H,aAAKm+H,oBAAoB,IACzB;AAAA,MAAA,GACDA,qBAAqB,SAAS3rH;AAC7BxS,aAAKqmI,yBAAyB7zH,GAC9BxS,KAAK2nI,oCAAoCn1H;AAAAA,MAEzC,GAEDqlH,mBAAmB,SAASz6H,GAAAA;AAC3B,YAAIyB;AACJ,YAAGmB,KAAKqmI;AAGP,cAFAxnI,IAAMmB,KAAKqmI,wBAER3vI,EAAU4E,SAAAA,EAAWw/B,SAAQ;AAK/B,kBAAM8sG,IAASlxI,EAAU4E,SAAWw/B,EAAAA;AACpC,gBAAI+sG,IAAO,IAGPC;AAEJjpI,YAAAA,EAAI/D,QAAQ,CAACY,GAASpD,MAAAA;AACrB,kBAAGuvI;AACF;AAED,oBAAME,IAAmB3qI,EAAK2xF,OAAOz2F,CACrC;AAAA,uBAAQ0vI,IAAa,GAAGA,IAAatsI,EAAQ7B,QAAQmuI,KAAa;AACjE,sBAAMvrI,IAAKf,EAAQssI,CAEnB;AAAA,oBAAGvrI,EAAG9C,MAAMiuI,KAERnrI,EAAGW,EAAKnD,UAAgB8tI,MAAAA,GAAiB;AAC3CD,kBAAAA,IAAQ,IACRpsI,EAAQwM,OAAO8/H,GAAY,IAC3BA;AAEA,wBAAMC,IAA0B7qI,EAAKuI,MAAMlJ,EAAGW,EAAKnD,UAAAA,CAAAA;AAChD4E,kBAAAA,EAAIopI,CAA4BvsI,KAAAA,KAAWmD,EAAIopI,CAAAA,KAAAA,CAA6BjwH,EAASnZ,EAAIopI,IAA0BxrI,EAAG9C,EAAAA,KACxHkF,EAAIopI,CAAyB5uI,EAAAA,KAAKoD;gBAEnC;AAAA,cAGF;AAEEqrI,cAAAA,MACFD,IAAAA;AAAAA,YACA,CAAA;AAAA,UAGF;AAAA;WAEDhpI,IAAMnI,EAAUiiI,yBAAyBv7H,CACrC8qI,GAAAA,eAAe,IACnBloI,KAAKm+H,oBAAoBt/H,CAAAA;AAQ1B,eAAOA;AAAAA,MACP,GAED0iI,cAAc,SAASnkI,GAAMunG,GAC5B;AAAA,YAAI+5B,IAAmB1+H,KAAK63H,kBAAkBz6H,CAE1C+qI,GAAAA,IAAiBnoI,KAAK+4H,uBAAuBt2H;AAIjD,YAHAzC,KAAK+4H,yBAAyB,CAEnBriI,GAAAA,CAAAA,EAAU8C,WAAW4d,cAAc,sCAAA;AACnC;AAEX,cAAMgxH,IAAU,CAAA;AAChB,iBAASxuI,IAAI,GAAGA,IAAIoG,KAAKu+H,uBAAuB1kI,QAAQD,KAAK;AAC5D,cAAI4vC,IAAMxpC,KAAKu+H,uBAAuB3kI,CAClCyuI,GAAAA,IAAc;AAElB,gBAAM3wI,IAAY0F,EAAK2xF,OAAOvlD,CAAAA,EAAKz/B;AACnC,cAAIu+H,IAAmBH,EAAe3+F,KAAO2+F,EAAe3+F,CAAAA,EAAK/mC,UAAU,CAC3E/L;AAAAA,UAAAA,EAAUikI,oCAAoC1vH,KAAK7N,GAAMshI,EAAiBl1F,CAAAA,CAAAA;AAG1E,mBAFI29F,IAAYzwI,EAAU4gI,uBAAuB8H,uBAAuBhiI,GAAMunG,GAAU+5B,GAAkBl1F,CAEjGiD,GAAAA,IAAO,GAAG87F,IAAUpB,EAAUttI,QAAQ4yC,IAAO87F,GAAS97F,KAAQ;AACtE,gBAAIoP,IAAMysF,EAAiBzhI,QAAQzM,OAAO+sI,EAAU16F,CAAAA,EAAM9yC,EAC1D,CAAA;AAAA,gBAAKkiD;AAEJ,kBAAGnlD,EAAU4E,SAAWw/B,EAAAA,WAAWqsG,EAAU16F,CAAM9yC,EAAAA;AAClD,yBAAQ8U,IAAI,GAAGA,IAAI65H,EAAiBzuI,QAAQ4U;AACxC65H,kBAAAA,EAAiB75H,CAAAA,KAAM04H,EAAU16F,CAAM9yC,EAAAA,MAAMwtI,EAAU16F,CAAAA,EAAMrvC,EAAKnD,UAAAA,KAAevC,MACnF4wI,EAAiBpgI,OAAOuG,GAAG,CAC3BA,GAAAA;AAAAA;AAIF65H,gBAAAA,EAAiBpgI,OAAO2zC,GAAK,CAI9BwsF;AAAAA;AAAAA,cAAAA,EAAYhvI,KAAK8tI,EAAU16F;UAE5B;AAED,cAAG/1C,EAAU4E,SAAWw/B,EAAAA,SAAU;AACjC,kBAAMmqD,IAAOvuF,EAAU4E,SAAAA,EAAWw/B,SAC5B0tG,IAAiB9xI,EAAUyE,SAAS8pF,CAAAA;AAC1C,gBAAGvuF,EAAUilH,oBAAoB6sB,GAAe;AAC/C,oBAAMC,IAAW,CAAA;AACdD,cAAAA,EAAeprI,EAAKnD,eAAevC,KACrC2wI,EAAYhvI,KAAKmvI,CAElB9xI,GAAAA,EAAUilH,iBAAiB6sB,GAAgBprI,GAAMqrI,IACjDA,EAAS3tI,QAAQI,CAAAA;AACbA,gBAAAA,EAAEkC,EAAKnD,eAAevC,KACxB2wI,EAAYhvI,KAAK6B,CACjB;AAAA,cAAA,CAAA;AAAA,YAEP;AAAastI,cAAAA,KAAkBA,EAAeprI,EAAKnD,eAAevC,KAC7D2wI,EAAYhvI,KAAKmvI,CAElB;AAAA,UAAA;AAED,cAAIrvD,IAAO/7E,EAAKoiI,gBAAgB9nI,CAAAA;AAChC,cAAIyhF,CAAAA;AACH;AAEGmvD,UAAAA,EAAiBzuI,UACpBmG,KAAK0oI,cAAcJ,GAAkBlrI,GAAM+7E,CAG5C;AAAA,gBAAMwvD,IAAW,EAChBj1C,WAAWva,GACXjoB,QAAQ5sD,SAASC,cAAc;AAEhC6jI,UAAAA,EAAQ/uI,KAAKsvI,IACTN,EAAYxuI,UACfmG,KAAK4oI,WAAWP,GAAajrI,GAAMurI,EAASz3E,QAAQ1nB,CAAAA;AAAAA,QAErD;AAED4+F,QAAAA,EAAQttI,QAAQ,SAAS+tI,GACxBA;AAAAA,UAAAA,EAAUn1C,UAAUjvF,YAAYokI,EAAU33E,OAAOltB;QACpD,CACEttC,GAAAA,EAAUoiI,4BAA4BpiI,EAAU8C,UAAAA,GAChD4D,EAAKiiI,UAAUX;AAAAA,MACf,GAEDgK,eAAe,SAASl2H,GAAQpV,GAAM4E,GACrC;AAAA,iBAASpI,IAAI,GAAGA,IAAI4Y,EAAO3Y,QAAQD,KAAK;AACvC,gBAAM6mB,IAAW,MAAI/pB,EAAUM,OAAO0C,kBAAgB,OAAM8Y,EAAO5Y,KAAI;AACvE,cAAI9C,IAAQkL,EAAOoV,cAAcqJ,CAAAA;AACjC,cAAI3pB;AACH,gBAAKA,EAAMye,UAAUyC,SAAS,gBAEvB;AACN,oBAAMimD,IAAQj8D,EAAOvI,iBAAiBgnB,CAAAA;AAEtC,uBAAQ7mB,IAAI,GAAGA,IAAIqkE,EAAMpkE,QAAOD;AAC1BqkE,gBAAAA,EAAMrkE,CAAG2b,EAAAA,UAAUyC,SAAS,aAAA,KAChCimD,EAAMrkE,CAAGmnB,EAAAA,OAAAA;AAAAA,YAGX;AATAjqB,cAAAA,EAAMiqB,OAAAA;AAAAA,QAWR;AAAA,MACD,GAED6nH,YAAY,SAASp2H,GAAQpV,GAAM4E,GAAQpI;AAE1C,YAAIkvI,IAAcpyI,EAAUukI,6BAA6BhwH,KAAK7N,GAAMoV,CACpExQ;AAAAA,QAAAA,EAAOwC,YAAYskI;AAAAA,MACnB,GAED1J,wBAAwB,SAAShiI,GAAMunG,GAAU9lG,GAAKsqG,GAErD;AAAA,YAAI4/B,IAAgB,CACpB;AAAA,YAAI3rI,EAAKkP,UAAU;AAClBy8H,UAAAA,IAAgBlqI;AAAAA,aACV;AACN,cAAIgqI,IAAYhqI,EAAIsqG,CAAAA;AACpB,cAAI0/B;AACH,qBAASrvE,IAAI,GAAGwvE,IAAQH,EAAUhvI,QAAQ2/D,IAAIwvE,GAAOxvE,KAAK;AACzD,kBAEIyvE,GAAQC,GAFRpyI,IAAQ+xI,EAAUrvE,CAClB2vE,GAAAA,IAAqBhgC,IAAW,MAAMryG,EAAM6C;AAE5CkF,cAAAA,EAAIqpI,gBAAgBrpI,EAAIqpI,aAAaiB,CAAAA,KACxCF,IAASpqI,EAAIqpI,aAAaiB,GAAoBF,QAC9CC,IAAOrqI,EAAIqpI,aAAaiB,CAAAA,EAAoBD,SAE5CD,IAASvyI,EAAUisG,eAAe7rG,GAAAA,IAAcsG,CAAAA,GAChD8rI,IAAOxyI,EAAUisG,eAAe7rG,OAAasG,CAAAA,GAEzCyB,EAAIqpI,iBACPrpI,EAAIqpI,aAAaiB,CAAAA,IAAsB,EACtCF,QAAQA,GACRC,MAAMA,EAAAA,KAKLxyI,EAAU4gI,uBAAuB4H,cAAc,EAACrnI,MAAMoxI,GAAQxrH,OAAOyrH,EAAAA,GAAOvkC,CAC/EokC,MAAAA,EAAc1vI,KAAKvC,CAGdkJ,GAAAA,KAAK+4H,uBAAuB5vB,CAChCnpG,MAAAA,KAAK+4H,uBAAuB5vB,CAAY,IAAA,CAAA,IACzCnpG,KAAK+4H,uBAAuB5vB,CAAU9vG,EAAAA,KAAKe,OAAOtD,EAAM6C,EAAAA,CAAAA;AAAAA,YAEzD;AAAA,QAEF;AAED,eAAOovI;AAAAA,MACP,GAEDK,wBAAwB,SAAShsI,GAAMunG,GAAUw2B,GAAOt8H,GAAKjF,GAQ5D;AAAA,iBAJIqjI,GADAgB,IAAc,IAGdoL,IAAiBrpI,KAAKsmI,wBAEjB/oH,IAAM,GAAGA,IAAM8rH,EAAexvI,QAAQ0jB,KAAO;AACrD,cAAIgN,IAAI8+G,EAAe9rH,CAEvB0/G;AAAAA,UAAAA,IAAc7/H,EAAKi4H,QAAQ9qG,CAAG1yB,EAAAA,OAAOuF,EAAKy/B,IAEtCnmC,EAAU4O,SAASilB,CAEH,IAAfntB,EAAKkP,UAAU,SAClB2xH,KAAevnI,EAAUmmI,oCAAoC1B,CAE7D8C,IAAAA,KAAevnI,EAAU6mI,mCAGP,IAAfngI,EAAKkP,UAAU,SAClB2xH,KAAevnI,EAAUomI,4BAA4BvyG,GAAG3wB,GAAGwD,GAAMyB,EAAIjF,CAAAA,EAAG2wB,IAAI4wG,GAAO8B,CAAAA,IAEnFgB,KAAevnI,EAAU8mI,2BAA2BjzG,GAAG3wB,GAAGwD,GAAMyB,EAAIjF,CAAAA,GAAIqjI,CAG1E;AAAA,QAAA;AAED,eAAOgB;AAAAA,MACP,GAEDqL,4BAA4B,SAASlsI,GAAMunG,GAAU9lG,GAAKsqG,GAAAA;AACzD,YAAI80B,IAAc,IACd9C,IAAQzkI,EAAUo9H,4BAA4B12H,GAAM+rG;AACxDgyB,QAAAA,IAAQzkI,EAAU2lI,+BAA+Bj/H,GAAM+rG,GAAUgyB,CAEjE;AAAA,YAAIoO,IAAYnsI,EAAK41H,YAAY7pB,CAE7Bv5E,GAAAA,IAAWl5B,EAAUya,UAAU/T,EAAK6R,OAAO,YAC3C2tH,GAAAA,IAAiB,EAAEx/H,MAAMA,GAAM1B,SAAS6tI,EAAU7tI,SAASk0B,UAAUA;AAgBzE,eAdIxyB,EAAKkP,UAAU,UAClB2xH,KAAevnI,EAAUgmI,qCAAqCvzB,GAAUgyB,GAAOoO,EAAU3xI,KAAK2xI,EAAU7tI,QAAQqO,KAAK6yH,CAAAA,GACrHqB,KAAej+H,KAAKopI,uBAAuBhsI,GAAMunG,GAAUw2B,GAAOt8H,GAAKsqG,IACvE80B,KAAe,aAGfA,KAAevnI,EAAU2mI,uCAAuCl0B,GAAUgyB,GAAOoO,EAAU3xI,KAAK2xI,EAAU7tI,QAAQqO,KAAK6yH,CAGvHqB,GAAAA,KAAevnI,EAAU4mI,oCAAoCnC,GAAOyB,IACpEqB,KAAej+H,KAAKopI,uBAAuBhsI,GAAMunG,GAAUw2B,GAAOt8H,GAAKsqG,CACvE80B,GAAAA,KAAe,iBAGTA;AAAAA,MACP,GAEDmD,gBAAgB,SAAShkI,GAAMunG,GAC1B3kG;AAAAA,aAAKumI,gBAAgB1sI,UACxBmG,KAAKwpI,gBAAgBxpI,KAAKumI,iBAAiBnpI,CAExC4C,GAAAA,KAAKwmI,aAAa3sI,UACrBmG,KAAKypI,aAAazpI,KAAKwmI,cAAcppI,GAAMunG;MAI5C,GAED6kC,iBAAiB,SAAS1yH,GAAO1Z,GAAAA;AAEhC,YADa1G,EAAU8C,WAAW4d,cAAc,sCAAA,GAChD;AAEA,mBAASxd,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD,KAAK;AACtC,kBAAMlC,IAAY0F,EAAK2xF,OAAOj4E,EAAMld,MAAMwD,EAAK2xF,OAAOj4E,EAAMld,CAAImQ,CAAAA,EAAAA,MAAM;AACnE3M,YAAAA,EAAKoiI,gBAAgB9nI,CACvB0F,MAAAA,EAAKoiI,gBAAgB9nI,CAAAA,EAAWqpB,iBACzB3jB,EAAKoiI,gBAAgB9nI;UAI7B;AAEDsI,eAAKumI,kBAAkB,CAZH;AAAA,QAAA;AAAA,MAapB,GAEDkD,cAAc,SAAS3yH,GAAO1Z,GAAMunG,GAEnC;AAAA,YAAA,EADI3iG,IAAStL,EAAU8C,WAAW4d,cAAc,sCACnC;AAAA;AAKb,iBAHIvY,IAAMmB,KAAK63H,kBAAkBz6H,CAAAA,GAE7BhF,IAAO,IACFwB,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD;AACjCxB,UAAAA,KAAQ4H,KAAKspI,2BAA2BlsI,GAAMunG,GAAU9lG,GAAKiY,EAAMld,CAAAA,CAAAA;AAGpE,cAAMs3D,IAAS5sD,SAASC,cAAc,UAAA;AACtC2sD,QAAAA,EAAO1sD,YAAYpM,GACnB4J,EAAOyC,YAAYysD,EAAOltB,OAI1B;AAAA,YAAIhiC,IAAStL,EAAU8C,WAAW4d,cAAc,sCAAA;AAChDha,QAAAA,EAAKoiI,kBAAkB;AACvB,iBAAQ5lI,IAAI,GAAG6M,IAAMzE,EAAOyzC,SAAS57C,QAAQD,IAAI6M,GAAK7M,KAAI;AACzD,cAAIqnB,IAAQjf,EAAOyzC,SAAS77C,CAAAA;AACzBqnB,UAAAA,EAAMzC,aAAa,iBAAA,MACrBphB,EAAKoiI,gBAAgBv+G,EAAMpmB,aAAa,sBAAsBomB;AAAAA,QAE/D;AAED,aAASrnB,IAAI,GAAGA,IAAIkd,EAAMjd,QAAQD,KAAK;AACtC,gBAAMlC,IAAY0F,EAAK2xF,OAAOj4E,EAAMld,MAAMwD,EAAK2xF,OAAOj4E,EAAMld,CAAImQ,CAAAA,EAAAA,MAAM;AACtErT,UAAAA,EAAUgpI,+BAA+BtiI,GAAMA,EAAK2xF,OAAOj4E,EAAMld,IAAImQ,KAAK3M,EAAKoiI,gBAAgB9nI,CAC/F,CAAA;AAAA,QAAA;AACGhB,QAAAA,EAAU0J,aACb1J,EAAU0J,aAEXJ,KAAKwmI,eAAe;MACpB,GAEDrF,gBAAgB,SAAS/jI,GAAMunG,GAAAA;AAI9B,iBAHI+kC,IAAuB1pI,KAAKsmI,wBAE5BqD,IAA2B,CAAA,GACvB/vI,IAAI,GAAGA,IAAI8vI,EAAqB7vI,QAAQD;AAC/C+vI,UAAAA,EAAyBD,EAAqB9vI,CAAAA,CAAAA,IAAAA;AAG/BlD,QAAAA,EAAU8C,WAAWC,iBAAiB,wBAC9CqB,EAAAA,SAAQ,SAAU0uC,GACzB;AAAA,gBAAMogG,IAAWpgG,EAAI/vC,iBAAiB,eAAA,GAEhCowI,IAAgBtnI,MAAMgS,UAAU+gC,OAAOrqC,KAAK2+H,GAAU,SAAS75E,GAAM/K,GAAAA;AAE1E,mBADA+K,EAAK/K,EAAKr3B,QAAQm8G,SAAS9kF,GACpB+K;AAAAA,UACP,GAAE,CAAE,CAAA;AAEL,cAAIg6E,IAAe,CAAA,GACnBC,IAAe,CAAA;AACf,mBAAQpwI,KAAKiwI;AACRF,YAAAA,EAAyB/vI,MAC5BmwI,EAAa1wI,KAAKwwI,EAAcjwI,CAGlC,CAAA;AAAA,mBAAQA,KAAK+vI;AACRE,YAAAA,EAAcjwI,MACjBowI,EAAa3wI,KAAKO;AAIpBmwI,UAAAA,EAAajvI,QAAQ,SAASkqD,GAC7BA;AAAAA,YAAAA,EAAKjkC,OACT;AAAA,UAAA,CAAA,GACMipH,EAAanwI,UACfmG,KAAKiqI,aAAazgG,GAAKwgG,GAAc5sI,GAAMunG,CAAAA;AAAAA,QAI5C,GAAE90F,KAAK7P,IAAAA,CAAAA;AAAAA,MACR,GAEDiqI,cAAc,SAASzgG,GAAK1yB,GAAO1Z,GAAMunG,GAAAA;AAExC,aADWjuG,EAAU8C,WAAW4d,cAAc,sCACnC;AAAA;AAEX,YAAIvY,IAAMmB,KAAK63H,kBAAkBz6H;AAEjC,cAAM1F,IAAY8xC,EAAInuC,QAAQ,mBAAA,EAAqBR,aAAa,iBAC1Dg5H,GAAAA,IAAez2H,EAAKuI,MAAMjO,CAChC;AAAA,YAAIU,IAAO,IACP+iI,IAAQzkI,EAAUo9H,4BAA4B12H,GAAMy2H;AACxDsH,QAAAA,IAAQzkI,EAAU2lI,+BAA+Bj/H,GAAMy2H,GAAcsH,CAAAA;AAErE,YAAIn5H,IAASwnC;AAGb,YAAIxnC,GAAQ;AACX,mBAASuoB,IAAI,GAAGA,IAAIzT,EAAMjd,QAAQ0wB;AAGjC,gBAFWvoB,CAAAA,EAAOoV,cAAc,mBAAiBN,EAAMyT,KAAG,IAE/C,GAAA;AACV,kBAAIy6B,IAAOhlD,KAAKkqI,mBAAmB9sI,GAAMunG,GAAUw2B,GAAOt8H,GAAKg1H,GAAc/8G,EAAMyT;AAC/Ey6B,cAAAA,MACH5sD,KAAQ4sD;AAAAA,YACT;AAGF,gBAAMkM,IAAS5sD,SAASC,cAAc,UAAA;AACtC2sD,UAAAA,EAAO1sD,YAAYpM,GACnB4J,EAAOyC,YAAYysD,EAAOltB,OAC1B;AAAA,QAAA;AAAA,MAGD,GAEDkmG,oBAAoB,SAAS9sI,GAAMunG,GAAUw2B,GAAOt8H,GAAKsqG,GAAUC;AAClE,YAAKhsG,EAAKi4H,QAAQjsB,CAAlB,GAAA;AACA,cAAI60B,IAAc,IACdhB,IAAc7/H,EAAKi4H,QAAQjsB,GAAWvxG,OAAKuF,EAAKy/B;AAgBpD,iBAdIz/B,EAAKkP,UAAU,SACd5V,EAAU4O,SAAS8jG,OAGtB60B,KAAevnI,EAAUomI,4BAA4B1zB,GAAWD,GAAU/rG,GAAMyB,EAAIsqG,CAAUC,EAAAA,CAAAA,GAAY+xB,GAAO8B,CAG9GvmI,KAAAA,EAAU4O,SAAS8jG,CAGtB60B,MAAAA,KAAevnI,EAAU8mI,2BAA2Bp0B,GAAWD,GAAU/rG,GAAMyB,EAAIsqG,CAAAA,GAAW8zB,KAIzFgB;AAAAA,QAlB8B;AAAA,MAmBrC,KAGFvnI,EAAUsE,YAAY,cAAc,WACnCtE;AAAAA,QAAAA,EAAU4gI,uBAAuB+O,yBAAyB,MAC1D3vI,EAAU4gI,uBAAuByB,yBAAyB,CAAA;AAAA,MAC3D,IACAriI,EAAUsE,YAAY,oBAAoB,WAEzC;AAAA,eADAtE,EAAU4gI,uBAAuB4G,yBAC1B,GAAA;AAAA,MACR;IAIA,EDyzEYxnI;EAKZ,GACAA,EAAUu9H;AAGV,G/C/5FCnqD,SiDzED,SAAyBpzE,GAAAA;AAExBA,IAAUM,OAAOoxF,kBAAkB,IACnC1xF,EAAUM,OAAO4vF,mBAAmB,IACpClwF,EAAUM,OAAO0vF,mBAAmB,IACpChwF,EAAUM,OAAOqxF,uBAAuB;AAElC,QAAA8hD,IAAiB,IAAIhjD,GAAezwF,CAAAA;AAE1CA,IAAU6c,IAAI62H,WAAWD,GAEfzzI,EAAAsE,YAAY,oBAAoB;AAEzCmvI,IAAAA,EAAeE,WAAW,EACzB5pH,UAAU,MAAM/pB,EAAUM,OAAO0C,kBAAkB,KACnDtB,MAAOtB,OACN;AAAA,UAAIJ,EAAUsiC,WAAYtiC,CAAAA,EAAUM,OAAO4wF;AAC1C;AAGD,YAAM0iD,IAAgB5zI,EAAUolC,cAAchlC,EAAMsE,MAChD;AAAA,UAAA1E,EAAUyE,SAASmvI,CAAAA,GAAgB;AAChCxzI,cAAAA,IAAQJ,EAAUyE,SAASmvI,CAAAA;AACjC,eAAO5zI,EAAUya,UAAUo+C,aAAaz4D,EAAMmB,YAAYnB,EAAMoB,UAAUpB,CAC3E;AAAA,MAAA;AACO,aAAA;AAAA,IAAA,GAERN,QAAQ,GAAA,CAAA;AAAA,EACR,CAGQE,GAAAA,EAAAsE,YAAY,aAAa,WAAA;AAClCmvI,IAAAA,EAAe99F,WAAW;AAAA,EAAA,CAAA,GAGjB31C,EAAAsE,YAAY,cAAc,WACnCmvI;AAAAA,IAAAA,EAAeI,YAAY;AAAA,EAAA,CAAA,GAGlB7zI,EAAAsE,YAAY,gBAAgB;AAErC,WAAItE,EAAUsiC,WAAWtiC,EAAUM,OAAO4wF,iBAG1CuiD,EAAeI,YAFP,GAAA;AAAA,EAGD,IAEE7zI,EAAAsE,YAAY,kBAAkB,WAEhC;AAAA,WADPmvI,EAAeI,YACR,GAAA;AAAA,EAAA,CAGT;AAAA,GjDsBChuE,ckD5Ec,SAAS7lE;AAyHxB,MAAI8zI;AAvHJ9zI,IAAUsE,YAAY,qBAAqB,SAAU5B,GAEnC;AAAA,IAAdA,EAAIkT,UAAU,WAChBlT,EAAIm7H,kBAAkBn7H,EAAI21F,QAC1B31F,EAAI21F,SAASr4F,EAAU+zI,mBAAmBrxI,EAAIm7H,eAAAA,GAExC79H,EAAUsE,YAAY,sBAAsB,WAAA;AACxC5B,QAAI21F,SAASr4F,EAAU+zI,mBAAmBrxI,EAAIm7H,eAAAA;AAAAA,IAC1D,IAEE79H,EAAUu4B,YAAY71B,EAAI6V,IAAAA,IAAM,EAC/B3C,QAAO,SAASwjB,GAEf;AAAA,aADc;AAAA,IAEd,GACDV,WAAU,SAASpS,GAAK9N,GAAMzS,GAAGzF,GAAAA;AAChC,UAAIsF,IAAU5F,EAAUg0I,mBAAmBh0I,EAAUuG,OAAOjG,EAAOuF,IAAAA,EAAMg4H,iBAAiBv9H,EAAOuF,IAAAA;AACjGygB,MAAAA,EAAKxY,YAAY;AACjB,UAAImmI,IAAcrmI,SAASC,cAAc;AACzCyY,MAAAA,EAAKvY,YAAYkmI;AAEjB,UAAItsH,IAASrB,EAAKwS,qBAAqB,QAAU,EAAA,CAAA;AAAA,OAE5CnR,EAAO8R,iBAAiBn5B,EAAOo5B,aACnC/R,EAAOxC,iBAAiB,UAAU7kB,EAAOo5B,QAAAA,GACzC/R,EAAO8R,gBAAAA;AAGR,eAASv2B,IAAI,GAAGA,IAAI0C,EAAQzC,QAAQD,KAAK;AACxC,YAAIgxI,IAActmI,SAASC,cAAc,QAAA;AACzCqmI,QAAAA,EAAY17H,QAAQ5S,EAAQ1C,GAAGmQ,KAC5B6gI,EAAY17H,SAASzS,EAAG/F,EAAUuG,OAAOjG,EAAOuF,IAAMtC,EAAAA,UAAAA,MACxD2wI,EAAYvhF,WAAW,KACxBuhF,EAAYpmI,YAAYlI,EAAQ1C,GAAG8wB,OACnCrM,EAAO5Z,YAAYmmI,CAAAA;AAAAA,MACnB;AAAA,IACD,GACD17G,WAAU,SAASlS,GAAKvgB,GAAGzF,GAC1B;AAAA,aAAOgmB,EAAKrW,WAAWuI;AAAAA,IACvB,GACD6gB,OAAM,SAAS/S,GAAAA;AAAAA,IACd;EAKJ,CAEAtmB,GAAAA,EAAUsE,YAAY,yBAAyB,SAAU+6H,GAAahnC,GAAQn0D,GAAAA;AAC7E,QAAI98B,IAAM,CAAA;AACV,QAAGi4H,KAAe,QAAO;AACxB,UAAItwH,GAEAw2H,GAAcvjC,GAAcojC,GAC5B+O,GAEAzO,GAgCAJ,GACA8O;AA/BJhP,MAAAA,IAAe,qCACZ/sC,EAAOt5C,YACThwC,IAASm1B,EAASmwG,aAAWnwG,EAASpO,IACnCoO,EAASmwG,aAAAA,CAAcnwG,EAAS60D,uBAClCiJ,IAAe,YAAU99D,EAASmwG,YAAU,QAE7C9O,IAAe,kBACfH,KAAgB,WACb/sC,EAAO9hC,OACT6uE,KAAgB,YAEhBA,KAAgB,WAEjB+O,IAAa,wCACbzO,IAAmBxhG,EAAgC,0BAAE,iCAA+B,4BAEpFn1B,IAASm1B,EAASpO,IAClByvG,IAAe,gBACfH,KAAgB,SAChB+O,IAAa,IACbzO,IAAkB,mBAGhBxhG,EAASo9B,YACX8jE,KAAgB,8BAGjBA,KAAiBplI,EAAUya,UAAUypB,EAAS3rB,OAAK,eAAiB8/E,EAAAA,EAAOhlF,KAAKglF,EAAOrkE,OAAOqkE,CAC7F,IAAA,MAAIr4F,EAAUya,UAAUypB,EAAS3rB,OAAK,eAAA,EAAiB8/E,EAAOhlF,KAAKglF,EAAOrkE,OAAOqkE,CAAU,IAAA;AAI5F,YAAMi8C,IAAe,qDAAqDj8C,EAAOk8C;AAGhFH,MAAAA,IADE/7C,EAAOk8C,QAAQ,IACF,QAAQD,aAER,QAAQA,CAAAA;AAExB,YAAMtxB,IAAU,4DAA4DoxB,CAAAA;AAG3E9O,MAAAA,IADEphG,EAASo9B,WAAWp9B,EAASo9B,QAAQn+D,SACzB,4DAA4D6/G,CAAWmxB,IAAAA,CAAAA,SAAoBn0I,EAAUya,UAAUypB,EAAS3rB,OAAK,gBAAgB8/E,EAAOhlF,KAAKglF,EAAOrkE,OAAOqkE,CAAAA,KAASA,EAAOrkE,KAExL,WAAA,gCAAgCgvF,CAAWmxB,IAAAA,CAAAA,+BAA0Cn0I,EAAUya,UAAUypB,EAAS3rB,OAAK,cAAA,EAAgB8/E,EAAOhlF,KAAKglF,EAAOrkE,OAAOqkE,CAASA,KAAAA,EAAOrkE,KAG/L5sB,gBAAAA,IAAM,EACL2H,QAAQA,GACRizF,cAAcA,GAEdujC,cAAcA,GACdH,cAAcA,GACdE,YAAYA,GAEZI,iBAAiBA,EAAAA;AAAAA,IAElB;AACD,WAAOt+H;AAAAA,EACR,CAIApH,GAAAA,EAAUsE,YAAY,wBAAwB,SAASkwI,GAAcC,GAAcjrF,GAAAA;AAClF,QAAIxpD,EAAUmsG,UAAU;AAGvB,eADIuoC,IAAc10I,EAAU6kH,sBAAsB7kH,EAAU6kH,oBAAoB2vB,CAAAA,IAAgB,CAACA,EAAax0I,EAAUuG,OAAOvG,EAAU0K,KAAOnH,EAAAA,UAAAA,CAAAA,GACxIL,IAAI,GAAGA,IAAIwxI,EAAYvxI,QAAQD,KAAI;AAC1C,YAAI8B,IAAUhF,EAAU20I,WAAWD,EAAYxxI,CAAAA,CAAAA;AAC/C,YAAI8B,KAAaA,EAAQ+5C,aAAa/+C,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAO80H;AAIvE,iBAHKh2E,MACJgrF,EAAax0I,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOnH,cAAcuwI,IAEvD;AAAA,MAER;AAEF,WAAA;AAAA,EACD,CAAA,GAEA9zI,EAAUsE,YAAY,gBAAgB,SAAUgjE,GAAU/iE,GAAM8vG;AAC/D,QAAGr0G,EAAUmsG,UAAU,MAAA,GAAS;AAC/B,UACIxS,GADArrC,IAAOtuD,EAAUkoH,sBAAsB7T,CAE3C;AAAA,UAAG/lD,MACFqrC,IAAa35F,EAAUuG,OAAOvG,EAAU0K,KAAO2tF,EAAAA,OAAO/pC,EAAKjjC,CAAGhY,EAAAA,KACzDrT,EAAUuG,OAAOvG,EAAU0K,OAAO2tF,OAAO/pC,EAAKjjC,CAAG0zB,EAAAA,YAAAA,CAAa/+C,EAAUuG,OAAOvG,EAAU0K,KAAO80H,EAAAA;AACpG;AAIF,UAAIz5H,IAAK/F,EAAUyE,SAAS6iE,IACxB7gE,IAAWzG,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOnH;AAEjDuwI,MAAAA,IAAqB/tI,KAAMA,EAAGU,CAAaV,IAAAA,EAAGU,CAAYkzF,IAAAA;AAAAA,IAC1D;AACD,WAAA;AAAA,EACD,CAEA35F,GAAAA,EAAU+zI,qBAAqB,SAASt8G,GAAAA;AACvC,QAAIpf,IAAS,CAAA,GACTu8H,IAAkB,SAASn9G,GAAOo9G,GAAKvpI,GAAQwpI,GAElD;AAAA,eADIP,IAAQM,KAAK,GACR3xI,IAAI,GAAGA,IAAIu0B,EAAMt0B,QAAQD,KAAK;AACtC,YAAIojB,IAAOmR,EAAMv0B,CACjBojB;AAAAA,QAAAA,EAAKiuH,QAAQA,GACbjuH,EAAKi4G,UAAUjzH,KAAU,MACnBgb,EAAKy4B,YAAmBz4B,EAAKjT,mBAClCiT,EAAKjT,MAAMrT,EAAUqM,IAGjByoI,IAAAA,KACJz8H,EAAO1V,KAAK2jB,CAGVA,GAAAA,EAAKy4B,YACP61F,EAAgBtuH,EAAKy4B,UAAUw1F,IAAM,GAAGjuH,EAAKjT,KAAKyhI,KAAAA,CAASxuH,EAAKiwC,IAAAA;AAAAA,MAEjE;AAAA,IACH;AAEC,WADAq+E,EAAgBn9G,CAAAA,GACTpf;AAAAA,EACR,GAGArY,EAAUg0I,qBAAqB,SAASv8G,GAAOlzB,GAC9C;AAAA,QAAI8T,IAAS,CAAA,GACTu8H,IAAkB,SAASn9G,GAAAA;AAC9B,eAAQv0B,IAAE,GAAGA,IAAEu0B,EAAMt0B,QAAQD;AACzBlD,UAAUuG,OAAOhC,GAAMi7H,0BACzBnnH,EAAO1V,KAAK80B,EAAMv0B,CAAAA,CAAAA,IAGdu0B,EAAMv0B,CAAG67C,EAAAA,YACZ1mC,EAAO1V,KAAK80B,EAAMv0B,CAAAA,CAAAA,GAGjBu0B,EAAMv0B,CAAG67C,EAAAA,YACX61F,EAAgBn9G,EAAMv0B,CAAAA,EAAG67C;IAE7B;AAEC,WADA61F,EAAgBn9G,CAAAA,GACTpf;AAAAA,EACR,GAQArY,EAAU+0I,uBAAuB,SAAS1hI,GAAK0F,GAAQi8H,GAAAA;AACtD,QACIC,IAAgB,SAAS5hI,GAAKokB,GAAO1e,GAAQi8H,GAAAA;AAChD,eAAS9xI,IAAE,GAAGA,IAAEu0B,EAAMt0B,WACjBs0B,EAAMv0B,CAAAA,EAAGmQ,OAAOA,KAAAA,CAAO2hI,KAAiBv9G,CAAAA,EAAMv0B,GAAG67C,aACpDtnB,EAAMv0B,GAAGqzD,OAAex9C,MAAU,SAAeA,IAAU0e,CAAAA,EAAMv0B,CAAGqzD,EAAAA,MAEhEy+E,KAJwB9xI;AAO1Bu0B,QAAAA,EAAMv0B,CAAG67C,EAAAA,YACXk2F,EAAc5hI,GAAIokB,EAAMv0B,GAAG67C,UAAUhmC,GAAQi8H,CAGjD;AAAA,IAAA,GACKhwI,IAAUhF,EAAU20I,WAAWthI,CAEd;AAAA,IAAV0F,MAAU,UAAiBi8H,MAErCj8H,IAAAA,CAAU/T,EAAQuxD,OAEfv2D,EAAUmJ,UAAU,wBAAwB,CAACnE,GAAS+T,GAAQi8H,CACjEC,CAAAA,MAAAA,EAAc5hI,GAAIrT,EAAUuG,OAAOvG,EAAU0K,KAAOmzH,EAAAA,iBAAiB9kH,GAAQi8H,CAC7Eh1I,GAAAA,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAO2tF,SAASr4F,EAAU+zI,mBAAmB/zI,EAAUuG,OAAOvG,EAAU0K,KAAOmzH,EAAAA,eAAAA,GAC1G79H,EAAUmJ,UAAU,iBAAgB,CACpCnJ,CAAAA,GAAAA,EAAUmJ,UAAU,uBAAuB,CAACnE,GAAS+T,GAAQi8H,CAAAA,CAAAA;AAAAA,EAE/D,GAEAh1I,EAAUsE,YAAY,eAAe,SAAUgnB,GAAGD,GAAGlJ,GAAGC,GAAGhiB,GAAAA;AACvDJ,MAAUmsG,UAAU,MAAA,MAClBnsG,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAO80H,2BAC3Bx/H,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAO2tF,OAAOhtE,CAChDrrB,gBAAAA,EAAUuG,OAAOvG,EAAU0K,KAAO2tF,EAAAA,OAAOhtE,GAAG0zB,YAC9C/+C,EAAU+0I,qBAAqB/0I,EAAUuG,OAAOvG,EAAU0K,KAAO2tF,EAAAA,OAAOhtE,CAAGhY,EAAAA,GAAAA;AAAAA,EAI/E,CAEArT,GAAAA,EAAUsE,YAAY,iBAAiB,SAAU1C,GAAO4W,GAAOpY,GAAAA;AAC3DJ,MAAUmsG,UAAU,MAAA,KACjB3zF,EAAMumC,YACV/+C,EAAU+0I,qBAAqBv8H,EAAMnF,GAGxC;AAAA,EAAA,CAAA,GAEArT,EAAU20I,aAAa,SAAS1xI;AAC/B,QAAGjD,EAAUmsG,UAAU,MAAA,GAAS;AAC/B,UAAIzpG,GACAwyI,IAAc,SAAS7hI,GAAKokB,GAC/B;AAAA,iBAASv0B,IAAE,GAAGA,IAAEu0B,EAAMt0B,QAAQD;AAC1Bu0B,UAAAA,EAAMv0B,CAAGmQ,EAAAA,OAAOA,MAClB3Q,IAAM+0B,EAAMv0B,KACVu0B,EAAMv0B,CAAAA,EAAG67C,YACXm2F,EAAY7hI,GAAIokB,EAAMv0B,GAAG67C,QAE9B;AAAA,MAAA;AAEE,aADAm2F,EAAYjyI,GAAIjD,EAAUuG,OAAOvG,EAAU0K,KAAOmzH,EAAAA,eAAAA,GAC3Cn7H,KAAK;AAAA,IACZ;AAAA,EACF,GAEA1C,EAAUm1I,gBAAgB,SAASlyI,GAAAA;AAClC,QAAGjD,EAAUmsG,UAAU,MAAS,GAAA;AAC/B,UAAI9zF,IAAAA,IACA+8H,IAAgB,SAAS/hI,GAAKokB,GACjC;AAAA,iBAASv0B,IAAE,GAAGA,IAAEu0B,EAAMt0B,WAClBs0B,EAAMv0B,GAAGmQ,OAAOA,MAClBokB,EAAMjmB,OAAOtO,GAAE,IACfmV,IAAS,KAAA,CAEPA,IAL0BnV;AAO1Bu0B,UAAAA,EAAMv0B,CAAAA,EAAG67C,YACXq2F,EAAc/hI,GAAIokB,EAAMv0B,CAAG67C,EAAAA,QAAAA;AAAAA,MAEhC;AAIE,aAHAq2F,EAAcnyI,GAAIjD,EAAUuG,OAAOvG,EAAU0K,OAAOmzH,eACpD79H,GAAAA,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAO2tF,SAASr4F,EAAU+zI,mBAAmB/zI,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOmzH,kBAC1G79H,EAAUmJ,UAAU,iBAAgB,CAC7BkP,CAAAA,GAAAA;AAAAA,IACP;AAAA,EACF,GAEArY,EAAUq1I,oBAAoB,WACvBr1I;AAAAA,MAAUmsG,UAAU,MACnBnsG,MAAAA,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOmzH,kBAAkB,CACpD79H,GAAAA,EAAUuG,OAAOvG,EAAU0K,KAAO2tF,EAAAA,SAASr4F,EAAU+zI,mBAAmB/zI,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOmzH,kBAC1G79H,EAAUmJ,UAAU,iBAAgB,CAAA,CAAA;AAAA,EAE5C,GAEAnJ,EAAUs1I,aAAa,SAAS5yI,GAAK6yI;AACpC,QAAGv1I,EAAUmsG,UAAU,MAAS,GAAA;AAC/B,UAAI9zF,IAAAA,IACAm9H,IAAa,SAAS9yI,GAAK+yI,GAAYh+G;AAC1C,YAAI89G;AAKH,mBAASryI,IAAE,GAAGA,IAAEu0B,EAAMt0B,WAClBs0B,EAAMv0B,CAAGmQ,EAAAA,OAAOoiI,KAAgBh+G,EAAMv0B,CAAAA,EAAG67C,aAC3CtnB,EAAMv0B,CAAAA,EAAG67C,SAASp8C,KAAKD,CACvB2V,GAAAA,IAAAA,MAEEA,IAL0BnV;AAO1Bu0B,YAAAA,EAAMv0B,CAAG67C,EAAAA,YACXy2F,EAAW9yI,GAAI+yI,GAAWh+G,EAAMv0B,CAAAA,EAAG67C,QAZrCtnB;AAAAA;AAAAA,UAAAA,EAAM90B,KAAKD,CACX2V,GAAAA,IAAAA;AAAAA,MAcJ;AAIE,aAHAm9H,EAAW9yI,GAAK6yI,GAAWv1I,EAAUuG,OAAOvG,EAAU0K,KAAAA,EAAOmzH,kBAC7D79H,EAAUuG,OAAOvG,EAAU0K,KAAO2tF,EAAAA,SAASr4F,EAAU+zI,mBAAmB/zI,EAAUuG,OAAOvG,EAAU0K,KAAOmzH,EAAAA,eAAAA,GAC1G79H,EAAUmJ,UAAU,iBAAgB,KAC7BkP;AAAAA,IACP;AAAA,EACF,GAGArY,EAAU01I,kBAAkB,WACxB11I;AAAAA,MAAUmsG,UAAU,MAAA,KACtBnsG,EAAU+0I,qBAAqB,GAAA,MACjC;AAAA,EAAA,GACA/0I,EAAU21I,mBAAmB,WAAA;AACzB31I,MAAUmsG,UAAU,MACtBnsG,KAAAA,EAAU+0I,qBAAqB,GAAG,IAAA;EACpC,GACA/0I,EAAU41I,cAAc,SAASj8C,GAAAA;AAC7B35F,MAAUmsG,UAAU,MACtBnsG,KAAAA,EAAU+0I,qBAAqBp7C,GAAY,EAAA;AAAA,EAC7C,GACA35F,EAAU61I,eAAe,SAASl8C,GAC9B35F;AAAAA,MAAUmsG,UAAU,MAAA,KACtBnsG,EAAU+0I,qBAAqBp7C,KACjC;AAAA,EAAA;AAEA,GlDlRC7mF,OmD7Ec,SAAS9S;AAExBA,IAAUsG,SAAS,CAAA,GACnBtG,EAAUkhD,kBAAgB,SAAS3oC,GAAK9R,GAASqe,GAAKha,GAAKk7B,GAAK8vG,GAAgBpwI,GA6B/E;AAAA,aAASqwI,EAAa/zI,GAAAA;AACrB,aAAOoN,KAAKM,OAAO1P,EAAUomD,eAAAA,CAAgBpkD,GAAM,CAAMhC,IAAAA,CAAAA,EAAUkK,aAAS,KAC5E;AAAA,IAAA;AA9BkB,IAARqO,OAAAA,KAAQ,aAClBuM,IAAOvM,EAAKuM,MACZre,IAAW8R,EAAK9R,UAChBqE,IAAOyN,EAAKzN,QAAM,GAClBk7B,IAAOztB,EAAKytB,QAAM,GAClB8vG,IAAiBv9H,EAAKu9H,gBACtBpwI,IAAO6S,EAAK7S,QAAQ,GACpB6S,IAAOA,EAAKA,OAGbvY,EAAUsG,OAAOiS,CAAAA,IAAM,EAAC/U,QAAOiD,GAAUb,SAAQkf,GAAMkhB,MAAKA,GAAMj7B,UAAS,GAAGrF,MAAMA,GAAM7E,QAAO,QAAA,GAC3FiK,IAAK9K,EAAUsG,OAAOiS,GAAM3S,QAAQzC,WACnCnD,EAAUsG,OAAOiS,CAAAA,EAAMy9H,iBAAiBlrI,GACxCA,IAAO,IAEX9K,EAAUsG,OAAOiS,CAAAA,EAAMzN,OAAOA,GACjC9K,EAAUsG,OAAOiS,CAAMu9H,EAAAA,iBAAiBA,KAAgB,IAExD91I,EAAUgC,KAAKuW,IAAK,QAAWvY,IAAAA,EAAUgC,KAAKitB,WAC9CjvB,EAAUya,UAAUlC,IAAK,OAAA,IAAW,SAASvW,GAAMR,GAElD;AAAA,aADSxB,EAAUsG,OAAOiS,CAAAA,EAClB7S,OAAO,IAGP1F,EAAUya,UAAUo8C,UAAU70D,GAAMR,CAFpCxB,IAAAA,EAAUya,UAAU+rB,SAASxkC;IAIvC,GAMChC,EAAUgT,kBAAkB,SAASijI,GAAWj0I;AAC/C,UAAIk0I,IAAoBD,EAAUlrI,YAAY,GAC1CorI,IAAgBJ,EAAa/zI,CAE7B42E,GAAAA,IAAIq9D,EAAUnrI,QAAQmrI,EAAUrwI,QAAQzC;AAK5C,aAJGgzI,KAAiBv9D,MACnBu9D,KAAgCv9D,IAG1Bs9D,IAAoBC;AAAAA,IAC7B,GACCn2I,EAAUya,UAAUlC,IAAO,aAAiB,IAAA,SAAStV,GAAI+wB,GAAOY,GAC/D;AAAA,aAAIA,EAAOnzB,MACH,kBAAkBmzB,EAAOnzB,MAAM,OAAOuyB,IAAQ,YAE9CA;AAAAA,IAEV,GACCh0B,EAAUya,UAAUlC,IAAK,iBAAiB,SAASvW,GAAAA;AAClD,UAAIi0I,IAAYj2I,EAAUsG,OAAOiS,CAC7BuM,GAAAA,IAAOmxH,EAAUrwI;AACrB,UAAKkf,CAAAA,EAAK3hB;AAAQ,eAAO;AACzB,UACIyxB,IAAS9P,EADD9kB,EAAUgT,gBAAgBijI,GAAWj0I,CAG7Co0I,CAAAA,GAAAA,IAAYL,EAAa/zI,CAAAA,GACzBmB,IAAS8yI,EAAUnrI,QAAQmrI,EAAUrwI,QAAQzC,QAC7CkzI,IAAWr2I,EAAUgC,KAAKC,IAAIjC,EAAU4E,SAAWuJ,EAAAA,UAAUiB,KAAK+D,MAAMijI,IAAYjzI,IAAS,KAEjG;AAAA,aAAOnD,EAAUya,UAAUlC,IAAO,aAAeqc,EAAAA,EAAOvhB,KAAKuhB,EAAOZ,OAAOY,GAAQyhH,CAAAA;AAAAA,IACrF,GACCr2I,EAAUya,UAAUlC,IAAK,oBAAwB,IAAA,SAASvW,GACzD;AAAA,aAAOhC,EAAUya,UAAU49C,gBAAgBr2D,CAC7C;AAAA,IAAA,GAEChC,EAAUgC,KAAK,SAAOuW,KAAM,SAASvW,GAAKmtB;AACzC,aAAOnvB,EAAUgC,KAAKC,IAAID,GAAKmtB,IAAMnvB,EAAUsG,OAAOiS,GAAM7S,MAAK,KAAA;AAAA,IACnE,GACC1F,EAAUgC,KAAK,SAAOuW,IAAK,MAAQ,IAAA,SAASvW;AAC3C,YAAMi0I,IAAYj2I,EAAUsG,OAAOiS,CAAAA,GAC7B+9H,IAAYL,EAAUnrI,QAAQmrI,EAAUrwI,QAAQzC,QAChDA,IAASiM,KAAKE,IAAIgnI,GAAWL,EAAUrwI,QAAQzC,MAAAA;AACrD,aAAOnD,EAAUgC,KAAKC,IAAID,GAAMmB,IAASnD,EAAUsG,OAAOiS,CAAM7S,EAAAA,MAAM;IACxE,GAEC1F,EAAUsE,YAAY,iBAAgB,WAIrC;AAAA,eAHU0gH,IAAKhlH,EAAUsG,OAAOiS,CAC5BtJ,GAAAA,IAAQ+1G,EAAG/1G,QAAQ,IACnB6V,IAAOkgG,EAAGp/G,SACN1C,IAAE,GAAGA,IAAE4hB,EAAK3hB,QAAOD;AAC1B+L,QAAAA,EAAM6V,EAAK5hB,CAAAA,EAAGmQ,GAAKnQ,IAAAA;AACX8hH,MAAAA,EAAGgxB,kBAAkBhxB,EAAGl6G,SAAO,MAC9Bk6G,EAAGl6G,OAAOk6G,EAAGgxB,uBACNhxB,EAAGgxB,iBAEjBhxB,EAAGl6G,OAAOga,EAAK3hB,UACR6hH,EAAGgxB,iBAAiBhxB,EAAGl6G,MACvBk6G,EAAGj6G,WAAW,GACdi6G,EAAGl6G,OAAO,KAGVk6G,EAAGl6G,OAAOk6G,EAAGgxB,kBAAgBhxB,EAAGl6G,MACtC9K,EAAUoT,SAASpT,EAAU0K,SAAS6N,KACzCvY,EAAU6V,eAAe7V,EAAUoT,OAAOpT,EAAU0K;IACvD,CAEC1K,GAAAA,EAAU,WAAUuY,CAAQ,IAAA,SAAS4sC;AACpC,UAAI6/D,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAAAA;AAE/B,UAAIs6G,GAAG;AASN,YARA7/D,IAAM77C,KAAK47C,uBAAuBC,CAC9B77C,GAAAA,KAAKs7C,gBAAat7C,KAAKs7C,cAAc,CAAA,IAErCt7C,KAAKR,YAAYQ,KAAKP,eACzBO,KAAKs7C,YAAY2E,eAAe,KAI9BjgD,KAAKP,cAAcO,KAAKP,cAAc,YAAW;AACnD,cAAI2F,IAAO1O,EAAUyoD,gBAAgBzoD,EAAU0W,QAAQ1W,EAAU8I,QAC9DsG,CAAAA;AAAAA,eAAK+D,MAAMgyC,EAAI75B,IAAI05F,EAAGp/G,QAAQzC,WAAWiM,KAAK+D,MAAMzE,IAAOs2G,EAAGp/G,QAAQzC,MACxEgiD,MAAAA,EAAI75B,IAAI5c;AAAAA,QACT;AAED,YAAI5D,IAAQk6G,EAAGl6G,QAAQk6G,EAAGp/G,QAAQzC,QAC9BozI,IAAcpxF,EAAI75B,IAAIxgB,GACtB0rI,IAAWpnI,KAAKE,IAAIinI,IAAYvxB,EAAGj6G,UAASi6G,EAAGp/G,QAAQzC,SAAO,CAAA;AAElEgiD,QAAAA,EAAIngD,WAAWggH,EAAGp/G,QAAQ4wI,CAAW,KAAA,CAAE,GAAEnjI,KACzC8xC,EAAI75B,IAAIlc,KAAK+D,MAAMgyC,EAAI75B,IAAIxgB,CAE3B;AAAA,YAAI/E,IAAKuD,KAAK7E,SAAS6E,KAAKR,QAC5BQ;AAAAA,aAAKo7G,qBAAqB,EAACh+G,MAAKs+G,GAAI5kH,OAAM2F,GAAIo/C,KAAIA;MAClD;AAGD,aAFAA,EAAIy8E,eAAe,IAEZz8E;AAAAA,IACT;AAEC,QAAIsxF,IAAgB;AAQpB,aAASC,IAAAA;AACLD,MAAAA,MACFz2I,EAAU+gB,GAAGqhC,gBAAgB,GAC7Bq0F,IAAAA;AAAAA,IAED;AAEDz2I,MAAUuY,IAAO,OAAA,IAAW,SAASs0D,GAAAA;AACpC,UAAIm4C,IAAKhlH,EAAUsG,OAAOtG,EAAU0K,KAAAA;AACjCmiE,MAAAA,KACEm4C,KAAMA,EAAGt/G,OAAO,IAfjB+wI,MACHA,IAAgBz2I,EAAU+gB,GAAGqhC,cAC7BpiD,EAAU+gB,GAAGqhC,eAA2C,IAA5BpiD,EAAU+gB,GAAGqhC,gBAgBxCs0F,EAAAA,GAED12I,EAAU6pD,aAAAA,KAEV6sF;IAEH,GAEC12I,EAAUmJ,UAAU,iBAAgB,CAAA,CAAA;AAAA,EACrC,GAEAnJ,EAAU0kH,uBAAuB,SAAStsG,GAAAA;AACzC,QAAI1R,IAAO0R,EAAO1R,MACjBtG,IAAQgY,EAAOhY,OACf+kD,IAAM/sC,EAAO+sC;AACX/kD,UACFA,EAAMsG,EAAKlD,MAAU2hD,IAAAA,EAAIngD;AAAAA,EAE3B,GAEAhF,EAAU22I,aAAW,SAAS3wG,GAAAA;AAC7B,QAAIg/E,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAC3Bs6G;AAAAA,IAAAA,MACHA,EAAGj6G,WAASqE,KAAKE,IAAIF,KAAKC,IAAI,GAAE21G,EAAGj6G,WAASi7B,CAAMg/E,GAAAA,EAAGp/G,QAAQzC,SAAO6hH,EAAGl6G,IACvExB,GAAAA,KAAKuM;EAEP,GACA,WAAA;AACC,QAAI+gI,IAAyB,SAASzuI,GACrC;AAAA,UAAI68G,IAAKhlH,EAAUsG,OAAOtG,EAAU0K,KAAAA;AACpC,UAAGs6G,KAAMA,EAAG/1G,SAAS+1G,EAAG8wB,gBAAgB;AAEvC,iBADae,IAAiB,IACtB3zI,IAAE,GAAGA,IAAEiF,EAAIhF,QAAQD;UAChB8hH,EAAG/1G,MAAM9G,EAAIjF,CAAG8hH,EAAAA,EAAGxhH,uBACbqzI,EAAel0I,KAAKwF,EAAIjF,CAGhCiF,CAAAA;AAAAA,QAAAA,EAAIqJ,OAAO,GAAErJ,EAAIhF,MAC1BgF,GAAAA,EAAIxF,KAAKuJ,MAAM/D,GAAI0uI,CACnB;AAAA,MAAA;AACD,aAAO1uI;AAAAA,IACT,GACK2uI,IAA8B92I,EAAU67D;AAC5C77D,MAAU67D,2BAAyB,SAAS1zD,GAAI+xD;AAE/C,aADA/xD,IAAMyuI,EAAuBzuI,CACtB2uI,GAAAA,EAA4B5qI,MAAM5C,MAAM,CAACnB,GAAK+xD,CACvD,CAAA;AAAA,IAAA;AACC,QAAI68E,IAA6B/2I,EAAU87D;AAC3C97D,MAAU87D,0BAA0B,SAAS3zD,GAAI+xD,GAAAA;AAEhD,aADA/xD,IAAMyuI,EAAuBzuI,CAAAA,GACtB4uI,EAA2B7qI,MAAM5C,MAAM,CAACnB,GAAK+xD,CAAAA,CAAAA;AAAAA,IACtD;AACC,QAAI88E,IAAQ,SAAShyB,GAAGj/G,GACvB;AAAA,UAAIi/G,KAAaA,EAAG/1G,MAAMlJ,EAAGi/G,EAAGxhH;AAG/B,eAFGwhH,EAAGp/G,QAAQzC,WACb4C,EAAGi/G,EAAGxhH,UAAUwhH,EAAGp/G,QAAQ,GAAGyN,MACxB;AAAA,IAEV,GAGK4jI,IAASj3I,EAAUw5D;AACvBx5D,MAAUw5D,oBAAoB,SAASh1D;AACtC,UAAI4C,IAAM6vI,EAAO/qI,MAAM5C,MAAK+I;AAC5B,UAAIjL,GAAI;AACP,YAAI49G,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAAAA;AAC/B,YAAIs6G,KAAMA,EAAGl6G,MAAK;AACjB,cAAIwkC,IAAM01E,EAAG/1G,MAAMzK,EAAEwgH,EAAGxhH,MACxB,CAAA;AAAA,cAAI8rC,IAAM01E,EAAGj6G,YAAYukC,KAAO01E,EAAGl6G,OAAKk6G,EAAGj6G;AAC1C,mBAAO;AAAA,QACR;AAAA,MACD;AACD,aAAO3D;AAAAA,IACT;AAEC,QAAI8vI,IAAsBl3I,EAAUyrD;AAEpCzrD,MAAUyrD,mBAAmB,SAASK,GAAI7mD,GAAGV,GAAMyhC,GAAM4nB;AACxD,UAAI5tD,EAAUsG,OAAOgD,KAAKoB,KAAAA,GAA1B;AAIApB,aAAKsF,WAAS,IACdtF,KAAKo8C,oBAAoB;AACzB,YAAI9qC,IAAS5a,EAAU,YAAUsJ,KAAKoB,KAEtC;AAAA,YAAIkQ,GAAO;AACV,cAAIu8H,IAAiBn3I,EAAUsG,UAAUtG,EAAUsG,OAAOgD,KAAKoB,KAC7D1K,IAAAA,EAAUsG,OAAOgD,KAAKoB,KAAOI,EAAAA,QAAM9K,EAAUsG,OAAOgD,KAAKoB,OAAO9E,QAAQzC,SAAU;AACpF8B,UAAAA,KAAKkyI;AAGL,mBADItpF,IAAW,IAAIrrD,KAAKspD,CACf5oD,GAAAA,IAAE,GAAGA,IAAE+B,GAAG/B,KAAI;AACtB,gBAAI0X,EAAOizC,CAAAA;AAIV,uBAFCupF,KAAcl0I,IAAI,KAAKi0I,GAEhBtjH,IAHW3wB,IAAIi0I,GAGGtjH,IAAIujH,GAAYvjH;AACzCvqB,qBAAKo8C,qBAAqB,GAC1Bp8C,KAAKsF,SAASilB,CAAAA,IAAAA,IACV+5B,KACH3oD;AAGH4oD,YAAAA,IAAW7tD,EAAUgC,KAAKC,IAAI4rD,GAAU7nB,GAAMzhC,CAAAA,GAC3CvE,EAAUgC,KAAKuC,IAAO,cACxBspD,IAAW7tD,EAAUgC,KAAKuC,IAAO,QAAA,EAAUspD;UAC5C;AAAA,QACD;AAAA,MA3BA;AAFAqpF,QAAAA,EAAoB3iI,KAAKjL,MAAMwiD,GAAI7mD,GAAGV,GAAMyhC,GAAM4nB,CAAAA;AAAAA,IA8BrD;AAGC,QAAIr7C,IAAIvS,EAAU6pD;AAClB7pD,MAAU6pD,eAAe;AACxB,UAAIm7D,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAE5Bs6G;AAAAA,MAAAA,MAECA,EAAGl6G,QAAQk6G,EAAGj6G,YAAYi6G,EAAGl6G,OAAOk6G,EAAGj6G,WAAWi6G,EAAGp/G,QAAQzC,SAC/D6hH,EAAGj6G,WAAWqE,KAAKC,IAAI,GAAG21G,EAAGp/G,QAAQzC,SAAS6hH,EAAGl6G,IAAAA,IACxCk6G,EAAGl6G,SACZk6G,EAAGj6G,WAAW,IAGZi6G,EAAGl6G,QAAQk6G,EAAGl6G,OAAOk6G,EAAGp/G,QAAQzC,WAClC6hH,EAAGl6G,OAAOk6G,EAAGp/G,QAAQzC;AAIvB,UAAIi9G,IAAM7tG,EAAErG,MAAM5C,MAAK+I,SAAAA;AACvB,UAAI2yG,GAAG;AAEN17G,aAAKW,YAAYX,KAAKtH,KAAKC,IAAIqH,KAAKY,WAAU86G,EAAGt/G,MAAK,KAAA;AAGtD,iBADIiM,IAAIrI,KAAKO,KAAmB,aAAE,CAAGmG,EAAAA,YAC5B9M,IAAE,GAAGA,IAAIyO,EAAExO,QAAQD;AAC3ByO,UAAAA,EAAEzO,CAAAA,EAAG2b,UAAUwL,OAAO,sBAAA;AAGvB,YAAI0hC,IAAQziD,KAAKS;AACjB,YAAGgiD,EAAMtpD,aAAa6G,KAAKY,aAAa6hD,EAAMtpD,QAAY6G,IAAAA,KAAKW,WAAW;AACzE,cACI4c,IAAMzX,KAAK+D,OAAO44C,IAAQ/rD,EAAUkK,aAD/B,KAAA,GAELW,IAAUm6G,EAAGl6G,QAAQk6G,EAAGp/G,QAAQzC,QAChCk0I,IAAcxwH,IAAIhc,GAClBysI,IAAYD,IAAcxsI;AAC9B,eAAK3H,IAAEm0I,GAAan0I,IAAEo0I,GAAWp0I;AAC7ByO,YAAAA,EAAEzO,CAAAA,KACJyO,EAAEzO,CAAG2b,EAAAA,UAAU5c,IAAI,sBAErB;AAAA,QAAA;AAED,YAAI+iH,EAAGl6G,QAAQk6G,EAAGl6G,OAAOk6G,EAAGp/G,QAAQzC,QAAO;AAE1C,cAAIye,IAAItY,KAAKO,KAAqB,eAAE,CAChC05G,GAAAA,IAAQ31G,SAASC,cAAc,KAC/Bm3G;AAAAA,UAAAA,EAAGj6G,aAENzB,KAAKuxB,SAASqvB,wBAAwBq5D,GAAO,EAAA,GAEzCvjH,EAAUM,OAAOsgC,OACpB2iF,EAAMz0G,YAAY,uBAClBy0G,EAAMtiH,MAAMgzC,UAAU,6DAEtBsvE,EAAMz0G,YAAY,uBAClBy0G,EAAMtiH,MAAMgzC,UAAU,gDAGvBryB,EAAE3R,WAAWlC,YAAYw1G,IACzBA,EAAMp+F,iBAAiB,SAAS,SAAS3gB,GAAAA;AACxCxE,cAAU22I,WAAoB,KAAT3xB,EAAGh/E,IACxBxhC,GAAAA,EAAE28B;UACR,CAEQ6jF,IAAAA,EAAGj6G,WAASi6G,EAAGl6G,OAAKk6G,EAAGp/G,QAAQzC,WAClCmG,KAAKuxB,SAASqvB,wBAAwBq5D,GAAO,KAE7CA,IAAQ31G,SAASC,cAAc,KAC3B7N,GAAAA,EAAUM,OAAOsgC,OACpB2iF,EAAMz0G,YAAY,uBAClBy0G,EAAMtiH,MAAMgzC,UAAU,kDAEtBsvE,EAAMz0G,YAAY,uBAClBy0G,EAAMtiH,MAAMgzC,UAAU,2DAGvBryB,EAAEohD,UAAUj1D,YAAYw1G,CAAAA,GACxBA,EAAMp+F,iBAAiB,SAAS;AAC/BnlB,cAAU22I,WAAW3xB,EAAGh/E,IAC9B;AAAA,UAAA,CAAA;AAAA,QAEI;AAAA,MACD;AACD,aAAOo6E;AAAAA,IAET;AAEC,QAAI/0D,IAAgBrrD,EAAUqrD;AAC9BrrD,MAAUqrD,gBAAgB,WACzB;AAAA,UAAI25D,IAAKhlH,EAAUsG,OAAOgD,KAAKoB;AAC/B,UAAGs6G,KAAMA,EAAGt/G,OAAO,GAAG;AACrB,YAAIswB,IAAK1sB,KAAK8hD,oBAAAA;AACd,eAAOprD,EAAUgC,KAAKC,IAAI+zB,GAAIgvF,EAAGt/G,MAAM,KAAA;AAAA,MAC1C;AACG,aAAO2lD,EAAcn/C,MAAM5C,MAAM+I,SAEpC;AAAA,IAAA;AAEC,QAAIs3G,IAAK3pH,EAAU4qD;AACnB5qD,MAAU4qD,mBAAmB,SAAS1nD,GAAG/B,GAAMwQ,GAAGiQ,GAAAA;AAEjD,UAAIojG,IAAKhlH,EAAUsG,OAAOgD,KAAKoB;AAC/B,UAAIs6G,CAAAA,KAAMA,EAAGt/G,QAAQ;AACpB,eAAOikH,EAAGz9G,MAAM5C,MAAM+I;AACjB,UAAG2yG,EAAGt/G,OAAO,GAAE;AAEpB,YAAI6xI,IAAgB31H,EAAElB,cAAc,wBAAA;AAChC62H,QAAAA,OACHA,IAAgB3pI,SAASC,cAAc,KAAA,GACzBiB,YAAY,yBAC1B8S,EAAE7T,YAAYwpI,CAGf;AAAA,YAAIn1F,IAAepiD,EAAU+gB,GAAGqhC;AAChCpiD,UAAU+gB,GAAGqhC,eAAehzC,KAAKg2C,KAAKhD,IAAe,IACrDunE,EAAGp1G,KAAKjL,MAAMpG,GAAG/B,GAAMwQ,GAAG4lI,GAAenoI,KAAKg2C,KAAKplD,EAAU+gB,GAAGqhC,YAAAA,CAAAA;AAEhE,YAAIv3C,IAAUm6G,EAAGl6G,QAAQk6G,EAAGp/G,QAAQzC;AAEpC,aAAKD,IAAE,KAAG2H,KAAY,GAAI;AACzB,cAAImd,IAAOpa,SAASC,cAAc,KAAA;AAClCma,UAAAA,EAAKlZ,YAAY;AACjB,cAAI9M,IAAOsH,KAAKtH,KAAKC,IAAIqH,KAAKY,WAAWkF,KAAK+D,MAAMjQ,IAAE2H,CAAU,GAAA,KAAA;AAC5DvB,eAAKmR,UAAUnR,KAAKoB,QAAQ,sBAC/Bsd,MAAAA,EAAKlZ,aAAa,MAAMxF,KAAKmR,UAAUnR,KAAKoB,QAAQ,wBAAwB,IAAIlI,KAAKR;AAEtF,cAAIw1I,GACHC,IAAUnuI,KAAKqF,MAAMzL,CAAG2H,IAAAA;AAExB2sI,UAAAA,IADE3sI,IAAU,KAAKvB,KAAKhJ,OAAOsgC,MACpBt3B,KAAKi8C,OAAOriD,KAAG2H,IAAQ,EAAA,IAAMvB,KAAKyX,GAAGshB,eACpCx3B,IAAU,IACXvB,KAAKi8C,OAAOriD,KAAG2H,IAAQ,EAAA,IAAMvB,KAAKyX,GAAGohC,cAErChhD,GAIVmI,KAAKy5C,OAAO/6B,GAAMyvH,GAASnuI,KAAKyX,GAAGqhC,cAAco1F,GAAQ,CAAA,GACzDxvH,EAAKla,YAAYxE,KAAKmR,UAAUnR,KAAKoB,QAAQ,oBAAA,EAAsB,IAAIlI,KAAKR,CAAAA,GAAOsH,KAAKoB,KACxF6sI,GAAAA,EAAcxpI,YAAYia,CAC1B;AAAA,QAAA;AACDhoB,UAAU+gB,GAAGqhC,eAAeA;AAAAA,MAC5B;AAAA,IACH;AAEC,QAAIrqC,IAAI/X,EAAUyoD;AAClBzoD,MAAUyoD,kBAAgB,SAAS1iD,GAClC;AAAA,UAAIi/G,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAAAA;AAC/B,aAAIs6G,IACAA,EAAGt/G,QAAQ,KACbsxI,EAAQhyB,GAAGj/G,IACJuD,KAAKouI,kBAAkB3xI,EAAGi/G,EAAGxhH,MAAAA,CAAAA,KAG1B4L,KAAK+D,OAAQpN,EAAGvE,SAASiB,QAAU,IAAA,IAAsC,KAAlCsD,EAAGvE,SAASktB,sBAA2B,OACtF1uB,EAAUkK,UAAUzH,QAAsD,IAAA,KAA1CzC,EAAUkK,UAAUwkB,kBAA2B,IAAA,QAFxE,UAIKs2F,EAAGl6G,QAAQk6G,EAAGp/G,QAAQzC,UAChB6hH,EAAG/1G,MAAMlJ,EAAGi/G,EAAGxhH,MAAAA,CAAAA,IACQwhH,EAAGj6G,WAIzCgN,EAAExD,KAAKjL,MAAKvD,CAAAA;AAAAA,IACrB,GACC/F,EAAU03I,oBAAoB,SAAS1yI,GAAAA;AACtC,UAAIggH,IAAKhlH,EAAUsG,OAAOgD,KAAKoB;AAC/B,aAAOs6G,EAAG/1G,MAAMjK,CAASggH,IAAAA,EAAGj6G;AAAAA,IAC9B;AAEC,QAAI6tE,IAAI54E,EAAUsK;AAClBtK,MAAUsK,oBAAkB,SAAS6X,GAAEC,GAAErc,GACxC;AAAA,UAIIf,GAJAggH,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAC/B;AAAA,aAAKs6G,KAIAj/G,IAQJixI,EAAQhyB,GAAIj/G,MAPZA,IAAK,EACJxE,YAAY4gB,GACZ3gB,UAAU2gB,KAEXnd,IAAU,IAKPggH,EAAGt/G,QAAQ,IACuD,KAA7DV,eAAwBggH,EAAG/1G,MAAMlJ,EAAGi/G,EAAGxhH,MAAWwB,CAAAA,IAAAA,MAAgBod,IAAI,IAAI,KAAK4iG,EAAGj6G,WAGhFqE,KAAK+D,OAAOpN,EAAGxE,WAAWkB,QAAYzC,IAAAA,EAAUkK,UAAUzH,QAAAA,KAD3D,KAEKuiH,KAAAA,EAAGl6G,QAAQk6G,EAAGp/G,QAAQzC,UAEI,KADpB6B,MAAYoiC,SAAY49E,EAAG/1G,MAAMlJ,EAAGi/G,EAAGxhH,MAAWwB,CAAAA,IAAAA,MACxBod,IAAI,IAAI,KAAK4iG,EAAGj6G,YApBvD6tE,EAAE1sE,MAAM5C,MAAM+I,SAAAA;AAAAA,IAsBxB;AAEC,QAAIyF,IAAI9X,EAAU69D;AAClB79D,MAAU69D,cAAc,SAAS11D;AAChC,UAAI68G,IAAKhlH,EAAUsG,OAAOgD,KAAKoB;AAC3Bs6G,MAAAA,IACH78G,EAAIyiB,KAAK,SAASzI,GAAEC,GAAAA;AACnB,eAAO4iG,EAAG/1G,MAAMkT,EAAE6iG,EAAGxhH,MAAAA,CAAAA,IAASwhH,EAAG/1G,MAAMmT,EAAE4iG,EAAGxhH,MAAAA,CAAAA,IAAS,IAAG;AAAA,MAC5D,KAEGsU,EAAE5L,MAAM5C,MAAK+I,SAChB;AAAA,IAAA;AAGC,QAAIslI,IAAY33I,EAAU67D;AAC1B77D,MAAU67D,2BAA2B,SAAS1zD,GAAK+xD,GAClD;AAAA,UAAI8qD,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAG/B;AAAA,UAAGs6G,KAAMA,EAAGt/G,OAAO,GAAE;AAEpB,iBA+BI+/C,GAhCA//C,IAAO,CAAA,GACHxC,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAI;AAClC,cAAI6C,IAAKoC,EAAIjF,CACb;AAAA,cAAIlD,EAAU4I,cAAcT,EAAIjF,CAmB3B,CAAA;AAEAwC,YAAAA,EADA1D,IAAAA,CAAQhC,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKuD,EAAGxE,kBAEhDmE,EAAK1D,CAAAA,IAAQ,CACd0D,IAAAA,EAAK1D,CAAMW,EAAAA,KAAKoD;eAvBmB;AAEnC,gBAAIgsB,IAAK,IAAIvvB,KAAK4M,KAAKE,IAAAA,CAAKvJ,EAAGvE,UAAAA,CAAW8H,KAAKW,SAAAA,CAAAA,GAC9C4nB,IAAO,IAAIrvB,KAAK4M,KAAKC,IAAKtJ,CAAAA,EAAGxE,aAAa+H,KAAKY,SAAAA,CAAAA;AAKhD,iBAJA2nB,IAAO7xB,EAAUgC,KAAKitB,UAAU4C,CAChC1pB,GAAAA,EAAIqJ,OAAOtO,GAAG,CAAA,GACdA,MAEO2uB,IAAQE,CAAAA,KAAG;AACjB,kBAKI/vB,GALAg6F,IAAQ1yF,KAAKs0D,YAAY73D,CAAAA;AAC7Bi2F,cAAAA,EAAMz6F,aAAaswB,GACnBmqE,EAAMx6F,WAAW6zF,EAAW2G,EAAMz6F,UAAAA,GAClCswB,IAAO7xB,EAAUgC,KAAKC,IAAI4vB,GAAM,GAAG,KAG/BnsB,GAAAA,EADA1D,KAAQhC,EAAUgC,KAAKwF,UAAU,IAAIhF,KAAKqvB,CAAAA,CAAAA,CAAAA,MAE7CnsB,EAAK1D,CAAQ,IAAA,CAAA,IACd0D,EAAK1D,CAAMW,EAAAA,KAAKq5F;YAChB;AAAA,UACN;AAAA,QAOI;AAIG7zF,QAAAA,IAAM,CAAA;AACV,iBAAQjF,KAAKwC,GAAK;AACjB,cAAI07H,IAAeuW,EAAUzrI,MAAM5C,MAAM,CAAC5D,EAAKxC,CAAAA,GAAIg3D,KAC/C09E,IAAiBtuI,KAAKi8C,OAAOE;AAI7BA,WAAAA,CAAAA,KAAWmyF,EAAe,CAAKnyF,IAAAA,EAAQ,CAC1CA,OAAAA,IAAUmyF,EAAe7rI,MAAAA,IAE1B5D,EAAIxF,KAAKuJ,MAAM/D,GAAKi5H,CACpB;AAAA,QAAA;AACD,YAAIyW,IAAmBvuI,KAAKi8C,OAAOE;AAKnC,aAJAoyF,EAAiBrmI,OAAO,GAAGqmI,EAAiB10I,MAAAA,GAC5C00I,EAAiBl1I,KAAKuJ,MAAM2rI,GAAkBpyF,CAG9C,GAASviD,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC/B,cAAIoG,KAAKsF,SAASzG,EAAIjF,GAAG23D,KACxB1yD;AAAAA,YAAAA,EAAIqJ,OAAOtO,GAAG,CACdA,GAAAA;AAAAA,eAEI;AACJ,gBAAIqtG,IAAUpoG,EAAIjF,CAClBqtG;AAAAA,YAAAA,EAAQ3xC,eAAe2xC,EAAQ1xC,cAAAA,IAEXv1D,KAAK7E,SAAS8rG,EAAQttG,IAC5BqhC,UAAUisE,EAAQjsE;AAAAA,UAEhC;AAEFn8B,QAAAA,EAAIyiB,KAAK,SAASzI,GAAGC,GACpB;AAAA,iBAAID,EAAE5gB,WAAWkB,aAAa2f,EAAE7gB,WAAWkB,YACnC0f,EAAElf,KAAKmf,EAAEnf,KAAK,IAAA,KACfkf,EAAE5gB,aAAa6gB,EAAE7gB,aAAa,IAAA;AAAA,QACzC,CAEA;AAAA,MAAA;AACG4G,QAAAA,IAAMwvI,EAAUzrI,MAAM5C,MAAM,CAACnB,GAAK+xD,CAAAA,CAAAA;AAGnC,eAASm7B,EAAWrzF,GAAAA;AACnB,YAAI0zF,IAAW11F,EAAUgC,KAAKC,IAAID,GAAM,GAAG,KAAA;AAE3C,eADA0zF,IAAW11F,EAAUgC,KAAKwF,UAAUkuF;MAEpC;AACD,aAAOvtF;AAAAA,IACT,GAECnI,EAAUsE,YAAY,gBAAe,SAASrB,GAAG8C;AAChD,UAAIuD,KAAKgtB;AAAU,eAAO;AAC1B,eAASnU,KAAKniB,EAAUsG,QAAO;AAC9B,YAAI0+G,IAAKhlH,EAAUsG,OAAO6b;QACfpc,EAAGi/G,EAAGxhH,MAA0BwhH,gBAAAA,EAAGp/G,QAAQ,CAAA,MACrDG,EAAGi/G,EAAGxhH,UAAUwhH,EAAGp/G,QAAQ,GAAGyN;AAAAA,MAE/B;AACD;IACF,CAAA,GACCrT,EAAUsE,YAAY,kBAAiB,SAASrB,GAAGisD,GAClD;AAAA,UAAI81D,IAAKhlH,EAAUsG,OAAOgD,KAAKoB,KAC/B;AAAA,UAAIs6G,KAAM91D,GAAK;AACd,YAAInpD,IAAKuD,KAAK7E,SAASxB;AACvB+zI,QAAAA,EAAQhyB,GAAGj/G;AACX,YAAIo/C,IAAM77C,KAAK+7C,cAAc6J,CAAAA;AAC7B5lD,aAAKo7G,qBAAqB,EAACh+G,MAAKs+G,GAAI5kH,OAAM2F,GAAIo/C,KAAIA,EAAAA,CAAAA,GAElD77C,KAAK4qC,cAAcnuC,CACnB;AAAA,MAAA;AACD;IACF,CAAA;AAAA,EACC,EAGD;AAAA,GnD/fCoQ,KoD9Ec,SAASnW,GAAAA;AAExBA,IAAUk5F,eAAe,WAGxB;AAAA,aAFIxwF,IAAI,CAAA,GACJkH,KAAQhC,SAAS8J,SAAS2hD,QAAQ,IAAIxhD,QAAQ,KAAK,EAAIlU,EAAAA,MAAM,MACxDT,IAAI,GAAGA,IAAI0M,EAAKzM,QAAQD,KAAK;AACrC,UAAIkD,IAAIwJ,EAAK1M,CAAGS,EAAAA,MAAM;AACN,MAAZyC,EAAEjD,UAAU,MACfuF,EAAEtC,EAAE,MAAMA,EAAE,CAAA;AAAA,IACb;AACD,WAAOsC;AAAAA,EACR,GAEA1I,EAAUsE,YAAY,oBAAoB;AACzC,QAAIy1B,IAAAA,IACA+9G,IAAM93I,EAAUgC,KAAKuuB,YAAY,UACjCwnH,GAAAA,IAAM/3I,EAAUgC,KAAK0tB,YAAY,aACjCsoH,IAAgBh4I,EAAUk5F,eAAe94F,SAAS;AAuDtD,aAASiiE,EAAU79D,GAClB;AAAA,UAAGxE,EAAUkiB;AACZ,eAAA;AAED81H,MAAAA,IAAexzI,GACZxE,EAAUyE,SAASD,CAAAA,KACrBxE,EAAUqiE,UAAU79D,CAErB;AAAA,IAAA;AA7DDxE,MAAUsE,YAAY,uBAAuB,SAASyB,GAErD;AAAA,aADAiyI,IAAe,MACR;AAAA,IACT,CAECh4I,GAAAA,EAAUsE,YAAY,sBAAsB,SAAU03G,GAAIC,GAAIn5C,GAAGnxD,GAChE;AAAA,UAAIooB,GAAO;AACVA,QAAAA,IAAAA;AACA,YAAIrxB,IAAI1I,EAAUk5F;AAElB,YAAIxwF,EAAEtI;AACL,cACC;AAAA,gBAAGJ,EAAUyE,SAASiE,EAAEtI,KAIvB;AAAA,qBAHA6X,WAAW,WAAA;AACVoqD,gBAAAA,EAAU35D,EAAEtI,KAAAA;AAAAA,cACnB;AAGM,gBAAIsZ,IAAU1Z,EAAUsE,YAAY,SAAS,WAAA;AAC5C2T,yBAAW,WAAA;AACVoqD,gBAAAA,EAAU35D,EAAEtI,KAAAA;AAAAA,cACpB,IACOJ,EAAU6kB,YAAYnL;YAC7B,CAEA;AAAA,UAAA,QAAalV;AAAAA,UAAI;AAGd,YAAIkE,EAAE1G,QAAQ0G,EAAEnE,MAAM;AACrB,cAAA;AACC+E,iBAAKuM,eAAgBnN,EAAE1G,OAAO81I,EAAIpvI,EAAE1G,IAAAA,IAAQ,MAAQ0G,EAAEnE,QAAQ;UAC9D;AAEA+E,iBAAKuM,eAAgBnN,EAAE1G,OAAO81I,EAAIpvI,EAAE1G,QAAQ,MAAO8gE,CAAAA;AAAAA,UACnD;AACD,iBAAO;AAAA,QACP;AAAA,MACD;AAED,UAAI95B,IAAS,CACZ,UAAU+uG,EAAIpmI,KAAKsqG,CAAAA,GACnB,WAAWn5C,KAAKk5C,EAAAA;AAGdg8B,MAAAA,KACFhvG,EAAOrmC,KAAK,WAAWq1I,CAAAA;AAGxB,UAAIx7H,IAAO,MAAMwsB,EAAOv7B,KAAK;AAE7B,aADAG,SAAS8J,SAAS2hD,OAAO78C,GAAAA;AAAAA,IAE3B,CAAA;AAAA,EAWA,CACA;AAAA,GpDHCkkC,aqD/Ec,SAAS1gD,GAAAA;AAqBxB,MACKi4I;AApBLj4I,IAAUk4I,MAAM,CAAA,GAChBl4I,EAAU+gB,GAAGm3E,2BAA2B,IACxCl4F,EAAUya,UAAU09H,yBAAyB,SAAS52I,GAAYC,GAAUpB,GAAO4B,GAClF;AAAA,WAAOhC,EAAUya,UAAU69C,WAAW/2D,CAAAA,IAAc,MAAMnB,EAAMoc;AAAAA,EACjE,GACAxc,EAAUgC,KAAKo2I,oBAAoBp4I,EAAUgC,KAAKY,YAClD5C,EAAUgC,KAAKq2I,kBAAkB,SAASr2I,GACzC;AAAA,WAAOhC,EAAUgC,KAAKC,IAAID,GAAM,GAAG,KAAA;AAAA,EACpC,GACAhC,EAAUgC,KAAKs2I,kBAAkB,SAASt2I,GAAMmtB,GAAAA;AAC/C,WAAOnvB,EAAUgC,KAAKC,IAAID,GAAY,IAANmtB,GAAS,KAAA;AAAA,EAC1C,GAEAnvB,EAAUsE,YAAY,oBAAoB,WAAA;AACzC,QAAIiO,IAAIvS,EAAUya;AACblI,MAAEgmI,qBACNhmI,EAAEgmI,mBAAmBhmI,EAAEskD;AAAAA,EACzB,IAGKohF,IAAoBj4I,EAAUgC,KAAK0tB,YAAY,WAAA,GACnD1vB,EAAUya,UAAU+9H,yBAAyB,SAASx2I,GAAAA;AACrD,WAAOi2I,EAAkBj2I;EAC3B,GAGAhC,EAAUsE,YAAY,oBAAoB,WAAA;AAEzC,QAAI8pB,IAAMpuB,EAAU+V;AAQpB,aAASs+E,EAAUzyF,GAAAA;AAClB,aAAO;AAAA;AAAA,0CAEiCA,CAAAA;AAAAA;AAAAA,IAExC;AAZD5B,MAAU+V,cAAc,SAAS5N,GAChC;AAAA,UAAImB,KAAKoB,SAAS;AAGjB,eAAO0jB,EAAIliB,MAAM5C,MAAM+I;AAFvBrS,QAAUy4I,iBAAAA;IAGb,GAwGCz4I,EAAUy4I,mBAAmB,SAASl0I,GACrCvE;AAAAA,QAAUkK,YAAYlK,EAAUgC,KAAKY,WAAW5C,EAAUoT,KAAAA,GAC1DpT,EAAUiK,YAAYjK,EAAUgC,KAAKC,IAAIjC,EAAUkK,WAAW,GAAG,MACjElK,GAAAA,EAAUiiD,aACN19C,KACHvE,EAAUyK,cAAczK,EAAU2oD,aAAAA,IAClC3oD,EAAU8C,WAAW4d,cAAc,mBAAmBzf,MAAMkgB,UAAU,QAGtEnhB,EAAU6J,KAAmB,aAAE,CAAGiE,EAAAA,YAAY,IAxGxB,WAAA;AAEvB9N,UAAU6J,KAAmB,aAAE,CAAGiE,EAAAA,YAAY,IAC9C9N,EAAU0lC,YAAY;AAEtB,YAAIhkC,IAAO;AAAA;AAAA,GAEV2yF,EAAU,CAAA,CAAA;AAAA,GACVA,EAAU,CACVA,CAAAA;AAAAA,GAAAA,EAAU;;;GAGVA,EAAU,CAAA,CAAA;AAAA,GACVA,EAAU,CACVA,CAAAA;AAAAA,GAAAA,EAAU,CACVA,CAAAA;AAAAA,GAAAA,EAAU,CAIPhB,CAAAA;AAAAA;AAAAA,SAAAA,IAAcrzF,EAAU0sD,mBACzB2mC;AAAAA,QAAAA,MACFA,EAAYvlF,YAAY9N,EAAUya,UAAUza,EAAU0K,QAAQ,OAAS1K,EAAAA,EAAUkK,WAAWlK,EAAUiK,WAAWjK,EAAU0K,KAAAA,IAG5H1K,EAAU6J,KAAmB,aAAE,GAAGiE,YAAYpM;AAE9C,cAAMg3I,IAAU14I,EAAU8C,WAAWC,iBAAiB,kBAEtD/C;AAAAA,UAAUk4I,IAAIn1C,iBAAiB,CAAA;AAI/B,iBAHIjnF,IAAS9b,EAAU85D,mBAAAA,GACnB6+E,IAAS34I,EAAUgC,KAAKY,WAAW5C,EAAUoT,QAC7CwlI,IAAO54I,EAAUgC,KAAKC,IAAI02I,GAAQ,GAAG,KAAA,GAChCz1I,IAAI,GAAGA,IAAI,GAAGA,KAAK;AAC3Bw1I,UAAAA,EAAQx1I,CAAAA,EAAGkQ,QAAQulI,GACnBD,EAAQx1I,CAAG6b,EAAAA,aAAa,aAAa/e,EAAUya,UAAU8c,YAAYohH,CAAAA,CAAAA,GAErE34I,EAAU66B,SAASg4B,kBAAkB6lF,EAAQx1I,CAAIy1I,GAAAA,CAAAA;AAEjD,cAAIE,IAAYH,EAAQx1I,CAAAA,EAAGwd,cAAc,mBACrCo4H,GAAAA,IAAaJ,EAAQx1I,CAAGwd,EAAAA,cAAc;AAC1Cm4H,UAAAA,EAAU/qI,YAAY9N,EAAUya,UAAU+9H,uBAAuBG,CAAAA;AAEjE,mBADIxwI,IAAM,IACD0rB,IAAI,GAAGA,IAAI/X,EAAO3Y,QAAQ0wB,KAAK;AACvC,gBAAIo8F,IAAMn0G,EAAO+X,CACbo8F;AAAAA,YAAAA,EAAI1uH,aAAaq3I,KAAQ3oB,EAAIzuH,WAAWm3I,KAC3CxwI,EAAIxF,KAAKstH,CAAAA;AAAAA,UACV;AACD9nH,UAAAA,EAAIyiB,KAAK,SAASzI,GAAGC;AACpB,mBAAID,EAAE5gB,WAAWkB,QAAa2f,KAAAA,EAAE7gB,WAAWkB,QAAAA,IACnC0f,EAAElf,KAAKmf,EAAEnf,KAAK,IAAA,KACfkf,EAAE5gB,aAAa6gB,EAAE7gB,aAAa,IAAA;AAAA,UACzC,CAAA;AACG,mBAASoL,IAAI,GAAGA,IAAIxE,EAAIhF,QAAQwJ,KAAK;AACpC,gBAAI5G,IAAKoC,EAAIwE,CAAAA,GACTosI,IAASnrI,SAASC,cAAc,KACpC7N;AAAAA,cAAU0lC,UAAU/iC,KAAKo2I,CAAAA;AACzB,gBAAIhmD,IAAW/yF,EAAUya,UAAU89C,YAAYxyD,EAAGxE,YAAYwE,EAAGvE,UAAUuE,CAAAA;AAC3EgzI,YAAAA,EAAOl6H,UAAU5c,IAAI,mBAClB8wF,KACFgmD,EAAOl6H,UAAU5c,IAAI8wF,CAGlB/yF,GAAAA,EAAUM,OAAOsgC,OACpBm4G,EAAOl6H,UAAU5c,IAAI,oBAAA,GAElB8D,EAAG85D,gBACNk5E,EAAO93I,MAAMgzC,UAAUluC,EAAG85D,cACvB95D,EAAGg6D,SACNg5E,EAAO93I,MAAM+9C,YAAY,oCAAoCj5C,EAAGg6D,KAAAA,GAC7Dh6D,EAAGu6D,aACNy4E,EAAO93I,MAAM+9C,YAAY,+BAA+Bj5C,EAAGu6D,YACxDtgE,EAAU2jD,cAAc59C,EAAG9C,MAAMjD,EAAU2jD,eAAiB3jD,EAAUM,OAAO04I,sBAAsBh5I,EAAUM,OAAO04I,uBAAvCA,YAChFD,EAAOl6H,UAAU5c,IAAI,wBACrBjC,GAAAA,EAAUk4I,IAAIn1C,eAAepgG,KAAKo2I,CAAAA;AAEnC,gBAAIhuI,IAAW;AACVhF,YAAAA,EAAG4C,WACPoC,IAAW,UACPhF,EAAGxE,WAAWkB,QAAak2I,KAAAA,EAAOl2I,QAAasD,KAAAA,EAAGxE,WAAWkB,QAAam2I,KAAAA,EAAKn2I,cAClFsI,IAAW,UACRhF,EAAGvE,SAASiB,QAAAA,KAAak2I,EAAOl2I,QAAAA,KAAasD,EAAGvE,SAASiB,aAAam2I,EAAKn2I,QAAAA,MAC9EsI,IAAW,SAEbguI,EAAOjrI,YAAY9N,EAAUya,UAAU09H,uBAAuBpyI,EAAGxE,YAAYwE,EAAGvE,UAAUuE,GAAI4yI,GAAQ5tI,IACtGguI,EAAOh6H,aAAa,YAAYhZ,EAAG9C,EAAAA,GACnC81I,EAAOh6H,aAAa/e,EAAUM,OAAO0C,iBAAiB+C,EAAG9C,EAAAA,GAEzDjD,EAAU66B,SAASi4B,gBAAgBimF,GAAQhzI,CAE3C+yI,GAAAA,EAAW/qI,YAAYgrI,CACvB;AAAA,UAAA;AACDJ,cAAS34I,EAAUgC,KAAKC,IAAI02I,GAAQ,GAAG,QACvCC,IAAO54I,EAAUgC,KAAKC,IAAI22I,GAAM,GAAG;QACnC;AAAA,MACH,QAaG54I,EAAUyK,cAAczK,EAAU2oD,aAAa,IAC/C3oD,EAAU8C,WAAW4d,cAAc,iBAAA,EAAmBzf,MAAMkgB,UAAU;AAAA,IAEzE,GACCnhB,EAAUi5I,oBAAoB,SAAS9zF,GACtC;AAAA,UAAIsvF,IAAetvF,EAAIp/C;AAEvB,YAAMmzI,IAAU/zF,EAAIp/C,GAAGrB,OAAOC,QAAQ,kBAAA;AACtC,UAAI3C;AAKJ,UAJGk3I,MACFl3I,IAAOk3I,EAAQ9lI,QAAAA,CAGXpR;AACJ,eAAOmjD;AACRA,MAAAA,EAAI75B,IAAI;AACR,UAAIk7B,IAAOxkD,EAAKS,QAAYzC,IAAAA,EAAUkK,UAAUzH,QAAAA;AAEhD,UADA0iD,EAAI95B,IAAIjc,KAAKg2C,KAAOoB,IAAI,MAAmBl9C,KAAKhJ,OAAOq6B,SAChC,GAAnBrxB,KAAKP,cAAc,UAAUO,KAAKw6B,aAAax6B,KAAK+8C,gBAAgB/8C,KAAKw6B,WAAWqhB,IAAM;AAC7F,YAAI4+C;AACJz6F,aAAKs7C,YAAY2E,eAAAA,IACjBjgD,KAAKq6C,aAAar6C,KAAKR;AACvB,iBAAS5F,IAAI,GAAGA,IAAIlD,EAAU0lC,UAAUviC,QAAQD;AAC3ClD,YAAU8I,YAAYQ,KAAKo8B,UAAUxiC,GAAGiB,aAAamF,KAAKhJ,OAAO0C,eAAAA,MACpE+gG,IAAYz6F,KAAKo8B,UAAUxiC,CAE7B;AAAA,YAAA,CAAKlD,EAAUk4I,IAAIiB,MAAM;AACxB,cAAI9tI,IAAM04F,EAAU3gG,UAAAA,EACpBkG;AAAAA,eAAK4uI,IAAIiB,OAAO9tI,GAChBA,EAAIyD,YAAYi1F,EAAUj1F,WAC1BzD,EAAIpI,KAAK,cACToI,EAAIyD,aAAa,eACjBlB,SAASmJ,KAAKhJ,YAAY1C;QAC1B;AACD,YAAI+tI,IAAUxrI,SAAS8/B,eAAe,YACtC0rG;AAAAA,QAAAA,EAAQn4I,MAAMC,OAAQuzI,EAAaj0G,SAASi0G,EAAajpH,WAAW,KAAM,MAC1E4tH,EAAQn4I,MAAME,QAASszI,EAAal0G,SAASk0G,EAAalpH,WAAW,KAAM;AAAA,MAC3E;AACD,aAAO45B;AAAAA,IACT,GACCnlD,EAAUsE,YAAY,wBAAwB,SAASkwI,GAAcC,GAAcjrF,GAAAA;AAClF,UAAIlgD,KAAKoB,SAAS,iBACbpB,KAAKP,cAAc,QAAQ;AAC9B,YAAIk7B,IAAMr2B,SAAS8/B,eAAe,YAAA;AAClCzJ,QAAAA,EAAI14B,WAAWC,YAAYy4B,IAC3BjkC,EAAUk4I,IAAIiB;MACd;AAEF,aAAO;AAAA,IACT,CAECn5I,GAAAA,EAAUsE,YAAY,eAAe,SAASrB,GAAI2M,GAAM2sG,GAAAA;AAGvD,aAFIA,KAAgBjzG,KAAKoB,SAAS,kBACjCpB,KAAKq6C,aAAa1gD;IAErB,CAAA,GAECjD,EAAUk4I,IAAIn1C,iBAAiB,IAE/B/iG,EAAUsE,YAAY,WAAW,SAASgjE,GAAU+sC,GAAAA;AACnD,UAAI/qG,KAAKoB,SAAS,kBAAoB1K,EAAUM,OAAO04I,sBAAsBh5I,EAAUM,OAAO04I,gCAAmC;AAChI,YAAIh5I,EAAUk4I,IAAIn1C;AACjB,mBAAS7/F,IAAI,GAAGA,IAAIoG,KAAK4uI,IAAIn1C,eAAe5/F,QAAQD,KAAK;AACxD,gBAAImI,IAAM/B,KAAK4uI,IAAIn1C,eAAe7/F;AAClCmI,YAAAA,EAAIyD,YAAYzD,EAAIyD,UAAU+I,QAAQ,2BAA2B;UACjE;AASF,eAPAvO,KAAKm8B,aAAa6hC,GAAU,SAASy8B,GACpCA;AAAAA,UAAAA,EAAUj1F,aAAa,2BACvB9O,EAAUk4I,IAAIn1C,eAAepgG,KAAKohG,CAAAA;AAAAA,QACtC,IAGG/jG,EAAU2jD,aAAa2jB;MAEvB;AACD,aAAO;AAAA,IACT,CACA;AAAA,EAAA,CAAA;AAGA,GrDzJC+xE,IsDhFc,SAASr5I;AACxBA,IAAUsE,YAAY,cAAa,WAClC;AAAA,QAAIgF,KAAKgzB;AACR,UAAA;AACChzB,aAAKgzB,OAAOr7B,MAAM8N,SAASzF,KAAK26C,WAAW,UAAWr2C,SAASmJ,KAAKxL,cAAYqC,SAASmJ,MAAMolD,eAAa;AAAA,MAC5G;MAEA;AAAA,EAEH,CAAA,GAEAn8D,EAAUu4B,YAAY5Q,OAAO+Q,YAAU,SAASpS,GAAK9N,GAAMzS;IAC/CyS,gBAAwBA,MAAU,OAC5CA,KAAS8N,EAAKrW,WAAWrK,QAAQ,CAAI,KAAA,CAAE,GAAE4S,QAC1C8N,EAAKrW,WAAWuI,QAAMA,KAAO;AAAA,EAC9B;AAEA,GtDgEC8gI,WuDjFc,SAASt5I,GAMvBA;AAAAA,IAAUya,UAAU8+H,YAAY,SAASv3I,GACxC;AAAA,WAAOhC,EAAUgC,KAAK0tB,YAAY1vB,EAAU0tB,OAAOwN,OAAOof,WAAW,KAAA,EAAOt4C,CAAAA;AAAAA,EAC9E,GACChC,EAAUya,UAAU++H,aAAax5I,EAAUgC,KAAK0tB,YAAY,IAC5D1vB,GAAAA,EAAUya,UAAUg/H,kBAAkBz5I,EAAUgC,KAAK0tB,YAAY,IACjE1vB,GAAAA,EAAUya,UAAUi/H,eAAe,SAAStzI,GAAG5B,GAAGuB,GAAAA;AACjD,WAAOA,EAAGyW;AAAAA,EACZ;AAEC,QAAMm9H,IAAa,WAAA;AAClB,WAAO35I,EAAU0K,SAAS;AAAA,EAC5B,GAEOkvI,IAAc,SAAStzH,GAAAA;AAC5B,QAAIrY,IAAMjO,EAAUu+B,YAAY55B,QAAQ2hB,GAAM,kBAC9C;AAAA,WAAIrY,KAAQA,EAAI6Z,aAAa,gBACtB9nB,IAAAA,EAAUya,UAAUC,WAAWzM,EAAI9J,aAAa,gBAAA,CAAA,IADA;AAAA,EAEzD;AAGCnE,IAAU65I,yBAAwB,SAASr1I,GAAAA;AAC1C,QAAIm1I,EAAAA,GAAc;AACjB,YAAMj1I,IAASF,EAAEE;AACjB,UAAG1E,EAAUu+B,YAAY55B,QAAQD,GAAQ,aAAA,KAAkB1E,EAAUu+B,YAAY55B,QAAQD,GAAQ;AAChG,eAAO;AAGR,YAAM1C,IAAO43I,EAAYl1I;AAEzB,UAAG1C,GAAK;AACP,cAAMiL,IAAQjL,GACRkL,IAAM5D,KAAKtH,KAAKC,IAAIgL,GAAO,GAAG;SAC/B3D,KAAKhJ,OAAOy6B,YAAYzxB,KAAKhJ,OAAOsT,mBACxCtK,KAAKuK,YAAY5G,EAAMxK,WAAWyK,EAAIzK,QAAAA,GAAW+B;MAElD;AAAA,IACD;AAAA,EACH,GAECxE,EAAUsE,YAAY,mBAAmB;AACpCq1I,IAAAA,EACHrwI,KAAAA,KAAKgwI,YACR;AAAA,EAAA,CAAA;AAGC,MAAIlrH,IAAMpuB,EAAU+V;AACpB/V,IAAU+V,cAAc,SAAS5N;AAChC,QAAKwxI,CAAAA,EAAAA;AAAc,aAAOvrH,EAAIliB,MAAM5C,MAAM+I,SAC1C;AAAA,aAASnP,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD;AAC/BoG,WAAKwwI,mBAAmB3xI,EAAIjF,CAC/B,CAAA;AAAA,EAAA;AAEC,MAAIshB,IAAQxkB,EAAUk5D;AACtBl5D,IAAUk5D,aAAa,WAAA;AACtB,SAAKygF,EAAc;AAAA,aAAOn1H,EAAMtY,MAAM5C,MAAM+I,SAC5C;AAAA,QAAIlF,IAAQnN,EAAU+5I;AAEtB,aAAS/3I,KAAQmL;AACZA,MAAAA,EAAMZ,eAAevK,CAClBmL,KAAAA,EAAMnL,CACR6c,EAAAA,UAAUwL,OAAO,kBAAkB;AAMzCrqB,MAAU+5I,qBAAqB;EACjC,GAEC/5I,EAAUg6I,eAAe,WAAA;AACpB1wI,SAAK8jI,aACR9jI,KAAK8jI,SAASnsI,MAAMkgB,UAAU,QAC9B7X,KAAK8jI,SAASprI,OAAO,IAAIQ,KAAK,MAAM,GAAG,CAAA;AAAA,EAE1C,GAECxC,EAAUi6I,eAAe,SAASj4I,GAAMmjD,GAAK3gD,GAAGmP,GAAAA;AAC/C,QAAIrK,KAAK8jI,UAAU;AAClB,UAAI9jI,KAAK8jI,SAASprI,KAAKS,QAAaT,KAAAA,EAAKS;AAAW;AACpD6G,WAAK8jI,SAASt/H,YAAY;AAAA,IAC7B,OAAS;AACN,UAAIyE,IAAIjJ,KAAK8jI,WAAWx/H,SAASC,cAAc,KAC/C0E;AAAAA,MAAAA,EAAEzD,YAAY,oBACVxF,KAAKhJ,OAAOsgC,QAAKruB,EAAEzD,aAAa,qBACpClB,SAASmJ,KAAKhJ,YAAYwE,CAC1BA,GAAAA,EAAE4S,iBAAiB,SAASnlB,EAAU8kC,OAAOC,YAAAA,GAC7CxyB,EAAE4S,iBAAiB,SAAS,SAAS3gB,GAAAA;AACpC,YAAGA,EAAEE,OAAOC,QAAQ,IAAI3E,EAAUM,OAAO0C,eAAAA,GAAAA,GAAoB;AAC5D,gBAAMC,IAAKuB,EAAEE,OAAOC,QAAQ,IAAI3E,EAAUM,OAAO0C,eAAoBmB,GAAAA,EAAAA,aAAanE,EAAUM,OAAO0C,eACnGhD;AAAAA,YAAUu8B,aAAat5B,CACvB;AAAA,QAAA;AAAA,MACL;IACG;AAID,aAHIkF,IAAMmB,KAAK+6B,UAAUriC,GAAMsH,KAAKtH,KAAKC,IAAID,GAAM,GAAG,SAClDN,IAAO,IAEFwB,IAAI,GAAGA,IAAIiF,EAAIhF,QAAQD,KAAK;AACpC,UAAI6C,IAAKoC,EAAIjF;AACb,UAAIoG,KAAK0wD,aAAaj0D,EAAG9C,IAAI8C,CAA7B,GAAA;AAGA,YAAIg8D,IAAYh8D,EAAGg6D,QAAS,sCAAsCh6D,EAAGg6D,QAAQ,MAAO,IAChFA,IAASh6D,EAAGu6D,YAAa,iCAAiCv6D,EAAGu6D,YAAY,MAAO;AAEpF5+D,QAAAA,KAAQ,0CAA0CqgE,IAAgBhC,IAAQ,iBAAiB53D,EAAIjF,CAAAA,EAAGD,KAAK,OAAKqG,KAAKhJ,OAAO0C,kBAAgB,OAAKmF,EAAIjF,CAAGD,EAAAA,KAAG,MACvJvB,KAAQ,0CAA0CqgE,IAAgBhC,IAAQ,QAAQ53D,EAAIjF,GAAGyF,SAASW,KAAKmR,UAAU69C,WAAWnwD,EAAIjF,GAAG3B,UAAc,IAAA,MAAM,UACvJG,KAAQ,yDACRA,KAAQ4H,KAAKmR,UAAUi/H,aAAavxI,EAAIjF,CAAG3B,EAAAA,YAAY4G,EAAIjF,CAAG1B,EAAAA,UAAU2G,EAAIjF,CAAAA,CAAAA,IAAM;AAAA,MARxE;AAAA,IASV;AAEDoG,SAAK8jI,SAASnsI,MAAMkgB,UAAU,IAC9B7X,KAAK8jI,SAASnsI,MAAMC,MAAM,OAGtB0M,SAASmJ,KAAKwM,cAAc4hC,EAAIhkD,OAAOmI,KAAK8jI,SAAS7pH,cAAc,IACtEja,KAAK8jI,SAASnsI,MAAME,OAAOgkD,EAAIhkD,OAAOmI,KAAK8jI,SAAS7pH,cAAc,OAElEja,KAAK8jI,SAASnsI,MAAME,OAAOgkD,EAAIhkD,OAAOwS,EAAI4P,cAAc,MAEzDja,KAAK8jI,SAASprI,OAAOA,GACrBsH,KAAK8jI,SAASt/H,YAAYpM,GAEtBkM,SAASmJ,KAAKsM,eAAe8hC,EAAIjkD,MAAMoI,KAAK8jI,SAAS/pH,eAAe,IACvE/Z,KAAK8jI,SAASnsI,MAAMC,MAAMikD,EAAIjkD,MAAMoI,KAAK8jI,SAAS/pH,eAAe1P,EAAI0P,eAAe,OAEpF/Z,KAAK8jI,SAASnsI,MAAMC,MAAMikD,EAAIjkD,MAAM;AAAA,EACvC,GAEClB,EAAUk6I,6BAA6B,SAAS11I,GAC/C;AAAA,QAAKm1I,KAAL;AAEA,UAAIhmI,IAAMnP,EAAEE,UAAUF,EAAEoiB;AACS,MAA7BjT,EAAI+X,QAAQ1H,YACfrQ,KADgC,QAChCA,IAAMA,EAAIpI,aACPvL,EAAUkQ,cAAcyD,CAAAA,EAAKxD,QAAQ,gBAAA,KAAsB,KAC9DnQ,EAAUi6I,aAAaj6I,EAAUya,UAAUC,WAAW/G,EAAIxP,aAAa,gBAAA,CAAA,GAAoBnE,EAAUu+B,YAAY/V,UAAU7U,CAAMnP,GAAAA,GAAGmP,CAEpI3T,IAAAA,EAAUg6I;IARe;AAAA,EAS5B,GACCh6I,EAAUm6I,qBAAqB,WAAA;AAC9Bn6I,MAAUuhD,gBAAgBvhD,EAAU6J,KAAmB,aAAE,CAAI,GAAA,aAAa7J,EAAUk6I,0BACpFl6I,GAAAA,EAAUI,MAAMJ,EAAU6J,KAAmB,aAAE,CAAI,GAAA,aAAa7J,EAAUk6I,0BAAAA;AAAAA,EAC5E,GAECl6I,EAAU0rG,iBAAiB,SAAS/5F,GAAAA;AAGnC,aAFIuf,IAAalxB,EAAUya,UAAU8c,YAAY5lB,CAC7C9O,GAAAA,IAAQyG,KAAKkZ,MAAMzf,iBAAiB,0DAA0DmuB,CAAAA,IAAAA,GAC1FhuB,IAAI,GAAGA,IAAIL,EAAMM,QAAQD;AAChC,WAAIlD,EAAUu+B,YAAY55B,QAAQ9B,EAAMK,CAAAA,GAAI;AAC3C,eAAOL,EAAMK;AAGf,WAAO;AAAA,EACT,GAEClD,EAAU+5I,qBAAqB,IAC/B/5I,EAAUo6I,kBAAkB,SAASp4I,GAAM5B,GAAAA;AAC1C,QAAI8wB,IAAalxB,EAAUya,UAAU8c,YAAYv1B,CAC7CssD,GAAAA,IAAOhlD,KAAKoiG,eAAe1pG,CAAAA;AAC/B,QAAKssD,GAAL;AAGA,UAAIykC,IAAWzpF,KAAKmR,UAAU89C,YAAYn4D,EAAMmB,YAAYnB,EAAMoB,UAAUpB,CAAAA;AACvEJ,QAAU+5I,mBAAmB7oH,CAAAA,MACjCo9B,EAAKzvC,UAAU5c,IAAI,kBAAkB,0BAAA,GACrCqsD,EAAKvvC,aAAa,kBAAkBmS,CACpCo9B,GAAAA,EAAKvvC,aAAa,QAAQmS,CAAAA,GAC1BlxB,EAAU+5I,mBAAmB7oH,CAAAA,IAAco9B,IAEzCykC,KACFzkC,EAAKzvC,UAAU5c,IAAI8wF,CATnB;AAAA,IAAA;AAAA,EAWH,GACC/yF,EAAUq6I,oBAAoB,SAASr4I,GACtC;AAAA,QAAIssD,IAAOhlD,KAAKoiG,eAAe1pG,CAAAA;AAC1BssD,IAAAA,KAGLA,EAAKzvC,UAAUwL,OAAO,kBAAkB,0BAAA;AAAA,EAE1C,GACCrqB,EAAU85I,qBAAqB,SAAS15I,GAAAA;AACvC,QAAI4B,IAAO5B,EAAMmB;AAOjB,SALCS,IADGA,EAAKS,QAAAA,IAAY6G,KAAKY,UAAUzH,QAAAA,IAC5B6G,KAAKY,YAELZ,KAAKtH,KAAKwF,UAAU,IAAIhF,KAAKR,KAG9BA,IAAO5B,EAAMoB;AAGnB,UAFA8H,KAAK8wI,gBAAgBp4I,GAAM5B,CAC3B4B,IAAAA,IAAOsH,KAAKtH,KAAKC,IAAID,GAAM,GAAG,KAAA,GACrBS,aAAa6G,KAAKW,UAAUxH,QACpC;AAAA;AAAA,EAEJ,GAECzC,EAAUs5I,YAAY,SAAS/0I,GAAAA;AAM9B,QAJAvE,EAAUiiD,UAAAA,GAEVjiD,EAAUyK,cAAclG,GAAAA,CAEpB+E,KAAK2oB,cAAAA,CAAc3oB,KAAKsoB,MAAAA;AAE5B,UAAIrtB,GAAM;AAGT,YAFAvE,EAAUm6I,mBAAAA,GACVn6I,EAAUs6I,kBACNt6I,GAAAA,EAAUiyB,cAAcjyB,EAAU4xB,MAErC;AAAA,iBAAA,MADA5xB,EAAUw2B,eAAe;AAG1Bx2B,UAAUgW,iBACb;AAAA,MAAA;AACGhW,UAAUg6I,aAEb;AAAA,EAAA,GAECh6I,EAAUs6I,oBAAoB,WAE7B;AAAA,QAAI90F,IAAWl8C,KAAKO,KAAmB,aAAE,CAEzC27C;AAAAA,IAAAA,EAAS/7B,YAAY,GACrB+7B,EAAS13C,YAAY;AAErB,QAAIm6E,IAAY3+E,KAAKtH,KAAK+sB,WAAW,IAAIvsB,KAAK8G,KAAK8J;AAEnD9J,SAAKY,YAAYZ,KAAKtH,KAAKY,WAAW,IAAIJ,KAAKylF,CAE/C,CAAA;AAAA,UAAMxoC,IAAU7xC,SAASC,cAAc;AACvC4xC,IAAAA,EAAQ5gC,UAAU5c,IAAI,kBAEtB;AAAA,QAAIi8C,IAAc+pC;AAClB,aAAQ/kF,IAAI,GAAGA,IAAI,IAAIA,KAAI;AAC1B,UAAIq3I,IAAU3sI,SAASC,cAAc,KACrC0sI;AAAAA,MAAAA,EAAQzrI,YAAY,gBAEpByrI,EAAQx7H,aAAa,QAAQzV,KAAKstB,SAASsf,WAAWgI,CACtDq8F,CAAAA,GAAAA,EAAQx7H,aAAa,mBAAmBzV,KAAKstB,SAASsf,WAAWgI,CAAAA,CAAAA,GACjEq8F,EAAQzsI,YAAY,+BAA+BxE,KAAKmR,UAAU++H,WAAWt7F,CAAAA,CAAAA;AAAAA;AAG7E,YAAM+U,IAAWsnF,EAAQ75H,cAAc,gBACjC85H,GAAAA,IAAax6I,EAAUo0D,kBAAkB,MAAM,EACpDpyD,MAAMk8C,GACN3B,YAAYv8C,EAAUy6I,aACtBj8F,UAAU;AAEXg8F,MAAAA,EAAW18F,eAAemV,IAC1BunF,EAAW7kG,WAAAA,GAEX8J,EAAQ1xC,YAAYwsI,CAEpBr8F,GAAAA,IAAc50C,KAAKtH,KAAKC,IAAIi8C,GAAa,GAAG,OAAA;AAAA,IAE5C;AACDsH,IAAAA,EAASz3C,YAAY0xC,CAErB;AAAA,QAAIL,IAAW91C,KAAKtH,KAAKC,IAAIgmF,GAAW,GAAG,MACxC7oC;AAAAA,IAAAA,EAAS38C,aAAa6G,KAAKtH,KAAKY,WAAW,IAAIJ,KAAK48C,CAAAA,CAAAA,EAAW38C,cACjE28C,IAAW91C,KAAKtH,KAAKY,WAAW,IAAIJ,KAAK48C,CACzCA,CAAAA,GAAAA,IAAW91C,KAAKtH,KAAKC,IAAIm9C,GAAU,GAAG,MAEvC91C,IAAAA,KAAKW,YAAYm1C;AACjB,QAAIi0C,IAAc/pF,KAAKojD,mBAAAA;AACpB2mC,IAAAA,MACFA,EAAYvlF,YAAYxE,KAAKmR,UAAUnR,KAAKoB,QAAQ,SAASu9E,GAAW7oC,GAAU91C,KAAKoB,KAE1F;AAAA,EAAA;AAEC,MAAI3F,IAAgB/E,EAAU+E;AAC9B/E,IAAU+E,gBAAgB,SAASmqD;AAClC,WAAIyqF,EAAAA,IAKG,EACN33I,MAFU43I,EAAY1qF,EAAKxqD,MAAAA,GAG3BM,SAAQ,KAAA,IANDD,EAAcmH,MAAMlM,GAAWqS;EAQzC;AAEC,MAAIqoI,IAAc16I,EAAUolC;AAC5BplC,IAAUolC,gBAAgB,SAAS9e,GAAAA;AAClC,QAAIrjB,IAAKy3I,EAAYxuI,MAAMlM,GAAWqS,SAAAA;AACtC,SAAIpP,GAAG;AAEN,UAAIjB,IAAO43I,EAAYtzH,CAAAA;AACvB,WAAItkB;AAAM,eAAO;AACjB,UAAImG,IAAMnI,EAAUqkC,UAAUriC,GAAMhC,EAAUgC,KAAKC,IAAID,GAAM,GAAG,KAChE,CAAA;AAAA,UAAA,CAAImG,EAAIhF;AAAQ,eAAO;AAGvBF,MAAAA,IAAKkF,EAAI,CAAGlF,EAAAA;AAAAA,IACZ;AACD,WAAOA;AAAAA,EACT,GAECjD,EAAUsE,YAAY,aAAa,WAAA;AAClCtE,MAAUg6I,aACZ;AAAA,EAAA,CAAA;AACA,KCjTMW,KAAU,ICQhB;EAEC,YAAaC;AACZtxI,SAAKiN,QAAQ,GACbjN,KAAKuxI,oBAAoB,CACzBvxI,GAAAA,KAAKwxI,qBAAqBF,GAC1BtxI,KAAKyxI,qBAAqB,IAAI50E,GAAkBy0E,CAChD;AAAA,EAAA;AAAA,EAED,OAAO/+H,GAAAA;AACNvS,SAAKuxI,kBAAkBl4I,KAAKkZ,CAAAA,GAEzB/b,EAAOE,aACT6b,EAAK/b,EAAOE,SAEb;AAAA,EAAA;AAAA,EAED,qBAAqBg7I,GAAAA;AAGpB,aAFIh7I,IAAYggD,GAAc12C,KAAKyxI,kBAE1B73I,GAAAA,IAAI,GAAGA,IAAIoG,KAAKuxI,kBAAkB13I,QAAQD;AAClDoG,WAAKuxI,kBAAkB33I,CAAGlD,EAAAA,CAAAA;AAY3B,WAVAA,EAAUi7I,eAAe3xI,KAAKiN,SAE1BjN,KAAK4xI,gBACR5xI,KAAK4xI,aAAal7I,CAGhBg7I,GAAAA,KACF1xI,KAAK6xI,gBAAgBn7I,GAAWg7I,CAG1Bh7I,GAAAA;AAAAA,EACP;AAAA,EAED,gBAAgBA,GAAWg7I,GAe1B;AAAA,QAdGA,EAAW51E,WACbplE,EAAUolE,QAAQ41E,EAAW51E,OAG3B41E,GAAAA,EAAW16I,UACbN,EAAUqd,MAAMrd,EAAUM,QAAQ06I,EAAW16I,QAAQ,EAAA,GAGnD06I,EAAWvgI,aACbza,EAAUsE,YAAY,oBAAoB;AACzCtE,QAAUqd,MAAMrd,EAAUya,WAAWugI,EAAWvgI,WAAW,EAAA;AAAA,IAC/D,GAAM,EAACwB,SAGF++H,CAAAA,GAAAA,EAAWl/H;AACb,iBAAU1b,KAAS46I,EAAWl/H;AAC7B9b,UAAUsE,YAAYlE,GAAO46I,EAAWl/H,OAAO1b,CAI9C46I,CAAAA;AAAAA,IAAAA,EAAWttH,UACb1tB,EAAU0kE,KAAKE,UAAUo2E,EAAWttH,MAAAA,GAGlC7hB,MAAM6R,QAAQs9H,EAAW13B,SAAAA,KAC3B03B,EAAW13B,UAAUl/G,QAAQ,SAASub,GACrC3f;AAAAA,QAAUo7I,YAAYz7H,CAC1B;AAAA,IAAA,CAAA,GAGKq7H,EAAWx0I,YACbxG,EAAUiuB,KAAK+sH,EAAWx0I,SAE1BxG,IAAAA,EAAUiuB,QAGR+sH,EAAWprI,gBACHorI,EAAWprI,QAAS,WAC7B5P,EAAUga,KAAKghI,EAAWprI,IAAAA,IAE1B5P,EAAUmX,MAAM6jI,EAAWprI;EAG7B;ADxFmCgiF,EAAAA,EAAAA,GAE/B5xF,KAAY26I,GAAQ/2E,qBAAAA,GACpBD,KAAY,EACjBsC,QAAQjmE,GAAUmZ,KAAKwhI,GAAQ10E,QAAQ00E;AAGxC96I,OAAOG,YAAYA,IACnBH,OAAO8jE,YAAYA,IAEf9jE,OAAOw7I,SACVx7I,OAAOw7I,OAAO,KAGfx7I,OAAOw7I,KAAKr7I,YAAYA,IACxBH,OAAOw7I,KAAK13E,YAAYA;","x_google_ignoreList":[4,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117]}